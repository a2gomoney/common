(function(){try{var b={pluginName:"convertpdf",pluginFullName:"p_convertpdf",_isLoadedAllResources:!1};G_DEPlugin.convertpdf=b;b.isSupportBrowser=!0;b.isRequiredOtherResource=function(a){var c=setInterval(function(){!0===b._isLoadedAllResources&&(clearInterval(c),a())},200)};(DEXTTOP.DEXT5.browser.ie||0==DEXTTOP.DEXT5.browser.canvasSupported)&&function(){b.isSupportBrowser=!1;_dext_editor._config.removeItem.push(b.pluginFullName);var a=_dext_editor._config.toolBar1.indexOf(b.pluginFullName),c=_dext_editor._config.toolBar2.indexOf(b.pluginFullName);
-1<a&&_dext_editor._config.toolBar1.splice(a,1);-1<c&&_dext_editor._config.toolBar2.splice(c,1);b._isLoadedAllResources=!0}();b.onClickToolIcon=function(a){if(b.isSupportBrowser)switch(a){case b.pluginName:b.start()}};b.onDisableToolIcon=function(a){switch(a){case "":case "default":return!1;case "selectedMultiCell":return[b.pluginFullName];case "focusInCell":return!1;case "focusInCellLockTable":return!1;default:return[b.pluginFullName]}};b.onInit=function(){if(b.isSupportBrowser){var a=function(){var b=
"../plugin/convertpdf/js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+"/jspdf.umd.min.js?t="+DEXTTOP.DEXT5.UrlStamp;loadScript({url:b,targetDocument:document});b="../plugin/convertpdf/js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+(DEXTTOP.DEXT5.isRelease?"/splitpage.min.js":"/splitpage.js")+"?t="+DEXTTOP.DEXT5.UrlStamp;loadScript({url:b,targetDocument:document});c()},c=function(){var a="../plugin/convertpdf/js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+"/config.js",a="1"==_dext_editor._config.useConfigTimeStamp?a+("?t="+
DEXTTOP.DEXT5.util.getTimeStamp()):a+("?t="+DEXTTOP.DEXT5.UrlStamp);loadScript({url:a,targetDocument:document});loadScript({url:_dext_editor._config.webPath.plugin+b.pluginName+"/js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+"/lang/"+_dext_editor._config.lang+".js?t="+DEXTTOP.DEXT5.UrlStamp,targetDocument:document},function(){b._isLoadedAllResources=!0})};0==DEXTTOP.DEXT5.browser.ES6Supported?loadScript({url:"../plugin/convertpdf/js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+"/polyfills.umd.js?t="+DEXTTOP.DEXT5.UrlStamp,
targetDocument:document},function(){a()}):a()}};b.onInit();b.onLoaded=function(){var a=document.getElementById("ue_"+_dext_editor.ID+b.pluginFullName);a&&a.setAttribute("title",b.lang.icon[b.pluginFullName])};b.start=function(){if(DEXTTOP.DEXT5.isEmpty(_dext_editor.ID))alert(b.lang.message.empty);else{showProcessingBackground();var a=DEXTTOP.DEXT5.getHtmlValueExWithDocType(_dext_editor.ID),c=DEXTTOP.DEXT5.util.getStyle(_iframeDoc.body,"all"),a={html:a,pageSize:"a4",defaultStyle:{fontSize:_dext_editor._setting.font_size,
fontFamily:_dext_editor._setting.font_family,paddingTop:c.marginTop,paddingBottom:c.marginBottom,paddingLeft:c.marginLeft,paddingRight:c.marginRight,lineHeight:_dext_editor._setting.line_height,editorBodyWidth:_iframeDoc.body.style.width,wordBreak:c.wordBreak,wordWrap:c.wordWrap}},e=new SplitPage;e.start(a,function(a){if(a)alert(b.lang.message.error),hideProcessingBackground();else{var c={pages:e.page,pageToImageIndex:0,canvas:[],imgData:[],splitPageWindow:e.splitPageWindow};a=e.splitPageDocument.createElement("script");
a.onload=function(){b.pageToImage(c,function(a){for(var c=new jspdf.jsPDF("p","cm","a4"),g=a.length,h=0;h<g;h++){0<h&&c.addPage();var k=a[h],d=c.internal.pageSize.getWidth()+"cm",d=DEXTTOP.DEXT5.util.replacePtOrCmToPx(d),d=parseFloat(d),d=(d-k.width)/2,d=.02645*d,f=b.options.minMarginLeft;"string"===typeof f&&0<f.length&&(f=parseInt(f,10),f*=.02645);d<f&&(d=f);k=k.toDataURL("image/png");c.addImage(k,"PNG",d,0)}c.save(b.options.fileName);e.clear();hideProcessingBackground()})};a.onerror=function(){};
a.src="../plugin/convertpdf/js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+"/html2canvas.min.js?t="+DEXTTOP.DEXT5.UrlStamp;e.splitPageDocument.getElementsByTagName("head")[0].appendChild(a)}})}};b.pageToImage=function(a,c){var e=a.pages,g=a.canvas;a.splitPageWindow.html2canvas(e[a.pageToImageIndex],{allowTaint:!0,useCORS:!0,logging:!1}).then(function(l){g.push(l);a.pageToImageIndex++;e[a.pageToImageIndex]?b.pageToImage(a,c):c(g)})}}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}})();
