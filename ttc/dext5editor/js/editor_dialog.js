var console=window&&window.console?window.console:{log:function(){}},G_IMAGE_ALLOW_EXT=["jpg","jpeg","png","gif","bmp"],G_dragDropFileObj=null,G_OriginalMultiImageSize={},G_IeUploadInputFileFlag=!0,LayerFrame=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+DEXTTOP.G_CURREDITOR.ID),LayerWin=LayerFrame.contentWindow,LayerDoc=LayerWin.document;DEXTTOP.DEXT5.util.overrideFn(window);
Array.prototype.indexOf||(Array.prototype.indexOf=function(a,e){e=e||0;for(var b=this.length;e<b;){if(this[e]===a)return e;++e}return-1});
try{HTMLCanvasElement&&!HTMLCanvasElement.prototype.toBlob&&Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(a,e,b){var c=this;setTimeout(function(){for(var d=atob(c.toDataURL(e,b).split(",")[1]),f=d.length,g=new Uint8Array(f),h=0;h<f;h++)g[h]=d.charCodeAt(h);a(new Blob([g],{type:e||"image/png"}))})}})}catch(e$$4){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}
function getBoundrayRanNumber(){if("undefined"!=typeof crypto&&"undefined"!=typeof crypto.randomUUID){var a="";do a+=crypto.randomUUID().replace(/-/g,"").replace(/[a-zA-Z]/g,"");while(5>a.length);return a.substring(0,5)}return Math.floor(99999*Math.random()).toString()}
function dext_setting(){var a=document.getElementById("grid_color").style.backgroundColor,e=document.getElementById("grid_color_name").innerHTML,b=document.getElementById("lang").value,c=document.getElementById("grid_spans").value,d=document.getElementsByName("grid_form")[0].checked?"line":"dot",f=document.getElementById("page_title").value,g=document.getElementById("encoding").value,h=document.getElementById("doctype").value,m=document.getElementById("xhtml").checked?document.getElementById("xhtml").value:
"",k=document.getElementById("auto_list").value,n=document.getElementById("check_auto_save").checked,p=document.getElementById("input_auto_save").value;"none"!=document.getElementById("div_auto_save").style.display?n?""!=p&&"0"!=p?(LayerWin._dext_editor._setting.auto_save.userSetting="on",LayerWin._dext_editor._setting.auto_save.time=parseFloat(p)):LayerWin._dext_editor._setting.auto_save.userSetting="off":LayerWin._dext_editor._setting.auto_save.userSetting="off":LayerWin._dext_editor._setting.auto_save=
null;n=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==n||-1<n.indexOf("setting_title"))if(n=LayerWin._dext_editor._config.accessibility,"1"==n)""==f&&alert(LayerWin.dext5_lang.msg.alert_page_title_access1);else if("2"==n&&""==f){alert(LayerWin.dext5_lang.msg.alert_page_title_access2);document.getElementById("page_title").focus();return}var q=n="",r="",n="1"==LayerWin._dext_editor._config.personalSettingUseFontFamilyKeyin?""==document.getElementById("personal_font_family").value?
document.getElementById("personal_font_family").value:LayerWin.getRealNameThroughDisplayName(document.getElementById("font_family_keyin").value):document.getElementById("personal_font_family").value;"1"==LayerWin._dext_editor._config.personalSettingUseFontSizeKeyin?""==document.getElementById("personal_font_size").value?q=document.getElementById("personal_font_size").value:(q=document.getElementById("font_size_keyin").value,q=isNaN(q)?q:q+"pt"):q=document.getElementById("personal_font_size").value;
var r="1"==LayerWin._dext_editor._config.personalSettingUseLineHeightKeyin?""==document.getElementById("personal_line_height").value?document.getElementById("personal_line_height").value:document.getElementById("line_height_keyin").value:document.getElementById("personal_line_height").value,u=document.getElementById("word_break").value,t=document.getElementById("word_wrap").value,z=document.getElementById("check_apply_word_break_for_table").checked,y=document.getElementById("personal_paste_to_image").value,
v=document.getElementById("personal_paste_to_image_popupMode").value;dext_json={grid_color:a,grid_color_nm:e,grid_spans:c,grid_form:d,page_title:f,encoding:g,lang:b,doctype:h,xhtml:m,auto_save:p,auto_list:k,personal_font_family:n,personal_font_size:q,personal_line_height:r,word_break_type:u,word_wrap_type:t,word_break_for_all_table:z,personal_paste_to_image:y,personal_paste_to_image_popupMode:v};LayerWin.event_dext_setting(dext_json,window.frameElement.parentNode.parentNode)}
function dext_horizontal_line(a,e,b){var c;if(a)LayerWin._dext_editor.lastHorizontalLine.dext_json=null,LayerWin._dext_editor.lastHorizontalLine.template={obj:a,tempWidth:e,clickedIdx:b};else{b=document.getElementById("width_1").value;c=document.getElementById("height").value;var d=document.getElementById("align").value,f=document.getElementById("hr_color").style.borderTopColor;c={width:b,height:c,align:d,color:f};LayerWin._dext_editor.lastHorizontalLine.dext_json=c;LayerWin._dext_editor.lastHorizontalLine.template=
{obj:null,tempWidth:null,clickedIdx:null}}LayerWin.event_dext_horizontal_line(c,a,e,window.frameElement.parentNode.parentNode)}function loading_image_show(a){var e=document.getElementById("dext_loading"),b="";0==a?(b="none",document.body.style.cursor="default"):document.body.style.cursor="wait";e&&(e.style.display=b);"1"==LayerWin._dext_editor._config.uploadUseHTML5&&a&&e&&e.childNodes&&(e.childNodes[1].nodeValue=" Uploading... ")}
function web_url_remove_char(a){a=DEXTTOP.DEXT5.util.trim(a);a=a.replace(/(\r\n|\r|\n)/gm,"");a=a.replace(/&#13;/g,"");a=a.replace(/&#10;/g,"");return a=a.replace(/&#32;/g,"")}
function dext_upload_image_quality(a){loading_image_show(!0);LayerWin.G_QualityFileObj=[];var e=0;G_dragDropFileObj&&(e=G_dragDropFileObj.length);for(var b=0;b<e;b++){var c=DEXTTOP.DEXT5.util.getExtensionFromFileName(G_dragDropFileObj[b].name),d=LayerWin.imageQualityBool(G_dragDropFileObj[b].size,c);LayerWin.G_QualityFileObj.push({fileObj:G_dragDropFileObj[b],originalExtension:c,originalFileName:G_dragDropFileObj[b].name,idx:b,changeBool:d})}if(0<e){DEXTTOP.DEXT5.browser.WorkerSupported&&"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?
LayerWin.changeImageQuality():LayerWin.changeImageQualityWithoutWorker();var f=setInterval(function(){if(LayerWin.G_CompleteImageQuality){G_dragDropFileObj=[];for(var b=0;b<e;b++)G_dragDropFileObj.push(LayerWin.G_QualityFileObj[b].fileObj);clearInterval(f);LayerWin.G_QualityFileObj=[];LayerWin.G_changeCount=0;LayerWin.G_CompleteImageQuality=!1;a()}},300)}else a()}
function dext_upload_image(){"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&LayerWin.closeBtnPreViewMode();var a=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo;if(DEXTTOP.DEXT5.browser.HTML5Supported&&"0"!=LayerWin.DEXTTOP.G_CURREDITOR._config.uploadUseHTML5)if(document.getElementsByName("InputFlag")[0].checked)if(G_dragDropFileObj){a.uploadData={isImageFileUpload:!0,
isUploaded:!0,isLastIdx:!1,uploadedFileCnt:0,totalFileCount:0,fileIdx:0,nowFileName:"",errorFile:[]};var e=1==LayerWin.DEXTTOP.G_CURREDITOR._config.insertMultiImage;if(e)for(var b=0;b<G_dragDropFileObj.length;b++)0>a.validData.errorFileIdx.indexOf(b)&&(a.uploadData.totalFileCount+=1);else a.uploadData.totalFileCount=1;loading_image_show(!0);var c=!!document.getElementById("image_slider_flag");if(c)var d=document.getElementById("slider_width").value,f=document.getElementById("slider_height").value,
g=document.getElementById("cb_dragable").checked,h=document.getElementById("cb_rewindable").checked,m=document.getElementById("cb_use_dots").checked,k=document.getElementById("cb_use_arrows").checked;var n=setInterval(function(){try{if(a.uploadData.isUploaded)if(0<a.uploadData.totalFileCount&&setProgressBar(),a.uploadData.isLastIdx){loading_image_show(!1);clearInterval(n);if(0<a.uploadData.errorFile.length){var b=!0;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError?b=DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,
{type:"imageUpload",message:a.uploadData.errorFile[0].message,response:a.uploadData.errorFile[0].response,arrFileError:a.uploadData.errorFile}):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&(b=DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a.uploadData.errorFile[0].message,response:a.uploadData.errorFile[0].response,arrFileError:a.uploadData.errorFile}));if(0==b){a.uploadData={};return}if("1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&
1<a.uploadData.totalFileCount){var q=LayerWin.dext5_lang.msg.multi_file_upload_error.replace("{0}",a.uploadData.errorFile.length);alert(q)}}else a.isMulti&&LayerWin.hideDialog(window.frameElement.parentNode.parentNode);a.uploadData={};c&&DEXTTOP.G_CURREDITOR._FRAMEWIN.G_DEPlugin.imageslider.insertImageSlider({_editor:DEXTTOP.G_CURREDITOR,width:d,height:f,isDragable:g,isRewindable:h,useDots:m,useArrows:k})}else a.uploadData.isUploaded=!1,a.uploadData.isLastIdx=a.uploadData.fileIdx==G_dragDropFileObj.length-
1,-1<a.validData.errorFileIdx.indexOf(a.uploadData.fileIdx)?a.uploadData.isUploaded=!0:(a.uploadData.nowFileName=G_dragDropFileObj[a.uploadData.fileIdx].name,dext_upload_image2(G_dragDropFileObj[a.uploadData.fileIdx]),e&&1!=a.uploadData.totalFileCount||(a.uploadData.isLastIdx=!0)),a.uploadData.isLastIdx||a.uploadData.fileIdx++}catch(r){clearInterval(n)}},100)}else alert(LayerWin.dext5_lang.msg.alert_no_file);else dext_upload_image2(null);else 0<a.validData.errorFileIdx.length?alert(LayerWin.dext5_lang.msg.alert_no_file):
dext_upload_image2(null)}function setProgressBar(){var a=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo,a=DEXTTOP.DEXT5.util.parseIntOr0(a.uploadData.uploadedFileCnt/a.uploadData.totalFileCount*100),e=document.getElementById("dext_loading");e&&e.childNodes&&(e.childNodes[1].nodeValue=" Uploading... "+a+"%")}
function dext_upload_image2(a){var e=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo,b=document.dext_upload_form,c;c=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&a?{value:a.name,id:document.getElementById(file_field_id).id}:{value:""}:G_dragDropFileObj&&(e.isMulti||a)?{value:a.name,id:document.getElementById(file_field_id).id}:document.getElementById(file_field_id);var d=document.getElementById("img_web_url"),f=document.getElementById("link_url"),g=LayerWin.getElementsByClass("EdiTor_Popup_contents",
document),h=/^\s\s*$/;if(!h.exec(f.value)&&""!=f.value){var h=new RegExp(/^(http|ftp|https|news)/),m=h.test(f.value);if(f.value==LayerWin.DEXTTOP.G_CURREDITOR._config.defaultProtocolInDialog)f.value="";else if(m&&!LayerWin.urlCheckOrPass(f.value)){alert(LayerWin.dext5_lang.msg.alert_url);g[0].className="EdiTor_Popup_contents none";g[1].className="EdiTor_Popup_contents view";LayerWin.lastFocus(f);return}}var k;if(document.getElementsByName("InputFlag")[0].checked)if(k=c.value,0<k.lastIndexOf(".")){f=
LayerWin._dext_editor._config.accessibilityValidationItems;if(""==f||-1<f.indexOf("img_alt"))if(f=LayerWin._dext_editor._config.accessibility,e.isMulti&&(document.getElementById("img_alt").value=a.name),g=document.getElementById("img_alt").value,"1"==f)""==g&&alert(LayerWin.dext5_lang.msg.alert_image_alt_access1);else if("2"==f&&""==g){alert(LayerWin.dext5_lang.msg.alert_image_alt_access2);document.getElementById("img_alt").focus();return}f=k.substring(k.lastIndexOf(".")+1).toLowerCase();if("base64"==
LayerWin._dext_editor._config.uploadMethod){var e="1"==LayerWin._dext_editor._config.uploadUseHTML5?a:c.files[0],n=new FileReader;n.onload=function(){var a=n.result,b=new Image;b.onload=function(){a+="?"+b.width+"^"+b.height;event_dext_image_upload_completed(a)};b.src=a;n=void 0};n.readAsDataURL(e)}else a=LayerWin._dext_editor._config.image_convert_width,g=LayerWin._dext_editor._config.image_convert_height,"1"==LayerWin._dext_editor._config.imageAutoConvert&&(g=a="0"),h=document.getElementById("original_image_width"),
m=document.getElementById("original_image_height"),"0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util._fn_$mEPF(f),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(getBoundrayRanNumber()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.toSavePathURL),
document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util._fn_$mEPF(a),document.getElementById("image_convert_height").value=
DEXTTOP.DEXT5.util._fn_$mEPF(g),G_OriginalMultiImageSize[k]&&(h.value=G_OriginalMultiImageSize[k].width,m.value=G_OriginalMultiImageSize[k].height),document.getElementById("original_image_width").value=DEXTTOP.DEXT5.util._fn_$mEPF(h.value+""),document.getElementById("original_image_height").value=DEXTTOP.DEXT5.util._fn_$mEPF(m.value+""),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin.getUploadOriginalFileName(k,
LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=f,document.getElementById("savefilename").value=getBoundrayRanNumber(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,
document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=a,document.getElementById("image_convert_height").value=g,G_OriginalMultiImageSize[k]&&(h.value=G_OriginalMultiImageSize[k].width,m.value=G_OriginalMultiImageSize[k].height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(k,LayerWin._dext_editor._config))),"1"==
LayerWin._dext_editor._config.uploadUseHTML5?(b=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&b.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),b.setItem("document_domain",document.getElementById("document_domain").value),b.setItem("proxy_url",document.getElementById("proxy_url").value),b.setItem("uploadtype",document.getElementById("uploadtype").value),b.setItem("savefilename",document.getElementById("savefilename").value),b.setItem("savefileext",
document.getElementById("savefileext").value),b.setItem("serverdomain",document.getElementById("serverdomain").value),b.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),b.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),b.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),b.setItem("image_convert_format",document.getElementById("image_convert_format").value),b.setItem("image_convert_width",document.getElementById("image_convert_width").value),
b.setItem("image_convert_height",document.getElementById("image_convert_height").value),b.setItem("cd",document.getElementById("cd").value),b.setItem("original_image_width",document.getElementById("original_image_width").value),b.setItem("original_image_height",document.getElementById("original_image_height").value),document.getElementById("originalfilename").value&&b.setItem("originalfilename",document.getElementById("originalfilename").value),addParamHashTable(b),b.setItem(LayerWin._dext_editor._config.userFieldID,
document.getElementById(LayerWin._dext_editor._config.userFieldID).value),uploadAjaxOnprogressStart({uploadType:"image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:c.id,fileObj:G_dragDropFileObj[e.uploadData.fileIdx],formData:b},event_dext_image_upload_completed)):(b.action=document.getElementById("upload_url").value,b.submit())}else""==k?alert(LayerWin.dext5_lang.msg.alert_no_file):alert(LayerWin.dext5_lang.msg.alert_exec);else k=d.value,h=new RegExp(/^(http|ftp|https|news)/),m=h.test(k),
h=/^\s\s*$/,""==k||h.exec(k)||m&&!LayerWin.urlCheckOrPass(k)?(alert(LayerWin.dext5_lang.msg.alert_url),d.focus()):(G_dragDropFileObj=null,LayerWin.executeDomainCheckForNewInsertFileByUrlProcess({editor:LayerWin._dext_editor,targetUrl:k,finalCallBackFn:function(a){a?(a=LayerWin.setMessageForMaxTotalFileSize(LayerWin._dext_editor),alert(a),d.focus()):event_dext_image_upload_completed(k)}}))}
function event_dext_image_link(){var a=document.getElementById("img_web_url").value,e=document.getElementById("img_width").value,b=document.getElementById("img_height").value,c=document.getElementById("img_alt").value,d=document.getElementById("img_title").value,f=document.getElementById("img_v_space").value,g=document.getElementById("img_h_space").value,h=document.getElementById("img_align"),h=h.options[h.selectedIndex].value,m="";document.getElementById("img_border")&&(m=document.getElementById("img_border").value);
var k=document.getElementById("link_url").value,n=document.getElementById("link_title").value,p=document.getElementById("link_target").value;LayerWin.event_dext_image_upload("","","","0",a,0,0,c,"",{srcURL:a,width:e,height:b,title:d,alt:c,vspace:f,hspace:g,align:h,border:m,linkurl:k,linktitle:n,linktarget:p},window.frameElement.parentNode.parentNode)}
function event_dext_image_upload_completed(a,e){a&&(a=a.replace(/<.*?script.*\/?>/g,""));var b=!1;document.getElementsByName("InputFlag")[1]&&(b=document.getElementsByName("InputFlag")[1].checked);"base64"!=LayerWin._dext_editor._config.uploadMethod&&a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));var c=document.getElementById("img_width").value,d=document.getElementById("img_height").value;if(!b){var f=0,g=0,h=document.getElementById("img_width_unit"),
m=!1;h&&"%"==h.value&&(m=!0);if(null!=a&&void 0!=a){try{var k;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?k=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&(k=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a));null!=k&&void 0!=k&&(a=k)}catch(n){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var p=[];"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&
(p=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<p.length&&(a=p[0]));h=a.split("?");if(2==h.length){a=h[0];var q=h[1].split("^");1==q.length?a+="?"+q[0]:2==q.length?(f=q[0],g=q[1]):3==q.length&&(f=q[0],g=q[1],a+="?"+q[2])}else""==c||m||(f=c),""==d||m||(g=d);"1"==LayerWin._dext_editor._config.imageSizeToServer&&(0<f&&(c=f),0<g&&(d=g));if(elemModify&&"img"==elemModify.tagName.toLowerCase()){"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))?
(elemModify.src=LayerWin._dext_editor._config.webPath.image+"dialog/image_xbox.jpg",b=a.indexOf("HTTP Error"),p=a.indexOf("HTTP Status"),-1<b?elemModify.setAttribute("alt",a.substring(b,errorIdx+16).replace(/"/g,"'")):-1<p&&elemModify.setAttribute("alt",a.substring(p,errorIdx+15).replace(/"/g,"'"))):"[FAIL]"==a.substring(0,6)?(elemModify.src=LayerWin._dext_editor._config.webPath.image+"dialog/image_xbox.jpg",elemModify.setAttribute("alt",a.substring(6,a.length).replace(/"/g,"'"))):elemModify.src=
a;"function"==typeof G_UploadCompleteCallBackFn&&G_UploadCompleteCallBackFn();try{LayerWin.contentChangeEventWrapper()}catch(r){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return}h=!1;document.getElementById("original_size")&&(h=document.getElementById("original_size").checked);if(!h){h=LayerWin.getWidthForAutoBodyFit(LayerWin._dext_editor,"img");k=!1;if(m){var u=DEXTTOP.DEXT5.util.getEditSpacePx(DEXTTOP.G_CURREDITOR);""==c&&(c=q[0]);f=Math.round(u*c/100);c=Math.round(c/u*1E4)/100;q=
LayerWin._dext_editor._config.imgDefaultWidth;u=DEXTTOP.DEXT5.util.parseFloatOr0(q);-1<q.indexOf("%")&&0!=u&&u<c&&(c=u);"2"==LayerWin._dext_editor._config.image_auto_fit&&f>h&&(k=!0)}if("1"==LayerWin._dext_editor._config.imageAutoConvert){h=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(LayerWin._dext_editor._config.image_convert_width);q=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(LayerWin._dext_editor._config.image_convert_height);u=k=!1;f=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(f);g=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(g);
if(0!=h&&0==q)f>=h&&(k=!0);else if(0==h&&0!=q)g>=q&&(u=!0);else{var t=1*h/f,z=1*q/g;t<z?1>t&&(k=!0):1>z&&(u=!0)}k?(k=h/f,f=h,g=DEXTTOP.DEXT5.util.parseIntOr0(k*g),c=f,d=g):u&&(k=q/g,g=q,c=f=DEXTTOP.DEXT5.util.parseIntOr0(k*f),d=g)}else"1"==LayerWin._dext_editor._config.image_auto_fit&&f>h||k?(k=h/f,f=h,g*=k,m?(h=c,c=f*c/100>=f?100:h):c>f&&(c=f,d=g)):"2"==LayerWin._dext_editor._config.image_auto_fit&&(f>h||g>LayerWin._dext_editor._defaultHeight)&&(c=LayerWin._dext_editor._defaultHeight,d=c/h,q=g/f,
q>d?g>c?(d=c,c=Math.round(f*d/g)):(c=f,d=g):q<d?f>h?(c=h,d=Math.round(g*c/f)):(c=f,d=g):(c=f,d=g))}}0==c.length&&0<f&&!m&&(c=parseInt(f),d=parseInt(g),g=f="",h=!1,document.getElementById("original_size")&&(h=document.getElementById("original_size").checked),document.getElementById("image_slider_flag")||(!h&&0>LayerWin._dext_editor._config.imgDefaultWidth.indexOf("%")&&(f=LayerWin._dext_editor._config.imgDefaultWidth,g=LayerWin._dext_editor._config.imgDefaultHeight),""!=f?DEXTTOP.DEXT5.util.parseIntOr0(c)>
DEXTTOP.DEXT5.util.parseIntOr0(f)&&(c=DEXTTOP.DEXT5.util.parseIntOr0(d,10)*DEXTTOP.DEXT5.util.parseIntOr0(f,10)/DEXTTOP.DEXT5.util.parseIntOr0(c,10),d=isNaN(c)?d:Math.round(c),c=DEXTTOP.DEXT5.util.parseIntOr0(f)):""!=g&&DEXTTOP.DEXT5.util.parseIntOr0(d)>DEXTTOP.DEXT5.util.parseIntOr0(g)&&(d=DEXTTOP.DEXT5.util.parseIntOr0(c,10)*DEXTTOP.DEXT5.util.parseIntOr0(g,10)/DEXTTOP.DEXT5.util.parseIntOr0(d,10),c=isNaN(d)?c:Math.round(d),d=DEXTTOP.DEXT5.util.parseIntOr0(g))));if("[FAIL]"==a.substring(0,6)||"1"!=
LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{var y,v=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.uploadData;if(v.isImageFileUpload&&LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.isMulti)v.errorFile.push({fileName:v.nowFileName,message:a,response:e.response});else if("function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError?y=DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:e.response}):
"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&(y=DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:e.response})),0==y)return}catch(A){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))){LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.uploadData.isUploaded=!0;LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.isMulti||(b=
!0,"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(b=confirm(LayerWin.dext5_lang.msg.uploadFailed)),b&&(b=a.indexOf("HTTP Error"),p=a.indexOf("HTTP Status"),-1<b?alert(a.substring(b,b+16)):-1<p&&alert(a.substring(p,p+15))));return}if(!b&&"[FAIL]"==a.substring(0,6)&&"base64"!=LayerWin._dext_editor._config.uploadMethod){LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.uploadData.isUploaded=!0;LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.isMulti||(b=!0,"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&
(b=confirm(LayerWin.dext5_lang.msg.uploadFailed)),b&&alert(a));return}}y=document.getElementById("savefilename").value;v=a;f="";"1"==LayerWin._dext_editor._config.autoInsertAlt&&(f=document.getElementById("img_alt").value);var z=document.getElementById("img_title").value,w="",C="",B="";try{w=document.getElementById("img_id").value,C=document.getElementById("img_class").value,B=document.getElementById("img_figure").checked}catch(l){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}g=document.getElementById("img_margin_left").value;
m=document.getElementById("img_margin_right").value;q=document.getElementById("img_margin_top").value;k=document.getElementById("img_margin_bottom").value;g="-"==g?"":g;m="-"==m?"":m;q="-"==q?"":q;k="-"==k?"":k;h=document.getElementById("img_align");u=h.options[h.selectedIndex].value;t="";document.getElementById("img_border")&&(t=document.getElementById("img_border").value);var x=!1;document.getElementById("continue_insert")&&(x=document.getElementById("continue_insert").checked);var E=document.getElementById("link_url").value;
if(null!=E&&void 0!=E&&""!=DEXTTOP.DEXT5.util.trim(E)){var D;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertHyperlink?D=DEXTTOP.G_CURREDITOR._config.event.beforeInsertHyperlink(DEXTTOP.G_CURREDITOR.ID,E):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_hyperlink_event&&(D=DEXTTOP.DEXTWIN.dext_editor_before_insert_hyperlink_event(DEXTTOP.G_CURREDITOR.ID,E))}catch(F){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}null!=D&&void 0!=D&&(E=document.getElementById("link_url").value=
D)}D=document.getElementById("link_title").value;var J=document.getElementById("link_target").value,H="",I="",K="",L="";document.getElementById("line_style")&&(H=document.getElementById("line_style").style.borderTopStyle,"none"!=H&&(I=document.getElementById("line_kind").value,K=document.getElementById("line_color").style.borderTopColor,L=document.getElementById("line_thickness").value));var G=!1;document.getElementById("image_spacing")&&(G=document.getElementById("image_spacing").checked);var Q=
"px",M="px",h=document.getElementById("img_width_unit"),N=document.getElementById("img_height_unit");h&&""!=h.value&&(Q=h.value);N&&""!=N.value&&(M=N.value);b={srcURL:a,width:c,height:d,title:z,id:w,className:C,figure:B,alt:f,margin_left:g,margin_right:m,margin_top:q,margin_bottom:k,align:u,border:t,linkurl:E,linktitle:D,linktarget:J,continueInsert:x,input_url_checked:b,img_attr_info_arr:p,input_url_checked:b,borderStyle:H,borderKind:I,borderColor:K,borderThickness:L,imageSpacing:G,widthUnit:Q,heightUnit:M};
p=""+("<img style='width:"+c+"px; height:"+d+"px;");0<q.length&&!isNaN(q)&&(p+=" margin-top:"+q+"px;");0<m.length&&!isNaN(m)&&(p+=" margin-right:"+m+"px;");0<k.length&&!isNaN(k)&&(p+=" margin-bottom:"+k+"px;");0<g.length&&!isNaN(g)&&(p+=" margin-left:"+g+"px;");p=p+" ' "+(" src='"+v+"'");p+=" alt='"+f+"'";0<u.length&&(p+=" align='"+u+"'");0<t.length&&!isNaN(t)&&(p+=" border='"+t+"'");p+=" />";0!=LayerWin._dext_editor._config.maxTotalFileSize&&null!=G_dragDropFileObj&&"0"==LayerWin._dext_editor._config.plugInUse&&
(D=LayerWin._dext_editor,D.addedTotalFileSize+=G_dragDropFileObj[0].size);LayerWin.event_dext_image_upload(y,"","","0",v,c,d,f,p,b,window.frameElement.parentNode.parentNode)}
function dext_upload_flash(){if(1==document.getElementById("cb_tag_insert").checked){var a=document.getElementById("ta_flash_tag").value,e=LayerWin.getDocumentForDummy().createElement("div");e.innerHTML=a;a=e.getElementsByTagName("EMBED")[0];if(null==a)alert(LayerWin.dext5_lang.flash.invalid_tag);else if(e=LayerWin.checkXssContentType(a.src,{editor:LayerWin._dext_editor}))alert(LayerWin.dext5_lang.msg.alert_insert_url_xss);else{var e=null,b=a.getAttribute("scale")?a.getAttribute("scale"):"",c=a.getAttribute("allowScriptAccess")?
a.getAttribute("allowScriptAccess"):"",d=a.getAttribute("quality")?a.getAttribute("quality"):"",f=a.getAttribute("align")?a.getAttribute("align"):"",g,h,m,k;g=null==a.getAttribute("menu")||void 0==a.getAttribute("menu")?!0:0==a.getAttribute("menu")||"false"==a.getAttribute("menu")?!1:!0;h=null==a.getAttribute("play")||void 0==a.getAttribute("play")?!0:0==a.getAttribute("play")||"false"==a.getAttribute("play")?!1:!0;m=null==a.getAttribute("loop")||void 0==a.getAttribute("loop")?!0:0==a.getAttribute("loop")||
"false"==a.getAttribute("loop")?!1:!0;null==a.getAttribute("allowFullScreen")||void 0==a.getAttribute("allowFullScreen")?k=!0:0==a.getAttribute("allowFullScreen")||"false"==a.getAttribute("allowFullScreen")?_allowFullScreenu=!1:k=!0;var n=a.getAttribute("flashvars")?a.getAttribute("flashvars"):"";"embed"==a.tagName.toLowerCase()&&(e={type:"flash",src:a.src,width:0==LayerWin.parseIntOr0(a.style.width)?LayerWin.parseIntOr0(a.width):LayerWin.parseIntOr0(a.style.width),height:0==LayerWin.parseIntOr0(a.style.height)?
LayerWin.parseIntOr0(a.height):LayerWin.parseIntOr0(a.style.height),hspace:LayerWin.parseIntOr0(a.getAttribute("hspace")),vspace:LayerWin.parseIntOr0(a.getAttribute("vspace")),scale:b,allowScriptAccess:c,quality:d,align:f,menu:g,play:h,loop:m,allowFullScreen:k,flashvars:n},k=LayerWin.getLinkMediaType(e.src),0<k.length&&(e.type=k,e.type2="flash"));LayerWin.event_dext_media_upload("","","","","","",e,window.frameElement.parentNode.parentNode)}}else{a=document.dext_upload_form;k="";k="1"==LayerWin._dext_editor._config.uploadUseHTML5?
document.getElementById("file_text"):document.getElementById(file_field_id);var p=document.getElementById("web_url"),q;if(document.getElementsByName("InputFlag")[0].checked)if(q=k.value,0<q.lastIndexOf(".")){e=q.substring(q.lastIndexOf(".")+1).toLowerCase();b=!1;c=LayerWin._dext_editor._config.allowFlashFileType;d=c.toString()+LayerWin.dext5_lang.msg.alert_exec_tail;for(f=0;f<c.length;f++)if(e==c[f]){b=!0;break}1==b?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=
DEXTTOP.DEXT5.util._fn_$mEPF(e),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(getBoundrayRanNumber()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util._fn_$mEPF(""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),document.getElementById("savafoldernamerule").value=
DEXTTOP.DEXT5.util._fn_$mEPF(""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin.getUploadOriginalFileName(q,LayerWin._dext_editor._config)))):
(document.getElementById("savefileext").value=e,document.getElementById("savefilename").value=getBoundrayRanNumber(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?
LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(q,LayerWin._dext_editor._config))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&
a.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",
document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&a.setItem("originalfilename",document.getElementById("originalfilename").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),
addParamHashTable(a),uploadAjaxOnprogressStart({uploadType:"flash",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:k.name,fileObj:G_dragDropFileObj,formData:a},event_dext_flash_upload_completed)):(a.action=document.getElementById("upload_url").value,a.submit())):alert(d)}else""==q?alert(LayerWin.dext5_lang.msg.alert_no_file):alert(LayerWin.dext5_lang.msg.alert_exec);else q=p.value,(e=LayerWin.checkXssContentType(q,{editor:LayerWin._dext_editor}))?(alert(LayerWin.dext5_lang.msg.alert_insert_url_xss),
setCursorPos(p,!0,!1)):(k=(new RegExp(/^(http|ftp|https|news)/)).test(q),a=/^\s\s*$/,""==q||a.exec(q)||k&&!LayerWin.urlCheckOrPass(q)?(alert(LayerWin.dext5_lang.msg.alert_url),p.focus()):LayerWin.executeDomainCheckForNewInsertFileByUrlProcess({editor:LayerWin._dext_editor,targetUrl:q,finalCallBackFn:function(a){a?(a=LayerWin.setMessageForMaxTotalFileSize(LayerWin._dext_editor),alert(a),p.focus()):event_dext_flash_upload_completed(q)}}))}}
function dext_upload_flash_byFlash(){if(1==document.getElementById("cb_tag_insert").checked){var a=document.getElementById("ta_flash_tag").value;DEXTTOP.event_dext_media_upload("","","","","",a)}else{a=document.dext_upload_form;document.getElementById(file_field_id);var e=document.getElementById("web_url"),e=document.getElementsByName("InputFlag")[0].checked?"dext.swf":e.value;if(0<e.lastIndexOf(".")){for(var b=e.substring(e.lastIndexOf(".")+1).toLowerCase(),c=!1,d=LayerWin._dext_editor._config.allowFlashFileType,
f=d.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,g=0;g<d.length;g++)if(b==d[g]){c=!0;break}1==c?document.getElementsByName("InputFlag")[0].checked?(document.getElementById("savefileext").value=b,document.getElementById("savefilename").value=getBoundrayRanNumber(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:
LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,a.action=document.getElementById("upload_url").value,document.getElementById("dext_flash_uploader").dext_upload()):event_dext_flash_upload_completed(e):
alert(f)}else alert(LayerWin.dext5_lang.msg.alert_exec)}}
function event_dext_flash_upload_completed(a,e){a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));var b=[];if(document.getElementsByName("InputFlag")[0].checked){if(null!=a&&void 0!=a){try{var c;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?c=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&(c=
DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a));null!=c&&void 0!=c&&(a=c)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}b=[];"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(b=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<b.length&&(a=b[0]));c=a.split("?");2==c.length&&-1<c[1].indexOf("^")&&(a=c[0],c=c[1].split("^"),1==c.length?a+="?"+c[0]:3==c.length&&(a+="?"+c[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,
6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{var f;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError?f=DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"flashUpload",message:a,response:e.response}):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&(f=DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"flashUpload",message:a,response:e.response}));if(0==f)return}catch(g){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))){b=!0;"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(b=confirm(LayerWin.dext5_lang.msg.uploadFailed));b&&(b=a.indexOf("HTTP Error"),f=a.indexOf("HTTP Status"),-1<b?alert(a.substring(b,b+16)):-1<f&&alert(a.substring(f,f+15)));return}if("[FAIL]"==a.substring(0,6)){b=!0;"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&
(b=confirm(LayerWin.dext5_lang.msg.uploadFailed));b&&alert(a);return}if(elemModify){elemData.src=a;"function"==typeof G_UploadCompleteCallBackFn&&(G_UploadCompleteCallBackFn(),LayerWin.hideDialog(window.frameElement.parentNode.parentNode));return}}f=document.getElementById("savefilename").value;var h=document.getElementById("flash_width").value,m=document.getElementById("flash_height").value;c=document.getElementById("flash_margin_left").value;var k=document.getElementById("flash_margin_right").value,
n=document.getElementById("flash_margin_top").value,p=document.getElementById("flash_margin_bottom").value,q=document.getElementById("flash_scale").value,r=document.getElementById("flash_allowScriptAccess").value,u=document.getElementById("flash_quality").value,t=document.getElementById("flash_menu").checked,z=document.getElementById("flash_play").checked,y=document.getElementById("flash_loop").checked,v=document.getElementById("flash_allowFullScreen").checked,A=document.getElementById("flash_width_unit"),
w=document.getElementById("flash_height_unit"),A=0==LayerWin.parseIntOr0(h)?"":h+A.value,w=0==LayerWin.parseIntOr0(m)?"":m+w.value;LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,a);b={type:"flash",src:a,width:A,height:w,margin_left:c,margin_right:k,margin_top:n,margin_bottom:p,scale:q,allowScriptAccess:r,quality:u,img_attr_info_arr:b,menu:t,play:z,loop:y,allowFullScreen:v};h=""+("<embed style='width:"+h+"px; height:"+m+"px; ");""!=c&&(h+="margin-left:"+c+"; ");""!=k&&(h+="margin-right:"+k+"; ");
""!=n&&(h+="margin-top:"+n+"; ");""!=p&&(h+="margin-bottom:"+p+"; ");h=h+"'"+("src='"+a+"'");""!=q&&(h+="scale='"+q+"'");""!=r&&(h+="allowScriptAccess='"+r+"'");""!=u&&(h+="quality='"+u+"'");0==t&&(h+="menu='false'");0==z&&(h+="play='false'");0==y&&(h+="loop='false'");0==v&&(h+="allowFullScreen='false'");h+='wmode="transparent"';h+=" pluginspage='http://www.macromedia.com/go/getflashplayer' type='application/x-shockwave-flash' />";LayerWin.event_dext_media_upload(f,"","","",a,h,b,window.frameElement.parentNode.parentNode)}
function dext_upload_media(){var a=document.dext_upload_form,e="",e="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),b,c=document.getElementById("web_url");if(document.getElementsByName("InputFlag")[0].checked)if(b=e.value,0<b.lastIndexOf(".")){var d=b.substring(b.lastIndexOf(".")+1).toLowerCase();"0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util._fn_$mEPF(d),
document.getElementById("savefilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(getBoundrayRanNumber()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util._fn_$mEPF(""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(""==
LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=
d,document.getElementById("savefilename").value=getBoundrayRanNumber(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:
LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)));loading_image_show(!0);"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),
a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",
document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&a.setItem("originalfilename",document.getElementById("originalfilename").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(a),uploadAjaxOnprogressStart({uploadType:"media",
handlerUrl:LayerWin._dext_editor._config.post_url,fileID:e.name,fileObj:G_dragDropFileObj,formData:a},event_dext_media_upload_completed)):(a.action=document.getElementById("upload_url").value,a.submit())}else""==b?alert(LayerWin.dext5_lang.msg.alert_no_file):alert(LayerWin.dext5_lang.msg.alert_exec);else b=c.value,e=new RegExp(/(http|https|mms):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/),a=(new RegExp(/^(http|https|mms)/)).test(b),d=/^\s\s*$/,LayerWin.checkXssContentType(b,
{editor:LayerWin._dext_editor})?(alert(LayerWin.dext5_lang.msg.alert_insert_url_xss),setCursorPos(c,!0,!1)):""==b||d.exec(b)||a&&!e.test(b)?(alert(LayerWin.dext5_lang.msg.alert_url),c.focus()):LayerWin.executeDomainCheckForNewInsertFileByUrlProcess({editor:LayerWin._dext_editor,targetUrl:b,finalCallBackFn:function(a){a?(a=LayerWin.setMessageForMaxTotalFileSize(LayerWin._dext_editor),alert(a),c.focus()):event_dext_media_upload_completed(b)}})}
function event_dext_flash_flash_upload_completed(a,e,b){LayerWin.event_dext_media_upload(a,"","","0",e,b,{type:"flash",src:e,width:300,height:300,hspace:"",vspace:"",scale:"",allowScriptAccess:"",quality:"",align:"",menu:"",play:"",loop:"",allowFullScreen:""},window.frameElement.parentNode.parentNode)}
function event_dext_flash_media_upload_completed(a,e,b){LayerWin.event_dext_media_upload(a,"","","0",e,b,{type:"media",src:e,width:300,height:300,autoStart:!1,playCount:!1,showTracker:!1,showStatusBar:!1,showControls:!1,showAudioControls:!1,showDisplay:!1,showPositionControls:!1},window.frameElement.parentNode.parentNode)}
function event_dext_media_upload_completed(a,e){null!=a&&void 0!=a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));d=[];if(document.getElementsByName("InputFlag")[0].checked){if(null!=a&&void 0!=a){try{var b;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?b=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&
(b=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a));null!=b&&void 0!=b&&(a=b)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var d=[];"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(d=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<d.length&&(a=d[0]));b=a.split("?");2==b.length&&-1<b[1].indexOf("^")&&(a=b[0],b=b[1].split("^"),1==b.length?a+="?"+b[0]:3==b.length&&(a+="?"+b[2]))}loading_image_show(!1);if("[FAIL]"==
a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{var f;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError?f=DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:a,response:e.response}):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&(f=DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:a,response:e.response}));
if(0==f)return}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))){d=!0;"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(d=confirm(LayerWin.dext5_lang.msg.uploadFailed));d&&(d=a.indexOf("HTTP Error"),f=a.indexOf("HTTP Status"),-1<d?alert(a.substring(d,d+16)):-1<f&&alert(a.substring(f,f+15)));return}if("[FAIL]"==a.substring(0,6)){d=!0;"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&
(d=confirm(LayerWin.dext5_lang.msg.uploadFailed));d&&alert(a);return}if(elemModify){elemData.src=a;"function"==typeof G_UploadCompleteCallBackFn&&(G_UploadCompleteCallBackFn(),LayerWin.hideDialog(window.frameElement.parentNode.parentNode));return}}f=document.getElementById("savefilename").value;b=document.getElementById("media_width").value;var h=document.getElementById("media_height").value,m=document.getElementById("media_width_unit"),k=document.getElementById("media_height_unit"),m=0==LayerWin.parseIntOr0(b)?
"":b+m.value,k=0==LayerWin.parseIntOr0(h)?"":h+k.value;LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,a);d={type:"media",src:a,width:m,height:k,autoStart:document.getElementById("cb_autostart").checked,playCount:document.getElementById("cb_loop").checked,showTracker:document.getElementById("cb_tracker").checked,showStatusBar:document.getElementById("cb_status").checked,showControls:document.getElementById("cb_controls").checked,showAudioControls:document.getElementById("cb_volumn").checked,showDisplay:document.getElementById("cb_display").checked,
showPositionControls:document.getElementById("cb_position").checked,img_attr_info_arr:d};k="";b=""+("<embed style='width:"+b+"px; height:"+h+"px;' ")+" type=application/x-mplayer2 ";b+=" pluginspage='http://www.microsoft.com/windows/windowsmedia/download/' ";b+=" src='"+a+"'";k=1==document.getElementById("cb_autostart").checked?"1":"0";b+=" AutoStart='"+k+"'";k=1==document.getElementById("cb_loop").checked?"1":"0";b+=" loop='"+k+"'";k=1==document.getElementById("cb_tracker").checked?"1":"0";b+=" ShowTracker='"+
k+"'";k=1==document.getElementById("cb_status").checked?"1":"0";b+=" ShowStatusBar='"+k+"'";k=1==document.getElementById("cb_controls").checked?"1":"0";b+=" ShowControls='"+k+"'";k=1==document.getElementById("cb_volumn").checked?"1":"0";b+=" ShowAudioControls='"+k+"'";k=1==document.getElementById("cb_display").checked?"1":"0";b+=" ShowDisplay='"+k+"'";k=1==document.getElementById("cb_position").checked?"1":"0";b+=" ShowPositionControls='"+k+"'";b+=" />";LayerWin.event_dext_media_upload(f,"","","0",
a,b,d,window.frameElement.parentNode.parentNode)}
function dext_detail_table_upload_image(){"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&LayerWin.closeBtnPreViewMode();var a=document.getElementById("tab_value").value,e=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==e||-1<e.indexOf("table_caption")||-1<e.indexOf("table_summary")||-1<e.indexOf("table_scope")){var b=LayerWin._dext_editor._config.accessibility,
c=document.getElementById("table_caption").value,d=document.getElementById("table_summary").value,f="N";1==document.getElementById("scope").checked&&(f="Y");var g="N";1==document.getElementById("t_scope").checked&&(g="Y");var h=document.getElementById("title_cell").value;if("1"==b)"3"!=a&&"4"!=a?((""==e||-1<e.indexOf("table_caption"))&&""==c&&alert(LayerWin.dext5_lang.msg.alert_table_caption_access1),(""==e||-1<e.indexOf("table_summary"))&&""==d&&alert(LayerWin.dext5_lang.msg.alert_table_summary_access1),
(""==e||-1<e.indexOf("table_scope"))&&"1"!=h&&"N"==f&&alert(LayerWin.dext5_lang.msg.alert_scope_access1)):"3"==a&&(""==e||-1<e.indexOf("table_scope"))&&"N"==g&&alert(LayerWin.dext5_lang.msg.alert_scope_access1);else if("2"==b)if("3"!=a&&"4"!=a){if((""==e||-1<e.indexOf("table_caption"))&&""==c){alert(LayerWin.dext5_lang.msg.alert_table_caption_access2);document.getElementById("table_caption").focus();return}if((""==e||-1<e.indexOf("table_summary"))&&""==d){alert(LayerWin.dext5_lang.msg.alert_table_summary_access2);
document.getElementById("table_summary").focus();return}if((""==e||-1<e.indexOf("table_scope"))&&"1"!=h&&"N"==f){alert(LayerWin.dext5_lang.msg.alert_scope_access2);document.getElementById("scope").focus();return}}else if("3"==a&&(""==e||-1<e.indexOf("table_scope"))&&"N"==g){alert(LayerWin.dext5_lang.msg.alert_scope_access2);document.getElementById("t_scope").focus();return}}c=document.dext_upload_form;e="";e="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id);
b="";e&&(b=e.value);d=b.lastIndexOf(".");"3"!=a&&"4"!=a&&0<d?(a=b.substring(b.lastIndexOf(".")+1).toLowerCase(),"0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util._fn_$mEPF(a),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(getBoundrayRanNumber()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=
DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=
DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config))),G_OriginalMultiImageSize[b]&&(G_OriginalMultiImageSize[b].width=DEXTTOP.DEXT5.util._fn_$mEPF(G_OriginalMultiImageSize[b].width+
""),G_OriginalMultiImageSize[b].height=DEXTTOP.DEXT5.util._fn_$mEPF(G_OriginalMultiImageSize[b].height+""))):(document.getElementById("savefileext").value=a,document.getElementById("savefilename").value=getBoundrayRanNumber(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,
document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=
LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),
a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("image_convert_format",document.getElementById("image_convert_format").value),
a.setItem("image_convert_width",document.getElementById("image_convert_width").value),a.setItem("image_convert_height",document.getElementById("image_convert_height").value),a.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&a.setItem("originalfilename",document.getElementById("originalfilename").value),G_OriginalMultiImageSize[b]&&(a.setItem("original_image_width",G_OriginalMultiImageSize[b].width),a.setItem("original_image_height",G_OriginalMultiImageSize[b].height)),
a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(a),uploadAjaxOnprogressStart({uploadType:"table_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:e.name,fileObj:G_dragDropFileObj,formData:a},event_dext_detail_table_completed)):(c.action=document.getElementById("upload_url").value,c.submit())):""==b||"3"==a||"4"==a?event_dext_detail_table_completed(document.getElementById("image_url_value").value):
alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_detail_table_completed(a,e){null!=a&&void 0!=a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));var b=[],c={maj:3,l:26,mi1:"3",mi2:"0"};if(LayerWin.G_dext5plugIn&&LayerWin.DEXTTOP.DEXT5.util.getRV(LayerWin.DEXTTOP.G_CURREDITOR._config.pv)>=LayerWin.DEXTTOP.DEXT5.util.makeCRV(c))a=a.replace(/\s/g,"%20"),a=a.replace(/\'/g,"%27"),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29");else if(null!=a&&void 0!=
a){try{if(0<a.toString().length){var d;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?d=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&(d=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a));null!=d&&void 0!=d&&(a=d)}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}b=[];"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&
(b=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<b.length&&(a=b[0]));c=a.split("?");2==c.length&&(a=c[0],c=c[1].split("^"),1==c.length?a+="?"+c[0]:3==c.length&&(a+="?"+c[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{var g;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError?g=DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,
{type:"imageUpload",message:a,response:e.response}):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&(g=DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:e.response}));if(0==g)return}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}g=document.getElementById("tab_value").value;c=document.getElementById("width_line").value;d=document.getElementById("height_line").value;var m=document.getElementById("width").value,
k="px";document.getElementById("width_type")&&""!=document.getElementById("width_type").value&&(k=document.getElementById("width_type").value);var n=document.getElementById("height").value,p="";1==document.getElementById("table_edge_reduce").checked?p="Y":0==document.getElementById("table_edge_reduce").checked&&(p="N");var q=document.getElementById("range").value,r=document.getElementById("topcell1"),u=document.getElementById("topcell2"),t=document.getElementById("bottomcell1");document.getElementById("bottomcell2");
var z={outsideTop:"",outsideLeft:"",outsideRight:"",outsideBottom:"",insideRow:"",insideCol:""};z.outsideTop=r.style.borderTop;z.outsideLeft=r.style.borderLeft;z.outsideRight=u?u.style.borderRight:r.style.borderRight;z.outsideBottom=t?t.style.borderBottom:r.style.borderBottom;t&&(z.insideRow=t.style.borderTop);u&&(z.insideCol=r.style.borderRight);var r=document.getElementById("cell_gap").value,u=document.getElementById("cell_inside_margin").value,t=document.getElementById("table_caption").value,y=
document.getElementById("table_summary").value,v=document.getElementById("caption_display").checked,A=document.getElementById("add").value,w=document.getElementById("repeat").value,C=document.getElementById("horizontal").value,B=document.getElementById("vertical").value,l=document.getElementById("background_color").style.backgroundColor,x="N";1==document.getElementById("scope").checked&&(x="Y");var E=document.getElementById("title_cell").value,D=document.getElementById("t_width_line").value,F=document.getElementById("t_height_line").value,
J=document.getElementById("t_width").value,H=document.getElementById("t_height").value,I="N";1==document.getElementById("t_scope").checked&&(I="Y");var K=document.getElementById("templet").value,L=LayerWin.parseIntOr0(document.getElementById("margin_left").value),G=document.getElementById("class_name").value,Q=document.getElementById("table_id").value;"none"==document.getElementById("class_name").style.display&&(G=null);var M=!1;document.getElementById("input_cell_include")&&document.getElementById("input_cell_include").checked&&
(M=!0);var N=document.getElementById("custom_templet").value;LayerWin.event_dext_detail_table_insert(g,c,d,m,n,p,q,z,r,u,t,y,a,A,w,C,B,l,x,E,D,F,J,H,I,K,L,window.frameElement.parentNode.parentNode,G,Q,M,N,gXmlData,b,k,{captionDisplay:v})}
function dext_table_property_upload_image(){"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&LayerWin.closeBtnPreViewMode();var a=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==a||-1<a.indexOf("table_caption")||-1<a.indexOf("table_summary")||-1<a.indexOf("table_scope")){var e=LayerWin._dext_editor._config.accessibility,b=document.getElementById("table_caption").value,
c=document.getElementById("table_summary").value,d="N";1==document.getElementById("scope").checked&&(d="Y");var f=document.getElementById("title_cell").value;if("1"==e)(""==a||-1<a.indexOf("table_caption"))&&""==b&&alert(LayerWin.dext5_lang.msg.alert_table_caption_access1),(""==a||-1<a.indexOf("table_summary"))&&""==c&&alert(LayerWin.dext5_lang.msg.alert_table_summary_access1),(""==a||-1<a.indexOf("table_scope"))&&"1"!=f&&"N"==d&&alert(LayerWin.dext5_lang.msg.alert_scope_access1);else if("2"==e){if((""==
a||-1<a.indexOf("table_caption"))&&""==b){alert(LayerWin.dext5_lang.msg.alert_table_caption_access2);document.getElementById("table_caption").focus();return}if((""==a||-1<a.indexOf("table_summary"))&&""==c){alert(LayerWin.dext5_lang.msg.alert_table_summary_access2);document.getElementById("table_summary").focus();return}if((""==a||-1<a.indexOf("table_scope"))&&"1"!=f&&"N"==d){alert(LayerWin.dext5_lang.msg.alert_scope_access2);document.getElementById("scope").focus();return}}}b=document.dext_upload_form;
a="";a="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id);e="";a&&(e=a.value);0<e.lastIndexOf(".")?(c=e.substring(e.lastIndexOf(".")+1).toLowerCase(),"0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util._fn_$mEPF(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(getBoundrayRanNumber()),document.getElementById("serverdomain").value=
DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=
DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin.getUploadOriginalFileName(e,
LayerWin._dext_editor._config))),G_OriginalMultiImageSize[e]&&(G_OriginalMultiImageSize[e].width=DEXTTOP.DEXT5.util._fn_$mEPF(G_OriginalMultiImageSize[e].width+""),G_OriginalMultiImageSize[e].height=DEXTTOP.DEXT5.util._fn_$mEPF(G_OriginalMultiImageSize[e].height+""))):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=getBoundrayRanNumber(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=
LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=
LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(e,LayerWin._dext_editor._config))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(b=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&b.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),b.setItem("document_domain",document.getElementById("document_domain").value),
b.setItem("proxy_url",document.getElementById("proxy_url").value),b.setItem("uploadtype",document.getElementById("uploadtype").value),b.setItem("savefilename",document.getElementById("savefilename").value),b.setItem("savefileext",document.getElementById("savefileext").value),b.setItem("serverdomain",document.getElementById("serverdomain").value),b.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),b.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),
b.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),b.setItem("image_convert_format",document.getElementById("image_convert_format").value),b.setItem("image_convert_width",document.getElementById("image_convert_width").value),b.setItem("image_convert_height",document.getElementById("image_convert_height").value),b.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&b.setItem("originalfilename",document.getElementById("originalfilename").value),
G_OriginalMultiImageSize[e]&&(b.setItem("original_image_width",G_OriginalMultiImageSize[e].width),b.setItem("original_image_height",G_OriginalMultiImageSize[e].height)),b.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(b),uploadAjaxOnprogressStart({uploadType:"p_table_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:a.name,fileObj:G_dragDropFileObj,formData:b},event_dext_table_property_completed)):
(b.action=document.getElementById("upload_url").value,b.submit())):""==e?(event_dext_table_property_completed(document.getElementById("image_url_value").value),null!=DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag=!1,DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,!0))):alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_table_property_completed(a,e){null!=a&&void 0!=a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));var b=[],c={maj:3,l:26,mi1:"3",mi2:"0"};if(LayerWin.G_dext5plugIn&&LayerWin.DEXTTOP.DEXT5.util.getRV(LayerWin.DEXTTOP.G_CURREDITOR._config.pv)>=LayerWin.DEXTTOP.DEXT5.util.makeCRV(c))a=a.replace(/\s/g,"%20"),a=a.replace(/\'/g,"%27"),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29");else if(_init_image_url!=
a&&null!=a&&void 0!=a){try{var d;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?d=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&(d=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a));null!=d&&void 0!=d&&(a=d)}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}b=[];"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&
(b=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<b.length&&(a=b[0]));c=a.split("?");2==c.length&&(a=c[0],c=c[1].split("^"),1==c.length?a+="?"+c[0]:3==c.length&&(a+="?"+c[2]));"[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))||LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,a)}loading_image_show(!1);if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||
-1<a.indexOf("HTTP Status")))try{var g;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError?g=DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:e.response}):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&(g=DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:e.response}));if(0==g)return}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}g=document.getElementById("width").value;
c="px";document.getElementById("width_type")&&""!=document.getElementById("width_type").value&&(c=document.getElementById("width_type").value);d=document.getElementById("height").value;var m="";1==document.getElementById("table_edge_reduce").checked?m="Y":0==document.getElementById("table_edge_reduce").checked&&(m="N");var k=document.getElementById("range").value,n=LayerWin.parseIntOr0(document.getElementById("margin_left").value),p=document.getElementById("topcell1"),q=document.getElementById("topcell2"),
r=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var u={outsideTop:{style:"",width:"",color:""},outsideLeft:{style:"",width:"",color:""},outsideRight:{style:"",width:"",color:""},outsideBottom:{style:"",width:"",color:""},insideRow:{style:"",width:"",color:""},insideCol:{style:"",width:"",color:""}};u.outsideTop.style=p.style.borderTopStyle;u.outsideTop.width=p.style.borderTopWidth;u.outsideTop.color=p.style.borderTopColor;u.outsideLeft.style=p.style.borderLeftStyle;
u.outsideLeft.width=p.style.borderLeftWidth;u.outsideLeft.color=p.style.borderLeftColor;q?(u.outsideRight.style=q.style.borderRightStyle,u.outsideRight.width=q.style.borderRightWidth,u.outsideRight.color=q.style.borderRightColor):(u.outsideRight.style=p.style.borderRightStyle,u.outsideRight.width=p.style.borderRightWidth,u.outsideRight.color=p.style.borderRightColor);r?(u.outsideBottom.style=r.style.borderBottomStyle,u.outsideBottom.width=r.style.borderBottomWidth,u.outsideBottom.color=r.style.borderBottomColor):
(u.outsideBottom.style=p.style.borderBottomStyle,u.outsideBottom.width=p.style.borderBottomWidth,u.outsideBottom.color=p.style.borderBottomColor);r&&(u.insideRow.style=r.style.borderTopStyle,u.insideRow.width=r.style.borderTopWidth,u.insideRow.color=r.style.borderTopColor);q&&(u.insideCol.style=p.style.borderRightStyle,u.insideCol.width=p.style.borderRightWidth,u.insideCol.color=p.style.borderRightColor);var p=document.getElementById("cell_gap").value,q=document.getElementById("cell_inside_margin").value,
r=document.getElementById("table_caption").value,t=document.getElementById("table_summary").value,z=document.getElementById("caption_display").checked,y=document.getElementById("prev_background_remove").value,v=document.getElementById("add").value,A=document.getElementById("repeat").value,w=document.getElementById("horizontal").value,C=document.getElementById("vertical").value,B=document.getElementById("background_color").style.backgroundColor,l="N";1==document.getElementById("scope").checked&&(l=
"Y");var x=document.getElementById("title_cell").value,E=document.getElementById("table_id").value,D=document.getElementById("class_name").value;"none"==document.getElementById("class_name").style.display&&(D=null);var F=!1;document.getElementById("input_cell_include")&&document.getElementById("input_cell_include").checked&&(F=!0);LayerWin.event_dext_table_property(g,d,m,k,u,p,q,r,t,y,a,v,A,w,C,B,l,x,n,window.frameElement.parentNode.parentNode,D,E,F,b,c,{cellPaddingMode:window.G_CELLPADDINGMODE,captionDisplay:z})}
function dext_cell_property_upload_image(){"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&LayerWin.closeBtnPreViewMode();var a=LayerWin._dext_editor._config.accessibility,e="";if("Y"==document.getElementById("title_cell").value||"N"==document.getElementById("title_cell").value)e=document.getElementById("title_cell").value;var b="";if("row"==document.getElementById("scope").value||
"col"==document.getElementById("scope").value)b="row";if("1"==a)"Y"==e&&""==b&&alert(LayerWin.dext5_lang.msg.alert_scope_access1);else if("2"==a&&"Y"==e&&""==b){alert(LayerWin.dext5_lang.msg.alert_scope_access2);document.getElementById("scope").focus();return}b=document.dext_upload_form;a="";a="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id);e="";a&&(e=a.value);if(0<e.lastIndexOf(".")){var c=e.substring(e.lastIndexOf(".")+
1).toLowerCase();"0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util._fn_$mEPF(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(getBoundrayRanNumber()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=
DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=
DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin.getUploadOriginalFileName(e,LayerWin._dext_editor._config))),G_OriginalMultiImageSize[e]&&(G_OriginalMultiImageSize[e].width=DEXTTOP.DEXT5.util._fn_$mEPF(G_OriginalMultiImageSize[e].width+""),G_OriginalMultiImageSize[e].height=DEXTTOP.DEXT5.util._fn_$mEPF(G_OriginalMultiImageSize[e].height+
""))):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=getBoundrayRanNumber(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,
document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(e,LayerWin._dext_editor._config)));loading_image_show(!0);
"1"==LayerWin._dext_editor._config.uploadUseHTML5?(b=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&b.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),b.setItem("document_domain",document.getElementById("document_domain").value),b.setItem("proxy_url",document.getElementById("proxy_url").value),b.setItem("uploadtype",document.getElementById("uploadtype").value),b.setItem("savefilename",document.getElementById("savefilename").value),b.setItem("savefileext",
document.getElementById("savefileext").value),b.setItem("serverdomain",document.getElementById("serverdomain").value),b.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),b.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),b.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),b.setItem("image_convert_format",document.getElementById("image_convert_format").value),b.setItem("image_convert_width",document.getElementById("image_convert_width").value),
b.setItem("image_convert_height",document.getElementById("image_convert_height").value),b.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&b.setItem("originalfilename",document.getElementById("originalfilename").value),G_OriginalMultiImageSize[e]&&(b.setItem("original_image_width",G_OriginalMultiImageSize[e].width),b.setItem("original_image_height",G_OriginalMultiImageSize[e].height)),b.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),
addParamHashTable(b),uploadAjaxOnprogressStart({uploadType:"cell_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:a.name,fileObj:G_dragDropFileObj,formData:b},event_dext_cell_property_completed)):(b.action=document.getElementById("upload_url").value,b.submit())}else""==e?event_dext_cell_property_completed(document.getElementById("image_url_value").value):alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_cell_property_completed(a,e){null!=a&&void 0!=a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));var b=[],c={maj:3,l:26,mi1:"3",mi2:"0"};if(LayerWin.G_dext5plugIn&&LayerWin.DEXTTOP.DEXT5.util.getRV(LayerWin.DEXTTOP.G_CURREDITOR._config.pv)>=LayerWin.DEXTTOP.DEXT5.util.makeCRV(c))a=a.replace(/\s/g,"%20"),a=a.replace(/\'/g,"%27"),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29");else if(_init_image_url!=
a){try{var d;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?d=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&(d=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a));null!=d&&void 0!=d&&(a=d)}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}null!=a&&void 0!=a&&(b=[],"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&
(b=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<b.length&&(a=b[0])),c=a.split("?"),2==c.length&&(a=c[0],c=c[1].split("^"),1==c.length?a+="?"+c[0]:3==c.length&&(a+="?"+c[2])),"[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))||LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,a))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||
-1<a.indexOf("HTTP Status")))try{var g;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError?g=DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:e.response}):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&(g=DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:e.response}));if(0==g)return}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}g=document.getElementById("horizontal_align").value;
var c=document.getElementById("vertical_align").value,m=document.getElementById("not_apply_class_name"),m=m?m.checked:!1,k=document.getElementById("not_apply_cell_id").checked;d="";d=document.getElementById("title_cell").value;var n="",n=document.getElementById("scope").value,p="",p=document.getElementById("nowrap").value,q=document.getElementById("topcell1"),r=document.getElementById("topcell2"),u=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var t={outsideTop:{style:"",
width:"",color:""},outsideLeft:{style:"",width:"",color:""},outsideRight:{style:"",width:"",color:""},outsideBottom:{style:"",width:"",color:""},insideRow:{style:"",width:"",color:""},insideCol:{style:"",width:"",color:""},diagonalUp:"",diagonalDown:""};t.outsideTop.style=q.style.borderTopStyle;t.outsideTop.width=q.style.borderTopWidth;t.outsideTop.color=q.style.borderTopColor;t.outsideLeft.style=q.style.borderLeftStyle;t.outsideLeft.width=q.style.borderLeftWidth;t.outsideLeft.color=q.style.borderLeftColor;
r?(t.outsideRight.style=r.style.borderRightStyle,t.outsideRight.width=r.style.borderRightWidth,t.outsideRight.color=r.style.borderRightColor):(t.outsideRight.style=q.style.borderRightStyle,t.outsideRight.width=q.style.borderRightWidth,t.outsideRight.color=q.style.borderRightColor);u?(t.outsideBottom.style=u.style.borderBottomStyle,t.outsideBottom.width=u.style.borderBottomWidth,t.outsideBottom.color=u.style.borderBottomColor):(t.outsideBottom.style=q.style.borderBottomStyle,t.outsideBottom.width=
q.style.borderBottomWidth,t.outsideBottom.color=q.style.borderBottomColor);u&&(t.insideRow.style=u.style.borderTopStyle,t.insideRow.width=u.style.borderTopWidth,t.insideRow.color=u.style.borderTopColor);r&&(t.insideCol.style=q.style.borderRightStyle,t.insideCol.width=q.style.borderRightWidth,t.insideCol.color=q.style.borderRightColor);!DEXTTOP.DEXT5.browser.ie&&"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&LayerWin.G_DEXT_Diagonal&&(q=document.getElementsByTagName("dext_diagonal_up"),r=document.getElementsByTagName("dext_diagonal_down"),
0<q.length&&(-1<q[0].className.indexOf("diff")?t.diagonalUp="noApply":t.diagonalUp=q[0].style.borderTop),0<r.length&&(-1<r[0].className.indexOf("diff")?t.diagonalDown="noApply":t.diagonalDown=r[0].style.borderTop));var q=document.getElementById("prev_background_remove").value,r=document.getElementById("add").value,u=document.getElementById("repeat").value,z=document.getElementById("horizontal").value,y=document.getElementById("vertical").value,v=document.getElementById("background_color").style.backgroundColor;
document.getElementById("tab_value");var A=document.getElementById("class_name").value,w=document.getElementById("cell_id").value;"notapplicable"==r&&(r=null);"notapplicable"==u&&(u=null);"notapplicable"==g&&(g=null);"notapplicable"==c&&(c=null);if("none"==document.getElementById("class_name").style.display||"notapplicable"==A||m)A=null;"notapplicable"==d&&(d=null);"notapplicable"==n&&(n=null);"notapplicable"==p&&(p=null);k&&(w=null);var k=m="",C=document.getElementById("cell_width"),B=document.getElementById("cell_height");
C&&B&&(C=C.value,B=B.value,""!=C&&G_preWidth!=C&&(m=C),""!=B&&G_preHeight!=B&&(k=B));LayerWin.event_dext_cell_property(g,c,d,n,p,t,q,a,r,u,z,y,v,window.frameElement.parentNode.parentNode,A,w,b,m,k)}
function dext_dog_bg_img_upload_image(){"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&LayerWin.closeBtnPreViewMode();var a=document.dext_upload_form,e="",e="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),b="";e&&(b=e.value);if(0<b.lastIndexOf(".")){var c=b.substring(b.lastIndexOf(".")+
1).toLowerCase();"0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util._fn_$mEPF(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(getBoundrayRanNumber()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=
DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=
DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config))),G_OriginalMultiImageSize[b]&&(G_OriginalMultiImageSize[b].width=DEXTTOP.DEXT5.util._fn_$mEPF(G_OriginalMultiImageSize[b].width+""),G_OriginalMultiImageSize[b].height=DEXTTOP.DEXT5.util._fn_$mEPF(G_OriginalMultiImageSize[b].height+
""))):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=getBoundrayRanNumber(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,
document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)));loading_image_show(!0);
"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",
document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("image_convert_format",document.getElementById("image_convert_format").value),a.setItem("image_convert_width",document.getElementById("image_convert_width").value),
a.setItem("image_convert_height",document.getElementById("image_convert_height").value),a.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&a.setItem("originalfilename",document.getElementById("originalfilename").value),G_OriginalMultiImageSize[b]&&(a.setItem("original_image_width",G_OriginalMultiImageSize[b].width),a.setItem("original_image_height",G_OriginalMultiImageSize[b].height)),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),
addParamHashTable(a),uploadAjaxOnprogressStart({uploadType:"doc_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:e.name,fileObj:G_dragDropFileObj,formData:a},event_dext_dog_bg_img_completed)):(a.action=document.getElementById("upload_url").value,a.submit())}else""==b?event_dext_dog_bg_img_completed(document.getElementById("image_url_value").value):alert(LayerWin.dext5_lang.msg.alert_exec)}
function dext_upload_video_media(){var a=document.dext_upload_form,e;e=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:document.getElementById(file_field_id);var b,c=document.getElementById("web_url");if(document.getElementsByName("InputFlag")[0].checked)if(b=e.value,0<b.lastIndexOf(".")){var d=b.substring(b.lastIndexOf(".")+1).toLowerCase();"0"!=LayerWin._dext_editor._config.security.encryptParam?
(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util._fn_$mEPF(d),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(getBoundrayRanNumber()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util._fn_$mEPF(""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),
document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin.getUploadOriginalFileName(b,
LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=d,document.getElementById("savefilename").value=getBoundrayRanNumber(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?
LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)));loading_image_show(!0);"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&
a.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",
document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename")&&a.setItem("originalfilename",document.getElementById("originalfilename").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),
addParamHashTable(a),uploadAjaxOnprogressStart({uploadType:"video_media",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:e.id,fileObj:G_dragDropFileObj,formData:a},event_dext_video_upload_completed)):(a.action=document.getElementById("upload_url").value,a.submit())}else""==b?alert(LayerWin.dext5_lang.msg.alert_no_file):alert(LayerWin.dext5_lang.msg.alert_exec);else b=c.value,e=(new RegExp(/^(http|ftp|https|news)/)).test(b),a=/^\s\s*$/,""==b||a.exec(b)||e&&!LayerWin.urlCheckOrPass(b)?(alert(LayerWin.dext5_lang.msg.alert_url),
c.focus()):LayerWin.executeDomainCheckForNewInsertFileByUrlProcess({editor:LayerWin._dext_editor,targetUrl:b,finalCallBackFn:function(a){a?(a=LayerWin.setMessageForMaxTotalFileSize(LayerWin._dext_editor),alert(a),c.focus()):event_dext_video_upload_completed(b)}})}
function event_dext_video_upload_completed(a,e){null!=a&&void 0!=a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));if(document.getElementsByName("InputFlag")[0].checked){if(null!=a&&void 0!=a){try{var b;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?b=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&
(b=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a));null!=b&&void 0!=b&&(a=b)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}b=a.split("?");2==b.length&&-1<b[1].indexOf("^")&&(a=b[0],b=b[1].split("^"),1==b.length?a+="?"+b[0]:3==b.length&&(a+="?"+b[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{var d;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError?
d=DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:a,response:e.response}):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&(d=DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:a,response:e.response}));if(0==d)return}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))){d=
!0;"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(d=confirm(LayerWin.dext5_lang.msg.uploadFailed));d&&(d=a.indexOf("HTTP Error"),b=a.indexOf("HTTP Status"),-1<d?alert(a.substring(d,d+16)):-1<b&&alert(a.substring(b,b+15)));return}if("[FAIL]"==a.substring(0,6)){d=!0;"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(d=confirm(LayerWin.dext5_lang.msg.uploadFailed));d&&alert(a);return}if(elemModify){"0"==LayerWin._dext_editor._config.useReplaceImage?null!=
elemModify.getAttribute("src")?(elemData.src=a,elemData.source=[]):0<elemModify.getElementsByTagName("source").length&&(elemData.source=[],elemData.source.push({src:a}),elemData.src=""):""!=elemData.src?(elemData.src=a,elemData.source=[]):0<elemData.source.length&&(elemData.source=[],elemData.source.push({src:a}),elemData.src="");"function"==typeof G_UploadCompleteCallBackFn&&(G_UploadCompleteCallBackFn(),LayerWin.hideDialog(window.frameElement.parentNode.parentNode));return}}d=document.getElementById("savefilename").value;
var g=document.getElementById("media_width").value,h=document.getElementById("media_height").value,m=document.getElementById("media_width_unit");b=document.getElementById("media_height_unit");m=0==LayerWin.parseIntOr0(g)?"":g+m.value;b=0==LayerWin.parseIntOr0(h)?"":h+b.value;LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,a);b={type:"video_media",src:a,width:m,height:b,autoPlay:document.getElementById("cb_autostart").checked,loop:document.getElementById("cb_loop").checked,controls:document.getElementById("cb_controls").checked,
muted:document.getElementById("cb_muted").checked,allowDownload:document.getElementById("cb_allowDownload").checked,isUrl:document.getElementById("radio_url").checked,isFirst:!0,textContent:""};g=""+("<video style='width:"+g+"px; height:"+h+"px;'");1==b.autoPlay&&(g+=" autoplay=''");1==b.loop&&(g+=" loop=''");1==b.controls&&(g+=" controls=''");1==b.muted&&(g+=" muted=''");var g=g+">",h=DEXTTOP.G_CURREDITOR._config.allowVideoFileType.length,m="",k=b.src.slice(b.src.lastIndexOf(".")+1,b.src.length);
if(b.isUrl)g+="<source src='"+b.src+"' type='video/"+("ogv"==k?"ogg":k)+"' />";else for(var g=g+("<source src='"+b.src+"' type='video/"+("ogv"==k?"ogg":k)+"' />"),n=0;n<h;n++)m=DEXTTOP.G_CURREDITOR._config.allowVideoFileType[n],m!=k&&(g+="<source src='"+b.src.slice(0,b.src.lastIndexOf("."))+"."+m+"' type='video/"+("ogv"==m?"ogg":m)+"' />");g+="HTML5 Video\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ube0c\ub77c\uc6b0\uc800</video>";LayerWin.event_dext_media_upload(d,"","","0",a,g,b,window.frameElement.parentNode.parentNode)}
function event_dext_cell_border_completed(){var a=document.getElementById("edge_border").style.borderTop,e=document.getElementById("edge_border").style.borderLeft,b=document.getElementById("edge_border").style.borderRight,c=document.getElementById("edge_border").style.borderBottom;LayerWin.event_dext_cell_border(a,e,b,c,window.frameElement.parentNode.parentNode)}
function event_dext_dog_bg_img_completed(a,e){null!=a&&void 0!=a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));var b=[],c={maj:3,l:26,mi1:"3",mi2:"0"};if(LayerWin.G_dext5plugIn&&LayerWin.DEXTTOP.DEXT5.util.getRV(LayerWin.DEXTTOP.G_CURREDITOR._config.pv)>=LayerWin.DEXTTOP.DEXT5.util.makeCRV(c))a=a.replace(/\s/g,"%20"),a=a.replace(/\'/g,"%27"),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29");else if(_init_image_url!=
a){try{var d;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?d=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&(d=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a));null!=d&&void 0!=d&&(a=d)}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}null!=a&&void 0!=a&&(b=[],"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&
(b=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<b.length&&(a=b[0])),c=a.split("?"),2==c.length&&(a=c[0],c=c[1].split("^"),1==c.length?a+="?"+c[0]:3==c.length&&(a+="?"+c[2])),"[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))||LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,a))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||
-1<a.indexOf("HTTP Status")))try{var g;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError?g=DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:e.response}):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&(g=DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:e.response}));if(0==g)return}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}g=document.getElementById("prev_background_remove").value;
c=document.getElementById("add").value;d=document.getElementById("repeat").value;var m=document.getElementById("background_color").style.backgroundColor;LayerWin.event_dext_dog_bg_img_insert(g,a,c,d,m,window.frameElement.parentNode.parentNode,b)}
function event_dext_find_completed(){var a=document.getElementById("search_contents").value,e=document.getElementsByName("search_option")[0].checked,b=document.getElementsByName("search_option")[1].checked,c=document.getElementsByName("search_option")[2].checked,d;1==document.getElementsByName("search_direction")[0].checked?d=!1:1==document.getElementsByName("search_direction")[1].checked&&(d=!0);LayerWin.event_dext_find(a,e,b,c,d,window.frameElement.parentNode.parentNode)}
function event_dext_replace_completed(){var a=document.getElementById("search_contents").value,e=document.getElementById("replace_contents").value,b=document.getElementsByName("search_option")[0].checked,c=document.getElementsByName("search_option")[1].checked,d=document.getElementsByName("search_option")[2].checked,f;1==document.getElementsByName("search_direction")[0].checked?f=!1:1==document.getElementsByName("search_direction")[1].checked&&(f=!0);LayerWin.event_dext_replace(a,e,b,c,d,f,window.frameElement.parentNode.parentNode)}
function event_dext_all_replace_completed(){var a=document.getElementById("search_contents").value,e=document.getElementById("replace_contents").value,b=document.getElementsByName("search_option")[0].checked,c=document.getElementsByName("search_option")[1].checked,d=document.getElementsByName("search_option")[2].checked,f;1==document.getElementsByName("search_direction")[0].checked?f=!1:1==document.getElementsByName("search_direction")[1].checked&&(f=!0);LayerWin.event_dext_all_replace(a,e,b,c,d,
f,window.frameElement.parentNode.parentNode,!0)}function event_dext_spellcheck_find_completed(a){return LayerWin.event_dext_spellcheck_find(a)}function event_dext_spellcheck_replace_completed(){var a=document.getElementById("wrong_word").value,e=document.getElementById("replace_word").value;LayerWin.event_dext_spellcheck_replace(a,e)}
function event_dext_spellcheck_all_replace_completed(){var a=document.getElementById("wrong_word").value,e=document.getElementById("replace_word").value;LayerWin.event_dext_spellcheck_all_replace(a,e)}
function event_dext_capital_small_letter_completed(){1==document.getElementsByName("capital_small_letter")[0].checked?_capital_small_letter="LOWER":1==document.getElementsByName("capital_small_letter")[1].checked?_capital_small_letter="UPPER":1==document.getElementsByName("capital_small_letter")[2].checked&&(_capital_small_letter="FIRSTUPPER");LayerWin.event_dext_capital_small_letter(_capital_small_letter,window.frameElement.parentNode.parentNode)}
var G_RECENT_EMOTICON={basePlusUrl:function(a,e){return e?0==e.toLowerCase().indexOf("http:")||0==e.toLowerCase().indexOf("https:")?e:""!==a?a+e:e:""},sameUrlIndex:function(a,e,b){return a?(a=DEXTTOP.DEXT5.util.jsonToString(a),e?a.indexOf(e):a.indexOf(b)):-1}};
function event_dext_emoticon_completed(a,e,b,c,d,f){if(DEXTTOP.DEXT5.browser.LocalStorageSupported&&d&&0<d.length){b=[];for(var g=c="",h=b.length,m=function(a){var b={};DEXTTOP.DEXT5.util.stringTypeIsEmpty(a.s)||(b.s=a.s);DEXTTOP.DEXT5.util.stringTypeIsEmpty(a.p_s)||(b.p_s=a.p_s);DEXTTOP.DEXT5.util.stringTypeIsEmpty(a.b)||(b.b=a.b);DEXTTOP.DEXT5.util.stringTypeIsEmpty(a.p_b)||(b.p_b=a.p_b);DEXTTOP.DEXT5.util.stringTypeIsEmpty(a.a)||(b.a=a.a);return b},k=0;k<d.length;){var n=d[k],p,q=n.s,r=n.p_s,u=
n.a;if(0==h)h=m({s:q,p_s:r,a:u}),b.push(DEXTTOP.DEXT5.util.jsonToString(h));else{p=DEXTTOP.DEXT5.util.stringToJson(b[h-1]);var t=d[k-1],n=t.s,t=t.p_s,z={s:q,p_s:r,a:u},u=function(a,b,c){for(var d=a,e="";a&&b;)if(a=a.substring(0,a.lastIndexOf("/")),""!=a&&0==b.indexOf(a)){"preview"!=c?(p.s=d.substr(a.length),p.b="",z.b=a,z.s=b.substr(a.length)):(p.p_s=d.substr(a.length),p.p_b="",z.p_b=a,z.p_s=b.substr(a.length));isChecked=!0;e=a;break}return e};if(""!=c&&p.b&&q&&0==q.indexOf(c))p.s=n.substr(c.length),
p.b="",z.s=q.substr(c.length),z.b=c;else if(""==c||void 0===p.b)c=u(n,q);if(""!=g&&p.p_b&&r&&0==r.indexOf(g))p.p_s=t.substr(g.length),p.p_b="",z.p_s=r.substr(g.length),z.p_b=g;else if(""==g||void 0===p.p_b)g=u(t,r,"preview");b[h-1]=DEXTTOP.DEXT5.util.jsonToString(m(p));b.push(DEXTTOP.DEXT5.util.jsonToString(m(z)))}h=b.length;k++}DEXTTOP.DEXTWIN.localStorage.setItem("dext_"+DEXTTOP.G_CURREDITOR.ID+"_emotion_list",b.join("|"))}d={srcURL:a,width:"",height:"",title:e,alt:e,margin_left:"",margin_right:"",
margin_top:"",margin_bottom:"",align_obj:"",align:"",border:"0",linkurl:"",borderStyle:"",borderKind:"",borderColor:"",borderThickness:""};a={url:a,preViewUrl:f,title:e,alt:e};"function"===typeof DEXTTOP.G_CURREDITOR._config.event.insertEmoticon?DEXTTOP.G_CURREDITOR._config.event.insert_emoticon(DEXTTOP.G_CURREDITOR.ID,a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_insert_emoticon_event&&DEXTTOP.DEXTWIN.dext_editor_insert_emoticon_event(DEXTTOP.G_CURREDITOR.ID,a);LayerWin.event_dext_emoticon_insert(d,
window.frameElement.parentNode.parentNode)}
function event_dext_insert_row_column_completed(){var a="",e="";1==document.getElementById("row").checked?(a="R",1==document.getElementById("up").checked?e="U":1==document.getElementById("down").checked&&(e="D")):1==document.getElementById("column").checked&&(a="C",1==document.getElementById("right").checked?e="R":1==document.getElementById("left").checked&&(e="L"));var b=document.getElementById("line_count").value;LayerWin.event_dext_insert_row_column(a,e,b,window.frameElement.parentNode.parentNode)}
function event_dext_row_property_completed(){var a=document.getElementById("background_color").style.backgroundColor,e=document.getElementById("row_height").value,b=document.getElementById("row_thead").checked,c=document.getElementById("horizontal_align").value,d=document.getElementById("vertical_align").value;LayerWin.event_dext_row_property(a,e,b,c,d,window.frameElement.parentNode.parentNode)}
function event_dext_column_property_completed(){var a=document.getElementById("background_color").style.backgroundColor,e=document.getElementById("column_width").value,b=document.getElementById("horizontal_align").value,c=document.getElementById("vertical_align").value;LayerWin.event_dext_column_property(a,e,b,c,window.frameElement.parentNode.parentNode)}
function dext_create_iframe(){var a=document.getElementById("input_url").value,a=web_url_remove_char(a),e=(new RegExp(/^(http|ftp|https|news)/)).test(a),b=/^\s\s*$/;if(""==a||b.exec(a)||e&&!LayerWin.urlCheckOrPass(a))alert(LayerWin.dext5_lang.msg.alert_url),setCursorPos(document.getElementById("input_url"),!0,!1);else if(LayerWin.checkXssContentType(a,{editor:LayerWin._dext_editor}))alert(LayerWin.dext5_lang.msg.alert_insert_url_xss),setCursorPos(document.getElementById("input_url"),!0,!1);else{e=
LayerWin._dext_editor._config.accessibilityValidationItems;if(""==e||-1<e.indexOf("iframe_title"))if(e=LayerWin._dext_editor._config.accessibility,b=document.getElementById("input_title").value,"1"==e)""==b&&alert(LayerWin.dext5_lang.msg.alert_iframe_input_title_access1);else if("2"==e&&""==b){alert(LayerWin.dext5_lang.msg.alert_iframe_input_title_access2);document.getElementById("input_title").focus();return}var e=document.getElementById("input_width").value,c=document.getElementById("input_width_unit"),
b=document.getElementById("input_height_unit"),c=0==LayerWin.parseIntOr0(e)?"":e+c.value,e=document.getElementById("input_height").value,e=0==LayerWin.parseIntOr0(e)?"":e+b.value,a={type:"iframe",src:a,id:document.getElementById("input_id").value,name:document.getElementById("input_name").value,className:document.getElementById("input_class").value,title:document.getElementById("input_title").value,width:c,height:e,align:document.getElementById("select_align").value,scrolling:document.getElementById("select_scroll").value,
frameBorder:document.getElementById("input_border").checked},e=LayerWin.getLinkMediaType(a.src);0<e.length&&(a.type=e,a.type2="iframe");LayerWin.event_dext_create_iframe(a,window.frameElement.parentNode.parentNode)}}
function dext_create_hyperlink_image(){"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&LayerWin.closeBtnPreViewMode();var a=document.dext_upload_form,e="",e="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),b;b=e.value;if(""==b)alert(LayerWin.dext5_lang.background_image.msg_file_select),setCursorPos(e,
!0,!1);else if(0<b.lastIndexOf(".")){var c=b.substring(b.lastIndexOf(".")+1).toLowerCase();"0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util._fn_$mEPF(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(getBoundrayRanNumber()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.toSavePathURL),
document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_width),
document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config))),G_OriginalMultiImageSize[b]&&(G_OriginalMultiImageSize[b].width=DEXTTOP.DEXT5.util._fn_$mEPF(G_OriginalMultiImageSize[b].width+""),G_OriginalMultiImageSize[b].height=DEXTTOP.DEXT5.util._fn_$mEPF(G_OriginalMultiImageSize[b].height+
""))):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=getBoundrayRanNumber(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,
document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)));loading_image_show(!0);
"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",
document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("image_convert_format",document.getElementById("image_convert_format").value),a.setItem("image_convert_width",document.getElementById("image_convert_width").value),
a.setItem("image_convert_height",document.getElementById("image_convert_height").value),a.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&a.setItem("originalfilename",document.getElementById("originalfilename").value),G_OriginalMultiImageSize[b]&&(a.setItem("original_image_width",G_OriginalMultiImageSize[b].width),a.setItem("original_image_height",G_OriginalMultiImageSize[b].height)),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),
addParamHashTable(a),uploadAjaxOnprogressStart({uploadType:"hyperlink_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:e.name,fileObj:G_dragDropFileObj,formData:a},dext_create_hyperlink)):(a.action=document.getElementById("upload_url").value,a.submit())}else alert(LayerWin.dext5_lang.msg.alert_exec),setCursorPos(e,!0,!1)}
function dext_create_hyperlink(a,e){"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&LayerWin.closeBtnPreViewMode();a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=web_url_remove_char(a));var b="";if("hyperlink"==document.getElementById("select_category").value||0>"bookmark,image".indexOf(document.getElementById("select_category").value)){b=document.getElementById("input_url").value;
b=web_url_remove_char(b);if(null!=b&&void 0!=b&&""!=b){var c;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertHyperlink?c=DEXTTOP.G_CURREDITOR._config.event.beforeInsertHyperlink(DEXTTOP.G_CURREDITOR.ID,b):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_hyperlink_event&&(c=DEXTTOP.DEXTWIN.dext_editor_before_insert_hyperlink_event(DEXTTOP.G_CURREDITOR.ID,b))}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}null!=c&&void 0!=c&&(b=c)}c=(new RegExp(/^(http|https|ftp|news)/)).test(b);
var f=/^\s\s*$/;if(""==b||f.exec(b)||c&&!LayerWin.urlCheckOrPass(b)){alert(LayerWin.dext5_lang.msg.alert_url);document.getElementById("input_url").value=b;setCursorPos(document.getElementById("input_url"),!0,!1);return}}else if("bookmark"==document.getElementById("select_category").value&&""==document.getElementById("select_bookmark").value){alert(LayerWin.dext5_lang.msg.alert_bookmark);setCursorPos(document.getElementById("select_bookmark"),!0,!1);return}c=LayerWin._dext_editor._config.accessibilityValidationItems;
if(""==c||-1<c.indexOf("a_title"))if(c=LayerWin._dext_editor._config.accessibility,f=document.getElementById("input_text").value,"1"==c)""==f&&alert(LayerWin.dext5_lang.msg.alert_hyperlink_input_text_access1);else if("2"==c&&""==f){alert(LayerWin.dext5_lang.msg.alert_hyperlink_input_text_access2);document.getElementById("input_text").focus();return}c=document.getElementById("select_category").value;0>"bookmark,image".indexOf(document.getElementById("select_category").value)&&(c="hyperlink");b={type:c,
url:b,text:document.getElementById("input_text").value,title:document.getElementById("input_title").value,target:document.getElementById("select_target").value,bookname:document.getElementById("select_bookmark").value,id:document.getElementById("input_id").value,className:document.getElementById("input_class").value,attr_info_arr:[]};if(null!=a&&void 0!=a){a=a.replace(/\r\n/g,"");a=a.replace(/\n/g,"");a=a.replace(/\t/g,"");try{var g;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?
g=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&(g=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a));null!=g&&void 0!=g&&(a=g)}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{var m;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError?
m=DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:e.response}):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&(m=DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:e.response}));if(0==m)return}catch(k){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(b.attr_info_arr=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),
1<b.attr_info_arr.length&&(a=b.attr_info_arr[0]));g=a.split("?");2==g.length&&(a=g[0],g=g[1].split("^"),1==g.length?a+="?"+g[0]:3==g.length&&(img_real_width=g[0],img_real_height=g[1],a+="?"+g[2]));!a||"[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))||LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,a);if(elemModify){if(b.attr_info_arr&&1<b.attr_info_arr.length)for(g=b.attr_info_arr.length,m=1;m<g;m++)c=b.attr_info_arr[m].split("^"),
2==c.length&&elemModify.setAttribute(c[0],c[1]);document.getElementById("input_url").value=a;set_modify_ok();return}b.url=a}LayerWin.event_dext_create_hyperlink(b,window.frameElement.parentNode.parentNode)}
function split_cell_ok(){var a=document.getElementById("input_row"),e=document.getElementById("input_column"),b=document.getElementsByName("radio_split")[0],c=document.getElementsByName("radio_split")[1];b.checked?e.value="0":c.checked&&(a.value="0");LayerWin.event_dext_split_cell(a.value,e.value,window.frameElement.parentNode.parentNode)}function symbol_ok(){var a=document.getElementById("input_output");LayerWin.event_dext_symbol(a.innerHTML,window.frameElement.parentNode.parentNode)}
function template_ok(a){void 0==a&&"0"!=DEXTTOP.DEXT5.getEditor()._config.skipConfirm.template&&(a=!0);var e=document.getElementById("clicked_template").value,b=document.getElementById("template_print_header").value,c=document.getElementById("template_print_footer").value,e={url:e,print_header:b,print_footer:c};0==DEXTTOP.DEXT5.isEmpty()?(a||0!=confirm(LayerWin.dext5_lang.msg.newDocument))&&LayerWin.event_dext_template(e,window.frameElement.parentNode.parentNode):LayerWin.event_dext_template(e,window.frameElement.parentNode.parentNode)}
function dext_insert_link_media(){if(""==document.getElementById("ta_media_tag").value)alert(LayerWin.dext5_lang.insert_link_media.tag_null);else{var a="",e=document.getElementById("ta_media_tag").value,b=document.getElementById("ta_media_caption").value,c=!1;document.getElementById("check_allow_full_screen")&&(c=document.getElementById("check_allow_full_screen").checked);var e=e.replace(/\r\n/g,""),e=e.replace(/\n/g,""),e=e.replace(/\r/g,""),a=e.match(/(<[\s]*embed [^>]+>)/gi),d=e.match(/(<[\s]*iframe [^>]+>)/gi),
f=e.match(/(<[\s]*object [^>]+>)/gi);d||(d=DEXTTOP.DEXT5.util.createYoutubeIframe(e).frameObj);e=LayerWin._dext_editor._config.xss_remove_tags.toLowerCase();if(f&&-1<e.indexOf("object"))alert(LayerWin.dext5_lang.msg.alert_insert_link_media_xss);else{if(a){if(-1<e.indexOf("embed")){alert(LayerWin.dext5_lang.msg.alert_insert_link_media_xss);return}a=a[0]}else if(d){if(-1<e.indexOf("iframe")){alert(LayerWin.dext5_lang.msg.alert_insert_link_media_xss);return}a=d[0]}else{alert(LayerWin.dext5_lang.insert_link_media.invalid_tag);
return}if("1"==LayerWin._dext_editor._config.allowLinkMediaCaption)if("1"==LayerWin._dext_editor._config.accessibility)""==b&&alert(LayerWin.dext5_lang.msg.alert_insert_link_media_caption_access1);else if("2"==LayerWin._dext_editor._config.accessibility&&""==b){alert(LayerWin.dext5_lang.msg.alert_insert_link_media_caption_access2);document.getElementById("ta_media_caption").focus();return}LayerWin.event_dext_insert_link_media(a,b,c,window.frameElement.parentNode.parentNode)}}}
function dext_modify_link_media(a){if(""==document.getElementById("ta_media_tag").value)alert(LayerWin.dext5_lang.insert_link_media.tag_null);else{var e="",b=document.getElementById("ta_media_tag").value,c=document.getElementById("ta_media_caption").value,d=!1;document.getElementById("check_allow_full_screen")&&(d=document.getElementById("check_allow_full_screen").checked);b=b.replace(/\r\n/g,"");b=b.replace(/\n/g,"");b=b.replace(/\r/g,"");e=b.match(/(<[\s]*embed [^>]+>)/gi);b=b.match(/(<[\s]*iframe [^>]+>)/gi);
if(e)e=e[0];else if(b)e=b[0];else{alert(LayerWin.dext5_lang.insert_link_media.invalid_tag);return}LayerWin.event_dext_modify_link_media(e,c,d,a,window.frameElement.parentNode.parentNode)}}function dext_insert_paste_dialog_html(){var a=document.getElementById("pasteArea").contentWindow.document.body.innerHTML;LayerWin.event_dext_insert_paste_dialog_html(a,window.frameElement.parentNode.parentNode)}
function dext_insert_input_text(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertReadonly:!1,insertType:"text",insertSize:"",insertMaxlength:"",insertEventNameArr:[],insertEventFunctionArr:[],insertPlaceholder:""};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;
a.insertTitle=document.getElementById("input_title").value;a.insertAlign=document.getElementById("input_textalign").value;a.insertWidth="0"==document.getElementById("input_width").value?"":document.getElementById("input_width").value;a.insertHeight="0"==document.getElementById("input_height").value?"":document.getElementById("input_height").value;a.insertDisabled=document.getElementById("input_disabled").checked;a.insertReadonly=document.getElementById("input_readonly").checked;a.insertSize="0"==
document.getElementById("input_size").value?"":document.getElementById("input_size").value;a.insertMaxlength="0"==document.getElementById("input_maxtext").value?"":document.getElementById("input_maxtext").value;a.insertPlaceholder=document.getElementById("input_placeholder").value;for(var e=document.getElementsByName("input_type"),b=e.length,c=0;c<b;c++)if(1==e[c].checked){a.insertType=e[c].value;break}for(var e=document.getElementById("event_table"),b=e.childNodes.length,c=0;c<b;c++){var d=e.childNodes[c].getElementsByTagName("span");
a.insertEventNameArr.push(d[0].innerHTML);a.insertEventFunctionArr.push(d[1].innerHTML)}LayerWin.event_dext_insert_input_text(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_text(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.readOnly&&(document.getElementById("input_readonly").checked=
!0);elemModify.getAttribute("size")&&""!=elemModify.getAttribute("size")&&(document.getElementById("input_size").value=elemModify.getAttribute("size"));elemModify.getAttribute("maxlength")&&""!=elemModify.getAttribute("maxlength")&&(document.getElementById("input_maxtext").value=elemModify.getAttribute("maxlength"));"text"==elemModify.type?(document.getElementById("input_type_general").checked=!0,document.getElementById("input_type_password").checked=!1):"password"==elemModify.type&&(document.getElementById("input_type_general").checked=
!1,document.getElementById("input_type_password").checked=!0);if(elemModify.getAttribute("dext5customdata")){var a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));if("event"==a.type){var e=a.eventFunction,a=a.eventName.split("\x0B"),e=e.split("\x0B"),b=a.length;for(i=0;i<b;i++){var c=document.getElementById("event_table"),d=document.createElement("tr"),f=document.createElement("td");f.className="type2";var g=document.createElement("a"),h=document.createElement("span");h.appendChild(document.createTextNode(a[i]));
g.appendChild(h);g.title=a[i];h=document.createElement("td");h.className="type2";h.style.width="65%";var m=document.createElement("a"),k=document.createElement("span");k.appendChild(document.createTextNode(e[i]));m.appendChild(k);m.title=e[i];f.appendChild(g);d.appendChild(f);h.appendChild(m);d.appendChild(h);c.appendChild(d)}}}}
function dext_modify_input_text(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?(elemModify.setAttribute("value",document.getElementById("input_value").value),elemModify.value=document.getElementById("input_value").value):(elemModify.setAttribute("value",""),elemModify.value="");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");
""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="";""!=document.getElementById("input_width").value&&
"0"!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value&&"0"!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;elemModify.readOnly=document.getElementById("input_readonly").checked;""!=document.getElementById("input_size").value&&
"0"!=document.getElementById("input_size").value?elemModify.size=document.getElementById("input_size").value:elemModify.removeAttribute("size");""!=document.getElementById("input_maxtext").value&&"0"!=document.getElementById("input_maxtext").value?elemModify.maxLength=document.getElementById("input_maxtext").value:elemModify.removeAttribute("maxLength");for(var a=document.getElementsByName("input_type"),e=a.length,b=0;b<e;b++)if(1==a[b].checked){try{elemModify.type=a[b].value}catch(c){b='<input type="'+
a[b].value+'" />',a=LayerWin._iframeDoc.createElement("div"),a.innerHTML=b,newElem=a.firstChild,LayerWin.setCopyAllObjectAtributesForInput(elemModify,newElem,!1),elemModify.parentNode.replaceChild(newElem,elemModify),LayerWin.DEXTTOP.G_SELECTED_ELEMENT=newElem,elemModify=null,elemModify=newElem}break}""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):
(b=elemModify.outerHTML,b=b.replace('name="'+elemModify.name+'"',""),b=b.replace("name='"+elemModify.name+"'",""),b=b.replace("name="+elemModify.name,""),b=b.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=b):elemModify.removeAttribute("name");var d=document.getElementById("event_table"),f=d.childNodes.length;if(0<f){for(var e=a="",b=0;b<f;b++)0!=b&&(a+="\x0B",e+="\x0B"),a+=d.childNodes[b].getElementsByTagName("span")[0].innerHTML,e+=d.childNodes[b].getElementsByTagName("span")[1].innerHTML;
""!=a&&(b={type:"event"},b.eventName=a,b.eventFunction=e,LayerWin.setDextCustomData(elemModify,b))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function dext_insert_input_radio_or_checkbox(a){var e={insertType:"",insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertChecked:!1,insertEventNameArr:[],insertEventFunctionArr:[]};e.insertType=a;e.insertName=document.getElementById("input_name").value;e.insertValue=document.getElementById("input_value").value;e.insertId=document.getElementById("input_id").value;e.insertClass=document.getElementById("input_class").value;e.insertTitle=
document.getElementById("input_title").value;e.insertWidth=document.getElementById("input_width").value;e.insertHeight=document.getElementById("input_height").value;e.insertDisabled=document.getElementById("input_disabled").checked;var b=document.getElementsByName("input_status"),c=b.length;for(a=0;a<c;a++)if(1==b[a].checked){e.insertChecked="true"==b[a].value?!0:!1;break}b=document.getElementById("event_table");c=b.childNodes.length;for(a=0;a<c;a++){var d=b.childNodes[a].getElementsByTagName("span");
e.insertEventNameArr.push(d[0].innerHTML);e.insertEventFunctionArr.push(d[1].innerHTML)}LayerWin.event_dext_insert_input_radio_or_checkbox(e,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_radio_or_checkbox(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.checked?document.getElementById("input_checked").checked=!0:document.getElementById("input_not_checked").checked=!0;if(elemModify.getAttribute("dext5customdata")){var a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));
if("event"==a.type){var e=a.eventFunction,a=a.eventName.split("\x0B"),e=e.split("\x0B"),b=a.length;for(i=0;i<b;i++){var c=document.getElementById("event_table"),d=document.createElement("tr"),f=document.createElement("td");f.className="type2";var g=document.createElement("a"),h=document.createElement("span");h.innerHTML=a[i];g.appendChild(h);g.title=a[i];h=document.createElement("td");h.className="type2";h.style.width="65%";var m=document.createElement("a"),k=document.createElement("span");k.innerHTML=
e[i];m.appendChild(k);m.title=e[i];f.appendChild(g);d.appendChild(f);h.appendChild(m);d.appendChild(h);c.appendChild(d)}}}}
function dext_modify_input_radio_or_checkbox(a){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?
elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+
"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;var e=document.getElementsByName("input_status"),b=e.length;for(a=0;a<b;a++)if(1==e[a].checked){"true"==e[a].value?(elemModify.checked=!0,elemModify.setAttribute("checked","checked")):(elemModify.checked=!1,elemModify.removeAttribute("checked"));break}""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",
document.getElementById("input_name").value):(a=elemModify.outerHTML,a=a.replace('name="'+elemModify.name+'"',""),a=a.replace("name='"+elemModify.name+"'",""),a=a.replace("name="+elemModify.name,""),a=a.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=a):elemModify.removeAttribute("name");var c=document.getElementById("event_table"),d=c.childNodes.length;if(0<d){b=e="";for(a=0;a<d;a++)0!=a&&(e+="\x0B",b+="\x0B"),e+=c.childNodes[a].getElementsByTagName("span")[0].innerHTML,
b+=c.childNodes[a].getElementsByTagName("span")[1].innerHTML;""!=e&&(a={type:"event"},a.eventName=e,a.eventFunction=b,LayerWin.setDextCustomData(elemModify,a))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function dext_insert_input_button(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertType:"button",insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;
a.insertAlign=document.getElementById("input_textalign").value;a.insertWidth=document.getElementById("input_width").value;a.insertHeight=document.getElementById("input_height").value;a.insertDisabled=document.getElementById("input_disabled").checked;for(var e=document.getElementsByName("input_type"),b=e.length,c=0;c<b;c++)if(1==e[c].checked){a.insertType=e[c].value;break}for(var e=document.getElementById("event_table"),b=e.childNodes.length,c=0;c<b;c++){var d=e.childNodes[c].getElementsByTagName("span");
a.insertEventNameArr.push(d[0].innerHTML);a.insertEventFunctionArr.push(d[1].innerHTML)}LayerWin.event_dext_insert_input_button(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_button(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.readOnly&&(document.getElementById("input_readonly").checked=
!0);"button"==elemModify.type?(document.getElementById("input_general").checked=!0,document.getElementById("input_reset").checked=!1,document.getElementById("input_submit").checked=!1):"reset"==elemModify.type?(document.getElementById("input_general").checked=!1,document.getElementById("input_reset").checked=!0,document.getElementById("input_submit").checked=!1):"submit"==elemModify.type&&(document.getElementById("input_general").checked=!1,document.getElementById("input_reset").checked=!1,document.getElementById("input_submit").checked=
!0);if(elemModify.getAttribute("dext5customdata")){var a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));if("event"==a.type){var e=a.eventFunction,a=a.eventName.split("\x0B"),e=e.split("\x0B"),b=a.length;for(i=0;i<b;i++){var c=document.getElementById("event_table"),d=document.createElement("tr"),f=document.createElement("td");f.className="type2";var g=document.createElement("a"),h=document.createElement("span");h.innerHTML=a[i];g.appendChild(h);g.title=a[i];h=document.createElement("td");
h.className="type2";h.style.width="65%";var m=document.createElement("a"),k=document.createElement("span");k.innerHTML=e[i];m.appendChild(k);m.title=e[i];f.appendChild(g);d.appendChild(f);h.appendChild(m);d.appendChild(h);c.appendChild(d)}}}}
function dext_modify_input_button(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:
elemModify.removeAttribute("title");""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="";""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=
document.getElementById("input_disabled").checked;for(var a=document.getElementsByName("input_type"),e=a.length,b=0;b<e;b++)if(1==a[b].checked){try{elemModify.type=a[b].value}catch(c){b='<input type="'+a[b].value+'" />',a=LayerWin._iframeDoc.createElement("div"),a.innerHTML=b,newElem=a.firstChild,LayerWin.setCopyAllObjectAtributesForInput(elemModify,newElem,!1),elemModify.parentNode.replaceChild(newElem,elemModify),LayerWin.DEXTTOP.G_SELECTED_ELEMENT=newElem,elemModify=null,elemModify=newElem}break}""!=
document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(b=elemModify.outerHTML,b=b.replace('name="'+elemModify.name+'"',""),b=b.replace("name='"+elemModify.name+"'",""),b=b.replace("name="+
elemModify.name,""),b=b.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=b):elemModify.removeAttribute("name");var d=document.getElementById("event_table"),f=d.childNodes.length;if(0<f){for(var e=a="",b=0;b<f;b++)0!=b&&(a+="\x0B",e+="\x0B"),a+=d.childNodes[b].getElementsByTagName("span")[0].innerHTML,e+=d.childNodes[b].getElementsByTagName("span")[1].innerHTML;""!=a&&(b={type:"event"},b.eventName=a,b.eventFunction=e,LayerWin.setDextCustomData(elemModify,
b))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function setInputSelectPageEvent(){var a=document.getElementById("input_value"),e=document.getElementById("btn_add"),b=document.getElementById("btn_modify"),c=document.getElementById("btn_delete"),d=document.getElementById("btn_up"),f=document.getElementById("btn_down");b.disabled=!0;b.className="non_btn";c.disabled=!0;c.className="non_btn";d.disabled=!0;d.className="non_btn";f.disabled=!0;f.className="non_btn";var g=document.getElementById("option_table");DEXTTOP.DEXT5.util.addEvent(e,"click",btn_select_add_click);
DEXTTOP.DEXT5.util.addEvent(b,"click",btn_select_mod_click);DEXTTOP.DEXT5.util.addEvent(c,"click",btn_select_del_click);DEXTTOP.DEXT5.util.addEvent(d,"click",btn_select_up_click);DEXTTOP.DEXT5.util.addEvent(f,"click",btn_select_down_click);DEXTTOP.DEXT5.util.addEvent(g,"click",function(a){a=a||window.event;var e=a.target?a.target:a.srcElement;a=document.getElementById("input_option");var h=document.getElementById("input_option_value");if(e=Dext5LayerWin.GetParentbyTagName(e,"tr"))_clicked_options=
e,e.style.background="#e5e5e5",a.value=e.getElementsByTagName("span")[0].innerHTML,h.value=e.getElementsByTagName("span")[1].innerHTML;for(a=0;a<g.childNodes.length;a++)g.childNodes[a]!=_clicked_options&&(g.childNodes[a].style.background="white");b.disabled=!1;b.className="in_btn";c.disabled=!1;c.className="in_btn";d.disabled=!1;d.className="in_btn";f.disabled=!1;f.className="in_btn"});var h=document.getElementById("input_multiselect");LayerWin.DEXTTOP.DEXT5.util.addEvent(h,"click",function(){if(0==
h.checked)for(var b=g.getElementsByTagName("input"),c=b.length,d=!1,e=0;e<c;e++)b[e].checked&&(d?b[e].checked=!1:(a.value=g.childNodes[e].getElementsByTagName("span")[1].innerHTML,d=!0))})}
function btn_select_add_click(){var a=document.getElementById("input_option"),e=document.getElementById("input_option_value");document.getElementById("btn_add");if(""!=a.value){var b=document.getElementById("option_table"),c=document.getElementById("input_value"),d=document.createElement("tr"),f=document.createElement("td");f.className="type";var g=document.createElement("input");g.type="checkbox";var h=document.createElement("td");h.className="type2";h.style.width="44%";var m=document.createElement("a"),
k=document.createElement("span");k.innerHTML=a.value;m.appendChild(k);m.title=a.value;k=document.createElement("td");k.className="type2";k.style.width="44%";var n=document.createElement("a"),p=document.createElement("span");p.innerHTML=e.value;n.appendChild(p);n.title=e.value;f.appendChild(g);d.appendChild(f);h.appendChild(m);d.appendChild(h);k.appendChild(n);d.appendChild(k);b.appendChild(d);a.value="";e.value="";LayerWin.DEXTTOP.DEXT5.util.addEvent(g,"click",function(){if(0==document.getElementById("input_multiselect").checked)if(1==
g.checked)for(var a=b.getElementsByTagName("input"),d=a.length,e=0;e<d;e++)a[e]!=g?a[e].checked=!1:c.value=p.innerHTML;else c.value="";else if(1==g.checked)c.value=p.innerHTML;else for(a=b.getElementsByTagName("input"),d=a.length,c.value="",e=0;e<d;e++)if(a[e].checked){c.value=b.childNodes[e].getElementsByTagName("span")[1].innerHTML;break}})}}
function btn_select_mod_click(){if(_clicked_options){var a=document.getElementById("input_option"),e=document.getElementById("input_option_value");_clicked_options.getElementsByTagName("span")[0].innerHTML=a.value;_clicked_options.getElementsByTagName("span")[1].innerHTML=e.value}}
function btn_select_del_click(){document.getElementById("option_table");document.getElementById("btn_add");var a=document.getElementById("btn_modify"),e=document.getElementById("btn_delete"),b=document.getElementById("btn_up"),c=document.getElementById("btn_down");document.getElementById("input_option").value="";document.getElementById("input_option_value").value="";_clicked_options&&_clicked_options.parentNode.removeChild(_clicked_options);a.disabled=!0;a.className="non_btn";e.disabled=!0;e.className=
"non_btn";b.disabled=!0;b.className="non_btn";c.disabled=!0;c.className="non_btn"}function btn_select_up_click(){_clicked_options&&_clicked_options.previousSibling&&_clicked_options.parentNode.insertBefore(_clicked_options,_clicked_options.previousSibling)}function btn_select_down_click(){_clicked_options&&_clicked_options.nextSibling&&_clicked_options.parentNode.insertBefore(_clicked_options.nextSibling,_clicked_options)}
function setInputCommonEventPageEvent(){var a=document.getElementById("btn_event_add"),e=document.getElementById("btn_event_modify"),b=document.getElementById("btn_event_delete");e.disabled=!0;e.className="non_btn";b.disabled=!0;b.className="non_btn";var c=document.getElementById("event_table");DEXTTOP.DEXT5.util.addEvent(a,"click",btn_common_event_add_click);DEXTTOP.DEXT5.util.addEvent(e,"click",btn_common_event_mod_click);DEXTTOP.DEXT5.util.addEvent(b,"click",btn_common_event_del_click);DEXTTOP.DEXT5.util.addEvent(c,
"click",function(a){a=a||window.event;var f=a.target?a.target:a.srcElement;a=document.getElementById("input_event_name");var g=document.getElementById("input_event_function");if(f=Dext5LayerWin.GetParentbyTagName(f,"tr"))_clicked_event=f,f.style.background="#e5e5e5",a.value=f.getElementsByTagName("span")[0].innerHTML,g.value=f.getElementsByTagName("span")[1].innerHTML;for(a=0;a<c.childNodes.length;a++)c.childNodes[a]!=_clicked_event&&(c.childNodes[a].style.background="white");e.disabled=!1;e.className=
"in_btn";b.disabled=!1;b.className="in_btn"})}
function btn_common_event_add_click(){var a=document.getElementById("input_event_name"),e=document.getElementById("input_event_function");document.getElementById("btn_event_add");if(""!=a.value){var b=document.getElementById("event_table"),c=b.childNodes.length;if(0<c)for(var d=0;d<c;d++)if(a.value==b.childNodes[d].getElementsByTagName("span")[0].innerHTML){alert(a.value+" "+LayerWin.dext5_lang.input_common.event_duplicate_msg);return}b=document.getElementById("event_table");c=document.createElement("tr");
d=document.createElement("td");d.className="type2";var f=document.createElement("a"),g=document.createElement("span");g.innerHTML=a.value;f.appendChild(g);f.title=a.value;a=document.createElement("td");a.className="type2";a.style.width="65%";var g=document.createElement("a"),h=document.createElement("span");h.innerHTML=e.value;g.appendChild(h);g.title=e.value;d.appendChild(f);c.appendChild(d);a.appendChild(g);c.appendChild(a);b.appendChild(c);e.value=""}}
function btn_common_event_mod_click(){if(_clicked_event){var a=document.getElementById("input_event_name"),e=document.getElementById("input_event_function"),b=document.getElementById("event_table"),c=b.childNodes.length;if(0<c)for(var d=0;d<c;d++)if("white"==b.childNodes[d].style.background&&a.value==b.childNodes[d].getElementsByTagName("span")[0].innerHTML){alert(a.value+" "+LayerWin.dext5_lang.input_common.event_duplicate_msg);return}_clicked_event.getElementsByTagName("span")[0].innerHTML=a.value;
_clicked_event.getElementsByTagName("span")[1].innerHTML=e.value}}function btn_common_event_del_click(){document.getElementById("event_table");document.getElementById("btn_event_add");var a=document.getElementById("btn_event_modify"),e=document.getElementById("btn_event_delete");document.getElementById("input_event_function").value="";_clicked_event&&_clicked_event.parentNode.removeChild(_clicked_event);a.disabled=!0;a.className="non_btn";e.disabled=!0;e.className="non_btn"}
function dext_insert_input_select(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertSize:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertMultiselect:!1,insertOptionsArr:[],insertOptionsValueArr:[],insertOptionsSelected:[],insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;
a.insertTitle=document.getElementById("input_title").value;a.insertSize="0"==document.getElementById("input_size").value?"":document.getElementById("input_size").value;a.insertWidth=document.getElementById("input_width").value;a.insertHeight=document.getElementById("input_height").value;a.insertDisabled=document.getElementById("input_disabled").checked;a.insertMultiselect=document.getElementById("input_multiselect").checked;for(var e=document.getElementById("option_table"),b=e.childNodes.length,c=
0;c<b;c++){var d=e.childNodes[c].getElementsByTagName("span"),f=e.childNodes[c].getElementsByTagName("input")[0];a.insertOptionsArr.push(d[0].innerHTML);a.insertOptionsValueArr.push(d[1].innerHTML);a.insertOptionsSelected.push(f.checked)}e=document.getElementById("event_table");b=e.childNodes.length;for(c=0;c<b;c++)d=e.childNodes[c].getElementsByTagName("span"),a.insertEventNameArr.push(d[0].innerHTML),a.insertEventFunctionArr.push(d[1].innerHTML);LayerWin.event_dext_insert_input_select(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_select(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.size&&(document.getElementById("input_size").value=elemModify.size);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.multiple&&(document.getElementById("input_multiselect").checked=!0);for(var a=elemModify.getElementsByTagName("option"),
e=a.length,b=0;b<e;b++){var c=a[b].innerHTML,d=a[b].value;document.getElementById("btn_add");var f=document.getElementById("option_table"),g=document.getElementById("input_value"),h=document.createElement("tr"),m=document.createElement("td");m.className="type";var k=document.createElement("input");k.type="checkbox";var n=document.createElement("td");n.className="type2";n.style.width="44%";var p=document.createElement("a"),q=document.createElement("span");q.innerHTML=c;p.appendChild(q);p.title=c;q=
document.createElement("td");q.className="type2";q.style.width="44%";var c=document.createElement("a"),r=document.createElement("span");r.innerHTML=d;c.appendChild(r);c.title=d;m.appendChild(k);h.appendChild(m);n.appendChild(p);h.appendChild(n);q.appendChild(c);h.appendChild(q);f.appendChild(h);LayerWin.DEXTTOP.DEXT5.util.addEvent(k,"click",function(a){a=a.target?a.target:a.srcElement;if(0==document.getElementById("input_multiselect").checked)if(1==a.checked)for(var b=f.getElementsByTagName("input"),
c=b.length,e=0;e<c;e++)b[e]!=a?b[e].checked=!1:(a.checked=!0,g.value=r.innerHTML);else g.value="";else if(1==a.checked)g.value=r.innerHTML;else for(b=f.getElementsByTagName("input"),c=b.length,g.value="",e=0;e<c;e++)if(b[e].checked){g.value=f.childNodes[e].getElementsByTagName("span")[1].innerHTML;break}});a[b].selected&&(k.checked=!0)}if(elemModify.getAttribute("dext5customdata")&&(h=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata")),"event"==h.type))for(b=h.eventFunction,a=h.eventName.split("\x0B"),
e=b.split("\x0B"),d=a.length,b=0;b<d;b++)f=document.getElementById("event_table"),h=document.createElement("tr"),m=document.createElement("td"),m.className="type2",k=document.createElement("a"),n=document.createElement("span"),n.innerHTML=a[b],k.appendChild(n),k.title=a[b],n=document.createElement("td"),n.className="type2",n.style.width="65%",p=document.createElement("a"),q=document.createElement("span"),q.innerHTML=e[b],p.appendChild(q),p.title=e[b],m.appendChild(k),h.appendChild(m),n.appendChild(p),
h.appendChild(n),f.appendChild(h)}
function dext_modify_input_select(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?elemModify.className=
document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_size").value&&"0"!=document.getElementById("input_size").value?elemModify.size=document.getElementById("input_size").value:elemModify.removeAttribute("size");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+
"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;elemModify.multiple=document.getElementById("input_multiselect").checked;elemModify.innerHTML="";for(var a=document.getElementById("option_table"),e=a.childNodes.length,b=0;b<e;b++){var c=document.createElement("option");c.innerHTML=a.childNodes[b].getElementsByTagName("span")[0].innerHTML;
c.setAttribute("value",a.childNodes[b].getElementsByTagName("span")[1].innerHTML);c.selected=a.childNodes[b].getElementsByTagName("input")[0].checked;elemModify.appendChild(c)}""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(b=elemModify.outerHTML,b=b.replace('name="'+elemModify.name+'"',""),b=b.replace("name='"+elemModify.name+"'",""),
b=b.replace("name="+elemModify.name,""),b=b.replace(">",' name="'+document.getElementById("input_name").value+'" >'),elemModify.outerHTML=b):elemModify.removeAttribute("name");var c=document.getElementById("event_table"),d=c.childNodes.length;if(0<d){e=a="";for(b=0;b<d;b++)0!=b&&(a+="\x0B",e+="\x0B"),a+=c.childNodes[b].getElementsByTagName("span")[0].innerHTML,e+=c.childNodes[b].getElementsByTagName("span")[1].innerHTML;""!=a&&(b={type:"event"},b.eventName=a,b.eventFunction=e,LayerWin.setDextCustomData(elemModify,
b))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function dext_insert_input_textarea(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertWidth:"",insertHeight:"",insertAlign:"",insertDisabled:!1,insertReadonly:!1,insertRows:"",insertCols:"",insertWrap:"",insertEventNameArr:[],insertEventFunctionArr:[],insertPlaceholder:""};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;
a.insertTitle=document.getElementById("input_title").value;a.insertWidth=document.getElementById("input_width").value;a.insertHeight=document.getElementById("input_height").value;a.insertAlign=document.getElementById("input_textalign").value;a.insertDisabled=document.getElementById("input_disabled").checked;a.insertReadonly=document.getElementById("input_readonly").checked;a.insertRows="0"==document.getElementById("input_rows").value?"":document.getElementById("input_rows").value;a.insertCols="0"==
document.getElementById("input_cols").value?"":document.getElementById("input_cols").value;a.insertPlaceholder=document.getElementById("input_placeholder").value;for(var e=document.getElementById("event_table"),b=e.childNodes.length,c=0;c<b;c++){var d=e.childNodes[c].getElementsByTagName("span");a.insertEventNameArr.push(d[0].innerHTML);a.insertEventFunctionArr.push(d[1].innerHTML)}LayerWin.event_dext_insert_input_textarea(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_textarea(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);""!=elemModify.value&&(document.getElementById("input_value").value=elemModify.value);""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=elemModify.title);""!=elemModify.style.width&&(document.getElementById("input_width").value=
parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign);elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.readOnly&&(document.getElementById("input_readonly").checked=!0);""!=elemModify.rows&&(document.getElementById("input_rows").value=elemModify.rows);""!=elemModify.cols&&
(document.getElementById("input_cols").value=elemModify.cols);if(elemModify.getAttribute("dext5customdata")){var a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));if("event"==a.type){var e=a.eventFunction,a=a.eventName.split("\x0B"),e=e.split("\x0B"),b=a.length;for(i=0;i<b;i++){var c=document.getElementById("event_table"),d=document.createElement("tr"),f=document.createElement("td");f.className="type2";var g=document.createElement("a"),h=document.createElement("span");h.innerHTML=
a[i];g.appendChild(h);g.title=a[i];h=document.createElement("td");h.className="type2";h.style.width="65%";var m=document.createElement("a"),k=document.createElement("span");k.innerHTML=e[i];m.appendChild(k);m.title=e[i];f.appendChild(g);d.appendChild(f);h.appendChild(m);d.appendChild(h);c.appendChild(d)}}}}
function dext_modify_input_textarea(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?(elemModify.value=document.getElementById("input_value").value,elemModify.innerHTML=document.getElementById("input_value").value):(elemModify.value="",elemModify.innerHTML="");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");
""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=
document.getElementById("input_height").value+"px":elemModify.style.height="";""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="";elemModify.disabled=document.getElementById("input_disabled").checked;elemModify.readOnly=document.getElementById("input_readonly").checked;""!=document.getElementById("input_rows").value&&"0"!=document.getElementById("input_rows").value?elemModify.rows=document.getElementById("input_rows").value:
elemModify.removeAttribute("rows");""!=document.getElementById("input_cols").value&&"0"!=document.getElementById("input_cols").value?elemModify.cols=document.getElementById("input_cols").value:elemModify.removeAttribute("cols");if(""!=document.getElementById("input_name").value)if(DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie)elemModify.setAttribute("name",document.getElementById("input_name").value);else{var a=elemModify.outerHTML,a=a.replace('name="'+elemModify.name+
'"',""),a=a.replace("name='"+elemModify.name+"'",""),a=a.replace("name="+elemModify.name,""),a=a.replace(">",' name="'+document.getElementById("input_name").value+'" >');elemModify.outerHTML=a}else elemModify.removeAttribute("name");var e=document.getElementById("event_table"),b=e.childNodes.length;if(0<b){for(var c=a="",d=0;d<b;d++)0!=d&&(a+="\x0B",c+="\x0B"),a+=e.childNodes[d].getElementsByTagName("span")[0].innerHTML,c+=e.childNodes[d].getElementsByTagName("span")[1].innerHTML;""!=a&&(e={type:"event"},
e.eventName=a,e.eventFunction=c,LayerWin.setDextCustomData(elemModify,e))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function dext_insert_input_hidden(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:""};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;LayerWin.event_dext_insert_input_hidden(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_hidden(){var a=elemModify.getAttribute("dext5customdata");null!=a&&void 0!=a&&(a=LayerWin.getDextCustomData(a),""!=a.id&&(document.getElementById("input_id").value=a.id),""!=a.name&&(document.getElementById("input_name").value=a.name),""!=a.value&&(document.getElementById("input_value").value=a.value),""!=a.className&&(document.getElementById("input_class").value=a.className),""!=a.title&&(document.getElementById("input_title").value=a.title))}
function dext_modify_input_hidden(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:""};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;
LayerWin.event_dext_insert_input_hidden(a,window.frameElement.parentNode.parentNode)}
function dext_insert_input_image(){var a=document.dext_upload_form,e;e=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:document.getElementById(file_field_id);var b=document.getElementById("img_web_url"),b=document.getElementsByName("InputFlag")[0].checked?e.value:b.value;if(0<b.lastIndexOf(".")){var c=b.substring(b.lastIndexOf(".")+1).toLowerCase();document.getElementsByName("InputFlag")[0].checked?
("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util._fn_$mEPF(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(getBoundrayRanNumber()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=
DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=
DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=getBoundrayRanNumber(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=
LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=
LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),a.setItem("document_domain",document.getElementById("document_domain").value),
a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),
a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("image_convert_format",document.getElementById("image_convert_format").value),a.setItem("image_convert_width",document.getElementById("image_convert_width").value),a.setItem("image_convert_height",document.getElementById("image_convert_height").value),a.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&a.setItem("originalfilename",document.getElementById("originalfilename").value),
a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(a),uploadAjaxOnprogressStart({uploadType:"image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:e.id,fileObj:G_dragDropFileObj,formData:a},event_dext_input_image_upload_completed)):(a.action=document.getElementById("upload_url").value,a.submit())):event_dext_input_image_upload_completed(b)}else alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_input_image_upload_completed(a,e){var b=document.getElementById("input_width").value,c=document.getElementById("input_height").value,d=0,f=0;if(null!=a&&void 0!=a){a=a.replace(/<.*?script.*\/?>/g,"");a=a.replace(/\r\n/g,"");a=a.replace(/\n/g,"");a=a.replace(/\t/g,"");if((a=web_url_remove_char(a))&&""!=a)try{var g;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?g=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&
(g=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a));null!=g&&void 0!=g&&(a=g)}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}g=a.split("?");2==g.length&&(a=g[0],g=g[1].split("^"),1==g.length?a+="?"+g[0]:2==g.length?(d=g[0],f=g[1]):3==g.length&&(d=g[0],f=g[1],a+="?"+g[2]));if(elemModify&&"input"==elemModify.tagName.toLowerCase()&&"image"==elemModify.type){elemModify.src=a;return}if("1"==LayerWin._dext_editor._config.image_auto_fit&&d>LayerWin._dext_editor._defaultWidth)g=
LayerWin._dext_editor._defaultWidth/d,d=LayerWin._dext_editor._defaultWidth,f*=g;else if("2"==LayerWin._dext_editor._config.image_auto_fit&&(d>LayerWin._dext_editor._defaultWidth||f>LayerWin._dext_editor._defaultHeight)){b=LayerWin._dext_editor._defaultWidth;c=LayerWin._dext_editor._defaultHeight;g=c/b;var m=f/d;m>g?f>c?b=Math.round(d*c/f):(b=d,c=f):m<g?d>b?c=Math.round(f*b/d):(b=d,c=f):(b=d,c=f)}}0==b.length&&0<d&&(b=parseInt(d),c=parseInt(f));loading_image_show(!1);if("[FAIL]"==a.substring(0,6)||
"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{var k;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError?k=DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"fileUpload",message:a,response:e.response}):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&(k=DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"fileUpload",message:a,response:e.response}));if(0==k)return}catch(n){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))d=!0,"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(d=confirm(LayerWin.dext5_lang.msg.uploadFailed)),d&&(d=a.indexOf("HTTP Error"),f=a.indexOf("HTTP Status"),-1<d?alert(a.substring(d,d+16)):-1<f&&alert(a.substring(f,f+15)));else if("[FAIL]"==a.substring(0,6))d=!0,"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&
(d=confirm(LayerWin.dext5_lang.msg.uploadFailed)),d&&alert(a);else{d={insertName:"",insertValue:"",insertSrc:a,insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertType:"image",insertEventNameArr:[],insertEventFunctionArr:[]};d.insertName=document.getElementById("input_name").value;d.insertValue=document.getElementById("input_value").value;d.insertId=document.getElementById("input_id").value;d.insertClass=document.getElementById("input_class").value;
d.insertTitle=document.getElementById("input_title").value;d.insertAlign=document.getElementById("input_textalign").value;d.insertWidth=b;d.insertHeight=c;d.insertDisabled=document.getElementById("input_disabled").checked;f=document.getElementById("event_table");k=f.childNodes.length;for(b=0;b<k;b++)c=f.childNodes[b].getElementsByTagName("span"),d.insertEventNameArr.push(c[0].innerHTML),d.insertEventFunctionArr.push(c[1].innerHTML);LayerWin.event_dext_insert_input_image(d,window.frameElement.parentNode.parentNode)}}
function set_modify_field_input_image(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.align);""==elemModify.style.width.replace("px","")?document.getElementById("input_width").value=parseInt(elemModify.width,10):document.getElementById("input_width").value=elemModify.style.width.replace("px","");""==elemModify.style.height.replace("px","")?document.getElementById("input_height").value=parseInt(elemModify.height,10):document.getElementById("input_height").value=elemModify.style.height.replace("px",
"");elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);var a=elemModify.outerHTML.match(RegExp("srcs*=s*(\"|')(([^\"']*))(\"|')","gi")),e="";a&&0<a.length&&(e=a[0].replace("src=",""),e=e.replace(/\'/g,""),e=e.replace(/\"/g,""),e=e.replace(/\&amp;/g,"&"));document.getElementById("img_web_url").value=e;var b=document.getElementById("img_ratio"),c=document.getElementById("input_width"),d=document.getElementById("input_height"),f,g;f=c.value;g=d.value;c.value=Math.round(f);d.value=
Math.round(g);"1"==LayerWin._dext_editor._config.allowImgSize&&(b.style.display="block",b.className="img_link_active_btn",b.setAttribute("ratio-checked","true"));DEXTTOP.DEXT5.util.addEvent(c,"keyup",function(){if("true"==b.getAttribute("ratio-checked")){var a=parseInt(g,10)*parseInt(c.value,10)/parseInt(f,10);d.value=isNaN(a)?d.value:Math.round(a)}});DEXTTOP.DEXT5.util.addEvent(d,"keyup",function(){if("true"==b.getAttribute("ratio-checked")){var a=parseInt(f,10)*parseInt(d.value,10)/parseInt(g,10);
c.value=isNaN(a)?c.value:Math.round(a)}});if(elemModify.getAttribute("dext5customdata")&&(a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata")),"event"==a.type)){var e=a.eventFunction,a=a.eventName.split("\x0B"),e=e.split("\x0B"),h=a.length;for(i=0;i<h;i++){var m=document.getElementById("event_table"),k=document.createElement("tr"),n=document.createElement("td");n.className="type2";var p=document.createElement("a"),q=document.createElement("span");q.innerHTML=a[i];p.appendChild(q);
p.title=a[i];q=document.createElement("td");q.className="type2";q.style.width="65%";var r=document.createElement("a"),u=document.createElement("span");u.innerHTML=e[i];r.appendChild(u);r.title=e[i];n.appendChild(p);k.appendChild(n);q.appendChild(r);k.appendChild(q);m.appendChild(k)}}"1"==Dext5LayerWin._dext_editor._config.uploadUseHTML5&&(a=document.getElementById("radio_image_url"),document.getElementById("radio_image").removeAttribute("checked"),a.setAttribute("checked","checked"),InputFlag_change(a))}
function dext_modify_input_image(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var a=document.getElementById(file_field_id);a.value&&""!=a.value&&dext_insert_input_image();a=document.getElementById(file_field_id);a.value&&""!=a.value||"1"==Dext5LayerWin._dext_editor._config.uploadUseHTML5&&G_dragDropFileObj?dext_insert_input_image():(a=document.getElementById("img_web_url"),elemModify.src=a.value);""!=document.getElementById("input_value").value?
elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:
elemModify.removeAttribute("title");""!=document.getElementById("input_textalign").value?elemModify.align=document.getElementById("input_textalign").value:elemModify.removeAttribute("align");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=
document.getElementById("input_disabled").checked;""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(a=elemModify.outerHTML,a=a.replace('name="'+elemModify.name+'"',""),a=a.replace("name='"+elemModify.name+"'",""),a=a.replace("name="+elemModify.name,""),a=a.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=
a):elemModify.removeAttribute("name");var e=document.getElementById("event_table"),b=e.childNodes.length;if(0<b){for(var c=a="",d=0;d<b;d++)0!=d&&(a+="\x0B",c+="\x0B"),a+=e.childNodes[d].getElementsByTagName("span")[0].innerHTML,c+=e.childNodes[d].getElementsByTagName("span")[1].innerHTML;""!=a&&(e={type:"event"},e.eventName=a,e.eventFunction=c,LayerWin.setDextCustomData(elemModify,e))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0;event_dext_close()}function event_dext_horizontal_line_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}
function event_dext_image_upload_cancel(){"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&LayerWin.closeBtnPreViewMode();"1"==LayerWin._dext_editor._config.uploadUseHTML5&&"function"==typeof uploadAjaxOnprogressCancel&&uploadAjaxOnprogressCancel();LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode);if("undefined"!=typeof elemModify)try{LayerWin.contentChangeEventWrapper()}catch(a){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function event_dext_bg_image_upload_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_flash_upload_cancel(){clearWindow(window);LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_media_upload_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}
function event_dext_table_cancel(){"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&LayerWin.closeBtnPreViewMode();LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}
function event_dext_doc_cancel(){"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&LayerWin.closeBtnPreViewMode();LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_emoticon_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}
function event_dext_about_close(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_close(a){"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&LayerWin.closeBtnPreViewMode();LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}
function event_dext_insert_datetime_close(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_insert_datetime(a){LayerWin.command_insert_datetime(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,a)}function clearWindow(a){a.document.open("text/html","replace");isCustomDomain()&&(a.document.domain=LayerWin.document.domain);a.document.write("<html><head></head><body></body></html>");a.document.close()}
function isCustomDomain(){if(!DEXTTOP.DEXT5.browser.ie)return!1;var a=LayerWin.document.domain,e=window.location.hostname;return a!=e&&a!="["+e+"]"}
function setCursorPos(a,e,b){null!=a&&void 0!=a&&null==navigator.userAgent.match(/iPhone|iPad/)&&setTimeout(function(){var c=0;a.value&&(c=a.value.length);try{var d={};"1"==LayerWin._dext_editor._config.autoRepositionPopupAndMenu.enableTransition&&(d.preventScroll=!0);if(0!=c&&0!=e)if("setSelectionRange"in a)b?a.setSelectionRange(0,c):a.setSelectionRange(c,c);else if("createTextRange"in a){var f=a.createTextRange();b||f.moveStart("character",c);f.select()}a.focus(d)}catch(g){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}},0)}function event_tab(a,e){9==("which"in a?a.which:a.keyCode)&&"last"==(a.target?a.target:a.srcElement).getAttribute("last_cursor_obj")&&(setCursorPos(e,!0,!1),DEXTTOP.DEXT5.util.cancelEvent(a))}
function edgeClick(a,e){LayerWin._dext_editor.applyEdgeMode="user";edgeSelectClick(4,"user");var b=document.getElementById("topcell1"),c=document.getElementById("topcell2"),d=document.getElementById("bottomcell1"),f=document.getElementById("bottomcell2"),g=function(a,b){var c="",c=" "==document.getElementById("line_thickness").value?c+G_prevCellStyle[a][0][b].width:c+(document.getElementById("line_thickness").value+"px"),c="none"==document.getElementById("line_style").style.borderTopStyle&&"0"!=document.getElementById("line_thickness").value?
c+(" "+G_prevCellStyle[a][0][b].style):c+(" "+document.getElementById("line_style").style.borderTopStyle);return c="none"==document.getElementById("line_color").style.borderTopStyle&&"0"!=document.getElementById("line_thickness").value?c+(" "+G_prevCellStyle[a][0][b].color):c+(" "+document.getElementById("line_color").style.borderTopColor)},h=[],m=function(a){h.push(a.split(" ")[0]);h.push(a.split(" ")[1]);(a=a.match(/rgb\(\d{1,3}, ?\d{1,3}, ?\d{1,3}\)$|rgb\(\d{1,3},\d{1,3},\d{1,3}\)|#[0-9a-fA-F]{6}|#[0-9a-fA-F]{3}/))?
h.push(a[0]):h.push("")};document.getElementById("edge_top");document.getElementById("edge_horizon");document.getElementById("edge_bottom");document.getElementById("edge_left");document.getElementById("edge_vertical");document.getElementById("edge_right");var k=document.getElementById("edge_"+a),n=document.getElementById("oldValue"),n=n?LayerWin.DEXTTOP.G_CURREDITOR._FRAMEWIN.JSON.parse(n.value):null;document.getElementById("edge_"+a).src.split("/");if("deactive"==DEXTTOP.DEXT5.util.getCustomAttribute(k,
"imgstate")){document.getElementById("edge_"+a).src="../images/editor/dialog/editor_line_"+a+"_img.gif";DEXTTOP.DEXT5.util.setCustomAttribute(k,"imgstate","active");var k="",k=""==document.getElementById("line_kind").value?k+(document.getElementById("line_thickness").value+"px"):k+document.getElementById("line_kind").value,k=k+(" "+document.getElementById("line_style").style.borderTopStyle),k=k+(" "+document.getElementById("line_color").style.borderTopColor),p=" "==document.getElementById("line_thickness").value||
"none"==document.getElementById("line_style").style.borderTopStyle||"none"==document.getElementById("line_color").style.borderTopStyle;if("top"==a)b&&(p?(k=g("topCell1","top"),""==G_prevCellStyle.topCell1[0].top.width+G_prevCellStyle.topCell1[0].top.style+G_prevCellStyle.topCell1[0].top.color&&(cellAddClass(b,"dext_cell_border_t"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-top-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-top-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-top-color"))):
cellRemoveClass(b,"dext_cell_border_t"),m(k),b.style.borderTopWidth=h[0],b.style.borderTopStyle=h[1],b.style.borderTopColor=h[2]),c&&(p&&""==G_prevCellStyle.topCell2[0].top.width+G_prevCellStyle.topCell2[0].top.style+G_prevCellStyle.topCell2[0].top.color?(cellAddClass(c,"dext_cell_border_t"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-top-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-top-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-top-color")):cellRemoveClass(c,"dext_cell_border_t"),
c.style.borderTopWidth=h[0],c.style.borderTopStyle=h[1],c.style.borderTopColor=h[2]),setClickedBorderCheck(["outsideTop"],n);else if("horizon"==a)d&&(p?(k=g("topCell1","bottom"),""==G_prevCellStyle.topCell1[0].bottom.width+G_prevCellStyle.topCell1[0].bottom.style+G_prevCellStyle.topCell1[0].bottom.color&&(cellAddClass(b,"dext_cell_border_b"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-bottom-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-bottom-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,
"border-bottom-color")),""==G_prevCellStyle.bottomCell1[0].top.width+G_prevCellStyle.bottomCell1[0].top.style+G_prevCellStyle.bottomCell1[0].top.color&&(cellAddClass(d,"dext_cell_border_t"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-top-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-top-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-top-color"))):(cellRemoveClass(b,"dext_cell_border_b"),cellRemoveClass(d,"dext_cell_border_t")),m(k),b.style.borderBottomWidth=h[0],b.style.borderBottomStyle=
h[1],b.style.borderBottomColor=h[2],d.style.borderTopWidth=h[0],d.style.borderTopStyle=h[1],d.style.borderTopColor=h[2]),f&&(p?(""==G_prevCellStyle.topCell2[0].bottom.width+G_prevCellStyle.topCell2[0].bottom.style+G_prevCellStyle.topCell2[0].bottom.color&&(cellAddClass(c,"dext_cell_border_b"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-bottom-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-bottom-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-bottom-color")),""==G_prevCellStyle.bottomCell2[0].top.width+
G_prevCellStyle.bottomCell2[0].top.style+G_prevCellStyle.bottomCell2[0].top.color&&(cellAddClass(f,"dext_cell_border_t"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-top-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-top-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-top-color"))):(cellRemoveClass(c,"dext_cell_border_b"),cellRemoveClass(f,"dext_cell_border_t")),m(k),c.style.borderBottomWidth=h[0],c.style.borderBottomStyle=h[1],c.style.borderBottomColor=h[2],f.style.borderTopWidth=
h[0],f.style.borderTopStyle=h[1],f.style.borderTopColor=h[2]),setClickedBorderCheck(["insideRow"],n);else if("bottom"==a)d?(p?(k=g("bottomCell1","bottom"),""==G_prevCellStyle.bottomCell1[0].bottom.width+G_prevCellStyle.bottomCell1[0].bottom.style+G_prevCellStyle.bottomCell1[0].bottom.color&&(cellAddClass(d,"dext_cell_border_b"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-bottom-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-bottom-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,
"border-bottom-color"))):cellRemoveClass(d,"dext_cell_border_b"),m(k),d.style.borderBottomWidth=h[0],d.style.borderBottomStyle=h[1],d.style.borderBottomColor=h[2],f&&(p&&""==G_prevCellStyle.bottomCell2[0].bottom.width+G_prevCellStyle.bottomCell2[0].bottom.style+G_prevCellStyle.bottomCell2[0].bottom.color?(cellAddClass(f,"dext_cell_border_b"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-bottom-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-bottom-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,
"border-bottom-color")):cellRemoveClass(f,"dext_cell_border_b"),f.style.borderBottomWidth=h[0],f.style.borderBottomStyle=h[1],f.style.borderBottomColor=h[2])):(b&&(p?(k=g("topCell1","bottom"),""==G_prevCellStyle.topCell1[0].bottom.width+G_prevCellStyle.topCell1[0].bottom.style+G_prevCellStyle.topCell1[0].bottom.color&&(cellAddClass(b,"dext_cell_border_b"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-bottom-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-bottom-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,
"border-bottom-color"))):cellRemoveClass(b,"dext_cell_border_b"),m(k),b.style.borderBottomWidth=h[0],b.style.borderBottomStyle=h[1],b.style.borderBottomColor=h[2]),c&&(p&&""==G_prevCellStyle.topCell2[0].bottom.width+G_prevCellStyle.topCell2[0].bottom.style+G_prevCellStyle.topCell2[0].bottom.color?(cellAddClass(c,"dext_cell_border_b"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-bottom-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-bottom-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,
"border-bottom-color")):cellRemoveClass(c,"dext_cell_border_b"),c.style.borderBottomWidth=h[0],c.style.borderBottomStyle=h[1],c.style.borderBottomColor=h[2])),setClickedBorderCheck(["outsideBottom"],n);else if("left"==a)b&&(p?(k=g("topCell1","left"),""==G_prevCellStyle.topCell1[0].left.width+G_prevCellStyle.topCell1[0].left.style+G_prevCellStyle.topCell1[0].left.color&&(cellAddClass(b,"dext_cell_border_l"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-left-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,
"border-left-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-left-color"))):cellRemoveClass(b,"dext_cell_border_l"),m(k),b.style.borderLeftWidth=h[0],b.style.borderLeftStyle=h[1],b.style.borderLeftColor=h[2]),d&&(p&&""==G_prevCellStyle.bottomCell1[0].left.width+G_prevCellStyle.bottomCell1[0].left.style+G_prevCellStyle.bottomCell1[0].left.color?(cellAddClass(d,"dext_cell_border_l"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-left-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-left-style"),
DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-left-color")):cellRemoveClass(d,"dext_cell_border_l"),d.style.borderLeftWidth=h[0],d.style.borderLeftStyle=h[1],d.style.borderLeftColor=h[2]),setClickedBorderCheck(["outsideLeft"],n);else if("vertical"==a)c&&(p?(k=g("topCell1","right"),""==G_prevCellStyle.topCell1[0].right.width+G_prevCellStyle.topCell1[0].right.style+G_prevCellStyle.topCell1[0].right.color&&(cellAddClass(b,"dext_cell_border_r"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-right-width"),
DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-right-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-right-color"))):(cellRemoveClass(b,"dext_cell_border_r"),cellRemoveClass(c,"dext_cell_border_l")),m(k),b.style.borderRightWidth=h[0],b.style.borderRightStyle=h[1],b.style.borderRightColor=h[2],c.style.borderLeftWidth=h[0],c.style.borderLeftStyle=h[1],c.style.borderLeftColor=h[2]),f&&(p?(""==G_prevCellStyle.bottomCell1[0].right.width+G_prevCellStyle.bottomCell1[0].right.style+G_prevCellStyle.bottomCell1[0].right.color&&
(cellAddClass(d,"dext_cell_border_r"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-right-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-right-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-right-color")),""==G_prevCellStyle.bottomCell2[0].left.width+G_prevCellStyle.bottomCell2[0].left.style+G_prevCellStyle.bottomCell2[0].left.color&&(cellAddClass(f,"dext_cell_border_l"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-left-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,
"border-left-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-left-color"))):(cellRemoveClass(d,"dext_cell_border_r"),cellRemoveClass(f,"dext_cell_border_l")),m(k),d.style.borderRightWidth=h[0],d.style.borderRightStyle=h[1],d.style.borderRightColor=h[2],f.style.borderLeftWidth=h[0],f.style.borderLeftStyle=h[1],f.style.borderLeftColor=h[2]),setClickedBorderCheck(["insideCol"],n);else if("right"==a)c?(p?(k=g("topCell2","right"),""==G_prevCellStyle.topCell2[0].right.width+G_prevCellStyle.topCell2[0].right.style+
G_prevCellStyle.topCell2[0].right.color&&(cellAddClass(c,"dext_cell_border_r"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-right-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-right-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-right-color"))):cellRemoveClass(c,"dext_cell_border_r"),m(k),c.style.borderRightWidth=h[0],c.style.borderRightStyle=h[1],c.style.borderRightColor=h[2],f&&(p&&""==G_prevCellStyle.bottomCell2[0].right.width+G_prevCellStyle.bottomCell2[0].right.style+
G_prevCellStyle.bottomCell2[0].right.color?(cellAddClass(f,"dext_cell_border_r"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-right-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-right-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-right-color")):cellRemoveClass(f,"dext_cell_border_r"),f.style.borderRightWidth=h[0],f.style.borderRightStyle=h[1],f.style.borderRightColor=h[2])):(b&&(p?(k=g("topCell1","right"),""==G_prevCellStyle.topCell1[0].right.width+G_prevCellStyle.topCell1[0].right.style+
G_prevCellStyle.topCell1[0].right.color&&(cellAddClass(b,"dext_cell_border_r"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-right-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-right-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(b,"border-right-color"))):cellRemoveClass(b,"dext_cell_border_r"),m(k),b.style.borderRightWidth=h[0],b.style.borderRightStyle=h[1],b.style.borderRightColor=h[2]),d&&(p&&""==G_prevCellStyle.bottomCell1[0].right.width+G_prevCellStyle.bottomCell1[0].right.style+
G_prevCellStyle.bottomCell1[0].right.color?(cellAddClass(d,"dext_cell_border_r"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-right-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-right-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-right-color")):cellRemoveClass(d,"dext_cell_border_r"),d.style.borderRightWidth=h[0],d.style.borderRightStyle=h[1],d.style.borderRightColor=h[2])),setClickedBorderCheck(["outsideRight"],n);else if(LayerWin.G_DEXT_Diagonal&&"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&
-1<a.indexOf("dext_diagonal")){n=k.split(" ");b=[b,c,d,f];d=a.split("_")[2];for(c=0;4>c;c++){if(g=LayerWin.findDiagonal(b[c],!0))f=g.diagonalUp,g=g.diagonalDown,0<f.length&&"up"==d&&(LayerWin.removeClassName(f[0],"dext_cell_border_t"),LayerWin.removeClassName(f[0],"diff")),LayerWin.G_DEXT_Diagonal.makeDiagonal(b[c],d,k,!0),0<g.length&&"down"==d&&(LayerWin.removeClassName(g[0],"dext_cell_border_t"),LayerWin.removeClassName(g[0],"diff"));LayerWin.G_DEXT_Diagonal.makeDiagonal(b[c],d,k,!0,null,!0)}0!=
DEXTTOP.DEXT5.util.parseIntOr0(n[0])&&"none"!=n[1]&&LayerWin.DEXTTOP.DEXT5.util.openModal(document,LayerWin.dext5_lang.msg.dext_diagonal_warning,DEXTTOP.G_CURREDITOR._config.diagonal.useNotification)}}else if("active"==DEXTTOP.DEXT5.util.getCustomAttribute(k,"imgstate"))if(document.getElementById("edge_"+a).src="../images/editor/dialog/editor_line_"+a+"_d_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(k,"imgstate","deactive"),g=k="",e||(k="1px none rgb(0, 0, 0)",g="1px"),"top"==a)b&&(b.style.borderTop=
k,b.style.borderTopWidth=g,e&&cellAddClass(b,"dext_cell_border_t"),null!=b.className&&cellRemoveClass(b,"dext_cell_border_t")),c&&(c.style.borderTop=k,c.style.borderTopWidth=g,e&&cellAddClass(c,"dext_cell_border_t"),null!=c.className&&cellRemoveClass(c,"dext_cell_border_t")),setClickedBorderCheck(["outsideTop"],n);else if("horizon"==a)d&&(b.style.borderBottom=k,d.style.borderTop=k,b.style.borderBottomWidth=g,d.style.borderTopWidth=g,e&&(cellAddClass(b,"dext_cell_border_b"),cellAddClass(d,"dext_cell_border_t")),
null!=b.className&&cellRemoveClass(b,"dext_cell_border_b"),null!=d.className&&cellRemoveClass(d,"dext_cell_border_t")),f&&(c.style.borderBottom=k,f.style.borderTop=k,c.style.borderBottomWidth=g,f.style.borderTopWidth=g,e&&(cellAddClass(c,"dext_cell_border_b"),cellAddClass(f,"dext_cell_border_t")),null!=c.className&&cellRemoveClass(c,"dext_cell_border_b"),null!=f.className&&cellRemoveClass(f,"dext_cell_border_t")),setClickedBorderCheck(["insideRow"],n);else if("bottom"==a)d?(d.style.borderBottom=k,
d.style.borderBottomWidth=g,e&&cellAddClass(d,"dext_cell_border_b"),null!=d.className&&cellRemoveClass(d,"dext_cell_border_b"),f&&(f.style.borderBottom=k,f.style.borderBottomWidth=g,e&&cellAddClass(f,"dext_cell_border_b"),null!=f.className&&cellRemoveClass(f,"dext_cell_border_b"))):(b&&(b.style.borderBottom=k,b.style.borderBottomWidth=g,e&&cellAddClass(b,"dext_cell_border_b"),null!=b.className&&cellRemoveClass(b,"dext_cell_border_b")),c&&(c.style.borderBottom=k,c.style.borderBottomWidth=g,e&&cellAddClass(c,
"dext_cell_border_b"),null!=c.className&&cellRemoveClass(c,"dext_cell_border_b"))),setClickedBorderCheck(["outsideBottom"],n);else if("left"==a)b&&(b.style.borderLeft=k,b.style.borderLeftWidth=g,e&&cellAddClass(b,"dext_cell_border_l"),null!=b.className&&cellRemoveClass(b,"dext_cell_border_l")),d&&(d.style.borderLeft=k,d.style.borderLeftWidth=g,e&&cellAddClass(d,"dext_cell_border_l"),null!=d.className&&cellRemoveClass(d,"dext_cell_border_l")),setClickedBorderCheck(["outsideLeft"],n);else if("vertical"==
a)c&&(b.style.borderRight=k,c.style.borderLeft=k,b.style.borderRightWidth=g,c.style.borderLeftWidth=g,e&&(cellAddClass(b,"dext_cell_border_r"),cellAddClass(c,"dext_cell_border_l")),null!=b.className&&cellRemoveClass(b,"dext_cell_border_r"),null!=c.className&&cellRemoveClass(c,"dext_cell_border_l")),f&&(d.style.borderRight=k,f.style.borderLeft=k,d.style.borderRightWidth=g,f.style.borderLeftWidth=g,e&&(cellAddClass(d,"dext_cell_border_r"),cellAddClass(f,"dext_cell_border_l")),null!=d.className&&cellRemoveClass(d,
"dext_cell_border_r"),null!=f.className&&cellRemoveClass(f,"dext_cell_border_l")),setClickedBorderCheck(["insideCol"],n);else if("right"==a)c?(c.style.borderRight=k,c.style.borderRightWidth=g,e&&cellAddClass(c,"dext_cell_border_r"),null!=c.className&&cellRemoveClass(c,"dext_cell_border_r"),f&&(f.style.borderRight=k,f.style.borderRightWidth=g,e&&cellAddClass(f,"dext_cell_border_r"),null!=f.className&&cellRemoveClass(f,"dext_cell_border_r"))):(b&&(b.style.borderRight=k,b.style.borderRightWidth=g,e&&
cellAddClass(b,"dext_cell_border_r"),null!=b.className&&cellRemoveClass(b,"dext_cell_border_r")),d&&(d.style.borderRight=k,d.style.borderRightWidth=g,e&&cellAddClass(d,"dext_cell_border_r"),null!=d.className&&cellRemoveClass(d,"dext_cell_border_r"))),setClickedBorderCheck(["outsideRight"],n);else if(-1<a.indexOf("dext_diagonal_")){k=a.substring(a.lastIndexOf("_")+1);b=[b,c,d,f];for(c=0;4>c;c++)LayerWin.deleteDiagonalLine(b[c],k,LayerWin.DEXTTOP.G_CURREDITOR,null,!0);LayerWin.DEXTTOP.DEXT5.util.closeModal(document)}}
function cellRemoveClass(a,e){var b=a.className+" ",c=new RegExp(e+" ","g");c.test(b)&&(b=LayerWin.DEXTTOP.DEXT5.util.trim(b.replace(c," ")),b=b.replace(/\s{2,}/g," "),a.className=b);""==a.className&&a.removeAttribute("class")}function cellAddClass(a,e){0==(new RegExp(e+" ","g")).test(a.className+" ")&&(a.className+=" "+e)}
function parseBorderStyle(a){if(""==a)return{thickness:"",style:"",color:""};var e="none solid dashed dotted double groove ridge inset outset hidden".split(" "),b=["thin","medium","thick"];a=a.split(" ");for(var c="",d="",f="",g=0;3>g;g++){var h=a[g];if("undefined"!=typeof h)-1<h.indexOf("px")||-1<h.indexOf("em")||-1<h.indexOf("cm")||-1<b.indexOf(h)?c=h:-1<e.indexOf(h)?d=h:f=h;else if(2==g)return{thickness:c,style:"none",color:f}}return{thickness:c,style:d,color:f}}
function allThicknessEqual(a){for(var e=1;e<a.length;e++){if(-1==a[e-1].indexOf("0px")&&(-1<a[e-1].indexOf("none")||""==parseBorderStyle(a[e-1]).style))return!1;var b=parseBorderStyle(a[e]).thickness,c=parseBorderStyle(a[e-1]).thickness;if(""==b||""==c||b!=c)return!1}return!0}
function allStyleEqual(a){for(var e=1;e<a.length;e++){var b=parseBorderStyle(a[e]).style,c=parseBorderStyle(a[e-1]).style;if(""==b||""==c)return!1;if(b!==c)return document.getElementById("line_style").style.borderTop="none",!1}return!0}
function allColorEqual(a){for(var e=1;e<a.length;e++){if(-1==a[e-1].indexOf("0px")&&(-1<a[e-1].indexOf("none")||""==parseBorderStyle(a[e-1]).style))return!1;var b=a[e].match(/rgb\(\d{1,3}, ?\d{1,3}, ?\d{1,3}\)$|rgb\(\d{1,3},\d{1,3},\d{1,3}\)|#[0-9a-fA-F]{6}|#[0-9a-fA-F]{3}/),c=a[e-1].match(/rgb\(\d{1,3}, ?\d{1,3}, ?\d{1,3}\)$|rgb\(\d{1,3},\d{1,3},\d{1,3}\)|#[0-9a-fA-F]{6}|#[0-9a-fA-F]{3}/);if(null==b||null==c)return!1;b=DEXTTOP.DEXT5.util.rgb2hex(b[0])?DEXTTOP.DEXT5.util.rgb2hex(b[0]):b[0];c=DEXTTOP.DEXT5.util.rgb2hex(c[0])?
DEXTTOP.DEXT5.util.rgb2hex(c[0]):c[0];if(b!=c)return!1}return!0}
function edgeNoneTotalClick(a,e,b){if("user"!=a){var c=document.getElementById("topcell1"),d=document.getElementById("topcell2"),f=document.getElementById("bottomcell1"),g=document.getElementById("bottomcell2"),h=null,m=null,k=null,n=null;e=function(){h={top:{width:c.style.borderTopWidth,style:c.style.borderTopStyle,color:c.style.borderTopColor},bottom:{width:c.style.borderBottomWidth,style:c.style.borderBottomStyle,color:c.style.borderBottomColor},left:{width:c.style.borderLeftWidth,style:c.style.borderLeftStyle,
color:c.style.borderLeftColor},right:{width:c.style.borderRightWidth,style:c.style.borderRightStyle,color:c.style.borderRightColor}};d&&(m={top:{width:d.style.borderTopWidth,style:d.style.borderTopStyle,color:d.style.borderTopColor},bottom:{width:d.style.borderBottomWidth,style:d.style.borderBottomStyle,color:d.style.borderBottomColor},left:{width:d.style.borderLeftWidth,style:d.style.borderLeftStyle,color:d.style.borderLeftColor},right:{width:d.style.borderRightWidth,style:d.style.borderRightStyle,
color:d.style.borderRightColor}});f&&(k={top:{width:f.style.borderTopWidth,style:f.style.borderTopStyle,color:f.style.borderTopColor},bottom:{width:f.style.borderBottomWidth,style:f.style.borderBottomStyle,color:f.style.borderBottomColor},left:{width:f.style.borderLeftWidth,style:f.style.borderLeftStyle,color:f.style.borderLeftColor},right:{width:f.style.borderRightWidth,style:f.style.borderRightStyle,color:f.style.borderRightColor}});g&&(n={top:{width:g.style.borderTopWidth,style:g.style.borderTopStyle,
color:g.style.borderTopColor},bottom:{width:g.style.borderBottomWidth,style:g.style.borderBottomStyle,color:g.style.borderBottomColor},left:{width:g.style.borderLeftWidth,style:g.style.borderLeftStyle,color:g.style.borderLeftColor},right:{width:g.style.borderRightWidth,style:g.style.borderRightStyle,color:g.style.borderRightColor}})};var p="",q=function(){!c||d||f||g?c&&d&&!f&&!g?p="cols":c&&!d&&f&&!g?p="rows":c&&d&&f&&g&&(p="multi"):p="one";u(p)},r=[],u=function(b){if("multi"==b)if("total"==a||"none"==
a)r=[c.style.borderTop,c.style.borderBottom,c.style.borderLeft,c.style.borderRight,d.style.borderTop,d.style.borderBottom,d.style.borderLeft,d.style.borderRight,f.style.borderTop,f.style.borderBottom,f.style.borderLeft,f.style.borderRight,g.style.borderTop,g.style.borderBottom,g.style.borderLeft,g.style.borderRight];else if("outside"==a||"outline"==a)r=[c.style.borderTop,c.style.borderLeft,d.style.borderTop,d.style.borderRight,f.style.borderBottom,f.style.borderLeft,g.style.borderBottom,g.style.borderRight];
else{if("inside"==a||"inline"==a)r=[c.style.borderBottom,c.style.borderRight,d.style.borderBottom,d.style.borderLeft,f.style.borderTop,f.style.borderRight,g.style.borderTop,g.style.borderLeft]}else if("cols"==b)if("total"==a||"none"==a)r=[c.style.borderTop,c.style.borderBottom,c.style.borderLeft,c.style.borderRight,d.style.borderTop,d.style.borderBottom,d.style.borderLeft,d.style.borderRight];else if("outside"==a||"outline"==a)r=[c.style.borderTop,c.style.borderBottom,c.style.borderLeft,d.style.borderTop,
d.style.borderBottom,d.style.borderRight];else{if("inside"==a||"inline"==a)r=[c.style.borderRight,d.style.borderLeft]}else if("rows"==b)if("total"==a||"none"==a)r=[c.style.borderTop,c.style.borderBottom,c.style.borderLeft,c.style.borderRight,f.style.borderTop,f.style.borderBottom,f.style.borderLeft,f.style.borderRight];else if("outside"==a||"outline"==a)r=[c.style.borderTop,c.style.borderLeft,c.style.borderRight,f.style.borderBottom,f.style.borderLeft,f.style.borderRight];else{if("inside"==a||"inline"==
a)r=[c.style.borderBottom,f.style.borderTop]}else"one"==b&&(r=[c.style.borderTop,c.style.borderBottom,c.style.borderLeft,c.style.borderRight])},t="";"none"!=a&&c&&q();var z=document.getElementById("line_kind"),y=document.getElementById("line_thickness"),v=document.getElementById("line_style"),A=document.getElementById("line_color");if(""!=z.value||""!=y.value){var w=/rgb\(\d{1,3}, ?\d{1,3}, ?\d{1,3}\)$|rgb\(\d{1,3},\d{1,3},\d{1,3}\)|#[0-9a-fA-F]{6}|#[0-9a-fA-F]{3}/,C=["solid","dotted","dashed"],B=
function(){var b="undefined"!=typeof G_sameAttr?G_sameAttr.total:null;b&&(0==a.indexOf("out")?b=G_sameAttr.outside:0==a.indexOf("in")&&(b=G_sameAttr.inside));if(""==z.value)if(" "==y.value)if(b&&""!=b.sameWidth&&"diff"!=b.sameWidth)isNaN(parseInt(b.sameWidth,10))?"thick"==b.sameWidth?y.value="5":"medium"==b.sameWidth?y.value="3":"thin"==b.sameWidth&&(y.value="1"):y.value=parseInt(b.sameWidth,10),t+=b.sameWidth;else{var c=null;allThicknessEqual(r)&&(c=r[0]);if(c){if(c=parseBorderStyle(c).thickness)isNaN(parseInt(c,
10))?"thick"==c?y.value="5":"medium"==c?y.value="3":"thin"==c&&(y.value="1"):y.value=parseInt(c,10);t+=c}}else t+=parseInt(y.value,10)+"px";else t+=z.value;if("none"==v.style.borderTopStyle)if("0"==y.value)null==document.getElementById("none_line_style")&&(c=document.createElement("span"),c.innerText=LayerWin.dext5_lang.table.line_style_hidden,c.id="none_line_style",c.className="none_line_style",v.style.display="none",v.parentNode.appendChild(c),y.value="0");else if(document.getElementById("none_line_style")&&
(v.parentNode.removeChild(document.getElementById("none_line_style")),DEXTTOP.DEXT5.util.removeStyleAttribute(v,"display")),b&&""!=b.sameStyle&&"diff"!=b.sameStyle)-1<C.indexOf(b.sameStyle)?(v.style.borderTopWidth="1px",v.style.borderTopStyle=b.sameStyle):"double"==b.sameStyle?(v.style.borderTopWidth="3px",v.style.borderTopStyle=b.sameStyle):v.style.border="3px "+b.sameStyle;else if(c=null,allStyleEqual(r)&&(c=r[0]),c&&(c=parseBorderStyle(c).style))-1<C.indexOf(c)?(v.style.borderTopWidth="1px",v.style.borderTopStyle=
c):"double"==c?(v.style.borderTopWidth="3px",v.style.borderTopStyle=c):v.style.border="3px "+c;if(-1<A.style.borderTopStyle.indexOf("none")||-1<A.style.borderTop.indexOf("currentColor"))if("0"==y.value)A.style.borderTopWidth="6px",A.style.borderTopStyle="solid",A.style.borderTopColor="rgb(0, 0, 0)";else if(b&&""!=b.sameColor&&"diff"!=b.sameColor)A.style.borderTopWidth="6px",A.style.borderTopStyle="solid",A.style.borderTopColor=b.sameColor;else if(c=null,allColorEqual(r)&&(c=r[0]),c&&(b=c.match(w)))A.style.borderTopWidth=
"6px",A.style.borderTopStyle="solid",A.style.borderTopColor=b};"none"!=a&&B();var t=t+(" "+v.style.borderTopStyle),t=t+(" "+(-1==A.style.borderTopStyle.indexOf("none")?A.style.borderTopColor:"initial")),l=t.split(" "),x=""!=l[0]&&(-1==l[1].indexOf("none")||-1<l[1].indexOf("none")&&0==parseInt(l[0],10))&&-1==l[2].indexOf("initial");"black"==l[2]&&(t=l[0]+" "+l[1]+" rgb(0, 0, 0)");var E=document.getElementById("edge_top"),D=document.getElementById("edge_horizon"),F=document.getElementById("edge_bottom"),
J=document.getElementById("edge_left"),H=document.getElementById("edge_vertical"),I=document.getElementById("edge_right"),K=document.getElementById("edge_dext_diagonal_up"),L=document.getElementById("edge_dext_diagonal_down"),G=document.getElementById("oldValue"),G=G?LayerWin.DEXTTOP.G_CURREDITOR._FRAMEWIN.JSON.parse(G.value):null;if("total"==a){E&&(E.src="../images/editor/dialog/editor_line_top_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(E,"imgstate","active"));D&&(D.src="../images/editor/dialog/editor_line_horizon_img.gif",
DEXTTOP.DEXT5.util.setCustomAttribute(D,"imgstate","active"));F&&(F.src="../images/editor/dialog/editor_line_bottom_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(F,"imgstate","active"));J&&(J.src="../images/editor/dialog/editor_line_left_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(J,"imgstate","active"));H&&(H.src="../images/editor/dialog/editor_line_vertical_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(H,"imgstate","active"));I&&(I.src="../images/editor/dialog/editor_line_right_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(I,
"imgstate","active"));if(c)if("undefined"==typeof G_prevMode)c.style.borderTop=c.style.borderBottom=c.style.borderLeft=c.style.borderRight=t;else{""==l[0]?(c.style.borderTopWidth=G_prevCellStyle.topCell1[0].top.width,c.style.borderBottomWidth=G_prevCellStyle.topCell1[0].bottom.width,c.style.borderLeftWidth=G_prevCellStyle.topCell1[0].left.width,c.style.borderRightWidth=G_prevCellStyle.topCell1[0].right.width):(c.style.borderTopWidth=l[0],c.style.borderBottomWidth=l[0],c.style.borderLeftWidth=l[0],
c.style.borderRightWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(c.style.borderTopStyle=G_prevCellStyle.topCell1[0].top.style,c.style.borderBottomStyle=G_prevCellStyle.topCell1[0].bottom.style,c.style.borderLeftStyle=G_prevCellStyle.topCell1[0].left.style,c.style.borderRightStyle=G_prevCellStyle.topCell1[0].right.style):(c.style.borderTopStyle=l[1],c.style.borderBottomStyle=l[1],c.style.borderLeftStyle=l[1],c.style.borderRightStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<
G_prevCellStyle.topCell1[0].top.style.indexOf("none")?c.style.borderTopStyle="none":c.style.borderTopColor=G_prevCellStyle.topCell1[0].top.color,-1<G_prevCellStyle.topCell1[0].bottom.style.indexOf("none")?c.style.borderBottomStyle="none":c.style.borderBottomColor=G_prevCellStyle.topCell1[0].bottom.color,-1<G_prevCellStyle.topCell1[0].left.style.indexOf("none")?c.style.borderLeftStyle="none":c.style.borderLeftColor=G_prevCellStyle.topCell1[0].left.color,-1<G_prevCellStyle.topCell1[0].right.style.indexOf("none")?
c.style.borderRightStyle="none":c.style.borderRightColor=G_prevCellStyle.topCell1[0].right.color;else if(b=t.match(w))c.style.borderTopColor=b[0],c.style.borderBottomColor=b[0],c.style.borderLeftColor=b[0],c.style.borderRightColor=b[0];""!=G_prevCellStyle.topCell1[0].top.width+G_prevCellStyle.topCell1[0].top.style+G_prevCellStyle.topCell1[0].top.color||x?cellRemoveClass(c,"dext_cell_border_t"):cellAddClass(c,"dext_cell_border_t");""!=G_prevCellStyle.topCell1[0].bottom.width+G_prevCellStyle.topCell1[0].bottom.style+
G_prevCellStyle.topCell1[0].bottom.color||x?cellRemoveClass(c,"dext_cell_border_b"):cellAddClass(c,"dext_cell_border_b");""!=G_prevCellStyle.topCell1[0].left.width+G_prevCellStyle.topCell1[0].left.style+G_prevCellStyle.topCell1[0].left.color||x?cellRemoveClass(c,"dext_cell_border_l"):cellAddClass(c,"dext_cell_border_l");""!=G_prevCellStyle.topCell1[0].right.width+G_prevCellStyle.topCell1[0].right.style+G_prevCellStyle.topCell1[0].right.color||x?cellRemoveClass(c,"dext_cell_border_r"):cellAddClass(c,
"dext_cell_border_r")}if(d)if("undefined"==typeof G_prevMode)d.style.borderTop=d.style.borderBottom=d.style.borderLeft=d.style.borderRight=t;else{""==l[0]?(d.style.borderTopWidth=G_prevCellStyle.topCell2[0].top.width,d.style.borderBottomWidth=G_prevCellStyle.topCell2[0].bottom.width,d.style.borderLeftWidth=G_prevCellStyle.topCell2[0].left.width,d.style.borderRightWidth=G_prevCellStyle.topCell2[0].right.width):(d.style.borderTopWidth=l[0],d.style.borderBottomWidth=l[0],d.style.borderLeftWidth=l[0],
d.style.borderRightWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(d.style.borderTopStyle=G_prevCellStyle.topCell2[0].top.style,d.style.borderBottomStyle=G_prevCellStyle.topCell2[0].bottom.style,d.style.borderLeftStyle=G_prevCellStyle.topCell2[0].left.style,d.style.borderRightStyle=G_prevCellStyle.topCell2[0].right.style):(d.style.borderTopStyle=l[1],d.style.borderBottomStyle=l[1],d.style.borderLeftStyle=l[1],d.style.borderRightStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<
G_prevCellStyle.topCell2[0].top.style.indexOf("none")?d.style.borderTopStyle="none":d.style.borderTopColor=G_prevCellStyle.topCell2[0].top.color,-1<G_prevCellStyle.topCell2[0].bottom.style.indexOf("none")?d.style.borderBottomStyle="none":d.style.borderBottomColor=G_prevCellStyle.topCell2[0].bottom.color,-1<G_prevCellStyle.topCell2[0].left.style.indexOf("none")?d.style.borderLeftStyle="none":d.style.borderLeftColor=G_prevCellStyle.topCell2[0].left.color,-1<G_prevCellStyle.topCell2[0].right.style.indexOf("none")?
d.style.borderRightStyle="none":d.style.borderRightColor=G_prevCellStyle.topCell2[0].right.color;else if(b=t.match(w))d.style.borderTopColor=b[0],d.style.borderBottomColor=b[0],d.style.borderLeftColor=b[0],d.style.borderRightColor=b[0];""!=G_prevCellStyle.topCell2[0].top.width+G_prevCellStyle.topCell2[0].top.style+G_prevCellStyle.topCell2[0].top.color||x?cellRemoveClass(d,"dext_cell_border_t"):cellAddClass(d,"dext_cell_border_t");""!=G_prevCellStyle.topCell2[0].bottom.width+G_prevCellStyle.topCell2[0].bottom.style+
G_prevCellStyle.topCell2[0].bottom.color||x?cellRemoveClass(d,"dext_cell_border_b"):cellAddClass(d,"dext_cell_border_b");""!=G_prevCellStyle.topCell2[0].left.width+G_prevCellStyle.topCell2[0].left.style+G_prevCellStyle.topCell2[0].left.color||x?cellRemoveClass(d,"dext_cell_border_l"):cellAddClass(d,"dext_cell_border_l");""!=G_prevCellStyle.topCell2[0].right.width+G_prevCellStyle.topCell2[0].right.style+G_prevCellStyle.topCell2[0].right.color||x?cellRemoveClass(d,"dext_cell_border_r"):cellAddClass(d,
"dext_cell_border_r")}if(f)if("undefined"==typeof G_prevMode)f.style.borderTop=f.style.borderBottom=f.style.borderLeft=f.style.borderRight=t;else{""==l[0]?(f.style.borderTopWidth=G_prevCellStyle.bottomCell1[0].top.width,f.style.borderBottomWidth=G_prevCellStyle.bottomCell1[0].bottom.width,f.style.borderLeftWidth=G_prevCellStyle.bottomCell1[0].left.width,f.style.borderRightWidth=G_prevCellStyle.bottomCell1[0].right.width):(f.style.borderTopWidth=l[0],f.style.borderBottomWidth=l[0],f.style.borderLeftWidth=
l[0],f.style.borderRightWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(f.style.borderTopStyle=G_prevCellStyle.bottomCell1[0].top.style,f.style.borderBottomStyle=G_prevCellStyle.bottomCell1[0].bottom.style,f.style.borderLeftStyle=G_prevCellStyle.bottomCell1[0].left.style,f.style.borderRightStyle=G_prevCellStyle.bottomCell1[0].right.style):(f.style.borderTopStyle=l[1],f.style.borderBottomStyle=l[1],f.style.borderLeftStyle=l[1],f.style.borderRightStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<
G_prevCellStyle.bottomCell1[0].top.style.indexOf("none")?f.style.borderTopStyle="none":f.style.borderTopColor=G_prevCellStyle.bottomCell1[0].top.color,-1<G_prevCellStyle.bottomCell1[0].bottom.style.indexOf("none")?f.style.borderBottomStyle="none":f.style.borderBottomColor=G_prevCellStyle.bottomCell1[0].bottom.color,-1<G_prevCellStyle.bottomCell1[0].left.style.indexOf("none")?f.style.borderLeftStyle="none":f.style.borderLeftColor=G_prevCellStyle.bottomCell1[0].left.color,-1<G_prevCellStyle.bottomCell1[0].right.style.indexOf("none")?
f.style.borderRightStyle="none":f.style.borderRightColor=G_prevCellStyle.bottomCell1[0].right.color;else if(b=t.match(w))f.style.borderTopColor=b[0],f.style.borderBottomColor=b[0],f.style.borderLeftColor=b[0],f.style.borderRightColor=b[0];""!=G_prevCellStyle.bottomCell1[0].top.width+G_prevCellStyle.bottomCell1[0].top.style+G_prevCellStyle.bottomCell1[0].top.color||x?cellRemoveClass(f,"dext_cell_border_t"):cellAddClass(f,"dext_cell_border_t");""!=G_prevCellStyle.bottomCell1[0].bottom.width+G_prevCellStyle.bottomCell1[0].bottom.style+
G_prevCellStyle.bottomCell1[0].bottom.color||x?cellRemoveClass(f,"dext_cell_border_b"):cellAddClass(f,"dext_cell_border_b");""!=G_prevCellStyle.bottomCell1[0].left.width+G_prevCellStyle.bottomCell1[0].left.style+G_prevCellStyle.bottomCell1[0].left.color||x?cellRemoveClass(f,"dext_cell_border_l"):cellAddClass(f,"dext_cell_border_l");""!=G_prevCellStyle.bottomCell1[0].right.width+G_prevCellStyle.bottomCell1[0].right.style+G_prevCellStyle.bottomCell1[0].right.color||x?cellRemoveClass(f,"dext_cell_border_r"):
cellAddClass(f,"dext_cell_border_r")}if(g)if("undefined"==typeof G_prevMode)g.style.borderTop=g.style.borderBottom=g.style.borderLeft=g.style.borderRight=t;else{""==l[0]?(g.style.borderTopWidth=G_prevCellStyle.bottomCell2[0].top.width,g.style.borderBottomWidth=G_prevCellStyle.bottomCell2[0].bottom.width,g.style.borderLeftWidth=G_prevCellStyle.bottomCell2[0].left.width,g.style.borderRightWidth=G_prevCellStyle.bottomCell2[0].right.width):(g.style.borderTopWidth=l[0],g.style.borderBottomWidth=l[0],g.style.borderRightWidth=
l[0],g.style.borderLeftWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(g.style.borderTopStyle=G_prevCellStyle.bottomCell2[0].top.style,g.style.borderBottomStyle=G_prevCellStyle.bottomCell2[0].bottom.style,g.style.borderLeftStyle=G_prevCellStyle.bottomCell2[0].left.style,g.style.borderRightStyle=G_prevCellStyle.bottomCell2[0].right.style):(g.style.borderTopStyle=l[1],g.style.borderBottomStyle=l[1],g.style.borderLeftStyle=l[1],g.style.borderRightStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<
G_prevCellStyle.bottomCell2[0].top.style.indexOf("none")?g.style.borderTopStyle="none":g.style.borderTopColor=G_prevCellStyle.bottomCell2[0].top.color,-1<G_prevCellStyle.bottomCell2[0].bottom.style.indexOf("none")?g.style.borderBottomStyle="none":g.style.borderBottomColor=G_prevCellStyle.bottomCell2[0].bottom.color,-1<G_prevCellStyle.bottomCell2[0].left.style.indexOf("none")?g.style.borderLeftStyle="none":g.style.borderLeftColor=G_prevCellStyle.bottomCell2[0].left.color,-1<G_prevCellStyle.bottomCell2[0].right.style.indexOf("none")?
g.style.borderRightStyle="none":g.style.borderRightColor=G_prevCellStyle.bottomCell2[0].right.color;else if(b=t.match(w))g.style.borderTopColor=b[0],g.style.borderBottomColor=b[0],g.style.borderLeftColor=b[0],g.style.borderRightColor=b[0];""!=G_prevCellStyle.bottomCell2[0].top.width+G_prevCellStyle.bottomCell2[0].top.style+G_prevCellStyle.bottomCell2[0].top.color||x?cellRemoveClass(g,"dext_cell_border_t"):cellAddClass(g,"dext_cell_border_t");""!=G_prevCellStyle.bottomCell2[0].bottom.width+G_prevCellStyle.bottomCell2[0].bottom.style+
G_prevCellStyle.bottomCell2[0].bottom.color||x?cellRemoveClass(g,"dext_cell_border_b"):cellAddClass(g,"dext_cell_border_b");""!=G_prevCellStyle.bottomCell2[0].left.width+G_prevCellStyle.bottomCell2[0].left.style+G_prevCellStyle.bottomCell2[0].left.color||x?cellRemoveClass(g,"dext_cell_border_l"):cellAddClass(g,"dext_cell_border_l");""!=G_prevCellStyle.bottomCell2[0].right.width+G_prevCellStyle.bottomCell2[0].right.style+G_prevCellStyle.bottomCell2[0].right.color||x?cellRemoveClass(g,"dext_cell_border_r"):
cellAddClass(g,"dext_cell_border_r")}setClickedBorderCheck("outsideTop outsideRight outsideBottom outsideLeft insideRow insideCol".split(" "),G);"undefined"==typeof G_prevMode&&(G_prevCellStyle={topCell1:[],topCell2:[],bottomCell1:[],bottomCell2:[]},e(),G_prevCellStyle.topCell1.push(h),d&&G_prevCellStyle.topCell2.push(m),f&&G_prevCellStyle.bottomCell1.push(k),g&&G_prevCellStyle.bottomCell2.push(n))}else if("inside"==a){E&&(DEXTTOP.DEXT5.util.setCustomAttribute(E,"imgstate","active"),edgeClick("top"));
F&&(DEXTTOP.DEXT5.util.setCustomAttribute(F,"imgstate","active"),edgeClick("bottom"));J&&(DEXTTOP.DEXT5.util.setCustomAttribute(J,"imgstate","active"),edgeClick("left"));I&&(DEXTTOP.DEXT5.util.setCustomAttribute(I,"imgstate","active"),edgeClick("right"));edgeSelectClick(2,"inside");D&&(D.src="../images/editor/dialog/editor_line_horizon_img.gif");H&&(H.src="../images/editor/dialog/editor_line_vertical_img.gif");if(c&&d){""==l[0]?(c.style.borderRightWidth=G_prevCellStyle.topCell1[0].right.width,d.style.borderLeftWidth=
G_prevCellStyle.topCell2[0].left.width):(c.style.borderRightWidth=l[0],d.style.borderLeftWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(c.style.borderRightStyle=G_prevCellStyle.topCell1[0].right.style,d.style.borderLeftStyle=G_prevCellStyle.topCell2[0].left.style):(c.style.borderRightStyle=l[1],d.style.borderLeftStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.topCell1[0].right.style.indexOf("none")?c.style.borderRightStyle="none":c.style.borderRightColor=
G_prevCellStyle.topCell1[0].right.color,-1<G_prevCellStyle.topCell2[0].left.style.indexOf("none")?d.style.borderLeftStyle="none":d.style.borderLeftColor=G_prevCellStyle.topCell2[0].left.color;else if(b=t.match(w))c.style.borderRightColor=b[0],d.style.borderLeftColor=b[0];""!=G_prevCellStyle.topCell1[0].right.width+G_prevCellStyle.topCell1[0].right.style+G_prevCellStyle.topCell1[0].right.color||x?cellRemoveClass(c,"dext_cell_border_r"):cellAddClass(c,"dext_cell_border_r");""!=G_prevCellStyle.topCell2[0].left.width+
G_prevCellStyle.topCell2[0].left.style+G_prevCellStyle.topCell2[0].left.color||x?cellRemoveClass(d,"dext_cell_border_l"):cellAddClass(d,"dext_cell_border_l")}if(f&&g){""==l[0]?(f.style.borderRightWidth=G_prevCellStyle.bottomCell1[0].right.width,g.style.borderLeftWidth=G_prevCellStyle.bottomCell2[0].left.width):(f.style.borderRightWidth=l[0],g.style.borderLeftWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(f.style.borderRightStyle=G_prevCellStyle.bottomCell1[0].right.style,g.style.borderLeftStyle=
G_prevCellStyle.bottomCell2[0].left.style):(f.style.borderRightStyle=l[1],g.style.borderLeftStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.bottomCell1[0].right.style.indexOf("none")?f.style.borderRightStyle="none":f.style.borderRightColor=G_prevCellStyle.bottomCell1[0].right.color,-1<G_prevCellStyle.bottomCell2[0].left.style.indexOf("none")?g.style.borderLeftStyle="none":g.style.borderLeftColor=G_prevCellStyle.bottomCell2[0].left.color;else if(b=t.match(w))f.style.borderRightColor=
b[0],g.style.borderLeftColor=b[0];""!=G_prevCellStyle.bottomCell1[0].right.width+G_prevCellStyle.bottomCell1[0].right.style+G_prevCellStyle.bottomCell1[0].right.color||x?cellRemoveClass(f,"dext_cell_border_r"):cellAddClass(f,"dext_cell_border_r");""!=G_prevCellStyle.bottomCell2[0].left.width+G_prevCellStyle.bottomCell2[0].left.style+G_prevCellStyle.bottomCell2[0].left.color||x?cellRemoveClass(g,"dext_cell_border_l"):cellAddClass(g,"dext_cell_border_l")}if(c&&f){""==l[0]?(c.style.borderBottomWidth=
G_prevCellStyle.topCell1[0].bottom.width,f.style.borderTopWidth=G_prevCellStyle.bottomCell1[0].top.width):(c.style.borderBottomWidth=l[0],f.style.borderTopWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(c.style.borderBottomStyle=G_prevCellStyle.topCell1[0].bottom.style,f.style.borderTopStyle=G_prevCellStyle.bottomCell1[0].top.style):(c.style.borderBottomStyle=l[1],f.style.borderTopStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.topCell1[0].bottom.style.indexOf("none")?
c.style.borderBottomStyle="none":c.style.borderBottomColor=G_prevCellStyle.topCell1[0].bottom.color,-1<G_prevCellStyle.bottomCell1[0].top.style.indexOf("none")?f.style.borderTopStyle="none":f.style.borderTopColor=G_prevCellStyle.bottomCell1[0].top.color;else if(b=t.match(w))c.style.borderBottomColor=b[0],f.style.borderTopColor=b[0];""!=G_prevCellStyle.topCell1[0].bottom.width+G_prevCellStyle.topCell1[0].bottom.style+G_prevCellStyle.topCell1[0].bottom.color||x?cellRemoveClass(c,"dext_cell_border_b"):
cellAddClass(c,"dext_cell_border_b");""!=G_prevCellStyle.bottomCell1[0].top.width+G_prevCellStyle.bottomCell1[0].top.style+G_prevCellStyle.bottomCell1[0].top.color||x?cellRemoveClass(f,"dext_cell_border_t"):cellAddClass(f,"dext_cell_border_t")}if(d&&g){""==l[0]?(d.style.borderBottomWidth=G_prevCellStyle.topCell2[0].bottom.width,g.style.borderTopWidth=G_prevCellStyle.bottomCell2[0].top.width):(d.style.borderBottomWidth=l[0],g.style.borderTopWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(d.style.borderBottomStyle=
G_prevCellStyle.topCell2[0].bottom.style,g.style.borderTopStyle=G_prevCellStyle.bottomCell2[0].top.style):(d.style.borderBottomStyle=l[1],g.style.borderTopStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.topCell2[0].bottom.style.indexOf("none")?d.style.borderBottomStyle="none":d.style.borderBottomColor=G_prevCellStyle.topCell2[0].bottom.color,-1<G_prevCellStyle.bottomCell2[0].top.style.indexOf("none")?g.style.borderTopStyle="none":g.style.borderTopColor=
G_prevCellStyle.bottomCell2[0].top.color;else if(b=t.match(w))d.style.borderBottomColor=b[0],g.style.borderTopColor=b[0];""!=G_prevCellStyle.topCell2[0].bottom.width+G_prevCellStyle.topCell2[0].bottom.style+G_prevCellStyle.topCell2[0].bottom.color||x?cellRemoveClass(d,"dext_cell_border_b"):cellAddClass(d,"dext_cell_border_b");""!=G_prevCellStyle.bottomCell2[0].top.width+G_prevCellStyle.bottomCell2[0].top.style+G_prevCellStyle.bottomCell2[0].top.color||x?cellRemoveClass(g,"dext_cell_border_t"):cellAddClass(g,
"dext_cell_border_t")}setClickedBorderCheck(["insideRow","insideCol"],G);G_prevMode=a}else if("outside"==a){D&&(DEXTTOP.DEXT5.util.setCustomAttribute(D,"imgstate","active"),edgeClick("horizon"));H&&(DEXTTOP.DEXT5.util.setCustomAttribute(H,"imgstate","active"),edgeClick("vertical"));edgeSelectClick(1,"outside");E&&(E.src="../images/editor/dialog/editor_line_top_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(E,"imgstate","active"));F&&(F.src="../images/editor/dialog/editor_line_bottom_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(F,
"imgstate","active"));J&&(J.src="../images/editor/dialog/editor_line_left_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(J,"imgstate","active"));I&&(I.src="../images/editor/dialog/editor_line_right_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(I,"imgstate","active"));if(c&&d){""==l[0]?(c.style.borderTopWidth=G_prevCellStyle.topCell1[0].top.width,c.style.borderLeftWidth=G_prevCellStyle.topCell1[0].left.width,d.style.borderTopWidth=G_prevCellStyle.topCell2[0].top.width,d.style.borderRightWidth=G_prevCellStyle.topCell2[0].right.width):
(c.style.borderTopWidth=l[0],c.style.borderLeftWidth=l[0],d.style.borderTopWidth=l[0],d.style.borderRightWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(c.style.borderTopStyle=G_prevCellStyle.topCell1[0].top.style,c.style.borderLeftStyle=G_prevCellStyle.topCell1[0].left.style,d.style.borderTopStyle=G_prevCellStyle.topCell2[0].top.style,d.style.borderRightStyle=G_prevCellStyle.topCell2[0].right.style):(c.style.borderTopStyle=l[1],c.style.borderLeftStyle=l[1],d.style.borderTopStyle=l[1],d.style.borderRightStyle=
l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.topCell1[0].top.style.indexOf("none")?c.style.borderTopStyle="none":c.style.borderTopColor=G_prevCellStyle.topCell1[0].top.color,-1<G_prevCellStyle.topCell1[0].left.style.indexOf("none")?c.style.borderLeftStyle="none":c.style.borderLeftColor=G_prevCellStyle.topCell1[0].left.color,-1<G_prevCellStyle.topCell2[0].top.style.indexOf("none")?d.style.borderTopStyle="none":d.style.borderTopColor=G_prevCellStyle.topCell2[0].top.color,
-1<G_prevCellStyle.topCell2[0].right.style.indexOf("none")?d.style.borderRightStyle="none":d.style.borderRightColor=G_prevCellStyle.topCell2[0].right.color;else if(b=t.match(w))c.style.borderTopColor=b[0],c.style.borderLeftColor=b[0],d.style.borderTopColor=b[0],d.style.borderRightColor=b[0];""!=G_prevCellStyle.topCell1[0].top.width+G_prevCellStyle.topCell1[0].top.style+G_prevCellStyle.topCell1[0].top.color||x?cellRemoveClass(c,"dext_cell_border_t"):cellAddClass(c,"dext_cell_border_t");""!=G_prevCellStyle.topCell1[0].left.width+
G_prevCellStyle.topCell1[0].left.style+G_prevCellStyle.topCell1[0].left.color||x?cellRemoveClass(c,"dext_cell_border_l"):cellAddClass(c,"dext_cell_border_l");""!=G_prevCellStyle.topCell2[0].top.width+G_prevCellStyle.topCell2[0].top.style+G_prevCellStyle.topCell2[0].top.color||x?cellRemoveClass(d,"dext_cell_border_t"):cellAddClass(d,"dext_cell_border_t");""!=G_prevCellStyle.topCell2[0].right.width+G_prevCellStyle.topCell2[0].right.style+G_prevCellStyle.topCell2[0].right.color||x?cellRemoveClass(d,
"dext_cell_border_r"):cellAddClass(d,"dext_cell_border_r")}else if(c){""==l[0]?(c.style.borderTopWidth=G_prevCellStyle.topCell1[0].top.width,c.style.borderLeftWidth=G_prevCellStyle.topCell1[0].left.width,c.style.borderRightWidth=G_prevCellStyle.topCell1[0].right.width):(c.style.borderTopWidth=l[0],c.style.borderLeftWidth=l[0],c.style.borderRightWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(c.style.borderTopStyle=G_prevCellStyle.topCell1[0].top.style,c.style.borderLeftStyle=G_prevCellStyle.topCell1[0].left.style,
c.style.borderRightStyle=G_prevCellStyle.topCell1[0].right.style):(c.style.borderTopStyle=l[1],c.style.borderLeftStyle=l[1],c.style.borderRightStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.topCell1[0].top.style.indexOf("none")?c.style.borderTopStyle="none":c.style.borderTopColor=G_prevCellStyle.topCell1[0].top.color,-1<G_prevCellStyle.topCell1[0].left.style.indexOf("none")?c.style.borderLeftStyle="none":c.style.borderLeftColor=G_prevCellStyle.topCell1[0].left.color,
-1<G_prevCellStyle.topCell1[0].right.style.indexOf("none")?c.style.borderRightStyle="none":c.style.borderRightColor=G_prevCellStyle.topCell1[0].right.color;else if(b=t.match(w))c.style.borderTopColor=b[0],c.style.borderLeftColor=b[0],c.style.borderRightColor=b[0];""!=G_prevCellStyle.topCell1[0].top.width+G_prevCellStyle.topCell1[0].top.style+G_prevCellStyle.topCell1[0].top.color||x?cellRemoveClass(c,"dext_cell_border_t"):cellAddClass(c,"dext_cell_border_t");""!=G_prevCellStyle.topCell1[0].left.width+
G_prevCellStyle.topCell1[0].left.style+G_prevCellStyle.topCell1[0].left.color||x?cellRemoveClass(c,"dext_cell_border_l"):cellAddClass(c,"dext_cell_border_l");""!=G_prevCellStyle.topCell1[0].right.width+G_prevCellStyle.topCell1[0].right.style+G_prevCellStyle.topCell1[0].right.color||x?cellRemoveClass(c,"dext_cell_border_r"):cellAddClass(c,"dext_cell_border_r")}if(f&&g){""==l[0]?(f.style.borderBottomWidth=G_prevCellStyle.bottomCell1[0].bottom.width,f.style.borderLeftWidth=G_prevCellStyle.bottomCell1[0].left.width,
g.style.borderBottomWidth=G_prevCellStyle.bottomCell2[0].bottom.width,g.style.borderRightWidth=G_prevCellStyle.bottomCell2[0].right.width):(f.style.borderBottomWidth=l[0],f.style.borderLeftWidth=l[0],g.style.borderBottomWidth=l[0],g.style.borderRightWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(f.style.borderBottomStyle=G_prevCellStyle.bottomCell1[0].bottom.style,f.style.borderLeftStyle=G_prevCellStyle.bottomCell1[0].left.style,g.style.borderBottomStyle=G_prevCellStyle.bottomCell2[0].bottom.style,
g.style.borderRightStyle=G_prevCellStyle.bottomCell2[0].right.style):(f.style.borderBottomStyle=l[1],f.style.borderLeftStyle=l[1],g.style.borderBottomStyle=l[1],g.style.borderRightStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.bottomCell1[0].bottom.style.indexOf("none")?f.style.borderBottomStyle="none":f.style.borderBottomColor=G_prevCellStyle.bottomCell1[0].bottom.color,-1<G_prevCellStyle.bottomCell1[0].left.style.indexOf("none")?f.style.borderLeftStyle=
"none":f.style.borderLeftColor=G_prevCellStyle.bottomCell1[0].left.color,-1<G_prevCellStyle.bottomCell2[0].bottom.style.indexOf("none")?g.style.borderBottomStyle="none":g.style.borderBottomColor=G_prevCellStyle.bottomCell2[0].bottom.color,-1<G_prevCellStyle.bottomCell2[0].right.style.indexOf("none")?g.style.borderRightStyle="none":g.style.borderRightColor=G_prevCellStyle.bottomCell2[0].right.color;else if(b=t.match(w))f.style.borderBottomColor=b[0],f.style.borderLeftColor=b[0],g.style.borderBottomColor=
b[0],g.style.borderRightColor=b[0];""!=G_prevCellStyle.bottomCell1[0].bottom.width+G_prevCellStyle.bottomCell1[0].bottom.style+G_prevCellStyle.bottomCell1[0].bottom.color||x?cellRemoveClass(f,"dext_cell_border_b"):cellAddClass(f,"dext_cell_border_b");""!=G_prevCellStyle.bottomCell1[0].left.width+G_prevCellStyle.bottomCell1[0].left.style+G_prevCellStyle.bottomCell1[0].left.color||x?cellRemoveClass(f,"dext_cell_border_l"):cellAddClass(f,"dext_cell_border_l");""!=G_prevCellStyle.bottomCell2[0].bottom.width+
G_prevCellStyle.bottomCell2[0].bottom.style+G_prevCellStyle.bottomCell2[0].bottom.color||x?cellRemoveClass(g,"dext_cell_border_b"):cellAddClass(g,"dext_cell_border_b");""!=G_prevCellStyle.bottomCell2[0].right.width+G_prevCellStyle.bottomCell2[0].right.style+G_prevCellStyle.bottomCell2[0].right.color||x?cellRemoveClass(g,"dext_cell_border_r"):cellAddClass(g,"dext_cell_border_r")}else if(f){""==l[0]?(f.style.borderBottomWidth=G_prevCellStyle.bottomCell1[0].bottom.width,f.style.borderLeftWidth=G_prevCellStyle.bottomCell1[0].left.width,
f.style.borderRightWidth=G_prevCellStyle.bottomCell1[0].right.width):(f.style.borderBottomWidth=l[0],f.style.borderLeftWidth=l[0],f.style.borderRightWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(f.style.borderBottomStyle=G_prevCellStyle.bottomCell1[0].bottom.style,f.style.borderLeftStyle=G_prevCellStyle.bottomCell1[0].left.style,f.style.borderRightStyle=G_prevCellStyle.bottomCell1[0].right.style):(f.style.borderBottomStyle=l[1],f.style.borderLeftStyle=l[1],f.style.borderRightStyle=l[1]);if(-1<
l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.bottomCell1[0].bottom.style.indexOf("none")?f.style.borderBottomStyle="none":f.style.borderBottomColor=G_prevCellStyle.bottomCell1[0].bottom.color,-1<G_prevCellStyle.bottomCell1[0].left.style.indexOf("none")?f.style.borderLeftStyle="none":f.style.borderLeftColor=G_prevCellStyle.bottomCell1[0].left.color,-1<G_prevCellStyle.bottomCell1[0].right.style.indexOf("none")?f.style.borderRightStyle="none":f.style.borderRightColor=G_prevCellStyle.bottomCell1[0].right.color;
else if(b=t.match(w))f.style.borderBottomColor=b[0],f.style.borderLeftColor=b[0],f.style.borderRightColor=b[0];""!=G_prevCellStyle.bottomCell1[0].bottom.width+G_prevCellStyle.bottomCell1[0].bottom.style+G_prevCellStyle.bottomCell1[0].bottom.color||x?cellRemoveClass(f,"dext_cell_border_b"):cellAddClass(f,"dext_cell_border_b");""!=G_prevCellStyle.bottomCell1[0].left.width+G_prevCellStyle.bottomCell1[0].left.style+G_prevCellStyle.bottomCell1[0].left.color||x?cellRemoveClass(f,"dext_cell_border_l"):cellAddClass(f,
"dext_cell_border_l");""!=G_prevCellStyle.bottomCell1[0].right.width+G_prevCellStyle.bottomCell1[0].right.style+G_prevCellStyle.bottomCell1[0].right.color||x?cellRemoveClass(f,"dext_cell_border_r"):cellAddClass(f,"dext_cell_border_r")}else{if(c){c.style.borderBottomWidth=""==l[0]?G_prevCellStyle.topCell1[0].bottom.width:l[0];-1<l[1].indexOf("none")&&"0px"!=l[0]?c.style.borderBottomStyle=G_prevCellStyle.topCell1[0].bottom.style:c.style.borderBottomStyle=l[1];if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<
G_prevCellStyle.topCell1[0].bottom.style.indexOf("none")?c.style.borderBottomStyle="none":c.style.borderBottomColor=G_prevCellStyle.topCell1[0].bottom.color;else if(b=t.match(w))c.style.borderBottomColor=b[0];""!=G_prevCellStyle.topCell1[0].bottom.width+G_prevCellStyle.topCell1[0].bottom.style+G_prevCellStyle.topCell1[0].bottom.color||x?cellRemoveClass(c,"dext_cell_border_b"):cellAddClass(c,"dext_cell_border_b")}if(d){d.style.borderBottomWidth=""==l[0]?G_prevCellStyle.topCell2[0].bottom.width:l[0];
-1<l[1].indexOf("none")&&"0px"!=l[0]?d.style.borderBottomStyle=G_prevCellStyle.topCell2[0].bottom.style:d.style.borderBottomStyle=l[1];if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.topCell2[0].bottom.style.indexOf("none")?d.style.borderBottomStyle="none":d.style.borderBottomColor=G_prevCellStyle.topCell2[0].bottom.color;else if(b=t.match(w))d.style.borderBottomColor=b[0];""!=G_prevCellStyle.topCell2[0].bottom.width+G_prevCellStyle.topCell2[0].bottom.style+G_prevCellStyle.topCell2[0].bottom.color||
x?cellRemoveClass(d,"dext_cell_border_b"):cellAddClass(d,"dext_cell_border_b")}}setClickedBorderCheck(["outsideTop","outsideRight","outsideBottom","outsideLeft"],G);G_prevMode=a}else if("inline"==a){E&&(DEXTTOP.DEXT5.util.setCustomAttribute(E,"imgstate","active"),edgeClick("top"));F&&(DEXTTOP.DEXT5.util.setCustomAttribute(F,"imgstate","active"),edgeClick("bottom"));J&&(DEXTTOP.DEXT5.util.setCustomAttribute(J,"imgstate","active"),edgeClick("left"));I&&(DEXTTOP.DEXT5.util.setCustomAttribute(I,"imgstate",
"active"),edgeClick("right"));edgeSelectClick(6,"inline");""==G_prevCellStyle.topCell1[0].top.style&&-1<c.style.borderTopStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-top-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-top-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-top-color"));""==G_prevCellStyle.topCell1[0].left.style&&-1<c.style.borderLeftStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-left-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,
"border-left-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-left-color"));d&&(""==G_prevCellStyle.topCell2[0].top.style&&-1<d.style.borderTopStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-top-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-top-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-top-color")),""==G_prevCellStyle.topCell2[0].right.style&&-1<d.style.borderRightStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-right-width"),
DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-right-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-right-color")));f&&(""==G_prevCellStyle.bottomCell1[0].bottom.style&&-1<f.style.borderBottomStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-bottom-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-bottom-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-bottom-color")),""==G_prevCellStyle.bottomCell1[0].left.style&&-1<f.style.borderLeftStyle.indexOf("none")&&
(DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-left-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-left-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-left-color")));g&&(""==G_prevCellStyle.bottomCell2[0].bottom.style&&-1<g.style.borderBottomStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(g,"border-bottom-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(g,"border-bottom-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(g,"border-bottom-color")),""==G_prevCellStyle.bottomCell2[0].right.style&&
-1<g.style.borderRightStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(g,"border-right-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(g,"border-right-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(g,"border-right-color")));D&&(D.src="../images/editor/dialog/editor_line_horizon_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(D,"imgstate","active"));H&&(H.src="../images/editor/dialog/editor_line_vertical_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(H,"imgstate","active"));if(c&&d){""==
l[0]?(c.style.borderRightWidth=G_prevCellStyle.topCell1[0].right.width,d.style.borderLeftWidth=G_prevCellStyle.topCell2[0].left.width):(c.style.borderRightWidth=l[0],d.style.borderLeftWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(c.style.borderRightStyle=G_prevCellStyle.topCell1[0].right.style,d.style.borderLeftStyle=G_prevCellStyle.topCell2[0].left.style):(c.style.borderRightStyle=l[1],d.style.borderLeftStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.topCell1[0].right.style.indexOf("none")?
c.style.borderRightStyle="none":c.style.borderRightColor=G_prevCellStyle.topCell1[0].right.color,-1<G_prevCellStyle.topCell2[0].left.style.indexOf("none")?d.style.borderLeftStyle="none":d.style.borderLeftColor=G_prevCellStyle.topCell2[0].left.color;else if(b=t.match(w))c.style.borderRightColor=b[0],d.style.borderLeftColor=b[0];""!=G_prevCellStyle.topCell1[0].right.width+G_prevCellStyle.topCell1[0].right.style+G_prevCellStyle.topCell1[0].right.color||x?cellRemoveClass(c,"dext_cell_border_r"):cellAddClass(c,
"dext_cell_border_r");""!=G_prevCellStyle.topCell2[0].left.width+G_prevCellStyle.topCell2[0].left.style+G_prevCellStyle.topCell2[0].left.color||x?cellRemoveClass(d,"dext_cell_border_l"):cellAddClass(d,"dext_cell_border_l")}if(f&&g){""==l[0]?(f.style.borderRightWidth=G_prevCellStyle.bottomCell1[0].right.width,g.style.borderLeftWidth=G_prevCellStyle.bottomCell2[0].left.width):(f.style.borderRightWidth=l[0],g.style.borderLeftWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(f.style.borderRightStyle=
G_prevCellStyle.bottomCell1[0].right.style,g.style.borderLeftStyle=G_prevCellStyle.bottomCell2[0].left.style):(f.style.borderRightStyle=l[1],g.style.borderLeftStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.bottomCell1[0].right.style.indexOf("none")?f.style.borderRightStyle="none":f.style.borderRightColor=G_prevCellStyle.bottomCell1[0].right.color,-1<G_prevCellStyle.bottomCell2[0].left.style.indexOf("none")?g.style.borderLeftStyle="none":g.style.borderLeftColor=
G_prevCellStyle.bottomCell2[0].left.color;else if(b=t.match(w))f.style.borderRightColor=b[0],g.style.borderLeftColor=b[0];""!=G_prevCellStyle.bottomCell1[0].right.width+G_prevCellStyle.bottomCell1[0].right.style+G_prevCellStyle.bottomCell1[0].right.color||x?cellRemoveClass(f,"dext_cell_border_r"):cellAddClass(f,"dext_cell_border_r");""!=G_prevCellStyle.bottomCell2[0].left.width+G_prevCellStyle.bottomCell2[0].left.style+G_prevCellStyle.bottomCell2[0].left.color||x?cellRemoveClass(g,"dext_cell_border_l"):
cellAddClass(g,"dext_cell_border_l")}if(c&&f){""==l[0]?(c.style.borderBottomWidth=G_prevCellStyle.topCell1[0].bottom.width,f.style.borderTopWidth=G_prevCellStyle.bottomCell1[0].top.width):(c.style.borderBottomWidth=l[0],f.style.borderTopWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(c.style.borderBottomStyle=G_prevCellStyle.topCell1[0].bottom.style,f.style.borderTopStyle=G_prevCellStyle.bottomCell1[0].top.style):(c.style.borderBottomStyle=l[1],f.style.borderTopStyle=l[1]);if(-1<l[2].indexOf("initial")||
-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.topCell1[0].bottom.style.indexOf("none")?c.style.borderBottomStyle="none":c.style.borderBottomColor=G_prevCellStyle.topCell1[0].bottom.color,-1<G_prevCellStyle.bottomCell1[0].top.style.indexOf("none")?f.style.borderTopStyle="none":f.style.borderTopColor=G_prevCellStyle.bottomCell1[0].top.color;else if(b=t.match(w))c.style.borderBottomColor=b[0],f.style.borderTopColor=b[0];""!=G_prevCellStyle.topCell1[0].bottom.width+G_prevCellStyle.topCell1[0].bottom.style+
G_prevCellStyle.topCell1[0].bottom.color||x?cellRemoveClass(c,"dext_cell_border_b"):cellAddClass(c,"dext_cell_border_b");""!=G_prevCellStyle.bottomCell1[0].top.width+G_prevCellStyle.bottomCell1[0].top.style+G_prevCellStyle.bottomCell1[0].top.color||x?cellRemoveClass(f,"dext_cell_border_t"):cellAddClass(f,"dext_cell_border_t")}if(d&&g){""==l[0]?(d.style.borderBottomWidth=G_prevCellStyle.topCell2[0].bottom.width,g.style.borderTopWidth=G_prevCellStyle.bottomCell2[0].top.width):(d.style.borderBottomWidth=
l[0],g.style.borderTopWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(d.style.borderBottomStyle=G_prevCellStyle.topCell2[0].bottom.style,g.style.borderTopStyle=G_prevCellStyle.bottomCell2[0].top.style):(d.style.borderBottomStyle=l[1],g.style.borderTopStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.topCell2[0].bottom.style.indexOf("none")?d.style.borderBottomStyle="none":d.style.borderBottomColor=G_prevCellStyle.topCell2[0].bottom.color,-1<G_prevCellStyle.bottomCell2[0].top.style.indexOf("none")?
g.style.borderTopStyle="none":g.style.borderTopColor=G_prevCellStyle.bottomCell2[0].top.color;else if(b=t.match(w))d.style.borderBottomColor=b[0],g.style.borderTopColor=b[0];""!=G_prevCellStyle.topCell2[0].bottom.width+G_prevCellStyle.topCell2[0].bottom.style+G_prevCellStyle.topCell2[0].bottom.color||x?cellRemoveClass(d,"dext_cell_border_b"):cellAddClass(d,"dext_cell_border_b");""!=G_prevCellStyle.bottomCell2[0].top.width+G_prevCellStyle.bottomCell2[0].top.style+G_prevCellStyle.bottomCell2[0].top.color||
x?cellRemoveClass(g,"dext_cell_border_t"):cellAddClass(g,"dext_cell_border_t")}if("rows"==p)""!=G_prevCellStyle.topCell1[0].top.style?(c.style.borderTopWidth=G_prevCellStyle.topCell1[0].top.width,c.style.borderTopStyle=G_prevCellStyle.topCell1[0].top.style,c.style.borderTopColor=G_prevCellStyle.topCell1[0].top.color):cellAddClass(c,"dext_cell_border_t"),""!=G_prevCellStyle.topCell1[0].left.style?(c.style.borderLeftWidth=G_prevCellStyle.topCell1[0].left.width,c.style.borderLeftStyle=G_prevCellStyle.topCell1[0].left.style,
c.style.borderLeftColor=G_prevCellStyle.topCell1[0].left.color):cellAddClass(c,"dext_cell_border_l"),""!=G_prevCellStyle.topCell1[0].right.style?(c.style.borderRightWidth=G_prevCellStyle.topCell1[0].right.width,c.style.borderRightStyle=G_prevCellStyle.topCell1[0].right.style,c.style.borderRightColor=G_prevCellStyle.topCell1[0].right.color):cellAddClass(c,"dext_cell_border_r"),""!=G_prevCellStyle.bottomCell1[0].bottom.style?(f.style.borderBottomWidth=G_prevCellStyle.bottomCell1[0].bottom.width,f.style.borderBottomStyle=
G_prevCellStyle.bottomCell1[0].bottom.style,f.style.borderBottomColor=G_prevCellStyle.bottomCell1[0].bottom.color):cellAddClass(f,"dext_cell_border_b"),""!=G_prevCellStyle.bottomCell1[0].left.style?(f.style.borderLeftWidth=G_prevCellStyle.bottomCell1[0].left.width,f.style.borderLeftStyle=G_prevCellStyle.bottomCell1[0].left.style,f.style.borderLeftColor=G_prevCellStyle.bottomCell1[0].left.color):cellAddClass(f,"dext_cell_border_l"),""!=G_prevCellStyle.bottomCell1[0].right.style?(f.style.borderRightWidth=
G_prevCellStyle.bottomCell1[0].right.width,f.style.borderRightStyle=G_prevCellStyle.bottomCell1[0].right.style,f.style.borderRightColor=G_prevCellStyle.bottomCell1[0].right.color):cellAddClass(f,"dext_cell_border_r");else if("cols"==p)""!=G_prevCellStyle.topCell1[0].top.style?(c.style.borderTopWidth=G_prevCellStyle.topCell1[0].top.width,c.style.borderTopStyle=G_prevCellStyle.topCell1[0].top.style,c.style.borderTopColor=G_prevCellStyle.topCell1[0].top.color):cellAddClass(c,"dext_cell_border_t"),""!=
G_prevCellStyle.topCell1[0].bottom.style?(c.style.borderBottomWidth=G_prevCellStyle.topCell1[0].bottom.width,c.style.borderBottomStyle=G_prevCellStyle.topCell1[0].bottom.style,c.style.borderBottomColor=G_prevCellStyle.topCell1[0].bottom.color):cellAddClass(c,"dext_cell_border_b"),""!=G_prevCellStyle.topCell1[0].left.style?(c.style.borderLeftWidth=G_prevCellStyle.topCell1[0].left.width,c.style.borderLeftStyle=G_prevCellStyle.topCell1[0].left.style,c.style.borderLeftColor=G_prevCellStyle.topCell1[0].left.color):
cellAddClass(c,"dext_cell_border_l"),""!=G_prevCellStyle.topCell2[0].top.style?(d.style.borderTopWidth=G_prevCellStyle.topCell2[0].top.width,d.style.borderTopStyle=G_prevCellStyle.topCell2[0].top.style,d.style.borderTopColor=G_prevCellStyle.topCell2[0].top.color):cellAddClass(d,"dext_cell_border_t"),""!=G_prevCellStyle.topCell2[0].bottom.style?(d.style.borderBottomWidth=G_prevCellStyle.topCell2[0].bottom.width,d.style.borderBottomStyle=G_prevCellStyle.topCell2[0].bottom.style,d.style.borderBottomColor=
G_prevCellStyle.topCell2[0].bottom.color):cellAddClass(d,"dext_cell_border_b"),""!=G_prevCellStyle.topCell2[0].right.style?(d.style.borderRightWidth=G_prevCellStyle.topCell2[0].right.width,d.style.borderRightStyle=G_prevCellStyle.topCell2[0].right.style,d.style.borderRightColor=G_prevCellStyle.topCell2[0].right.color):cellAddClass(d,"dext_cell_border_r");else if("multi"==p||""==p)""!=G_prevCellStyle.topCell1[0].top.style?(c.style.borderTopWidth=G_prevCellStyle.topCell1[0].top.width,c.style.borderTopStyle=
G_prevCellStyle.topCell1[0].top.style,c.style.borderTopColor=G_prevCellStyle.topCell1[0].top.color):cellAddClass(c,"dext_cell_border_t"),""!=G_prevCellStyle.topCell1[0].left.style?(c.style.borderLeftWidth=G_prevCellStyle.topCell1[0].left.width,c.style.borderLeftStyle=G_prevCellStyle.topCell1[0].left.style,c.style.borderLeftColor=G_prevCellStyle.topCell1[0].left.color):cellAddClass(c,"dext_cell_border_l"),""!=G_prevCellStyle.topCell2[0].top.style?(d.style.borderTopWidth=G_prevCellStyle.topCell2[0].top.width,
d.style.borderTopStyle=G_prevCellStyle.topCell2[0].top.style,d.style.borderTopColor=G_prevCellStyle.topCell2[0].top.color):cellAddClass(d,"dext_cell_border_t"),""!=G_prevCellStyle.topCell2[0].right.style?(d.style.borderRightWidth=G_prevCellStyle.topCell2[0].right.width,d.style.borderRightStyle=G_prevCellStyle.topCell2[0].right.style,d.style.borderRightColor=G_prevCellStyle.topCell2[0].right.color):cellAddClass(d,"dext_cell_border_r"),""!=G_prevCellStyle.bottomCell1[0].bottom.style?(f.style.borderBottomWidth=
G_prevCellStyle.bottomCell1[0].bottom.width,f.style.borderBottomStyle=G_prevCellStyle.bottomCell1[0].bottom.style,f.style.borderBottomColor=G_prevCellStyle.bottomCell1[0].bottom.color):cellAddClass(f,"dext_cell_border_b"),""!=G_prevCellStyle.bottomCell1[0].left.style?(f.style.borderLeftWidth=G_prevCellStyle.bottomCell1[0].left.width,f.style.borderLeftStyle=G_prevCellStyle.bottomCell1[0].left.style,f.style.borderLeftColor=G_prevCellStyle.bottomCell1[0].left.color):cellAddClass(f,"dext_cell_border_l"),
""!=G_prevCellStyle.bottomCell2[0].bottom.style?(g.style.borderBottomWidth=G_prevCellStyle.bottomCell2[0].bottom.width,g.style.borderBottomStyle=G_prevCellStyle.bottomCell2[0].bottom.style,g.style.borderBottomColor=G_prevCellStyle.bottomCell2[0].bottom.color):cellAddClass(g,"dext_cell_border_b"),""!=G_prevCellStyle.bottomCell2[0].right.style?(g.style.borderRightWidth=G_prevCellStyle.bottomCell2[0].right.width,g.style.borderRightStyle=G_prevCellStyle.bottomCell2[0].right.style,g.style.borderRightColor=
G_prevCellStyle.bottomCell2[0].right.color):cellAddClass(g,"dext_cell_border_r");u(p);B();setClickedBorderCheck(["insideRow","insideCol"],G)}else if("outline"==a){D&&(DEXTTOP.DEXT5.util.setCustomAttribute(D,"imgstate","active"),edgeClick("horizon"));H&&(DEXTTOP.DEXT5.util.setCustomAttribute(H,"imgstate","active"),edgeClick("vertical"));edgeSelectClick(5,"outline");""==G_prevCellStyle.topCell1[0].bottom.style&&-1<c.style.borderBottomStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(c,
"border-bottom-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-bottom-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-bottom-color"));""==G_prevCellStyle.topCell1[0].right.style&&-1<c.style.borderRightStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-right-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-right-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-right-color"));d&&(""==G_prevCellStyle.topCell2[0].bottom.style&&-1<d.style.borderBottomStyle.indexOf("none")&&
(DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-bottom-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-bottom-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-bottom-color")),""==G_prevCellStyle.topCell2[0].left.style&&-1<d.style.borderLeftStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-left-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-left-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(d,"border-left-color")));f&&(""==G_prevCellStyle.bottomCell1[0].top.style&&
-1<f.style.borderTopStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-top-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-top-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-top-color")),""==G_prevCellStyle.bottomCell1[0].right.style&&-1<f.style.borderRightStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-right-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-right-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(f,"border-right-color")));
g&&(""==G_prevCellStyle.bottomCell2[0].top.style&&-1<g.style.borderTopStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(g,"border-top-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(g,"border-top-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(g,"border-top-color")),""==G_prevCellStyle.bottomCell2[0].left.style&&-1<g.style.borderLeftStyle.indexOf("none")&&(DEXTTOP.DEXT5.util.removeStyleAttribute(g,"border-left-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(g,"border-left-style"),DEXTTOP.DEXT5.util.removeStyleAttribute(g,
"border-left-color")));E&&(E.src="../images/editor/dialog/editor_line_top_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(E,"imgstate","active"));F&&(F.src="../images/editor/dialog/editor_line_bottom_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(F,"imgstate","active"));J&&(J.src="../images/editor/dialog/editor_line_left_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(J,"imgstate","active"));I&&(I.src="../images/editor/dialog/editor_line_right_img.gif",DEXTTOP.DEXT5.util.setCustomAttribute(I,"imgstate",
"active"));if(c&&d){""==l[0]?(c.style.borderTopWidth=G_prevCellStyle.topCell1[0].top.width,c.style.borderLeftWidth=G_prevCellStyle.topCell1[0].left.width,d.style.borderTopWidth=G_prevCellStyle.topCell2[0].top.width,d.style.borderRightWidth=G_prevCellStyle.topCell2[0].right.width):(c.style.borderTopWidth=l[0],c.style.borderLeftWidth=l[0],d.style.borderTopWidth=l[0],d.style.borderRightWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(c.style.borderTopStyle=G_prevCellStyle.topCell1[0].top.style,c.style.borderLeftStyle=
G_prevCellStyle.topCell1[0].left.style,d.style.borderTopStyle=G_prevCellStyle.topCell2[0].top.style,d.style.borderRightStyle=G_prevCellStyle.topCell2[0].right.style):(c.style.borderTopStyle=l[1],c.style.borderLeftStyle=l[1],d.style.borderTopStyle=l[1],d.style.borderRightStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.topCell1[0].top.style.indexOf("none")?c.style.borderTopStyle="none":c.style.borderTopColor=G_prevCellStyle.topCell1[0].top.color,-1<G_prevCellStyle.topCell1[0].left.style.indexOf("none")?
c.style.borderLeftStyle="none":c.style.borderLeftColor=G_prevCellStyle.topCell1[0].left.color,-1<G_prevCellStyle.topCell2[0].top.style.indexOf("none")?d.style.borderTopStyle="none":d.style.borderTopColor=G_prevCellStyle.topCell2[0].top.color,-1<G_prevCellStyle.topCell2[0].right.style.indexOf("none")?d.style.borderRightStyle="none":d.style.borderRightColor=G_prevCellStyle.topCell2[0].right.color;else if(b=t.match(w))c.style.borderTopColor=b[0],c.style.borderLeftColor=b[0],d.style.borderTopColor=b[0],
d.style.borderRightColor=b[0];""!=G_prevCellStyle.topCell1[0].top.width+G_prevCellStyle.topCell1[0].top.style+G_prevCellStyle.topCell1[0].top.color||x?cellRemoveClass(c,"dext_cell_border_t"):cellAddClass(c,"dext_cell_border_t");""!=G_prevCellStyle.topCell1[0].left.width+G_prevCellStyle.topCell1[0].left.style+G_prevCellStyle.topCell1[0].left.color||x?cellRemoveClass(c,"dext_cell_border_l"):cellAddClass(c,"dext_cell_border_l");""!=G_prevCellStyle.topCell2[0].top.width+G_prevCellStyle.topCell2[0].top.style+
G_prevCellStyle.topCell2[0].top.color||x?cellRemoveClass(d,"dext_cell_border_t"):cellAddClass(d,"dext_cell_border_t");""!=G_prevCellStyle.topCell2[0].right.width+G_prevCellStyle.topCell2[0].right.style+G_prevCellStyle.topCell2[0].right.color||x?cellRemoveClass(d,"dext_cell_border_r"):cellAddClass(d,"dext_cell_border_r")}else if(c){""==l[0]?(c.style.borderTopWidth=G_prevCellStyle.topCell1[0].top.width,c.style.borderLeftWidth=G_prevCellStyle.topCell1[0].left.width,c.style.borderRightWidth=G_prevCellStyle.topCell1[0].right.width):
(c.style.borderTopWidth=l[0],c.style.borderLeftWidth=l[0],c.style.borderRightWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(c.style.borderTopStyle=G_prevCellStyle.topCell1[0].top.style,c.style.borderLeftStyle=G_prevCellStyle.topCell1[0].left.style,c.style.borderRightStyle=G_prevCellStyle.topCell1[0].right.style):(c.style.borderTopStyle=l[1],c.style.borderLeftStyle=l[1],c.style.borderRightStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.topCell1[0].top.style.indexOf("none")?
c.style.borderTopStyle="none":c.style.borderTopColor=G_prevCellStyle.topCell1[0].top.color,-1<G_prevCellStyle.topCell1[0].left.style.indexOf("none")?c.style.borderLeftStyle="none":c.style.borderLeftColor=G_prevCellStyle.topCell1[0].left.color,-1<G_prevCellStyle.topCell1[0].right.style.indexOf("none")?c.style.borderRightStyle="none":c.style.borderRightColor=G_prevCellStyle.topCell1[0].right.color;else if(b=t.match(w))c.style.borderTopColor=b[0],c.style.borderLeftColor=b[0],c.style.borderRightColor=
b[0];""!=G_prevCellStyle.topCell1[0].top.width+G_prevCellStyle.topCell1[0].top.style+G_prevCellStyle.topCell1[0].top.color||x?cellRemoveClass(c,"dext_cell_border_t"):cellAddClass(c,"dext_cell_border_t");""!=G_prevCellStyle.topCell1[0].left.width+G_prevCellStyle.topCell1[0].left.style+G_prevCellStyle.topCell1[0].left.color||x?cellRemoveClass(c,"dext_cell_border_l"):cellAddClass(c,"dext_cell_border_l");""!=G_prevCellStyle.topCell1[0].right.width+G_prevCellStyle.topCell1[0].right.style+G_prevCellStyle.topCell1[0].right.color||
x?cellRemoveClass(c,"dext_cell_border_r"):cellAddClass(c,"dext_cell_border_r")}if(f&&g){""==l[0]?(f.style.borderBottomWidth=G_prevCellStyle.bottomCell1[0].bottom.width,f.style.borderLeftWidth=G_prevCellStyle.bottomCell1[0].left.width,g.style.borderBottomWidth=G_prevCellStyle.bottomCell2[0].bottom.width,g.style.borderRightWidth=G_prevCellStyle.bottomCell2[0].right.width):(f.style.borderBottomWidth=l[0],f.style.borderLeftWidth=l[0],g.style.borderBottomWidth=l[0],g.style.borderRightWidth=l[0]);-1<l[1].indexOf("none")&&
"0px"!=l[0]?(f.style.borderBottomStyle=G_prevCellStyle.bottomCell1[0].bottom.style,f.style.borderLeftStyle=G_prevCellStyle.bottomCell1[0].left.style,g.style.borderBottomStyle=G_prevCellStyle.bottomCell2[0].bottom.style,g.style.borderRightStyle=G_prevCellStyle.bottomCell2[0].right.style):(f.style.borderBottomStyle=l[1],f.style.borderLeftStyle=l[1],g.style.borderBottomStyle=l[1],g.style.borderRightStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.bottomCell1[0].bottom.style.indexOf("none")?
f.style.borderBottomStyle="none":f.style.borderBottomColor=G_prevCellStyle.bottomCell1[0].bottom.color,-1<G_prevCellStyle.bottomCell1[0].left.style.indexOf("none")?f.style.borderLeftStyle="none":f.style.borderLeftColor=G_prevCellStyle.bottomCell1[0].left.color,-1<G_prevCellStyle.bottomCell2[0].bottom.style.indexOf("none")?g.style.borderBottomStyle="none":g.style.borderBottomColor=G_prevCellStyle.bottomCell2[0].bottom.color,-1<G_prevCellStyle.bottomCell2[0].right.style.indexOf("none")?g.style.borderRightStyle=
"none":g.style.borderRightColor=G_prevCellStyle.bottomCell2[0].right.color;else if(b=t.match(w))f.style.borderBottomColor=b[0],f.style.borderLeftColor=b[0],g.style.borderBottomColor=b[0],g.style.borderRightColor=b[0];""!=G_prevCellStyle.bottomCell1[0].bottom.width+G_prevCellStyle.bottomCell1[0].bottom.style+G_prevCellStyle.bottomCell1[0].bottom.color||x?cellRemoveClass(f,"dext_cell_border_b"):cellAddClass(f,"dext_cell_border_b");""!=G_prevCellStyle.bottomCell1[0].left.width+G_prevCellStyle.bottomCell1[0].left.style+
G_prevCellStyle.bottomCell1[0].left.color||x?cellRemoveClass(f,"dext_cell_border_l"):cellAddClass(f,"dext_cell_border_l");""!=G_prevCellStyle.bottomCell2[0].bottom.width+G_prevCellStyle.bottomCell2[0].bottom.style+G_prevCellStyle.bottomCell2[0].bottom.color||x?cellRemoveClass(g,"dext_cell_border_b"):cellAddClass(g,"dext_cell_border_b");""!=G_prevCellStyle.bottomCell2[0].right.width+G_prevCellStyle.bottomCell2[0].right.style+G_prevCellStyle.bottomCell2[0].right.color||x?cellRemoveClass(g,"dext_cell_border_r"):
cellAddClass(g,"dext_cell_border_r")}else if(f){""==l[0]?(f.style.borderBottomWidth=G_prevCellStyle.bottomCell1[0].bottom.width,f.style.borderLeftWidth=G_prevCellStyle.bottomCell1[0].left.width,f.style.borderRightWidth=G_prevCellStyle.bottomCell1[0].right.width):(f.style.borderBottomWidth=l[0],f.style.borderLeftWidth=l[0],f.style.borderRightWidth=l[0]);-1<l[1].indexOf("none")&&"0px"!=l[0]?(f.style.borderBottomStyle=G_prevCellStyle.bottomCell1[0].bottom.style,f.style.borderLeftStyle=G_prevCellStyle.bottomCell1[0].left.style,
f.style.borderRightStyle=G_prevCellStyle.bottomCell1[0].right.style):(f.style.borderBottomStyle=l[1],f.style.borderLeftStyle=l[1],f.style.borderRightStyle=l[1]);if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.bottomCell1[0].bottom.style.indexOf("none")?f.style.borderBottomStyle="none":f.style.borderBottomColor=G_prevCellStyle.bottomCell1[0].bottom.color,-1<G_prevCellStyle.bottomCell1[0].left.style.indexOf("none")?f.style.borderLeftStyle="none":f.style.borderLeftColor=
G_prevCellStyle.bottomCell1[0].left.color,-1<G_prevCellStyle.bottomCell1[0].right.style.indexOf("none")?f.style.borderRightStyle="none":f.style.borderRightColor=G_prevCellStyle.bottomCell1[0].right.color;else if(b=t.match(w))f.style.borderBottomColor=b[0],f.style.borderLeftColor=b[0],f.style.borderRightColor=b[0];""!=G_prevCellStyle.bottomCell1[0].bottom.width+G_prevCellStyle.bottomCell1[0].bottom.style+G_prevCellStyle.bottomCell1[0].bottom.color||x?cellRemoveClass(f,"dext_cell_border_b"):cellAddClass(f,
"dext_cell_border_b");""!=G_prevCellStyle.bottomCell1[0].left.width+G_prevCellStyle.bottomCell1[0].left.style+G_prevCellStyle.bottomCell1[0].left.color||x?cellRemoveClass(f,"dext_cell_border_l"):cellAddClass(f,"dext_cell_border_l");""!=G_prevCellStyle.bottomCell1[0].right.width+G_prevCellStyle.bottomCell1[0].right.style+G_prevCellStyle.bottomCell1[0].right.color||x?cellRemoveClass(f,"dext_cell_border_r"):cellAddClass(f,"dext_cell_border_r")}else{if(c){c.style.borderBottomWidth=""==l[0]?G_prevCellStyle.topCell1[0].bottom.width:
l[0];-1<l[1].indexOf("none")&&"0px"!=l[0]?c.style.borderBottomStyle=G_prevCellStyle.topCell1[0].bottom.style:c.style.borderBottomStyle=l[1];if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.topCell1[0].bottom.style.indexOf("none")?c.style.borderBottomStyle="none":c.style.borderBottomColor=G_prevCellStyle.topCell1[0].bottom.color;else if(b=t.match(w))c.style.borderBottomColor=b[0];""!=G_prevCellStyle.topCell1[0].bottom.width+G_prevCellStyle.topCell1[0].bottom.style+
G_prevCellStyle.topCell1[0].bottom.color||x?cellRemoveClass(c,"dext_cell_border_b"):cellAddClass(c,"dext_cell_border_b")}if(d){d.style.borderBottomWidth=""==l[0]?G_prevCellStyle.topCell2[0].bottom.width:l[0];-1<l[1].indexOf("none")&&"0px"!=l[0]?d.style.borderBottomStyle=G_prevCellStyle.topCell2[0].bottom.style:d.style.borderBottomStyle=l[1];if(-1<l[2].indexOf("initial")||-1<l[2].indexOf("currentColor"))-1<G_prevCellStyle.topCell2[0].bottom.style.indexOf("none")?d.style.borderBottomStyle="none":d.style.borderBottomColor=
G_prevCellStyle.topCell2[0].bottom.color;else if(b=t.match(w))d.style.borderBottomColor=b[0];""!=G_prevCellStyle.topCell2[0].bottom.width+G_prevCellStyle.topCell2[0].bottom.style+G_prevCellStyle.topCell2[0].bottom.color||x?cellRemoveClass(d,"dext_cell_border_b"):cellAddClass(d,"dext_cell_border_b")}}if("rows"==p)""!=G_prevCellStyle.topCell1[0].bottom.style?(c.style.borderBottomWidth=G_prevCellStyle.topCell1[0].bottom.width,c.style.borderBottomStyle=G_prevCellStyle.topCell1[0].bottom.style,c.style.borderBottomColor=
G_prevCellStyle.topCell1[0].bottom.color):cellAddClass(c,"dext_cell_border_b"),""!=G_prevCellStyle.bottomCell1[0].top.style?(f.style.borderTopWidth=G_prevCellStyle.bottomCell1[0].top.width,f.style.borderTopStyle=G_prevCellStyle.bottomCell1[0].top.style,f.style.borderTopColor=G_prevCellStyle.bottomCell1[0].top.color):cellAddClass(f,"dext_cell_border_t");else if("cols"==p)""!=G_prevCellStyle.topCell1[0].right.style?(c.style.borderRightWidth=G_prevCellStyle.topCell1[0].right.width,c.style.borderRightStyle=
G_prevCellStyle.topCell1[0].right.style,c.style.borderRightColor=G_prevCellStyle.topCell1[0].right.color):cellAddClass(c,"dext_cell_border_r"),""!=G_prevCellStyle.topCell2[0].left.style?(d.style.borderLeftWidth=G_prevCellStyle.topCell2[0].left.width,d.style.borderLeftStyle=G_prevCellStyle.topCell2[0].left.style,d.style.borderLeftColor=G_prevCellStyle.topCell2[0].left.color):cellAddClass(d,"dext_cell_border_l");else if("multi"==p||""==p)""!=G_prevCellStyle.topCell1[0].bottom.style?(c.style.borderBottomWidth=
G_prevCellStyle.topCell1[0].bottom.width,c.style.borderBottomStyle=G_prevCellStyle.topCell1[0].bottom.style,c.style.borderBottomColor=G_prevCellStyle.topCell1[0].bottom.color):cellAddClass(c,"dext_cell_border_b"),""!=G_prevCellStyle.topCell1[0].right.style?(c.style.borderRightWidth=G_prevCellStyle.topCell1[0].right.width,c.style.borderRightStyle=G_prevCellStyle.topCell1[0].right.style,c.style.borderRightColor=G_prevCellStyle.topCell1[0].right.color):cellAddClass(c,"dext_cell_border_r"),""!=G_prevCellStyle.topCell2[0].bottom.style?
(d.style.borderBottomWidth=G_prevCellStyle.topCell2[0].bottom.width,d.style.borderBottomStyle=G_prevCellStyle.topCell2[0].bottom.style,d.style.borderBottomColor=G_prevCellStyle.topCell2[0].bottom.color):cellAddClass(d,"dext_cell_border_b"),""!=G_prevCellStyle.topCell2[0].left.style?(d.style.borderLeftWidth=G_prevCellStyle.topCell2[0].left.width,d.style.borderLeftStyle=G_prevCellStyle.topCell2[0].left.style,d.style.borderLeftColor=G_prevCellStyle.topCell2[0].left.color):cellAddClass(d,"dext_cell_border_l"),
""!=G_prevCellStyle.bottomCell1[0].top.style?(f.style.borderTopWidth=G_prevCellStyle.bottomCell1[0].top.width,f.style.borderTopStyle=G_prevCellStyle.bottomCell1[0].top.style,f.style.borderTopColor=G_prevCellStyle.bottomCell1[0].top.color):cellAddClass(f,"dext_cell_border_t"),""!=G_prevCellStyle.bottomCell1[0].right.style?(f.style.borderRightWidth=G_prevCellStyle.bottomCell1[0].right.width,f.style.borderRightStyle=G_prevCellStyle.bottomCell1[0].right.style,f.style.borderRightColor=G_prevCellStyle.bottomCell1[0].right.color):
cellAddClass(f,"dext_cell_border_r"),""!=G_prevCellStyle.bottomCell2[0].top.style?(g.style.borderTopWidth=G_prevCellStyle.bottomCell2[0].top.width,g.style.borderTopStyle=G_prevCellStyle.bottomCell2[0].top.style,g.style.borderTopColor=G_prevCellStyle.bottomCell2[0].top.color):cellAddClass(g,"dext_cell_border_t"),""!=G_prevCellStyle.bottomCell2[0].left.style?(g.style.borderLeftWidth=G_prevCellStyle.bottomCell2[0].left.width,g.style.borderLeftStyle=G_prevCellStyle.bottomCell2[0].left.style,g.style.borderLeftColor=
G_prevCellStyle.bottomCell2[0].left.color):cellAddClass(g,"dext_cell_border_l");u(p);B();setClickedBorderCheck(["outsideTop","outsideRight","outsideBottom","outsideLeft"],G)}else if("none"==a){var Q=function(a,b,c){var e=["top","right","bottom","left"],d={top:"dext_cell_border_t",right:"dext_cell_border_r",bottom:"dext_cell_border_b",left:"dext_cell_border_l"},f={top:"../images/editor/dialog/editor_line_top_d_img.gif",right:"../images/editor/dialog/editor_line_right_d_img.gif",bottom:"../images/editor/dialog/editor_line_bottom_d_img.gif",
left:"../images/editor/dialog/editor_line_left_d_img.gif",diagonalUp:"../images/editor/dialog/editor_line_dext_diagonal_up_d_img.gif",diagonalDown:"../images/editor/dialog/editor_line_dext_diagonal_down_d_img.gif"};DEXTTOP.DEXT5.util.setCustomAttribute(E,"imgstate","active");DEXTTOP.DEXT5.util.setCustomAttribute(F,"imgstate","active");DEXTTOP.DEXT5.util.setCustomAttribute(J,"imgstate","active");DEXTTOP.DEXT5.util.setCustomAttribute(I,"imgstate","active");K&&DEXTTOP.DEXT5.util.setCustomAttribute(K,
"imgstate","deactive");L&&DEXTTOP.DEXT5.util.setCustomAttribute(L,"imgstate","deactive");switch(b.multiSelection){case "one":break;case "rows":e.push("middle");d.middle="";f.middle="../images/editor/dialog/editor_line_horizon_d_img.gif";D&&DEXTTOP.DEXT5.util.setCustomAttribute(D,"imgstate","active");break;case "cols":e.push("center");d.center="";f.center="../images/editor/dialog/editor_line_vertical_d_img.gif";H&&DEXTTOP.DEXT5.util.setCustomAttribute(H,"imgstate","active");break;default:e.push("middle"),
e.push("center"),d.middle="",d.center="",f.middle="../images/editor/dialog/editor_line_horizon_d_img.gif",f.center="../images/editor/dialog/editor_line_vertical_d_img.gif",D&&DEXTTOP.DEXT5.util.setCustomAttribute(D,"imgstate","active"),H&&DEXTTOP.DEXT5.util.setCustomAttribute(H,"imgstate","active")}if(b.middle&&""!=b.middle)switch(a.id){case "topcell1":case "topcell2":d.middle="dext_cell_border_b";break;case "bottomcell1":case "bottomcell2":d.middle="dext_cell_border_t"}if(b.center&&""!=b.center)switch(a.id){case "topcell1":case "bottomcell1":d.center=
"dext_cell_border_r";break;case "topcell2":case "bottomcell2":d.center="dext_cell_border_l"}for(var g=document.getElementById("line_style"),h=document.getElementById("line_color"),k=document.getElementById("line_thickness"),l=[],m=[],n=[],p=!1,x=!1,q=0;q<e.length;q++){var r=e[q],t=!0,u=!1;if("multi"==b.multiSelection)if("top"==r&&""!=b.middle){if(-1<a.id.indexOf("bottom"))continue}else if("right"==r&&""!=b.center){if(-1<a.id.indexOf("cell1"))continue}else if("bottom"==r&&""!=b.middle){if(-1<a.id.indexOf("top"))continue}else{if("left"==
r&&""!=b.center&&-1<a.id.indexOf("cell2"))continue}else if("rows"==b.multiSelection)if("top"==r&&""!=b.middle){if(-1<a.id.indexOf("bottom"))continue}else{if("bottom"==r&&""!=b.middle&&-1<a.id.indexOf("top"))continue}else if("cols"==b.multiSelection)if("right"==r&&""!=b.center){if(-1<a.id.indexOf("cell1"))continue}else if("left"==r&&""!=b.center&&-1<a.id.indexOf("cell2"))continue;var B,v=[],w="",y=!1;if((B=(B=b[r].match(/(px|em|rem|vh|vw|%|medium|thin|thick)/))?B[0]:null)&&""!=B){if("medium"!=B&&"thin"!=
B&&"thick"!=B){for(B=b[r].indexOf(B)-1;b[r][B]&&" "!=b[r][B]&&0<=B;)v.push(b[r][B]),B--;B=v.length;for(var z=0;z<B;z++)w+=v.pop();"0"==w&&(y=!0)}}else null==B&&(y=!0);b[r]&&(-1<b[r].indexOf("diff")||-1<b[r].indexOf("none")||y)?(y&&(t=!1),-1<b[r].indexOf("none")&&(p=!0,t=!1,u=!0),-1<b[r].indexOf("diff")&&(t=x=!0,a.className+=" "+d[r],DEXTTOP.DEXT5.util.setCustomAttribute(c[r],"imgstate","deactive")),c[r]&&(c[r].src=f[r])):t=!1;t?(l="solid",m="#5d5d5d",n="1",p=!0):(t="",t="middle"==r&&""!=d.middle?
"b"==d[r].charAt(d[r].lastIndexOf("_")+1)?"borderBottom":"borderTop":"center"==r&&""!=d.center?"r"==d[r].charAt(d[r].lastIndexOf("_")+1)?"borderRight":"borderLeft":"border"+r.charAt(0).toUpperCase()+r.slice(1),u?(a.style[t]="0px none rgb(0, 0, 0)",c[t]&&(c[t].src=f[t])):a.style[t]=b[r],p||l.push(a.style[t]),p||m.push(a.style[t+"Color"]),p||n.push(LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(a.style[t+"Width"])));if(q==e.length-1){var t=u=r=!1,A,C,G;if("string"!=typeof l&&l.length&&1<l.length)for(A=l[0],
v=0;v<l.length;v++)if(A!=l[v]){r=!0;break}else A=l[v];if("string"!=typeof m&&m.length&&1<m.length)for(C=m[0],v=0;v<m.length;v++)if(C!=m[v]){u=!0;break}else C=m[v];if("string"!=typeof n&&n.length&&1<n.length)for(G=n[0],v=0;v<n.length;v++)if(G!=n[v]){t=!0;break}else G=n[v];if(A&&!r)switch(g.style.borderTop=A,g.style.borderTopColor="#5d5d5d",g.style.borderTopStyle){case "solid":case "dashed":case "dotted":g.style.borderTopWidth="1px";break;case "groove":case "ridge":case "inset":case "outset":g.style.border=
A;default:g.style.borderWidth="3px",g.style.borderColor="rgb(225, 225, 225)"}C&&!u&&(h.style.borderTopColor=C);G&&!t&&(k.value=G)}}x&&edgeSelectClick(4,"user")},B=LayerWin.GetPreviewCellBorder(b);G_sameAttr=B.sameAttr;B.isDifferent&&edgeSelectClick(4,"user");if("one"===B.multiSelection||"rows"===B.multiSelection||"cols"===B.multiSelection||"multi"===B.multiSelection){for(var l={top:E,right:I,bottom:F,left:J,middle:D,center:H,diagonalUp:K,diagonalDown:L},G=x=!1,M=!0,N=!0,S=[c,d,f,g],R=0;R<S.length;R++)if(S[R]&&
(Q(S[R],B,l),"1"==LayerWin.DEXTTOP.G_CURREDITOR._config.diagonal.use&&LayerWin.G_DEXT_Diagonal&&B.diagonalInfo&&!b)){if(""!=B.diagonalInfo.diagonalUpBorder){var x=!0,O=B.diagonalInfo.diagonalUpBorder,P=O.indexOf("diff");-1<P&&(O=O.substring(0,P),M=!1);LayerWin.G_DEXT_Diagonal.makeDiagonal(S[R],"up",O,!0,B.diagonalInfo.notAllUp||-1<P?["dext_cell_border_t","diff"]:null)}""!=B.diagonalInfo.diagonalDownBorder&&(G=!0,O=B.diagonalInfo.diagonalDownBorder,P=O.indexOf("diff"),-1<P&&(O=B.diagonalInfo.diagonalDownBorder.substring(0,
P),N=!1),LayerWin.G_DEXT_Diagonal.makeDiagonal(S[R],"down",O,!0,B.diagonalInfo.notAllDown||-1<P?["dext_cell_border_t","diff"]:null))}G_prevCellStyle={topCell1:[],topCell2:[],bottomCell1:[],bottomCell2:[]};e();G_prevCellStyle.topCell1.push(h);d&&G_prevCellStyle.topCell2.push(m);f&&G_prevCellStyle.bottomCell1.push(k);g&&G_prevCellStyle.bottomCell2.push(n);q();""!=G_sameAttr.total.sameWidth&&"diff"!=G_sameAttr.total.sameWidth?(isNaN(parseInt(G_sameAttr.total.sameWidth,10))?"thick"==G_sameAttr.total.sameWidth?
y.value="5":"medium"==G_sameAttr.total.sameWidth?y.value="3":"thin"==G_sameAttr.total.sameWidth&&(y.value="1"):y.value=parseInt(G_sameAttr.total.sameWidth,10),t+=G_sameAttr.total.sameWidth):allThicknessEqual(r)?(b=parseBorderStyle(r[0]).thickness,isNaN(parseInt(b,10))?"thick"==b?y.value="5":"medium"==b?y.value="3":"thin"==b&&(y.value="1"):y.value=parseInt(b,10),t+=b):y.value=" ";""!=G_sameAttr.total.sameStyle&&"diff"!=G_sameAttr.total.sameStyle?"none"==G_sameAttr.total.sameStyle?null==document.getElementById("none_line_style")&&
(b=document.createElement("span"),b.innerText=LayerWin.dext5_lang.table.line_style_hidden,b.id="none_line_style",b.className="none_line_style",v.style.display="none",v.parentNode.appendChild(b)):(document.getElementById("none_line_style")&&(v.parentNode.removeChild(document.getElementById("none_line_style")),DEXTTOP.DEXT5.util.removeStyleAttribute(v,"display")),v.style.borderTopStyle=G_sameAttr.total.sameStyle,-1<C.indexOf(G_sameAttr.total.sameStyle)?v.style.borderTopWidth="1px":v.style.borderTopWidth=
"3px"):allStyleEqual(r)?"none"==h.top.style?null==document.getElementById("none_line_style")&&(b=document.createElement("span"),b.innerText=LayerWin.dext5_lang.table.line_style_hidden,b.id="none_line_style",b.className="none_line_style",v.style.display="none",v.parentNode.appendChild(b)):(document.getElementById("none_line_style")&&(v.parentNode.removeChild(document.getElementById("none_line_style")),DEXTTOP.DEXT5.util.removeStyleAttribute(v,"display")),-1<C.indexOf(h.top.style)?(v.style.borderTopWidth=
"1px",v.style.borderTopStyle=h.top.style):"double"==h.top.style?(v.style.borderTopWidth="3px",v.style.borderTopStyle=h.top.style):v.style.border="3px "+h.top.style):v.style.borderTop="none";""!=G_sameAttr.total.sameColor&&"diff"!=G_sameAttr.total.sameColor?(A.style.borderTopWidth="6px",A.style.borderTopStyle="solid",A.style.borderTopColor=G_sameAttr.total.sameColor):allColorEqual(r)?(b=h.top.color,""!=b&&(A.style.borderTopWidth="6px",A.style.borderTopStyle="solid",A.style.borderTopColor=b)):A.style.borderTopStyle=
"none";(x||G)&&edgeSelectClick(4,"user");x&&!B.diagonalInfo.notAllUp&&M||!l.diagonalUp||(l.diagonalUp.src="../images/editor/dialog/editor_line_dext_diagonal_up_d_img.gif");G&&!B.diagonalInfo.notAllDown&&N||!l.diagonalDown||(l.diagonalDown.src="../images/editor/dialog/editor_line_dext_diagonal_down_d_img.gif")}}G_prevMode=a}}}function fnLineStyleToggle(){var a=document.getElementById("line_style_list");a.style.display="none"==a.style.display?"block":"none"}
function lineStyleChange(){var a=document.getElementById("line_style"),e=document.getElementById("line_thickness");if("hidden"==a.style.borderTopStyle||"none"==a.style.borderTopStyle)e.value="0",null==document.getElementById("none_line_style")&&(e=document.createElement("span"),e.innerText=LayerWin.dext5_lang.table.line_style_hidden,e.id="none_line_style",e.className="none_line_style",a.style.display="none",a.parentNode.appendChild(e),document.getElementById("line_color").style.borderTopColor="rgb(0, 0, 0)");
else if(document.getElementById("none_line_style")&&(a.parentNode.removeChild(document.getElementById("none_line_style")),DEXTTOP.DEXT5.util.removeStyleAttribute(a,"display")),"solid"!=a.style.borderTopStyle&&"dotted"!=a.style.borderTopStyle&&"dashed"!=a.style.borderTopStyle&&"hidden"!=a.style.borderTopStyle&&"none"!=a.style.borderTopStyle){if(isNaN(parseInt(e.value,10))||3>parseInt(e.value,10))e.value="3"}else" "!=e.value&&(isNaN(parseInt(e.value,10))||0>=parseInt(e.value,10))&&(e.value="1");edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}
function lineKindChange(){var a=document.getElementById("line_kind"),e=document.getElementById("line_thickness"),b=document.getElementById("line_thickness_updn_btn");""!=a.value?(e.disabled=!0,b.style.display="none","medium"==a.value?e.value="3":"thin"==a.value?e.value="1":"thick"==a.value&&(e.value="5")):(e.disabled=!1,b.style.display="block");edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}
function imgLineKindChange(){var a=document.getElementById("line_kind"),e=document.getElementById("line_thickness"),b=document.getElementById("line_thickness_updn_btn");""!=a.value?(e.disabled=!0,e.value="",b.style.display="none"):(e.disabled=!1,b.style.display="block")}function lineThicknessChange(){var a=document.getElementById("line_thickness");10<a.value&&(a.value=10);edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}
function cellGapChange(){var a=document.getElementById("cell_gap");10<a.value&&(a.value=10);edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function insideMarginChange(){var a=document.getElementById("cell_inside_margin");10<a.value&&(a.value=10);edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function tableEdgeReduceChange(){edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}
function getColorHex(a){return-1<a.indexOf("#")?a:LayerWin.DEXTTOP.DEXT5.util.rgb2hex(a)?LayerWin.DEXTTOP.DEXT5.util.rgb2hex(a):"#000000"}
function setLineStyleEvt(){var a=document.getElementById("ul_line_style");LayerWin.DEXTTOP.DEXT5.util.addEvent(a,"click",function(a){var b=document.getElementById("line_style");a=LayerWin.getClickCell(a,"li").getElementsByTagName("SPAN")[0];b.style.border="";"solid"==a.style.borderTopStyle||"dotted"==a.style.borderTopStyle||"dashed"==a.style.borderTopStyle||"double"==a.style.borderTopStyle||"hidden"==a.style.borderTopStyle||"none"==a.style.borderTopStyle?b.style.borderTop=a.style.borderTop:b.style.border=
a.style.border;fnLineStyleToggle();setCursorPos(document.getElementById("line_style_btn"),!1,!1);lineStyleChange()})}
function setCellBorderModifyValue(a){var e=LayerWin.DEXTTOP.G_SELECTED_ELEMENT;if(a){a=LayerWin.GetTableSelectionCells(e);for(var e=a.length,b=!0,c=0;c<e-1;c++){if(a[c].style.borderTopStyle!=a[c+1].style.borderTopStyle||a[c].style.borderTopWidth!=a[c+1].style.borderTopWidth||a[c].style.borderTopColor!=a[c+1].style.borderTopColor){b=!1;break}if(a[c].style.borderRightStyle!=a[c+1].style.borderRightStyle||a[c].style.borderRightWidth!=a[c+1].style.borderRightWidth||a[c].style.borderRightColor!=a[c+1].style.borderRightColor){b=
!1;break}if(a[c].style.borderBottomStyle!=a[c+1].style.borderBottomStyle||a[c].style.borderBottomWidth!=a[c+1].style.borderBottomWidth||a[c].style.borderBottomColor!=a[c+1].style.borderBottomColor){b=!1;break}if(a[c].style.borderLeftStyle!=a[c+1].style.borderLeftStyle||a[c].style.borderLeftWidth!=a[c+1].style.borderLeftWidth||a[c].style.borderLeftColor!=a[c+1].style.borderLeftColor){b=!1;break}}b?setModifyValue(a[0].style,!0):setModifyValue(null)}else setModifyValue(e.style,!0)}
function setTableBorderModifyValue(a){if("separate"==a.style.borderCollapse)setModifyValue(a.style,!0);else{var e=!0,b=!0,c=!0,d=!0,f,g,h,m;a=LayerWin.getTableBorderCells(a);var k=a.arrTop.length;if(1==k)f=a.arrTop[0].style.borderTop;else for(var n=0;n<k;n++)0!=n&&(a.arrTop[n-1].style.borderTop!=a.arrTop[n].style.borderTop&&(e=!1),n==k-1&&e&&(f=a.arrTop[n].style.borderTop));k=a.arrLeft.length;if(1==k)h=a.arrLeft[0].style.borderLeft;else for(n=0;n<k;n++)0!=n&&(a.arrLeft[n-1].style.borderLeft!=a.arrLeft[n].style.borderLeft&&
(d=!1),n==k-1&&d&&(h=a.arrLeft[n].style.borderLeft));k=a.arrRight.length;if(1==k)m=a.arrRight[0].style.borderRight;else for(n=0;n<k;n++)0!=n&&(a.arrRight[n-1].style.borderRight!=a.arrRight[n].style.borderRight&&(c=!1),n==k-1&&c&&(m=a.arrRight[n].style.borderRight));k=a.arrBottom.length;if(1==k)g=a.arrBottom[0].style.borderBottom;else for(n=0;n<k;n++)0!=n&&(a.arrBottom[n-1].style.borderBottom!=a.arrBottom[n].style.borderBottom&&(b=!1),n==k-1&&b&&(g=a.arrBottom[n].style.borderBottom));a=document.createElement("td");
a.style.borderTop=f?f:"1px solid #000000";a.style.borderBottom=g?g:"1px solid #000000";a.style.borderLeft=h?h:"1px solid #000000";a.style.borderRight=m?m:"1px solid #000000";f=!1;a.style.borderTop==a.style.borderRight&&a.style.borderRight==a.style.borderBottom&&a.style.borderBottom==a.style.borderLeft&&e&&b&&c&&d&&(f=!0);setModifyValue(a.style,f)}}
function setModifyValue(a,e){if(a){var b=e,c,d,f,g;c=a.borderTopWidth;d=a.borderBottomWidth;f=a.borderRightWidth;g=a.borderLeftWidth;c==d&&d==f&&f==g?-1<c.indexOf("px")?document.getElementById("line_thickness").value=parseInt(c,10):document.getElementById("line_kind").value=c:(document.getElementById("line_thickness").value="1",document.getElementById("line_kind").value="");c+=" ";d+=" ";f+=" ";g+=" ";a.borderTopStyle==a.borderRightStyle&&a.borderRightStyle==a.borderLeftStyle&&a.borderLeftStyle==
a.borderBottomStyle?("solid"==a.borderStyle||"dotted"==a.borderStyle||"dashed"==a.borderStyle||"double"==a.borderStyle||"hidden"==a.borderStyle||"none"==a.borderStyle?document.getElementById("line_style").style.borderTopStyle=a.borderStyle:document.getElementById("line_style").style.borderStyle=a.borderStyle,"solid"!=a.borderTopStyle&&"dotted"!=a.borderTopStyle&&"dashed"!=a.borderTopStyle&&"hidden"!=a.borderTopStyle&&"none"!=a.borderTopStyle?(document.getElementById("line_style").style.borderWidth=
"3px","double"==a.borderTopStyle?document.getElementById("line_style").style.borderColor="#5d5d5d":document.getElementById("line_style").style.borderColor="#e1e1e1"):(document.getElementById("line_style").style.borderTopWidth="1px",document.getElementById("line_style").style.borderTopColor="#5d5d5d")):(document.getElementById("line_style").style.borderTopStyle="none",b=!1);c+=a.borderTopStyle+" ";d+=a.borderBottomStyle+" ";f+=a.borderRightStyle+" ";g+=a.borderLeftStyle+" ";var h=getColorHex(a.borderTopColor),
m=getColorHex(a.borderBottomColor),k=getColorHex(a.borderRightColor),n=getColorHex(a.borderLeftColor);h==m&&m==k&&k==n&&(document.getElementById("line_color").style.borderTopColor=h);c+=h;d+=m;f+=k;g+=n;document.getElementById("edge_border").style.borderTop=c;document.getElementById("edge_border").style.borderBottom=d;document.getElementById("edge_border").style.borderRight=f;document.getElementById("edge_border").style.borderLeft=g;b||edgeNoneTotalClick("none")}else document.getElementById("line_style").style.borderTopStyle=
"none",edgeNoneTotalClick("none")}function setLayout(a){a=a.replace("te","");a={num:a};0==LayerWin.DEXTTOP.DEXT5.isEmpty()?1==confirm(LayerWin.dext5_lang.msg.newDocument)&&LayerWin.event_dext_layout(a,window.frameElement.parentNode.parentNode):LayerWin.event_dext_layout(a,window.frameElement.parentNode.parentNode)}
function event_dext_file_upload_completed(a,e){loading_image_show(!1);if(a&&""!=a){a=a.replace(/<.*?script.*\/?>/g,"");a=a.replace(/\r\n/g,"");a=a.replace(/\n/g,"");a=a.replace(/\t/g,"");a=web_url_remove_char(a);try{var b;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?b=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&(b=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,
a));null!=b&&void 0!=b&&(a=b)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{var d;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError?d=DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"fileUpload",message:a,response:e.response}):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&(d=DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,
{type:"fileUpload",message:a,response:e.response}));if(0==d)return}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))b=!0,"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(b=confirm(LayerWin.dext5_lang.msg.uploadFailed)),b&&(b=a.indexOf("HTTP Error"),d=a.indexOf("HTTP Status"),-1<b?alert(a.substring(b,b+16)):-1<d&&alert(a.substring(d,d+15)));else if("[FAIL]"==
a.substring(0,6))b=!0,"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(b=confirm(LayerWin.dext5_lang.msg.uploadFailed)),b&&alert(a);else{b=document.getElementById("file_title").value;var g=document.getElementById("file_text").value;"0"!=LayerWin._dext_editor._config.security.encryptParam&&(g=DEXTTOP.DEXT5.util._fn_$mDRMF(g));d=document.getElementById("input_id").value;var h=document.getElementById("input_class").value;if(""==g)var m=document.getElementById(file_field_id).value,
g=getFileName(m);m=a;if(null!=a&void 0!=a){var k=a.split("?");2==k.length&&(m=k[0],k=k[1].split("^"),1==k.length?m+="?"+k[0]:3==k.length&&(m+="?"+k[2]));""==g&&(g=m.split("/"),g=g[g.length-1])}k=m.substring(m.lastIndexOf(".")+1).toLowerCase();k=k.toLowerCase();LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,m);var n=!1;document.getElementById("continue_insert")&&(n=document.getElementById("continue_insert").checked);b={text:g,url:m,target:"_blank",title:b,type:"hyperlink",type2:"insert_file",file_ext:k,
id:d,className:h,continueInsert:n};elemModify&&"a"==elemModify.tagName.toLowerCase()?(elemModify.innerHTML=b.text,elemModify.title=b.title,elemModify.id=b.id,elemModify.className=b.className,elemModify.href=b.url,"1"==LayerWin._dext_editor._config.attachFileImage&&LayerWin.attachFileImage(elemModify,b),LayerWin._dext_editor.UndoManager.putUndo(),event_dext_close()):(0!=LayerWin._dext_editor._config.maxTotalFileSize&&null!=G_dragDropFileObj&&"0"==LayerWin._dext_editor._config.plugInUse&&(d=LayerWin._dext_editor,
d.addedTotalFileSize+=G_dragDropFileObj[0].size),LayerWin.event_dext_insert_file(b,window.frameElement.parentNode.parentNode))}}
function dext_upload_file(){var a=document.dext_upload_form,e;e=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:G_IeUploadInputFileFlag?document.getElementById(file_field_id):{value:""};var b=e.value;if(0<b.lastIndexOf(".")){var c=b.substring(b.lastIndexOf(".")+1).toLowerCase(),d=document.getElementById("file_text_view").value;"0"!=LayerWin._dext_editor._config.security.encryptParam?
(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util._fn_$mEPF(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(getBoundrayRanNumber()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util._fn_$mEPF(""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),
document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("savafiletext").value=DEXTTOP.DEXT5.util._fn_$mEPF(d),document.getElementById("file_text").value=DEXTTOP.DEXT5.util._fn_$mEPF(d),
document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=getBoundrayRanNumber(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?
LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("savafiletext").value=d,document.getElementById("file_text").value=d,document.getElementById("originalfilename")&&
(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)));loading_image_show(!0);"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",
document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("savafiletext",
document.getElementById("savafiletext").value),a.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&a.setItem("originalfilename",document.getElementById("originalfilename").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(a),uploadAjaxOnprogressStart({uploadType:"insert_file",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:e.id,fileObj:G_dragDropFileObj,
formData:a},event_dext_file_upload_completed)):(a.action=document.getElementById("upload_url").value,a.submit())}else""!=b?alert(LayerWin.dext5_lang.msg.alert_exec):alert(LayerWin.dext5_lang.msg.alert_no_file)}function getFileName(a){var e="";if(a&&0<a.length)return e=a,a=a.split("\\"),0<a.length&&(e=a[a.length-1]),e}function htmlSpecialChars(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;")}
function dext_upload_open_file(){var a=document.dext_upload_form,e=document.getElementById(file_field_id),b=e.value;if(0<b.lastIndexOf(".")&&G_IeUploadInputFileFlag){if(b=b.substring(b.lastIndexOf(".")+1).toLowerCase(),0!=DEXTTOP.DEXT5.isEmpty()||0!=confirm(LayerWin.dext5_lang.msg.newDocument))"1"==LayerWin._dext_editor._config.openDocument.useHtml5FileOpen?(loading_image_show(!0),handleFileSelect(e.files)):(e=DEXTTOP.DEXT5.util.makeGuid().toLowerCase(),"0"!=LayerWin._dext_editor._config.security.encryptParam?
(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util._fn_$mEPF(b),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util._fn_$mEPF(getBoundrayRanNumber()),document.getElementById("savefileguid").value=DEXTTOP.DEXT5.util._fn_$mEPF(e),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util._fn_$mEPF(""==LayerWin._dext_editor._config.toSaveFilePathURL?
LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util._fn_$mEPF(LayerWin._dext_editor._config.saveFileNameRule)):(document.getElementById("savefileext").value=
b,document.getElementById("savefilename").value=getBoundrayRanNumber(),document.getElementById("savefileguid").value=e,document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?
LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule),loading_image_show(!0),a.action=document.getElementById("upload_url").value,a.submit())}else alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_open_file_upload_completed(a){var e=document.getElementById(file_field_id).value;a={fileExt:e.substring(e.lastIndexOf(".")+1).toLowerCase(),data:a};LayerWin.event_dext_insert_open_file(a,window.frameElement.parentNode.parentNode)}function dext_blockquote(){var a={tagvalue:document.getElementById("tempblockquote").value};LayerWin.event_dext_insert_blockquote(a,window.frameElement.parentNode.parentNode)}
function dext_blockquoteCancel(){LayerWin.event_dext_cancel_blockquote(window.frameElement.parentNode.parentNode)}
function dext_setAccessibility(a,e){var b=document.getElementById("input_title").value,c=document.getElementById("input_alt").value,d=document.getElementById("chk_skip").checked,f=document.getElementById("input_id").value,g;e.parentNode.cells[1].getElementsByTagName("span")[2]&&(g=e.parentNode.cells[1].getElementsByTagName("span")[2].innerHTML);var h=!1;""==document.getElementById("id_tr").style.display&&(h=!0);LayerWin.event_dext_setAccessibility({title:b,alt:c,skip:d,id:f,idSamMode:h,sameOrgId:g},
a,e)}
function fileOnchange(a,e){if(!(DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion)||""!=a.value&&null!=a.value){try{var b=LayerWin.DEXTTOP.G_CURREDITOR._FRAMEWIN.G_DEPlugin,c;for(c in b)if("function"===typeof b[c].onFileChange){var d={pageKind:e,file:a,runFlag:!0},f=b[c].onFileChange(d);if(!1===f.runFlag)return;d.file=f.file}}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var h=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo;h.validData={isFile:!1,isDragDropFile:!1,isLastIdx:!1,
fileIdx:0,fileTotalCnt:0,valiedCnt:0,errorFileIdx:[],sizeErrorFile:[],base64CntErrorFile:[],extensionErrorFile:[],detectErrorFile:[],eventReturnFalse:[]};var m="";if(DEXTTOP.DEXT5.browser.HTML5Supported){if(event&event.target&&"Filedata"==event.target.id&&!(a&&a.files&&0<a.files.length))return;var k=a&&a.files&&0<a.files.length,b=G_dragDropFileObj&&0<G_dragDropFileObj.length,n=1==LayerWin.DEXTTOP.G_CURREDITOR._config.insertMultiImage,p=1;if("image"==e||"p_imageslider"==e)p=k?a.files.length:b?G_dragDropFileObj.length:
0;h.isMulti=("image"==e||"p_imageslider"==e)&&n&&1<p;if(!k&&!b){reset_dialog_input_text(document);return}h.validData.isFile=k;h.validData.isDragDropFile=b;h.validData.fileTotalCnt=p;var q=k?a.files:b?G_dragDropFileObj:null;e&&k&&"1"==LayerWin._dext_editor._config.uploadUseHTML5&&(G_dragDropFileObj=a.files);var r=document.getElementById("img_title"),u=document.getElementById("img_alt"),t=document.getElementById("img_id"),z=document.getElementById("img_class"),b=document.getElementById("img_width");
c=document.getElementById("img_height");var y=document.getElementById("continue_insert"),v=document.getElementById("image_spacing"),A=document.getElementById("continue_insert_menu"),d=document.getElementById("original_size"),w=document.getElementById("maintain_value");if("image"==e||"p_imageslider"==e)r&&(r.disabled=!1,r.value=""),u&&(u.disabled=!1,u.value=""),t&&(t.disabled=!1,t.value="",elemModify&&(t.value=elemModify.id)),z&&(z.disabled=!1,z.value="",elemModify&&(z.value=elemModify.className)),
b&&(b.value=""),c&&(c.value=""),d&&(d.checked=!1),y&&(y.parentElement.style.display=""),w&&(w.parentElement.style.display="");"undefined"!==typeof G_validImageFiles&&null!=G_validImageFiles&&(G_validImageFiles=[]);"undefined"!==typeof G_tempTotalFileSizeForMulti&&null!=G_tempTotalFileSizeForMulti&&(G_tempTotalFileSizeForMulti=0);DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.messageType="default";DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currAddedTotalFileSize=0;DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currPassedFiles=
[];DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currFilteredFiles=[]}var C=function(){"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&LayerWin.closeBtnPreViewMode();h.validData.valiedCnt+=1;if(q&&0==h.validData.errorFileIdx.length||0<h.validData.errorFileIdx.length&&h.validData.fileIdx!=h.validData.errorFileIdx[h.validData.errorFileIdx.length-1])m=-1<m.indexOf(",")?
m+(", "+q[h.validData.fileIdx].name):","+q[h.validData.fileIdx].name,"undefined"!==typeof G_validImageFiles&&null!=G_validImageFiles&&G_validImageFiles.push(q[h.validData.fileIdx]);if(n&&h.validData.fileTotalCnt!=h.validData.valiedCnt)h.validData.fileIdx+=1,h.validData.isLastIdx=h.validData.fileIdx==p-1,fileValidation(q[h.validData.fileIdx],e,C);else{loading_image_show(!1);var b=h.validData.valiedCnt-h.validData.errorFileIdx.length;if(0==b&&document.getElementById("drop_zone")){var c=LayerWin.dext5_lang.upload.drop_zone_content;
1==DEXTTOP.DEXT5.browser.mobile&&(c=LayerWin.dext5_lang.upload.drop_zone_content2);document.getElementById("drop_zone").innerHTML=c;if("image"==e||"p_imageslider"==e)c=document.getElementById("drop_zone").children[0],c.style.height="46px",c.style.paddingTop="8px"}if(0<b&&document.getElementById("drop_zone")){c=document.getElementById("drop_zone");if(1<b){c.style.overflowY="scroll";c.style.overflowX="hidden";c.style.position="relative";c.style.border="solid 1px #c5c5c5";for(var d="",f=0;f<G_validImageFiles.length;f++)d+=
'<div class="drop_zone_file_list" style="width: 100%; height: 21px; font-size: 11px; border-bottom: 1px solid #e1e2e2; position: relative; cursor: pointer;"',"p_imageslider"==e&&(d+=' data-index="'+f+'"'),d+='">',d+='<div title="'+G_validImageFiles[f].name+'" style="height: 100%; width: 285px; float: left; font-size: 13px;">',d+='<div style="height: 100%; width: 250px; display: block; float: left; line-height: 1.9; color: rgb(97, 97, 97);overflow:hidden; text-overflow:ellipsis; white-space:nowrap; text-align: left; padding-left:10px;">',
d+=G_validImageFiles[f].name,d+="</div>","1"==LayerWin._dext_editor._config.imgPreView&&(d+="<a href=\"javascript:imgPreView('obj', "+f+')" title="'+LayerWin.dext5_lang.imgPreview.title+'" style="display: block; float: right; line-height: 20px;">',d+='<img id="imgPreview_img_1" src="../images/editor/icon/img_preview.png" alt="img_preview" style = "border:0;"/>',d+="</a>"),d+="</div>",d+="</div>"}else{f=!1;switch(e){case "image":f=!0;break;case "doc_bg_image":f=!0;break;case "hyperlink_image":f=!0;
break;case "table_bg_image":f=!0;break;case "p_table_bg_image":f=!0;break;case "cell_bg_image":f=!0;break;case "p_imageslider":f=!0}"image"==e||"p_imageslider"==e?(c.style.border="solid 1px #c5c5c5",c.style.overflow="auto",d='<div class="drop_zone_file_list" style="width: 100%; height: 100%; font-size: 11px; position: relative; cursor: pointer;"><div style="padding-top: 17px; height: 37px; width: 295px; float: left;">',d+='<div style="font-size: 12px; height: 100%; width: 250px; display: block; float: left; line-height: 1.9; color: rgb(97, 97, 97);overflow:hidden; text-overflow:ellipsis; white-space:nowrap; text-align: left; padding-left:10px;">',
d+=G_validImageFiles[0].name,d+="</div>","1"==LayerWin._dext_editor._config.imgPreView&&(d+='<a href="javascript:imgPreView(\'obj\', 0)" title="'+LayerWin.dext5_lang.imgPreview.title+'" style="display: block; float: right; line-height: 20px;">',d+='<img id="imgPreview_img_1" src="../images/editor/icon/img_preview.png" alt="img_preview" style = "border:0;"/>',d+="</a>")):(c.style.border="solid 1px #c5c5c5",d='<div class="drop_zone_file_list" style="width: 100%; height: 100%; font-size: 11px; position: relative; cursor: pointer;">',
d+='<div style="padding-top: 9px; height: 31px; width: 255px; float: left;">',d+='<div style="font-size: 12px; height: 100%; width: 215px; display: block; float: left; line-height: 1.9; color: rgb(97, 97, 97);overflow:hidden; text-overflow:ellipsis; white-space:nowrap; text-align: left; padding-left:3px;">',d="undefined"!==typeof G_validImageFiles&&null!=G_validImageFiles?d+G_validImageFiles[0].name:d+m.substring(1),d+="</div>","1"==LayerWin._dext_editor._config.imgPreView&&f&&(d+='<a href="javascript:imgPreView(\'obj\', 0)" title="'+
LayerWin.dext5_lang.imgPreview.title+'" style="display: block; float: right; line-height: 20px; padding-right:10px;">',d+='<img id="imgPreview_img_1" src="../images/editor/icon/img_preview.png" alt="img_preview" style = "border:0;"/>',d+="</a>"));d+="</div>";d+="</div>"}c.innerHTML=d;document.getElementById("drop_zone").className="DEXT_fiVe_ED_Popup_DropZoneNoneBackground"}h.isMulti=1<b;"image"!=e&&"p_imageslider"!=e||!h.isMulti?null!=u&&(u.value=LayerWin.getFileName(m.substring(1),!0)):(r.disabled=
!0,u.disabled=!0,t.disabled=!0,z.disabled=!0,y.parentElement.style.display="none",A.style.display="",w.parentElement.style.display="none",v.checked=!1,y.checked=!1);0<h.validData.errorFileIdx.length&&(b=makeErrorContent(),""!=b&&alert(b));h.validData.fileTotalCnt==h.validData.errorFileIdx.length&&(G_dragDropFileObj=null,k&&(a.value=null));try{var g=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_DEPlugin,F;for(F in g)if("function"===typeof g[F].onAfterFileValidation&&!1===g[F].onAfterFileValidation({pageKind:e,
files:G_validImageFiles,runFlag:!0}).runFlag)break}catch(J){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}};loading_image_show(!0);DEXTTOP.DEXT5.browser.HTML5Supported&&"0"!=LayerWin.DEXTTOP.G_CURREDITOR._config.uploadUseHTML5?fileValidation(q[h.validData.fileIdx],e,C):fileValidation(null,e,C,q?q[h.validData.fileIdx]:null)}}
function makeErrorContent(){var a=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.validData,e="",b=LayerWin.dext5_lang.msg.multi_file_validation_error;if(0<a.sizeErrorFile.length)if(1==a.sizeErrorFile.length)e+=a.sizeErrorFile[0].filename+" : "+a.sizeErrorFile[0].content+"\n";else var c=b.replace("{0}",a.sizeErrorFile[0].filename),c=c.replace("{1}",(a.sizeErrorFile.length-1).toString()),e=e+(c+a.sizeErrorFile[0].content+"\n");0<a.base64CntErrorFile.length&&(1==a.base64CntErrorFile.length?e+=a.base64CntErrorFile[0].filename+
" : "+a.base64CntErrorFile[0].content+"\n":(c=b.replace("{0}",a.base64CntErrorFile[0].filename),c=c.replace("{1}",(a.base64CntErrorFile.length-1).toString()),e+=c+a.base64CntErrorFile[0].content+"\n"));0<a.extensionErrorFile.length&&(1==a.extensionErrorFile.length?e+=a.extensionErrorFile[0].filename+" : "+a.extensionErrorFile[0].content+"\n":(c=b.replace("{0}",a.extensionErrorFile[0].filename),c=c.replace("{1}",(a.extensionErrorFile.length-1).toString()),e+=c+a.extensionErrorFile[0].content+"\n"));
0<a.detectErrorFile.length&&(1==a.detectErrorFile.length?e+=a.detectErrorFile[0].filename+" : "+a.detectErrorFile[0].content+"\n":(c=b.replace("{0}",a.detectErrorFile[0].filename),c=c.replace("{1}",(a.detectErrorFile.length-1).toString()),e+=c+a.detectErrorFile[0].content+"\n"));return e}
function fileValidation(a,e,b,c){var d=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.validData,f=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.isMulti,g=a?a:document.getElementById(LayerWin._dext_editor._config.fileFieldID),h=g.value?getFileName(g.value):g.name;if(e&&a&&DEXTTOP.DEXT5.browser.HTML5Supported){var m=!1,k=LayerWin.dext5_lang.msg.max_file_size,n=a.size;("image"==e||"m_image"==e||"cell_bg_image"==e||"doc_bg_image"==e||"hyperlink_image"==e||"input_image"==e||"table_bg_image"==e||"p_table_bg_image"==
e||"p_imageslider"==e)&&0!=LayerWin._dext_editor._config.maxImageFileSize&&n>LayerWin._dext_editor._config.maxImageFileSize?(k=k.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxImageFileSize).toString),m=!0):"media"==e&&0!=LayerWin._dext_editor._config.maxMediaFileSize&&n>LayerWin._dext_editor._config.maxMediaFileSize?(k=k.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxMediaFileSize).toString),m=!0):"flash"==e&&0!=LayerWin._dext_editor._config.maxFlashFileSize&&
n>LayerWin._dext_editor._config.maxFlashFileSize?(k=k.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxFlashFileSize).toString),m=!0):"insert_file"==e&&0!=LayerWin._dext_editor._config.maxInsertFileSize&&n>LayerWin._dext_editor._config.maxInsertFileSize?(k=k.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxInsertFileSize).toString),m=!0):"video_media"==e&&0!=LayerWin._dext_editor._config.maxVideoFileSize&&n>LayerWin._dext_editor._config.maxVideoFileSize&&
(k=k.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxVideoFileSize).toString),m=!0);if(0!=LayerWin._dext_editor._config.maxTotalFileSize&&!m){var p=0;f?(0==G_tempTotalFileSizeForMulti&&(G_tempTotalFileSizeForMulti=LayerWin._dext_editor.addedTotalFileSize),p=G_tempTotalFileSizeForMulti+=n,d.isLastIdx&&(G_tempTotalFileSizeForMulti=0)):p=LayerWin._dext_editor.addedTotalFileSize+n;p>LayerWin._dext_editor._config.maxTotalFileSize?(m=!0,f?(LayerWin._dext_editor.messageInfoForMaxTotalFileSize.messageType=
"multi_img",LayerWin._dext_editor.messageInfoForMaxTotalFileSize.currAddedTotalFileSize=LayerWin._dext_editor.addedTotalFileSize,LayerWin._dext_editor.messageInfoForMaxTotalFileSize.currFilteredFiles.push(a)):(LayerWin._dext_editor.messageInfoForMaxTotalFileSize.currAddedTotalFileSize=p-n,LayerWin._dext_editor.messageInfoForMaxTotalFileSize.currFileSize=n),k=LayerWin.setMessageForMaxTotalFileSize(LayerWin._dext_editor),!d.isLastIdx&&f&&(G_tempTotalFileSizeForMulti-=n)):f&&(LayerWin._dext_editor.messageInfoForMaxTotalFileSize.currAddedTotalFileSize=
LayerWin._dext_editor.addedTotalFileSize,LayerWin._dext_editor.messageInfoForMaxTotalFileSize.currPassedFiles.push(a));d.isLastIdx&&f&&0<d.sizeErrorFile.length&&(d.sizeErrorFile[0].content=LayerWin.setMessageForMaxTotalFileSize(LayerWin._dext_editor))}if(m)return d.errorFileIdx.push(d.fileIdx),errorData={filename:a.name,content:k},d.sizeErrorFile.push(errorData),f||("1"==LayerWin._dext_editor._config.uploadUseHTML5?1==DEXTTOP.DEXT5.browser.mobile?document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content2:
document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content:document.getElementById("image_url").value=""),b()}var m=h.substring(h.lastIndexOf(".")+1).toLowerCase(),k=!1,p=[],q="",r=0;"image"==e||"m_image"==e||"cell_bg_image"==e||"doc_bg_image"==e||"hyperlink_image"==e||"input_image"==e||"table_bg_image"==e||"p_table_bg_image"==e||"p_imageslider"==e?p=LayerWin._dext_editor._config.allowImageFileType:"file_open"==e?p=["htm","html","txt"]:"media"==e?p=LayerWin._dext_editor._config.allowMediaFileType:
"flash"==e?p=LayerWin._dext_editor._config.allowFlashFileType:"video_media"==e?p=LayerWin._dext_editor._config.allowVideoFileType:"insert_file"==e&&(p=LayerWin._dext_editor._config.allowInsertFileType);for(var q=p.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,r=p.length,u=0;u<r;u++)if(m==p[u]){k=!0;break}if(k){DEXTTOP.DEXT5.browser.HTML5Supported||(G_IeUploadInputFileFlag=!0);var t=!1;-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector&&
(m=a.name.split(".").pop(),k=function(){return function(a,b,c){0==c&&(d.errorFileIdx.push(d.fileIdx),errorData={filename:a.name,content:LayerWin.dext5_lang.msg.message_file_ext_detect},d.detectErrorFile.push(errorData),t=!0,f||(reset_dialog_input_text(document),"1"==LayerWin._dext_editor._config.uploadUseHTML5?1==DEXTTOP.DEXT5.browser.mobile?document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content2:document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content:
document.getElementById("image_url").value=""))}}(),D5FileDetector(a,m,k));var z;try{void 0==n&&c&&(n=c.size),c={strFileName:h,nFileSize:void 0!==n?n:0,objFile:null!==a?a:c},"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeAddFile?z=DEXTTOP.G_CURREDITOR._config.event.beforeAddFile(c,e,LayerWin._dext_editor.ID):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_add_file_event&&(z=DEXTTOP.DEXTWIN.dext_editor_before_add_file_event(c,e,LayerWin._dext_editor.ID))}catch(y){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(null!=z&&void 0!=z&&0==z)"image"==e||"p_imageslider"==e?(d.errorFileIdx.push(d.fileIdx),errorData={filename:a.name,content:"eventReturnFalse"},d.eventReturnFalse.push(errorData),setTimeout(function(){b&&b()},50)):(DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion&&"insert_file"==e&&(G_dragDropFileObj=[],G_IeUploadInputFileFlag=!1),document.getElementById(file_field_id).value="",loading_image_show(!1));else{DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion&&
"insert_file"==e&&(G_IeUploadInputFileFlag=!0);g&&(g&&(g.name||g.value)?"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&"insert_file"!=e||void 0==e||(document.getElementById("file_text")&&(document.getElementById("file_text").value=h),document.getElementById("file_text_view")&&(document.getElementById("file_text_view").value=h),document.getElementById("input_text")&&(document.getElementById("input_text").value=h)):"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&"insert_file"==e&&(DEXTTOP.DEXT5.browser.chrome||
DEXTTOP.DEXT5.browser.opera)?document.getElementById("file_text").value="":"1"==LayerWin._dext_editor._config.uploadUseHTML5&&d.isDragDropFile&&(h=a.name,document.getElementById("file_text").value=h,document.getElementById("input_text")&&(document.getElementById("input_text").value=h)));if(("image"==e||"m_image"==e||"p_imageslider"==e)&&"base64"==LayerWin._dext_editor._config.uploadMethod&&null==elemModify&&a&&"-1"!=LayerWin._dext_editor._config.maxImageBase64fileCount&&(LayerWin.getBase64ImageCount()>=
parseInt(LayerWin._dext_editor._config.maxImageBase64fileCount,10)||d&&LayerWin.getBase64ImageCount()+d.fileIdx+1>parseInt(LayerWin._dext_editor._config.maxImageBase64fileCount,10)))return k=LayerWin.dext5_lang.msg.max_base64file_count,k=k.replace("{0}",LayerWin._dext_editor._config.maxImageBase64fileCount),d.errorFileIdx.push(d.fileIdx),errorData={filename:a.name,content:k},d.base64CntErrorFile.push(errorData),f||("1"==LayerWin._dext_editor._config.uploadUseHTML5?1==DEXTTOP.DEXT5.browser.mobile?
document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content2:document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content:document.getElementById("image_url").value=""),b();document.getElementById("image_url")&&(document.getElementById("image_url").value=h);try{if("image"!=e&&"m_image"!=e&&"p_imageslider"!=e||!a||f)-1<e.indexOf("image")&&a&&(v=window.URL||window.webkitURL||window,A=v.createObjectURL(a),w=new Image,w.onload=function(b){G_OriginalMultiImageSize[w.realFileName]=
{width:w.width,height:w.height};LayerWin.DEXTTOP.G_CURREDITOR._FRAMEWIN.validateWidthHeight(LayerWin._dext_editor._config,w.width,w.height)?(b=LayerWin.dext5_lang.msg.alert_exec_iamgesize,0!=LayerWin._dext_editor._config.maxImageWidthSize&&(b+=LayerWin.dext5_lang.msg.alert_width.replace("{0}",LayerWin._dext_editor._config.maxImageWidthSize),b+=" "),0!=LayerWin._dext_editor._config.maxImageHeightSize&&(b+=LayerWin.dext5_lang.msg.alert_height.replace("{0}",LayerWin._dext_editor._config.maxImageHeightSize)),
d.errorFileIdx.push(d.fileIdx),errorData={filename:a.name,content:b},d.sizeErrorFile.push(errorData)):(w=null,w=void 0)},w.src=A,w.realFileName=a.name);else{var v=window.URL||window.webkitURL||window,A=v.createObjectURL(a),w=new Image;w.onload=function(){if(t)document.getElementById("img_width")&&(document.getElementById("img_width").value=""),document.getElementById("img_height")&&(document.getElementById("img_height").value="");else{try{(window.URL||window.webkitURL||window).revokeObjectURL(this.src)}catch(b){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(LayerWin.DEXTTOP.G_CURREDITOR._FRAMEWIN.validateWidthHeight(LayerWin._dext_editor._config,w.width,w.height)){var c=LayerWin.dext5_lang.msg.alert_exec_iamgesize;0!=LayerWin._dext_editor._config.maxImageWidthSize&&(c+=LayerWin.dext5_lang.msg.alert_width.replace("{0}",LayerWin._dext_editor._config.maxImageWidthSize),c+=" ");0!=LayerWin._dext_editor._config.maxImageHeightSize&&(c+=LayerWin.dext5_lang.msg.alert_height.replace("{0}",LayerWin._dext_editor._config.maxImageHeightSize));
d.errorFileIdx.push(d.fileIdx);errorData={filename:a.name,content:c};d.sizeErrorFile.push(errorData)}else{var c=document.getElementById("img_width_unit"),e=document.getElementById("img_height_unit"),f=!1;c&&"%"==c.value&&(f=!0);if(f){e.value="%";document.getElementById("img_height").disabled=!0;c=w.width;f=w.height;document.getElementById("original_image_width").value=c;document.getElementById("original_image_height").value=f;var e=LayerWin._dext_editor._config.imgDefaultWidth,f=DEXTTOP.DEXT5.util.parseIntOr0(e),
g=DEXTTOP.DEXT5.util.getEditSpacePx(DEXTTOP.G_CURREDITOR),c=Math.round(c/g*1E4)/100;-1<e.indexOf("%")&&0!=f&&f<c&&(c=f);document.getElementById("img_width").value=c}else if(e.value="px",c=w.width,f=w.height,document.getElementById("original_image_width").value=c,document.getElementById("original_image_height").value=f,g=e="",0>LayerWin._dext_editor._config.imgDefaultWidth.indexOf("%")&&(e=LayerWin._dext_editor._config.imgDefaultWidth,g=LayerWin._dext_editor._config.imgDefaultHeight),""!=e?DEXTTOP.DEXT5.util.parseIntOr0(c)>
DEXTTOP.DEXT5.util.parseIntOr0(e)&&(c=DEXTTOP.DEXT5.util.parseIntOr0(f,10)*DEXTTOP.DEXT5.util.parseIntOr0(e,10)/DEXTTOP.DEXT5.util.parseIntOr0(c,10),f=isNaN(c)?f:Math.round(c),c=DEXTTOP.DEXT5.util.parseIntOr0(e)):""!=g&&DEXTTOP.DEXT5.util.parseIntOr0(f)>DEXTTOP.DEXT5.util.parseIntOr0(g)&&(e=DEXTTOP.DEXT5.util.parseIntOr0(c,10)*DEXTTOP.DEXT5.util.parseIntOr0(g,10)/DEXTTOP.DEXT5.util.parseIntOr0(f,10),c=isNaN(e)?c:Math.round(e),f=DEXTTOP.DEXT5.util.parseIntOr0(g)),document.getElementById("img_width").value=
c,document.getElementById("img_height").value=f,e=document.getElementById("img_ratio"))"true"!=e.getAttribute("ratio-checked")&&e.click(),DEXTTOP.DEXT5.browser.mobile?(e.style.display="none",document.getElementById("img_ratio_view").style.display=""):e.style.display="",addEventImgWidthHeight(c,f);(c=document.getElementById("original_size"))&&(c.checked||"1"==LayerWin._dext_editor._config.keepImageOriginalSizeAutoCheck)&&(c.checked=!0,document.getElementById("img_width").disabled=!0,document.getElementById("img_height").disabled=
!0,document.getElementById("img_width_unit").disabled=!0,document.getElementById("img_height_unit").disabled=!0);w=null;w=void 0}}};w.src=A}}catch(C){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}setTimeout(function(){b&&b()},50)}}else{DEXTTOP.DEXT5.browser.HTML5Supported||(g=null,G_IeUploadInputFileFlag=!1);d.errorFileIdx.push(d.fileIdx);errorData={filename:h,content:q};d.extensionErrorFile.push(errorData);if(b)return b();loading_image_show(!1)}}
function set_page_table_lock_property(){DEXTTOP.DEXT5.util.addEvent(document.getElementById("ok_btn"),"click",function(){applyTableLockProperty()});var a=LayerWin.GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table",!0);if(a){var e=LayerWin.checkLockAttr(a,!0),b=document.getElementsByName("table_lock");e?(b[0].checked=!0,b[1].checked=!1):(b[0].checked=!1,b[1].checked=!0);a.getAttribute("lock_mode")&&(c=a.getAttribute("lock_mode"));e=document.getElementsByName("lock_mode");"1"==c?(e[0].checked=!0,
e[1].checked=!1):(e[0].checked=!1,e[1].checked=!0);var c=DEXTTOP.G_CURREDITOR._config.defaultTableLockMode;a.getAttribute("lock_mode")&&(c=a.getAttribute("lock_mode"));e=document.getElementsByName("lock_mode");"1"==c?(e[0].checked=!0,e[1].checked=!1):(e[0].checked=!1,e[1].checked=!0);c=DEXTTOP.G_CURREDITOR._config.defaultShowLockIconUserMode;a.getAttribute("show_icon")&&(c=a.getAttribute("show_icon"));a=document.getElementsByName("lock_icon_option");"0"==c?(a[1].checked=!0,a[0].checked=!1):(a[1].checked=
!1,a[0].checked=!0)}}
function applyTableLockProperty(){var a=LayerWin.GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table",!0);a&&(document.getElementsByName("table_lock")[0].checked?(LayerWin.setClassName(a,"DEXT_five_table_lock"),a.setAttribute(DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultLockName,""),document.getElementsByName("lock_mode")[0].checked?a.setAttribute("lock_mode","1"):a.setAttribute("lock_mode","2"),document.getElementsByName("lock_icon_option")[0].checked?a.setAttribute("show_icon","1"):a.setAttribute("show_icon",
"0")):(LayerWin.removeLockAttr(a),LayerWin.removeClassName(a,"DEXT_five_table_lock"),a.removeAttribute("lock_mode"),a.removeAttribute("show_icon")),a=LayerWin.getFirstRange().range.startContainer,3==a.nodeType&&(a=a.parentNode),a&&1==a.nodeType&&LayerWin.setMenuIconRealable(a));event_dext_close()}
function setBorderListValue(a,e){switch(a){case "none":e.style.borderTopStyle="none";break;case "solid":e.style.borderTop="1px solid rgb(93, 93, 93)";break;case "dotted":e.style.borderTop="1px dotted rgb(93, 93, 93)";break;case "dashed":e.style.borderTop="1px dashed rgb(93, 93, 93)";break;case "double":e.style.border="3px double rgb(93, 93, 93)";break;case "groove":e.style.border="3px groove rgb(225, 225, 225)";break;case "ridge":e.style.border="3px ridge rgb(225, 225, 225)";break;case "inset":e.style.border=
"3px inset rgb(225, 225, 225)";break;case "outset":e.style.border="3px outset rgb(225, 225, 225)"}}
function paste_to_image_loaded_event(){var a=LayerWin._dext_editor._config.style.skinName;document.getElementById("dext_dialog_box").className="DEXT_fiVe_ED_Popup_Type06 DEXT_fiVe_PUi_"+a;if("0"==LayerWin._dext_editor._config.pasteToImagePopupMode){for(var e=document.querySelectorAll(".con_right"),b=e.length,a=0;a<b;a++)if(e[a].className=e[a].className.replace("con_right","con_left"),e[a].style.width="500px",0==a){e[a].parentNode.style.height="270px";var c=e[a].querySelector("dd");c.style.width="496px";
c.style.height="170px";c=e[a].querySelector("canvas");c.width="496";c.height="170"}a=document.querySelectorAll("fieldset");a[0].style.display="none";a[1].style.display="none";document.querySelector("#setting_img_format").style.marginTop="55px";e=a[2].querySelectorAll("li");b=["22%","22%","30%","20%"];c=e.length;for(a=0;a<c;a++)e[a].style.display="inline-block",e[a].style.width=b[a]}for(var e=c=!1,b="",d=document.getElementById("formatList"),a=0;a<DEXTTOP.G_CURREDITOR._config.pasteToImageType.length;a++)0==
a&&(b=DEXTTOP.G_CURREDITOR._config.pasteToImageType[a].toLowerCase()),"png"==DEXTTOP.G_CURREDITOR._config.pasteToImageType[a].toLowerCase()?(d.innerHTML+='<li class="Li" style="width:100%;"><input id="image_type_png" name="image_type" type="radio" value="png" /><label for="image_type_png">PNG</label></li>',c=!0):"jpg"==DEXTTOP.G_CURREDITOR._config.pasteToImageType[a].toLowerCase()&&(d.innerHTML+='<li class="Li"><input id="image_type_jpg" name="image_type" type="radio" value="jpg"/><label for="image_type_jpg" style="vertical-align:middle;">JPG</label></li><li class="Li" style = "position:relative;"><label for="image_quality" id="label_quality"></label><div class="no_a" style="position:absolute; right:0; top:0"><input class="con_input" id="image_quality" style="width: 30px; vertical-align:middle;" type="text" /><ul style="vertical-align:middle;"><li id="quality_spinUp"><a style="cursor: pointer; margin:0; padding:0; border:none;" href="javascript:void(0);"><img src="../images/editor/dialog/btn/editor_ta_btn.gif" width="15" height="10" style="margin:0; padding:0;" /></a></li><li id="quality_spinDown"><a style="cursor: pointer;  margin:0; padding:0; border:none;" href="javascript:void(0);"><img src="../images/editor/dialog/btn/editor_ba_btn.gif" width="15" height="10" style="margin:0; padding:0;" /></a></li></ul></div></li>',
e=!0);"Windows"==DEXTTOP.DEXT5.UserAgent.os.name&&e&&c?"png"==b?(imageType="png",document.getElementById("image_type_png").checked=!0):(imageType="jpeg",document.getElementById("image_type_jpg").checked=!0):"Windows"!=DEXTTOP.DEXT5.UserAgent.os.name||!e&&c?(imageType="png",document.getElementById("image_type_png").checked=!0,e&&(document.getElementById("image_type_jpg").parentNode.style.display="none",document.getElementById("label_quality").parentNode.style.display="none")):e&&!c&&(imageType="jpeg",
document.getElementById("image_type_jpg").checked=!0);var c=document.getElementById("html_btn"),f=document.getElementById("image_width"),g=document.getElementById("image_height"),h=document.getElementById("image_quality");document.getElementById("span_title").innerHTML=LayerWin.dext5_lang.paste_to_image.title;document.getElementById("span_save_client").innerHTML=LayerWin.dext5_lang.paste_to_image.save_client;document.getElementById("legent_format").innerHTML=LayerWin.dext5_lang.paste_to_image.format;
e&&(document.getElementById("label_quality").innerHTML=LayerWin.dext5_lang.paste_to_image.quality);document.getElementById("rotate").innerHTML=LayerWin.dext5_lang.paste_to_image.rotate;document.getElementById("size").innerHTML=LayerWin.dext5_lang.paste_to_image.size;document.getElementById("label_width").innerHTML=LayerWin.dext5_lang.paste_to_image.width;document.getElementById("label_height").innerHTML=LayerWin.dext5_lang.paste_to_image.height;document.getElementById("lock_size_rate").innerHTML=
LayerWin.dext5_lang.paste_to_image.lock_size_rate;document.getElementById("span_origin_size").innerHTML=LayerWin.dext5_lang.paste_to_image.origin_size;document.getElementById("dt_preview").innerHTML=LayerWin.dext5_lang.paste_to_image.preview;document.getElementById("label_lock_size_rate").innerHTML=LayerWin.dext5_lang.paste_to_image.lock_size_rate;document.getElementById("label_lock_origin_size").innerHTML=LayerWin.dext5_lang.paste_to_image.lock_origin_size;""!=LayerWin._dext_editor._config.buttonText001?
document.getElementById("span_insert_image").innerHTML=LayerWin._dext_editor._config.buttonText001:document.getElementById("span_insert_image").innerHTML=LayerWin.dext5_lang.paste_to_image.insert_image;document.getElementById("span_insert_html").innerHTML=LayerWin.dext5_lang.paste_to_image.insert_html;DEXTTOP.DEXT5.util.addEvent(h,"keydown",LayerWin.onlyNumber);DEXTTOP.DEXT5.util.addEvent(h,"blur",function(){100<DEXTTOP.DEXT5.util.parseIntOr0(h.value)?h.value="100":0==DEXTTOP.DEXT5.util.parseIntOr0(h.value)&&
(h.value="1")});DEXTTOP.DEXT5.util.addEvent(f,"keydown",LayerWin.onlyNumber);DEXTTOP.DEXT5.util.addEvent(g,"keydown",LayerWin.onlyNumber);DEXTTOP.DEXT5.util.addEvent(f,"keyup",function(){if(1==document.getElementById("lock_size_rate").checked){var a=parseInt(u,10)*parseInt(f.value,10)/parseInt(r,10);g.value=isNaN(a)?g.value:Math.round(a)}});DEXTTOP.DEXT5.util.addEvent(g,"keyup",function(){if(1==document.getElementById("lock_size_rate").checked){var a=parseInt(r,10)*parseInt(g.value,10)/parseInt(u,
10);f.value=isNaN(a)?f.value:Math.round(a)}});DEXTTOP.DEXT5.util.addEvent(document.getElementById("span_origin_size").parentNode,"click",function(){f.value=r;g.value=u});DEXTTOP.DEXT5.util.addEvent(document.getElementById("lock_origin_size"),"click",function(){document.getElementById("lock_origin_size").checked?(f.value=parseInt(document.getElementById("original_img_width").value,10),g.value=parseInt(document.getElementById("original_img_height").value,10),f.disabled=!0,g.disabled=!0):(f.disabled=
!1,g.disabled=!1)});DEXTTOP.DEXT5.util.addEvent(document.getElementById("quality_spinUp"),"click",function(){0==h.disabled&&LayerWin.click_plus_func(document.getElementById("image_quality"),100,10)});DEXTTOP.DEXT5.util.addEvent(document.getElementById("quality_spinDown"),"click",function(){0==h.disabled&&LayerWin.click_minus_func(document.getElementById("image_quality"),1,10)});var m=document.getElementById("canvas_preview"),k=m.getContext("2d"),n=DEXTTOP.G_CURREDITOR.clipImageBeforePopup,p,q,r,u,
t=0,z=0,y=1,v={type:"",width:0,height:0,checkOriginSize:!1};0==DEXTTOP.G_CURREDITOR.bTextorHtmlData&&(document.getElementById("html_btn").style.display="none",c=document.getElementById("image_btn"));DEXTTOP.DEXT5.util.addEvent(document.getElementById("image_btn"),"click",function(){if("1"==DEXTTOP.G_CURREDITOR._config.pasteToImagePopupMode){var a=document.getElementById("image_type_jpg"),b=document.getElementById("image_type_png");a&&a.checked&&(imageType="jpeg");b&&b.checked&&(imageType="png")}for(var a=
0,b=document.getElementsByName("image_rotate"),c=b.length,d=0;d<c;d++)if(b[d].checked){a=DEXTTOP.DEXT5.util.parseIntOr0(b[d].value);break}var e=1;"jpeg"==imageType&&0==h.disabled&&(e=1*DEXTTOP.DEXT5.util.parseIntOr0(h.value)/100);1>DEXTTOP.G_CURREDITOR._config.imageQuality.quality&&(b=LayerWin.imageQualityBool(DEXTTOP.G_CURREDITOR.clipImageBlob.size,DEXTTOP.DEXT5.util.getExtensionFromFileName(DEXTTOP.G_CURREDITOR.clipImageBlob.name)),e>DEXTTOP.G_CURREDITOR._config.imageQuality.quality&&b&&(e=DEXTTOP.G_CURREDITOR._config.imageQuality.quality));
var p=function(a,b){var c=DEXTTOP.G_CURREDITOR.clipImageBlob;a&&(c=a);LayerWin.G_QualityFileObj=[];if(c){var e=DEXTTOP.G_CURREDITOR.clipImageBlob.name,f=DEXTTOP.DEXT5.util.getExtensionFromFileName(e),g=LayerWin.imageQualityBool(c.size,f);LayerWin.G_QualityFileObj.push({fileObj:c,originalExtension:f,originalFileName:e,idx:d,changeBool:g});DEXTTOP.DEXT5.browser.WorkerSupported&&"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?LayerWin.changeImageQuality(b):LayerWin.changeImageQualityWithoutWorker(b);
var h=setInterval(function(){if(LayerWin.G_CompleteImageQuality){var a=LayerWin.G_QualityFileObj[0].fileObj;clearInterval(h);LayerWin.G_QualityFileObj=[];LayerWin.G_changeCount=0;LayerWin.G_CompleteImageQuality=!1;q(a)}},300)}else q()},q=function(a){a&&(DEXTTOP.G_CURREDITOR.clipImageBlob=a);v.type="image";-1<f.value.indexOf("%")?(v.width=f.value,v.height=0):(v.width=DEXTTOP.DEXT5.util.parseIntOr0(f.value),v.height=DEXTTOP.DEXT5.util.parseIntOr0(g.value));v.checkOriginSize=document.getElementById("lock_origin_size").checked;
a=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("original_img_width").value);var b=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("original_img_height").value);v.checkOriginSize&&(v.width=a,v.height=b);LayerWin.command_pasteToImage(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,v);n=void 0;event_dext_close()},b=DEXTTOP.G_CURREDITOR.clipImageBlob.type.replace("image/","");0==a&&1==e&&imageType==b||"0"==DEXTTOP.G_CURREDITOR._config.pasteToImagePopupMode?1>DEXTTOP.G_CURREDITOR._config.imageQuality.quality&&
"0"==DEXTTOP.G_CURREDITOR._config.plugInUse?p():q():(m.style.display="none",90==a||270==a?(b=n.height,c=n.width):(b=n.width,c=n.height),m.width=b,m.height=c,k.save(),"png"!=imageType&&(k.fillStyle="white",k.fillRect(0,0,m.width,m.height)),k.translate(m.width/2,m.height/2),k.rotate(a*Math.PI/180),"png"==imageType&&k.clearRect(0,0,m.width,m.height),k.drawImage(n,-n.width/2,-n.height/2,n.width,n.height),k.restore(),m.toBlob(function(a){try{var b=DEXTTOP.G_CURREDITOR.clipImageBlob.name,c=DEXTTOP.G_CURREDITOR.clipImageBlob.name.lastIndexOf("."),
b=b.substring(0,c);a.name=b+"."+imageType;1>DEXTTOP.G_CURREDITOR._config.imageQuality.quality&&"0"==DEXTTOP.G_CURREDITOR._config.plugInUse?p(a,e):q(a)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},"image/"+imageType,e))});DEXTTOP.DEXT5.util.addEvent(document.getElementById("html_btn"),"click",function(){v.type="html";LayerWin.command_pasteToImage(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,v);n=void 0;event_dext_close();DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode&&LayerWin.DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.paste_table)});for(var A=document.getElementsByName("image_rotate"),w=A.length,a=0;a<w;a++)d=function(a){return function(b){b=DEXTTOP.DEXT5.util.parseIntOr0(A[a].value);k.save();k.clearRect(0,0,m.width,m.height);k.translate(m.width/2,m.height/2);k.rotate(b*Math.PI/180);k.drawImage(n,-p/2,-q/2,p,q);k.restore();var c;90==b||270==b?(b=n.height,c=n.width,r=n.height,u=n.width):(b=n.width,c=n.height,r=n.width,u=n.height);document.getElementById("original_img_width").value=
r;document.getElementById("original_img_height").value=u;0>document.getElementById("image_width").value.indexOf("%")&&(f.value=b,g.value=c)}}(a),DEXTTOP.DEXT5.util.addEvent(A[a],"click",d);for(var C=document.getElementsByName("image_type"),w=C.length,a=0;a<w;a++)d=function(a){return function(b){b=C[a].value;"jpg"==b?(imageType="jpeg",h.disabled=!1):(imageType=b,h.disabled=!0)}}(a),DEXTTOP.DEXT5.util.addEvent(C[a],"click",d);e&&(h.value="100");"jpg"==b?(setCursorPos(document.getElementById("image_type_jpg"),
!1,!1),LayerWin.setFocusFirstAndLast(document,document.getElementById("image_type_jpg"),c)):(setCursorPos(document.getElementById("image_type_png"),!1,!1),LayerWin.setFocusFirstAndLast(document,document.getElementById("image_type_png"),c));(function(){DEXTTOP.G_CURREDITOR=LayerWin._dext_editor;r=n.width;u=n.height;document.getElementById("original_img_width").value=n.width;document.getElementById("original_img_height").value=n.height;var a="",b="";0>LayerWin._dext_editor._config.imgDefaultWidth.indexOf("%")?
(a=LayerWin._dext_editor._config.imgDefaultWidth,b=LayerWin._dext_editor._config.imgDefaultHeight):a=LayerWin._dext_editor._config.imgDefaultWidth;if(""!=a)if(-1<a.indexOf("%")){var c=DEXTTOP.DEXT5.util.getEditSpacePx(DEXTTOP.G_CURREDITOR),b=DEXTTOP.DEXT5.util.parseIntOr0(a),c=Math.round(r/c*1E4)/100;r=0!=b&&b<c?a:c+"%";u="";document.getElementById("lock_size_rate").checked=!1}else DEXTTOP.DEXT5.util.parseIntOr0(r)>DEXTTOP.DEXT5.util.parseIntOr0(a)&&(b=DEXTTOP.DEXT5.util.parseIntOr0(u,10)*DEXTTOP.DEXT5.util.parseIntOr0(a,
10)/DEXTTOP.DEXT5.util.parseIntOr0(r,10),u=isNaN(b)?u:Math.round(b),r=DEXTTOP.DEXT5.util.parseIntOr0(a));else""!=b&&DEXTTOP.DEXT5.util.parseIntOr0(u)>DEXTTOP.DEXT5.util.parseIntOr0(b)&&(a=DEXTTOP.DEXT5.util.parseIntOr0(r,10)*DEXTTOP.DEXT5.util.parseIntOr0(b,10)/DEXTTOP.DEXT5.util.parseIntOr0(u,10),r=isNaN(a)?r:Math.round(a),u=DEXTTOP.DEXT5.util.parseIntOr0(b));f.value=r;g.value=u;y=Math.min(m.width/n.width,m.height/n.height);1>y?(p=Math.round(n.width*y),q=Math.round(n.height*y)):(p=n.width,q=n.height,
y=1);p<m.width&&(t=(m.width-p)/2);q<m.height&&(z=(m.height-q)/2);k.drawImage(n,t,z,p,q)})()}function dext_create_conversion(){var a={text:document.getElementById("targetContent").value};LayerWin.event_dext_create_conversion(a,window.frameElement.parentNode.parentNode)}function dext_calculator(){var a=document.getElementById("valueText");LayerWin.event_dext_calculator(a.value,window.frameElement.parentNode.parentNode)}
function dext_insert_placeholder(){var a={notice:""};a.notice=document.getElementById("input_notice").value;LayerWin.event_dext_insert_placeholder(a,window.frameElement.parentNode.parentNode)}function dext_load_auto_save_open(a,e,b){return LayerWin.event_dext_load_auto_save_open(a,e,b)}function dext_load_auto_save(){LayerWin.event_dext_load_auto_save(g_currHtml,window.frameElement.parentNode.parentNode)}
function dext_load_auto_save_del(a,e,b,c){a="dext_"+a;""!=e&&(a+="_"+e);LayerWin.event_dext_load_auto_save_del(a,b,window.frameElement.parentNode.parentNode,c)}
function dext_load_auto_save_setDateList(){var a=dext_load_auto_save_open(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._config.setAutoSave.unique_key,DEXTTOP.G_CURREDITOR._config.setAutoSave.maxCount);if(null!=a&&void 0!=a&&0<a.length)for(var e=document.getElementById("ul_date"),b=a.length-1;0<=b;b--){var c=document.createElement("li");c.style.cursor="pointer";var d=document.createElement("span");d.className="icon";var f=document.createElement("img");f.src="../images/bg/editor_popup_close_bg.gif";
f.width="10";f.height="10";f.style.cursor="pointer";d.appendChild(f);var g=document.createElement("span");g.className="text";var f=a[b].date.split(" "),h=f[0].split("/");g.innerHTML=h[2]+"/"+h[0]+"/"+h[1]+" "+f[1];f=document.createElement("a");f.appendChild(g);f.href="javascript:void(0)";f.style.textDecoration="none";f.className="a_data_width";g=document.createElement("a");g.appendChild(d);g.href="javascript:void(0)";g.style.textDecoration="none";7==DEXTTOP.DEXT5.browser.ieVersion&&(c.style.width=
"100%");c.appendChild(f);c.appendChild(g);e.appendChild(c);d=function(b){return function(c){dext_load_auto_save_click_date(b,a);DEXTTOP.DEXT5.util.stopEvent(c)}}(b);DEXTTOP.DEXT5.util.addEvent(c,"click",d);DEXTTOP.DEXT5.util.addEvent(f,"focus",d);c=function(a){return function(a){13==("which"in a?a.which:a.keyCode)&&(DEXTTOP.DEXT5.util.cancelEvent(a),dext_load_auto_save())}}(f);DEXTTOP.DEXT5.util.addEvent(f,"keydown",c);"cssFloat"in f.style?f.style.cssFloat="left":f.style.styleFloat="left";"cssFloat"in
g.style?g.style.cssFloat="right":g.style.styleFloat="right";g.style.marginRight="5px";c=function(b){return function(c){dext_load_auto_save_click_date(b,a);dext_load_auto_save_click_del(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._config.setAutoSave.unique_key,b,DEXTTOP.G_CURREDITOR._config.setAutoSave.maxCount);DEXTTOP.DEXT5.util.stopEvent(c)}}(b);DEXTTOP.DEXT5.util.addEvent(g,"click",c);setCursorPos(document.getElementById("ul_date").getElementsByTagName("a")[0],!1,!1);LayerWin.setFocusFirstAndLast(document,
document.getElementById("ul_date").getElementsByTagName("a")[0])}else dext_load_auto_save_setHtml("<html><head></head><body></body></html>")}
function dext_load_auto_save_click_date(a,e){for(var b=document.getElementById("ul_date"),c=b.getElementsByTagName("li").length-1,d=c;0<=d;d--){var f=c-d;d==a?b.getElementsByTagName("li")[f].style.backgroundColor="#dff1ff":b.getElementsByTagName("li")[f].style.backgroundColor="#ffffff";b.getElementsByTagName("li")[f].getElementsByTagName("img")[0].src="../images/bg/editor_popup_close_bg.gif"}0<b.getElementsByTagName("li").length&&dext_load_auto_save_setHtml(e[a].html)}
function dext_load_auto_save_setHtml(a){var e=document.getElementById("content_frame").contentWindow.document;g_currHtml=a;"1"==DEXTTOP.G_CURREDITOR._config.enforceDoctype&&(g_currHtml=g_currHtml.replace(/<!doctype *([^>?+])*>/gi,""));a=LayerWin.getRemoveHeadScript(g_currHtml);g_currHtml=a.html;e.open("text/html","replace");LayerWin.isCustomDomain(LayerWin.document)&&(e.domain=LayerWin.document.domain);e.write(g_currHtml);e.close();LayerWin.setHeadScriptSrc(e,a.scriptsAry);a=Math.max(e.body.scrollWidth,
e.body.offsetWidth,e.documentElement.clientWidth,e.documentElement.scrollWidth,e.documentElement.offsetWidth);var b=Math.max(e.body.scrollHeight,e.body.offsetHeight,e.documentElement.clientHeight,e.documentElement.scrollHeight,e.documentElement.offsetHeight),c=document.getElementById("content_frame").parentNode,d=LayerWin.getClientRect(c),c=d.right-d.left,d=d.bottom-d.top,f=!0;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(f=!1);a>c?f&&(e.body.style.overflowX="scroll"):f&&(e.body.style.overflowX=
"hidden");b>d?f&&(e.body.style.overflowY="scroll"):f&&(e.body.style.overflowY="hidden");DEXTTOP.DEXT5.util.addEvent(e,"contextmenu",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});e.body.contentEditable=!1;"1"==LayerWin.DEXTTOP.G_CURREDITOR._config.diagonal.use&&LayerWin.G_DEXT_Diagonal&&LayerWin.findDiagonal(e.body)&&LayerWin.G_DEXT_Diagonal.setResizeForDiagonal(null,e.body)}
function dext_load_auto_save_click_del(a,e,b,c){var d=document.getElementById("ul_date");if(confirm(LayerWin.dext5_lang.loadAutoSave.delMsg)){for(dext_load_auto_save_del(a,e,b,c);d.hasChildNodes();)d.removeChild(d.firstChild);dext_load_auto_save_setDateList()}}
function dext_paragraph_attribute(){var a=document.getElementById("p_margin_left"),e=document.getElementById("p_margin_right"),b=document.getElementById("p_margin_top"),c=document.getElementById("p_margin_bottom"),d=document.getElementById("p_letter_spacing"),f=document.getElementById("p_word_spacing"),g=document.getElementById("p_text_indent"),h=document.getElementById("p_font_size"),m=document.getElementById("font_family_select"),k=document.getElementById("p_font_size_type"),n,p,q,r,u;"[object Array]"===
Object.prototype.toString.call(DEXTTOP.G_CURREDITOR._config.paragraphAttributeType)?(p_text_indent_type=document.getElementById("p_text_indent_type"),p_margin_left_type=document.getElementById("p_margin_left_type"),p_margin_right_type=document.getElementById("p_margin_right_type"),p_margin_top_type=document.getElementById("p_margin_top_type"),p_margin_bottom_type=document.getElementById("p_margin_bottom_type"),n=p_text_indent_type[p_text_indent_type.options.selectedIndex].value,p=p_margin_left_type[p_margin_left_type.options.selectedIndex].value,
q=p_margin_right_type[p_margin_right_type.options.selectedIndex].value,r=p_margin_top_type[p_margin_top_type.options.selectedIndex].value,u=p_margin_bottom_type[p_margin_bottom_type.options.selectedIndex].value):u=r=q=p=n=DEXTTOP.G_CURREDITOR._config.paragraphAttributeType;LayerWin.event_dext_paragraph_attribute({marginLeft:a.value,marginRight:e.value,marginTop:b.value,marginBottom:c.value,letterSpacing:d.value,wordSpacing:f.value,textIndent:g.value,fontSize:h.value,fontFamily:m.value,fontType:k.value,
textIndentType:n,marginLeftType:p,marginRightType:q,marginTopType:r,marginBottomType:u},window.frameElement.parentNode.parentNode)}function dext_paste_table(){for(var a="",e=document.getElementsByName("radio_select"),b=e.length,c=0;c<b;c++)if(1==e[c].checked){a=e[c].value;break}LayerWin.event_dext_paste_table({type:a},window.frameElement.parentNode.parentNode)}
function set_paste_table_button(){for(var a=DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode,e=0,b=0,e=a.rows.length,c=0;c<e;c++){var d=a.rows[c].cells.length;b<d&&(b=d)}for(var f=DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode,g=a=0,a=f.rows.length,c=0;c<a;c++)d=f.rows[c].cells.length,g<d&&(g=d);c=DEXTTOP.G_SELECTED_ELEMENT;f=d=0;try{c&&c.tagName&&"TD"==c.tagName&&(d=c.parentNode.rowIndex,f=c.cellIndex+(c.colSpan-1)+(c.rowSpan-1))}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(a<
e+d||g<b+f)document.getElementById("radio_2").setAttribute("disabled","disabled"),document.getElementById("radio_7").setAttribute("disabled","disabled"),document.getElementById("radio_8").setAttribute("disabled","disabled");a==e&&(document.getElementById("radio_3").removeAttribute("disabled"),document.getElementById("radio_4").removeAttribute("disabled"));g==b&&(document.getElementById("radio_5").removeAttribute("disabled"),document.getElementById("radio_6").removeAttribute("disabled"))}
DEXTTOP.DEXT5.util.addEvent(window,"dragover",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});DEXTTOP.DEXT5.util.addEvent(document,"dragover",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});DEXTTOP.DEXT5.util.addEvent(window,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});DEXTTOP.DEXT5.util.addEvent(document,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});"undefined"==typeof useContextmenu&&DEXTTOP.DEXT5.util.addEvent(document,"contextmenu",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});
function dext5plugin_action(a){LayerWin.event_dext5plugin_action(a,window.frameElement.parentNode.parentNode)}function setInputBoxWidth(a,e){e=DEXTTOP.DEXT5.util.parseIntOr0(e);a.style.width=DEXTTOP.DEXT5.browser.mobile?DEXTTOP.DEXT5.browser.safari?e-10+"px":e+"px":e+"px"}
function dext_spellcheck_set_popup(a,e){if(0==a.length)return!1;try{for(var b=LayerWin.rangy.createRange(document.getElementById("copycontent").contentDocument),c=0;c<a.length;c++)if(b.findText(a[c].word)){b.deleteContents();var d=document.createElement("span");d.setAttribute("id","cnt"+c);d.setAttribute("class","cnt");d.setAttribute("onmouseover","parent.wrong_word_over(this)");d.setAttribute("onmouseout","parent.wrong_word_out(this)");var f=document.createElement("span");f.setAttribute("class",
"cnt_modify");f.setAttribute("title",Dext5LayerWin.dext5_lang.plugins.spellcheck.apply);f.setAttribute("onclick","parent.above_word_click(this)");f.innerHTML=a[c].suggestions[0];d.appendChild(f);var g=document.createElement("span");g.setAttribute("class","wordspan");g.innerText=a[c].word;var h=document.createElement("sup"),m=document.createTextNode(c+1+")");h.appendChild(m);d.appendChild(h);d.appendChild(g);b.insertNode(d);b.selectNode(d);e?b.collapse(!1):b.collapse(!0);var k=document.createElement("dl");
k.setAttribute("id","list"+c);k.setAttribute("value",c);-1!=LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].word.indexOf("'")?k.innerHTML='<dt onclick="wrong_word_click(this)" title="'+Dext5LayerWin.dext5_lang.plugins.spellcheck.undo+'"><a href="javascript:void(0);" data-value="'+LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].word+'">'+(c+1)+") "+LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].word+"</a></dt>":k.innerHTML="<dt onclick='wrong_word_click(this)' title='"+Dext5LayerWin.dext5_lang.plugins.spellcheck.undo+
"'><a href='javascript: void (0);' data-value='"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].word+"'>"+(c+1)+") "+LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].word+"</a></dt>";document.getElementById("wordlist").appendChild(k);for(var n=0;n<LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].suggestions.length;n++){var p=document.createElement("dd");p.setAttribute("onclick","replace_word_click(this)");p.setAttribute("title",Dext5LayerWin.dext5_lang.plugins.spellcheck.apply);p.innerHTML="<a href='javascript: void (0);' value='"+
LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].suggestions[n]+"'>"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].suggestions[n]+"</a></dt>";document.getElementById("list"+c).appendChild(p)}k.getElementsByTagName("dd")[0].setAttribute("class","recommend")}else{var q=a[c].word,q=q.replace(/ /gi,"\u00a0");if(b.findText(q)){b.deleteContents();d=document.createElement("span");d.setAttribute("id","cnt"+c);d.setAttribute("class","cnt");d.setAttribute("onmouseover","parent.wrong_word_over(this)");d.setAttribute("onmouseout",
"parent.wrong_word_out(this)");f=document.createElement("span");f.setAttribute("class","cnt_modify");f.setAttribute("title",Dext5LayerWin.dext5_lang.plugins.spellcheck.apply);f.setAttribute("onclick","parent.above_word_click(this)");f.innerHTML=a[c].suggestions[0];d.appendChild(f);g=document.createElement("span");g.setAttribute("class","wordspan");g.innerText=a[c].word;h=document.createElement("sup");m=document.createTextNode(c+1+")");h.appendChild(m);d.appendChild(h);d.appendChild(g);b.insertNode(d);
b.selectNode(d);e?b.collapse(!1):b.collapse(!0);k=document.createElement("dl");k.setAttribute("id","list"+c);k.setAttribute("value",c);-1!=LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].word.indexOf("'")?k.innerHTML='<dt onclick="wrong_word_click(this)" title="'+Dext5LayerWin.dext5_lang.plugins.spellcheck.undo+'"><a href="javascript:void(0);" data-value="'+LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].word+'">'+(c+1)+") "+LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].word+"</a></dt>":k.innerHTML="<dt onclick='wrong_word_click(this)' title='"+
Dext5LayerWin.dext5_lang.plugins.spellcheck.undo+"'><a href='javascript: void (0);' data-value='"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].word+"'>"+(c+1)+") "+LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].word+"</a></dt>";document.getElementById("wordlist").appendChild(k);for(n=0;n<LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].suggestions.length;n++)p=document.createElement("dd"),p.setAttribute("onclick","replace_word_click(this)"),p.setAttribute("title",Dext5LayerWin.dext5_lang.plugins.spellcheck.apply),
p.innerHTML="<a href='javascript: void (0);' value='"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].suggestions[n]+"'>"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[c].suggestions[n]+"</a></dt>",document.getElementById("list"+c).appendChild(p);k.getElementsByTagName("dd")[0].setAttribute("class","recommend")}else LayerWin.G_DEPlugin.spellcheck.chkWordArr.splice(c,1),c--}Dext5LayerWin.hideProcessingBackground()}catch(r){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function imgSizeUnitChange(a,e){var b=document.getElementById("img_height_unit"),c=document.getElementById("img_width_unit"),d=document.getElementById("img_width"),f=document.getElementById("img_height"),g=document.getElementById("img_ratio"),h=DEXTTOP.G_CURREDITOR._config.imgDefaultWidth,m=DEXTTOP.DEXT5.util.parseIntOr0(h),k=DEXTTOP.DEXT5.util.getEditSpacePx(DEXTTOP.G_CURREDITOR);if("%"==a){var n=Math.round(document.getElementById("original_image_width").value/k*1E4)/100;0==n&&(n="")}if(c.value!=
b.value)if(c.value=a,b.value=a,"%"==a)-1<h.indexOf("%")&&m<n&&""!=n&&0!=m?d.value=m:d.value=n,f.value="",f.disabled=!0;else{var h=DEXTTOP.G_CURREDITOR._config.imgDefaultWidth,k=DEXTTOP.G_CURREDITOR._config.imgDefaultHeight,p=document.getElementById("original_image_width").value,q=document.getElementById("original_image_height").value;""!=h&&0>h.indexOf("%")?DEXTTOP.DEXT5.util.parseIntOr0(p)>DEXTTOP.DEXT5.util.parseIntOr0(h)&&(k=DEXTTOP.DEXT5.util.parseIntOr0(q,10)*DEXTTOP.DEXT5.util.parseIntOr0(h,
10)/DEXTTOP.DEXT5.util.parseIntOr0(p,10),q=isNaN(k)?q:Math.round(k),p=DEXTTOP.DEXT5.util.parseIntOr0(h)):""!=k&&DEXTTOP.DEXT5.util.parseIntOr0(q)>DEXTTOP.DEXT5.util.parseIntOr0(k)&&(q=DEXTTOP.DEXT5.util.parseIntOr0(p,10)*DEXTTOP.DEXT5.util.parseIntOr0(k,10)/DEXTTOP.DEXT5.util.parseIntOr0(q,10),p=isNaN(q)?p:Math.round(q),q=DEXTTOP.DEXT5.util.parseIntOr0(k));d.value=p;f.value=q;f.disabled=!1}"true"==g.getAttribute("ratio-checked")?(c.value=a,b.value=a,"%"==a?"w"==e&&(-1<h.indexOf("%")&&m<n&&""!=n&&
0!=m?d.value=m:d.value=n,f.value="",f.setAttribute("disabled","true")):(d.removeAttribute("disabled"),f.removeAttribute("disabled"))):c.value==b.value?g.removeAttribute("disabled"):(g.className="img_link_btn",g.setAttribute("ratio-checked",!1),g.setAttribute("disabled","true"),d.removeAttribute("disabled"),f.removeAttribute("disabled"))}
function checkSameBorderWidthInCells(a,e){var b=["borderLeftWidth","borderTopWidth","borderRightWidth","borderBottomWidth"],c=b.length,d={isSame:!0,borderWidth:""};try{if(e){a=[];for(var f=["td","th"],g=f.length,h=0;h<g;h++){var m=e.getElementsByTagName(f[h]);try{a=a.concat(Array.prototype.slice.call(m,0))}catch(k){for(var n=m.length,p=0;p<n;p++)a.push(m[p])}}}var q=a.length;if(500>=q){for(var r=a[0].style.borderLeftWidth,h=0;h<q;h++){for(var u=a[h],p=0;p<c;p++)if(r!=u.style[b[p]]){d.isSame=!1;break}if(0==
d.isSame)break}1==d.isSame&&(d.borderWidth=r)}else d={isSame:!1,borderWidth:""}}catch(t){d={isSame:!1,borderWidth:""}}return d}function changeStyleForiOS(a,e){if(DEXTTOP.DEXT5.browser.iOS)for(data in a.style.webkitAppearance="none",e){a.style[data]=e[data];break}}function addParamHashTable(a){for(var e=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_FormData,b=e.length,c=0;c<b;c++){var d=e[c].form_value,d=encodeURIComponent(e[c].form_value);a.setItem(e[c].form_name,d)}}
function addParamForm(a){try{for(var e=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_FormData,b=e.length-1;0<=b;b--){var c=e[b].form_value,c=encodeURIComponent(e[b].form_value),d=document.createElement("input");d.setAttribute("type","hidden");d.setAttribute("id","addFormData"+[b]);d.setAttribute("name",e[b].form_name);d.setAttribute("value",c);a.insertBefore(d,a.firstChild)}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function postMessageEvent(a,e){if(window.postMessage){var b=function(a){try{var d=a.data.replace("*","?");_web_url=DEXTTOP.DEXT5.util.trim(d);switch(e){case "image":event_dext_image_upload_completed(d);break;case "cell_property":event_dext_cell_property_completed(_web_url);break;case "doc_bg_img":event_dext_dog_bg_img_completed(_web_url);break;case "flash":event_dext_flash_upload_completed(_web_url);break;case "hyperlink":dext_create_hyperlink(_web_url);break;case "insert_file":event_dext_file_upload_completed(_web_url);
break;case "media":event_dext_media_upload_completed(_web_url);break;case "video":event_dext_video_upload_completed(_web_url);break;case "table":event_dext_detail_table_completed(_web_url);break;case "table_property":event_dext_table_property_completed(_web_url);break;case "input_image":event_dext_input_image_upload_completed(_web_url)}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXTTOP.DEXT5.util.removeEvent(window,"message",b)};DEXTTOP.DEXT5.util.addEvent(window,"message",
b)}DEXTTOP.DEXT5.util.addEvent(a,"load",function(){var b="";"1"==DEXTTOP.G_CURREDITOR._config.security.postMessageTargetOriginMode?(b="",b=""!=DEXTTOP.G_CURREDITOR._config.post_url_save_for_notes?DEXTTOP.G_CURREDITOR._config.post_url_save_for_notes:DEXTTOP.G_CURREDITOR._config.post_url,b=DEXTTOP.DEXT5.util.getDomainInUrl(b).fullDomain2):b="*";a.contentWindow.postMessage("check",b)},!0)}
function aboutShowInfo(){try{document.getElementById("dext_license_company").innerHTML=": "+LayerWin._dext_editor.____.l[1],document.getElementById("dext_license_system").innerHTML=": "+LayerWin._dext_editor.____.l[2],document.getElementById("dext_license_product").innerHTML=": "+LayerWin._dext_editor.____.l[7],"S"==LayerWin._dext_editor.____.l[3]?document.getElementById("dext_license_edition").innerHTML=": Standard Edition":document.getElementById("dext_license_edition").innerHTML=": Professional Edition",
0==LayerWin._dext_editor.____.l[6]?document.getElementById("dext_license_user").innerHTML=": Unlimited.":document.getElementById("dext_license_user").innerHTML=": "+LayerWin._dext_editor.____.l[6],document.getElementById("dext_license_ver").innerHTML=": "+DEXTTOP.DEXT5.util.grvi("c")}catch(a){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function page_dialog_loaded_event(a){try{var e=document.location.href;try{e=e.substring(e.indexOf("/pages/editor_")+14),e=e.substring(0,e.indexOf(".html?"))}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(LayerWin.isMobileAndFixBottom()){var c=DEXTTOP.document.createElement("div");c.style.width="99%";c.style.position="absolute";DEXTTOP.document.body.append(c);var d=LayerWin.getClientRect(c).width;c.parentNode.removeChild(c);for(a=1;6>=a;a++){var f=document.querySelector(".DEXT_fiVe_ED_Popup_Type0"+
a);if(f){f.style.width=d+"px";break}}d=!0;-1<",calculator,paragraph_attribute,".indexOf(","+e+",")&&(d=!1);if(d){var g=document.querySelectorAll(".EdiTor_Popup_contents");for(a=0;a<g.length;a++)for(var h=g[a].querySelectorAll("table"),m=h.length,d=0;d<m;d++)h[d].style.width="",h[d].classList.add("mobile")}"function"==typeof setUiForMobile&&setUiForMobile()}"function"===typeof DEXTTOP.G_CURREDITOR._config.event.dialogLoaded?DEXTTOP.G_CURREDITOR._config.event.dialogLoaded(e,document):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_dialog_loaded_event&&
DEXTTOP.DEXTWIN.dext_editor_dialog_loaded_event(e,document)}catch(k){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function row_property_set_page(){var a=LayerWin.GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);if(null!=a&&void 0!=a){var e=LayerWin.GetParentbyTagName(a,"table"),b=LayerWin.GetParentbyTagName(a,"tr");if(null!=e&&null!=b){for(var c=null,d="",f="",g="",h="",m=!0,k=!0,n=!0,p=!0,q=b.cells.length,r=0;r<q;r++)c=b.cells[r],0!=r&&(m&&d!=c.style.backgroundColor&&(m=!1),k&&f!=c.style.height&&(k=!1),n&&g!=c.style.textAlign&&(n=!1),p&&h!=c.style.verticalAlign&&(p=!1)),d=c.style.backgroundColor,f=c.style.height,g=c.style.textAlign,
h=c.style.verticalAlign;m&&(document.getElementById("background_color").style.backgroundColor=d);f=LayerWin.parseIntOr0(f);k&&0<f&&(document.getElementById("row_height").value=f);n&&""!=g&&(document.getElementById("horizontal_align").value=g);p&&""!=h&&(document.getElementById("vertical_align").value=h);if(DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion)a=document.getElementsByClassName("contents")[0],b=document.getElementById("div_thead"),a.removeChild(b);else{(c="THEAD"==b.parentNode.tagName?
!0:!1)?document.getElementById("row_thead").checked=!0:document.getElementById("row_thead").checked=!1;d=!1;f=[];for(g=0;g<e.rows.length;g++)for(h=e.rows[g],m=0;m<h.cells.length;m++)k=h.cells[m],1<k.rowSpan&&f.push({tr:h,td:k});for(g=0;g<f.length;g++)if(e=f[g],1==a.rowSpan)if(c){if(b.rowIndex>e.tr.rowIndex&&b.rowIndex<=e.tr.rowIndex+e.td.rowSpan-1){d=!0;break}}else{if(e.tr.rowIndex+e.td.rowSpan-1>b.rowIndex&&e.tr.rowIndex<=b.rowIndex){d=!0;break}}else if(c){if(b.rowIndex>e.tr.rowIndex&&b.rowIndex<=
e.tr.rowIndex+e.td.rowSpan-1){d=!0;break}}else if(b.rowIndex+a.rowSpan<e.tr.rowIndex+e.td.rowSpan&&b.rowIndex+a.rowSpan-1>=e.tr.rowIndex){d=!0;break}d&&(document.getElementById("row_thead").disabled=!0)}}}}
function imgPreView(a,e,b){var c=null,d=null;if(null!=a&&"string"==typeof a){if("obj"==a){if(c=G_validImageFiles,null==c||0>=c.length){alert(LayerWin.dext5_lang.imgPreview.msg_img_error);"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&(a=""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display?!0:!1)&&LayerWin.closeBtnPreViewMode();return}}else if(d=null!=b||""!=b?document.getElementById(b).value:document.getElementById("img_web_url").value,
null==d||""==d){alert(LayerWin.dext5_lang.imgPreview.msg_img_error);"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&(a=""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display?!0:!1)&&LayerWin.closeBtnPreViewMode();return}showImgPreViewPopup(a,c,e,d)}else alert(LayerWin.dext5_lang.imgPreview.msg_img_error),"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&(a=""==
DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display?!0:!1)&&LayerWin.closeBtnPreViewMode()}
function showImgPreViewPopup(a,e,b,c){var d=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup");null==d&&(LayerWin.createImgPreViewPopup(),d=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup"));d.childNodes[0].className="DEXT_fiVe_PUi_imgPreView_popup_"+DEXTTOP.G_CURREDITOR._config.style.skinName;d.style.width=DEXTTOP.G_CURREDITOR._config.imgPreViewWidth;d.style.height=DEXTTOP.G_CURREDITOR._config.imgPreViewHeight;d.childNodes[0].style.height=parseInt(DEXTTOP.G_CURREDITOR._config.imgPreViewHeight)-
2+"px";var f=parseInt(DEXTTOP.G_CURREDITOR._config.imgPreViewWidth)-6,g=parseInt(DEXTTOP.G_CURREDITOR._config.imgPreViewHeight)-6-16,h=null;"obj"==a&&(h=e[b]);e=d.getElementsByTagName("span")[0];e.innerHTML="";var m=new Image;e.appendChild(m);m.onload=function(){if(0!=m.width&&0!=m.height){var a,b;b=Math.min(f/m.width,g/m.height);1>b?(a=Math.round(m.width*b),b=Math.round(m.height*b)):(a=m.width,b=m.height);m.style.width=a+"px";m.style.height=b+"px";a=0;b<g&&(a=(g-b)/2);0<a&&(m.style.marginTop=a+"px");
setPositionPreviewPopup(d)}};m.onerror=function(a){"1"===m.getAttribute("de_bloburl")?(m.setAttribute("de_bloburl","2"),a=new FileReader,a.onload=function(){m.src=this.result},a.readAsDataURL(h)):(LayerWin.closeBtnPreViewMode(),alert(LayerWin.dext5_lang.imgPreview.msg_img_error))};"url"==a?""!=c?m.src=c:LayerWin.closeBtnPreViewMode():-1<h.type.indexOf("image")?(a=(window.URL||window.webkitURL||window).createObjectURL(h),m.src=a,m.setAttribute("de_bloburl","1")):LayerWin.closeBtnPreViewMode()}
function setPositionPreviewPopup(a){var e=DEXTTOP.DEXTDOC.getElementById("div_dlgmoveing_iframe_"+DEXTTOP.G_CURREDITOR.ID),b=null,b=null==e?DEXTTOP.DEXTDOC.getElementById("dext_dialog"):e.parentElement;a.style.zIndex=DEXTTOP.G_CURREDITOR._config.zIndex+4E3;a.style.display="";LayerWin.makeDragPreviewPopup(a);a.style.left=b.offsetLeft+b.offsetWidth+2+"px";a.style.top=b.offsetTop+"px";e=DEXTTOP.innerWidth+DEXTTOP.scrollX;b=a.offsetLeft+a.offsetWidth;e<=b&&(a.style.left=a.offsetLeft-(b-e)-18+"px")}
function setPreviewIcon(a,e,b,c){"hyperlink_image"==a?(e.style.width="220px",b="<a href=\"javascript:imgPreView('url',-1, '"+b+'\')" title="'+LayerWin.dext5_lang.imgPreview.title+'" style="margin-left: 5px;">',b+='<img id="imgPreview_img_2" src="../images/editor/icon/img_preview.png" alt="img_preview" style = "border:0;"/></a>',e.insertAdjacentHTML("afterend",b)):(e.style.border="solid 1px #c5c5c5",a='<div class="drop_zone_file_list" style="width: 100%; height: 100%; font-size: 11px; position: relative; cursor: pointer;"><div style="padding-top: 9px; height: 31px; width: 255px; float: left;">',
a+='<div style="font-size: 12px; height: 100%; width: 215px; display: block; float: left; line-height: 1.9; color: rgb(97, 97, 97);overflow:hidden; text-overflow:ellipsis; white-space:nowrap; text-align: left; padding-left:3px;">',a+=c,a+="</div>",a+="<a href=\"javascript:imgPreView('url',-1, '"+b+'\')" title="'+LayerWin.dext5_lang.imgPreview.title+'" style="display: block; float: right; line-height: 20px; padding-right:10px;">',a+='<img id="imgPreview_img_2" src="../images/editor/icon/img_preview.png" alt="img_preview" style = "border:0;"/>',
a+="</a>",a+="</div>",a+="</div>",e.innerHTML=a)}function set_numbering_value_ok(){var a=LayerWin._dext_editor.orderedListObj,e=a.changeVal,b=a.selectedNode,c=document.getElementById("preview");LayerWin.event_dext_set_numbering_value(a,e,b,c.style.listStyleType,b.parentNode,window.frameElement.parentNode.parentNode)}
function set_list_adjustment_ok(a,e){LayerWin.event_dext5editor_set_list_inoutdent_value(DEXTTOP.G_CURREDITOR.orderedListObj,a,e,window.frameElement.parentNode.parentNode,window.frameElement.contentDocument)}
function reset_dialog_input_text(a){a.getElementById("image_url")&&(a.getElementById("image_url").value="");a.getElementById("img_alt")&&(a.getElementById("img_alt").value="");a.getElementById("file_text")&&(a.getElementById("file_text").value="");a.getElementById("file_text_view")&&(a.getElementById("file_text_view").value="");a.getElementById("input_text")&&(a.getElementById("input_text").value="")}
function setNumberingValuePageLoadedEvent(){var a=LayerWin._dext_editor._config.style.skinName;document.getElementById("dext_dialog_box").className="DEXT_fiVe_ED_Popup_Type01 DEXT_fiVe_PUi_"+a;var e=document.getElementById("span_title"),b=document.getElementById("input_start_number"),c=document.getElementById("preview"),a=document.getElementById("val_up"),d=document.getElementById("val_down"),f=document.getElementById("span_ok"),g=document.getElementById("span_cancel"),h=document.getElementById("ok_btn");
e.innerHTML=LayerWin.dext5_lang.set_numbering_value.title;f.innerHTML=LayerWin.dext5_lang.set_numbering_value.btn_ok;f.parentNode.title=LayerWin.dext5_lang.set_numbering_value.btn_ok;g.innerHTML=LayerWin.dext5_lang.set_numbering_value.btn_cancel;g.parentNode.title=LayerWin.dext5_lang.set_numbering_value.btn_cancel;document.title=LayerWin.dext5_lang.set_numbering_value.frame_title;if(LayerWin.G_DEPlugin.customliststyle)LayerWin.G_DEPlugin.customliststyle.setNumberingPageLoaded({dialogWin:window});
else{var m=DEXTTOP.G_CURREDITOR.orderedListObj;c.style.listStyleType=m.marker;b.value=m.currNum;c.start=m.currNum;e=function(){return function(a){b.value=c.start;LayerWin.click_plus_func(b,null,1,function(){b.value=b.value;c.start++;m.changeVal++;b.focus()});DEXTTOP.DEXT5.util.stopEvent(a)}}();f=function(){return function(a){switch(b.value.toString()){case "0":case "00":return}b.value=c.start;LayerWin.click_minus_func(b,0,1,null,function(){c.start--;m.changeVal--;b.value=b.value;b.focus()});DEXTTOP.DEXT5.util.stopEvent(a)}}();
g=function(){return function(a){a:{var c=b.value,d=c.length,e=c.charAt(0);for(k=0;k<d;k++)if(e=c.charAt(k),!("0"<=e&&"9">=e)){alert("0 \uc774\uc0c1 "+LayerWin.dext5_lang.msg.alert_only_number);b.value="0";document.getElementById("preview").start=0;DEXTTOP.G_CURREDITOR.orderedListObj.changeVal=0;b.focus();break a}else if(0<k&&"0"==c.charAt(0)){b.value=e;document.getElementById("preview").start=e;DEXTTOP.G_CURREDITOR.orderedListObj.changeVal=e;b.focus();break a}""==b.value?(b.value="0",document.getElementById("preview").start=
0,DEXTTOP.G_CURREDITOR.orderedListObj.changeVal=0):(document.getElementById("preview").start=b.value,DEXTTOP.G_CURREDITOR.orderedListObj.changeVal=b.value)}DEXTTOP.DEXT5.util.stopEvent(a)}}();DEXTTOP.DEXT5.util.addEvent(a,"click",e);DEXTTOP.DEXT5.util.addEvent(d,"click",f);DEXTTOP.DEXT5.util.addEvent(b,"keyup",g);DEXTTOP.DEXT5.util.addEvent(b,"keydown",LayerWin.onlyNumber);DEXTTOP.DEXT5.util.addEvent(h,"click",function(){set_numbering_value_ok()});if("BackCompat"==LayerDoc.compatMode)for(var a=document.getElementsByTagName("input"),
k=0;k<a.length;k++)"text"==a[k].type&&(a[k].style.height="20px")}LayerWin.getElementsByClass("EdiTor_Popup_header",document)[0].onselectstart=function(){return!1};setCursorPos(b,!1,!1);LayerWin.setFocusFirstAndLast(document,b)}
function setListAdjustmentPageLoaded(){var a=LayerWin._dext_editor._config.style.skinName;document.getElementById("keditor_dialog_box").className="DEXT_fiVe_ED_Popup_Type03 DEXT_fiVe_PUi_"+a;var e=document.getElementById("span_title"),b=document.getElementById("list_title"),c=document.getElementById("text_title"),d=document.getElementById("check_label"),f=document.getElementById("include_list"),g=document.getElementById("list_position"),h=document.getElementById("options"),m=document.getElementById("text_inoutdent"),
k=document.getElementById("options2"),a=document.getElementById("val_up"),n=document.getElementById("val_down"),p=document.getElementById("val_up2"),q=document.getElementById("val_down2"),r=document.getElementById("span_ok"),u=document.getElementById("span_cancel"),t=document.getElementById("ok_btn");e.innerHTML=LayerWin.dext5_lang.set_list_adjustment.title;r.innerHTML=LayerWin.dext5_lang.set_list_adjustment.btn_ok;r.parentNode.title=LayerWin.dext5_lang.set_list_adjustment.btn_ok;u.innerHTML=LayerWin.dext5_lang.set_list_adjustment.btn_cancel;
u.parentNode.title=LayerWin.dext5_lang.set_list_adjustment.btn_cancel;document.title=LayerWin.dext5_lang.set_list_adjustment.frame_title;if(LayerWin.G_DEPlugin.customliststyle)LayerWin.G_DEPlugin.customliststyle.setListAdjustmentPageLoaded({dialogWin:window});else{var z=DEXTTOP.G_CURREDITOR.orderedListObj,e=z.selectedNode,y,v,A,w;e&&(y=DEXTTOP.G_CURREDITOR.orderedListObj.changeListPos,v=DEXTTOP.G_CURREDITOR.orderedListObj.changeListUnit,A=DEXTTOP.G_CURREDITOR.orderedListObj.changeTextPos,w=DEXTTOP.G_CURREDITOR.orderedListObj.changeTextUnit,
"OL"==e.parentNode.tagName?(b.innerHTML=LayerWin.dext5_lang.set_list_adjustment.list_position_num,f.innerHTML=LayerWin.dext5_lang.set_list_adjustment.list_position_num_check,d.title=LayerWin.dext5_lang.set_list_adjustment.list_check_label):"UL"==e.parentNode.tagName&&(b.innerHTML=LayerWin.dext5_lang.set_list_adjustment.list_position_sym,f.innerHTML=LayerWin.dext5_lang.set_list_adjustment.list_position_sym_check,d.title=LayerWin.dext5_lang.set_list_adjustment.list_check_label),c.innerHTML=LayerWin.dext5_lang.set_list_adjustment.text_inoutdent);
b=d=!1;for(c=0;c<h.length;c++)v==h[c].value&&(h.value=v,d=!0);for(c=0;c<k.length;c++)w==k[c].value&&(k.value=w,b=!0);d||(c=document.getElementById("options"),d=c.lastElementChild,f=new Option(v,v),c.add(f),c.add(d),c.value=v);b||(c=document.getElementById("options2"),d=c.lastElementChild,f=new Option(w,w),c.add(f),c.add(d),c.value=w);g.value=y;m.value=A;y=function(){return function(a){LayerWin.click_plus_func(g,null,1,function(){});DEXTTOP.DEXT5.util.stopEvent(a)}}();v=function(){return function(a){LayerWin.click_minus_func(g,
null,1,null,function(){});DEXTTOP.DEXT5.util.stopEvent(a)}}();A=function(){return function(a){LayerWin.click_plus_func(m,null,1,function(){});DEXTTOP.DEXT5.util.stopEvent(a)}}();w=function(){return function(a){LayerWin.click_minus_func(m,0,1,null,function(){});DEXTTOP.DEXT5.util.stopEvent(a)}}();DEXTTOP.DEXT5.util.addEvent(a,"click",y);DEXTTOP.DEXT5.util.addEvent(n,"click",v);DEXTTOP.DEXT5.util.addEvent(p,"click",A);DEXTTOP.DEXT5.util.addEvent(q,"click",w);DEXTTOP.DEXT5.util.addEvent(t,"click",function(){var a=
!0,b=!0,c=DEXTTOP.G_CURREDITOR.orderedListObj.changeTextPos+DEXTTOP.G_CURREDITOR.orderedListObj.changeTextUnit,d=m.value+k.value;DEXTTOP.G_CURREDITOR.orderedListObj.changeListPos+DEXTTOP.G_CURREDITOR.orderedListObj.changeListUnit==g.value+h.value?a=!1:(DEXTTOP.G_CURREDITOR.orderedListObj.changeListPos=g.value,DEXTTOP.G_CURREDITOR.orderedListObj.changeListUnit=h.value);c==d?b=!1:(DEXTTOP.G_CURREDITOR.orderedListObj.changeTextPos=m.value,DEXTTOP.G_CURREDITOR.orderedListObj.changeTextUnit=k.value);c=
document.getElementById("options");z.changeListUnit=c.value;c=document.getElementById("options2");z.changeTextUnit=c.value;set_list_adjustment_ok(a,b)})}if("BackCompat"==LayerDoc.compatMode)for(a=document.getElementsByTagName("input"),c=0;c<a.length;c++)"text"==a[c].type&&(a[c].style.height="20px");LayerWin.getElementsByClass("EdiTor_Popup_header",document)[0].onselectstart=function(){return!1};setCursorPos(document.getElementById("radio_row"),!1,!1);LayerWin.setFocusFirstAndLast(document,document.getElementById("radio_row"))}
;
