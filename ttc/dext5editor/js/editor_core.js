var console=window&&window.console?window.console:{log:function(){}},G_ICON_FULL_SET="new save save_as print undo redo copy text_copy cut paste text_paste find replace emoticon setting horizontal_line detail_horizontal_line image_create image_editor image_property image_editor_property flash_create flash_property media_create media_property iframe_create iframe_property hyperlink_create hyperlink_property remove_hyperlink bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight table_group table_group_detail full_screen bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color align_group align_group_detail align_left align_center align_right align_full line_height line_height_inc line_height_dec indent outdent list_number list_bullets detail_list_number detail_list_bullets top_design top_source top_preview top_text design source preview text formatting font_family font_size font_size_inc font_size_dec about select_all insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom template grid tool_replace convert_table_to_text insert_link_media paste_word cell_border cell_bg_color table_indent table_outdent load_auto_save ruler pagebreak layout dirltr dirrtl insert_file file_open format_painter apply_format letter_spacing letter_spacing_inc letter_spacing_dec image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_textarea_property input_select input_select_property input_imagebutton input_same_width input_same_height input_same_width_height accessibility_validation table_copy table_paste intable_paste table_content_paste table_content_paste_to_text table_content_paste_with_format horizontal_sum vertical_sum horizontal_avg vertical_avg horizontal_mul vertical_mul horizontal_sub vertical_sub horizontal_div vertical_div table_selection show_blocks table_lock cell_lock table_lock_property help tool_bar_grouping list_lower_alpha word_transform photo_editor photo_editor_property insert_file_property shortcut detail_font_color detail_font_bg_color detail_cell_bg_color table_border insert_layer element_position order_of_objects order_of_objects_detail insert_datetime detail_insert_datetime conversion personal_data forbidden_word video video_property spell_check calculator zoom zoom_plus zoom_minus mini_photo_editor placeholder paragraph_attribute table_adjust insert_table_top_paragraph insert_table_bottom_paragraph clean_nested_tag body_fit hyperlink_open manually_temp_save status_source status_preview status_text save_as_image filelink_open delete_pagebreak continue_numbering set_numbering_value set_numbering_from_first sticky_table sticky_top_row sticky_first_column".split(" "),
G_ICON_READONLY_ACTIVATION_SET="save print find full_screen help about".split(" "),G_ICON_CUSTOM_ADD_DISABLED_SET=[],G_FORMATTING=" h1 h2 h3 h4 h5".split(" "),DEXTTOP=parent;try{DEXTTOP.IsCrossDomain=!1}catch(e$$4){try{var evtDataObj={strType:"CrossDomain",strCode:"C204",strMessage:"cross domain error"};"function"===typeof DEXTTOP.dext_editor_on_error_event?DEXTTOP.dext_editor_on_error_event("",evtDataObj):alert(evtDataObj.strMessage)}catch(e$$5){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}setDEXTWINwindow();
setDEXTDOCdocument();DEXTTOP.G_SELECTED_ELEMENT=null;DEXTTOP.G_CURREDITOR=null;DEXTTOP.G_COPIEDTABLE=null;DEXTTOP.G_COPIEDCELLDATA=null;var G_CURSOR_ELEMENT=DEXTTOP.G_SELECTED_IMAGE_ELEMENT=null,G_dextResize_Elem_Flag=!1;DEXTTOP.DEXT5=parent.DEXT5;parent.DEXTTOP=DEXTTOP;
var G_dext5plugIn=null,G_dialogHelper=null,G_SUB_DIALOG=null,G_CURRENT_IFRAME=null,G_CURRENT_IFRAME_HOLDER=null,G_USE_EDITOR_ID=null,G_LAST_CMD=null,G_MAIN_ZINDEX=1E4,G_PutUndoCharCount=20,G_Progress_LoadTime=100,G_TIMEOUT_CNT=0,G_ShortCutClose=!1,G_ShortCutClick=!1,xmlHttpReqeust_Config,SIL=[],Z=[],___=DEXTTOP.DEXTWIN.location,_0_,_1_,_7_;DEXTTOP.DEXT5.util.overrideFn(window);
var G_BASE_COLOR_PICKER="#ffffff #f7f7f7 #e2e2e2 #c2c2c2 #9c9c9c #858585 #404040 #272727 #000000 #ffb39b #ffd4a7 #fff599 #c5dd9c #7ec89d #85ddff #87c5ff #bd8fbf #f69fc1 #ff0000 #ff9c23 #f4d400 #7bb423 #00a350 #00afef #0076c8 #93338f #f02c8c #9f190d #a46206 #a79a00 #568228 #007036 #0077a4 #0000ff #63155f #a01a5c".split(" "),_R_O_="c",R=[],T=[],K__="zu",C1=[],C2=[],ALS=[],S1=[],S2=[],M1="UklFbHVkbUZzYVdRZ1VISnZaSFZqZENCTFpYa3VJQT09",M2="UklFeHBZMlZ1YzJVZ1JYaHdhWEpsWkM0Zw==",M3="UklFbHVkbUZzYVdRZ1JHOXRZV2x1TGlBPQ==",
M4="UklFbHVkbUZzYVdRZ1ZVa2dUVzlrZFd4bElFeHBZMlZ1YzJVdUlBPT0=",M5="UklFbHVkbUZzYVdRZ1UzQmxiR3dnUTJobFkydGxjaUJNYVdObGJuTmxMZz09",G_DEPlugin={},G_SC="",G_KeydownNode=null,G_BODY_DEFAULT_VALUE="",G_Ruler=null,G_BodyFit=null,G_DEXT_Diagonal=null,G_IsCollapsedInMouseup=!0,G_DesignHtmlWidth=null,G_DesignHtmlMarginValue=null,G_ZoomValue=null,G_AddOrRemovedNodesObserver=null;
function setDEXTWINwindow(){try{topURL=top.location.href,"undefined"==typeof topURL?(DEXTTOP.DEXTWIN=parent,DEXTTOP.IsCrossDomain=!0):(DEXTTOP.DEXTWIN=parent,DEXTTOP.IsCrossDomain=!1)}catch(a){DEXTTOP.DEXTWIN=parent,DEXTTOP.IsCrossDomain=!0}}
function setDEXTDOCdocument(){try{topURL=top.location.href,"undefined"==typeof topURL?(DEXTTOP.DEXTDOC=parent.document,DEXTTOP.IsCrossDomain=!0):(DEXTTOP.DEXTDOC=parent.document,DEXTTOP.IsCrossDomain=!1)}catch(a){DEXTTOP.DEXTDOC=parent.document,DEXTTOP.IsCrossDomain=!0}}SIL[0]="t";K__+="vw";
function DEXT5_EDITOR(a,b,c,d){G_PutUndoCharCount=b.undoCount;this.ID=a;this.Frame=c;this.FrameStatus="";this.FrameID=c.FrameID;DEXTTOP.DEXT5.DEXTMULTIPLE[c.FrameID]=this;DEXTTOP.G_CURREDITOR=this;this._config=b;this._newMode=this._currentMode="design";this._BODY=this._DOC=null;this._EDITOR={};this._defaultHeight="";this._setting={};this._top_menu_click_flag=!1;this._top_menu_click_id="";this._docType={};this.UndoManager=new UndoManager;this.WordCountUndoManager=new UndoManager;this.baseMenuToolbarHeight=
0;this._PageProp={};this.remove_item=[];this.remove_context_item=[];this.____={};this._LastRange=null;this._RangeBlurBug=!1;this._defaultWidth=this._defTableWidth=0;this._dextCustomData=[];this._dextframeHasFocus=this._dextCustomDataMode=!1;this.changeMultiValue={valueLength:0};this._FRAMEWIN=window;this._formatPainterList=null;this._contentsClass=["dext5_bookmark"];_R_O_+="/";_R_O_+="=";G_MAIN_ZINDEX=b.zIndex;this.setImageArr=[];this.setElementsArr=[];this.sTextareaArr=[];this.applyEdgeMode=this.violationNode=
this._editingCheckedValue=null;this._configXml=c.configXml;this.ShowBlocks="";this.lastElemForLock=this.dext_dragresize=null;this.Toolbar_group=[[],[]];this.detailSubCmd="list_decimal list_decimal_leading_zero list_lower_alpha list_lower_greek list_lower_roman list_upper_alpha list_upper_roman list_disc list_circle list_square list_none".split(" ");this.initPaste=!0;this.imageForPhotoEditor=null;this.initSetSize=!0;this.groupingBoxOpen=this.isOccurredResizeEvent=!1;this.dialogWindow=null!=d.DialogWindow?
d.DialogWindow:null;null!=this.dialogWindow&&(this.dialogWindow.DEXTWIN=DEXTTOP.DEXTWIN,this.dialogWindow.DEXTDOC=DEXTTOP.DEXTDOC,this.dialogWindow.G_CURREDITOR=DEXTTOP.G_CURREDITOR);this.topStatusBarTitleIdx=this.statusBarTitleIdx=0;this.setTextPaste=!1;this.setTextPasteMode="0";this.iconEnableCommandType=this.dextResize=null;this.lockCommand=[];this.toolmenu_bg_resize=function(){return function(a){try{var b="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth,
c="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight,d=DEXTTOP.DEXTDOC.getElementById("dext_toolmenu_background"+_dext_editor.ID);d.firstChild.style.width=b+"px";d.firstChild.style.height=c+"px"}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}();this.topmenu_bg_resize=function(){return function(a){try{var b="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth,
c="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight,d=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+_dext_editor.ID);d.firstChild.style.width=b+"px";d.firstChild.style.height=c+"px"}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}();this.context_bg_resize=function(){return function(a){try{getDialogWindow();var b=getDialogDocument(),c="CSS1Compat"==b.compatMode?b.documentElement.scrollWidth:b.body.scrollWidth,
d="CSS1Compat"==b.compatMode?b.documentElement.scrollHeight:b.body.scrollHeight,e=b.getElementById("dext_context_background");e&&(e.firstChild.style.width=c+"px",e.firstChild.style.height=d+"px")}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}();this.isInitFocusHandler=!0;this.mouseDropPosition={clientX:null,clientY:null};this.ShowTableBorder=!1;this.selectionDextmark=[];this.isUseApplyFormat=!1;this.strOldSaveFileName="";this.pluginInstallGuidePopup=this.beforeOffset=null;this.bTextorHtmlData=
this.isInitKeydownForSetApi=!1;this.pasteEvt=this.clipImageBlob=null;this.clipData="";this.clipImageBeforePopup=null;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.languageDefinition?DEXTTOP.G_CURREDITOR._config.event.languageDefinition(dext5_lang,a):"function"==typeof DEXTTOP.DEXTWIN.dext_editor_language_definition_event&&DEXTTOP.DEXTWIN.dext_editor_language_definition_event(dext5_lang,a)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}this.isStopScroll=!1;this.previousScrollTop=
0;this.preventScrollMove={use:!1,beforeTop:0,beforeLeft:0};this.xhr_onprogress=null;if("undefined"==typeof DEXTTOP.DEXTWIN.G_CURREDITOR._FRAMEWIN.DEXT_LANG_CONFIG)this.lastDateType=null;else try{this.lastDateType=DEXTTOP.DEXTWIN.G_CURREDITOR._FRAMEWIN.DEXT_LANG_CONFIG.dateTime.common_date[0]}catch(f){this.lastDateType=""}this.recentlyColorName="dextRecentlyColor";this.recentlyFontName="dextRecentlyFont";this.DEXT5WordDoc=this.DEXT5WordApp=null;this.checkEnterKeyTargetTagArr="li h1 h2 h3 h4 h5".split(" ");
this.isEnterKeyInTargetTag=!1;this.changeDivTagArr=[];this.isClickedMiniPhoto=this.miniPhotoLastMode=this.dextiframeKeydown=!1;this.keydownStyleForIOS={currStyle:null,fontSize:""};this.defaultTableTemplateTab=this.keydownInputText="";this.isInitBodyAutoFit=!0;this.keydownNodeForTableCaret={tdNode:null,backupRange:null};this.useFocusDivForIOS=DEXTTOP.DEXT5.browser.iOS?!0:!1;this.pasteTableParam={tableNode:null,tableHtml:"",currTableNode:null,currCellNode:null};this.isTablePaste=this.AccessClipboardForIEGecko=
!1;this.autoMoveInitFocusData={targetDocument:null,targetNode:null,targetNodeEx:null};this.insertBrNodes=[];this.backupWidthForIOS={backupWidth:"",isPopup:!1};this.hasFontNodeInPasteHtml=!1;this.relativeNode=[];this.isAOver={over:!1,node:null,nodeChild:null,openHelp:!1,linkStyle:!1,timer:null,addTarget:!1};this.disableUndoRedo=!1;this.lastCellForUndoManager=null;this.autoListUse="";this.fixDEXTWINScroll={keyCodeArr:[33,34],backupValue:null,fn:function(){DEXTTOP.DEXTWIN.scrollTo(DEXTTOP.G_CURREDITOR.fixDEXTWINScroll.backupValue.left,
DEXTTOP.G_CURREDITOR.fixDEXTWINScroll.backupValue.top)}};this.imageFileInfo={isMulti:!1,validData:{isFile:!1,isDragDropFile:!1,isLastIdx:!1,fileIdx:0,fileTotalCnt:0,valiedCnt:0,errorFileIdx:[],sizeErrorFile:[],base64CntErrorFile:[],extensionErrorFile:[],detectErrorFile:[],eventReturnFalse:[]},uploadData:{isImageFileUpload:!0,isUploaded:!0,isLastIdx:!1,uploadedFileCnt:0,totalFileCount:0,fileIdx:0,nowFileName:"",errorFile:[]}};G_BodyFit=new BodyFit(this);"1"==this._config.ruler.use&&(G_Ruler=new Ruler(this));
DEXTTOP.DEXT5.browser.ie||"1"!=this._config.diagonal.use||(G_DEXT_Diagonal=new Diagonal(this));this.isPasting=!1;a=this._config.defaultHorizontalLineStyle;this.lastHorizontalLine={dext_json:{width:a.width,align:a.align,height:a.height,color:a.color},template:{obj:null,tempWidth:null,clickedIdx:null}};this.xssRemoveEventsList="onabort,onactivate,onafterprint,onafterupdate,onbeforeactivate,onbeforecopy,onbeforecut,onbeforedeactivate,onbeforeeditfocus,onbeforepaste,onbeforeprint,onbeforeunload,onbeforeupdate,onbegin,onblur,onbounce,oncellchange,onchange,onclick,oncontentready,oncontentsave,oncontextmenu,oncontrolselect,oncopy,oncut,ondataavailable,ondatasetchanged,ondatasetcomplete,ondblclick,ondeactivate,ondetach,ondocumentready,ondrag,ondragdrop,ondragend,ondragenter,ondragleave,ondragover,ondragstart,ondrop,onend,onerror,onerrorupdate,onfilterchange,onfinish,onfocus,onfocusin,onfocusout,onhelp,onhide,onkeydown,onkeypress,onkeyup,onlayoutcomplete,onload,onlosecapture,onmediacomplete,onmediaerror,onmedialoadfailed,onmousedown,onmouseenter,onmouseleave,onmousemove,onmouseout,onmouseover,onmouseup,onmousewheel,onmove,onmoveend,onmovestart,onopenstatechange,onoutofsync,onpaste,onpause,onplaystatechange,onpropertychange,onreadystatechange,onrepeat,onreset,onresize,onresizeend,onresizestart,onresume,onreverse,onrowclick,onrowenter,onrowexit,onrowout,onrowover,onrowsdelete,onrowsinserted,onsave,onscroll,onseek,onselect,onselectionchange,onselectstart,onshow,onstart,onstop,onsubmit,onsyncrestored,ontimeerror,ontrackchange,onunload,onurlflip,formaction,onwheel,ontoggle,oninput,oncanplay,onafterscriptexecute,onanimationcancel,onanimationend,onanimationiteration,onanimationstart,onauxclick,onbeforeinput,onbeforescriptexecute,onbeforetoggle,oncanplaythrough,onclose,oncompositionend,oncompositionstart,oncompositionupdate,oncuechange,ondurationchange,onended,onfullscreenchange,onhashchange,oninvalid,onloadeddata,onloadedmetadata,onlostpointercapture,onmessage,onmozfullscreenchange,onpagehide,onpageshow,onplay,onplaying,onpopstate,onpointerrawupdate,onpointerout,onpointerover,onpointermove,onpointerup,onpointerleave,onpointerenter,onpointerdown,onpointercancel,onprogress,onratechange,onsearch,onsecuritypolicyviolation,onseeked,onseeking,onscrollend,ontimeupdate,ontransitionstart,ontransitionrun,ontransitionend,ontransitioncancel,ontouchstart,ontouchmove,ontouchend,ontouchcancel,onunhandledrejection,onvolumechange,onwebkitanimationend,onwebkitanimationiteration,onwebkitanimationstart,onwebkittransitionend,onloadstart,onformdata,onfullscreenerror,onoffline,ononline,onopen,onstalled,onstorage,onsuspend,onwaiting,oncontentvisibilityautostatechange,onautocomplete,onautocompleteerror,oncancel,onemptied,onsort,ongotpointercapture,onvisibilitychange,onpointerlockchange,onpointerlockerror,ondevicemotion,ondeviceorientation";
try{"1"==this._config.imgPreView&&createImgPreViewPopup()}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}this.addedTotalFileSize=0;this.targetElemOriginDataForReplaceImage=null;this.messageInfoForMaxTotalFileSize={messageType:"default",currAddedTotalFileSize:0,currFileSize:0,currPassedFiles:[],currFilteredFiles:[]};this.dialogOpenCmd=null;this.orderedListObj={selectedNode:null,currNum:null,changeVal:null,marker:null,defaultMessage:dext5_lang.context.set_numbering_from_first,changeListPos:null,
changeListUnit:null,changeTextPos:null,changeTextUnit:null,fnGetCurrIdx:function(a){for(var b=a.parentNode.childNodes,c=b.length,d=0,e=0;e<c;e++)if(b[e]&&b[e].tagName&&"LI"==b[e].tagName)if(b[e]==a)break;else d++;return d},fnGetListStyleType:function(a){var b;document.defaultView&&document.defaultView.getComputedStyle?b=document.defaultView.getComputedStyle(a,null).getPropertyValue("list-style-type"):a.currentStyle&&(b=a.currentStyle["list-style-type"]);return b},fnGetListStyleMargin:function(a){var b;
"OL"==a.tagName||"UL"==a.tagName?""!=a.style.marginLeft?(b=a.style.marginLeft,b=parseIntOr0(b)):b=40:"LI"==a.tagName&&(""!=a.style.paddingLeft?(b=a.style.paddingLeft,b=parseIntOr0(b)):b=0);return b},fnGetListUnit:function(a){var b;"OL"==a.tagName||"UL"==a.tagName?b=""==a.style.marginLeft?"px":a.style.marginLeft.match(/[a-zA-Z]+/)[0]:"LI"==a.tagName&&(b=""==a.style.paddingLeft?"px":a.style.paddingLeft.match(/[a-zA-Z]+/)[0]);return b}}}K__+="CDE";
DEXT5_EDITOR.prototype={_Design2Source:function(){var a="table tbody tr td th ol ul li div".split(" ");if("0"==this._config.sourceViewtype||"3"==this._config.sourceViewtype)a=[];var b="",c=[];"0"==this._config.keepOriginalHtml&&(c=replaceWhiteSpaceStyleNodeInDesign2Source(this._BODY));removeFakeLineHeight(this._BODY);setMatchSelectedValue(this._BODY);setMatchInputValue(this._BODY);adjustInputNodeForFF(this._DOC,!1);setEmptyTagWhiteSpace(this);if("1"==this._config.keepOriginalHtml)b=this._BODY.innerHTML;
else if(this._BODY.hasChildNodes())for(var d=this._BODY.childNodes.length,e=0;e<d;e++){var f=this._BODY.childNodes[e];if(f)if(1===f.nodeType){var g=f.tagName.toLowerCase(),h=f.outerHTML;if("script"==g)h=h.replace(/<script([^>]+?)>[\s]+/gi,"<script$1>\r\n"),h=h.replace(/\;[\s]+/gi,";\r\n");else if("1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)h=removeCRLFChar(h);if("table"==g||"ol"==g||"ul"==g||"dextmark"==g)b+=h;else{if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&
"p"==g&&""==(f.innerText||f.textContent))for(;f="(<span[^>]*>)(?:\\s|<br>|<br />|  | |)(</span>)","0"==this._config.removeEmptyTagReplaceDefaultParagraphValue&&(f="(<span[^>]*>)(?:\\s|  | |)(</span>)"),f=new RegExp(f,"gim"),h=h.replace(f,"$1"+unescape("%u200B")+"</span>"),0!=f.test(h););b+=(""!=b?"\r\n":"")+h}}else{h=f.nodeValue;if("1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)h="#comment"!=f.nodeName?removeCRLFChar(h):"0"==this._config.removeComment?void 0!=f.data?"\x3c!--"+
f.data+"--\x3e":void 0!=f.nodeValue?"\x3c!--"+f.nodeValue+"--\x3e":"":"";b+=(""!=b?"\r\n":"")+h}else if(b=this._BODY.innerHTML,"1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)b=removeCRLFChar(b)}else if(b=this._BODY.innerHTML,"1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)b=removeCRLFChar(b);b=replaceLineBreak(this,b);"0"==this._config.applyStyleEmptyTag&&(b=RemoveUnnecessaryChar(b),b=CleanZeroChar(b));"1"==this._config.sourceViewtypeEmptyTagMode&&(b=DEXTTOP.DEXT5.util.replaceBrOrSpaceToNbspString(b,
"p"));"0"==this._config.keepOriginalHtml&&(b=b.replace(/\t/g,""));"3"==this._config.sourceViewtype&&(b=DEXTTOP.DEXT5.util.pretty.html(b,{indent_with_tabs:!0,unformatted:this._config.sourceViewtype_unformatted}));d="";if("0"==this._config.keepOriginalHtml)for(e=0,h=a.length;e<h;e++)d=a[e],f=new RegExp("(<"+d+"(\"[^\"]*\"|'[^']*'|[^'\">])*>)","gi"),g=new RegExp("</"+d+">","ig"),"tbody"==d?(b=b.replace(f,function(a,b){return"\r\n\t"+b+"\r\n"}),b=b.replace(g,"\r\n\t</"+d+">")):"li"==d?b=b.replace(f,function(a,
b){return"\r\n\t"+b}):"tr"==d?(b=b.replace(f,function(a,b){return"\r\n\t\t"+b+""}),b=b.replace(g,"\r\n\t\t</"+d+">")):"td"==d||"th"==d?(b=b.replace(f,function(a,b){return"\r\n\t\t\t"+b+"\r\n\t\t\t\t"}),b=b.replace(g,"\r\n\t\t\t</"+d+">")):"table"==d||"ol"==d||"ul"==d?(b=b.replace(f,function(a,b){return"\r\n"+b+""}),b=b.replace(g,"\r\n</"+d+">\r\n")):b=b.replace(f,function(a,b){return"\r\n"+b+""});b=changeRealTagToReplaceString(b);"0"==this._config.keepOriginalHtml&&(b=DEXTTOP.DEXT5.browser.ie&&9<=
DEXTTOP.DEXT5.browser.ieVersion?b.replace(/\r?\n?\r?\n/g,"\r\n"):b.replace(/\r?\n?\r?\n/g,"\n"),b=restoreWhiteSpaceStyleNodeInDesign2Source(b,c));b=changeReplaceStringToRealTag(b);b=DEXTTOP.DEXT5.util.trim(b);"0"==DEXTTOP.G_CURREDITOR._config.viewImgBase64Source&&(b=DEXTTOP.DEXT5.util.ImageSrcConvert(b,!0,DEXTTOP.G_CURREDITOR.ID));try{var m=G_DEPlugin.customliststyle;m&&(b=m.convertForExportHtml(b))}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}"1"==DEXTTOP.G_CURREDITOR._config.xhtml_value&&
(b=DEXTTOP.DEXT5.util.html2xhtml(b));this._EDITOR.source.value=b;a=this._EDITOR.source;a.focus();"setSelectionRange"in a?a.setSelectionRange(0,0):"createTextRange"in a&&a.createTextRange().moveStart("character",0)},_Design2Preview:function(){changeBodyImageProperty(!0);G_BodyFit.noncreationAreaBackgroundStatus&&setBodyFitStyle(DEXTTOP.G_CURREDITOR,!0);setHtmlToPreview(this);setFocusTopWindow()},_Design2Text:function(){for(var a=["style","title"],b=a.length,c=0;c<b;c++)for(var d=this._BODY.getElementsByTagName(a[c]),
e=d.length-1;0<=e;e--)d[e].parentNode.removeChild(d[e]);a=this._BODY.innerHTML;a=a.replace(/\r/g,"");a=a.replace(/[\n|\t]/g,"");a=a.replace(/[\v|\f]/g,"");a=a.replace(/<p><br><\/p>/gi,"\n");a=a.replace(/<P>&nbsp;<\/P>/gi,"\n");a=a.replace(/<br(\s)*\/?>/gi,"\n");a=a.replace(/<br(\s[^\/]*)?>/gi,"\n");a=a.replace(/<\/p(\s[^\/]*)?>/gi,"\n");a=a.replace(/<\/li(\s[^\/]*)?>/gi,"\n");a=a.replace(/<\/tr(\s[^\/]*)?>/gi,"\n");a=a.replace(/<\/h[1-5](\s[^\/]*)?>/gi,"\n");nIdx=a.lastIndexOf("\n");-1<nIdx&&"\n"==
a.substring(nIdx)&&(a=a.substring(0,nIdx));a=removeStripTags(a,null);a=unhtmlSpecialChars(a);this._EDITOR.text.value=a;a=this._EDITOR.text;try{a.focus()}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},getEditorMode:function(){return this._currentMode},setChangeMode:function(a){clearAllFormControlSelected();var b=this.getEditorMode();if(b!=a)if(this._newMode=a,"1"!=this._config.formMode&&"0"!=this._config.userTableLock.use&&IsExistTableLock(this)&&"0"==this._config.userTableLock.allowChangeMode&&
(-1<a.indexOf("text")||-1<a.indexOf("source")))alert(dext5_lang.msg.notChangeMode);else{var c=!0;("top_text"==a||"text"==a)&&DEXTTOP.DEXT5.ShowTextChangeAlert&&(c=confirm(dext5_lang.msg.changeTextMode));if(c){var c=this._setting.word_break_type,d=this._setting.word_wrap_type;if(null==this._EDITOR.preview){var e=document.getElementById("ue_editor_holder_"+this.ID),c=createEditorIframe(this._config,e,"dext5_preview_"+this.ID,dext5_lang.iframe_title.preview,this._docType[this._setting.doctype],this._setting.encoding,
this._setting.lang,this._setting.xmlnsname,this._setting.font_family,this._setting.font_size,this._setting.line_height,c,d);c.style.width="0px";c.style.height="0px";c.style.display="none";this._EDITOR.preview=document.getElementById("dext5_preview_"+this.ID)}ClearDraggingTableCellSelected();Mouse_Status=Mouse_IsPlain;g_findRepalceRange=ActiveCurrTable=DrageStartCell=null;this._iconSelected();for(var e=null,f=["top_design","top_source","top_preview","top_text"],c=0,d=f.length;c<d;c++)e=document.getElementById("ue_"+
this.ID+f[c]),null!=e&&((0>a.indexOf("top_")?"top_"+a:a)==f[c]?e.className="on":e.className="");var g=null,e=null,f=["design","source","preview","text"];a=a.replace("top_","");"design"!=a&&this._iconEnable("allDisable");c=0;for(d=f.length;c<d;c++)if(g=document.getElementById("ue_"+this.ID+f[c]),e=document.getElementById("dext5_"+f[c]+"_"+this.ID),null!=g||-1<(","+this._config.toolBar1.join(",")+",").indexOf("status_")||-1<(","+this._config.toolBar2.join(",")+",").indexOf("status_"))if(a==f[c]){null!=
g&&(g.className=this._config.style.skinName,g.getElementsByTagName("A")[0].className="color_on",g.style.backgroundImage="url("+this._config.webPath.image+"skin/"+this._config.style.skinName+"/ue_btn_bg.gif)");if("source"==a||"text"==a){try{e.focus()}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}g=this._defaultHeight;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks?g-=5:DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(g-=3);
e.style.height=g+"px";e.height=g+"px"}else e.style.height="100%";e.style.width="100%";e.style.display="";e.style.overflow="";"design"==a&&(this._LastRange=null,setFocusToBody())}else null!=g&&(g.className="",g.getElementsByTagName("A")[0].className="",g.style.backgroundImage=""),e.style.width="0px",e.style.height="0px",e.style.display="none",e.style.overflow="hidden",e.blur();c=document.getElementById("ue_diabled_div_"+this.ID);"BackCompat"==document.compatMode&&(c.style.height=document.getElementById("ue_toolbar_"+
G_USE_EDITOR_ID).scrollHeight+"px");document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="relative";"design"==a?(-1<(","+this._config.toolBar1.join(",")+",").indexOf("status_")||-1<(","+this._config.toolBar2.join(",")+",").indexOf("status_")?"1"==this._config.top_menu||isViewMode(this)||(c=document.getElementById("ue_top_menu_diabled_div_"+this.ID),c.className=c.className.replace(" tm_"+this._config.style.skinName,""),c.style.width="0px"):c.style.width="0px",document.getElementById("ue_toolbar_"+
G_USE_EDITOR_ID).style.position=""):-1<(","+this._config.toolBar1.join(",")+",").indexOf("status_")||-1<(","+this._config.toolBar2.join(",")+",").indexOf("status_")?"1"==this._config.top_menu||isViewMode(this)||(c=document.getElementById("ue_top_menu_diabled_div_"+this.ID),0>c.className.indexOf("tm_"+this._config.style.skinName)&&(c.className=c.className+" tm_"+this._config.style.skinName),c.style.width=document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).scrollWidth-2+"px"):c.style.width=document.getElementById("ue_toolbar_"+
G_USE_EDITOR_ID).scrollWidth+"px";c=document.getElementById("dext_ruler_vertical_disabled_"+this.ID);null!=c&&(c.style.display="design"==a?"":"block");getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear();"design"==b&&"design"!=a&&DEXTTOP.G_CURREDITOR.ShowTableBorder&&command_showTableBorder(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR);var m=this,c=function(a){null!=m._config.zoomList&&(a?(document.getElementById("zoom_"+m.ID+"_holder").style.display=
"","1"==m._config.wordCount.use&&(document.getElementById("word_count_"+m.ID+"_holder").style.textAlign="")):(document.getElementById("zoom_"+m.ID+"_holder").style.display="none","1"==m._config.wordCount.use&&(document.getElementById("word_count_"+m.ID+"_holder").style.textAlign="right")))};"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&(DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&hyperLinkOut(),DEXTTOP.G_CURREDITOR.isAOver.openHelp&&hyperHelpClose());try{for(var q in G_DEPlugin)if("function"===
typeof G_DEPlugin[q].onBeforeEditorChangeMode)G_DEPlugin[q].onBeforeEditorChangeMode({currMode:b,newMode:a})}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}switch(b){case "design":setRemoveClass(["td","th"],["DEXT_dot"]);switch(a){case "source":"1"==this._config.useSelectionMark&&makeRangeSelectionMarkInDesign();ReplaceImageToRealObject();"1"==this._config.formMode&&ReplaceCustomDataToRealEvent();this._Design2Source();c(!1);break;case "preview":ReplaceImageToRealObject();"1"==this._config.formMode&&
ReplaceCustomDataToRealEvent();this._Design2Preview();break;case "text":this._Design2Text(),c(!1)}break;case "source":_value=this._EDITOR.source.value;_value=xssReplaceScript(null,_value);"1"==this._config.useSelectionMark&&"design"==a&&(this._EDITOR.source.value=_value,makeRangeSelectionMarkInSource(this._EDITOR.source),_value=this._EDITOR.source.value);"0"==this._config.keepOriginalHtml&&(_value=_value.replace(/\t/g,""),_value=removeCRLFChar(_value));"1"!=DEXTTOP.G_CURREDITOR._config.plugInUse&&
(_value=DEXTTOP.DEXT5.util.removeLocalFileImage(_value));"0"==DEXTTOP.G_CURREDITOR._config.viewImgBase64Source&&(_value=DEXTTOP.DEXT5.util.ImageSrcConvert(_value,!1,DEXTTOP.G_CURREDITOR.ID));var u,v,w,y,x;"preview"==a&&"1"==this._config.tableAutoAdjustInSetHtml&&(u=document.getElementById("dext5_design_"+this.ID),v=u.style.width,w=u.style.height,u.style.width="100%",u.style.height="100%",y=u.style.display,x=u.style.overflow,u.style.display="",u.style.overflow="");DEXTTOP.DEXT5.setBodyValue(_value,
"",!0,!0);"preview"==a&&"1"==this._config.tableAutoAdjustInSetHtml&&(u.style.width=v,u.style.height=w,u.style.display=y,u.style.overflow=x);u=this.Frame;showRuler(u.editor);switch(a){case "design":c(!0);"1"==this._config.formMode?(ReplaceRealEventToCustomData(),ReplaceRealObjectToImage(!1)):ReplaceRealObjectToImage();setAddClass(["td","th"],["DEXT_dot"]);break;case "preview":ReplaceImageToRealObject();"1"==this._config.formMode&&ReplaceCustomDataToRealEvent();setRemoveClass(["td","th"],["DEXT_dot"]);
this._Design2Preview();c(!0);break;case "text":this._Design2Text()}break;case "preview":u=this.Frame;showRuler(u.editor);ClearPreViewContent(u.editor);switch(a){case "design":FixFlashError(this);"1"==this._config.formMode?(ReplaceRealEventToCustomData(),ReplaceRealObjectToImage(!1)):ReplaceRealObjectToImage();setAddClass(["td","th"],["DEXT_dot"]);try{this._iconEnable(""),setFocusToBody(),setFocusChildForStyle(this._BODY)}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}break;case "source":this._Design2Source();
c(!1);break;case "text":this._Design2Text(),c(!1)}break;case "text":switch(_value=this._EDITOR.text.value,_value=htmlSpecialChars(_value),_value=addLineBreaker(this._config.enterTag,_value),DEXTTOP.DEXT5.setBodyValue(_value,"",!0,!0,!0),u=this.Frame,showRuler(u.editor),a){case "design":c(!0);break;case "source":this._Design2Source();break;case "preview":this._Design2Preview(),c(!0)}}this._currentMode=a;null!=m._config.zoomList&&command_zoom(m.ID);"1"==this._config.useSelectionMark&&-1<b.indexOf("design")&&
-1<a.indexOf("source")&&setRangeSelectionMarkInSource(this._EDITOR.source);if(-1<a.indexOf("design")){"1"!=this._config.useSelectionMark&&setFocusChildForStyle(DEXTTOP.G_CURREDITOR._BODY);try{contentChangeEventWrapper()}catch(B){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}"2"==DEXTTOP.G_CURREDITOR._config.undoMode&&(DEXTTOP.G_CURREDITOR.UndoManager.reset(),"2"==DEXTTOP.G_CURREDITOR._config.undoMode&&setTimeout(function(){DEXTTOP.G_CURREDITOR.UndoManager.putUndo({isInit:!0})},1))}-1==
a.indexOf("source")&&"1"==this._config.autoBodyFit&&G_BodyFit.noncreationAreaBackgroundStatus&&setBodyFitStyle(this,!0);try{for(q in G_DEPlugin)if("function"===typeof G_DEPlugin[q].onAfterEditorChangeMode)G_DEPlugin[q].onAfterEditorChangeMode({currMode:b,newMode:a})}catch(D){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}setTimeout(function(){try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterChangeMode?DEXTTOP.G_CURREDITOR._config.event.afterChangeMode(a,b,DEXTTOP.G_CURREDITOR.ID):
"function"==typeof DEXTTOP.DEXTWIN.dext_editor_afterchangemode_event&&DEXTTOP.DEXTWIN.dext_editor_afterchangemode_event(a,b,DEXTTOP.G_CURREDITOR.ID)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},100)}(-1<this._config.toolBar1.indexOf("status_"+a)||-1<this._config.toolBar2.indexOf("status_"+a))&&this._statusToolBarIconSelect(m.ID,"status_"+a);"design"!=a&&(-1<(","+this._config.toolBar1.join(",")+",").indexOf("status_")||-1<(","+this._config.toolBar2.join(",")+",").indexOf("status_"))&&
this._topMenuDisbleCheck();onChange({editor:DEXTTOP.G_CURREDITOR})}},start:function(){var a=this._config;G_AddOrRemovedNodesObserver=new NodesObserver;"rtl"==a.direction.ui&&document.documentElement.setAttribute("dir","rtl");setZoomValueToBody(document,this);this.setValueIsBusy=!0;if("1"==a.autoMoveInitFocus.use){this.autoMoveInitFocusData.targetDocument=document;a.autoMoveInitFocus.targetWindow&&(this.autoMoveInitFocusData.targetDocument=a.autoMoveInitFocus.targetWindow.document,a.autoMoveInitFocus.targetWindow=
null);var b=this.autoMoveInitFocusData.targetDocument.activeElement;b&&(this.autoMoveInitFocusData.targetNode=b)}for(var c=a.toolBar1.length,d=a.toolBar2.length,e=[],c=a.toolBar1.length,d=a.toolBar2.length,f=0;f<c;f++)b=a.toolBar1[f],0==b.indexOf("p_")&&(b=b.split("_"),e.push(b[1]));for(c=0;c<d;c++)b=a.toolBar2[c],0==b.indexOf("p_")&&(b=b.split("_"),e.push(b[1]));d=0;for(c=a.pluginToolExArr.length;d<c;d++)b=a.pluginToolExArr[d],e.push(b);var g=e.length,h=0,m=function(){loadPluginJs(e[h],function(){h++;
h<g?m():_dext_editor._setEditorIcon()})};0<g?m():_dext_editor._setEditorIcon()},_setEditorIcon:function(){var a=_dext_editor,b=a._config.style.skinName,c=a._config.webPath.image+"skin/"+b,d=a._config.toolBar1,e=a._config.toolBar2;a.____.p=a._config[R[28]+R[21]+R[18]+R[11]+"u"+R[17]+R[14]+String.fromCharCode(75)+R[12]+String.fromCharCode(121)];_7_=a._config[String.fromCharCode(76)+T[10]+R[17]+R[12]+T[11]+T[4]+String.fromCharCode(75)+T[2]+T[7]];a.____.l=_L__.DE(_7_);try{a.____.l=a.____.l.split("|"),
_0_=a.____.l,_1_=a.____.p}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}a._dextSetting();if("1"==a._config.usePersonalSetting&&DEXTTOP.DEXT5.browser.LocalStorageSupported){var g=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage("dext_personal_setting");g&&""!=g.fontFamily&&void 0!=g.fontFamily&&(this._setting.font_family=g.fontFamily);g&&""!=g.fontSize&&void 0!=g.fontSize&&(this._setting.font_size=g.fontSize);g&&""!=g.lineHeight&&void 0!=g.lineHeight&&(this._setting.line_height=g.lineHeight);
g&&""!=g.pasteToImage&&void 0!=g.pasteToImage&&"-1"!=g.pasteToImage&&(a._config.pasteToImage=g.pasteToImage);g&&""!=g.pasteToImagePopupMode&&void 0!=g.pasteToImagePopupMode&&(a._config.pasteToImagePopupMode=g.pasteToImagePopupMode)}a.remove_item=a._config.removeItem;-1<a._config.disableInsertImage.indexOf(",image,")&&null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)&&
a.remove_item.push("image_create");!getApplyDragResize(a)&&(0==DEXTTOP.DEXT5.browser.ie||11<DEXTTOP.DEXT5.browser.ieVersion)&&a.remove_item.push("table_selection");DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&(a.remove_item.push("format_painter"),a.remove_item.push("apply_format"));a.remove_item.push("grid");"1"==a._config.paste_image_base64_remove&&(a.remove_item.push("paste_to_image"),a.remove_item.push("paste_to_image_detail"));a.remove_context_item=a._config.removeContextItem;
(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)&&a.remove_item.push("full_screen");DEXTTOP.DEXTWIN!=top&&"1"!=DEXTTOP.G_CURREDITOR._config.frameFullScreen&&a.remove_item.push("full_screen");if(""!=a._config.xss_remove_tags){g=a._config.xss_remove_tags.toLowerCase();-1<g.indexOf("iframe")&&(a.remove_item.push("iframe_create"),a.remove_item.push("insert_link_media"));if(-1<g.indexOf("object")||-1<g.indexOf("embed"))a.remove_item.push("media_create"),a.remove_item.push("flash_create");-1<g.indexOf("video")&&
a.remove_item.push("video")}null===a._setting.auto_save&&"1"!=a._config.setAutoSave.useManuallySave&&a.remove_item.push("load_auto_save");"0"==a._config.setAutoSave.useManuallySave&&a.remove_item.push("manually_temp_save");0==a._config.ruler.use&&a.remove_item.push("ruler");G_BodyFit.widthFixableStatus||a.remove_item.push("body_fit");"0"==a._config.useMiniImageEditor&&a.remove_item.push("mini_photo_editor");"0"==a._config.stickyTable&&a.remove_item.push("sticky_table");"0"==a._config.stickyTopRow&&
a.remove_item.push("sticky_top_row");"0"==a._config.stickyFirstColumn&&a.remove_item.push("sticky_first_column");"1"==a._config.plugInUse&&"1"==a._config.imageEditorUse&&0!=DEXTTOP.DEXT5.browser.ie||a.remove_item.push("image_editor");("ieplugin"==a._config.runtimes||DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion)&&a.remove_item.push("photo_editor");"1"!=a._config.formMode&&(a.remove_item.push("table_lock"),a.remove_item.push("cell_lock"),a.remove_item.push("table_lock_property"));"1"!=
a._config.plugInUse&&(a.remove_item.push("word_transform"),a.remove_item.push("save_as"));if(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion||"Windows"==DEXTTOP.DEXT5.UserAgent.os.name&&DEXTTOP.DEXT5.browser.safari)a.remove_item.push("video"),a.remove_item.push("placeholder");if(!DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.ie&&11<DEXTTOP.DEXT5.browser.ieVersion)a.remove_item.push("spell_check"),0==canAccessClipboardEnv()&&a.remove_item.push("text_paste");(DEXTTOP.DEXT5.browser.mobile||
DEXTTOP.DEXT5.browser.safari||DEXTTOP.DEXT5.browser.ie&&10>DEXTTOP.DEXT5.browser.ieVersion&&"1"!=a._config.plugInUse)&&a.remove_item.push("save_as_image");var h="",m="",q=isViewMode(a),m=m+('<div id="ue_editor_main_'+a.ID+'" class="DEXT_fiVe_EdiTor" style="z-index:'+G_MAIN_ZINDEX+'; width:100%; "  oncontextmenu="return false">'),g=a._config.statusBarItem.length;0==g&&(a._config.status_bar="1");h="";h="1"==a._config.top_status_bar||q?h+"height:1px;":h+"height:28px;";if("1"==a._config.top_status_bar||
q)h+="display:none;";""!=h&&(h=" style='"+h+"'");for(var m=m+("<div id='dext_topstatusbar_"+a.ID+"' class='ue_as DEXT_fiVe_EdiTor_TopStatusBar_"+b+"'"+h+">"),m=m+("    <ul class='"+b+"'>"),h=a._config.statusBarItem,t=0;t<h.length;t++){var u=h[t],u=DEXTTOP.DEXT5.util.trim(u).toLowerCase(),v="";a.getEditorMode()==u.replace("top_","")&&(v='class="on"');m+=" <li "+v+' id="ue_'+a.ID+"top_"+u+'"><a href="javascript:void(0);">DEXT_Top_Status</a></li>'}m+="    </ul></div>";m+='<div onselectstart="return false;" id="ue_toolbar_'+
a.ID+'" style="width:100%" class="ue_as">';h=a._makeEditorTopMenu();m+=h;h="";DEXTTOP.DEXT5.browser.ie&&(7>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)&&(h="margin-bottom:-2px;");m="3"==a._config.tool_bar||isViewMode(a)?m+('\t\t<table id="dext_toolbar_'+a.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table ue_tg_'+b+'" style="display:none; '+h+'">'):m+('\t\t<table id="dext_toolbar_'+a.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table ue_tg_'+b+'" style="'+
h+'">');m+="\t\t\t<tr>";m="mono"==b?m+'\t\t\t\t<td style="">':"1"==a._config.tool_bar_grouping?m+('\t\t\t\t<td style="background-image:url('+c+'/ue_tbg.gif);">'):m+('\t\t\t\t<td style="background-image:url('+c+"/ue_tbg01.gif);"+(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion?"":"background-size: auto 100%;")+'">');m+='\t\t\t\t\t<table id="table_gecko_'+a.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table01 toolbar_table" ';m+=">";h=d.length;t=e.length;0==h&&0==t?a._config.tool_bar=
"3":0==h?a._config.tool_bar="1":0==t&&(a._config.tool_bar="2");h=a._makeEditorIcon(d,"1");m+=h;h=a._makeEditorIcon(e,"2");m+=h;h=a._makeEditorFormBar();m+=h;if("1"==a._config.ruler.use){m+="<tr>";d=18;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(d+=1);var w=G_Ruler.rulerPositionLen,m=m+('<td class="ue_tdb_'+b+'01" id="dext_tab_tool3_'+a.ID+'" style="padding:0px; height:'+d+'px; display:none; position:relative; overflow:visible; border:0px;">');"2"==a._config.ruler.mode&&--w;"2"==
a._config.ruler.mode&&(m+='<div id="ruler_pointer_value_'+a.ID+'" style="position:absolute; display:none;" class="ruler_pointer_value"></div>');m+='<div style="position: relative; overflow: hidden;height: 18px;">';m+='<div id="dext_ruler_horizontal_scroll_'+a.ID+'" class="ruler_horizontal_scroll"><div id="h_minus_ruler_area" style="display: inline;"></div><div id="h_plus_ruler_area" style="display: inline;"></div></div>';for(d=0;d<w;d++)m="2"==a._config.ruler.mode?1==d?m+('<img id="dext_ruler_point_'+
d+"_"+a.ID+'" src="../images/bg/point2.gif" title="'+dext5_lang.setting["ruler"+d+"_desc"]+'" alt="" style="vertical-align:top; border:0px; width:14px; height:9px; margin:0 0 0 -7; display:none; position:absolute; top:0px; z-index:'+(G_MAIN_ZINDEX+101)+';" />'):m+('<img id="dext_ruler_point_'+d+"_"+a.ID+'" src="../images/bg/point3.gif" title="'+dext5_lang.setting["ruler"+d+"_desc"]+'" alt="" style="vertical-align:bottom; border:0px; width:14px; height:9px; margin:0 0 0 -7; display:none; position:absolute; bottom:0px; z-index:'+
(G_MAIN_ZINDEX+101)+';" />'):m+('<img id="dext_ruler_point_'+d+"_"+a.ID+'" src="../images/bg/point.gif" title="'+dext5_lang.setting["ruler"+d+"_desc"]+'" alt="" style="vertical-align:top; border:0px; width:14px; height:9px; margin:0 0 0 -7; display:none; position:absolute; top:-1px; z-index:'+(G_MAIN_ZINDEX+101)+';" />');"2"==a._config.ruler.mode&&(m+='<div id="dext_ruler_area_0" style="background-color:#dddddd; background-color: rgba(0,0,0,0.18); filter:alpha(opacity=70); opacity:0.70; position:absolute; z-index:'+
(G_MAIN_ZINDEX+100)+'; height:18px; position:absolute; width:10px; left:0px; top:0px;"></div>',d=G_Ruler.maxRulerPosition,e=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXTWIN.document.getElementById("dext_frame_holder"+DEXTTOP.G_CURREDITOR.ID).style.width)-d,m+='<div id="dext_ruler_area_1" style="background-color:#dddddd; background-color: rgba(0,0,0,0.18); filter:alpha(opacity=70); opacity:0.70; position:absolute; z-index:'+(G_MAIN_ZINDEX+100)+"; top:0px; height:18px; position:absolute; width:"+e+"px; left:"+
d+'px;"></div>',"1"==a._config.ruler.useMouseGuide&&(m+='<div id="dext_ruler_mouse_guide_'+a.ID+'" class="ruler_mouse_guide" ></div>'));m+="</div>";m+="</div>";m+="</td>";m+="</tr>";"2"==a._config.ruler.mode&&(m+="<tr>",m+='<td class="ruler_'+b+'" id="dext_tab_tool4_'+a.ID+'" style="margin-top:-1px; padding:0px; height:6px; background-color:#ffffff; background-repeat:no-repeat; display:none; position:relative; overflow:visible">',m+='<img id="dext_ruler_point_3_'+a.ID+'" src="../images/bg/point_square.gif" title="'+
dext5_lang.setting.ruler3_desc+'" alt="" style="vertical-align:bottom; border:0px; width:14px; height:7px; margin:0 0 0 -7; display:none; position:absolute; bottom:0px; z-index:'+(G_MAIN_ZINDEX+101)+';" />',m+="</td>",m+="</tr>")}m+="\t\t\t\t\t</table>";m+="\t\t\t\t</td>";m+="\t\t\t</tr>";m+="\t\t</table>";m+='\t<div id="ue_diabled_div_'+a.ID+'" style="background-color:#ffffff; filter:alpha(opacity=50); opacity:0.50; position:absolute; z-index:'+(G_MAIN_ZINDEX+1E3)+'; left:0px; top:0px; width:0px; height:100%;"></div>';
"2"==a._config.ruler.mode&&(m+='\t<div id="ue_ruler_back_div" style="background-color:#ffffff; filter:alpha(opacity=0); opacity:0; position:absolute; z-index:'+(G_MAIN_ZINDEX+100)+'; left:0px; top:0px; width:100%; height:100%; display:none;"></div>');"1"==a._config.tool_bar_grouping&&(m+='<div class="tool_bar_grouping_box" id="dext_div_tool_bar_grouping_box1" style="display:none; z-index:'+(G_MAIN_ZINDEX+900)+';">',m+='<div class="tool_bar_grouping_list tool_bar_grouping_list_'+a._config.style.skinName+
'" id="dext_tool_bar_grouping_list1">',m+='<ul id="ul_tool_bar_grouping_list1">',m+="</ul>",m+="</div>",m+="</div>",m+='<div class="tool_bar_grouping_box" id="dext_div_tool_bar_grouping_box2" style="display:none; z-index:'+(G_MAIN_ZINDEX+900)+';">',m+='<div class="tool_bar_grouping_list tool_bar_grouping_list_'+a._config.style.skinName+'" id="dext_tool_bar_grouping_list2">',m+='<ul id="ul_tool_bar_grouping_list2">',m+="</ul>",m+="</div>",m+="</div>");m+="</div>";"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&
(m+='<div class="hyper_link_help_box" id="dext_div_hyper_link_help" style="display:none; z-index:'+(G_MAIN_ZINDEX+900)+';">',m+='<div class="'+a._config.style.skinName+'">',m+='<p id="dext_div_hyper_link_help_content">',m+="</p>",m+='<p class="content">'+dext5_lang.hyperlink.open,m+="</p>",m+="</div>",m+="</div>");if("1"==a._config.ruler.use){w=G_Ruler.rulerPositionLen;m+='<div id="dext_ruler_pointline_div">';for(d=0;d<w;d++)e=a._config.ruler.guideLineColor,h=a._config.ruler.guideLineStyle,"2"==a._config.ruler.mode&&
(e=a._config.ruler.moveGuideLineColor,h=a._config.ruler.moveGuideLineStyle),m+='<div id="dext_ruler_pointline_'+d+"_"+a.ID+'" style="position:absolute; z-index: 9999; border-left:'+h+" 1px "+e+'; display:none;"></div>';m+="</div>"}"2"==a._config.ruler.mode&&"0"==a._config.useNoncreationAreaBackground&&(m+='<div id="dext_ruler_pointline_4_'+a.ID+'" style="position:absolute; left:'+G_Ruler.maxRulerPosition+"px; z-index: 9999; border-left:"+a._config.ruler.guideLineStyle+" 1px "+a._config.ruler.guideLineColor+
';"></div>');"1"==a._config.ruler.useVertical&&(m=G_Ruler.viewRulerStatus&&"edit"==a._config.mode?m+('<div id="dext_ruler_vertical_'+a.ID+'" class="ruler_vertical ruler_vertical_'+b+'" style="height: '+a.height+'px;"><div id="dext_ruler_vertical_scroll_'+a.ID+'" class="ruler_vertical_scroll'):m+('<div id="dext_ruler_vertical_'+a.ID+'" class="ruler_vertical ruler_vertical_'+b+'" style="height: '+a.height+'px; display:none;"><div id="dext_ruler_vertical_scroll_'+a.ID+'" class="ruler_vertical_scroll'),
DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&(m+=" ie8"),m+='" ><div id="v_minus_ruler_area" style="display: inline;"></div><div id="v_plus_ruler_area" style="display: inline;"></div></div>',"2"==a._config.ruler.mode&&(m+='<div id="dext_ruler_vertical_area_0_'+a.ID+'" class="ruler_vertical_unfocused" ></div><div id="dext_ruler_vertical_area_1_'+a.ID+'" class="ruler_vertical_unfocused" style="height:100%;"></div>'),m+='<div id="dext_ruler_vertical_disabled_'+a.ID+'" class="ruler_vertical_disabled"></div>',
m+="</div > ");"2"==a._config.horizontalLine.use&&(m+='<div id="dext_horizontal_line_'+a.ID+'"></div>');d=a._config.style.height.replace("px","");a._defaultHeight=d+"";m+='\t<div id="ue_editor_holder_'+a.ID+'" class="ue_editor_'+b+'_lr" ';if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)m="view"==a._config.mode&&"1"==a._config.view_mode_auto_height?m+' style="overflow:hidden;"':m+' style="overflow:scroll; -webkit-overflow-scrolling:touch;"';m+="\t></div>";m+='\t<div id="status_'+a.ID+'" class="ue_as" style="width:100%;">';
m="1"==a._config.status_bar||q||0==g?m+('\t\t<table id="dext_statusbar_'+a.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table_'+b+' status_table" style="background-image:url('+c+"/ue_gbg.gif); display:none; "):m+('\t\t<table id="dext_statusbar_'+a.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table_'+b+' status_table" style="background-image:url('+c+"/ue_gbg.gif); ");m+='">';m+='\t\t    <tr id="status_tr_'+a.ID+'" ';m+=">";m+="\t\t\t\t<td>";m+='\t\t\t\t\t<ul class="ue_btn_'+
b+'" id="dext_tab_status_'+a.ID+'">';if(0==g)m+=' <li class="" id="ue_'+a.ID+'design" style="visibility:hidden;"><a href="javascript:void(0);">DEXT_Status</a></li>';else for(h=a._config.statusBarItem,t=0;t<h.length;t++)u=h[t],u=DEXTTOP.DEXT5.util.trim(u).toLowerCase(),m+=' <li class="" id="ue_'+a.ID+u+'"><a href="javascript:void(0);">DEXT_Status</a></li>';m+="\t\t\t\t\t</ul>";m+='<ul class="ue_btn_'+b+'" style="float: right;">';m+='<li id="editor_temporarily_message" style="width: 120px; text-align:right; cursor:default; border-right:none; display:none;">';
m+="</li>";"1"==a._config.wordCount.use&&(m+='<li id="word_count_'+a.ID+'_holder" style="width: 300px; ',null==DEXTTOP.G_CURREDITOR._config.zoomList&&(m+="text-align: right; "),m+='cursor:default;"><span id="count_line_span_'+a.ID+'" style="margin-right:10px;"></span><span id="count_characters_span_'+a.ID+'" style="margin-right:10px;"></span></li>');null!=a._config.zoomList&&(m+='<li id="zoom_'+a.ID+'_holder" class="zoom_editor_holder"><span class="bottom_width_r"><textarea id="ue_'+a.ID+'zoom_text" title="'+
dext5_lang.icon.zoom_text+'" maxlength="5" rows="1" wrap="soft"></textarea>',m+='<a class="z_arrow" id="ue_'+a.ID+'zoom" href="javascript:void(0);">',m+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">',m+='\t\t<span id="dext_pan_zoom_'+a.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc;"></span>',m+="\t</span>",m+='</a><a class="z_plus" id="ue_'+a.ID+'zoom_plus" href="javascript:void(0);">',
m+='</a><a class="z_minus" id="ue_'+a.ID+'zoom_minus" href="javascript:void(0);"></a></span></li>');m+="</ul>";m+="\t\t\t\t</td>";m+="\t\t\t</tr>";m+="\t\t</table>";m+="\t</div>";m+="</div>";document.getElementById("editorContentArea").innerHTML=m;for(d=0;d<w;d++)m=document.getElementById("dext_ruler_point_"+d+"_"+a.ID),null!=m&&void 0!=m&&"2"!=a._config.ruler.mode&&(m.onmousedown=function(){return!1},m.unselectable="on");for(w=0;w<this.remove_item.length;w++)-1<this.remove_item[w].indexOf("detail")&&
(m=document.getElementById("dext_span_"+a.ID+this.remove_item[w]))&&(m.style.display="none");m=this._setting.word_break_type;q=this._setting.word_wrap_type;""==m&&(m="normal");""==q&&(q="normal");w=document.getElementById("ue_editor_holder_"+a.ID);createEditorIframe(a._config,w,"dext5_design_"+a.ID,dext5_lang.iframe_title.design,a._docType[a._setting.doctype],a._setting.encoding,a._setting.lang,a._setting.xmlnsname,a._setting.font_family,a._setting.font_size,a._setting.line_height,m,q);setEditorBorder(a);
m=document.createElement("label");m.id="dext5_source_label_"+a.ID;m.setAttribute("for","dext5_source_"+a.ID);m.className="blind";m.innerText=dext5_lang.iframe_title.source;w.appendChild(m);m=document.createElement("textarea");m.id="dext5_source_"+a.ID;m.title=dext5_lang.iframe_title.source;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion?m.style.cssText="padding: 0px !important":m.style.padding="0px";m.style.color="#111111";""!=a._config.editingAreaBgColor&&(m.style.backgroundColor=a._config.editingAreaBgColor);
m.style.width="0px";m.style.height="0px";m.style.display="none";m.style.borderWidth="0px";m.style.margin="0px 0px";m.className="DEXT_fiVe_EdiTor_source_editor_font";"1"==a._config.sourceViewtype&&("wrap"in m?m.wrap="off":"wordWrap"in m.style&&(m.style.wordWrap="normal"));w.appendChild(m);m=document.createElement("label");m.id="dext5_text_label_"+a.ID;m.setAttribute("for","dext5_text_"+a.ID);m.className="blind";m.innerText=dext5_lang.iframe_title.text;w.appendChild(m);m=document.createElement("textarea");
m.id="dext5_text_"+a.ID;m.title=dext5_lang.iframe_title.text;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion?m.style.cssText="padding: 0px !important":m.style.padding="0px";m.style.color="#111111";""!=a._config.editingAreaBgColor&&(m.style.backgroundColor=a._config.editingAreaBgColor);m.style.width="0px";m.style.height="0px";m.style.display="none";m.style.borderWidth="0px";m.style.margin="0px 0px";m.className="DEXT_fiVe_EdiTor_text_editor_font";w.appendChild(m);if(w=document.getElementById("ue_"+
a.ID+"design"))w.className=a._config.style.skinName,w.getElementsByTagName("A")[0].className="color_on",w.style.backgroundImage="url("+a._config.webPath.image+"skin/"+a._config.style.skinName+"/ue_btn_bg.gif)";setEditorHeight(a,!0);document.getElementById("ue_editor_holder_"+a.ID).style.height=0>a._defaultHeight?"0px":a._defaultHeight+"px";document.getElementById("dext_background")||(w=document.createElement("div"),w.setAttribute("id","dext_background"),w.style.zIndex=G_MAIN_ZINDEX+1E3,document.getElementsByTagName("body")[0].appendChild(w));
document.getElementById("dext_click_background")||(w=document.createElement("div"),w.setAttribute("id","dext_click_background"),w.style.zIndex=G_MAIN_ZINDEX+1E3,document.body.appendChild(w),DEXTTOP.DEXT5.util.addEvent(w,"click",function(){DEXT5_EDITOR.prototype.dialog._click_background()}),w.onmousedown=function(){return!1},w.unselectable="on");a._dextFormatting.init(a.ID);!DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion&&G_DEPlugin.customformatting&&G_DEPlugin.customformatting.init(a.ID);
a._dextLineHeight.init(a.ID);a._dextzoom.init(a.ID);if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.safari)w=null,0==!!DEXTTOP.DEXTDOC.getElementById("dext5_paste_temp_frame")&&(w=DEXTTOP.DEXTDOC.createElement("iframe"),w.id="dext5_paste_temp_frame",w.style.width="0px",w.style.height="0px",w.style.display="none",m="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",m=DEXTTOP.DEXT5.browser.ie&&
12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(m)+"}())":"",w.src=m,DEXTTOP.DEXTDOC.body.appendChild(w));if(w=document.getElementById("ue_"+a.ID+"design"))w.style.backgroundImage="url("+c+"/ue_btn_bg.gif)";a._setIconEvents();setToolbarScroll(a,!0);a._iconEnable("default");a._config.useServerLicense?DEXTTOP.DEXT5.util.checkServerLicense(a):(c=setTimeout(_fn_0,2E3),DEXTTOP.DEXT5.DEXTMULTIPLETIMEOUT.push(c));"1"==a._config.resize_bar&&0<g&&(DEXTTOP.DEXTWIN!=top&&
"1"!=a._config.frameResizeBar||0!=DEXTTOP.DEXT5.browser.mobile||0!=DEXTTOP.DEXT5.browser.iOS||a._setEditorResizeBar());if("1"==a._config.tool_bar_grouping){groupingIcon();c=document.getElementById("dext_span_"+a.ID+"tool_bar_grouping1");"mono"==b?(c.style.height="38px",c.style.marginTop="-6px",7==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks&&(c.style.height="39px")):c.style.height=DEXTTOP.DEXT5.browser.quirks?"29px":"27px";for(d=0;d<c.childNodes.length;d++)if(1==c.childNodes[d].nodeType&&
"a"==c.childNodes[d].tagName.toLowerCase()){c.childNodes[d].style.height=c.style.height;break}var y=document.getElementById("dext_div_tool_bar_grouping_box1"),g=function(){return function(b){DEXTTOP.G_CURREDITOR=a;"block"==x.style.display&&hideGroupingBox();if("block"==y.style.display)hideGroupingBox();else{if(DEXTTOP.DEXT5.browser.mobile||"mobile"==DEXTTOP.DEXT5.UserAgent.device.type)y.style.top="0px",y.style.left="0px";y.style.display="block";showGroupingBackground();setPositionGroupingDiv(1);var c=
y.getElementsByTagName("a"),d=c.length;if(0<d)var e=setInterval(function(){a.groupingBoxOpen&&(c[0].focus(),setFocusFirstAndLast2(c[0],c[d-1]),a.groupingBoxOpen=!1,clearInterval(e))},100)}}}();DEXTTOP.DEXT5.util.addEvent(c,"click",g);c=document.getElementById("dext_span_"+a.ID+"tool_bar_grouping2");"mono"==b?(c.style.height="37px",c.style.marginTop="-6px",7==DEXTTOP.DEXT5.browser.ieVersion&&(c.style.marginTop="-7px",DEXTTOP.DEXT5.browser.quirks&&(c.style.height="38px"))):(c.style.height="28px",10>
DEXTTOP.DEXT5.browser.ieVersion&&(7==DEXTTOP.DEXT5.browser.ieVersion?(c.style.height="27px",c.style.marginTop="-2px",DEXTTOP.DEXT5.browser.quirks&&(c.style.marginTop="0px")):c.style.marginTop="-1px"));for(d=0;d<c.childNodes.length;d++)if(1==c.childNodes[d].nodeType&&"a"==c.childNodes[d].tagName.toLowerCase()){c.childNodes[d].style.height=c.style.height;break}var x=document.getElementById("dext_div_tool_bar_grouping_box2"),b=function(){return function(b){DEXTTOP.G_CURREDITOR=a;"block"==y.style.display&&
hideGroupingBox();if("block"==x.style.display)hideGroupingBox();else{if(DEXTTOP.DEXT5.browser.mobile||"mobile"==DEXTTOP.DEXT5.UserAgent.device.type)x.style.top="0px",x.style.left="0px";x.style.display="block";showGroupingBackground();setPositionGroupingDiv(2);var c=x.getElementsByTagName("a"),d=c.length;if(0<d)var e=setInterval(function(){a.groupingBoxOpen&&(c[0].focus(),setFocusFirstAndLast2(c[0],c[d-1]),a.groupingBoxOpen=!1,clearInterval(e))},100)}}}();DEXTTOP.DEXT5.util.addEvent(c,"click",b);if(("1"==
a._config.pluginInstallType||"2"==a._config.pluginInstallType)&&G_dext5plugIn&&!G_dext5plugIn.productKey&&void 0==G_dext5plugIn.productKey)if("0"==a._config.usePluginInstallGuide)requestPluginInstall(window,document,a._config);else{if("0"==a._config.pluginInstallGuideType){var b=getDialogWindow(),z=getDialogDocument(),c={},c=getWindowClientSize(b),w="CSS1Compat"==z.compatMode?z.documentElement.scrollWidth:z.body.scrollWidth,m="CSS1Compat"==z.compatMode?z.documentElement.scrollHeight:z.body.scrollHeight,
g={},g=getWindowScrollPos(b);null==z.getElementById("d5editor_install_div_back")&&(q=z.createElement("div"),q.innerHTML='<div id="d5editor_install_div_back" style="background-color:white; filter:alpha(opacity=80); opacity:0.8; -moz-opacity:0.8; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=80); -khtml-opacity: 0.8; left: 0px; top: 0px; width: '+w+"px; height: "+m+"px; display: block; position: absolute; z-index: "+(a._config.pluginInstallGuideZIndex+1)+';"></div>',z.body.appendChild(q.firstChild));
null==z.getElementById("d5editor_install_div")&&(w=z.createElement("div"),m='<div id="d5editor_install_div" style="border:2px #0e639c solid; z-index:'+(a._config.pluginInstallGuideZIndex+5)+'; position:fixed; _position:absolute; overflow:hidden; width:600px; height:212px; background-color:white;">',m+='<iframe frameborder="0" src="'+a._config.webPath.pluginInstallGuide+'" style="position:absolute; width:600px; height:212px; border-width:0px;" title="Plugin Install Guide"></iframe>',w.innerHTML=m+
"</div>",m=[0,0],DEXTTOP.DEXT5.browser.quirks&&(m=g),w.firstChild.style.left=m[0]+c[0]/2-300+"px",w.firstChild.style.top=m[1]+c[1]/2-106+"px",DEXTTOP.DEXT5.installGuideResizeEvt=function(){try{var a=z.getElementById("install_div_back");if(a){var b="CSS1Compat"==z.compatMode?z.documentElement.scrollHeight:z.body.scrollHeight;a.style.width=("CSS1Compat"==z.compatMode?z.documentElement.scrollWidth:z.body.scrollWidth)+"px";a.style.height=b+"px"}}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},
DEXTTOP.DEXT5.util.addEvent(b,"resize",DEXTTOP.DEXT5.installGuideResizeEvt),z.body.appendChild(w))}else b=640,DEXTTOP.DEXT5.browser.ie&&(b-=4),0==!!DEXTTOP.DEXT5.loadedPluginPopup&&(DEXTTOP.DEXT5.loadedPluginPopup=!0,a.pluginInstallGuidePopup=Dext5_PopupCenter(a._config.webPath.pluginInstallGuide,"DEXT5_Plugin_Install_Guide",b,208,void 0,void 0,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no"));var B=setInterval(function(){if(G_dext5plugIn&&
(G_dext5plugIn.productKey||void 0!=G_dext5plugIn.productKey)){if(clearInterval(B),"1"==a._config.usePluginInstallGuide)if("1"==a._config.pluginInstallGuideType){if(null!=a.pluginInstallGuidePopup)try{a.pluginInstallGuidePopup.close()}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else try{closePluginInstall()}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else{var d=document.getElementById("dext5plugin");d&&(G_dext5plugIn=null,d.parentNode.removeChild(d),fn_createPluginObject(a._config));
document.getElementById("dext5plugin")&&(G_dext5plugIn=document.getElementById("dext5plugin"))}},200)}}if("2"==DEXTTOP.G_CURREDITOR._config.ruler.mode){var D=document.getElementById("dext_ruler_point_0_"+DEXTTOP.G_CURREDITOR.ID),A=document.getElementById("dext_ruler_point_1_"+DEXTTOP.G_CURREDITOR.ID),C=document.getElementById("dext_ruler_point_2_"+DEXTTOP.G_CURREDITOR.ID),E=document.getElementById("dext_ruler_point_3_"+DEXTTOP.G_CURREDITOR.ID);DEXTTOP.DEXT5.util.addEvent(D,"mouseover",function(){D.style.cursor=
"pointer"});DEXTTOP.DEXT5.util.addEvent(A,"mouseover",function(){A.style.cursor="pointer"});DEXTTOP.DEXT5.util.addEvent(C,"mouseover",function(){C.style.cursor="pointer"});DEXTTOP.DEXT5.util.addEvent(E,"mouseover",function(){E.style.cursor="pointer"});DEXTTOP.DEXT5.util.addEvent(D,"mousedown",rulerStartDrag);DEXTTOP.DEXT5.util.addEvent(A,"mousedown",rulerStartDrag);DEXTTOP.DEXT5.util.addEvent(C,"mousedown",rulerStartDrag);DEXTTOP.DEXT5.util.addEvent(E,"mousedown",rulerStartDrag)}},_setLazyLoadFrame:function(a){"1"!=
DEXTTOP.G_CURREDITOR._config.contextMenuDisable&&DEXT5_CONTEXT._create(a);"0"==DEXTTOP.G_CURREDITOR._config.top_menu&&DEXT5_TOPMENU._create(a);-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&1>DEXTTOP.G_CURREDITOR._config.imageQuality.quality&&(a=document.createElement("canvas"),a.id="dext5editor_imageCanvas",a.style.display="none",DEXTTOP.G_CURREDITOR._FRAMEWIN.document.body.appendChild(a))},_setEditorResizeBar:function(){DEXTTOP.G_CURREDITOR.dextResize=new DextResize(DEXTTOP.G_CURREDITOR);
DEXTTOP.G_CURREDITOR.dextResize.createStatusResizeBar();DEXTTOP.G_CURREDITOR.dextResize.apply(DEXTTOP.DEXTDOC)},_dextSetting:function(){this._setting.grid_color=this._config.gridColor;this._setting.grid_color_nm=this._config.gridColorName;this._setting.grid_spans=this._config.gridSpans;this._setting.grid_form=this._config.gridForm;this._setting.encoding=this._config.encoding;this._PageProp.encoding=this._setting.encoding;this._setting.word_break_type=DEXTTOP.DEXT5.util.getWordBreakStyle(this._config);
this._setting.word_wrap_type=DEXTTOP.DEXT5.util.getWordWrapStyle(this._config);this._setting.page_title=this._config.document.docTitle;this._setting.page_title&&""!=this._setting.page_title||(this._setting.page_title=dext5_lang.document.no_title);var a="";"1"==this._config.enforceDoctype?a="None":"2"==this._config.enforceDoctype?DEXTTOP.DEXT5.browser.ie?a="Auto":(a="None",this._config.enforceDoctype="1"):a=this._config.docType;this._setting.doctype=this._setting_DocType(a);this._PageProp.doctype=
this._setting.doctype;this._setting.xmlnsname=this._config.xmlnsname;this._PageProp.xmlnsname=this._setting.xmlnsname;this._setting.lang=this._config.lang;if((this._PageProp.lang=this._setting.lang)&&0<this._setting.lang.length){var a=document.getElementsByTagName("html")[0],b=this._setting.lang;-1<b.indexOf("-")&&(b=b.split("-")[0]);a.setAttribute("lang",b);a.setAttribute("xml:lang",b);0<this._setting.xmlnsname.length&&a.setAttribute("xmlns",this._setting.xmlnsname)}this._setting.font_family=this._config.defaultFontFamily;
this._setting.font_size=this._config.defaultFontSize;this._setting.line_height=this._config.defaultLineHeight;this._setting.show_font_real=this._config.showRealFont;a=getAutoSave(DEXTTOP.G_CURREDITOR);this._setting.auto_save=a;this._setting.auto_save_fn=null;"1"==this._config.useLineBreak&&"1"==this._config.saveLineBreakToLocalStorage&&DEXTTOP.DEXT5.browser.LocalStorageSupported&&((a=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage("dext_"+this.ID+"_line_break"))?(b=a.word_wrap_type,this._setting.word_break_type=
a.word_break_type,this._setting.word_wrap_type=b):(this._setting.word_break_type="1"==this._config.wordBreakType?"break-all":"2"==this._config.wordBreakType?"keep-all":"normal",this._setting.word_wrap_type="1"==this._config.wordWrapType?"break-word":"normal"));DEXTTOP.DEXT5.browser.LocalStorageSupported&&(this._setting.config_paste_to_image=this._config.pasteToImage);this._docType.Auto=DEXTTOP.DEXT5.util.getDocType(DEXTTOP.document);this._docType.None="";this._docType["XHTML 1.1"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">';
this._docType["XHTML 1.0 Transitional"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">';this._docType["XHTML 1.0 Strict"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">';this._docType["XHTML 1.0 Frameset"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">';this._docType["HTML 5"]="<!DOCTYPE html>";
this._docType["HTML 4.01 Transitional"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">';this._docType["HTML 4.01 Strict"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">';this._docType["HTML 4.01 Frameset"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">';this._docType["HTML 3.2"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">';this._docType["HTML 2.0"]=
'<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">'},_setting_DocType:function(a){for(var b="HTML 5",c="Auto;None;XHTML 1.1;XHTML 1.0 Transitional;XHTML 1.0 Strict;XHTML 1.0 Frameset;HTML 5;HTML 4.01 Transitional;HTML 4.01 Strict;HTML 4.01 Frameset;HTML 3.2;HTML 2.0".split(";"),d=c.length,e=0;e<d;e++)if(a==c[e]){b=a;break}return b},_makeEditorTopMenu:function(){var a=this._config.style.skinName,b="",c=this._config.topMenuItem.length;0==c&&(this._config.top_menu="1");if("1"==this._config.top_menu||isViewMode(this))b+=
'<table style="display:none; height:0px;" border="0" cellpadding="0" cellspacing="0" class="ue_tm tm_'+a+' top_menu_table" id="dext_menu_'+this.ID+'" >';else if(b+='<table border="0" cellpadding="0" cellspacing="0" class="ue_tm tm_'+a+' top_menu_table" id="dext_menu_'+this.ID+'" >',-1<(","+this._config.toolBar1.join(",")+",").indexOf("status_")||-1<(","+this._config.toolBar2.join(",")+",").indexOf("status_"))b+='<div id="ue_top_menu_diabled_div_'+this.ID+'" class="ue_tm" style="background-color:#ffffff; filter:alpha(opacity=50); opacity:0.50; position:absolute; z-index:'+
(G_MAIN_ZINDEX+1E3)+'; left:0px; top:0px; width:0px;"></div>';b+='<tr><td><ul id="dext_tab_menu_'+this.ID+'">';for(a=0;a<c;a++)var d=this._config.topMenuItem[a],d=DEXTTOP.DEXT5.util.trim(d).toLowerCase(),b=b+('<li id="ue_'+this.ID+d+'"><a href="javascript:void(0);" id="'+this.ID+":"+d+'">'+dext5_lang.top_menu[d]+"</a></li>");return b+="</ul></td></tr></table>"},_makeEditorIcon:function(a,b){var c=this._config.style.skinName,d=this._config.webPath.image,e=d+"skin/"+c,f="26px;";if("1"!=this._config.tool_bar_grouping||
"mono"!=c)DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion||(f="24px;");var g='<span class="ue_SM"><img style="margin:1px; padding: 0px; width: 11px; height: '+f+'" src="'+e+'/separator.gif" alt="" /></span>',f="",h=0,h=a.length,m=isViewMode(this),q="",t="";"1"==this._config.tool_bar_grouping||DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion||(q="height: auto; overflow: visible; white-space:normal;",t="background-size: auto 100%;");if("0"==b)f=f+"<tr>"+('\t<td class="ue_tdb_'+
c+'" style="padding: 1px 5px 0px 5px;" >');else if("1"==b){var f=f+('<tr id="tool1_'+this.ID+'">'),u="";DEXTTOP.DEXT5.browser.mobile&&"1"==this._config.useAutoToolbar&&(u="position:relative;");f="3"==this._config.tool_bar||"1"==this._config.tool_bar||m?"mono"==c?f+('\t<td class="ue_tdb_'+c+' txt_ip_blue" style="padding: 5px 5px 5px 5px; display:none;'+u+q+'" id="dext_tab_tool1_'+this.ID+'">'):f+('\t<td class="ue_tdb_'+c+' txt_ip_blue" style="padding: 1px 5px 0px 5px; display:none;'+u+q+'" id="dext_tab_tool1_'+
this.ID+'">'):"mono"==c?f+('\t<td class="ue_tdb_'+c+' txt_ip_blue" style="padding: 5px 5px 5px 5px;'+u+q+'" id="dext_tab_tool1_'+this.ID+'">'):f+('\t<td class="ue_tdb_'+c+' txt_ip_blue" style="padding: 1px 5px 0px 5px;'+u+q+'" id="dext_tab_tool1_'+this.ID+'">')}else f+='<tr id="tool2_'+this.ID+'">',u="",DEXTTOP.DEXT5.browser.mobile&&"1"==this._config.useAutoToolbar&&(u="position:relative;"),f="3"==this._config.tool_bar||"2"==this._config.tool_bar||m?"mono"==c?f+('\t<td class="ue_tdb_'+c+'01 txt_ip_blue" style="padding: 5px 5px 4px 5px; display:none;'+
u+q+'" id="dext_tab_tool2_'+this.ID+'">'):f+('\t<td class="ue_tdb_'+c+'01 txt_ip_blue" style="padding: 2px 5px 0px 5px; background-image:url('+e+"/ue_tbg01.gif); display:none;"+u+q+t+'" id="dext_tab_tool2_'+this.ID+'">'):"mono"==c?f+('\t<td class="ue_tdb_'+c+'01 txt_ip_blue" style="padding: 5px 5px 4px 5px;'+u+q+'" id="dext_tab_tool2_'+this.ID+'">'):f+('\t<td class="ue_tdb_'+c+'01 txt_ip_blue" style="padding: 2px 5px 0px 5px; background-image:url('+e+"/ue_tbg01.gif);"+u+q+t+'" id="dext_tab_tool2_'+
this.ID+'">');for(e=0;e<h;e++){"0"==b?m=a[e]:(m=a[e],"apply_format"==m?this.isUseApplyFormat=!0:"text_paste"==m&&(this.setTextPasteMode=this._config.setTextPasteMode));m=DEXTTOP.DEXT5.util.trim(m).toLowerCase();q=this.remove_item.length;for(t=0;t<q;t++)if(this.remove_item[t].toLowerCase()==m){m="remove";break}if("0"==b)f+='<span class="uebutton_combo_on" id="dext_span_'+this.ID+m+'" >',f+="</span>",f+=g;else if(0==m.indexOf("p_"))u=m.split("_"),q=u[1],"customformatting"==q?(t="Font_Btn_"+c,f+='<span class="uebutton_combo_on',
f+='" id="dext_span_'+this.ID+m+'" >',f+='\t<button unselectable="on" onmousedown="return false;" id="ue_'+this.ID+m+'" class="'+t+'" type="button" title="'+dext5_lang.icon[q]+'" style="margin:0;"><span></span></button>',f+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">',f+='\t\t<span id="dext_pan_'+m+"_"+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>',f+="\t</span>"):
(t="icon_mono"==_dext_editor._config.style.iconName?"icon_mono":"icon",2<u.length&&(t=u[2]),f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">',u="",DEXTTOP.DEXT5.browser.ie&&(u="vertical-align:bottom; "),f=null!=G_DEPlugin[q].lang||void 0!=G_DEPlugin[q].lang?f+('<a href="javascript:;" id="'+this.ID+":"+m+'" title="'+G_DEPlugin[q].lang.title+'"><img style="'+u+'margin: -1px; padding: 0px; width: 20px; height: 20px;" id="ue_'+this.ID+m+'" class="ue_H ue_M" title="'+G_DEPlugin[q].lang.title+
'" alt="" src="'+this._config.webPath.plugin+q+"/images/"+t+'.png" /></a>'):f+('<a href="javascript:;" id="'+this.ID+":"+m+'"><img style="'+u+'margin: -1px; padding: 0px; width: 20px; height: 20px;" id="ue_'+this.ID+m+'" class="ue_H ue_M" title="" alt="" src="'+this._config.webPath.plugin+q+"/images/"+t+'.png" /></a>'),"selectedcontent"==q&&!0===G_DEPlugin[q].config.expandMenuList.use&&(f+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">',f+='\t\t<span id="dext_pan_'+
m+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute; left: 0px; top:0px; padding:0px; border:0px solid #cccccc;"></span>',f+="\t</span>")),f+="</span>",G_ICON_FULL_SET.push(m);else if(getCustomIconAttr(m).isCustom)q="custom",null!=DEXTTOP.DEXT5.ajax.load(d+"icon/"+getCustomIconAttr(m).command+".gif",void 0,this._config.addHttpHeader)&&(q=getCustomIconAttr(m).command),f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">',f+='\t<a href="javascript:;" id="'+
this.ID+":"+m+'"><img style="margin: 2px 0px 0px 1.5px; padding: 0px; width: 16px; height: 16px;" id="ue_'+this.ID+m+'" class="ue_H ue_M" title="" alt="" src="'+d+"icon/"+q+'.gif" /></a>',f+="</span>",G_ICON_FULL_SET.push(m);else switch(m){case "remove":break;case "separator":f+=g;break;case "font_family":case "font_size":case "line_height":case "formatting":case "letter_spacing":q=!1;switch(m){case "font_family":"1"==this._config.useFontFamilyKeyin&&(q=!0);break;case "font_size":"1"==this._config.useFontSizeKeyin&&
(q=!0);break;case "line_height":"1"==this._config.useLineHeightKeyin&&(q=!0)}if(q){if(q="",DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.browser.quirks&&(q="22px"),f+='<span class="uebutton_combo_on',"font_size"==m&&"1"==this._config.useFontSizeIncDec?f+=" fontSize upDown":"line_height"==m&&"1"==this._config.useLineHeightIncDec&&(f+=" lineHeight upDown"),f+='" id="dext_span_'+this.ID+m+'" >',f+='\t<textarea placeholder="" rows="1" wrap="soft" id="txtara_'+this.ID+m+'" style="height:'+q+';" title="'+dext5_lang.icon[m].replace("\uae30\ubcf8",
"")+'"></textarea>',f+='<a class="t_arrow" href="javascript:void(0);"  id="ue_'+this.ID+m+'"></a>',"font_size"==m&&"1"==this._config.useFontSizeIncDec||"line_height"==m&&"1"==this._config.useLineHeightIncDec)f+='<a class="t_arrow t_arrow_top" href="javascript:void(0);"  id="ue_'+this.ID+m+'_inc" style="cursor: pointer;">',f+="</a>",f+='<a class="t_arrow t_arrow_bottom" href="javascript:void(0);"  id="ue_'+this.ID+m+'_dec" style="cursor: pointer;"></a>'}else if(t="line_height"==m?"Fsize_Btn_"+c:"Font_Btn_"+
c,f+='<span class="uebutton_combo_on',"font_size"==m&&"1"==this._config.useFontSizeIncDec?f+=" fontSize upDown":"line_height"==m&&"1"==this._config.useLineHeightIncDec?f+=" lineHeight upDown":"letter_spacing"==m&&"1"==this._config.useLetterSpacingIncDec&&(f+=" spacing upDown"),f+='" id="dext_span_'+this.ID+m+'" >',f+='\t<button unselectable="on" onmousedown="return false;" id="ue_'+this.ID+m+'" class="'+t+'" type="button" title="'+dext5_lang.icon[m].replace("\uae30\ubcf8","")+'" style="margin:0;"><span></span></button>',
"line_height"==m&&"1"==this._config.useLineHeightIncDec||"letter_spacing"==m&&"1"==this._config.useLetterSpacingIncDec||"font_size"==m&&"1"==this._config.useFontSizeIncDec)f+='<a class="t_arrow t_arrow_top" href="javascript:void(0);"  id="ue_'+this.ID+m+'_inc" style="cursor: pointer;"></a>',f+='<a class="t_arrow t_arrow_bottom" href="javascript:void(0);"  id="ue_'+this.ID+m+'_dec" style="cursor: pointer;"></a>';f+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';
f+='\t\t<span id="dext_pan_'+m+"_"+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';f+="\t</span>";f+="</span>";break;case "table_insert":f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';f+='\t<a href="javascript:;" id="'+this.ID+":"+m+'" class="'+m+'"><span id="ue_'+this.ID+m+'" style="display:block;width:16px; height:16px;"></span></a>';f+='\t<span style="display:block;position:absolute; z-index:'+
(G_MAIN_ZINDEX+2E3)+'">';f+='\t\t<span id="dext_pan_'+m+"_"+this.ID+'" style="background-color:#ffffff; position:absolute; left:0px; top:0px; display:none; width:180px; height:200px; padding:5px; border:1px solid #cccccc;">';f+='\t\t\t<span id="dext_table_rc_'+this.ID+'" style="font-size:12px;">0 * 0</span>';f+="\t\t</span>";f+="\t</span>";f+="</span>";m=!1;if(-1<(","+this._config.toolBar1.join(",")+",").indexOf(",detail_table_insert_new,")||-1<(","+this._config.toolBar2.join(",")+",").indexOf(",detail_table_insert_new,"))m=
!0;0==m&&(f+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_table_insert">',f+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_table_insert" class="dialog"></a>',f+="</span>");break;case "detail_table_insert":f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';f+='\t<a href="javascript:;" id="'+this.ID+":"+m+'" class="'+m+'"><span id="ue_'+this.ID+m+'" style="display:block;width:16px; height:16px;"></span></a>';f+='\t<span style="display:block;position:absolute; z-index:'+
(G_MAIN_ZINDEX+2E3)+'">';f+='\t\t<span id="dext_pan_'+m+"_"+this.ID+'" style="background-color:#ffffff; position:absolute; left:0px; top:0px; display:none; width:180px; height:200px; padding:5px; border:1px solid #cccccc;">';f+='\t\t\t<span id="dext_table_rc_'+this.ID+'" style="font-size:12px;">0 * 0</span>';f+="\t\t</span>";f+="\t</span>";f+="</span>";break;case "detail_table_insert_new":f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';f+='\t<a href="javascript:;" id="'+
this.ID+":"+m+'" class="'+m+'"><span id="ue_'+this.ID+m+'" style="display:block;width:16px; height:16px;"></span></a>';f+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';f+='\t\t<span id="dext_pan_'+m+"_"+this.ID+'" style="background-color:#ffffff; position:absolute; left:0px; top:0px; display:none; width:180px; height:200px; padding:5px; border:1px solid #cccccc; ">';f+='\t\t\t<span id="dext_table_rc_'+this.ID+'" style="font-size:12px;">0 * 0</span>';f+="\t\t</span>";
f+="\t</span>";f+="</span>";break;case "font_color":f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';f+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'">';f+='<em class="dext_font_color_basic dext_color_style1" id="dext_em_'+this.ID+'color_show"></em>';f+="</a>";f+="</span>";f+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_font_color">';f+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_font_color" class="dialog"></a>';f+="</span>";
break;case "detail_font_color":break;case "font_bg_color":f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';f+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'">';f+='\t<em class="dext_font_color_basic dext_color_style2" id="dext_em_'+this.ID+'bg_color_show"></em>';f+="</a>";f+="</span>";f+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_font_bg_color">';f+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_font_bg_color" class="dialog"></a>';
f+="</span>";break;case "detail_font_bg_color":break;case "cell_bg_color":f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';f+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'">';f+='\t    <em class="dext_font_color_basic dext_color_style2" id="dext_em_'+this.ID+'cell_bg_color_show"></em>';f+="    </a>";f+="</span>";f+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_cell_bg_color">';f+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_cell_bg_color" class="dialog"></a>';
f+="</span>";break;case "detail_cell_bg_color":break;case "list_number":f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';f+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'"></a>';f+="</span>";f+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_list_number">';f+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_list_number" class="dialog"></a>';f+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';f+=
'\t\t<span id="dext_pan_detail_list_number_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc;"></span>';f+="\t</span>";f+="</span>";break;case "detail_list_number":break;case "list_bullets":f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';f+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'"></a>';f+="</span>";f+='<span style="" class="uebutton_dialog_on" id="dext_span_'+
this.ID+'detail_list_bullets">';f+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_list_bullets" class="dialog"></a>';f+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';f+='\t\t<span id="dext_pan_detail_list_bullets_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';f+="\t</span>";f+="</span>";break;case "detail_list_bullets":break;case "align_group":f+='<span style="" class="uebutton_span_on" id="dext_span_'+
this.ID+m+'">';f+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'"></a>';f+="</span>";f+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'align_group_detail">';f+='\t<a href="javascript:;" id="ue_'+this.ID+'align_group_detail" class="dialog"></a>';f+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';f+='\t\t<span id="dext_span_align_group_detail_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';
f+="\t</span>";f+="</span>";break;case "align_group_detail":break;case "order_of_objects":f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';f+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'"></a>';f+="</span>";f+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'order_of_objects_detail">';f+='\t<a href="javascript:;" id="ue_'+this.ID+'order_of_objects_detail" class="dialog"></a>';f+='\t<span style="display:block;position:absolute; z-index:'+
(G_MAIN_ZINDEX+2E3)+'">';f+='\t\t<span id="dext_span_order_of_objects_detail_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';f+="\t</span>";f+="</span>";break;case "order_of_objects_detail":break;case "table_group":f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';f+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'"></a>';f+="</span>";f+='<span style="" class="uebutton_dialog_on" id="dext_span_'+
this.ID+'table_group_detail">';f+='\t<a href="javascript:;" id="ue_'+this.ID+'table_group_detail" class="dialog"></a>';f+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';f+='\t\t<span id="dext_span_table_group_detail_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';f+="\t</span>";f+="</span>";break;case "table_group_detail":break;case "insert_datetime":f+='<span style="" class="uebutton_span_on" id="dext_span_'+
this.ID+m+'">';f+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'">';f+="</a>";f+="</span>";f+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_insert_datetime">';f+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_insert_datetime" class="dialog"></a>';f+="</span>";break;case "detail_insert_datetime":break;case "horizontal_line":f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';f+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+
m+'">';f+="</a>";f+="</span>";f+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_horizontal_line">';f+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_horizontal_line" class="dialog"></a>';f+="</span>";break;case "detail_horizontal_line":break;default:f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">',f+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'"></a>',f+="</span>"}}if("1"==b){c=!1;q=this.remove_item.length;for(t=0;t<q;t++)if("about"==
this.remove_item[t]){c=!0;break}0==c&&(f+='<span style="" class="uebutton_span_on">',f+='\t<a href="javascript:;" id="'+this.ID+':about" class="about"><span id="ue_'+this.ID+'about" style="display:block;width:16px; height:16px;"></span></a>',f+="</span>")}"1"==this._config.tool_bar_grouping&&(c="a_focus",DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion&&(c="a_focus_ie7"),"1"==b?(f+='<span style="z-index:'+(G_MAIN_ZINDEX+850)+';" class="tool_bar_grouping" id="dext_span_'+this.ID+'tool_bar_grouping1">',
f+='\t<a href="javascript:;" id="ue_'+this.ID+'tool_bar_grouping1" class="'+c+'" title="'+dext5_lang.icon.toolbar_grouping+' 1" ><span style="display:none;">'+dext5_lang.icon.toolbar_grouping+" 1</span></a>",f+="</span>"):"2"==b&&(f+='<span style="z-index:'+(G_MAIN_ZINDEX+850)+';" class="tool_bar_grouping" id="dext_span_'+this.ID+'tool_bar_grouping2">',f+='\t<a href="javascript:;" id="ue_'+this.ID+'tool_bar_grouping2" class="'+c+'" title="'+dext5_lang.icon.toolbar_grouping+' 2"><span style="display:none;">'+
dext5_lang.icon.toolbar_grouping+" 2</span></a>",f+="</span>"));f+="\t</td>";return f+="</tr>"},_makeEditorFormBar:function(){var a="";if("1"==this._config.formMode){var b=this._config.style.skinName,c='<span class="ue_SM"><img style="margin:1px; padding: 0px; width: 11px; height: 26px;" src="'+(this._config.webPath.image+"skin/"+b)+'/separator.gif" alt="" /></span>',d=0,d=this._config.toolBarAdmin.length;if(0<d&&"1"==this._config.formMode)for(a=a+('<table id="" class="ue_table02 tm_'+b+'2" border="0" cellpadding="0" cellspacing="0">')+
"<tbody>",a+='<tr id="tool3_'+this.ID+'">',a+='<td class="ue_tdb_ty ue_tdb_'+b+'">',b=0;b<d;b++){var e;e=this._config.toolBarAdmin[b];e=DEXTTOP.DEXT5.util.trim(e).toLowerCase();for(var f=this.remove_item.length,g=0;g<f;g++)if(this.remove_item[g]==e){e="remove";break}switch(e){case "remove":break;case "separator":a+=c;break;default:a+='<span id="dext_span_'+this.ID+e+'" class="uebutton_type_on"><a id="ue_'+this.ID+e+'" title="" href="javascript:;" class="'+e.replace("input_","type_")+'"></a></span>'}}a+=
"</td>";a+="</tr>";a+="</tbody>";a+="</table>"}return a},_div_pan_reset:function(a){},_iconEnableForTextInRange:function(){var a=getFirstRange(),b=a.range;if(a.sel.isCollapsed){a="";if(b=GetTDTHCell(b.startContainer))b=GetParentbyTagName(b,"table"),a=checkLockAttr(b,!0)&&"1"!=DEXTTOP.G_CURREDITOR._config.formMode?"focusInCellLockTable":"focusInCell";this._iconEnable(a)}},_iconEnable:function(a,b,c){if(null==this.iconEnableCommandType||this.iconEnableCommandType!=a||""==a||"undo"==G_LAST_CMD||"redo"==
G_LAST_CMD||c){this.iconEnableCommandType=a;var d=!1;-1<a.indexOf("noMerge")&&(d=!0,a=a.substring(0,a.indexOf("_")));if(0==DEXTTOP.G_CURREDITOR._config.editorBodyEditable&&(""==a||"default"==a))try{var e=getFirstRange().range.startContainer;3==e.nodeType?e=e.parentNode:1!=e.nodeType&&(e=_iframeDoc.body);0==e.isContentEditable&&(a="editableFalse")}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var g=null,h=null,m="",e=g="";c=0;for(var q=G_ICON_FULL_SET.length;c<q;c++)if(m=DEXTTOP.DEXT5.util.trim(G_ICON_FULL_SET[c]).toLowerCase(),
g=document.getElementById("ue_"+this.ID+m),h=document.getElementById("dext_span_"+this.ID+m),g&&(g.style.cursor="pointer"),h){switch(m){case "formatting":case "p_customformatting":case "font_family":case "font_size":case "line_height":case "letter_spacing":g="font_size"==m&&"1"==this._config.useFontSizeIncDec?"fontSize upDown uebutton_combo_":"line_height"==m&&"1"==this._config.useLineHeightIncDec?"lineHeight upDown uebutton_combo_":"letter_spacing"==m&&"1"==this._config.useLetterSpacingIncDec?"spacing upDown uebutton_combo_":
"uebutton_combo_";break;case "detail_table_insert":case "detail_list_number":case "detail_list_bullets":case "order_of_objects_detail":case "align_group_detail":case "table_group_detail":case "detail_font_color":case "detail_font_bg_color":case "detail_cell_bg_color":case "detail_insert_datetime":case "detail_horizontal_line":g="uebutton_dialog_";break;case "input_textfield":case "input_textarea":case "input_select":case "input_checkbox":case "input_radio":case "input_button":case "input_imagebutton":case "input_hiddenfield":case "input_align_left":case "input_align_right":case "input_valign_top":case "input_valign_bottom":case "input_same_width":case "input_same_height":case "input_word_spacing":case "input_line_height":case "input_same_width_height":case "table_lock":case "cell_lock":case "table_lock_property":case "placeholder":g=
"uebutton_type_";break;default:g="uebutton_span_"}if((e=DEXTTOP.DEXT5.util.getClass(h))&&-1<e.indexOf("_off"))if(DEXTTOP.DEXT5.util.setClass(h,g+"on"),0==m.indexOf("p_")){var t=m.split("_")[1];if(h=h.getElementsByTagName("img")[0])h.title=dext5_lang.plugins[t].icon[m]}else if(h=h.getElementsByTagName("a")[0])h.title=dext5_lang.icon[m]}e=[];switch(a){case "":case "default":e="copy text_copy cut table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight insert_row_column insert_row insert_column table_row_clone table_selection table_select cell_size align_vertical row_property table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property table_tool cell_border cell_bg_color table_group table_group_detail apply_format image_align_default image_align_left image_align_right table_lock cell_lock table_lock_property detail_cell_bg_color element_position order_of_objects order_of_objects_detail table_adjust insert_table_top_paragraph insert_table_bottom_paragraph table_copy_paste calculation_formula table_row_column delete_table_and_row_column table_row_column_cell_property sticky_table sticky_top_row sticky_first_column".split(" ");
break;case "selectedSingleCell":e="new save print pagebreak copy text_copy cut paste text_paste find replace template emoticon horizontal_line image_create image_editor flash_create insert_link_media media_create iframe_create hyperlink_create insert_file file_open bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete insert_row_up insert_row_down insert_column_left insert_column_right merge_cell cell_size table_same_width table_same_height table_same_widthheight full_screen entity insert_row_column insert_row insert_column table_row_clone table_selection table_select row_property column_property format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton show_blocks photo_editor insert_datetime detail_insert_datetime conversion video calculator mini_photo_editor placeholder insert_table_top_paragraph insert_table_bottom_paragraph table_selection table_indent table_outdent table_row_column table_row_clone insert_row_column insert_row_up insert_row_down insert_column_right insert_table_top_paragraph insert_table_bottom_paragraph table_delete row_property column_property table_property calculation_formula horizontal_sum vertical_sum horizontal_avg vertical_avg horizontal_mul vertical_mul horizontal_sub vertical_sub horizontal_div vertical_div".split(" ");
null==DEXTTOP.G_COPIEDCELLDATA&&(e.push("table_content_paste"),e.push("intable_paste"),e.push("table_content_paste_to_text"),e.push("table_content_paste_with_format"));DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&e.push("apply_format");(c=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table"))&&"all"==c.getAttribute("sticky")&&(e.push("sticky_top_row"),e.push("sticky_first_column"));break;case "selectedMultiCell":e="new save print pagebreak copy text_copy cut paste text_paste find replace emoticon horizontal_line template image_create image_editor flash_create insert_link_media media_create iframe_create hyperlink_create insert_file file_open bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete insert_row_up insert_row_down insert_column_left insert_column_right full_screen entity insert_row_column insert_row insert_column table_row_clone table_selection table_select row_property column_property format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton show_blocks photo_editor insert_datetime detail_insert_datetime conversion video calculator mini_photo_editor placeholder insert_table_top_paragraph insert_table_bottom_paragraph table_indent table_outdent table_content_paste table_content_paste_to_text table_content_paste_with_format table_delete row_property column_property calculation_formula horizontal_sum vertical_sum horizontal_avg vertical_avg horizontal_mul vertical_mul horizontal_sub vertical_sub horizontal_div vertical_div table_paste table_row_column".split(" ");
d&&e.push("merge_cell");null==DEXTTOP.G_COPIEDCELLDATA&&(e.push("table_content_paste"),e.push("intable_paste"),e.push("table_content_paste_to_text"),e.push("table_content_paste_with_format"));DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&e.push("apply_format");(c=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table"))&&"all"==c.getAttribute("sticky")&&(e.push("sticky_top_row"),e.push("sticky_first_column"));break;case "focusInCell":e="copy text_copy cut merge_cell table_same_width table_same_height table_same_widthheight doc_bg_image cell_size apply_format image_align_default image_align_left image_align_right table_copy".split(" ");
null==DEXTTOP.G_COPIEDCELLDATA&&(e.push("table_content_paste"),e.push("intable_paste"),e.push("table_content_paste_to_text"),e.push("table_content_paste_with_format"));DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&e.push("apply_format");(c=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table"))&&"all"==c.getAttribute("sticky")&&(e.push("sticky_top_row"),e.push("sticky_first_column"));break;case "focusInCellLockTable":e="copy text_copy cut merge_cell table_same_width table_same_height table_same_widthheight doc_bg_image cell_size apply_format image_align_default image_align_left image_align_right table_copy insert_row_up insert_row_down insert_column_left insert_column_right delete_row delete_column".split(" ");
null==DEXTTOP.G_COPIEDCELLDATA&&(e.push("table_content_paste"),e.push("intable_paste"),e.push("table_content_paste_to_text"),e.push("table_content_paste_with_format"));DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&e.push("apply_format");(c=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table"))&&"all"==c.getAttribute("sticky")&&(e.push("sticky_top_row"),e.push("sticky_first_column"));break;case "focusTable":e="new save print pagebreak find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create hyperlink_create insert_file file_open insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell remove_css insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight font_color font_bg_color list_number list_bullets detail_list_number detail_list_bullets template entity table_delete insert_row_column insert_row insert_column formatting font_family font_size line_height letter_spacing bold italic underline strike_through superscript subscript remove_format table_row_clone table_selection table_select cell_size align_vertical row_property select_all table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail indent outdent image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator mini_photo_editor placeholder insert_table_top_paragraph insert_table_bottom_paragraph calculation_formula table_copy_paste table_row_column delete_table_and_row_column table_row_column_cell_property sticky_table sticky_top_row sticky_first_column".split(" ");
"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign&&(e.push("align_left"),e.push("align_center"),e.push("align_right"),e.push("align_full"),e.push("align_group"),e.push("align_group_detail"));!(c=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table"))||"all"==c.getAttribute("sticky")&&null!=c.getAttribute("sticky")&&void 0!=c.getAttribute("sticky")||(c=e.indexOf("sticky_top_row"),-1<c&&e.splice(c,1),c=e.indexOf("sticky_first_column"),-1<c&&e.splice(c,1));break;case "cellSelectText":e=
"new save print pagebreak find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight template entity table_delete insert_row_column insert_row insert_column table_row_clone table_selection table_select cell_size align_vertical row_property table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_cell_bg_color insert_datetime detail_insert_datetime video calculator mini_photo_editor placeholder table_copy_paste delete_table_and_row_column table_row_column table_row_column_cell_property calculation_formula sticky_table sticky_top_row sticky_first_column".split(" ");
"1"!=this._config.allowInoutdentText&&(e.push("indent"),e.push("outdent"));break;case "selectArea":e="new save print pagebreak find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight template entity table_delete insert_row_column insert_row insert_column table_row_clone table_selection table_select cell_size align_vertical row_property table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_cell_bg_color insert_datetime detail_insert_datetime video calculator mini_photo_editor placeholder table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column sticky_table sticky_top_row sticky_first_column".split(" ");
break;case "focusImage":e="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets detail_list_number detail_list_bullets indent outdent insert_row_column insert_row insert_column iframe_create table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator placeholder table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column sticky_table sticky_top_row sticky_first_column".split(" ");
break;case "focusFigure":e="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template hyperlink_create insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets detail_list_number detail_list_bullets indent outdent insert_row_column insert_row insert_column iframe_create table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator align_full placeholder table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column sticky_table sticky_top_row sticky_first_column".split(" ");
break;case "focusEmbed":e="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template hyperlink_create insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets indent outdent insert_row_column insert_row insert_column table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator mini_photo_editor placeholder table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column sticky_table sticky_top_row sticky_first_column".split(" ");
break;case "editableFalse":e=G_ICON_FULL_SET;c=[];d=","+G_ICON_READONLY_ACTIVATION_SET.join(",")+",";m=0;for(q=e.length;m<q;m++)-1==d.indexOf(","+e[m]+",")&&c.push(e[m]);e=c;break;case "allDisable":e=G_ICON_FULL_SET;break;case "dextResize":e="new save print pagebreak find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create hyperlink_create insert_file file_open insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell remove_css insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight font_color font_bg_color list_number list_bullets detail_list_number detail_list_bullets template entity table_delete insert_row_column insert_row insert_column formatting font_family font_size line_height letter_spacing bold italic underline strike_through superscript subscript remove_format table_row_clone table_selection table_select cell_size align_vertical row_property select_all table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail indent outdent image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color table_lock cell_lock table_lock_property insert_datetime detail_insert_datetime video calculator mini_photo_editor placeholder table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column sticky_table sticky_top_row sticky_first_column".split(" ");
break;case "focusPageBreak":e="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template hyperlink_create insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets detail_list_number detail_list_bullets indent outdent insert_row_column insert_row insert_column iframe_create table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator placeholder table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column sticky_table sticky_top_row sticky_first_column".split(" ");
break;case "placeholder":e="copy text_copy cut paste text_paste replace emoticon setting horizontal_line image_create image_editor image_property image_editor_property flash_create flash_property media_create media_property iframe_create iframe_property hyperlink_create hyperlink_property remove_hyperlink bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight table_group table_group_detail bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color align_group align_group_detail align_left align_center align_right align_full line_height indent outdent list_number list_bullets detail_list_number detail_list_bullets formatting font_family font_size select_all entity insert_row insert_column table_select cell_size align_vertical table_tool list_number list_bullets insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom grid tool_replace convert_table_to_text insert_link_media paste_word cell_border cell_bg_color table_indent table_outdent ruler pagebreak dirltr dirrtl insert_file format_painter apply_format letter_spacing align image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_textarea_property input_select input_select_property input_imagebutton input_same_width input_same_height input_same_width_height accessibility_validation table_copy table_paste intable_paste table_content_paste horizontal_sum vertical_sum horizontal_avg vertical_avg horizontal_mul vertical_mul horizontal_sub vertical_sub horizontal_div vertical_div table_selection show_blocks table_lock cell_lock table_lock_property list_lower_alpha word_transform photo_editor photo_editor_property insert_file_property detail_cell_bg_color insert_datetime detail_insert_datetime conversion personal_data forbidden_word video video_property spell_check calculator mini_photo_editor table_adjust table_tool delete_table_and_row_column table_row_column_cell_property table_row_colum table_copy_paste calculation_formula table_row_column sticky_table sticky_top_row sticky_first_column".split(" ")}for(t in G_DEPlugin)if(G_DEPlugin[t].onDisableToolIcon&&
(c=G_DEPlugin[t].onDisableToolIcon(a)))for(d=0;d<c.length;d++)e.push(c[d]);m=0;for(q=G_ICON_CUSTOM_ADD_DISABLED_SET.length;m<q;m++)e.push(G_ICON_CUSTOM_ADD_DISABLED_SET[m]);e=e.concat(this.lockCommand);0==this.UndoManager.canUndo&&(e[e.length]="undo");0==this.UndoManager.canRedo&&(e[e.length]="redo");if("editableFalse"!=a){b&&1==b&&(e=addDisalbeItemForNoActionTable(e));if(void 0==getAutoSaveHtml_userID(this.ID,this._config.setAutoSave.unique_key,this._config.setAutoSave.maxCount)||""==getAutoSaveHtml_userID(this.ID,
this._config.setAutoSave.unique_key))e[e.length]="load_auto_save";null==this._formatPainterList&&(e[e.length]="apply_format");"focusImage"==a&&(b=DEXTTOP.G_SELECTED_IMAGE_ELEMENT)&&b.getAttribute("dext5customdata")&&""!=b.getAttribute("dext5customdata")&&(b=b.getAttribute("dext5customdata"),"iframe"!=getDextCustomData(b).type&&(e.push("image_align_default"),e.push("image_align_left"),e.push("image_align_right")));(b=getFormControlSelectedItem())&&2>b.count&&(e.push("input_same_width"),e.push("input_same_height"),
e.push("input_same_width_height"))}-1<e.indexOf("status_source")&&e.splice(e.indexOf("status_source"),1);-1<e.indexOf("status_preview")&&e.splice(e.indexOf("status_preview"),1);-1<e.indexOf("status_text")&&e.splice(e.indexOf("status_text"),1);c=0;for(q=e.length;c<q;c++)if(m=DEXTTOP.DEXT5.util.trim(e[c]).toLowerCase(),g=document.getElementById("ue_"+this.ID+m),h=document.getElementById("dext_span_"+this.ID+m),"zoom"!=m&&"zoom_plus"!=m&&"zoom_minus"!=m||"allDisable"!=a)if(g&&(g.style.cursor="default"),
h){switch(m){case "formatting":case "p_customformatting":case "font_family":case "font_size":case "line_height":case "letter_spacing":g="font_size"==m&&"1"==this._config.useFontSizeIncDec?"fontSize upDown uebutton_combo_":"line_height"==m&&"1"==this._config.useLineHeightIncDec?"lineHeight upDown uebutton_combo_":"letter_spacing"==m&&"1"==this._config.useLetterSpacingIncDec?"spacing upDown uebutton_combo_":"uebutton_combo_";break;case "detail_insert_datetime":case "detail_table_insert":case "detail_list_number":case "detail_list_bullets":case "table_group_detail":case "align_group_detail":case "order_of_objects_detail":case "detail_font_color":case "detail_font_bg_color":case "detail_cell_bg_color":case "detail_horizontal_line":g=
"uebutton_dialog_";break;case "input_textfield":case "input_textarea":case "input_select":case "input_checkbox":case "input_radio":case "input_button":case "input_imagebutton":case "input_hiddenfield":case "input_align_left":case "input_align_right":case "input_valign_top":case "input_valign_bottom":case "input_same_width":case "input_same_height":case "input_word_spacing":case "input_line_height":case "input_same_width_height":case "table_lock":case "cell_lock":case "table_lock_property":case "placeholder":g=
"uebutton_type_";break;default:g="uebutton_span_"}DEXTTOP.DEXT5.util.setClass(h,g+"off");0==m.indexOf("p_")?(h=h.getElementsByTagName("img")[0])&&0>h.title.indexOf(dext5_lang.icon.inactive_button)&&(h.title=h.title+" "+dext5_lang.icon.inactive_button):(h=h.getElementsByTagName("a")[0])&&0>h.title.indexOf(dext5_lang.icon.inactive_button)&&(h.title=dext5_lang.icon[m]+" "+dext5_lang.icon.inactive_button)}if("1"==this._config.useAutoToolbar){document.getElementById("dext_tab_tool1_"+this.ID);b=document.getElementById("dext_tab_tool2_"+
this.ID);hiddenIconForAutoToolbar(this);""==a&&(a="default");a=this._config.autoToolbar[a]?this._config.autoToolbar[a]:[];t=a.length;d=this._config.webPath.image+"skin/"+this._config.style.skinName;for(c=0;c<t;c++)m=document.getElementById("dext_span_"+this.ID+a[c]),"separator"==a[c]&&(m=document.createElement("span"),m.className="ue_SM",m.innerHTML='<img style="margin:1px; padding: 0px; width: 11px; height: 26px;" src="'+d+'/separator.gif" alt="">'),m&&b.appendChild(m);b.scrollLeft="0px";setToolbarScroll(this)}DEXT5_TOPMENU._disabeld_menu=
e}},_iconSelected:function(a){for(var b="bold italic underline align_left align_center align_right align_full strike_through subscript superscript full_screen grid list_number list_bullets dirltr dirrtl show_blocks table_lock cell_lock table_lock_property font_color font_bg_color table_border status_source status_preview status_text".split(" "),c=DEXTTOP.G_CURREDITOR,d="",e=0,f=b.length;e<f;e++)if(_icon_id=DEXTTOP.DEXT5.util.trim(b[e]).toLowerCase(),_icon_span=document.getElementById("dext_span_"+
c.ID+_icon_id))d=DEXTTOP.DEXT5.util.getClass(_icon_span),d=DEXTTOP.DEXT5.util.replaceAll(d,"uebutton_span_enter",""),d=DEXTTOP.DEXT5.util.trim(d),DEXTTOP.DEXT5.util.setClass(_icon_span,d),_icon_span.style.backgroundImage="";if(a)for(e=0,f=a.length;e<f;e++)if(_icon_id=DEXTTOP.DEXT5.util.trim(a[e]).toLowerCase(),_icon_span=document.getElementById("dext_span_"+c.ID+_icon_id))d=DEXTTOP.DEXT5.util.getClass(_icon_span),d+=" uebutton_span_enter",DEXTTOP.DEXT5.util.setClass(_icon_span,d),-1<_icon_span.className.indexOf("uebutton_type")?
_icon_span.style.backgroundImage="url("+c._config.webPath.image+"skin/"+c._config.style.skinName+"/form_skinback_release.gif)":_icon_span.style.backgroundImage="url("+c._config.webPath.image+"skin/"+c._config.style.skinName+"/skinback_release.gif)"},_setIconEvents:function(){for(var a=this,b=null,c="",d=0,e=G_ICON_FULL_SET.length,f;d<e;d++)if(c=DEXTTOP.DEXT5.util.trim(G_ICON_FULL_SET[d]).toLowerCase(),b=document.getElementById("ue_"+a.ID+c)){if(getCustomIconAttr(G_ICON_FULL_SET[d]).isCustom)b.setAttribute("title",
getCustomIconAttr(G_ICON_FULL_SET[d])["desc_"+a._config.lang]),"A"==b.nodeName&&(f=document.createElement("span"),f.style.display="none",f.innerText=getCustomIconAttr(G_ICON_FULL_SET[d])["desc_"+a._config.lang],b.appendChild(f));else if(null!=dext5_lang.icon[c]&&void 0!=dext5_lang.icon[c])if("design"==c||"source"==c||"preview"==c||"text"==c)0<a._config.statusBarTitle.length&&void 0!=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]?""!=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]?
b.setAttribute("title",a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]):b.setAttribute("title",dext5_lang.icon[c]):b.setAttribute("title",dext5_lang.icon[c]);else try{f=document.createElement("span"),f.style.display="none",f.innerText=dext5_lang.icon[c],"A"==b.nodeName?(b.setAttribute("title",dext5_lang.icon[c]),b.appendChild(f)):"SPAN"==b.nodeName&&b.parentNode&&"A"==b.parentNode.nodeName&&(b.parentNode.setAttribute("title",dext5_lang.icon[c]),b.parentNode.appendChild(f))}catch(g){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}switch(c){case "top_design":case "top_source":case "top_preview":case "top_text":0<a._config.statusBarTitle.length&&void 0!=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.topStatusBarTitleIdx]?(""!=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.topStatusBarTitleIdx]?b.getElementsByTagName("A")[0].title=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.topStatusBarTitleIdx]:b.getElementsByTagName("A")[0].title=dext5_lang.icon[c.replace("top_","")],DEXTTOP.G_CURREDITOR.topStatusBarTitleIdx++):
b.getElementsByTagName("A")[0].title=dext5_lang.icon[c.replace("top_","")],b.getElementsByTagName("A")[0].innerHTML=dext5_lang.icon[c.replace("top_","")]}switch(c){case "design":case "source":case "preview":case "text":0<a._config.statusBarTitle.length&&void 0!=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]?(""!=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]?b.getElementsByTagName("A")[0].title=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]:b.getElementsByTagName("A")[0].title=
dext5_lang.icon[c],DEXTTOP.G_CURREDITOR.statusBarTitleIdx++):b.getElementsByTagName("A")[0].title=dext5_lang.icon[c],b.getElementsByTagName("A")[0].innerHTML=dext5_lang.icon[c]}var h=function(b){return function(c){a._dextCommands(a.ID,b);"shortcut"==b&&(G_ShortCutClick=!0);DEXTTOP.DEXT5.util.stopEvent(c)}}(c),m="";switch(c){case "font_family":case "font_size":case "letter_spacing":m="click";break;default:m="click"}DEXTTOP.DEXT5.util.addEvent(b,m,h);b.onmousedown=function(){return!1};b.unselectable=
"on";h=function(b){return function(c){if(!(-1<",detail_table_insert,detail_list_number,detail_list_bullets,align_group_detail,order_of_objects_detail,table_group_detail,detail_font_color,detail_font_bg_color,detail_cell_bg_color,detail_insert_datetime,detail_horizontal_line,".indexOf(","+b+","))){var d=document.getElementById("dext_span_"+a.ID+b);null!=d&&(""==d.style.backgroundImage&&-1<d.className.indexOf("_on")&&(d.style.backgroundImage="url("+a._config.webPath.image+"skin/"+a._config.style.skinName+
"/icon_skinback.gif)"),DEXTTOP.DEXT5.util.stopEvent(c));DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&hyperLinkOut();DEXTTOP.G_CURREDITOR.isAOver.openHelp&&hyperHelpClose()}}}(c);c=function(b){return function(c){var d=document.getElementById("dext_span_"+a.ID+b);null!=d&&(0<d.style.backgroundImage.indexOf("skinback.gif")&&(d.style.backgroundImage=""),DEXTTOP.DEXT5.util.stopEvent(c))}}(c);DEXTTOP.DEXT5.util.addEvent(b,"mouseover",h);DEXTTOP.DEXT5.util.addEvent(b,"mouseout",c)}b=function(){return function(b){document.getElementById("ue_toolbar_"+
a.ID).onselectstart="";b=b.target||b.srcElement;b.selectionStart=0;b.selectionEnd=b.value.length}}();d=function(){return function(b){document.getElementById("ue_toolbar_"+a.ID).onselectstart=new Function("return false")}}();e=function(){return function(){DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0}}();f=document.getElementById("txtara_"+a.ID+"font_family");c=document.getElementById("txtara_"+a.ID+"font_size");h=document.getElementById("txtara_"+a.ID+"line_height");m=document.getElementById("ue_"+a.ID+
"zoom_text");f&&(DEXTTOP.DEXT5.util.addEvent(f,"focus",b),DEXTTOP.DEXT5.util.addEvent(f,"blur",d),DEXTTOP.DEXT5.util.addEvent(f,"mousedown",e));c&&(DEXTTOP.DEXT5.util.addEvent(c,"focus",b),DEXTTOP.DEXT5.util.addEvent(c,"blur",d),DEXTTOP.DEXT5.util.addEvent(c,"mousedown",e));h&&(DEXTTOP.DEXT5.util.addEvent(h,"focus",b),DEXTTOP.DEXT5.util.addEvent(h,"blur",d),DEXTTOP.DEXT5.util.addEvent(h,"mousedown",e));m&&DEXTTOP.DEXT5.util.addEvent(m,"mousedown",e);this._load_editor_frame(!0)},_load_editor_frame:function(a){var b=
this;void 0==b._EDITOR&&DEXTTOP.G_CURREDITOR&&""!=DEXTTOP.G_CURREDITOR._config.directEditHtmlUrl&&(b=DEXTTOP.G_CURREDITOR);b._EDITOR.design=document.getElementById("dext5_design_"+b.ID);b._EDITOR.source=document.getElementById("dext5_source_"+b.ID);b._EDITOR.preview=document.getElementById("dext5_preview_"+b.ID);b._EDITOR.text=document.getElementById("dext5_text_"+b.ID);var c=b._EDITOR.design;b._DOC=c.contentDocument?c.contentDocument:c.contentWindow.document;G_USE_EDITOR_ID=b.ID;DEXTTOP.G_CURREDITOR=
b;b._BODY=b._DOC.body;"1"!=b._config.browserSpellCheck&&"spellcheck"in b._BODY&&(b._BODY.spellcheck=!1);"contentEditable"in b._BODY&&(isViewMode(b)||0==b._config.editorBodyEditable?b._BODY.contentEditable=!1:b._BODY.contentEditable=!0);LayerFrame=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+DEXTTOP.G_CURREDITOR.ID);LayerFrame.title=dext5_lang.iframe_title.layer;dext_src_init_once(c,b);dext_src_init(c);0<_iframeDoc.body.clientWidth&&(b._defTableWidth=_iframeDoc.body.clientWidth-30,b._defaultWidth=
_iframeDoc.body.clientWidth-30);100>b._defTableWidth&&(b._defTableWidth=400,b._defaultWidth=400);"1"==b._config.useFontSizeKeyin?document.getElementById("txtara_"+b.ID+"font_size")&&("1"==b._setting.show_font_real?document.getElementById("txtara_"+b.ID+"font_size").value=b._setting.font_size:document.getElementById("txtara_"+b.ID+"font_size").value=dext5_lang.icon.font_size):document.getElementById("ue_"+b.ID+"font_size")&&("1"==b._setting.show_font_real?document.getElementById("ue_"+b.ID+"font_size").innerHTML=
"<span>"+b._setting.font_size+"</span>":document.getElementById("ue_"+b.ID+"font_size").innerHTML="<span>"+dext5_lang.icon.font_size+"</span>");"1"==b._config.useFontFamilyKeyin?document.getElementById("txtara_"+b.ID+"font_family")&&("1"==b._setting.show_font_real?document.getElementById("txtara_"+b.ID+"font_family").value=getDisplayFontName(b._setting.font_family):document.getElementById("txtara_"+b.ID+"font_family").value=getDisplayFontName(dext5_lang.icon.font_family)):document.getElementById("ue_"+
b.ID+"font_family")&&("1"==b._setting.show_font_real?document.getElementById("ue_"+b.ID+"font_family").innerHTML="<span>"+getDisplayFontName(b._setting.font_family)+"</span>":document.getElementById("ue_"+b.ID+"font_family").innerHTML="<span>"+getDisplayFontName(dext5_lang.icon.font_family)+"</span>");document.getElementById("ue_"+b.ID+"letter_spacing")&&(document.getElementById("ue_"+b.ID+"letter_spacing").innerHTML="<span>"+dext5_lang.icon.letter_spacing+"</span>");""!=b._config.defaultMessage&&
(c=b._BODY.innerHTML,"<p></p>"==c||"<P></P>"==c?b._BODY.innerHTML="<p>"+b._config.defaultMessage+"</p>":b._config.defaultMessage="");if(a){DEXTTOP.DEXT5.util.addEvent(window,"resize",dextWindowResizeEvt);try{if(setTimeout(function(){var a=null;try{a=_dext_editor.Frame}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(null!=a){var d;try{if(DEXTTOP.DEXT5.browser.LocalStorageSupported){var e=DEXTTOP.localStorage["dext_"+a.editor.ID+"_auto_list"];e&&(d=0<e?1<e?0:1:a.editor._config.autoList.use)}}catch(q){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}a.editor.autoListUse=void 0!=d?d:a.editor._config.autoList.use;try{setAutoSave(a.editor,!0)}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{isViewMode(a.editor)?a.editor._BODY.style.cursor="auto":G_Ruler&&G_Ruler.viewRulerStatus&&showRuler(a.editor),G_BodyFit.SetBodyWidth()}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{if(""!=a.editor._config.setValueObjId){var v=DEXTTOP.DEXTDOC.getElementById(a.editor._config.setValueObjId);
if(v){var w=v.value;w&&DEXTTOP.DEXT5.setHtmlContents(w,a.editor.ID)}}}catch(y){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}d=a.editor._config.statusBarInitMode;if("design"!=d){for(var e=!1,v=a.editor._config.statusBarItem,w=v.length,x=0;x<w;x++)if("design"==v[x]){e=!0;break}e||(a.editor._EDITOR.design.style.width="0px",a.editor._EDITOR.design.style.height="0px");DEXTTOP.DEXT5.ShowTextChangeAlert=!1;a.editor._dextCommands(a.editor.ID,d);DEXTTOP.DEXT5.ShowTextChangeAlert=!0}var z=function(a){try{for(var c in G_DEPlugin)if("function"===
typeof G_DEPlugin[c].onLoaded)G_DEPlugin[c].onLoaded()}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{if("ieplugin"==a.editor._config.runtimes)try{for(var e in a.editor._config.addHttpHeader)G_dext5plugIn.AddHttpHeader(e,a.editor._config.addHttpHeader[e])}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}"2"==a.editor._config.undoMode&&a.editor.UndoManager.putUndo({isInit:!0});""!=a.editor._config.directEditHtmlUrl&&loadDirectEditHtmlUrl(a.editor._config);"1"!=
b._config.tool_bar_grouping||!DEXTTOP.DEXT5.browser.mobile&&"mobile"!=DEXTTOP.DEXT5.UserAgent.device.type||setTimeout(function(){groupingIcon()},500);onChange({editor:a.editor});G_BODY_DEFAULT_VALUE=a.editor._BODY.innerHTML;a.editor.setValueIsBusy=!1;DEXTTOP.DEXT5.browser.ie&&(DEXTTOP.focus(),DEXTTOP.document.focus(),DEXTTOP.document.body.focus());c=null;""!=a.editor._config.focusInitObjId?c=DEXTTOP.DEXTDOC.getElementById(a.editor._config.focusInitObjId):a.editor.autoMoveInitFocusData.targetNode&&
(c=a.editor.autoMoveInitFocusData.targetNode);null!=c&&(a.editor._config.initFocus=!1,c.focus());1==a.editor._config.initFocus&&setFocusToBody(a.editor);G_BodyFit.widthFixStatus&&(setBodyFitStyle(a.editor,!0),setAutoBodyFit(a.editor));try{if(DEXTTOP.G_LIGHTVIEWDOC&&a.editor.ID in DEXTTOP.G_LIGHTVIEWDOC){var g=DEXTTOP.G_LIGHTVIEWDOC[a.ID],h=a.editor._DOC.getElementsByTagName("head")[0].outerHTML;c="";void 0!=a.editor._PageProp.doctype&&0<a.editor._docType[a.editor._PageProp.doctype].length&&(c=a.editor._docType[a.editor._PageProp.doctype]);
a.editor._DOC.open("text/html","replace");a.editor._DOC.write(c+"<html>"+h+g+"</html>");a.editor._DOC.close();a.editor._load_editor_frame(!1);delete DEXTTOP.G_LIGHTVIEWDOC[a.ID];G_BodyFit.SetBodyWidth()}else"function"==typeof a.editor._config.event.loadedEvent?a.editor._config.event.loadedEvent(a):"function"==typeof a.editor._config.LoadedEvent?a.editor._config.LoadedEvent(a):"function"==typeof DEXTTOP.DEXTWIN.dext_editor_loaded_event&&DEXTTOP.DEXTWIN.dext_editor_loaded_event(a)}catch(m){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}G_Ruler&&"2"==a.editor._config.ruler.mode&&setRulerPositionForNode(a.editor,!0);G_AddOrRemovedNodesObserver.addMutationObserver();if(DEXTTOP.DEXT5.browser.LocalStorageSupported&&("0"!=a.editor._config.setAutoSave.mode||"1"==a.editor._config.setAutoSave.useManuallySave))for(var q=parseIntOr0(a.editor._config.setAutoSave.maxCount);8>q;q++)localStorage.removeItem("dext_"+a.editor.ID+"_"+q);setEditorIframeTitle(a.editor);if("edit"==a.editor._config.mode&&"0"!=
a.editor._config.autoDestroy.restoreHtml&&DEXTTOP.DEXT5.AutoDestroyHtmlHashTable&&DEXTTOP.DEXT5.AutoDestroyHtmlHashTable.getItem(a.editor.ID)){var t=DEXTTOP.DEXT5.AutoDestroyHtmlHashTable.getItem(a.editor.ID);setHtmlValueToEditor(t,!0,a.editor);DEXTTOP.DEXT5.AutoDestroyHtmlHashTable.removeItem(a.editor.ID)}else if(DEXTTOP.DEXT5.InitEditorDataHashTable){var v=DEXTTOP.DEXT5.InitEditorDataHashTable.getItem(a.editor.ID);"undefined"!=typeof v&&("object"==typeof v?"setHtmlValueExWithDocType"==v.mode?DEXTTOP.DEXT5.setHtmlValueExWithDocType(v.value,
a.editor.ID):"setHtmlValueEx"==v.mode?DEXTTOP.DEXT5.setHtmlValueEx(v.value,a.editor.ID):"setHtmlValue"==v.mode?DEXTTOP.DEXT5.setHtmlValue(v.value,a.editor.ID):"setBodyValueEx"==v.mode?DEXTTOP.DEXT5.setBodyValueEx(v.value,a.editor.ID):"setBodyValueExLikeDiv"==v.mode?DEXTTOP.DEXT5.setBodyValueExLikeDiv(v.value,a.editor.ID):"setBodyValue"==v.mode?DEXTTOP.DEXT5.setBodyValue(v.value,a.editor.ID):"loadHtmlValueExFromURL"==v.mode?DEXTTOP.DEXT5.loadHtmlValueExFromURL(v.value,a.editor.ID):"loadHtmlValueExFromServerURL"==
v.mode?DEXTTOP.DEXT5.loadHtmlValueExFromServerURL(v.value,a.editor.ID):"setDirectEditHtmlUrl"==v.mode?DEXTTOP.DEXT5.setDirectEditHtmlUrl(v.value,a.editor.ID):"setOriginalHtmlValue"==v.mode?DEXTTOP.DEXT5.setOriginalHtmlValue(v.value,a.editor.ID):"setHtmlContents"==v.mode?DEXTTOP.DEXT5.setHtmlContents(v.value,a.editor.ID):"setBodyTextValue"==v.mode&&DEXTTOP.DEXT5.setBodyTextValue(v.value,a.editor.ID):DEXTTOP.DEXT5.setHtmlContentsEw(v,a.editor.ID),DEXTTOP.DEXT5.InitEditorDataHashTable.removeItem(a.editor.ID))}}catch(u){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};try{try{DEXT5_EDITOR.prototype._setLazyLoadFrame(a.editor.ID)}catch(B){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{var D=DEXTTOP.DEXTDOC.getElementById("dext_toolmenu_background"+a.editor.ID);D&&D.parentNode.removeChild(D)}catch(A){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{var C=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+a.editor.ID);C&&C.parentNode.removeChild(C)}catch(E){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}try{var H=DEXTTOP.DEXTDOC.getElementById("dext_context_background");H&&H.parentNode.removeChild(H)}catch(M){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{var N=DEXTTOP.DEXTDOC.getElementById("dext_disabled");N&&N.parentNode.removeChild(N)}catch(I){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{var S=DEXTTOP.DEXTDOC.getElementById("dext_dialog");S&&S.parentNode.removeChild(S)}catch(F){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXTTOP.DEXT5.setDirty(a.editor.ID);
a.editor._config.isLoadedEditor=!0;setScrollStyleForIOS(a.editor);null==DEXTTOP.DEXT5.IsEditorLoadedHashTable&&(DEXTTOP.DEXT5.IsEditorLoadedHashTable=new DEXTTOP.DEXT5.util.hashTable);"1"!=DEXTTOP.DEXT5.IsEditorLoadedHashTable.getItem(a.editor.ID)&&DEXTTOP.DEXT5.IsEditorLoadedHashTable.setItem(a.editor.ID,"1");showWordCount();var O=function(){var a=!0;try{for(var b in G_DEPlugin)if("function"===typeof G_DEPlugin[b].isRequiredCheck&&(a=G_DEPlugin[b].isRequiredCheck(),!0!==a))break}catch(c){a=!0}return a};
if(O())z(a);else var P=setInterval(function(){1==O()&&(clearInterval(P),z(a))},100)}catch(J){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}},100),0==this._config.style.InitVisible)try{this._config.visibility=!1,LayerFrame.parentElement.style.height="0px",LayerFrame.parentElement.style.display="none"}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}},_cmd_new:function(a,b){void 0==b&&"0"!=DEXTTOP.DEXT5.getEditor()._config.skipConfirm.newDoc&&
(b=!0);void 0==a&&"0"!=DEXTTOP.DEXT5.getEditor()._config.newDocumentResetAll&&(a=!0);if(0==DEXTTOP.DEXT5.isEmpty())if(b||0!=confirm(dext5_lang.msg.newDocument))command_InsertDogBGImg(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._EDITOR.design,"Y","","","","",[]),DEXTTOP.DEXT5.setBodyValue("","",!0),this._iconEnable(""),setBodyDefaultValue(),setFocusToBody(),DEXTTOP.G_CURREDITOR._config.printHeader=DEXTTOP.G_CURREDITOR._config.basePrintHeader,DEXTTOP.G_CURREDITOR._config.printFooter=DEXTTOP.G_CURREDITOR._config.basePrintFooter;
else return;else command_InsertDogBGImg(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._EDITOR.design,"Y","","","","",[]),DEXTTOP.DEXT5.setBodyValue("","",!0),this._iconEnable(""),setBodyDefaultValue(),setFocusToBody(),DEXTTOP.G_CURREDITOR._config.printHeader=DEXTTOP.G_CURREDITOR._config.basePrintHeader,DEXTTOP.G_CURREDITOR._config.printFooter=DEXTTOP.G_CURREDITOR._config.basePrintFooter;a&&(DEXTTOP.G_CURREDITOR._DOC.title=DEXTTOP.G_CURREDITOR._FRAMEWIN.dext5_lang.document.no_title,DEXTTOP.DEXT5.ClearUserCssText(),
DEXTTOP.DEXT5.ClearUserCssUrl(!1),DEXTTOP.DEXT5.ClearUserJsText(),DEXTTOP.DEXT5.ClearUserJsUrl())},_dextCommands:function(a,b,c){setDEXTWINDOC();G_USE_EDITOR_ID=a;DEXTTOP.G_CURREDITOR=this;var d=!1;if(!(-1<(","+this.lockCommand.join(",")+",").indexOf(","+b+","))){DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"selectionchange",_iframeDoc_selectionchange);DEXTTOP.G_CURREDITOR.isInitFocusHandler&&(DEXTTOP.G_CURREDITOR.isInitFocusHandler=!1,setFocusToBody());var e=null;0>",insert_layer,element_position,order_of_objects,order_of_objects_detail,bring_to_front,send_to_back,bring_forward,send_backward,".indexOf(","+
b+",")&&getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv&&(e=DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem,DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear(),DEXTTOP.G_CURREDITOR.dext_dragresize.selection(e));var f=!1;null!=G_LAST_CMD&&-1<G_LAST_CMD.indexOf("align_")&&-1<b.indexOf("align_")&&(f=!0);G_LAST_CMD=b;checkDefaultMessage();if("1"!=this._config.formMode&&"1"==this._config.userTableLock.use){var g=GetTableSelectionCells(),h=g.length;
if(0<h){var m=GetParentbyTagName(g[0],"table");if("insert_row_up"==G_LAST_CMD||"insert_row_down"==G_LAST_CMD||"insert_column_left"==G_LAST_CMD||"insert_column_right"==G_LAST_CMD)if(null==m||checkLockAttr(m,!0))return;var q=this._config.userTableLock.defaultTableLockMode;"2"==this._config.userTableLock.tableLockMode?checkLockAttr(m,!0)||checkLockAttr(g[0],!0)?m.getAttribute("lock_mode")&&""!=m.getAttribute("lock_mode")&&(q=m.getAttribute("lock_mode")):q="0":m.getAttribute("lock_mode")&&""!=m.getAttribute("lock_mode")&&
(q=m.getAttribute("lock_mode"));var t=!0;"1"==q?t=!1:"0"==q&&(t=!1);for(var m=!1,u=0;u<h;u++){if(checkLockAttr(g[u],!t)){m=!0;break}else{q=[];q.push(g[u].getElementsByTagName("table"));q.push(g[u].getElementsByTagName("td"));var v=q.length;for(j=0;j<v;j++){var w=q[j].length;for(k=0;k<w;k++)if(checkLockAttr(q[j][k],!0)){m=!0;break}if(m)break}}if(m)break}if(m)return}else if(t=getFirstRange(),t.range){t=t.range.startContainer;3==t.nodeType&&(t=t.parentNode);g=GetTDTHCell(t);m=GetParentbyTagName(t,"table");
if("insert_row_up"==G_LAST_CMD||"insert_row_down"==G_LAST_CMD||"insert_column_left"==G_LAST_CMD||"insert_column_right"==G_LAST_CMD)if(null==m||checkLockAttr(m,!0))return;q=this._config.userTableLock.defaultTableLockMode;m&&("2"==this._config.userTableLock.tableLockMode?checkLockAttr(m,!0)||checkLockAttr(g,!0)?m.getAttribute("lock_mode")&&""!=m.getAttribute("lock_mode")&&(q=m.getAttribute("lock_mode")):q="0":m.getAttribute("lock_mode")&&""!=m.getAttribute("lock_mode")&&(q=m.getAttribute("lock_mode")));
t=!0;"1"==q?t=!1:"0"==q&&(t=!1);h=!1;if(h=t?checkLockAttr(m,!t)||checkLockAttr(g,!t):checkLockAttr(g,!t))return}}t=document.getElementById("ue_"+a+b);if(!t||!(t.parentNode&&null!=t.parentNode.className.match(/_off/gi)||t.parentNode.parentNode&&null!=t.parentNode.parentNode.className.match(/_off/gi)||t.parentNode.parentNode.parentNode&&null!=t.parentNode.parentNode.parentNode.className.match(/_off/gi))){AdjustDesignBodyWidth({editor:DEXTTOP.G_CURREDITOR,isApply:!0});if("1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&
b&&("detail_table_insert_new"==b||"detail_table_insert"==b||0>b.indexOf("detail"))&&"table_insert"!=b&&"font_bg_color"!=b&&"font_color"!=b&&"font_family"!=b&&"font_size"!=b&&"line_height"!=b&&"formatting"!=b&&"p_zoomslider"!=b){g=!1;g=isGroupingIcon(a,b);if(!g)for(h=DEXTTOP.G_CURREDITOR.detailSubCmd,m=h.length,u=0;u<m;u++)if(h[u]==b){g=!0;break}g&&hideGroupingBox()}if(DEXTTOP.DEXT5.browser.ie){DEXTTOP.G_CURREDITOR._RangeBlurBug=!0;try{var y=saveSelection(a);8<DEXTTOP.DEXT5.browser.ieVersion?0==(9==
y.startContainer.nodeType||9==y.endContainer.nodeType)&&(DEXTTOP.G_CURREDITOR._LastRange=y):null==DEXTTOP.G_CURREDITOR._LastRange&&y&&0!=y.offsetLeft&&0!=y.offsetTop&&(DEXTTOP.G_CURREDITOR._LastRange=y)}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}try{if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){var z=getFirstRange().range;"design"==b||z.startContainer!=z.endContainer||z.startContainer!=z.commonAncestorContainer||9!=z.startContainer.nodeType&&"body"!=z.startContainer.nodeName.toLowerCase()||
doSetCaretPosition(_iframeDoc.body.firstChild,0)}}catch(B){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXTTOP.G_CURREDITOR.dialogOpenCmd=b;switch(b){case "clean_nested_tag":DEXTTOP.DEXT5.cleanNestedTag(dext5_lang.msg.clean_nested_tag,"","1",this._config.cleanNestedTagOptions.nestedCount,"p,div",this.ID);d=!0;break;case "grid":command_grid(a,this);d=!0;break;case "insert_file":case "insert_file_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.insert_file);
d=!0;break;case "file_open":if(G_dext5plugIn)try{c&&c.hide(),file_open_plugin()}catch(D){DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.file_open)}else DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.file_open);break;case "new":this._cmd_new();break;case "save":command_saveAs(a,this);break;case "save_as":command_saveAs(a,this,!0);break;case "print":command_print(a,this);break;case "pagebreak":command_pagebreak(a,this);break;case "undo":command_undo(a,
this);d=!0;break;case "redo":command_redo(a,this);d=!0;break;case "text_copy":command_copy(this,{textCopy:!0});break;case "copy":command_copy(this);break;case "cut":command_cut(a,this);break;case "text_paste":DEXTTOP.DEXT5.browser.ie&&"1"==DEXTTOP.G_CURREDITOR.setTextPasteMode?command_pastetext(a,this):(DEXTTOP.G_CURREDITOR.setTextPaste=!0,command_pastehtml(a,this));d=!0;break;case "paste":var A;!checkCanPasteToIamge()||"1"!=this._config.pasteToImage&&"2"!=this._config.pasteToImage||(A="");command_pastehtml(a,
this,A);d=!0;break;case "paste_dialog":alert(dext5_lang.paste_dialog.msg);d=!0;break;case "paste_to_image":command_pastehtml(a,this,"jpg",!1);d=!0;break;case "paste_to_image_detail":command_pastehtml(a,this,"",c);d=!0;break;case "table_copy":command_tableCopy(a,this);break;case "table_content_paste":case "table_paste":command_tablePaste(a,this);d=!0;break;case "table_content_paste_to_text":case "table_content_paste_with_format":command_tablePaste(a,this,null,{pasteType:b});d=!0;break;case "intable_paste":command_intablePaste(a,
this);d=!0;break;case "find":g_findRepalceRange=null;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.find);break;case "replace":g_findRepalceRange=null;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.replace);break;case "emoticon":null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?
DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_emoticon):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.emoticon);d=!0;break;case "setting":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.setting);break;case "horizontal_line":command_insertHorizontalLine(a,this._EDITOR.design,this.lastHorizontalLine.dext_json,this.lastHorizontalLine.template.obj,this.lastHorizontalLine.template.tempWidth);d=!0;break;
case "detail_horizontal_line":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.horizontal_line);d=!0;break;case "image_create":d=!0;if(G_dext5plugIn&&"0"==this._config.userPluginModeSetting.useHtml5ModeForImage&&"base64"==this._config.uploadMethod&&"-1"!=this._config.maxImageBase64fileCount&&getBase64ImageCount()>=parseInt(this._config.maxImageBase64fileCount,10)){b=dext5_lang.msg.max_base64file_count;b=b.replace("{0}",this._config.maxImageBase64fileCount);alert(b);
return}null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_image):G_dext5plugIn&&"0"==this._config.userPluginModeSetting.useHtml5ModeForImage?showSetImageProperty(null):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.image);break;
case "image_property":d=!0;if(G_dext5plugIn&&"0"==this._config.userPluginModeSetting.useHtml5ModeForImage&&DEXTTOP.G_SELECTED_ELEMENT)showSetImageProperty(DEXTTOP.G_SELECTED_ELEMENT);else if(null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)){DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_image);break}else DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.image);break;case "image_editor":d=!0;G_dext5plugIn&&showImageEditor(null);break;case "image_editor_property":d=!0;G_dext5plugIn&&DEXTTOP.G_SELECTED_ELEMENT&&-1!=DEXTTOP.G_SELECTED_ELEMENT.src.search("file:///")&&showImageEditor(DEXTTOP.G_SELECTED_ELEMENT);break;case "flash_create":case "flash_property":d=!0;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.flash);break;case "media_create":case "media_property":d=!0;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.media);break;case "iframe_create":case "iframe_property":d=!0;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.iframe);break;case "hyperlink_create":case "hyperlink_property":d=!0;if(null==DEXTTOP.G_SELECTED_ELEMENT)try{var C=getFirstRange().range,E=C.startContainer;3==E.nodeType&&(E=E.parentNode);var H=GetParentbyTagName(E,"a");H&&(DEXTTOP.G_SELECTED_ELEMENT=H)}catch(M){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{if(DEXTTOP.G_SELECTED_ELEMENT&&
"A"!=DEXTTOP.G_SELECTED_ELEMENT.tagName&&(H=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"a"))&&(DEXTTOP.G_SELECTED_ELEMENT=H),DEXTTOP.G_SELECTED_ELEMENT&&"A"==DEXTTOP.G_SELECTED_ELEMENT.tagName){var N=getFirstRange().sel;N.removeAllRanges();C=getFirstRange().range;C.selectNode(DEXTTOP.G_SELECTED_ELEMENT);N.addRange(C)}}catch(I){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.hyperlink);break;case "remove_hyperlink":d=
!0;if(null==DEXTTOP.G_SELECTED_ELEMENT)try{if(C=getFirstRange().range,E=C.startContainer,3==E.nodeType&&(E=E.parentNode),H=GetParentbyTagName(E,"a"))DEXTTOP.G_SELECTED_ELEMENT=H}catch(S){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{if(DEXTTOP.G_SELECTED_ELEMENT&&"A"!=DEXTTOP.G_SELECTED_ELEMENT.tagName&&(H=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"a"))&&(DEXTTOP.G_SELECTED_ELEMENT=H),DEXTTOP.G_SELECTED_ELEMENT&&"A"==DEXTTOP.G_SELECTED_ELEMENT.tagName){for(var F=DEXTTOP.G_SELECTED_ELEMENT.getElementsByTagName("span"),
u=0;u<F.length;u++)DEXTTOP.DEXT5.browser.ie?F[u].style.textDecoration="":(F[u].style.textDecoration="",F[u].style.textDecorationLine="");if(DEXTTOP.G_SELECTED_ELEMENT.style.color&&""!=DEXTTOP.G_SELECTED_ELEMENT.style.color){var O=_iframeDoc.createElement("span");O.style.color=DEXTTOP.G_SELECTED_ELEMENT.style.color;O.innerHTML=DEXTTOP.G_SELECTED_ELEMENT.innerHTML;DEXTTOP.G_SELECTED_ELEMENT.parentNode.replaceChild(O,DEXTTOP.G_SELECTED_ELEMENT)}else{for(var P=DEXTTOP.G_SELECTED_ELEMENT.childNodes;0<
P.length;)DEXTTOP.G_SELECTED_ELEMENT.parentNode.insertBefore(P[0],DEXTTOP.G_SELECTED_ELEMENT);DEXTTOP.G_SELECTED_ELEMENT.parentNode.removeChild(DEXTTOP.G_SELECTED_ELEMENT)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo()}}catch(J){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}break;case "bookmark":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.bookmark);break;case "symbol":z=getFirstRange().range;c=getMyElementNode(z.startContainer);e="";c&&1==c.nodeType&&(e=
getElementInParentStyleProperty(c,"fontFamily"),""==e&&(e=DEXTTOP.DEXT5.util.getStyle(c,"fontFamily")));""==e&&(e=this._setting.font_family);this._config.currFontFamily=e;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.symbol);break;case "doc_bg_image":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.doc_bg_img);d=!0;break;case "detail_table_insert":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table);
d=!0;break;case "detail_table_insert_new":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table);d=!0;break;case "table_insert":d=!0;if(DEXTTOP.DEXT5.browser.mobile)DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table);else{if("1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&(c=document.getElementById("ue_"+a+"table_insert"),(c=GetParentbyTagName(c,"ul"))&&-1<c.id.indexOf("ul_tool_bar_grouping"))){hideGroupingBox();DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.table);break}this._dextTable.show(a)}break;case "table_delete":command_deleteTable(a,this);d=!0;break;case "merge_cell":command_mergeCell(a,this);d=!0;break;case "split_cell":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.split_cell);d=!0;break;case "insert_row_up":command_insertRowUp(a,this);d=!0;break;case "insert_row_down":command_insertRowDown(a,this);d=!0;break;case "delete_row":command_deleteRow(a,this);d=!0;break;case "insert_column_left":command_insertCellLeft(a,
this);d=!0;break;case "insert_column_right":command_insertCellRight(a,this);d=!0;break;case "delete_column":command_deleteCell(a,this);d=!0;break;case "table_indent":isRTL()?command_tableIndentOutdent(a,this,"outdent"):command_tableIndentOutdent(a,this,"indent");d=!0;break;case "table_outdent":isRTL()?command_tableIndentOutdent(a,this,"indent"):command_tableIndentOutdent(a,this,"outdent");d=!0;break;case "table_selection":command_tableSelection(a,this);break;case "table_select_cell":command_TableSelect(a,
this,"select_cell");break;case "table_select_row":command_TableSelect(a,this,"select_row");break;case "table_select_column":command_TableSelect(a,this,"select_column");break;case "table_select_all":command_TableSelect(a,this,"select_all");break;case "table_same_width":command_TableSameWidthheight(a,this,"same_width");d=!0;break;case "table_same_height":command_TableSameWidthheight(a,this,"same_height");d=!0;break;case "table_same_widthheight":command_TableSameWidthheight(a,this,"same_widthheight");
d=!0;break;case "table_row_clone":command_TableRowClone(a,this);d=!0;break;case "convert_table_to_text":command_convertTableToText(a,this);d=!0;break;case "cell_border":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.cell_border,DEXTTOP.G_SELECTED_ELEMENT);d=!0;break;case "cell_bg_color":command_cellBGColor(a,this._EDITOR.design);d=!0;break;case "detail_cell_bg_color":c=getDialogDocument();showColorPopup(c,t,void 0,"detail_cell_bg_color");break;case "insert_row_column":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.insert_row_column);d=!0;break;case "cell_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.cell_property,DEXTTOP.G_SELECTED_ELEMENT);d=!0;break;case "row_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.row_property);d=!0;break;case "column_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.column_property);d=!0;break;case "table_property":ClearDraggingTableCellSelected();
DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table_property,DEXTTOP.G_SELECTED_ELEMENT);d=!0;break;case "table_group":this._dextListTables.show(a);d=!0;break;case "table_group_detail":this._dextListTables.show(a);d=!0;break;case "table_adjust":m=null!=DEXTTOP.G_SELECTED_ELEMENT?DEXTTOP.G_SELECTED_ELEMENT:ActiveCurrTable;(m=GetParentbyTagName(m,"table"))&&"TABLE"==m.tagName&&command_AdjustTableAndCellWidth(this,{tables:[m]});d=!0;break;case "bold":command_bold(a,
this);d=!0;break;case "underline":command_underline(a,this);d=!0;break;case "italic":command_italic(a,this);d=!0;break;case "strike_through":command_strikeThrough(a,this);d=!0;break;case "superscript":command_superscript(a,this);d=!0;break;case "subscript":command_subscript(a,this);d=!0;break;case "remove_format":command_removeFormat(a,this);d=!0;break;case "remove_css":command_removeCss(a,this);d=!0;break;case "font_color":command_fontColor(a,this._EDITOR.design);d=!0;break;case "detail_font_color":c=
getDialogDocument();showColorPopup(c,t,void 0,"detail_font_color");d=!0;break;case "font_bg_color":command_fontBgColor(a,this._EDITOR.design);d=!0;break;case "detail_font_bg_color":c=getDialogDocument();showColorPopup(c,t,void 0,"detail_font_bg_color");d=!0;break;case "align_left":command_align(a,this,"left",f,e);d=!0;break;case "align_center":command_align(a,this,"center",f,e);d=!0;break;case "align_right":command_align(a,this,"right",f,e);d=!0;break;case "align_full":command_align(a,this,"justify",
f,e);d=!0;break;case "align_group":this._dextListAligns.show(a);d=!0;break;case "align_group_detail":this._dextListAligns.show(a);d=!0;break;case "line_height":this._dextLineHeight.show(a);d=!0;break;case "line_height_inc":case "line_height_dec":command_lineHeightIncDec(a,b,this);d=!0;break;case "indent":isRTL()?command_outdent(a,this):command_indent(a,this);d=!0;break;case "outdent":isRTL()?command_indent(a,this):command_outdent(a,this);d=!0;break;case "list_number":command_insertOrderedList(a,this);
d=!0;break;case "list_bullets":command_insertUnOrderedList(a,this);d=!0;break;case "detail_list_number":this._dextListNumber.show(a);d=!0;break;case "detail_list_bullets":this._dextListBullets.show(a);d=!0;break;case "list_decimal":command_listDecimal(a,this);d=!0;break;case "list_decimal_leading_zero":command_listDecimalLeadingZero(a,this);d=!0;break;case "list_lower_alpha":command_listLowerAlpha(a,this);d=!0;break;case "list_lower_greek":command_listLowerGreek(a,this);d=!0;break;case "list_lower_roman":command_listLowerRoman(a,
this);d=!0;break;case "list_upper_alpha":command_listUpperAlpha(a,this);d=!0;break;case "list_upper_roman":command_listUpperRoman(a,this);d=!0;break;case "list_hangul":case "list_hangul-consonant":case "list_korean-hangul-formal":case "list_korean-hanja-formal":case "list_korean-hanja-informal":case "list_cjk-demical":case "list_cjk-earthly-branch":case "list_cjk-heavenly-stem":case "list_cjk-ideographic":case "list_simp-chinese-formal":case "list_simp-chinese-informal":case "list_trad-chinese-formal":case "list_trad-chinese-informal":case "list_hiragana":case "list_hiragana-iroha":case "list_japanese-formal":case "list_japanese-informal":case "list_katakana":case "list_katakana-iroha":case "list_kannada":case "list_arabic-indic":case "list_armenian":case "list_lower-armenian":case "list_upper-armenian":case "list_bengali":case "list_cambodian":case "list_khmer":case "list_devanagari":case "list_ethiopic-numeric":case "list_georgian":case "list_gujarati":case "list_gurmukhi":case "list_hebrew":case "list_lao":case "list_malayalam":case "list_mongolian":case "list_myanmar":case "list_oriya":case "list_persian":case "list_tamil":case "list_telugu":case "list_thai":case "list_tibetan":command_expandList(a,
this,b);d=!0;break;case "list_disc":command_listDisc(a,this);d=!0;break;case "list_circle":command_listCircle(a,this);d=!0;break;case "list_square":command_listSquare(a,this);d=!0;break;case "list_disclosure-open":command_expandListBullet(a,this,b);d=!0;break;case "list_disclosure-closed":command_expandListBullet(a,this,b);d=!0;break;case "list_none_N":command_listNone_N(a,this);d=!0;break;case "list_none_B":command_listNone_B(a,this);d=!0;break;case "full_screen":command_fullScreen(a,this);showRuler(this);
break;case "formatting":this._dextFormatting.show(a);d=!0;break;case "font_family":this._dextFontFamily.show(a);d=!0;break;case "font_size":this._dextFontSize.show(a);d=!0;break;case "font_size_inc":case "font_size_dec":command_fontSizeIncDec(a,b,this);d=!0;break;case "letter_spacing":this._dextLetterSpacing.show(a);d=!0;break;case "letter_spacing_inc":case "letter_spacing_dec":command_letterSpacingIncDec(a,b,this);d=!0;break;case "top_design":if("1"==this._config.topStatusBarLoading){var L=this;
showProcessingBackground();setTimeout(function(){try{L.setChangeMode("top_design"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)}else this.setChangeMode("top_design");break;case "top_source":"1"==this._config.topStatusBarLoading?(L=this,showProcessingBackground(),setTimeout(function(){try{L.setChangeMode("top_source"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("top_source");break;case "top_preview":"1"==
this._config.topStatusBarLoading?(L=this,showProcessingBackground(),setTimeout(function(){try{L.setChangeMode("top_preview"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("top_preview");break;case "top_text":"1"==this._config.topStatusBarLoading?(L=this,showProcessingBackground(),setTimeout(function(){try{L.setChangeMode("top_text"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("top_text");
break;case "design":"1"==this._config.statusBarLoading?(L=this,showProcessingBackground(),setTimeout(function(){try{L.setChangeMode("design"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("design");break;case "source":"1"==this._config.statusBarLoading?(L=this,showProcessingBackground(),setTimeout(function(){try{L.setChangeMode("source"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("source");
break;case "preview":"1"==this._config.statusBarLoading?(L=this,showProcessingBackground(),setTimeout(function(){try{L.setChangeMode("preview"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("preview");break;case "text":"1"==this._config.statusBarLoading?(L=this,showProcessingBackground(),setTimeout(function(){try{L.setChangeMode("text"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("text");
break;case "about":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.about);break;case "select_all":command_selectAll(a,this);break;case "valign_up":command_VerticalAlignExcute(a,this,"top");d=!0;break;case "valign_center":command_VerticalAlignExcute(a,this,"middle");d=!0;break;case "valign_baseline":command_VerticalAlignExcute(a,this,"baseline");d=!0;break;case "valign_bottom":command_VerticalAlignExcute(a,this,"bottom");d=!0;break;case "template":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.template);d=!0;break;case "tool_replace":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.tool_replace);break;case "insert_link_media":d=!0;null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_insert_link_media):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.insert_link_media);break;case "shortcut":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.shortcut);break;case "load_auto_save":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.load_auto_save);break;case "ruler":command_useRuler(a);break;case "layout":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.layout);d=!0;break;case "dirltr":command_Direction(a,this,"LTR");d=!0;break;case "dirrtl":command_Direction(a,
this,"RTL");d=!0;break;case "format_painter":command_formatPainter(a,this);break;case "apply_format":command_applyFormat(a,this);d=!0;break;case "image_align_default":command_imageAlign(a,this,"");d=!0;break;case "image_align_left":command_imageAlign(a,this,"left");d=!0;break;case "image_align_right":command_imageAlign(a,this,"right");d=!0;break;case "list_blockquote":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.blockquote);d=!0;break;case "placeholder":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.placeholder);d=!0;break;case "input_textfield":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_text);d=!0;break;case "input_radio":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_radio);d=!0;break;case "input_checkbox":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_checkbox);d=!0;break;case "input_button":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.input_button);d=!0;break;case "input_hiddenfield":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_hidden);d=!0;break;case "input_textarea_property":case "input_textarea":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_textarea);d=!0;break;case "input_select_property":case "input_select":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_select);d=!0;break;case "input_imagebutton":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.input_image);d=!0;break;case "input_same_width":command_inputSameWidthHeight(a,this,"width");d=!0;break;case "input_same_height":command_inputSameWidthHeight(a,this,"height");d=!0;break;case "input_same_width_height":command_inputSameWidthHeight(a,this,"widthheight");d=!0;break;case "accessibility_validation":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.accessibility_validation);break;case "horizontal_sum":case "vertical_sum":case "horizontal_avg":case "vertical_avg":case "horizontal_mul":case "vertical_mul":case "horizontal_sub":case "vertical_sub":case "horizontal_div":case "vertical_div":command_calculationFormula(a,
this,b);d=!0;break;case "show_blocks":command_showBlocks(a,this);break;case "table_lock":command_tableLock(a,this);d=!0;break;case "cell_lock":command_cellLock(a,this);d=!0;break;case "table_lock_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table_lock_property);d=!0;break;case "help":command_help(a,this);break;case "word_transform":command_wordTransform(a,this);d=!0;break;case "photo_editor":command_InsertImagePhotoEdit(a,this);d=!0;break;case "mini_photo_editor":var d=
!0,K=c?!0:!1;if(0==!!DEXTTOP.DEXT5.isClickedMiniPhoto){DEXTTOP.DEXT5.isClickedMiniPhoto=!0;c=DEXTTOP.G_SELECTED_ELEMENT;null!=c&&"IMG"!=c.tagName&&(c=null);executeMaxTotalFileSizeCheckProcess({editor:this,selectedElem:c,finalCallBackFn:function(a){command_InsertMiniPhotoEditor(a.ID,a,K)}});break}break;case "photo_editor_property":command_photoEditProperty(a,this);d=!0;break;case "table_border":command_showTableBorder(a,this);d=!0;break;case "pastetoimage":var L=this,W=window.URL||window.webkitURL||
window,G=W.createObjectURL(L.clipImageBlob),Q=new Image;Q.src=G;Q.onload=function(){if(validateWidthHeight(L._config,Q.width,Q.height)){var a=dext5_lang.msg.alert_exec_iamgesize;0!=L._config.maxImageWidthSize&&(a+=dext5_lang.msg.alert_width.replace("{0}",L._config.maxImageWidthSize),a+=" ");0!=L._config.maxImageHeightSize&&(a+=dext5_lang.msg.alert_height.replace("{0}",L._config.maxImageHeightSize));alert(a)}else{1==L.hasClipSvgText&&(a=Q.height,Q.width=getChangedSizeForPPTImage(Q.width),Q.height=
getChangedSizeForPPTImage(a),L._FRAMEWIN.G_PPTConvertedSize[G]={width:Q.width,height:Q.height});L.clipImageBeforePopup=Q;DEXT5_EDITOR.prototype.dialog.show(L._config.webPath.page,L._config.pages.pastetoimage);d=!0;try{W.revokeObjectURL(G)}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}};Q.onerror=function(){var a=function(){L._config.pasteToImage="0";""!=L.clipData&&command_pasteHtml5(L)};if("1"===Q.getAttribute("de_b64"))a();else{Q.setAttribute("de_b64","1");var b=new FileReader;
b.onload=function(a){Q.src=this.result};b.onerror=function(b){a()};b.readAsDataURL(L.clipImageBlob)}};break;case "insert_layer":command_insertLayer(a,this);d=!0;break;case "element_position":command_elementPosition(a,this);break;case "order_of_objects":this._dextElementZindex.show(a);d=!0;break;case "order_of_objects_detail":this._dextElementZindex.show(a);d=!0;break;case "bring_to_front":command_elementZindex(a,this,1);d=!0;break;case "send_to_back":command_elementZindex(a,this,2);d=!0;break;case "bring_forward":command_elementZindex(a,
this,3);d=!0;break;case "send_backward":command_elementZindex(a,this,4);d=!0;break;case "insert_datetime":command_insert_datetime(a,this);d=!0;break;case "detail_insert_datetime":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.insert_datetime);break;case "conversion":canConversion()?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.conversion):alert(dext5_lang.conversion.msg2);break;case "personal_data":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.personal_data);d=!0;break;case "forbidden_word":command_forbidden_word(a,this,"ICON");break;case "video":case "video_property":d=!0;null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_video):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.video);break;case "spell_check":d=!0;this._LastRange=g_findRepalceRange=null;doSetCaretPosition(_iframeDoc.body.firstChild,0);null==this.DEXT5WordApp&&(this.DEXT5WordApp=new ActiveXObject("Word.Application"),this.DEXT5WordDoc=this.DEXT5WordApp.Documents.Add());L=this;setTimeout(function(){DEXT5_EDITOR.prototype.dialog.show(L._config.webPath.page,L._config.pages.spell_check)},1E3);break;case "calculator":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.calculator);
break;case "zoom":this._dextzoom.show(a);break;case "zoom_plus":command_zoom(a,this,"p");break;case "zoom_minus":command_zoom(a,this,"m");break;case "paragraph_attribute":restoreSelection();c=getApplyNodes("p li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" "));e=c.length;DEXTTOP.G_SELECTED_ELEMENT=null;1==e&&(DEXTTOP.G_SELECTED_ELEMENT=c[0]);DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.paragraph_attribute);break;case "insert_table_top_paragraph":case "insert_table_bottom_paragraph":command_InsertTableTopBottomParagraph(b,
this);d=!0;break;case "body_fit":command_bodyFit(a,this);d=!0;break;case "hyperlink_open":case "filelink_open":window.open(DEXTTOP.G_SELECTED_ELEMENT.href);break;case "manually_temp_save":DEXTTOP.DEXT5.ManuallyTempSave(a);break;case "status_source":case "status_preview":case "status_text":G_LAST_CMD=-1<t.parentElement.className.indexOf("uebutton_span_enter")?"design":b.replace("status_","");"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode(G_LAST_CMD),
hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode(G_LAST_CMD);break;case "save_as_image":command_saveAsImage(a,DEXTTOP.G_SELECTED_ELEMENT,this);break;case "delete_pagebreak":c=G_CURSOR_ELEMENT;e=c.nextSibling;c&&c.tagName&&"DIV"==c.tagName&&"DEXT_fiVe_Page_Break"==c.className&&c.parentNode.removeChild(c);doSetCaretPosition(e,0);G_CURSOR_ELEMENT=e;DEXTTOP.G_CURREDITOR.UndoManager.putUndo();this._iconEnable("default");break;case "continue_numbering":c=
_dext_editor.orderedListObj.selectedNode;command_continueNumbering(c);break;case "set_numbering_value":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.set_numbering_value);break;case "set_numbering_from_first":G_DEPlugin.customliststyle?G_DEPlugin.customliststyle.setStartValue():(c=_dext_editor.orderedListObj,e=c.selectedNode,f=e.parentNode,command_SetNumberingValue(c,f.start,e,c.marker,f));break;case "set_list_adjustment":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.set_list_adjustment);break;case "sticky_table":case "sticky_top_row":case "sticky_first_column":m=null!=DEXTTOP.G_SELECTED_ELEMENT?DEXTTOP.G_SELECTED_ELEMENT:ActiveCurrTable,m=GetParentbyTagName(m,"table"),c=void 0==GetTableSelectionCells(DEXTTOP.G_SELECTED_ELEMENT)[0]?DEXTTOP.G_SELECTED_ELEMENT:GetTableSelectionCells(DEXTTOP.G_SELECTED_ELEMENT)[0],command_tableSticky(b,c,m)}DEXTTOP.DEXT5.browser.ie&&(DEXTTOP.G_CURREDITOR._RangeBlurBug=!1);if(b&&0==b.indexOf("p_")){if(a=b.split("_"),
e=c=a[1],2<a.length&&(e=a[2]),G_DEPlugin[c]&&G_DEPlugin[c].onClickToolIcon)G_DEPlugin[c].onClickToolIcon(e)}else b&&getCustomIconAttr(b).isCustom&&command_custom(a,this,getCustomIconAttr(b).command);0==DEXTTOP.G_CURREDITOR.backupWidthForIOS.isPopup&&AdjustDesignBodyWidth({editor:DEXTTOP.G_CURREDITOR,isApply:!1});DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.util.addEventEx(_iframeDoc,"selectionchange",_iframeDoc_selectionchange);onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:d});onCommand({editor:DEXTTOP.G_CURREDITOR,
cmd:b,tool:!0})}}},_dextzoom:{_zoomList:{},_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(a){return document.getElementById("dext_pan_zoom_"+a)},init:function(a){document.getElementById("ue_"+a+"zoom_text")&&(document.getElementById("ue_"+a+"zoom_text").value="100%")},make:function(a,b){var c=DEXTTOP.DEXTDOC.getElementById("dext_zoom_iframe_"+a);c&&c.parentNode.removeChild(c);(c=DEXTTOP.DEXTDOC.getElementById("dext_zoom_iframe_holder_"+
a))&&c.parentNode.removeChild(c);var d=this;if(null!=this._self(a)){d._editor_config=b;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.zoom;this._iframe_id="dext_zoom_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),
this._iframeHolder_id="dext_zoom_iframe_holder_"+a,this._iframeHolder.id=this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="75px",this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",
this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):(this._iframe.width="75px",this._iframe.height="200px",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframe.style.overflow="",this._iframe.style.overflowX="",DEXTTOP.DEXTDOC.body.appendChild(this._iframe));c="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";
c=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(c)+"}())":"";this._iframe.src=c;c="";isRTL(document)&&(c=' dir="rtl"');this._iframe_doc=this._iframe.contentWindow.document;c="<html"+c+"><head><title>"+dext5_lang.zoom.frame_title+"</title>";isCustomDomain(document)&&(c+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');c+='</head><body style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);
this._iframe_doc.open("text/html","replace");this._iframe_doc.write(c);this._iframe_doc.close();this._zoomList[a]=[];0<DEXTTOP.G_CURREDITOR._config.zoomList.length&&(this._zoomList[a]=this._zoomList[a].concat(DEXTTOP.G_CURREDITOR._config.zoomList));for(var c=this._zoomList[a].length,e=0;e<c;e++){var f=this._zoomList[a][e],g="lh_"+a+"_"+e;_item=this._iframe_doc.createElement("div");_item.setAttribute("id",g);_item.style.whiteSpace="nowrap";_item.style.fontSize="14px";_item.style.margin="3px";_item.style.padding=
"3px";_item.style.cursor="pointer";_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.innerHTML=f;_a_tag.style.textDecoration="none";_a_tag.style.color="black";_item.appendChild(_a_tag);f=function(b){return function(c){d.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(g);g=function(b){return function(c){d.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(e);DEXTTOP.DEXT5.util.addEvent(_item,"mouseover",f);DEXTTOP.DEXT5.util.addEvent(_item,"click",g);_item.onmousedown=
function(){return!1};_item.unselectable="on";this._iframe_doc.body.appendChild(_item)}DEXTTOP.DEXT5.util.addEvent(d._iframe_doc,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(d.hide(a),setTimeout(function(){setFocusToBody()},1))})}},mouseover_func:function(a,b){this.reset(a);this._iframe_doc.getElementById(b).style.backgroundColor="#e7e7e7"},click_func:function(a,b){var c=this.get_value(a,b);document.getElementById("ue_"+a+"zoom_text").value=c;command_zoom(a,document.getElementById("dext5_design_"+
a));this.hide(a);onChange({editor:DEXTTOP.G_CURREDITOR})},show:function(a){if(null!=DEXTTOP.G_CURREDITOR._config.zoomList){null==this._iframe&&this.make(a,DEXTTOP.G_CURREDITOR._config);G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);this._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(this._iframeHolder.id));this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);var b={},b=getWindowScrollPos(DEXTTOP.DEXTWIN),c=getClientRect(_iframeWin.parent.frameElement);
getClientRect(_iframeWin.frameElement);a=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+a+"zoom"));var d=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(d=-2);var e=a.left+b[0]+c.left-60;isRTL(document)&&(e=this._iframeHolder?DEXTTOP.DEXT5.util.parseIntOr0(this._iframeHolder.style.width):DEXTTOP.DEXT5.util.parseIntOr0(this._iframe.style.width),e=a.right+b[0]+c.left-60-(e+4),0>e&&(e=10));b=a.bottom+b[1]+c.top+d-222;this._iframeHolder?(this._iframeHolder.style.left=
e+"px",this._iframeHolder.style.top=b+"px",this._iframeHolder.style.display=""):(this._iframe.style.left=e+"px",this._iframe.style.top=b+"px");this._iframe.style.display="";var b=this._iframe.contentWindow,f=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&b.focus();setTimeout(function(){f.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(f,f.getElementsByTagName("A")[0])}},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);
document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="relative";this._iframe.style.display="none";this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(a){for(var b=this._iframe_doc.getElementsByTagName("div").length,c,d=0;d<b;d++)c="lh_"+a+"_"+d,this._iframe_doc.getElementById(c).style.backgroundColor=""},get_value:function(a,b){return this._zoomList[a][b]}},_dextDialog:{make:function(a,b){getDialogWindow();var c=getDialogDocument(),d;try{d=c.createElement("<iframe tabkey='-1' frameborder='0' scrolling='no'>")}catch(e){d=
c.createElement("iframe"),d.setAttribute("frameborder","0"),d.setAttribute("scrolling","no"),d.setAttribute("tabkey","-1")}d.title=dext5_lang.iframe_title.dialog;d.style.display="none";d.style.margin="0px";d.style.padding="0px";d.style.zIndex="1";var f=c.createElement("div");f.id="dext_dialog";f.style.display="none";f.style.position="absolute";isRTL(document)&&f.setAttribute("dir","rtl");if(""!=b.style.dialogBorderRadius)try{f.style.borderRadius=b.style.dialogBorderRadius}catch(g){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}if(""!=b.style.dialogBoxShadow)try{f.style.boxShadow=b.style.dialogBoxShadow}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(""!=b.style.dialogBorder)try{f.style.border=b.style.dialogBorder}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var q=c.createElement("div");q.id="EdiTor_Popup_header";DEXTTOP.DEXT5.util.setClass(q,"EdiTor_Popup_header");DEXTTOP.DEXT5.util.addEvent(f,"contextmenu",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});
var t=c.createElement("span");t.className="subject";var u=c.createElement("span");u.className="text";u.innerHTML=b.system_title;var v=c.createElement("div");v.className="closeDextDialog";v.id="dext_dialog_close";var w=c.createElement("a");w.title="close";w.href="javascript:void(0);";var y=c.createElement("span");y.style.display="none";y.innerText="close";w.appendChild(y);v.appendChild(w);q.appendChild(t);q.appendChild(u);q.appendChild(v);f.appendChild(q);q=c.createElement("div");DEXTTOP.DEXT5.browser.ie&&
8==DEXTTOP.DEXT5.browser.ieVersion&&(q.style.backgroundColor="#eeeeee",q.style.backgroundRepeat="no-repeat",q.style.backgroundPosition="50% 50%",q.style.backgroundImage="url("+b.webPath.image+"dialog/dailogmove.png)");q.appendChild(d);f.appendChild(q);v.onclick=function(){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1);for(var a in G_DEPlugin)if(G_DEPlugin[a].isProcess)return!1;"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&
null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&closeBtnPreViewMode();hideDialog(f,{isCancel:!0});return!1};d.setAttribute("id","dext_dialog_"+a);var x;try{x=c.createElement("<iframe tabkey='-1' frameborder='0' scrolling='no'>")}catch(z){x=c.createElement("iframe"),x.setAttribute("frameborder","0"),x.setAttribute("scrolling","no"),d.setAttribute("tabkey","-1")}x.style.display="block";x.style.position="absolute";
x.style.top="0";x.style.left="0";x.style.zIndex="-1";x.style.filter="alpha(opacity = 0)";x.style.width="100%";x.style.height="100%";x.title="Dialog Moving";f.appendChild(x);x.setAttribute("id","div_dlgmoveing_iframe_"+a);c.body.appendChild(f)}},_dextTable:{_getDextTable:function(a){return document.getElementById("dext_table_pan")},_self:function(a){return document.getElementById("dext_pan_table_insert_"+a)},make:function(a){var b=this;if(null!=this._self(a)){var c=document.createElement("table"),
d=document.createElement("tbody");c.setAttribute("id","dext_table_pan");var e,f,g;e=DEXTTOP.G_CURREDITOR._config.tableInsertDragSize.split(",");var h=e[0],m=e[1];this._self(a).style.width=18*m+1+"px";this._self(a).style.height=18*h+20+"px";for(var q=1;q<=h;q++){e=document.createElement("tr");for(var t="",u=1;u<=m;u++){t="trd_"+a+"_"+q+"_"+u;f=document.createElement("td");f.style.border="1px solid #000000";f.style.cursor="pointer";g=document.createElement("div");g.style.width="12px";g.style.height=
"12px";g.style.fontSize="1pt";var v=document.createElement("a");v.href="javascript:void(0);";v.style.width="12px";v.style.height="12px";v.style.marginTop="0px";v.style.marginLeft="0px";v.style.display="inline";v.title="\ud45c \uc0bd\uc785 \uc140";var w=document.createElement("span");w.style.display="none";w.title="\ud45c \uc0bd\uc785 \uc140";v.appendChild(w);g.appendChild(v);f.appendChild(g);f.setAttribute("id",t);e.appendChild(f);g=function(c){return function(d){b.mouseover_func(a,c);DEXTTOP.DEXT5.util.stopEvent(d)}}(t);
t=function(c){return function(d){b.click_func(a,c);DEXTTOP.DEXT5.util.stopEvent(d)}}(t);DEXTTOP.DEXT5.util.addEvent(f,"mouseover",g);DEXTTOP.DEXT5.util.addEvent(f,"click",t);t=function(c,e){return function(f){var g="which"in f?f.which:f.keyCode,h=function(a,b){d.childNodes[c-1+a]&&d.childNodes[c-1+a].childNodes[e-1+b]&&(d.childNodes[c-1+a].childNodes[e-1+b].getElementsByTagName("a")[0].focus(),is_next=!0,DEXTTOP.DEXT5.util.cancelEvent(f))};39==g?h(0,1):37==g?h(0,-1):40==g?h(1,0):38==g?h(-1,0):27==
g&&(b.hide(a),setTimeout(function(){setFocusToBody()},1))}}(q,u);DEXTTOP.DEXT5.util.addEvent(v,"focus",g);DEXTTOP.DEXT5.util.addEvent(v,"keydown",t);f.onmousedown=function(){return!1};f.unselectable="on"}d.appendChild(e)}c.appendChild(d);this._self(a).appendChild(c)}},show:function(a){null==this._getDextTable(a)&&this.make(a);G_SUB_DIALOG=this._self(a);var b=G_SUB_DIALOG.getElementsByTagName("a").length,c=G_SUB_DIALOG.getElementsByTagName("a")[0],d=G_SUB_DIALOG.getElementsByTagName("a")[b-1];this.reset(a);
DEXT5_EDITOR.prototype.dialog._click_background();setTimeout(function(){c.focus();setFocusFirstAndLast(document,c,d)},1);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background()},click_func:function(a,b){b=b.replace("trd_"+a+"_","");var c=b.split("_");command_InsertTablebyRowCol(a,document.getElementById("dext5_design_"+a),c[0],c[1]);onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"table_insert"});this.hide(a)},
mouseover_func:function(a,b){b=b.replace("trd_"+a+"_","");for(var c=b.split("_"),d="",d=DEXTTOP.G_CURREDITOR._config.tableInsertDragSize.split(","),e=d[0],f=d[1],g=1;g<=e;g++)for(var h=1;h<=f;h++)d="trd_"+a+"_"+g+"_"+h,document.getElementById(d).style.backgroundColor="#ffffff";for(g=1;g<=c[0];g++)for(h=1;h<=c[1];h++)d="trd_"+a+"_"+g+"_"+h,document.getElementById(d).style.backgroundColor="#0697f7";document.getElementById("dext_table_rc_"+a).innerHTML=c[0]+" * "+c[1]},reset:function(a){for(var b="",
b=DEXTTOP.G_CURREDITOR._config.tableInsertDragSize.split(","),c=b[0],d=b[1],e=1;e<=c;e++)for(var f=1;f<=d;f++)b="trd_"+a+"_"+e+"_"+f,document.getElementById(b).style.backgroundColor="#ffffff";document.getElementById("dext_table_rc_"+a).innerHTML="0 * 0"}},_dextFontFamily:{_fontFamily:{},_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(a){return document.getElementById("dext_pan_font_family_"+a)},make:function(a,
b){var c=DEXTTOP.DEXTDOC.getElementById("dext_fontfamily_iframe_"+a);c&&c.parentNode.removeChild(c);(c=DEXTTOP.DEXTDOC.getElementById("dext_fontfamily_iframe_holder_"+a))&&c.parentNode.removeChild(c);var d=this;null!=d._self(a)&&(d._editor_config=b,d._set_font_family(a,b),c=getIframeDocument(d._iframe),DEXTTOP.DEXT5.util.addEvent(c,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(d.hide(a),setTimeout(function(){setFocusToBody()},1))}))},_set_recently_font_family:function(a){var b=this;this._iframe_doc.getElementById("item_recently")&&
this._iframe_doc.getElementById("item_recently").parentNode.removeChild(this._iframe_doc.getElementById("item_recently"));if(DEXTTOP.DEXT5.browser.LocalStorageSupported){var c=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyFontName);if(null!=c&&void 0!=c&&""!=c){for(var c=parseRecentlyFont(c),d=[],e=0;e<this._fontFamily[a].length;e++)d.push(this.get_trimmed_font(this._fontFamily[a][e]));for(var e=!1,f=0;f<c.length;f++){var g=getDisplayFontName(c[f],DEXTTOP.G_CURREDITOR);0>d.indexOf(c[f])&&
0>this._fontFamily[a].indexOf(g)&&(c.splice(c.indexOf(c[f]),1),e=!0,--f)}e&&DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyFontName,JSON.stringify(c));d=this._iframe_doc.createElement("div");d.setAttribute("id","item_recently");e=this._iframe_doc.createElement("div");e.setAttribute("id","item_recently_tit");e.innerText=dext5_lang.font_family.recently_font;e.style.fontFamily="Tahoma,\ub3cb\uc6c0,Dotum,AppleGothic,sans-serif !important";e.style.fontSize="11px";e.style.whiteSpace=
"nowrap";e.style.padding="4px 3px 4px 6px";e.style.width="100%";e.style.backgroundColor="rgb(242, 242, 242)";e.style.color="rgb(138, 138, 138)";e.style.fontWeight="600";0==this._iframe_doc.body.childNodes.length?this._iframe_doc.body.appendChild(d):this._iframe_doc.body.insertBefore(d,this._iframe_doc.body.childNodes[0]);d.appendChild(e);e=c.length;for(f=0;f<e;f++){_font_family=c[f];g=this._fontFamily[a].indexOf(_font_family);-1==g&&(g=getDisplayFontName(_font_family),g=this._fontFamily[a].indexOf(g));
var h=getDisplayFontName(c[f])+"_r";_item_rfont=this._iframe_doc.createElement("div");_item_rfont.setAttribute("id",h);_item_rfont.style.fontSize="14px";_item_rfont.style.whiteSpace="nowrap";_item_rfont.style.margin="3px";_item_rfont.style.padding="3px";_item_rfont.style.cursor="pointer";_item_rfont.style.width="100%";_item_text=this._iframe_doc.createElement("span");var m=_font_family,m=getDisplayFontName(m);"textContent"in _item_text?_item_text.textContent=m:_item_text.innerText=m;_font_family=
changeFontFamily(_font_family);_item_text.style.fontFamily=_font_family;_item_text.onmousedown=function(){return!1};_item_text.unselectable="on";_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.appendChild(_item_text);_a_tag.style.textDecoration="none";_a_tag.style.color="black";h=function(c){return function(d){b.mouseover_func(a,c);DEXTTOP.DEXT5.util.stopEvent(d)}}(h);g=function(c,d){return function(d){b.click_func(a,c);DEXTTOP.DEXT5.util.stopEvent(d)}}(g,_item_rfont);
DEXTTOP.DEXT5.util.addEvent(_item_rfont,"mouseover",h);DEXTTOP.DEXT5.util.addEvent(_item_rfont,"click",g);_item_rfont.onmousedown=function(){return!1};_item_rfont.unselectable="on";_item_rfont.appendChild(_a_tag);d.appendChild(_item_rfont)}}}},_set_font_family:function(a,b){var c=this;if(null!=this._self(a)){var d,e;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.font_family;this._iframe_id="dext_fontfamily_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display=
"none";this._iframe.className="ue_combo_"+(""==b.skinName?"blue":b.skinName);DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),this._iframeHolder_id="dext_fontfamily_iframe_holder_"+a,this._iframeHolder.id=this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="180px",
this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):(this._iframe.width="180px",this._iframe.height="250px",this._iframe.style.width=
"180px",this._iframe.style.height="250px",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframe.style.overflow="",this._iframe.style.overflowX="",DEXTTOP.DEXTDOC.body.appendChild(this._iframe));var f="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",f=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(f)+
"}())":"";this._iframe.src=f;this._iframe_doc=this._iframe.contentWindow.document;f="";isRTL(document)&&(f=' dir="rtl"');f="<html"+f+"><head><title>"+dext5_lang.font_family.frame_title+"</title>";isCustomDomain(document)&&(f+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');""!=DEXTTOP.G_CURREDITOR._config.webFontCssUrl&&(f+='<link href="'+DEXTTOP.G_CURREDITOR._config.webFontCssUrl+'" rel="stylesheet" type="text/css">');f+='</head><body style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>';
getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(f);this._iframe_doc.close();c=this;if(G_DEPlugin.webfontloader){var g=function(a){"0"==G_DEPlugin.webfontloader.config.uselocalstorage?G_DEPlugin.webfontloader.loadWebFontCss(a):G_DEPlugin.webfontloader.loadWebFontFromLocalStorage(a)};if(G_DEPlugin.webfontloader.isRequiredCheck())g(c._iframe.contentWindow);else var h=setInterval(function(){G_DEPlugin.webfontloader.isRequiredCheck()&&(clearInterval(h),
g(c._iframe.contentWindow))},100)}this._fontFamily[a]=[];this._default_value=DEXTTOP.G_CURREDITOR._setting.font_family;0==this._default_value.length&&(this._default_value="gulim");this._fontFamily[a].push(this._default_value);if(DEXTTOP.DEXT5.browser.ie&&"1"==DEXTTOP.G_CURREDITOR._config.useLocalFont&&G_dialogHelper&&G_dialogHelper.fonts&&0<G_dialogHelper.fonts.count){var f=[],m=dlgHelper.fonts.count;for(d=1;d<m+1;d++)f.push(G_dialogHelper.fonts(d));f.sort();this._fontFamily[a]=this._fontFamily[a].concat(f)}else 0<
DEXTTOP.G_CURREDITOR._config.fontFamilyList.length&&(f=DEXTTOP.G_CURREDITOR._config.fontFamilyList.slice(),m=f.indexOf(this._default_value),-1<m&&f.splice(m,1),this._fontFamily[a]=this._fontFamily[a].concat(f));f=this._fontFamily[a].length;"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont&&this._set_recently_font_family(a);m=this._iframe_doc.createElement("div");m.setAttribute("id","item_all");this._iframe_doc.body.appendChild(m);"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont&&(d=this._iframe_doc.createElement("div"),
d.setAttribute("id","item_all_tit"),d.innerText=dext5_lang.font_family.all_font,d.style.fontFamily="Tahoma,\ub3cb\uc6c0,Dotum,AppleGothic,sans-serif !important",d.style.fontSize="11px",d.style.whiteSpace="nowrap",d.style.padding="4px 3px 4px 6px",d.style.width="100%",d.style.backgroundColor="rgb(242, 242, 242)",d.style.color="rgb(138, 138, 138)",d.style.fontWeight="600",m.appendChild(d));for(var q=0;q<f;q++){_font_family=this._fontFamily[a][q];var t="ff_"+a+"_"+q;d=this._iframe_doc.createElement("div");
d.setAttribute("id",t);d.style.fontSize="14px";d.style.whiteSpace="nowrap";d.style.margin="3px";d.style.padding="3px";d.style.cursor="pointer";d.style.width="100%";e=this._iframe_doc.createElement("span");var u=_font_family,u=getDisplayFontName(u);if(0==q){var v=dext5_lang.icon.font_family;"string"==typeof v&&0<v.length&&(u+="("+v+")")}"textContent"in e?e.textContent=u:e.innerText=u;_font_family=changeFontFamily(_font_family);e.style.fontFamily=_font_family;e.onmousedown=function(){return!1};e.unselectable=
"on";_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.appendChild(e);_a_tag.style.textDecoration="none";_a_tag.style.color="black";d.appendChild(_a_tag);e=function(b){return function(d){c.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(d)}}(t);t=function(b){return function(d){c.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(d)}}(q);DEXTTOP.DEXT5.util.addEvent(d,"mouseover",e);DEXTTOP.DEXT5.util.addEvent(d,"click",t);d.onmousedown=function(){return!1};d.unselectable=
"on";m.appendChild(d)}}},mouseover_func:function(a,b){this.reset(a);this._iframe_doc.getElementById(b).style.backgroundColor="#e7e7e7"},click_func:function(a,b,c){var d="",e=DEXTTOP.G_CURREDITOR._dextFontFamily;b=d=c&&0<c.length?c:e.get_value(a,b);b==e._default_value&&(b=dext5_lang.icon.font_family);"0"!=DEXTTOP.G_CURREDITOR._setting.show_font_real&&(b=d);"1"==DEXTTOP.G_CURREDITOR._config.useFontFamilyKeyin?document.getElementById("txtara_"+a+"font_family").value=getDisplayFontName(b):document.getElementById("ue_"+
a+"font_family").innerHTML="<span>"+getDisplayFontName(b)+"</span>";d=getRealNameThroughDisplayName(d);command_fontfamily(a,document.getElementById("dext5_design_"+a),d);c||e.hide(a);"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont&&(a=this.get_trimmed_font(d),DEXTTOP.DEXT5.browser.LocalStorageSupported&&(c=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyFontName),null==c||void 0==c||""==c?DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyFontName,JSON.stringify([a])):
(c=parseRecentlyFont(c),-1<c.indexOf(a)&&c.splice(c.indexOf(a),1),c.unshift(a),5<c.length&&(c.reverse(),c.shift(),c.reverse()),DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyFontName,JSON.stringify(c)))))},show:function(a){var b=DEXTTOP.G_CURREDITOR._dextFontFamily;null!=b._iframe&&"ios"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()||b.make(a,DEXTTOP.G_CURREDITOR._config);"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont&&b._set_recently_font_family(a);G_SUB_DIALOG=b._self(a);
G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(b._iframe_id);b._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(b._iframeHolder.id));b.reset(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),d=null,d="1"==DEXTTOP.G_CURREDITOR._config.useFontFamilyKeyin?getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("txtara_"+a+"font_family")):getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+
a+"font_family")),e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=-2);var f=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&(b._iframe.style.position="fixed",c[0]=0,c[1]=0);var g=d.left+c[0]+f.left;isRTL(document)&&(g=b._iframeHolder?DEXTTOP.DEXT5.util.parseIntOr0(b._iframeHolder.style.width):DEXTTOP.DEXT5.util.parseIntOr0(b._iframe.style.width),g=d.right+c[0]+f.left-(g+4),0>g&&(g=10));c=d.bottom+c[1]+f.top+e;b._iframeHolder?
(b._iframeHolder.style.left=g+"px",b._iframeHolder.style.top=c+"px",b._iframeHolder.style.display=""):(b._iframe.style.left=g+"px",b._iframe.style.top=c+"px");b._iframe.style.display="";changePosForCovered({popupNode:b._iframe,checkNode:b._iframe});var c=b._iframe.contentWindow,h=getIframeDocument(b._iframe);setZoomValueToBody(h,DEXTTOP.G_CURREDITOR);0==DEXTTOP.DEXT5.browser.ie&&c.focus();setTimeout(function(){h.getElementsByTagName("A")[0].focus()},1);c.scrollTo(0,0);setFocusFirstAndLast(h,h.getElementsByTagName("A")[0]);
try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterPopupShow?DEXTTOP.G_CURREDITOR._config.event.afterPopupShow(a,b._iframe,"fontfamily"):"function"==typeof DEXTTOP.dext_editor_afterpopupshow_event&&DEXTTOP.dext_editor_afterpopupshow_event(a,b._iframe,"fontfamily")}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe&&(this._iframe.style.display="none");
this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(a){if(DEXTTOP.DEXT5.browser.LocalStorageSupported&&"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont){var b=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyFontName);if(null!=b&&void 0!=b&&""!=b)for(var c=parseRecentlyFont(b),d,e=c.length,b=0;b<e;b++)d=getDisplayFontName(c[b])+"_r",d=this._iframe_doc.getElementById(d),1==!!d&&(d.style.backgroundColor="")}c=0;c="0"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont?
this._iframe_doc.getElementById("item_all").getElementsByTagName("div").length:this._iframe_doc.getElementById("item_all").getElementsByTagName("div").length-1;for(b=0;b<c;b++)e="ff_"+a+"_"+b,this._iframe_doc.getElementById(e).style.backgroundColor=""},get_value:function(a,b){return this._fontFamily[a][b]},get_trimmed_font:function(a,b){for(var c="",d=a.split(","),e=0;e<d.length;e++)""!=d[e]&&(c+='"'+DEXTTOP.DEXT5.util.trim(d[e])+'"',b||(c=c.replace(/"/g,"")),e<d.length-1&&(c+=","));return c}},_dextFontSize:{_fontSize:{},
_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(a){return document.getElementById("dext_pan_font_size_"+a)},make:function(a,b){var c=DEXTTOP.DEXTDOC.getElementById("dext_fontsize_iframe_"+a);c&&c.parentNode.removeChild(c);(c=DEXTTOP.DEXTDOC.getElementById("dext_fontsize_iframe_holder_"+a))&&c.parentNode.removeChild(c);var d=this;if(null!=d._self(a)){d._editor_config=b;this._iframe=DEXTTOP.DEXT5.util.makeIframe();
this._iframe.title=dext5_lang.iframe_title.font_size;this._iframe_id="dext_fontsize_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),this._iframeHolder_id="dext_fontsize_iframe_holder_"+a,this._iframeHolder.id=this._iframeHolder_id,
this._iframeHolder.style.display="none",this._iframeHolder.style.width="150px",this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):
(this._iframe.width="150px",this._iframe.height="270px",this._iframe.style.width="150px",this._iframe.style.height="270px",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframe.style.overflow="",this._iframe.style.overflowX="",DEXTTOP.DEXTDOC.body.appendChild(this._iframe));c="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";c=DEXTTOP.DEXT5.browser.ie&&
12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(c)+"}())":"";this._iframe.src=c;this._iframe_doc=this._iframe.contentWindow.document;c="";isRTL(document)&&(c=' dir="rtl"');c="<html"+c+"><head><title>"+dext5_lang.font_size.frame_title+"</title>";isCustomDomain(document)&&(c+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');c+='</head><body  style="margin:0px; padding:0px; " oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);
this._iframe_doc.open("text/html","replace");this._iframe_doc.write(c);this._iframe_doc.close();this._fontSize[a]=[];this._default_value=DEXTTOP.G_CURREDITOR._setting.font_size;0==this._default_value.length&&(this._default_value="12pt");this._fontSize[a].push(this._default_value);c=DEXTTOP.G_CURREDITOR._config.fontSizeList;if(0<c.length){var c=c.slice(),e=c.indexOf(this._default_value);-1<e&&c.splice(e,1);this._fontSize[a]=this._fontSize[a].concat(c)}c=this._fontSize[a].length;for(e=0;e<c;e++){_font_size=
this._fontSize[a][e];var f="fs_"+a+"_"+e;_item=this._iframe_doc.createElement("div");_item.setAttribute("id",f);_item.style.whiteSpace="nowrap";_item.style.margin="3px";_item.style.padding="5px";_item.style.cursor="pointer";_item.style.width="100%";var g="",g=-1<_font_size.indexOf("pt")?_font_size.replace("pt","")+" pt":-1<_font_size.indexOf("px")?_font_size.replace("px","")+" px":_font_size;if(0==e){var g=_font_size,h=dext5_lang.icon.font_size;"string"==typeof h&&0<h.length&&(g+="("+h+")")}1==b.style.isFontSizeUse?
_item.style.fontSize=_font_size:(_item.style.fontSize="10 pt",g="        "+_font_size);_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.innerHTML=g;_a_tag.style.textDecoration="none";_a_tag.style.color="black";_item.appendChild(_a_tag);f=function(b){return function(c){d.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(f);g=function(b){return function(c){d.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(e);DEXTTOP.DEXT5.util.addEvent(_item,"mouseover",f);DEXTTOP.DEXT5.util.addEvent(_item,
"click",g);_item.onmousedown=function(){return!1};_item.unselectable="on";this._iframe_doc.body.appendChild(_item)}DEXTTOP.DEXT5.util.addEvent(d._iframe_doc,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(d.hide(a),setTimeout(function(){setFocusToBody()},1))})}},mouseover_func:function(a,b){this.reset(a);this._iframe_doc.getElementById(b).style.backgroundColor="#e7e7e7"},click_func:function(a,b,c){var d="",e=DEXTTOP.G_CURREDITOR._dextFontSize;if(c&&0<c.length){d=parseFloat(c);if(isNaN(d))return;
d=c=0<c.indexOf("pt")?d+"pt":0<c.indexOf("px")?d+"px":0<c.indexOf("em")?d+"em":0<c.indexOf("%")?d+"%":d+"pt"}else d=e.get_value(a,b);b=d;b==e._default_value&&(b=dext5_lang.icon.font_size);"0"!=DEXTTOP.G_CURREDITOR._setting.show_font_real&&(b=d);"1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?document.getElementById("txtara_"+a+"font_size").value=b:document.getElementById("ue_"+a+"font_size").innerHTML="<span>"+b+"</span>";command_fontsize(a,document.getElementById("dext5_design_"+a),d);c||e.hide(a)},
show:function(a){var b=DEXTTOP.G_CURREDITOR._dextFontSize;null!=b._iframe&&"ios"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()||b.make(a,DEXTTOP.G_CURREDITOR._config);G_SUB_DIALOG=b._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(b._iframe_id);b._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(b._iframeHolder.id));b.reset(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),d=getClientRect(_iframeWin.parent.frameElement);
getClientRect(_iframeWin.frameElement);var e=null,e="1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("txtara_"+a+"font_size")):getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+a+"font_size")),f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(f=-2);isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&(b._iframe.style.position="fixed",c[0]=0,c[1]=0);var g=e.left+c[0]+d.left;isRTL(document)&&
(g=b._iframeHolder?DEXTTOP.DEXT5.util.parseIntOr0(b._iframeHolder.style.width):DEXTTOP.DEXT5.util.parseIntOr0(b._iframe.style.width),g=e.right+c[0]+d.left-(g+4),0>g&&(g=10));c=e.bottom+c[1]+d.top+f;b._iframeHolder?(b._iframeHolder.style.left=g+"px",b._iframeHolder.style.top=c+"px",b._iframeHolder.style.display=""):(b._iframe.style.left=g+"px",b._iframe.style.top=c+"px");b._iframe.style.display="";changePosForCovered({popupNode:b._iframe,checkNode:b._iframe});var c=b._iframe.contentWindow,h=getIframeDocument(b._iframe);
setZoomValueToBody(h,DEXTTOP.G_CURREDITOR);0==DEXTTOP.DEXT5.browser.ie&&c.focus();setTimeout(function(){h.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(h,h.getElementsByTagName("A")[0]);try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterPopupShow?DEXTTOP.G_CURREDITOR._config.event.afterPopupShow(a,b._iframe,"fontsize"):"function"==typeof DEXTTOP.dext_editor_afterpopupshow_event&&DEXTTOP.dext_editor_afterpopupshow_event(a,b._iframe,"fontsize")}catch(m){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe.style.display="none";this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(a){for(var b=this._iframe_doc.getElementsByTagName("div").length,c,d=0;d<b;d++)c="fs_"+a+"_"+d,this._iframe_doc.getElementById(c).style.backgroundColor=""},get_value:function(a,b){return this._fontSize[a][b]}},_dextFormatting:{_format:G_FORMATTING,_iframeHolder:null,
_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_self:function(a){return document.getElementById("dext_pan_formatting_"+a)},init:function(a){document.getElementById("ue_"+a+"formatting")&&(document.getElementById("ue_"+a+"formatting").innerHTML="<span>"+dext5_lang.icon.formatting+"</span>")},make:function(a,b){var c=DEXTTOP.DEXTDOC.getElementById("dext_formatting_iframe_"+a);c&&c.parentNode.removeChild(c);(c=DEXTTOP.DEXTDOC.getElementById("dext_formatting_iframe_holder_"+a))&&c.parentNode.removeChild(c);
var d=this;if(null!=d._self(a)){var e;0<DEXTTOP.G_CURREDITOR._config.formattingList.length&&(d._format=DEXTTOP.G_CURREDITOR._config.formattingList);c=d._format.length;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.formatting;this._iframe_id="dext_formatting_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow=
"hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),this._iframeHolder_id="dext_formatting_iframe_holder_"+a,this._iframeHolder.id=this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="230px",this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow=
"scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):(this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.width="230px",this._iframe.height="200px",this._iframe.style.width="230px",this._iframe.style.height="200px",DEXTTOP.DEXTDOC.body.appendChild(this._iframe));
e="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";e=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(e)+"}())":"";this._iframe.src=e;this._iframe_doc=this._iframe.contentWindow.document;e="";isRTL(document)&&(e=' dir="rtl"');e="<html"+e+"><head><title>"+dext5_lang.formatting.frame_title+"</title>";isCustomDomain(document)&&(e+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');
e+='</head><body style="margin:0px; padding:0px; " oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(e);this._iframe_doc.close();for(var f=null,g=0;g<c;g++){var h="fs_"+a+"_"+g;e=this._iframe_doc.createElement("div");e.setAttribute("id",h);e.style.whiteSpace="nowrap";e.style.width="96%";e.style.cursor="pointer";e.style.padding="3px";e.style.margin="3px";var m="("+d._format[g]+") Heading";""==d._format[g]?
(f=this._iframe_doc.createElement("span"),m=dext5_lang.icon.formatting):(f=this._iframe_doc.createElement(d._format[g]),f.style.margin="1px",f.style.padding="1px");f.style.fontFamily="Dotum Arial";_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.innerHTML=m;_a_tag.style.textDecoration="none";_a_tag.style.color="black";f.appendChild(_a_tag);e.innerHTML=f.outerHTML;f=function(b){return function(c){d.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(h);h=function(b){return function(c){d.click_func(a,
b);DEXTTOP.DEXT5.util.stopEvent(c)}}(g);DEXTTOP.DEXT5.util.addEvent(e,"mouseover",f);DEXTTOP.DEXT5.util.addEvent(e,"click",h);e.onmousedown=function(){return!1};e.unselectable="on";this._iframe_doc.body.appendChild(e)}document.getElementById("ue_"+a+"formatting").innerHTML="<span>"+dext5_lang.icon.formatting+"</span>";DEXTTOP.DEXT5.util.addEvent(d._iframe_doc,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(d.hide(a),setTimeout(function(){setFocusToBody()},1))})}},mouseover_func:function(a,
b){this.reset(a);this._iframe_doc.getElementById(b).style.backgroundColor="#e7e7e7"},click_func:function(a,b){var c=DEXTTOP.G_CURREDITOR._dextFormatting,d=c.get_value(a,b),e=d;""==e&&(e=dext5_lang.icon.formatting);document.getElementById("ue_"+a+"formatting").innerHTML="<span>"+e+"</span>";try{if(DEXTTOP.DEXT5.browser.ie){var f=getFirstRange(),g=f.range.startContainer,h=f.range.endContainer;if(3==g.nodeType&&1==h.nodeType&&g.parentNode==h&&1==f.range.endOffset){var m=h.lastChild,e=1;3==m.nodeType&&
(e=m.length);f.range.setEnd(m,e);f.sel.removeAllRanges();f.sel.addRange(f.range);null!=DEXTTOP.G_CURREDITOR._LastRange&&(DEXTTOP.G_CURREDITOR._LastRange=f.range)}}}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}command_formatting(a,document.getElementById("dext5_design_"+a),d);c.hide(a)},show:function(a){var b=DEXTTOP.G_CURREDITOR._dextFormatting;null!=b._iframe&&"ios"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()||b.make(a,DEXTTOP.G_CURREDITOR._config);G_SUB_DIALOG=b._self(a);
G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(b._iframe_id);b._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(b._iframeHolder.id));b.reset(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),d=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);var e=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+a+"formatting")),f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&
(f=-2);isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&(b._iframe.style.position="fixed",c[0]=0,c[1]=0);var g=e.left+c[0]+d.left;isRTL(document)&&(g=b._iframeHolder?DEXTTOP.DEXT5.util.parseIntOr0(b._iframeHolder.style.width):DEXTTOP.DEXT5.util.parseIntOr0(b._iframe.style.width),g=e.right+c[0]+d.left-(g+4),0>g&&(g=10));c=e.bottom+c[1]+d.top+f;b._iframeHolder?(b._iframeHolder.style.left=g+"px",b._iframeHolder.style.top=c+"px",b._iframeHolder.style.display=""):(b._iframe.style.left=g+"px",b._iframe.style.top=
c+"px");b._iframe.style.display="";changePosForCovered({popupNode:b._iframe,checkNode:b._iframe});var c=b._iframe.contentWindow,h=getIframeDocument(b._iframe);setZoomValueToBody(h,DEXTTOP.G_CURREDITOR);0==DEXTTOP.DEXT5.browser.ie&&c.focus();setTimeout(function(){h.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(h,h.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterPopupShow?DEXTTOP.G_CURREDITOR._config.event.afterPopupShow(a,
b._iframe,"formatting"):"function"==typeof DEXTTOP.dext_editor_afterpopupshow_event&&DEXTTOP.dext_editor_afterpopupshow_event(a,b._iframe,"formatting")}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe.style.display="none";this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(a){for(var b=this._iframe_doc.getElementsByTagName("div").length,
c,d=0;d<b;d++)c="fs_"+a+"_"+d,this._iframe_doc.getElementById(c).style.backgroundColor=""},get_value:function(a,b){return this._format[b]}},_dextLineHeight:{_lineHeight:{},_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(a){return document.getElementById("dext_pan_line_height_"+a)},init:function(a){var b="";if("1"==DEXTTOP.G_CURREDITOR._setting.show_font_real){var b=DEXTTOP.G_CURREDITOR._setting.line_height,c=!0,
d=DEXTTOP.G_CURREDITOR._config.lineHeightList[0];d&&0>d.indexOf("%")&&(c=!1);-1<b.indexOf("%")?c||(b=parseInt(b,10)/100):c&&(b=parseInt(100*b,10)+"%")}"1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin?document.getElementById("txtara_"+a+"line_height")&&("1"==DEXTTOP.G_CURREDITOR._setting.show_font_real?document.getElementById("txtara_"+a+"line_height").value=b:document.getElementById("txtara_"+a+"line_height").value=dext5_lang.icon.line_height):document.getElementById("ue_"+a+"line_height")&&("1"==
DEXTTOP.G_CURREDITOR._setting.show_font_real?document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+b+"</span>":document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+dext5_lang.icon.line_height+"</span>")},make:function(a,b){var c=DEXTTOP.DEXTDOC.getElementById("dext_lineheight_iframe_"+a);c&&c.parentNode.removeChild(c);(c=DEXTTOP.DEXTDOC.getElementById("dext_lineheight_iframe_holder_"+a))&&c.parentNode.removeChild(c);var d=this;if(null!=this._self(a)){d._editor_config=b;this._iframe=
DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.line_height;this._iframe_id="dext_lineheight_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),this._iframeHolder_id="dext_lineheight_iframe_holder_"+a,this._iframeHolder.id=
this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="140px",this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):
(this._iframe.width="140px",this._iframe.height="200px",this._iframe.style.width="140px",this._iframe.style.height="200px",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframe.style.overflow="",this._iframe.style.overflowX="",DEXTTOP.DEXTDOC.body.appendChild(this._iframe));c="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";c=DEXTTOP.DEXT5.browser.ie&&
12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(c)+"}())":"";this._iframe.src=c;this._iframe_doc=this._iframe.contentWindow.document;c="";isRTL(document)&&(c=' dir="rtl"');c="<html"+c+"><head><title>"+dext5_lang.line_height.frame_title+"</title>";isCustomDomain(document)&&(c+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');c+='</head><body style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);
this._iframe_doc.open("text/html","replace");this._iframe_doc.write(c);this._iframe_doc.close();this._lineHeight[a]=[];this._default_value=DEXTTOP.G_CURREDITOR._setting.line_height;var c=!0,e=DEXTTOP.G_CURREDITOR._config.lineHeightList[0];e&&0>e.indexOf("%")&&(c=!1);-1<this._default_value.indexOf("%")?c||(this._default_value=parseInt(this._default_value,10)/100):c&&(this._default_value=parseInt(100*this._default_value,10)+"%");0==this._default_value.length&&(this._default_value="1.2");this._lineHeight[a].push(this._default_value);
c=DEXTTOP.G_CURREDITOR._config.lineHeightList.slice();0<c.length&&(e=c.indexOf(this._default_value),-1<e&&c.splice(e,1),this._lineHeight[a]=this._lineHeight[a].concat(c));1==this._lineHeight[a].length&&(this._lineHeight[a]=this._lineHeight[a].concat(c));c=this._lineHeight[a].length;for(e=0;e<c;e++){_line_height=this._lineHeight[a][e];var f="lh_"+a+"_"+e;_item=this._iframe_doc.createElement("div");_item.setAttribute("id",f);_item.style.whiteSpace="nowrap";_item.style.fontSize="14px";_item.style.margin=
"3px";_item.style.padding="3px";_item.style.cursor="pointer";var g=_line_height;if(0==e){var h=dext5_lang.icon.line_height;"string"==typeof h&&0<h.length&&(g+="("+h+")")}_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.innerHTML=g;_a_tag.style.textDecoration="none";_a_tag.style.color="black";_item.appendChild(_a_tag);f=function(b){return function(c){d.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(f);g=function(b){return function(c){d.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(e);
DEXTTOP.DEXT5.util.addEvent(_item,"mouseover",f);DEXTTOP.DEXT5.util.addEvent(_item,"click",g);_item.onmousedown=function(){return!1};_item.unselectable="on";this._iframe_doc.body.appendChild(_item)}DEXTTOP.DEXT5.util.addEvent(d._iframe_doc,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(d.hide(a),setTimeout(function(){setFocusToBody()},1))})}},mouseover_func:function(a,b){this.reset(a);this._iframe_doc.getElementById(b).style.backgroundColor="#e7e7e7"},click_func:function(a,b,c){var d="",
e=DEXTTOP.G_CURREDITOR._dextLineHeight;if(c&&0<c.length){d=parseFloat(c);if(isNaN(d))return;d=c}else d=e.get_value(a,b);b=d;b==e._default_value&&(b=dext5_lang.icon.line_height);"0"!=DEXTTOP.G_CURREDITOR._setting.show_font_real&&(b=d);"1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin?document.getElementById("txtara_"+a+"line_height").value=b:document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+b+"</span>";command_lineHeight(a,document.getElementById("dext5_design_"+a),d);onCommand({editor:DEXTTOP.G_CURREDITOR,
cmd:"line_height"});c||e.hide(a)},show:function(a){var b=DEXTTOP.G_CURREDITOR._dextLineHeight;null!=b._iframe&&"ios"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()||b.make(a,DEXTTOP.G_CURREDITOR._config);G_SUB_DIALOG=b._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(b._iframe_id);b._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(b._iframeHolder.id));b.reset(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),d=getClientRect(_iframeWin.parent.frameElement);
getClientRect(_iframeWin.frameElement);var e=null,e="1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin?getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("txtara_"+a+"line_height")):getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+a+"line_height")),f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(f=-2);isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&(b._iframe.style.position="fixed",c[0]=0,c[1]=0);var g=e.left+c[0]+d.left;isRTL(document)&&
(g=b._iframeHolder?DEXTTOP.DEXT5.util.parseIntOr0(b._iframeHolder.style.width):DEXTTOP.DEXT5.util.parseIntOr0(b._iframe.style.width),g=e.right+c[0]+d.left-(g+4),0>g&&(g=10));c=e.bottom+c[1]+d.top+f;b._iframeHolder?(b._iframeHolder.style.left=g+"px",b._iframeHolder.style.top=c+"px",b._iframeHolder.style.display=""):(b._iframe.style.left=g+"px",b._iframe.style.top=c+"px");b._iframe.style.display="";changePosForCovered({popupNode:b._iframe,checkNode:b._iframe});var c=b._iframe.contentWindow,h=getIframeDocument(b._iframe);
setZoomValueToBody(h,DEXTTOP.G_CURREDITOR);0==DEXTTOP.DEXT5.browser.ie&&c.focus();setTimeout(function(){h.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(h,h.getElementsByTagName("A")[0]);try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterPopupShow?DEXTTOP.G_CURREDITOR._config.event.afterPopupShow(a,b._iframe,"lineheight"):"function"==typeof DEXTTOP.dext_editor_afterpopupshow_event&&DEXTTOP.dext_editor_afterpopupshow_event(a,b._iframe,"lineheight")}catch(m){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe.style.display="none";this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(a){for(var b=this._iframe_doc.getElementsByTagName("div").length,c,d=0;d<b;d++)c="lh_"+a+"_"+d,this._iframe_doc.getElementById(c).style.backgroundColor=""},get_value:function(a,b){return this._lineHeight[a][b]}},_dextLetterSpacing:{_letterSpacing:{},
_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(a){return document.getElementById("dext_pan_letter_spacing_"+a)},make:function(a,b){var c=this;if(null!=c._self(a)){c._editor_config=b;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.letter_spacing;this._iframe.width="85px";this._iframe.height="270px";this._iframe.style.width="85px";this._iframe.style.height="270px";this._iframe_id="dext_letterspacing_iframe_"+a;
this._iframe.id=this._iframe_id;this._iframe.style.display="none";this._iframe.style.border="2px solid #cccccc";this._iframe.style.position="absolute";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.overflow="";this._iframe.style.overflowX="";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);var d="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",d=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+
encodeURIComponent(d)+"}())":"";this._iframe.src=d;this._iframe_doc=this._iframe.contentWindow.document;d="";isRTL(document)&&(d=' dir="rtl"');d="<html"+d+"><head><title>"+dext5_lang.letter_spacing.frame_title+"</title>";isCustomDomain(document)&&(d+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');d+='</head><body style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(d);
this._iframe_doc.close();this._letterSpacing[a]=[];this._default_value="";this._letterSpacing[a].push(this._default_value);for(var d=b.letterSpacingList.length,e=0;e<d;e++)_letter_spacing=b.letterSpacingList[e],this._letterSpacing[a].push(_letter_spacing);d=this._letterSpacing[a].length;for(e=0;e<d;e++){_letter_spacing=this._letterSpacing[a][e];var f="ls_"+a+"_"+e;_item=this._iframe_doc.createElement("div");_item.setAttribute("id",f);_item.style.whiteSpace="nowrap";_item.style.fontSize="14px";_item.style.margin=
"3px";_item.style.padding="3px";_item.style.cursor="pointer";var g="",g=0==e?dext5_lang.icon.letter_spacing:_letter_spacing;_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.innerHTML=g;_a_tag.style.textDecoration="none";_a_tag.style.color="black";_item.appendChild(_a_tag);f=function(b){return function(d){c.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(d)}}(f);g=function(b){return function(d){c.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(d)}}(e);DEXTTOP.DEXT5.util.addEvent(_item,
"mouseover",f);DEXTTOP.DEXT5.util.addEvent(_item,"click",g);_item.onmousedown=function(){return!1};_item.unselectable="on";this._iframe_doc.body.appendChild(_item)}}},mouseover_func:function(a,b){this.reset(a);this._iframe_doc.getElementById(b).style.backgroundColor="#e7e7e7"},click_func:function(a,b){var c=DEXTTOP.G_CURREDITOR._dextLetterSpacing,d=c.get_value(a,b),e=d;e==c._default_value&&(e=dext5_lang.icon.letter_spacing);document.getElementById("ue_"+a+"letter_spacing").innerHTML="<span>"+e+"</span>";
command_letterSpacing(a,DEXTTOP.G_CURREDITOR,d);c.hide(a)},show:function(a){var b=DEXTTOP.G_CURREDITOR._dextLetterSpacing;null!=b._iframe&&"ios"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()||b.make(a,DEXTTOP.G_CURREDITOR._config);G_SUB_DIALOG=b._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(b._iframe_id);b.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),d=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);
var e=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+a+"letter_spacing")),f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(f=-2);isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&(b._iframe.style.position="fixed",c[0]=0,c[1]=0);var g=e.left+c[0]+d.left;isRTL(document)&&(g=DEXTTOP.DEXT5.util.parseIntOr0(b._iframe.style.width),g=e.right+c[0]+d.left-(g+4),0>g&&(g=10));c=e.bottom+c[1]+d.top+f;b._iframe.style.left=g+"px";b._iframe.style.top=c+"px";b._iframe.style.display=
"";changePosForCovered({popupNode:b._iframe,checkNode:b._iframe});var c=b._iframe.contentWindow,h=getIframeDocument(b._iframe);setZoomValueToBody(h,DEXTTOP.G_CURREDITOR);0==DEXTTOP.DEXT5.browser.ie&&c.focus();setTimeout(function(){h.getElementsByTagName("A")[0].focus()},1);DEXTTOP.DEXT5.util.addEvent(h,"keyup",function(c){27==("which"in c?c.which:c.keyCode)&&(b.hide(a),setTimeout(function(){setFocusToBody()},1))});setFocusFirstAndLast(h,h.getElementsByTagName("A")[0])},hide:function(a){dialogCancel();
G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"},reset:function(a){for(var b=this._iframe_doc.getElementsByTagName("div").length,c,d=0;d<b;d++)c="ls_"+a+"_"+d,this._iframe_doc.getElementById(c).style.backgroundColor=""},get_value:function(a,b){return this._letterSpacing[a][b]}},_dextWorkProcessing:{_iframe:null,_iframe_id:"",_self:function(a){return document.getElementById("ue_editor_holder_"+a)},make:function(a,b){if(null!=this._self(a)){this._iframe=
DEXTTOP.DEXT5.util.makeIframe();this._iframe.title="dext5 work processing...";var c=this._self(a);this._iframe.width=c.clientWidth-10+"px";this._iframe.height="200px";this._iframe_id="dext_workprocessing_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";this._iframe.style.border="0px solid #cccccc";this._iframe.style.position="absolute";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);c="document.open();"+(isCustomDomain(document)?
'document.domain="'+document.domain+'";':"")+" document.close();";c=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(c)+"}())":"";this._iframe.src=c;this._iframe_doc=this._iframe.contentWindow.document;c="";isRTL(document)&&(c=' dir="rtl"');c="<html"+c+"><head><title>"+this._iframe.title+'</title></head><body  style="margin:0px; padding:0px;" oncontextmenu="return false"><div style="text-align:center;"></div></body></html>';getDocWindow(this._iframe_doc);
this._iframe_doc.open("text/html","replace");isCustomDomain(document)&&(this._iframe_doc.domain=document.domain);this._iframe_doc.write(c);this._iframe_doc.close()}},show:function(a){setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);a={};a=getWindowScrollPos(DEXTTOP.DEXTWIN);var b=getClientRect(G_SUB_DIALOG),c=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);this._iframe.style.left=b.left+a[0]+c.left+
"px";this._iframe.style.top=b.top+a[1]+c.top+50+"px";this._iframe.style.display=""},hide:function(a){dialogCancel();this._iframe.style.display="none"}},_dextListNumber:{_iframe:null,_iframe_id:"",_line_number_item:"list_decimal list_decimal_leading_zero list_lower_alpha list_lower_greek list_lower_roman list_upper_alpha list_upper_roman list_none".split(" "),_self:function(a){return document.getElementById("dext_pan_detail_list_number_"+a)},make:function(a){var b=DEXTTOP.DEXTDOC.getElementById("dext_detail_list_number_iframe_"+
a);b&&b.parentNode.removeChild(b);var c=this;if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe_id="dext_detail_list_number_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position="absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency=
"true";if(1==_dext_editor._config.expandListItem&&!DEXTTOP.DEXT5.browser.ie){var d,b=_dext_editor._config.expandListUrl;d=DEXTTOP.DEXT5.util.ajax.xml_http_request();d.onreadystatechange=function(a){if(4==d.readyState)if(200==d.status){var b=d.responseXML;if(null==b||""==b.xml)b=DEXTTOP.DEXT5.util.stringToXML(d.responseText);if(null==b||""==b.xml)try{if(b={strType:"ListNumber",strCode:"1003",strMessage:"ErrCode : 1003"},"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError)DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,
b);else"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event?DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,b):alert(b.strMessage)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else{a=c._line_number_item;b=b.documentElement.children[0].children;a.push("");for(var f=0;f<b.length;f++)a.push("list_"+b[f].innerHTML)}}else if(404==d.status)try{if(b={strType:"ListNumber",strCode:"1003",strMessage:"ErrCode : 1003"},"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError)DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,
b);else"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event?DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,b):alert(b.strMessage)}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};d.open("GET",b+"?t="+(new Date).getTime(),!1);d.send()}b=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)b=2;this._iframe.style.width=180+b+"px";b=this._line_number_item.length;7==DEXTTOP.DEXT5.browser.ieVersion&&(b-=2);b=1!=_dext_editor._config.expandListItem||
DEXTTOP.DEXT5.browser.ie?24*b+2:402;1!=getDEXTWINZoomValue(DEXTTOP.G_CURREDITOR)&&(b+=1);this._iframe.style.height=b+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";this._iframe.src=b;this._iframe_doc=this._iframe.contentWindow.document;
var e=b="",e=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,f="editor_context.css";"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(f="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var g="";isRTL(document)&&(g=' dir="rtl"');b+="<html"+g+"><head>";isCustomDomain(document)&&(b+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');b+='<link rel="stylesheet" type="text/css" href="'+e+f+"?t="+DEXTTOP.DEXT5.UrlStamp+
'" charset="utf-8">';"1"==DEXTTOP.G_CURREDITOR._config.customCssUrlDetailApply&&(b+='<link rel="stylesheet" type="text/css" href="'+DEXTTOP.G_CURREDITOR._config.style.customCssUrl+"?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">');b+='<link rel="stylesheet" type="text/css" href="'+e+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">';isRTL(document)&&(b+='<link rel="stylesheet" type="text/css" href="'+e+"editor_context_rtl.css?t="+DEXTTOP.DEXT5.UrlStamp+
'" charset="utf-8">');b+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_number_iframe_bg">';b+='<div class="DEXT_fiVe_ED_popup">';b+='<div class="DEXT_fiVe_EDP">';b+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';b=1!=_dext_editor._config.expandListItem||DEXTTOP.DEXT5.browser.ie?b+'<dl id="div_line_number_main"><dt>number_group</dt></dl>':
b+'<dl id="div_line_number_main" style="overflow-y:scroll; height:400px;"><dt>number_group</dt></dl>';b+="</div>";b+="</div>";b+="</div>";b+="</div>";b+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(b);this._iframe_doc.close();b=this._iframe_doc.getElementById("div_line_number_main");e=c._line_number_item.length;for(f=0;f<e;f++){var g=c._line_number_item[f],h=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<h;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==
g)return;if(7!=DEXTTOP.DEXT5.browser.ieVersion||"list_decimal_leading_zero"!=g&&"list_lower_greek"!=g){h=this._iframe_doc.createElement("dd");h.id=g;if(""==h.id)h.className="b_border";else{var m=c.getImageIconUrl(g),q=c.getText(g),t=this._iframe_doc.createElement("div"),u=this._iframe_doc.createElement("div"),v=this._iframe_doc.createElement("span");0<m.length&&(v.className=g,t.appendChild(v));"textContent"in u?u.textContent=q:u.innerText=q;t.className="s_left";u.className="s_right";var w=this._iframe_doc.createElement("a");
w.href="javascript:void(0);";w.title=q;w.style.textDecoration="none";w.style.color="#545454";w.style.cursor="pointer";w.appendChild(t);w.appendChild(u);h.appendChild(w);var m=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(w,"focus",y);DEXTTOP.DEXT5.util.removeEvent(w,"blur",x);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),q=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(w,"focus",y);DEXTTOP.DEXT5.util.addEvent(w,"blur",x);
"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),y=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),x=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),c=this,t=function(a){return function(b){"list_none"==a.id&&(a.id+="_N");_dext_editor._dextCommands(_dext_editor.ID,a.id);c.hide(_dext_editor.ID);DEXTTOP.DEXT5.util.stopEvent(b)}}(h);
DEXTTOP.DEXT5.util.addEvent(h,"mouseover",m);DEXTTOP.DEXT5.util.addEvent(h,"mouseout",q);DEXTTOP.DEXT5.util.addEvent(h,"click",t);DEXTTOP.DEXT5.util.addEvent(w,"focus",y);DEXTTOP.DEXT5.util.addEvent(w,"blur",x);0<g.length&&(h.id=g);h.unselectable="on"}b.appendChild(h)}}DEXTTOP.DEXT5.util.addEvent(c._iframe_doc,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(c.hide(a),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(a){var b="";""!=a&&(b=DEXTTOP.G_CURREDITOR._config.webPath.image+
DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif");return b},getText:function(a){var b="";""!=a&&(b=dext5_lang.icon[a]);return b},show:function(a){var b=DEXTTOP.G_CURREDITOR._dextListNumber;null==b._iframe&&b.make(a);setFocusTopWindow();G_SUB_DIALOG=b._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(b._iframe_id);DEXT5_EDITOR.prototype.dialog._click_background(!0);a={};a=getWindowScrollPos(DEXTTOP.DEXTWIN);var c=getClientRect(G_SUB_DIALOG),d=getClientRect(_iframeWin.parent.frameElement),
e=getClientRect(_iframeWin.frameElement),f=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)f+=2;var g=0;c.left+f>=e.right&&(g=c.left+f-e.right+30);e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=-15);f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(f=6);isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&(b._iframe.style.position="fixed",a[0]=0,a[1]=0);g=c.left+a[0]+d.left+e-g;isRTL(document)&&(g=DEXTTOP.DEXT5.util.parseIntOr0(b._iframe.style.width),g=c.right+a[0]+d.left-(g+-18)+
e,0>g&&(g=10));a=c.bottom+a[1]+d.top+f;b._iframe.style.left=g+"px";b._iframe.style.top=a+"px";b._iframe.style.display="";changePosForCovered({popupNode:b._iframe,checkNode:b._iframe});a=b._iframe.contentWindow;var h=getIframeDocument(b._iframe);setZoomValueToBody(h,DEXTTOP.G_CURREDITOR);0==DEXTTOP.DEXT5.browser.ie&&a.focus();setTimeout(function(){h.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(h,h.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background(!0);
this._iframe.style.display="none"}},_dextListBullets:{_iframe:null,_iframe_id:"",_line_bullets_item:["list_disc","list_circle","list_square","list_none"],_self:function(a){return document.getElementById("dext_pan_detail_list_bullets_"+a)},make:function(a){var b=DEXTTOP.DEXTDOC.getElementById("dext_detail_list_bullets_iframe_"+a);b&&b.parentNode.removeChild(b);var c=this;if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe_id="dext_detail_list_bullets_iframe_"+a;this._iframe.id=
this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position="absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency="true";if(1==_dext_editor._config.expandListItem&&!DEXTTOP.DEXT5.browser.ie){var d,b=_dext_editor._config.expandListUrl;d=DEXTTOP.DEXT5.util.ajax.xml_http_request();d.onreadystatechange=
function(a){if(4==d.readyState)if(200==d.status){var b=d.responseXML;if(null==b||""==b.xml)b=DEXTTOP.DEXT5.util.stringToXML(d.responseText);if(null==b||""==b.xml)try{if(b={strType:"ListBullet",strCode:"1003",strMessage:"ErrCode : 1003"},"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError)DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,b);else"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event?DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,
b):alert(b.strMessage)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else{a=c._line_bullets_item;b=b.documentElement.children[1].children;a.push("");for(var f=0;f<b.length;f++)a.push("list_"+b[f].innerHTML)}}else if(404==d.status)try{if(b={strType:"ListBullet",strCode:"1003",strMessage:"ErrCode : 1003"},"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError)DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,b);else"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event?
DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,b):alert(b.strMessage)}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};d.open("GET",b+"?t="+(new Date).getTime(),!1);d.send()}b=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)b=2;this._iframe.style.width=180+b+"px";var b=this._line_bullets_item.length,e=24*b+2;-1<this._line_bullets_item.indexOf("")&&(e=24*(b-1)+4);1!=getDEXTWINZoomValue(DEXTTOP.G_CURREDITOR)&&(e+=1);this._iframe.style.height=
e+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";this._iframe.src=b;this._iframe_doc=this._iframe.contentWindow.document;var e=b="",e=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,
f="editor_context.css";"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(f="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var g="";isRTL(document)&&(g=' dir="rtl"');b+="<html"+g+"><head>";isCustomDomain(document)&&(b+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');b+='<link rel="stylesheet" type="text/css" href="'+e+f+"?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">';"1"==DEXTTOP.G_CURREDITOR._config.customCssUrlDetailApply&&(b+='<link rel="stylesheet" type="text/css" href="'+
DEXTTOP.G_CURREDITOR._config.style.customCssUrl+"?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">');b+='<link rel="stylesheet" type="text/css" href="'+e+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">';isRTL(document)&&(b+='<link rel="stylesheet" type="text/css" href="'+e+"editor_context_rtl.css?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">');b+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">';
b+='<div class="DEXT_fiVe_ED_popup">';b+='<div class="DEXT_fiVe_EDP">';b+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';b+='<dl id="div_line_bullets_main"><dt>bullets_group</dt></dl>';b+="</div>";b+="</div>";b+="</div>";b+="</div>";b+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(b);this._iframe_doc.close();b=this._iframe_doc.getElementById("div_line_bullets_main");e=c._line_bullets_item.length;
for(f=0;f<e;f++){var g=c._line_bullets_item[f],h=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<h;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==g)return;h=this._iframe_doc.createElement("dd");h.id=g;if(""==h.id)h.className="b_border";else{var m=c.getImageIconUrl(g),q=c.getText(g),t=this._iframe_doc.createElement("div"),u=this._iframe_doc.createElement("div"),v=this._iframe_doc.createElement("span");0<m.length&&(v.className=g,t.appendChild(v));"textContent"in u?u.textContent=q:u.innerText=q;t.className=
"s_left";u.className="s_right";var w=this._iframe_doc.createElement("a");w.href="javascript:void(0);";w.title=q;w.style.textDecoration="none";w.style.color="#545454";w.style.cursor="pointer";w.appendChild(t);w.appendChild(u);h.appendChild(w);var m=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(w,"focus",y);DEXTTOP.DEXT5.util.removeEvent(w,"blur",x);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),q=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(w,
"focus",y);DEXTTOP.DEXT5.util.addEvent(w,"blur",x);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),y=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),x=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),c=this,t=function(a){return function(b){"list_none"==a.id&&(a.id+="_B");_dext_editor._dextCommands(_dext_editor.ID,a.id);c.hide();
DEXTTOP.DEXT5.util.stopEvent(b)}}(h);DEXTTOP.DEXT5.util.addEvent(h,"mouseover",m);DEXTTOP.DEXT5.util.addEvent(h,"mouseout",q);DEXTTOP.DEXT5.util.addEvent(h,"click",t);DEXTTOP.DEXT5.util.addEvent(w,"focus",y);DEXTTOP.DEXT5.util.addEvent(w,"blur",x);0<g.length&&(h.id=g);h.unselectable="on"}b.appendChild(h)}DEXTTOP.DEXT5.util.addEvent(c._iframe_doc,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(c.hide(a),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(a){var b="";
""!=a&&(b=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif");return b},getText:function(a){var b="";""!=a&&(b=dext5_lang.icon[a]);return b},show:function(a){var b=DEXTTOP.G_CURREDITOR._dextListBullets;null==b._iframe&&b.make(a);setFocusTopWindow();G_SUB_DIALOG=b._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(b._iframe_id);DEXT5_EDITOR.prototype.dialog._click_background(!0);a={};a=getWindowScrollPos(DEXTTOP.DEXTWIN);var c=getClientRect(G_SUB_DIALOG),
d=getClientRect(_iframeWin.parent.frameElement),e=getClientRect(_iframeWin.frameElement),f=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)f+=2;var g=0;c.left+f>=e.right&&(g=c.left+f-e.right+30);e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=-15);f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(f=6);isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&(b._iframe.style.position="fixed",a[0]=0,a[1]=0);var h=c.left+a[0]+d.left+e-g;isRTL(document)&&(h=DEXTTOP.DEXT5.util.parseIntOr0(b._iframe.style.width),
h=c.right+a[0]+d.left-(h+-18)+e-g,0>h&&(h=10));a=c.bottom+a[1]+d.top+f;b._iframe.style.left=h+"px";b._iframe.style.top=a+"px";b._iframe.style.display="";changePosForCovered({popupNode:b._iframe,checkNode:b._iframe});a=b._iframe.contentWindow;var m=getIframeDocument(b._iframe);setZoomValueToBody(m,DEXTTOP.G_CURREDITOR);0==DEXTTOP.DEXT5.browser.ie&&a.focus();setTimeout(function(){m.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(m,m.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=
!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe.style.display="none"}},_dextListAligns:{_iframe:null,_iframe_id:"",_line_align_item:["align_left","align_center","align_right","align_full"],_self:function(a){return document.getElementById("dext_span_align_group_detail_"+a)},make:function(a){var b=DEXTTOP.DEXTDOC.getElementById("dext_detail_align_group_iframe_"+a);b&&b.parentNode.removeChild(b);var c=this;if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();
this._iframe_id="dext_detail_align_group_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position="absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency="true";b=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)b=2;this._iframe.style.width=
180+b+"px";this._iframe.style.height=24*this._line_align_item.length+2+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";this._iframe.src=b;this._iframe_doc=this._iframe.contentWindow.document;var b="",b=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:
DEXTTOP.G_CURREDITOR._config.webPath.css_dev,d="editor_context.css";"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(d="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var e="";isRTL(document)&&(e=' dir="rtl"');e=""+("<html"+e+"><head>");isCustomDomain(document)&&(e+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');e+='<link rel="stylesheet" type="text/css" href="'+b+d+"?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">';"1"==DEXTTOP.G_CURREDITOR._config.customCssUrlDetailApply&&
(e+='<link rel="stylesheet" type="text/css" href="'+DEXTTOP.G_CURREDITOR._config.style.customCssUrl+"?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">');e+='<link rel="stylesheet" type="text/css" href="'+b+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">';isRTL(document)&&(e+='<link rel="stylesheet" type="text/css" href="'+b+"editor_context_rtl.css?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">');e+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">';
e+='<div class="DEXT_fiVe_ED_popup">';e+='<div class="DEXT_fiVe_EDP">';e+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';e+='<dl id="div_align_group_main"><dt>align_group</dt></dl>';e+="</div>";e+="</div>";e+="</div>";e+="</div>";e+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(e);this._iframe_doc.close();b=this._iframe_doc.getElementById("div_align_group_main");d=c._line_align_item.length;for(e=
0;e<d;e++){var f=c._line_align_item[e],g=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<g;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==f)return;g=this._iframe_doc.createElement("dd");g.id=f;var h=c.getImageIconUrl(f),m=c.getText(f),q=this._iframe_doc.createElement("div"),t=this._iframe_doc.createElement("div"),u=this._iframe_doc.createElement("span");0<h.length&&(u.className=f,q.appendChild(u));"textContent"in t?t.textContent=m:t.innerText=m;q.className="s_left";t.className="s_right";var v=this._iframe_doc.createElement("a");
v.href="javascript:void(0);";v.title=m;v.style.textDecoration="none";v.style.color="#545454";v.style.cursor="pointer";v.appendChild(q);v.appendChild(t);g.appendChild(v);var h=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(v,"focus",w);DEXTTOP.DEXT5.util.removeEvent(v,"blur",y);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),m=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(v,"focus",w);DEXTTOP.DEXT5.util.addEvent(v,"blur",y);
"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),w=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),y=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),c=this,q=function(a){return function(b){_dext_editor._dextCommands(_dext_editor.ID,a.id);c.hide();DEXTTOP.DEXT5.util.stopEvent(b)}}(g);DEXTTOP.DEXT5.util.addEvent(g,"mouseover",
h);DEXTTOP.DEXT5.util.addEvent(g,"mouseout",m);DEXTTOP.DEXT5.util.addEvent(g,"click",q);DEXTTOP.DEXT5.util.addEvent(v,"focus",w);DEXTTOP.DEXT5.util.addEvent(v,"blur",y);0<f.length&&(g.id=f);g.unselectable="on";b.appendChild(g)}DEXTTOP.DEXT5.util.addEvent(c._iframe_doc,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(c.hide(a),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(a){var b="";""!=a&&(b=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+
"/"+a+".gif");return b},getText:function(a){var b="";""!=a&&(b=dext5_lang.icon[a]);return b},show:function(a){var b=DEXTTOP.G_CURREDITOR._dextListAligns;null==b._iframe&&b.make(a);setFocusTopWindow();G_SUB_DIALOG=b._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(b._iframe_id);DEXT5_EDITOR.prototype.dialog._click_background(!0);a={};a=getWindowScrollPos(DEXTTOP.DEXTWIN);var c=getClientRect(G_SUB_DIALOG),d=getClientRect(_iframeWin.parent.frameElement),e=getClientRect(_iframeWin.frameElement),
f=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)f+=2;var g=0;c.left+f>=e.right&&(g=c.left+f-e.right+30);e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=-15);f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(f=6);isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&(b._iframe.style.position="fixed",a[0]=0,a[1]=0);g=c.left+a[0]+d.left+e-g;isRTL(document)&&(g=DEXTTOP.DEXT5.util.parseIntOr0(b._iframe.style.width),g=c.right+a[0]+d.left-(g+-18)+e,0>g&&(g=10));a=c.bottom+a[1]+d.top+f;
b._iframe.style.left=g+"px";b._iframe.style.top=a+"px";b._iframe.style.display="";changePosForCovered({popupNode:b._iframe,checkNode:b._iframe});a=b._iframe.contentWindow;var h=getIframeDocument(b._iframe);setZoomValueToBody(h,DEXTTOP.G_CURREDITOR);0==DEXTTOP.DEXT5.browser.ie&&a.focus();setTimeout(function(){h.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(h,h.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background(!0);
this._iframe.style.display="none"}},_dextListTables:{_iframe:null,_iframe_id:"",_table_item:"insert_row_up insert_row_down insert_column_right insert_column_left delete_row delete_column table_delete merge_cell split_cell table_same_width table_same_height".split(" "),_self:function(a){return document.getElementById("dext_span_table_group_detail_"+a)},make:function(a){var b=DEXTTOP.DEXTDOC.getElementById("dext_detail_table_group_iframe_"+a);b&&b.parentNode.removeChild(b);var c=this;if(null!=this._self(a)){this._iframe=
DEXTTOP.DEXT5.util.makeIframe();this._iframe_id="dext_detail_table_group_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position="absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency="true";b=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)b=
2;this._iframe.style.width=180+b+"px";this._iframe.style.height=24*this._table_item.length+2+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";this._iframe.src=b;this._iframe_doc=this._iframe.contentWindow.document;var b="",b=DEXTTOP.DEXT5.isRelease?
DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,d="editor_context.css";"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(d="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var e="";isRTL(document)&&(e=' dir="rtl"');e=""+("<html"+e+"><head>");isCustomDomain(document)&&(e+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');e+='<link rel="stylesheet" type="text/css" href="'+b+d+"?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">';"1"==DEXTTOP.G_CURREDITOR._config.customCssUrlDetailApply&&
(e+='<link rel="stylesheet" type="text/css" href="'+DEXTTOP.G_CURREDITOR._config.style.customCssUrl+"?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">');e+='<link rel="stylesheet" type="text/css" href="'+b+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">';isRTL(document)&&(e+='<link rel="stylesheet" type="text/css" href="'+b+"editor_context_rtl.css?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">');e+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">';
e+='<div class="DEXT_fiVe_ED_popup">';e+='<div class="DEXT_fiVe_EDP">';e+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';e+='<dl id="div_table_group_main"><dt>table_group</dt></dl>';e+="</div>";e+="</div>";e+="</div>";e+="</div>";e+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(e);this._iframe_doc.close();for(var b=this._iframe_doc.getElementById("div_table_group_main"),d=c._table_item.length,
e=DEXTTOP.G_CURREDITOR.remove_item.length,f=0;f<d;f++){var g=c._table_item[f];for(r=0;r<e;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==g)return;var h=this._iframe_doc.createElement("dd");h.id=g;var m=c.getImageIconUrl(g),q=c.getText(g),t=this._iframe_doc.createElement("div"),u=this._iframe_doc.createElement("div"),v=this._iframe_doc.createElement("span");0<m.length&&(v.className=g,t.appendChild(v));"textContent"in u?u.textContent=q:u.innerText=q;t.className="s_left";u.className="s_right";var w=this._iframe_doc.createElement("a");
w.href="javascript:void(0);";w.title=q;w.style.textDecoration="none";w.style.color="#545454";w.style.cursor="pointer";w.appendChild(t);w.appendChild(u);h.appendChild(w);var m=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(w,"focus",y);DEXTTOP.DEXT5.util.removeEvent(w,"blur",x);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),q=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(w,"focus",y);DEXTTOP.DEXT5.util.addEvent(w,"blur",x);
"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),y=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),x=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),c=this,t=function(a){return function(b){"item_disabled"!=a.className&&(_dext_editor._dextCommands(_dext_editor.ID,a.id),c.hide(),DEXTTOP.DEXT5.util.stopEvent(b))}}(h);DEXTTOP.DEXT5.util.addEvent(h,
"mouseover",m);DEXTTOP.DEXT5.util.addEvent(h,"mouseout",q);DEXTTOP.DEXT5.util.addEvent(h,"click",t);DEXTTOP.DEXT5.util.addEvent(w,"focus",y);DEXTTOP.DEXT5.util.addEvent(w,"blur",x);0<g.length&&(h.id=g);h.unselectable="on";b.appendChild(h)}DEXTTOP.DEXT5.util.addEvent(c._iframe_doc,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(c.hide(a),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(a){var b="";""!=a&&(b=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+
"/"+a+".gif");return b},getText:function(a){var b="";""!=a&&(b=dext5_lang.icon[a]);return b},show:function(a){var b=DEXTTOP.G_CURREDITOR._dextListTables;null==b._iframe&&b.make(a);try{DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}setFocusTopWindow();G_SUB_DIALOG=b._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(b._iframe_id);DEXT5_EDITOR.prototype.dialog._click_background(!0);a={};a=getWindowScrollPos(DEXTTOP.DEXTWIN);
var d=getClientRect(G_SUB_DIALOG),e=getClientRect(_iframeWin.parent.frameElement),f=getClientRect(_iframeWin.frameElement),g=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)g+=2;var h=0;d.left+g>=f.right&&(h=d.left+g-f.right+30);f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(f=-15);g=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(g=6);isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&(b._iframe.style.position="fixed",a[0]=0,a[1]=0);h=d.left+a[0]+e.left+f-h;isRTL(document)&&(h=
DEXTTOP.DEXT5.util.parseIntOr0(b._iframe.style.width),h=d.right+a[0]+e.left-(h+-18)+f,0>h&&(h=10));a=d.bottom+a[1]+e.top+g;b._iframe.style.left=h+"px";b._iframe.style.top=a+"px";b._iframe.style.display="";changePosForCovered({popupNode:b._iframe,checkNode:b._iframe});a=DEXT5_TOPMENU._disabeld_menu;e=b._table_item.length;d=a.length;for(h=0;h<e;h++)if(f=G_CURRENT_IFRAME.contentWindow.document.getElementById(b._table_item[h]))f.className="",removeAttribute(f,"class");for(e=0;e<d;e++)if(h=G_CURRENT_IFRAME.contentWindow.document.getElementById(a[e]))h.className=
"item_disabled";a=b._iframe.contentWindow;var m=getIframeDocument(b._iframe);0==DEXTTOP.DEXT5.browser.ie&&a.focus();setTimeout(function(){m.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(m,m.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe.style.display="none"}},_dextElementZindex:{_iframe:null,_iframe_id:"",_zindex_item:["bring_to_front","send_to_back","bring_forward","send_backward"],
_self:function(a){return document.getElementById("dext_span_order_of_objects_detail_"+a)},make:function(a){var b=DEXTTOP.DEXTDOC.getElementById("dext_order_of_objects_detail_iframe_"+a);b&&b.parentNode.removeChild(b);var c=this;if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe_id="dext_order_of_objects_detail_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position=
"absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency="true";b=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)b=2;this._iframe.style.width=180+b+"px";this._iframe.style.height=24*this._zindex_item.length+2+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);b="document.open();"+(isCustomDomain(document)?'document.domain="'+
document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";this._iframe.src=b;this._iframe_doc=this._iframe.contentWindow.document;var b="",b=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,d="editor_context.css";"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(d="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var e="";
isRTL(document)&&(e=' dir="rtl"');e=""+("<html"+e+"><head>");isCustomDomain(document)&&(e+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');e+='<link rel="stylesheet" type="text/css" href="'+b+d+"?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">';"1"==DEXTTOP.G_CURREDITOR._config.customCssUrlDetailApply&&(e+='<link rel="stylesheet" type="text/css" href="'+DEXTTOP.G_CURREDITOR._config.style.customCssUrl+"?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">');e+='<link rel="stylesheet" type="text/css" href="'+
b+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">';e+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">';e+='<div class="DEXT_fiVe_ED_popup">';e+='<div class="DEXT_fiVe_EDP">';e+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';e+='<dl id="div_order_of_objects_main"><dt>Order of Objects</dt></dl>';
e+="</div>";e+="</div>";e+="</div>";e+="</div>";e+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(e);this._iframe_doc.close();b=this._iframe_doc.getElementById("div_order_of_objects_main");d=c._zindex_item.length;for(e=0;e<d;e++){var f=c._zindex_item[e],g=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<g;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==f)return;g=this._iframe_doc.createElement("dd");g.id=f;var h=c.getImageIconUrl(f),
m=c.getText(f),q=this._iframe_doc.createElement("div"),t=this._iframe_doc.createElement("div"),u=this._iframe_doc.createElement("span");0<h.length&&(u.className=f,q.appendChild(u));"textContent"in t?t.textContent=m:t.innerText=m;q.className="s_left";t.className="s_right";var v=this._iframe_doc.createElement("a");v.href="javascript:void(0);";v.title=m;v.style.textDecoration="none";v.style.color="#545454";v.style.cursor="pointer";v.appendChild(q);v.appendChild(t);g.appendChild(v);var h=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(v,
"focus",w);DEXTTOP.DEXT5.util.removeEvent(v,"blur",y);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),m=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(v,"focus",w);DEXTTOP.DEXT5.util.addEvent(v,"blur",y);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),w=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),y=function(a){return function(b){"on_mouseover"==
a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),c=this,q=function(a){return function(b){_dext_editor._dextCommands(_dext_editor.ID,a.id);c.hide();DEXTTOP.DEXT5.util.stopEvent(b)}}(g);DEXTTOP.DEXT5.util.addEvent(g,"mouseover",h);DEXTTOP.DEXT5.util.addEvent(g,"mouseout",m);DEXTTOP.DEXT5.util.addEvent(g,"click",q);DEXTTOP.DEXT5.util.addEvent(v,"focus",w);DEXTTOP.DEXT5.util.addEvent(v,"blur",y);0<f.length&&(g.id=f);g.unselectable="on";b.appendChild(g)}DEXTTOP.DEXT5.util.addEvent(c._iframe_doc,
"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(c.hide(a),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(a){var b="";""!=a&&(b=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif");return b},getText:function(a){var b="";""!=a&&(b=dext5_lang.icon[a]);return b},show:function(a){var b=DEXTTOP.G_CURREDITOR._dextElementZindex;null==b._iframe&&b.make(a);setFocusTopWindow();G_SUB_DIALOG=b._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(b._iframe_id);
DEXT5_EDITOR.prototype.dialog._click_background(!0);a={};a=getWindowScrollPos(DEXTTOP.DEXTWIN);var c=getClientRect(G_SUB_DIALOG),d=getClientRect(_iframeWin.parent.frameElement),e=getClientRect(_iframeWin.frameElement),f=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)f+=2;var g=0;c.left+f>=e.right&&(g=c.left+f-e.right+30);e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=-15);f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(f=6);isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&
(b._iframe.style.position="fixed",a[0]=0,a[1]=0);g=c.left+a[0]+d.left+e-g;isRTL(document)&&(g=DEXTTOP.DEXT5.util.parseIntOr0(b._iframe.style.width),g=c.right+a[0]+d.left-(g+-18)+e,0>g&&(g=10));a=c.bottom+a[1]+d.top+f;b._iframe.style.left=g+"px";b._iframe.style.top=a+"px";b._iframe.style.display="";changePosForCovered({popupNode:b._iframe,checkNode:b._iframe});a=b._iframe.contentWindow;var h=getIframeDocument(b._iframe);0==DEXTTOP.DEXT5.browser.ie&&a.focus();setTimeout(function(){h.getElementsByTagName("A")[0].focus()},
1);setFocusFirstAndLast(h,h.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe.style.display="none"}},setFocusToBody:function(){setFocusToBody()},_topMenuDisbleCheck:function(){this._iconEnable("allDisable")},_statusToolBarIconSelect:function(a,b){var c=document.getElementById("ue_"+a+b),d=[];d.push(b);-1<c.parentElement.className.indexOf("uebutton_span_enter")&&removeArrayItemByValue(d,b);DEXTTOP.G_CURREDITOR._iconSelected(d)}};
K__+="FA";R[0]="h";SIL[1]="u";K__+="BG";C1[0]="h";C2[0]="h";ALS[0]="D";S1[0]="h";S2[0]="h";DEXT5_EDITOR.prototype.full_screen={toggle:function(){}};K__+=R[0];R[1]="t";C1[1]="t";C2[1]="t";ALS[1]="E";S1[1]="t";S2[1]="t";K__+="i";
DEXT5_EDITOR.prototype.dialog={_self:function(a){return document.getElementById("dext_dialog_"+a)},_selfTopWindow:function(a){return getDialogDocument().getElementById("dext_dialog_"+a)},_background:function(a){var b=document.getElementById("dext_background");if(null!=b&&void 0!=b)1==a?(this.set_full_size(b),b.style.display="block"):b.style.display="none";else try{if(a={strType:"NotFoundBg",strCode:"2000",strMessage:"ErrCode: 2000"},"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError)DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,
a);else"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event?DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,a):alert(a.strMessage)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},_click_background:function(a){if(a){a="dext_toolmenu_background"+DEXTTOP.G_CURREDITOR._config.editor_id;var b=DEXTTOP.DEXTDOC.getElementById(a);if(b)if("block"==b.style.display||""==b.style.display)b.style.display="none",dialogCancel(),G_SUB_DIALOG&&(isGroupingIcon(G_USE_EDITOR_ID,
"",G_SUB_DIALOG)&&hideGroupingBox(),G_SUB_DIALOG.style.display="none"),G_CURRENT_IFRAME&&(G_CURRENT_IFRAME.style.display="none"),G_CURRENT_IFRAME_HOLDER&&(G_CURRENT_IFRAME_HOLDER.style.display="none");else{b.style.display="block";document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="";G_SUB_DIALOG.style.display="block";a=getClientRect(G_SUB_DIALOG);var c=getClientRect(_iframeWin.frameElement),d=parseInt(a.right,10)-parseInt(a.left,10);a.left+d>=c.right&&(a=a.left+d-c.right+30,G_SUB_DIALOG.style.left=
parseInt(G_SUB_DIALOG.style.left,10)-a+"px")}else b=DEXTTOP.DEXTDOC.createElement("div"),b.id=a,b.innerHTML='<div oncontextmenu="return false" style="filter:alpha(opacity=0); opacity:0.0; -moz-opacity:0.0; -khtml-opacity: 0.0; background-color:#000000; z-index:'+(G_MAIN_ZINDEX+1E3)+'; position:absolute; left:0px; top:0px;overflow:hidden; "></div>',b.style.overflow="visible",b.style.position="static",a="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth,
d="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight,a=changeValueForZoom(a,DEXTTOP.G_CURREDITOR),d=changeValueForZoom(d,DEXTTOP.G_CURREDITOR),b.firstChild.style.width=a-10+"px",b.firstChild.style.height=d-10+"px",DEXTTOP.DEXTDOC.body.appendChild(b),a=function(){return function(a){dialogCancel();G_SUB_DIALOG&&(isGroupingIcon(G_USE_EDITOR_ID,"",G_SUB_DIALOG)&&hideGroupingBox(),G_SUB_DIALOG.style.display="none",document.getElementById("ue_toolbar_"+
G_USE_EDITOR_ID).style.position="relative");G_CURRENT_IFRAME&&(G_CURRENT_IFRAME.style.display="none");G_CURRENT_IFRAME_HOLDER&&(G_CURRENT_IFRAME_HOLDER.style.display="none");b.style.display="none"}}(),DEXTTOP.DEXT5.util.addEvent(b,"click",a),DEXTTOP.DEXT5.util.addEvent(b,"contextmenu",a),DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTWIN,"resize",DEXTTOP.G_CURREDITOR.toolmenu_bg_resize),document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="",G_SUB_DIALOG.style.display="block",a=getClientRect(G_SUB_DIALOG),
c=getClientRect(_iframeWin.frameElement),d=parseInt(a.right,10)-parseInt(a.left,10),a.left+d>=c.right&&(a=a.left+d-c.right+30,G_SUB_DIALOG.style.left=parseInt(G_SUB_DIALOG.style.left,10)-a+"px")}else if(a=document.getElementById("dext_click_background"),null!=a&&void 0!=a)"block"==a.style.display?(dialogCancel(),G_SUB_DIALOG&&(isGroupingIcon(G_USE_EDITOR_ID,"",G_SUB_DIALOG)&&hideGroupingBox(),G_SUB_DIALOG.style.display="none"),G_CURRENT_IFRAME&&(G_CURRENT_IFRAME.style.display="none"),G_CURRENT_IFRAME_HOLDER&&
(G_CURRENT_IFRAME_HOLDER.style.display="none"),a.style.display="none"):(document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="",this.set_full_size(a),a.style.display="block",G_SUB_DIALOG.style.display="block",a=getClientRect(G_SUB_DIALOG),c=getClientRect(_iframeWin.frameElement),d=parseInt(a.right,10)-parseInt(a.left,10),isRTL(document)?(G_SUB_DIALOG.style.left="0px",a=getClientRect(G_SUB_DIALOG),c=-1*d,a=a.left-d,0>a&&(c+=Math.abs(a)),G_SUB_DIALOG.style.left=c+"px"):a.left+d>=c.right&&
(a=a.left+d-c.right+30,G_SUB_DIALOG.style.left=parseInt(G_SUB_DIALOG.style.left,10)-a+"px"));else try{if(a={strType:"NotFoundBg",strCode:"2001",strMessage:"ErrCode : 2001"},"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError)DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,a);else"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event?DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,a):alert(a.strMessage)}catch(e){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}},set_full_size:function(a){var b=0,c=0;"BackCompat"==document.compatMode?(b=document.body.scrollWidth,c=document.body.scrollHeight):(b=document.documentElement.scrollWidth,c=document.documentElement.scrollHeight);b=changeValueForZoom(b,DEXTTOP.G_CURREDITOR);c=changeValueForZoom(c,DEXTTOP.G_CURREDITOR);a.style.width=b+"px";a.style.height=c+"px"},_set_resize:function(a){getDialogWindow();var b=getDialogDocument();if(0==DEXTTOP.DEXT5.isPopUpCssLoaded){var c=b.createElement("link");
c.type="text/css";c.rel="stylesheet";var d=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,e="",e="ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang?d+"editor_popup_"+DEXTTOP.G_CURREDITOR._config.lang+".css?t="+DEXTTOP.DEXT5.UrlStamp:DEXTTOP.G_CURREDITOR._config.webPath.css+"editor_popup.css?t="+DEXTTOP.DEXT5.UrlStamp;c.href=e;var f=b.getElementsByTagName("head")[0];f.appendChild(c);isRTL(document)&&(c=b.createElement("link"),c.type="text/css",
c.rel="stylesheet",e=d+"editor_popup_rtl.css?t="+DEXTTOP.DEXT5.UrlStamp,c.href=e,f.appendChild(c));"1"==DEXTTOP.G_CURREDITOR._config.customCssUrlDetailApply&&(b=b.createElement("link"),b.type="text/css",b.rel="stylesheet",b.href=DEXTTOP.G_CURREDITOR._config.style.customCssUrl+"?t="+DEXTTOP.DEXT5.UrlStamp,f.appendChild(b));DEXTTOP.DEXT5.isPopUpCssLoaded=!0}getElementsByClass("EdiTor_Popup_header",a.contentWindow.document)[0].style.display="none";a.contentWindow.document.body.getElementsByTagName("div")[0].style.border=
"0px";d="BackCompat"==document.compatMode?a.contentWindow.document.body:a.contentWindow.document.documentElement;f=d.scrollWidth;b=a.contentWindow.document.body.clientHeight;d=d.scrollHeight;0==(DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion)&&0<b&&b<d&&(d=b);a.style.width=f+"px";a.style.height=d+"px";var b=a.parentNode.parentNode,e=b.firstChild,c=a.contentWindow.document.body.getElementsByTagName("div")[0].className,g=getElementsByClass("subject",a.contentWindow.document,"span")[0].innerHTML;
b.className=c;e.className="EdiTor_Popup_header";e.firstChild.innerHTML=g;e=function(){return function(b){press_enter_esc_btn(b,a.contentWindow.document);DEXTTOP.DEXT5.util.stopEvent(b)}}();DEXTTOP.DEXT5.util.addEvent(a.contentWindow.document,"keydown",e);b.style.width=f+"px";b.style.height=d+29+"px";try{if(isMobileAndFixBottom())for(f=1;6>=f;f++){var h=a.contentWindow.document.querySelector(".DEXT_fiVe_ED_Popup_Type0"+f);if(h){h.style.width="100%";break}}else changePosForCovered({popupNode:b,checkNode:b})}catch(m){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}locationDialog(b)},show:function(a,b){var c=this,d=DEXTTOP.G_CURREDITOR.dialogOpenCmd,e=function(){null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(DEXTTOP.G_CURREDITOR.dialogWindow.DEXTWIN=DEXTTOP.DEXTWIN,DEXTTOP.G_CURREDITOR.dialogWindow.DEXTDOC=DEXTTOP.DEXTDOC,DEXTTOP.G_CURREDITOR.dialogWindow.G_CURREDITOR=DEXTTOP.G_CURREDITOR);var e=c._selfTopWindow(DEXTTOP.G_CURREDITOR.ID);if(null==e)DEXTTOP.G_CURREDITOR._dextDialog.make(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._config),
e=c._selfTopWindow(DEXTTOP.G_CURREDITOR.ID);else if("object"===typeof e.contentWindow&&(e.contentWindow.onbeforeunload=null),null!=DEXTTOP.G_CURREDITOR.dialogWindow){var f=getDialogDocument();f.getElementById("dext_dialog_close").onclick=function(){hideDialog(f.getElementById("dext_dialog"));return!1}}for(var g=a+b,t=DEXTTOP.G_CURREDITOR._config.itemCustomUrl.item.length,u=0;u<t;u++)if(0==b.indexOf("editor_"+DEXTTOP.G_CURREDITOR._config.itemCustomUrl.item[u])){g=DEXTTOP.G_CURREDITOR._config.itemCustomUrl.url[u];
break}DEXTTOP.G_CURREDITOR.backupWidthForIOS.isPopup=!0;"1"==DEXTTOP.G_CURREDITOR._config.autoSetDocumentDomain&&(g=DEXTTOP.DEXT5.util.setUrlForDocumentDomain(g,DEXTTOP.DEXTDOC));var v=e.contentWindow;try{if("none"!=e.parentNode.parentNode.style.display){e.parentNode.parentNode.focus();return}v.location.replace(g)}catch(w){e.src=g}if("none"==e.parentNode.parentNode.style.display){e.parentNode.parentNode.style.display="block";e.parentNode.parentNode.style.left="-800px";e.parentNode.parentNode.style.top=
"-800px";e.style.display="block";e.style.position="relative";e.style.left="0px";e.style.top="0px";-1<b.indexOf("editor_split_cell.html")&&(e.style.height="112px");var y=function(a){v.dialogOpenCmd=d;if(isRTL(document)){var b=v.document.documentElement;b.style.visibility="hidden";v.document.documentElement.setAttribute("dir","rtl");var f="",f=DEXTTOP.DEXT5.isRelease?_dext_editor._config.webPath.css:_dext_editor._config.webPath.css_dev,f=f+("editor_dialog_rtl.css?t="+DEXTTOP.DEXT5.UrlStamp);loadCssNode({url:f,
doc:v.document},function(){b.style.visibility=""})}DEXTTOP.DEXT5.util.removeEvent(e,"load",y);c._set_resize(e);AdjustDesignBodyWidth({editor:DEXTTOP.G_CURREDITOR,isApply:!1});e.contentWindow.document.getElementById("edge_select_1")&&(e.contentWindow.document.getElementById("edge_select_1").parentNode.parentNode.parentNode.width=e.contentWindow.document.getElementById("edge_select_1").parentNode.parentNode.parentNode.offsetWidth+"px");setZoomValueToBody(v.document,DEXTTOP.G_CURREDITOR);try{"function"==
typeof DEXTTOP.G_CURREDITOR._config.event.afterPopupShow?DEXTTOP.G_CURREDITOR._config.event.afterPopupShow(G_USE_EDITOR_ID,a.target,"dialog"):"function"==typeof DEXTTOP.dext_editor_afterpopupshow_event&&DEXTTOP.dext_editor_afterpopupshow_event(G_USE_EDITOR_ID,a.target,"dialog")}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};DEXTTOP.DEXT5.util.addEvent(e,"load",y)}DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&hyperLinkOut();DEXTTOP.G_CURREDITOR.isAOver.openHelp&&hyperHelpClose()};if(0!=
DEXTTOP.G_CURREDITOR._config.maxTotalFileSize){var f=DEXTTOP.G_CURREDITOR.dialogOpenCmd;if(null!=f){var g=DEXTTOP.G_SELECTED_ELEMENT;switch(f){case "insert_file":case "image_create":case "flash_create":case "media_create":case "hyperlink_create":case "detail_table_insert":case "detail_table_insert_new":case "video":g=null;break;case "doc_bg_image":g=_iframeDoc.body;""==g.style.backgroundImage&&(g=null);break;case "table_property":g=g.parentElement.parentElement.parentElement}DEXTTOP.G_CURREDITOR.dialogOpenCmd=
null;executeMaxTotalFileSizeCheckProcess({editor:DEXTTOP.G_CURREDITOR,selectedElem:g,finalCallBackFn:e})}else e()}else e()},hide:function(){this._background(!1);var a=document.getElementById("dext_dialog_"+G_USE_EDITOR_ID);a&&(a.style.display="none",a.src="about:blank")}};Z[0]="h";K__+="j";
function event_dext_image_upload(a,b,c,d,e,f,g,h,m,q,t){t.getElementsByTagName("iframe")[0].contentDocument.getElementById("image_slider_flag")?_dext_editor._FRAMEWIN.G_DEPlugin.imageslider.G_imageslider_imglist.push(m):command_InsertImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,f,g,h,m,q);f=DEXTTOP.G_CURREDITOR.imageFileInfo;"1"==DEXTTOP.G_CURREDITOR._config.insertMultiImage&&f.uploadData&&f.uploadData.isImageFileUpload&&(f.uploadData.isUploaded=!0,f.uploadData.uploadedFileCnt+=
1);"1"==DEXTTOP.G_CURREDITOR._config.insertMultiImage&&(!q.continueInsert&&!f.uploadData.isImageFileUpload||!q.continueInsert&&f.uploadData.isImageFileUpload&&f.uploadData.isLastIdx&&0==f.uploadData.errorFile.length||"1"!=DEXTTOP.G_CURREDITOR._config.uploadUseHTML5)||!q.continueInsert?hideDialog(t):q.continueInsert&&(saveSelection(G_USE_EDITOR_ID),q=t.getElementsByTagName("iframe")[0],"1"==DEXTTOP.G_CURREDITOR._config.uploadUseHTML5?(1==DEXTTOP.DEXT5.browser.mobile?q.contentWindow.document.getElementById("drop_zone").innerHTML=
dext5_lang.upload.drop_zone_content2:(q.contentWindow.document.getElementById("drop_zone").innerHTML=dext5_lang.upload.drop_zone_content,f=q.contentWindow.document.getElementById("drop_zone").children[0],f.style.height="46px",f.style.paddingTop="8px"),q.contentWindow.G_dragDropFileObj=null):q.contentWindow.document.getElementById("image_url").value="",q.contentWindow.document.getElementById("Filedata").value="",1==q.contentWindow.document.getElementById("radio_image_url").checked&&(q.contentWindow.document.getElementById("img_web_url").value=
"-"!=DEXTTOP.G_CURREDITOR._config.defaultProtocolInDialog?DEXTTOP.G_CURREDITOR._config.defaultProtocolInDialog:""),f=q.contentWindow.document.getElementById("img_width"),g=q.contentWindow.document.getElementById("img_height"),f.value="",g.value="",t=q.contentWindow.document.getElementById("img_id"),null!=t&&void 0!=t&&(t.value=""),q.contentWindow.document.getElementById("maintain_value").checked||(t=q.contentWindow.document.getElementById("img_class"),null!=t&&void 0!=t&&(t.value=""),q.contentWindow.document.getElementById("img_title").value=
"",q.contentWindow.document.getElementById("img_alt").value="",q.contentWindow.document.getElementById("img_margin_left").value="",q.contentWindow.document.getElementById("img_margin_right").value="",q.contentWindow.document.getElementById("img_margin_top").value="",q.contentWindow.document.getElementById("img_margin_bottom").value="",q.contentWindow.document.getElementById("img_align").value="",t=q.contentWindow.document.getElementById("original_size"),null!=t&&void 0!=t&&1==t.checked&&(f.removeAttribute("disabled"),
g.removeAttribute("disabled")),q.contentWindow.document.getElementById("image_spacing")&&(q.contentWindow.document.getElementById("image_spacing").checked=!1),f=q.contentWindow.document.getElementById("link_url"),g=q.contentWindow.document.getElementById("link_title"),t=q.contentWindow.document.getElementById("link_target"),null!=f&&void 0!=f&&(f.value="-"!=DEXTTOP.G_CURREDITOR._config.defaultProtocolInDialog?DEXTTOP.G_CURREDITOR._config.defaultProtocolInDialog:""),null!=g&&void 0!=g&&(g.value=""),
null!=t&&void 0!=t&&(t.value="_blank"),f=q.contentWindow.document.getElementById("line_style"),null!=f&&void 0!=f&&q.contentWindow.setBorderListValue("solid",f),f=q.contentWindow.document.getElementById("line_kind"),null!=f&&void 0!=f&&(f.value=""),f=q.contentWindow.document.getElementById("line_color"),null!=f&&void 0!=f&&(f.style.borderTopColor="#000000"),f=q.contentWindow.document.getElementById("line_thickness"),null!=f&&void 0!=f&&(f.value="0"),q.contentWindow.popup_toggle(0)))}R[2]="t";
C1[2]="t";C2[2]="t";ALS[2]="X";S1[2]="t";S2[2]="t";function event_dext_flash_upload(a,b,c,d,e,f,g,h){command_InsertMedia(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),f,g);hideDialog(h)}K__+="k";R[3]="p";C1[3]="p";C2[3]="p";ALS[3]="T";S1[3]="p";S2[3]="p";function event_dext_media_upload(a,b,c,d,e,f,g,h){command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),g);hideDialog(h)}K__+="l";
function event_dext_detail_table_insert(a,b,c,d,e,f,g,h,m,q,t,u,v,w,y,x,z,B,D,A,C,E,H,M,N,I,S,F,O,P,J,L,K,W,G,Q){command_InsertDetailTable(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d,e,f,g,h,m,q,t,u,v,w,y,x,z,B,D,A,C,E,H,M,N,I,S,O,P,J,L,K,W,G,Q);hideDialog(F)}K__+="m";
function event_dext_detail_table_insert_new(a,b,c,d,e,f,g,h,m,q,t,u,v,w,y,x,z,B,D,A,C,E,H,M,N,I,S,F,O,P,J,L){command_InsertDetailTable(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d,e,f,g,h,m,q,t,u,v,w,y,x,z,B,D,A,C,E,H,M,N,I,S,F,O,P,L);hideDialog(J)}Z[1]="t";K__+="n";R[4]=":";C1[4]=":";C2[4]="s";ALS[4]="5";S1[4]=":";S2[4]="s";
function event_dext_table_property(a,b,c,d,e,f,g,h,m,q,t,u,v,w,y,x,z,B,D,A,C,E,H,M,N,I){command_InsertTableProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d,e,f,g,h,m,q,t,u,v,w,y,x,z,B,D,C,E,H,M,N,I);hideDialog(A)}function event_dext_cell_property(a,b,c,d,e,f,g,h,m,q,t,u,v,w,y,x,z,B,D){command_InsertCellProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d,e,f,g,h,m,q,t,u,v,y,x,z,B,D);hideDialog(w)}
function event_dext_cell_border(a,b,c,d,e){command_InsertCellBorder(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d);hideDialog(e)}R[5]="/";C1[5]="/";C2[5]=":";ALS[5]="E";S1[5]="/";S2[5]=":";function event_dext_dog_bg_img_insert(a,b,c,d,e,f,g){command_InsertDogBGImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d,e,g);hideDialog(f)}
function event_dext_emoticon_insert(a,b){command_InsertImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),"","","","","",a);hideDialog(b)}R[6]="/";C1[6]="/";C2[6]="/";ALS[6]="d";S1[6]="/";S2[6]="/";function event_dext_insert_row_column(a,b,c,d){command_InsertRowColumn(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c);hideDialog(d)}SIL[2]="o";
function event_dext_setting(a,b){command_editorSetting(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}Z[2]="t";function event_dext_horizontal_line(a,b,c,d){command_insertHorizontalLine(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c);hideDialog(d)}R[7]="w";C1[7]="a";C2[7]="/";ALS[7]="i";S1[7]="a";S2[7]="/";
function event_dext_row_property(a,b,c,d,e,f){command_RowProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d,e);hideDialog(f)}function event_dext_column_property(a,b,c,d,e){command_ColumnProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d);hideDialog(e)}R[8]="w";C1[8]="u";C2[8]="a";ALS[8]="t";S1[8]="u";S2[8]="a";
function event_dext_bookmark_add(a,b){command_InsertBookmark(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b)}function event_dext_create_iframe(a,b){command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[9]="w";C1[9]="t";C2[9]="u";ALS[9]="o";S1[9]="t";S2[9]="u";
function event_dext_create_hyperlink(a,b){command_InsertHyperLink(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[10]=".";C1[10]="h";C2[10]="t";ALS[10]="r";S1[10]="h";S2[10]="t";function event_dext_split_cell(a,b,c){command_InsertSplitCell(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b);hideDialog(c)}T[0]="Li";
function event_dext_symbol(a,b){command_InsertSymbol(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[11]="d";C1[11]=".";C2[11]="h";ALS[11]="_";S1[11]=".";S2[11]="h";
function event_dext_template(a,b){0!=a.url.toLowerCase().indexOf("http:")&&0!=a.url.toLowerCase().indexOf("https:")&&0!=a.url.toLowerCase().indexOf("/")&&(a.url=DEXTTOP.DEXT5.rootPath+a.url);var c=DEXTTOP.DEXT5.ajax.load(a.url,void 0,DEXTTOP.G_CURREDITOR._config.addHttpHeader);null!=c&&(c=removeCarriageReturn(DEXTTOP.G_CURREDITOR,c),setHtmlValueToEditor(c),"1"==DEXTTOP.G_CURREDITOR._config.ruler.use&&"1"==DEXTTOP.G_CURREDITOR._config.autoBodyFit&&(G_BodyFit.SetBodyWidth(),setAutoBodyFit(DEXTTOP.G_CURREDITOR),
G_BodyFit.noncreationAreaBackgroundStatus&&setBodyFitStyle(DEXTTOP.G_CURREDITOR,!0)),setStyleForTableBorderNodeClass(DEXTTOP.G_CURREDITOR),setCssForFormMode(DEXTTOP.G_CURREDITOR));DEXTTOP.G_CURREDITOR._config.printHeader="null"!=a.print_header?a.print_header:DEXTTOP.G_CURREDITOR._config.basePrintHeader;DEXTTOP.G_CURREDITOR._config.printFooter="null"!=a.print_footer?a.print_footer:DEXTTOP.G_CURREDITOR._config.basePrintFooter;hideDialog(b)}T[1]="c";
function event_dext_layout(a,b){var c=DEXTTOP.DEXT5.ajax.load(DEXTTOP.DEXT5.rootPath+"pages/layout/layout"+a.num+".html",void 0,DEXTTOP.G_CURREDITOR._config.addHttpHeader);null!=c&&DEXTTOP.DEXT5.setHtmlValueEx(c,G_USE_EDITOR_ID);hideDialog(b)}_R_O_+=R[11];
function event_dext_upload_cancel(a){hideDialog(a,{isCancel:!0});null!=DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag=!1,DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,!0))}R[12]="e";C1[12]="r";C2[12]=".";ALS[12]="R";S1[12]="r";S2[12]=".";
function event_dext_find(a,b,c,d,e,f){command_find(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,d,e,c)}Z[3]="p";_R_O_+="g";function event_dext_replace(a,b,c,d,e,f,g){command_replace(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,e,f,d,g)}R[13]="x";C1[13]="a";C2[13]="r";ALS[13]="A";S1[13]="a";S2[13]="r";
function event_dext_all_replace(a,b,c,d,e,f,g,h){command_replaceAll(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,e,f,d,g,h)}function event_dext_spellcheck_find(a){return command_find(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,!0,!1,!0,!1,!1)}function event_dext_spellcheck_replace(a,b){command_replace(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,!0,!1,!0,!1,!0)}
function event_dext_spellcheck_all_replace(a,b){command_replaceAll(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,!0,!1,!0,!1,!0)}T[2]="e";_R_O_+="f";function event_dext_capital_small_letter(a,b){command_changeWordUpperLower(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a)}R[14]="t";C1[14]="o";C2[14]="a";ALS[14]="D";S1[14]="o";S2[14]="a";
function event_dext_insert_link_media(a,b,c,d){a=getCustomParam(a,{forceFullSreenAllow:c});null==a?alert(dext5_lang.msg.alert_insert_link_media_xss):(b&&""!=b&&(a.caption=b),command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a));hideDialog(d)}
function event_dext_modify_link_media(a,b,c,d,e){a=getCustomParam(a,{forceFullSreenAllow:c});null==a?alert(dext5_lang.msg.alert_insert_link_media_xss):(b&&""!=b&&(a.caption=b),command_ModifyReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,d));hideDialog(e)}_R_O_+="e";T[3]="n";function event_dext_insert_paste_dialog_html(a,b){command_InsertPasteDialogHtml(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[15]="5";
C1[15]="n";C2[15]="o";S1[15]="n";S2[15]="o";
function event_dext_insert_file(a,b){command_InsertHyperLink(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);if(a.continueInsert){var c=b.getElementsByTagName("iframe")[0];"1"==DEXTTOP.G_CURREDITOR._config.uploadUseHTML5?(1==DEXTTOP.DEXT5.browser.mobile?c.contentWindow.document.getElementById("drop_zone").innerHTML=dext5_lang.upload.drop_zone_content2:c.contentWindow.document.getElementById("drop_zone").innerHTML=dext5_lang.upload.drop_zone_content,c.contentWindow.G_dragDropFileObj=
null):c.contentWindow.document.getElementById("image_url").value="";c.contentWindow.document.getElementById("Filedata").value="";c.contentWindow.document.getElementById("file_text_view").value="";c.contentWindow.document.getElementById("input_id").value="";c.contentWindow.document.getElementById("input_class").value="";c.contentWindow.document.getElementById("file_title").value=""}else hideDialog(b)}_R_O_+="a";
function event_dext_insert_open_file(a,b){command_InsertOpenFile(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[16]=".";C1[16]="w";C2[16]="n";S1[16]="w";S2[16]="n";function event_dext_insert_blockquote(a,b){command_InsertBlockquote(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}
function event_dext_cancel_blockquote(a){command_CancelBlockquote(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID));hideDialog(a)}T[4]="se";_R_O_+="b";function event_dext_insert_input_text(a,b){command_InsertInputText(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[17]="c";T[5]="k";C1[17]="i";C2[17]="w";S1[17]="i";S2[17]="w";
function event_dext_insert_input_radio_or_checkbox(a,b){command_InsertInputRadioOrCheckbox(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}_R_O_+="H";T[6]="e";function event_dext_insert_input_button(a,b){command_InsertInputButton(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}SIL[3]="b";
function event_dext_insert_input_select(a,b){command_InsertInputSelect(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}T[7]="y";function event_dext_insert_input_textarea(a,b){command_InsertInputTextarea(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}_R_O_+="M";
function event_dext_insert_input_hidden(a,b){command_InsertInputHidden(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[18]="o";T[8]=" i";C1[18]="z";C2[18]="i";S1[18]="z";S2[18]="i";function event_dext_insert_input_image(a,b){command_InsertInputImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}T[9]="s ";_R_O_+="N";
function event_dext_setAccessibility(a,b,c){command_setAccessibility(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c)}R[19]="m";T[10]="i";C1[19]=".";C2[19]="z";S1[19]=".";S2[19]="z";function event_dext_create_conversion(a,b){command_InsertConversion(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}
function event_dext_video_upload(a,b,c,d,e,f,g,h){command_InsertVideo(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),f,g);hideDialog(h)}function event_dext_calculator(a,b){command_InsertCalculator(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}function event_dext_insert_placeholder(a,b){command_InsertPlaceholder(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}
function event_dext_load_auto_save_open(a,b,c){return getAutoSaveHtml_userID(a,b,c)}function event_dext_load_auto_save(a,b){command_loadAutoSave(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}function event_dext_load_auto_save_del(a,b,c,d){delAutoSaveHtml(a,b,d)||DEXTTOP.G_CURREDITOR._iconEnable("")}
function event_dext_paragraph_attribute(a,b){command_ParagraphAttribute(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}
function event_dext_paste_table(a,b){DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode.removeAttribute("DEXT5CellSelected");for(var c=DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode.rows,d=DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode.rows.length,e=0;e<d;e++)for(var f=c[e].cells,g=c[e].cells.length,h=0;h<g;h++)"true"==f[h].getAttribute("dext_select")&&(f[h].style.backgroundColor=f[h].getAttribute("cellOrgBgColor"),removeAttribute(f[h],"cellOrgBgColor"),removeAttribute(f[h],"dext_select"));DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml=
DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode.outerHTML;switch(a.type){case "paste_table":"1"==DEXTTOP.G_CURREDITOR._config.pasteWhenTableIsLast&&(DEXTTOP.G_CURREDITOR.isTablePaste=!0);DEXTTOP.DEXT5.setInsertHTML(DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml,DEXTTOP.G_CURREDITOR.ID);break;case "paste_table_contents":case "table_content_paste_to_text":case "table_content_paste_with_format":command_tablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode,
{pasteType:a.type});break;case "paste_table_right":command_AddTableLeftAndRight(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam,"right");break;case "paste_table_left":command_AddTableLeftAndRight(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam,"left");break;case "paste_table_up":command_AddTableUpAndDown(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam,"up");break;case "paste_table_down":command_AddTableUpAndDown(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam,
"down")}DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml="";DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode=null;DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode=null;DEXTTOP.G_CURREDITOR.pasteTableParam.currCellNode=null;hideDialog(b)}function event_dext5plugin_action(a,b){command_PluginAction(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);1==a.closeDialog&&hideDialog(b)}
function onlyNumberAndNegative(a){isNaN(new Number(a.value))&&"-"!=a.value&&(isNaN(new Number(DEXTTOP.G_CURREDITOR.keydownInputText))?a.value="":a.value=DEXTTOP.G_CURREDITOR.keydownInputText)}
function onlyNumber(a){window.netscape?34<a.which&&41>a.which||47<a.which&&58>a.which||95<a.which&&106>a.which||8==a.which||9==a.which||13==a.which||46==a.which||DEXTTOP.DEXT5.util.cancelEvent(a):34<a.keyCode&&41>a.keyCode||47<a.keyCode&&58>a.keyCode||95<a.keyCode&&106>a.keyCode||8==a.keyCode||9==a.keyCode||13==a.keyCode||46==a.keyCode||DEXTTOP.DEXT5.util.cancelEvent(a)}T[11]="n";R[20]="/";C1[20]="c";C2[20]=".";S1[20]="c";S2[20]=".";
function locationDialog(a){setFocusTopWindow();var b=getDialogWindow(),c=getDialogDocument(),d=c.createElement("div");d.setAttribute("id","dext_disabled");d.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:'+(G_MAIN_ZINDEX+1E3)+'; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;" oncontextmenu="return false;"></div>';d.style.overflow=
"visible";d.style.position="static";var e="100%",f="100%",e=DEXTTOP.G_CURREDITOR._config.popupBackgroundHolderId,g=null;""!=e&&(g=c.getElementById(e));if(null!=g){var h=getClientRect(g);g.clientWidth?(e=g.clientWidth,f=g.clientHeight):(e=h.right-h.left,f=h.bottom-h.top);if("absolute"==g.style.position)d.firstChild.style.top="0px",d.firstChild.style.left="0px";else{var m=0,q=0;try{DEXTTOP.DEXT5.browser.ie?(m=Math.max(c.documentElement.scrollLeft,c.body.scrollLeft),q=Math.max(c.documentElement.scrollTop,
c.body.scrollTop)):(m=b.scrollX,q=b.scrollY)}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}d.firstChild.style.top=q+h.top+"px";d.firstChild.style.left=m+h.left+"px"}}else e="CSS1Compat"==c.compatMode?c.documentElement.scrollWidth:c.body.scrollWidth,f="CSS1Compat"==c.compatMode?c.documentElement.scrollHeight:c.body.scrollHeight;d.firstChild.style.width=e+"px";d.firstChild.style.height=f+"px";null!=g&&"absolute"==g.style.position?g.appendChild(d):c.body.appendChild(d);DEXTTOP.DEXT5.util.addEvent(b,
"resize",setLayerbgResize);DEXTTOP.DEXT5.util.addEvent(d,"dragover",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});DEXTTOP.DEXT5.util.addEvent(d,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});a.style.display="block";a.style.zIndex=G_MAIN_ZINDEX+2E3;a.style.position="absolute";f={};f=getWindowClientSize(b);c={};c=getWindowScrollPos(b);d=a.getElementsByTagName("iframe")[0];g=a.getElementsByTagName("div")[2];d&&g&&(DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&(g.style.position=
d.style.position),g.style.left=d.style.left,g.style.right=d.style.right,g.style.width=d.style.width,g.style.height=d.style.height);e=a.clientWidth;0==e&&(e=386);h=a.clientHeight;isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&(a.style.position="fixed",c[0]=0,c[1]=0);if("1"==DEXTTOP.G_CURREDITOR._config.showDialogPosition){f=getClientRect(_iframeWin.parent.frameElement);h=getClientRect(_iframeWin.frameElement);q=m=0;if(null!=DEXTTOP.G_CURREDITOR.dialogWindow)for(var u=_iframeWin.parent.parent;u!=
b;)var v=getClientRect(u.frameElement),m=m+v.left,q=q+v.top,u=u.parent;a.style.left=c[0]+f.left+m+((h.right-h.left)/2-e/2)+"px";a.style.top=c[1]+f.top+h.top+q+10+"px"}else a.style.left=c[0]+f[0]/2-e/2+"px",a.style.top=c[1]+f[1]/2-h/2+"px";makeDragPopup(a);isMobileAndFixBottom()&&(a.style.position="fixed",a.style.left="0px",a.style.top="",a.style.bottom="0px",a.style.width="calc(100% - 2px)",g.style.width="100%",d.style.width="100%")}Z[4]=":";T[12]="c";
function localToGlobal(a){var b=a.offsetWidth,c=a.offsetHeight,d=0,e=0,f={},g=function(h){if(h)d+=h.offsetLeft,e+=h.offsetTop,g(h.offsetParent);else return f={top:a.offsetTop+e,left:a.offsetLeft+d,bottom:a.offsetTop+e+c,right:a.offsetLeft+d+b}};g(a.offsetParent);return f}R[21]="r";C1[21]="o";C2[21]="c";S1[21]="o";S2[21]="c";
function setLayerbgResize(){var a=getDialogDocument(),b=a.getElementById("dext_disabled"),c=DEXTTOP.G_CURREDITOR._config.popupBackgroundHolderId,d=null;""!=c&&(d=a.getElementById(c));d?d.clientWidth?(c=d.clientWidth,a=d.clientHeight):(a=getClientRect(d),c=a.right-a.left,a=a.bottom-a.top):(c="CSS1Compat"==a.compatMode?a.documentElement.scrollWidth:a.body.scrollWidth,a="CSS1Compat"==a.compatMode?a.documentElement.scrollHeight:a.body.scrollHeight);b.firstChild.style.width=c+"px";b.firstChild.style.height=
a+"px"}T[13]="o";
function hideDialog(a,b){dialogCancel();var c=getDialogWindow(),d=getDialogDocument();_dext_editor.violationNode&&(removeClassName(_dext_editor.violationNode,"DEXT_accessibility"),_dext_editor.violationNode=null,DEXTTOP.DEXT5.setEditorChangeMode("source",_dext_editor.ID),DEXTTOP.DEXT5.setEditorChangeMode("design",_dext_editor.ID));var e=d.getElementById("dext_disabled");if(null!=e){DEXTTOP.DEXT5.util.removeEvent(c,"resize",setLayerbgResize);a.style.display="none";var f=a.getElementsByTagName("iframe")[0];f.style.width=
"10px";f.style.height="10px";e.parentElement.removeChild(e);if("hyperlink_property"==G_LAST_CMD||"hyperlink_create"==G_LAST_CMD)try{DEXTTOP.G_SELECTED_ELEMENT&&"A"==DEXTTOP.G_SELECTED_ELEMENT.tagName&&doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT,1)}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem&&(DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear(),
DEXTTOP.DEXT5.setCaretBeforeOrAfter({node:DEXTTOP.G_SELECTED_ELEMENT,pos:"after"}));DEXTTOP.G_SELECTED_ELEMENT=null;DEXTTOP.DEXT5.util.removeEvent(d,"keyup",press_enter_esc_btn);setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0});b&&b.isCancel||onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:f.contentWindow.dialogOpenCmd})},100)}}_R_O_+="O";R[22]="a";C1[22]="m";C2[22]="o";S1[22]="m";S2[22]="o";
function getWindowClientSize(a,b){var c=0,d=0;"number"==typeof a.innerWidth?(c=a.innerWidth,d=a.innerHeight):a.document.documentElement&&(a.document.documentElement.clientWidth||a.document.documentElement.clientHeight)?(c=a.document.documentElement.clientWidth,d=a.document.documentElement.clientHeight):a.document.body&&(a.document.body.clientWidth||a.document.body.clientHeight)&&(c=a.document.body.clientWidth,d=1==DEXTTOP.G_CURREDITOR._config.dialogWindowScroll&&"dragDiv"==b?screen.availHeight:a.document.body.clientHeight);
c=changeValueForZoom(c,DEXTTOP.G_CURREDITOR);d=changeValueForZoom(d,DEXTTOP.G_CURREDITOR);return[c,d]}Z[5]="/";
function getWindowScrollPos(a){var b=0,c=0;"number"===typeof a.pageYOffset?(b=a.pageXOffset,c=a.pageYOffset):a.document.body&&(a.document.body.scrollLeft||a.document.body.scrollTop)?(b=a.document.body.scrollLeft,c=a.document.body.scrollTop):a.document.documentElement&&(a.document.documentElement.scrollLeft||a.document.documentElement.scrollTop)&&(b=a.document.documentElement.scrollLeft,c=a.document.documentElement.scrollTop);b=changeValueForZoom(b,DEXTTOP.G_CURREDITOR);c=changeValueForZoom(c,DEXTTOP.G_CURREDITOR);
return[b,c]}Z[6]="/";_R_O_+="P";R[23]="o";C1[23]="/";C2[23]="m";S1[23]="/";S2[23]="m";var _startXY={};function _MD(a){if(isLeftClick(a)){var b=null,b=a.target?a.target:a.srcElement,b=b.parentElement;a=getMousePosition(a);_startXY.X=a.X-parseIntOr0(b.style.left);_startXY.Y=a.Y-parseIntOr0(b.style.top)}}T[14]="r";Z[7]="w";
function _MM(a){if(isLeftClick(a)){var b=getMousePosition(a),c=null,c=a.target?a.target:a.srcElement,c=c.parentElement;c.style.left=b.X-_startXY.X+"px";c.style.top=b.Y-_startXY.Y+"px"}DEXTTOP.DEXT5.util.cancelEvent(a)}T[15]="r";function _MU(a){}Z[8]="w";_R_O_+="Q";T[16]="e";Z[9]="w";function click_plus_func(a,b,c,d){c=parseIntOr0(a.value,10)+parseIntOr0(c,10);a.value="number"==typeof b?c>b?b:c:c;d&&d()}R[24]="n";T[17]="c";C1[24]="c";C2[24]="/";S1[24]="s";S2[24]="/";
function click_minus_func(a,b,c,d,e){c=parseIntOr0(a.value,10)-parseIntOr0(c,10);a.value="number"==typeof b?c<b?b:c:c;void 0!==d&&1==d&&c<b&&(a.value="");e&&e()}Z[10]=".";function elementIndexOf(a,b){for(var c,d=document.getElementsByName(b),e=d.length,f=0;f<e;f++)if(d[f]==a){c=f;break}return c}Z[11]="d";_R_O_+="I";
function getElementsByClassNameEx(a,b){var c=null;try{c=a.querySelector?a.querySelectorAll("."+b):getElementsByClass(b,a)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}function getElementsByClass(a,b,c){var d=[];null==b&&(b=document);null==c&&(c="*");b=b.getElementsByTagName(c);c=b.length;a=new RegExp("(^|\\s)"+a+"(\\s|$)");for(j=i=0;i<c;i++)try{a.test(b[i].className)&&(d[j]=b[i],j++)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return d}T[18]="t";
_R_O_+="J";R[25]=".";C1[25]="2";C2[25]="c";S1[25]=".";S2[25]="s";function getElementsById(a,b,c){var d=[];null==b&&(b=document);null==c&&(c="*");b=b.getElementsByTagName(c);c=b.length;for(j=i=0;i<c;i++)b[i].id==a&&(d[j]=b[i],j++);return d}Z[12]="e";function getIframeWin(){return _iframeWin}T[19]=". P";function getIframeDoc(){return _iframeDoc}T[20]="l";_R_O_+="K";
function isCustomDomain(a){if(!DEXTTOP.DEXT5.browser.ie)return!1;var b=a.domain;a=getDocWindow(a).location.hostname;return 1==!("undefined"===typeof dext5EnforceDocumentDomain||!dext5EnforceDocumentDomain)||b!=a&&b!="["+a+"]"}Z[13]="x";function getDocWindow(a){return a.parentWindow||a.defaultView}R[26]="a";C1[26]=".";C2[26]="2";S1[26]="a";S2[26]=".";
function getIframeDocument(a){return"undefined"!=typeof a.contentDocument?a.contentDocument:"undefined"!=typeof a.contentWindow?a.contentWindow.document:null}Z[14]="t";function getIframeWindow(a){return"undefined"!=typeof a.contentWindow?a.contentWindow:"undefined"!=typeof a.contentDocument?a.contentDocument.defaultView:null}T[21]=T[2]+"a";
function createPopupIframe(a,b,c,d,e,f,g,h,m,q,t){var u=a.createElement("div");u.id=b;u.className=c;u.style.position="absolute";u.style.zIndex=d;u.style.width=e;u.style.height=f;u.style.display=g;c=a.createElement("iframe");c.frameBorder=0;c.style.top="0px";c.style.position="absolute";c.style.left="0px";c.width="100%";c.height="100%";c.scrolling="no";c.title=b;1==h&&(c.allowTransparency=!0);u.appendChild(c);a.body.appendChild(u);b="";void 0===m||""==m?(b="document.open();"+(isCustomDomain(a)?'document.domain="'+
a.domain+'";':"")+" document.close();",b=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(b)+"}())":""):b=m;c.src=b;b=getIframeDocument(c);d="";isRTL(document)&&(d=' dir="rtl"');if(void 0===m||""==m)m="<html"+d+"><head><title>"+_dext_editor._config.system_title+' Editor Popup Window</title></head><body style="padding:0; margin:0;"></body></html>',b.open("text/html","replace"),isCustomDomain(a)&&(b.domain=a.domain),b.write(m),b.close(),1==
h&&(b.body.style.backgroundColor="transparent");a=b.getElementsByTagName("head")[0];m=q.length;for(h=0;h<m;h++)d=b.createElement("link"),d.type="text/css",d.rel="stylesheet",d.href=q[h],a.appendChild(d);"1"==DEXTTOP.G_CURREDITOR._config.customCssUrlDetailApply&&(q=b.createElement("link"),q.type="text/css",q.rel="stylesheet",q.href=DEXTTOP.G_CURREDITOR._config.style.customCssUrl,a.appendChild(q));b=getIframeDocument(c);a=b.getElementsByTagName("head")[0];q=t.length;for(h=0;h<q;h++)m=b.createElement("script"),
m.type="text/javascript",m.src=t[h],a.appendChild(m);t={};t.layer=u;t.iframe=c;t.iframeDoc=getIframeDocument(c);t.iframeWin=getIframeWindow(c);return t}Z[15]="5";_R_O_+="L";
function showColorPopup(a,b,c,d,e,f,g){var h=!1,m=!1;if("detail_font_color"==d||"detail_font_bg_color"==d||"detail_cell_bg_color"==d){var q=a.getElementById("editor_intelligent_menu_iframe_"+DEXTTOP.G_CURREDITOR.ID);null!=q&&"none"!=q.style.display&&(m=!0);h=!0}x=onColorPicker({cmd:"before",targetDoc:a,clickedElem:b,styleColor:c,actionType:d,leftX:x,topY:t,excuteFn:g});void 0!=x&&null!=x.clickedElem&&(b=x.clickedElem);x=q="";DEXTTOP.DEXT5.isRelease?(q=_dext_editor._config.webPath.css,x=_dext_editor._config.webPath.js):
(q=_dext_editor._config.webPath.css_dev,x=_dext_editor._config.webPath.js_dev);var t=[],u=q,u="ko-kr"!=_dext_editor._config.lang?u+("editor_"+_dext_editor._config.lang+".css"):u+"editor.css",u=u+("?t="+DEXTTOP.DEXT5.UrlStamp);t.push(u);isRTL()&&(q+="editor_rtl.css",q+="?t="+DEXTTOP.DEXT5.UrlStamp,t.push(q));var q=Math.max(a.documentElement.scrollHeight,a.body.scrollHeight),v=createPopupIframe(a,"popupCover","",G_MAIN_ZINDEX+2E3,"165px","300px","none",!0,"",t,[x+"jscolor/jscolor.js"]),w=a.createElement("div");
w.setAttribute("id","dext_color_back");w.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:'+(G_MAIN_ZINDEX+1E3)+'; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';w.style.position="static";var u="CSS1Compat"==a.compatMode?a.documentElement.scrollWidth:a.body.scrollWidth,y="CSS1Compat"==a.compatMode?a.documentElement.scrollHeight:
a.body.scrollHeight,x=e,t=f,u=changeValueForZoom(u,_dext_editor),y=changeValueForZoom(y,_dext_editor);h&&y>q&&(y=q);w.firstChild.style.width=u+"px";w.firstChild.style.height=y+"px";a.body.appendChild(w);w.onclick=function(){a.body.removeChild(a.getElementById("popupCover"));a.body.removeChild(w);DEXTTOP.DEXT5.util.isDialogOpen(DEXTTOP.G_CURREDITOR.ID)||dialogCancel()};f=getClientRect(b);e=b.ownerDocument||b.document||a;var z;"undefined"!=typeof e.defaultView?z=e.defaultView:"undefined"!=typeof e.parentWindow&&
(z=e.parentWindow);var B=getDocWindow(a),q=null;z!==B&&(q=getClientRect(z.frameElement));null==x&&(x=0);null==t&&(t=0);0==f.left&&(f=getClientRect(b));DEXTTOP.G_CURREDITOR._config.userColorPicker&&""!=DEXTTOP.G_CURREDITOR._config.userColorPicker&&(G_BASE_COLOR_PICKER=DEXTTOP.G_CURREDITOR._config.userColorPicker.split(","));var D=v.iframeDoc,A=v.iframeWin,C=G_BASE_COLOR_PICKER;if("detail_font_bg_color"==d){var E=D.createElement("div");E.setAttribute("class","color");E.setAttribute("id","removeBgColor");
E.style.display="block";E.style.textAlign="center";E.style.lineHeight="24px";E.style.backgroundColor="#ffffff";E.style.color="#5d5d5d";E.style.fontSize="11px";E.style.overflow="hidden";E.style.cursor="pointer";E.style.width="150px";E.style.height="20px";E.style.margin="5px 5px 0 5px";_a_tag=D.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.style.width="150px";_a_tag.style.height="20px";_a_tag.style.display="block";_a_tag.style.textDecoration="none";_a_tag.style.color="#5d5d5d";_a_tag.style.outlineOffset=
"-1px";_a_tag.innerText=dext5_lang.color_picker.remove_bg_Color;E.appendChild(_a_tag);u=function(a){return function(b){S("",a);DEXTTOP.DEXT5.util.stopEvent(b)}}("removeBgColor");DEXTTOP.DEXT5.util.addEvent(E,"click",u)}var H=C.length;e=D.createElement("ul");e.setAttribute("id","color_ul");DEXTTOP.DEXT5.util.setClass(e,"dext_color");"cssFloat"in e.style?e.style.cssFloat="left":e.style.styleFloat="left";for(var M=0;M<H;M++){var N="",N="cp_"+G_USE_EDITOR_ID+"_"+M,y=D.createElement("li");y.setAttribute("id",
N);y.setAttribute("title",C[M]);y.style.fontSize="1pt";var I="12px";DEXTTOP.DEXT5.browser.mobile&&(I="24px");y.style.width=I;y.style.height=I;"cssFloat"in y.style?y.style.cssFloat="left":y.style.styleFloat="left";y.style.padding="2px";y.style.margin="-1px 0 0 -1px";y.style.border="1px solid #fff";y.style.cursor="pointer";y.style.listStyleType="none";y.style.backgroundColor=C[M];_a_tag=D.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.style.width=I;_a_tag.style.height=I;_a_tag.style.display=
"block";_a_tag.title=C[M];y.appendChild(_a_tag);var S=function(e,f){N=f?f:3<e.length?e:C[e];"#000000"==N&&(N="black");var h=N;if(""!==c||void 0!==c){"none"==b.style.borderTopStyle&&(b.style.borderTopStyle="");b.style[c]=N;b.style.borderTopWidth="6px";0==DEXTTOP.DEXT5.browser.ie&&B.focus();a.body.focus();b.parentNode.focus();if(void 0!==d)if("doc_bg_color"==d)command_docBGColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),N);else if("detail_cell_bg_color"==d)isGroupingIcon(G_USE_EDITOR_ID,
"cell_bg_color")&&hideGroupingBox(),command_cellBGColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),N),onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:d});else if("line_color"==d)g&&g();else if("detail_font_color"==d)isGroupingIcon(G_USE_EDITOR_ID,"font_color")&&hideGroupingBox(),command_fontColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),N);else if("detail_font_bg_color"==d)isGroupingIcon(G_USE_EDITOR_ID,"font_bg_color")&&hideGroupingBox(),"removeBgColor"==
N?command_removeBackgroundColor(G_USE_EDITOR_ID,DEXTTOP.G_CURREDITOR):command_fontBgColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),N);else if("custom_color"==d&&b.onchange)b.onchange();a.body.removeChild(w);a.body.removeChild(a.getElementById("popupCover"));if(DEXTTOP.DEXT5.browser.LocalStorageSupported&&"removeBgColor"!=h){var m=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyColorName);null==m?DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyColorName,
h):(m=m.split(","),-1<m.indexOf(h)&&m.splice(m.indexOf(h),1),m.unshift(h),9<m.length&&(m.reverse(),m.shift(),m.reverse()),DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyColorName,m.toString()))}}},u=function(a){return function(b){S(a);DEXTTOP.DEXT5.util.stopEvent(b)}}(M);DEXTTOP.DEXT5.util.addEvent(y,"click",u);y.onmousedown=function(){return!1};y.unselectable="on";u=function(a,b,c){return function(c){function d(a,b,e){a.getElementsByTagName("li")[b+e]&&(a.getElementsByTagName("li")[b+
e].getElementsByTagName("a")[0]&&a.getElementsByTagName("li")[b+e].getElementsByTagName("a")[0].focus(),DEXTTOP.DEXT5.util.cancelEvent(c))}var e="which"in c?c.which:c.keyCode;37==e?d(a,b,-1):39==e?d(a,b,1):38==e?d(a,b,-9):40==e&&d(a,b,9)}}(e,M);DEXTTOP.DEXT5.util.addEvent(_a_tag,"keydown",u);e.appendChild(y)}e.style.width="158px";e.style.paddingLeft="5px";e.style.paddingTop="5px";e.style.paddingRight="0";e.style.paddingBottom="0";e.style.margin="0px";e.style.backgroundColor="#fbfbfb";var F=/msie ([0-9]{1,}[.0-9]{0,})/;
null!=F.exec(navigator.userAgent.toLowerCase())&&"6"==parseFloat(RegExp.$1)&&(e.style.width="210px");y=D.createElement("div");DEXTTOP.DEXT5.util.addClass(y,"recenlty_holder");y.style.margin="0px 0px 0px 0px";y.style.padding=DEXTTOP.DEXT5.browser.mobile&&"tablet"!=DEXTTOP.DEXT5.UserAgent.device.type?"5px 0px 3px 5px":"5px 0px 0px 5px";y.style.display="block";if(DEXTTOP.DEXT5.browser.LocalStorageSupported&&null!=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyColorName)){H=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyColorName).split(",");
u=D.createElement("div");u.style.padding="0";u.style.margin="0 0 5px 0";u.style.fontSize="0px";u.style.height="1px";u.style.width="151px";u.style.backgroundColor="#c5c5c5";y.appendChild(u);u=D.createElement("div");u.innerHTML=dext5_lang.color_picker.recently_used_color;u.className="DEXT_fiVe_EdiTor_font";u.style.color="#5d5d5d";u.style.fontSize="11px";y.appendChild(u);for(var M=H.length,O=0;O<M;O++){var P=D.createElement("span");P.setAttribute("id","recentlyColor_"+O);P.style.width=I;P.style.height=
I;P.style.border="1px solid #fff";P.style.display="inline-block";P.style.margin="2px 0px 0px -1px";P.style.padding="2px";P.setAttribute("title",H[O]);_a_tag=D.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.style.width=I;_a_tag.style.height=I;_a_tag.style.display="block";P.appendChild(_a_tag);P.style.backgroundColor=H[O];u=function(a){return function(b){S("",a);DEXTTOP.DEXT5.util.stopEvent(b)}}(H[O]);DEXTTOP.DEXT5.util.addEvent(P,"click",u);y.appendChild(P)}}if(!DEXTTOP.DEXT5.browser.mobile||
"tablet"==DEXTTOP.DEXT5.UserAgent.device.type){var J=D.createElement("div");J.setAttribute("class","color");J.setAttribute("id","more_btn");J.style.cursor="pointer";J.style.width="150px";J.style.height="20px";J.style.overflow="hidden";J.style.fontSize="11px";J.style.color="#5d5d5d";J.style.lineHeight="20px";J.style.display="block";J.style.textAlign="center";J.style.autoComplete="off";J.style.marginBottom="5px";J.style.marginTop="5px";_a_tag=D.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.style.width=
"146px";_a_tag.style.height="16px";_a_tag.style.display="block";_a_tag.style.textDecoration="none";_a_tag.style.color="#5d5d5d";_a_tag.style.marginTop="2px";_a_tag.style.marginLeft="2px";_a_tag.innerText=dext5_lang.color_picker.custom_color;J.appendChild(_a_tag);DEXTTOP.DEXT5.util.addEvent(J,"click",function(){(new A.jscolor.color(J,{},b,c,d,g,h)).showPicker({preventScroll:"1"==_dext_editor._config.autoRepositionPopupAndMenu.enableTransition});var e=getClientRect(L),e=parseInt(e.bottom,10)-parseInt(e.top,
10);v.layer.style.height=e+150+"px";null!=F.exec(navigator.userAgent.toLowerCase())&&"6"==parseFloat(RegExp.$1)&&(v.iframe.style.height=e+150+"px");var f=163;DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.browser.quirks&&--f;D.getElementById("color_picker").firstChild.style.width=f+"px";D.getElementById("color_picker").style.width="163px";D.getElementById("color_picker").style.display="";f=getClientRect(D.getElementById("color_picker"));f=parseInt(f.bottom,10)-parseInt(f.top,10);setColorPickerHeight(a,e+
f);changePosForCovered({popupNode:D.getElementById("color_picker"),checkNode:D.getElementById("color_picker")})})}I=D.createElement("div");I.style.clear="both";I.style.margin="0";I.style.padding="0";I.style.line_height="0";I.style.fontSize="0";var L=D.createElement("div");L.className="DEXT_fiVe_EdiTor";L.style.backgroundColor="#fbfbfb";"detail_font_bg_color"==d&&L.appendChild(E);L.appendChild(e);L.appendChild(I);L.appendChild(y);DEXTTOP.DEXT5.browser.mobile&&"tablet"!=DEXTTOP.DEXT5.UserAgent.device.type||
L.appendChild(J);L.style.position="absolute";L.style.width="163px";L.style.border="solid 1px #bbbbbb";D.body.appendChild(L);z=v.iframe.contentWindow;var K=getIframeDocument(v.iframe);setZoomValueToBody(K,DEXTTOP.G_CURREDITOR);setTimeout(function(){K.getElementsByTagName("A")[0].focus()},1);DEXTTOP.DEXT5.util.addEvent(K,"keyup",function(c){c=c?c:z.event;27==("which"in c?c.which:c.keyCode)&&(a.body.removeChild(w),a.body.removeChild(a.getElementById("popupCover")),setTimeout(function(){try{B==window?
setFocusToBody():(0==DEXTTOP.DEXT5.browser.ie&&B.focus(),a.body.focus(),b.parentNode.focus())}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},1))});if(a==document)v.layer.style.display="block",m=D.getElementsByTagName("div")[0],P=getClientRect(m),E=getClientRect(_iframeWin.frameElement),v.layer.style.display="none",m=parseInt(P.right,10)-parseInt(P.left,10),parseInt(P.bottom,10),parseInt(P.top,10),f.left+m>=E.right?(v.layer.style.left=f.left-(f.left+m-E.right+30)+"px",v.layer.style.top=
f.bottom+t+"px"):null==q?(v.layer.style.left=f.left+x+"px",v.layer.style.top=f.bottom+t+"px"):(v.layer.style.left=q.left+f.left+x+"px",v.layer.style.top=q.top+f.bottom+t+"px"),isRTL(document)&&(I=0,I=f.right+x,q&&(I+=q.left),I-=m,0>I&&(I=10),v.layer.style.left=I+"px");else if(null==q)v.layer.style.left=f.left+x+"px",isRTL(document)&&(v.layer.style.display="block",m=D.getElementsByTagName("div")[0],P=getClientRect(m),v.layer.style.display="none",m=parseInt(P.right,10)-parseInt(P.left,10),I=0,I=f.right+
x,I-=m,0>I&&(I=10),v.layer.style.left=I+"px"),a.getElementById("editor_popup_row_property")||a.getElementById("editor_popup_column_property")?v.layer.style.top="0px":v.layer.style.top=f.bottom+t+"px";else{I=E=0;y=getDialogWindow();if(null!=DEXTTOP.G_CURREDITOR.dialogWindow)for(u=_iframeWin.parent.parent;u!=y;)H=getClientRect(u.frameElement),E+=H.left,I+=H.top,u=u.parent;O=M=H=u=0;h&&(u=Math.max(a.documentElement.scrollLeft,a.body.scrollLeft),H=Math.max(a.documentElement.scrollTop,a.body.scrollTop),
u=changeValueForZoom(u,DEXTTOP.G_CURREDITOR),H=changeValueForZoom(H,DEXTTOP.G_CURREDITOR),M=m?getClientRect(frameElement).top:0,O=m?getClientRect(frameElement).left:0);O=q.left+f.left+x+E+u+O;v.layer.style.display="block";m=D.getElementsByTagName("div")[0];P=getClientRect(m);v.layer.style.display="none";var m=parseInt(P.right,10)-parseInt(P.left,10),P=getWindowClientSize(y),W={},W=getWindowScrollPos(y),y=W[0]+P[0]-20,m=O+m;m>y&&(O-=m-y);v.layer.style.left=O+"px";v.layer.style.top=q.top+f.bottom+t+
I+H+M+"px";isRTL(document)&&(v.layer.style.display="block",m=D.getElementsByTagName("div")[0],P=getClientRect(m),v.layer.style.display="none",m=parseInt(P.right,10)-parseInt(P.left,10),I=0,I=f.right+x+E+u+rectFrameLef,q&&(I+=q.left),I-=m,0>I&&(I=10),v.layer.style.left=I+"px")}v.layer.style.display="block";DEXTTOP.DEXT5.browser.ie&&(x=D.getElementById("color_ul"),x=getClientRect(x),850<x.bottom-x.top&&(e.style.paddingBottom=DEXTTOP.G_CURREDITOR._config.userColorPicker&&""!=DEXTTOP.G_CURREDITOR._config.userColorPicker?
"":"5px"));changePosForCovered({popupNode:v.iframe,checkNode:v.iframe.contentWindow.document.getElementsByTagName("div")[0]});setFocusFirstAndLast(K,L.getElementsByTagName("a")[0])}T[22]=T[4];
function showAccessPopup(a,b,c,d,e,f){var g=a.createElement("div");g.setAttribute("id","dext_access_back");g.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:12; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';var h="CSS1Compat"==a.compatMode?a.documentElement.scrollHeight:a.body.scrollHeight;g.firstChild.style.width=("CSS1Compat"==
a.compatMode?a.documentElement.scrollWidth:a.body.scrollWidth)+"px";g.firstChild.style.height=h+"px";a.body.appendChild(g);g.onclick=function(){a.body.removeChild(g);c.style.display="none"};c.getElementsByTagName("p")[0].innerHTML=d;setTimeout(function(){var d=getClientRect(b);c.style.display="";if(void 0!=e){var g=d.left+e;isRTL()&&(g=d.right+e-c.offsetWidth,10>g&&(g=10))}else g=(("CSS1Compat"==a.compatMode?a.documentElement.scrollWidth:a.body.scrollWidth)-c.offsetWidth)/2;c.style.left=g+"px";c.style.top=
void 0!=f?d.top+f+"px":(("CSS1Compat"==a.compatMode?a.documentElement.scrollHeight:a.body.scrollHeight)-c.offsetHeight)/2+"px"},0)}Z[16]=".";_R_O_+="R";function getClickCell(a,b){var c=null;a.srcElement?c=a.srcElement:a.target&&(c=a.target);if(null!=c)return GetParentbyTagName(c,b)}Z[17]="c";___=1==DEXTTOP.IsCrossDomain?___.href:top.location.href;
function createSelectProtocols(a,b){var c=["http://","https://","ftp://","news://","other"],d=["http://","https://","ftp://","news://",""],e=[],f;for(f in c)e.push(document.createElement("option")),e[f].innerHTML=c[f],e[f].setAttribute("value",d[f]),a.appendChild(e[f]);DEXTTOP.DEXT5.util.addEvent(b,"keyup",function(){for(var d in c)c[d]==b.value&&"other"!=c[d]&&(b.value="",a.options[d].selected="selected")})}function lastFocus(a){}R[27]="s";C1[27]="a";C2[27]=".";S1[27]="s";S2[27]="a";
function press_enter_esc_btn(a,b){var c=!1,d=!1;if(27==("which"in a?a.which:a.keyCode)){for(var e in G_DEPlugin)if(G_DEPlugin[e].isProcess)return!1;b?(c=closeWebAccessPopup(b),d=closeGridSelectPopop(b),"1"==DEXTTOP.G_CURREDITOR._config.imgPreView&&null!=DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup")&&""==DEXTTOP.DEXTDOC.getElementById("dext_imgPreView_popup").style.display&&closeBtnPreViewMode()):d=c=!0;c&&d&&(c=DEXTTOP.G_CURREDITOR.dialog._selfTopWindow(DEXTTOP.G_CURREDITOR.ID).parentNode.parentNode,
hideDialog(c,{isCancel:!0}))}}T[23]=",";___=1==DEXTTOP.IsCrossDomain?null!=DEXTTOP.DEXTDOC.referrer&&void 0!=DEXTTOP.DEXTDOC.referrer&&""!=DEXTTOP.DEXTDOC.referrer?DEXTTOP.DEXTDOC.referrer:___:___;function closeWebAccessPopup(a){for(var b=a.getElementsByTagName("div"),c=b.length,d=!0,e=0;e<c;e++)if(-1<b[e].id.indexOf("access_div")&&"none"!=b[e].style.display){c=a.getElementById("dext_access_back");a.body.removeChild(c);b[e].style.display="none";d=!1;break}return d}Z[18]="o";
function closeGridSelectPopop(a){a=a.getElementById("grid_select");var b=!0;a&&"none"!=a.style.display&&(a.style.display="none",b=!1);return b}Z[19]="m";K__+=Z[18];_R_O_+="S";T[24]=" c";
function setEditorHeight(a,b){var c={};b?c.height=parseIntOr0(a._config.style.height):c=getClientSize(a._FRAMEWIN.frameElement);var d=c.height,c=getEditorFrameDoc(a),e=c.getElementById("dext_topstatusbar_"+a.ID),f=c.getElementById("dext_menu_"+a.ID),g=c.getElementById("dext_toolbar_"+a.ID),h=c.getElementById("dext_statusbar_"+a.ID),m=c.getElementById("tool3_"+a.ID),q=0,t=0;if(e){switch(a._config.top_status_bar){case "1":t=0;break;default:t=27}q+=t}if(f){switch(a._config.top_menu){case "1":t=0;break;
default:t=29}q+=t}if(g){f=c.getElementById("dext_tab_tool1_"+a.ID);e=c.getElementById("dext_tab_tool2_"+a.ID);f=getClientRect(f).bottom-getClientRect(f).top;e=getClientRect(e).bottom-getClientRect(e).top;switch(a._config.tool_bar){case "1":t=f+e+1;DEXTTOP.DEXT5.browser.quirks&&("mono"==a._config.style.skinName?--t:t-=2);DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(t+=1);break;case "2":t=f+e+1;DEXTTOP.DEXT5.browser.quirks&&--t;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&
(t+=1);break;case "3":t=f+e+1;DEXTTOP.DEXT5.browser.quirks&&(t="mono"==a._config.style.skinName?t-2:t-3);1>t&&(t=1);break;case "4":t=93;break;default:t=f+e+1,DEXTTOP.DEXT5.browser.ie&&(DEXTTOP.DEXT5.browser.quirks||7!=DEXTTOP.DEXT5.browser.ieVersion?DEXTTOP.DEXT5.browser.quirks&&7>=DEXTTOP.DEXT5.browser.ieVersion&&"mono"==a._config.style.skinName&&(t+=5):--t)}q+=t;"1"==a._config.formMode&&m&&(q+=35,!DEXTTOP.DEXT5.browser.ie||11>=DEXTTOP.DEXT5.browser.ieVersion&&10<=DEXTTOP.DEXT5.browser.ieVersion||
(7>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks?q-=6:9>=DEXTTOP.DEXT5.browser.ieVersion&&7<DEXTTOP.DEXT5.browser.ieVersion&&(q-=3)))}if(h){switch(a._config.status_bar){case "1":t=1;break;default:t=23}q+=t}h=c.getElementById("dext_tab_tool3_"+a.ID);"none"!=g.style.display&&h&&"none"!=h.style.display&&(h=getClientRect(h),q+=h.bottom-h.top);h=c.getElementById("dext_tab_tool4_"+a.ID);"none"!=g.style.display&&h&&"none"!=h.style.display&&(h=getClientRect(h),q+=h.bottom-h.top-1,DEXTTOP.DEXT5.browser.ie&&
9>=DEXTTOP.DEXT5.browser.ieVersion&&7<DEXTTOP.DEXT5.browser.ieVersion&&(q+=1));a.baseMenuToolbarHeight=q;-1<a._config.style.height.indexOf("%")&&(c.getElementsByTagName("html")[0].style.height="100%",d=c.getElementsByTagName("body")[0],d.style.height="100%",d.style.margin="0",c.body.getElementsByTagName("div")[0].style.height="100%",getClientRect(c.body.getElementsByTagName("div")[0]),d=Math.max(c.body.clientHeight,c.documentElement.clientHeight));isViewMode(a)&&(q=2,7==DEXTTOP.DEXT5.browser.trident||
12<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.quirks||(q=0));"0"==a._config.editorborder&&(q-=2);a._defaultHeight=d-q;1!=getDEXTWINZoomValue(a)&&2<q&&(a._defaultHeight-=2)}_R_O_+="T";K__+="p";
function _fn_0(){var a=null,b=null;try{a=DEXTTOP.G_CURREDITOR}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(a)try{b=DEXTTOP.G_CURREDITOR._config}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(0!=!!a&&0!=!!b&&(a=function(a){try{DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(a)}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},"undefined"!==typeof T)){var e=T.toString(),e=e.replace(/,/gi,""),f,g,h,m,q,t;f=g=h=m=q=t="";try{t=_0_[3],f=_0_[4],g=_0_[5],
h=_0_[7],q=_0_[8],m=_1_}catch(u){a(e+u.toString());return}try{if(0==m.length||m!=h){a(e+DEXTTOP.DEXT5.util._fn_$mDRM(M1)+m);return}}catch(v){a(e+v.toString());return}try{if(0==g.length){a(e);return}if("0"!=g){var w=new Date;g=g.toString();g=g.split("-");var y=parseIntOr0(g[0]),x=parseIntOr0(g[1]),x=x-1,z=parseIntOr0(g[2]);if(w>new Date(y,x,z,23,59,59)){a(e+DEXTTOP.DEXT5.util._fn_$mDRM(M2)+g.join());return}}}catch(B){a(e+B.toString());return}try{if(0==f.length){a(e);return}f=f.split(",");w=!1;f.push("localhost");
f.push("127.0.0.1");DEXTTOP&&DEXTTOP.DEXT5&&DEXTTOP.DEXT5.util&&""==DEXTTOP.DEXT5.util.trim(___)&&(___=DEXTTOP.DEXTWIN.location.href);-1<___.indexOf("file://")&&(___=""!=b.post_url_save_for_notes?b.post_url_save_for_notes:b.post_url);for(y=0;y<f.length;y++){var D=f[y].replace("*.",""),A=D.split("-");if(!(3!=A.length&&4!=A.length||isNaN(A[0])||isNaN(A[1])||isNaN(A[2])))if("7ylc-firp-7hek-lz88"==D.toLowerCase()||"15si-20th-8ry8-0z0z"==D.toLowerCase())w=!1;else{var C=D.replace(/-/gi,"").split(""),E=
C.length;for(f=0;f<E;f++)C[f]=parseInt(C[f],10);if(10==E){D=[1,3,7,1,3,7,1,3,5];for(f=A=0;9>f;f++)A+=D[f]*C[f];A+=parseInt(D[8]*C[8]/10,10);w=Math.floor(C[9])===(10-A%10)%10;break}}if(-1!=___.toLowerCase().search(D.toLowerCase())){w=!0;break}else{var H=D.replace("www.","");if(H!=D&&(H="/"+H,-1!=___.toLowerCase().search(H.toLowerCase()))){w=!0;break}}}try{var M=q.split(",")[2];M&&-1<M.toLowerCase().indexOf("a")?b.auditLogEnable="0":b.auditLogEnable="1"}catch(N){b.auditLogEnable="1"}if(0==w){a(e+DEXTTOP.DEXT5.util._fn_$mDRM(M3)+
___);return}}catch(I){if(I.number&&5011==(I.number&65535))return;a(e+I.toString());return}C=!1;try{if(0==t.length){a(e);return}if("I"==t){try{if("1"==b.formMode&&!(q.split(",")[2]&&-1<q.split(",")[2].indexOf("M"))){a(e+" "+t);return}}catch(S){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}C=!0}else if("P"==t){try{if("1"==b.formMode&&!(q.split(",")[2]&&-1<q.split(",")[2].indexOf("M"))){a(e+" "+t);return}}catch(F){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}C=!0}else"A"==t?C=
!0:"M"==t&&(C=!0)}catch(O){a(e+O.toString());return}try{if(1==C){if((b.interworkingModuleFirst||b.interworkingModuleSecond||b.interworkingModuleThird)&&q.split(",")[2]){var P=q.split(",")[2];t=!1;0>P.indexOf(b.interworkingModuleFirst)?t=!0:0>P.indexOf(b.interworkingModuleSecond)?t=!0:0>P.indexOf(b.interworkingModuleThird)&&(t=!0);if(t){a(e+DEXTTOP.DEXT5.util._fn_$mDRM(M4));return}}if(-1==q.split(",")[0].indexOf("E")){a(e);return}}}catch(J){a(e+J.toString());return}try{G_SC=q.split(",")[2]&&(-1<q.split(",")[2].indexOf("C")||
-1<q.split(",")[2].indexOf("O"))?"Y":"N"}catch(L){G_SC="N"}_1_=!0}}T[25]=T[13];K__+="XYZ";_R_O_+="x";
function checkDefaultMessage(a){try{var b=DEXTTOP.G_CURREDITOR._config.firstLoadType;""!=DEXTTOP.G_CURREDITOR._config.firstLoadType&&""==DEXTTOP.G_CURREDITOR._config.defaultMessage&&(DEXTTOP.G_CURREDITOR._config.defaultMessage=" ");if(""==DEXTTOP.G_CURREDITOR._config.defaultMessage)return!1;""!=DEXTTOP.G_CURREDITOR._config.defaultMessage&&(DEXTTOP.G_CURREDITOR._config.defaultMessage="",DEXTTOP.G_CURREDITOR._config.firstLoadType="");var c=!1;!isViewMode(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR._config.editorBodyEditableEx&&
(DEXTTOP.G_CURREDITOR._BODY.contentEditable=!0,DEXTTOP.G_CURREDITOR._config.editorBodyEditable=!0);switch(b.toLowerCase()){case "bodyvalue":DEXTTOP.DEXT5.setBodyValue(DEXTTOP.G_CURREDITOR._config.firstLoadMessage,DEXTTOP.G_CURREDITOR._config.editor_id);c=!0;break;case "bodyvalueex":DEXTTOP.DEXT5.setBodyValueEx(DEXTTOP.G_CURREDITOR._config.firstLoadMessage);c=!0;break;case "bodyvalueexlikediv":DEXTTOP.DEXT5.setBodyValueExLikeDiv(DEXTTOP.G_CURREDITOR._config.firstLoadMessage);c=!0;break;case "htmlvalue":DEXTTOP.DEXT5.setHtmlValue(DEXTTOP.G_CURREDITOR._config.firstLoadMessage);
c=!0;break;case "htmlvalueex":DEXTTOP.DEXT5.setHtmlValueEx(DEXTTOP.G_CURREDITOR._config.firstLoadMessage);c=!0;break;case "url":DEXTTOP.DEXT5.loadHtmlValueExFromURL(DEXTTOP.G_CURREDITOR._config.firstLoadMessage,DEXTTOP.G_CURREDITOR._config.editor_id);c=!0;break;default:DEXTTOP.DEXT5.setBodyValue("",DEXTTOP.G_CURREDITOR._config.editor_id,!0),setBodyDefaultValue(),setFocusToBody(),c=!0}}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}_R_O_+="y";Z[20]="/";
function isViewMode(a){var b=a;if(void 0==a||null==a)b=DEXTTOP.G_CURREDITOR;return"view"==b._config.mode?!0:!1}T[26]="n";K__+="qrstU";
function resizeEditor(a,b){try{if(null==a||void 0==a)a=DEXTTOP.G_CURREDITOR;setEditorHeight(a,b);var c=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+a.ID);("undefined"!=typeof c.contentDocument?c.contentDocument:"undefined"!=typeof c.contentWindow?c.contentWindow.document:document).getElementById("ue_editor_holder_"+a.ID).style.height=a._defaultHeight+"px";for(var c=["source","text"],d=c.length,e=0;e<d;e++){var f=document.getElementById("dext5_"+c[e]+"_"+a.ID),g=a._defaultHeight;DEXTTOP.DEXT5.browser.quirks?
g-=5:DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(g-=3);f.style.height=g+"px"}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}Z[21]="z";K__+="VW";
function getCustomIconAttr(a){var b={isCustom:!1,command:"","desc_ko-kr":"","desc_en-us":"","desc_ja-jp":"","desc_zh-cn":"","desc_zh-tw":"","desc-vi-vn":"","desc-ru-ru":"","desc-ar":""};"c_"==a.substring(0,2)&&(b.isCustom=!0);b.isCustom&&(a=a.split("|"),b.command=a[0],a[1]&&(a=a[1].split("^"),1==a.length?(b["desc_ko-kr"]=a[0],b["desc_en-us"]=a[0],b["desc_ja-jp"]=a[0],b["desc_zh-cn"]=a[0],b["desc_zh-tw"]=a[0],b["desc_vi-vn"]=a[0],b["desc_ru-ru"]=a[0],b.desc_ar=a[0]):(a[0]&&(b["desc_ko-kr"]=a[0]),a[1]&&
(b["desc_en-us"]=a[1]),a[2]&&(b["desc_ja-jp"]=a[2]),a[3]&&(b["desc_zh-cn"]=a[3]),a[4]&&(b["desc_zh-tw"]=a[4]),a[5]&&(b["desc_ru-ru"]=a[5]),a[5]&&(b.desc_ar=a[6]))));return b}K__+="67890";T[27]=T[18];function removeCRLFChar(a){a=changeRealTagToReplaceString(a);a=changeReplaceStringToRealTag(a);return a=a.replace(/>\n</g,"><")}T[28]="a";
function setFocusFirstAndLast(a,b,c){try{var d=null;if(c)d=c;else var e=a.getElementsByTagName("a").length,d=a.getElementsByTagName("a")[e-1];var f=getDocWindow(a),g=!1;f.frameElement&&f.frameElement.parentNode&&"dext_dialog"==f.frameElement.parentNode.id&&(g=!0);var h=c=null;g&&(c=f.frameElement.parentNode.getElementsByTagName("div")[0],h=c.getElementsByTagName("a")[0]);c=function(c){c=c?c:DEXTTOP.DEXTWIN.event;var e="which"in c?c.which:c.keyCode;DEXTTOP.DEXT5.util.cancelEvent(c);0==c.shiftKey&&
9==e?(0==DEXTTOP.DEXT5.browser.ie&&f.focus(),a.body.focus(),b.focus()):c.shiftKey&&9==e&&(0==DEXTTOP.DEXT5.browser.ie&&f.focus(),a.body.focus(),d.focus())};b.onkeydown=function(b){b=b?b:f.event;var c="which"in b?b.which:b.keyCode,e=g?DEXTTOP.DEXTWIN:f,m=g?DEXTTOP.DEXTDOC:a,w=g?h:d;b.shiftKey&&9==c&&(DEXTTOP.DEXT5.util.cancelEvent(b),0==DEXTTOP.DEXT5.browser.ie&&e.focus(),m.body.focus(),w.focus())};d.onkeydown=function(c){c=c?c:f.event;var d="which"in c?c.which:c.keyCode,e=g?DEXTTOP.DEXTWIN:f,m=g?
DEXTTOP.DEXTDOC:a,w=g?h:b;0==c.shiftKey&&9==d&&(DEXTTOP.DEXT5.util.cancelEvent(c),0==DEXTTOP.DEXT5.browser.ie&&e.focus(),m.body.focus(),w.focus())};h&&(h.onkeydown=c)}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}Z[25]=".";T[29]="c";
function move_next_a_tag(a,b,c,d,e,f){b.childNodes[c+e]&&b.childNodes[c+e].childNodes[d+f]&&(b.childNodes[c+e].childNodes[d+f].getElementsByTagName("a")[0]&&b.childNodes[c+e].childNodes[d+f].getElementsByTagName("a")[0].focus(),DEXTTOP.DEXT5.util.cancelEvent(a))}K__+="123";T[30]="t ";Z[26]="a";K__+="45";SIL[4]="a";
function removeFakeLineHeight(a){if(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion){var b="span strong i u strike sup sub".split(" "),c=b.length,d=DEXTTOP.G_CURREDITOR._setting.line_height,e=d;-1<d.indexOf("%")?(e=parseInt(d,10),d=e/=100,e+=.01):0>d.indexOf("px")&&0>d.indexOf("pt")&&0>d.indexOf("em")&&(d=e=parseFloat(d),e+=.01);for(var f=0;f<c;f++)for(var g=a.getElementsByTagName(b[f]),h=g.length,m=0;m<h;m++)g[m].style.lineHeight!=d&&g[m].style.lineHeight!=
e||g[m].style.removeAttribute("line-height")}}Z[27]="s";T[31]="u";
function showRuler(a){if(G_Ruler&&G_Ruler.viewRulerStatus&&"view"!=a._config.mode){var b=getEditorFrameDoc(a),c=G_Ruler.rulerPositionLen;G_Ruler.SettingInit();G_Ruler.SelectIcon();if("1"==a._config.horizontalLine.use){for(var d="",e=0;e<a._config.horizontalLine.url.length;e++)0<e&&(d+=","),d+="url("+a._config.horizontalLine.url[e]+")";_iframeDoc.body.style.backgroundImage=d;_iframeDoc.body.style.backgroundRepeat="repeat"}"1"==a._config.ruler.useVertical&&(e=b.getElementById("dext_ruler_vertical_"+
a.ID),null!=e&&(e.style.display=""));"1"==a._config.ruler.viewRuler&&(G_Ruler.rulerArea.style.display="","2"==a._config.ruler.mode&&(G_Ruler.rulerBottomArea.style.display=""),resizeEditor(a));if("1"==a._config.ruler.viewPointer)for(e=0;e<c;e++)if(d=b.getElementById("dext_ruler_point_"+e+"_"+a.ID))d.style.display="";if("1"==a._config.ruler.viewGuideLine)for(e=0;e<c;e++)(d=b.getElementById("dext_ruler_pointline_"+e+"_"+a.ID))&&"1"==a._config.ruler.mode&&(d.style.display="");G_BodyFit.widthFixedStatus||
G_BodyFit.SetBodyWidth();G_Ruler.SetRulerPosition()}}R[28]="p";C1[28]="s";C2[28]="a";S1[28]="p";S2[28]="s";
function hideRuler(a){var b=getEditorFrameDoc(a),c=G_Ruler?G_Ruler.rulerArea:null;if("1"==a._config.ruler.use&&null!=c){G_BodyFit.widthFixableStatus||(G_BodyFit.widthFixedStatus=!1);G_Ruler.SelectIcon();c.style.display="none";"2"==a._config.ruler.mode&&(G_Ruler.rulerBottomArea.style.display="none");if("1"==a._config.ruler.viewPointer)for(var d=c.getElementsByTagName("img"),e=d.length,c=0;c<e;c++)d[c].style.display="none";if("1"==a._config.ruler.viewGuideLine){d=b.getElementById("dext_ruler_pointline_div").getElementsByTagName("div");
e=d.length;for(c=0;c<e;c++)d[c].style.display="none";"2"==a._config.ruler.mode&&(b.getElementById("dext_ruler_pointline_3_"+a.ID).style.display="none",(c=b.getElementById("dext_ruler_pointline_4_"+a.ID))&&"none"!=c.style.display&&(c.style.display="none"))}"1"==a._config.ruler.useVertical&&(c=b.getElementById("dext_ruler_vertical_"+a.ID),null!=c&&(c.style.display="none"),c=b.getElementById("ue_editor_holder_"+a.ID),null!=c&&(c.style.marginLeft="0px"));resizeEditor(a,!1)}"1"==a._config.horizontalLine.use&&
(changeBodyImageProperty(!0),G_BodyFit.noncreationAreaBackgroundStatus&&setBodyFitStyle(a,!0));"2"==a._config.horizontalLine.use&&(a=b.getElementById("dext_horizontal_line_"+a.ID))&&(a.style.marginLeft="0px");G_BodyFit.SetBodyWidth()}Z[28]="p";K__+="+";T[32]="s.";C1[29]="p";C2[29]="s";S2[29]="p";
var K__=K__+"/",_L__={_K:_R_O_+K__,DE:function(a){var b="",c,d,e,f,g,h=0;if(void 0==a||null==a||""==a)return!1;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<a.length;)c=this._K.indexOf(a.charAt(h++)),d=this._K.indexOf(a.charAt(h++)),f=this._K.indexOf(a.charAt(h++)),g=this._K.indexOf(a.charAt(h++)),c=c<<2|d>>4,d=(d&15)<<4|f>>2,e=(f&3)<<6|g,b+=String.fromCharCode(c),64!=f&&(b+=String.fromCharCode(d)),64!=g&&(b+=String.fromCharCode(e));return b=_L__._utf8_d(b)},_utf8_d:function(a){for(var b="",c=0,d=c1=
c2=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):191<d&&224>d?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((d&31)<<6|c2&63),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((d&15)<<12|(c2&63)<<6|c3&63),c+=3);return b}};C2[30]="p";
function ClearPreViewContent(a){a=a._EDITOR.preview.contentDocument?a._EDITOR.preview.contentDocument:a._EDITOR.preview.contentWindow.document;for(var b=a.getElementsByTagName("embed"),c=b.length-1;0<=c;c--){var d=b[c];try{d.stop()}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}a.body.innerHTML=""}
function setFocusFirstAndLast2(a,b){try{a.onkeydown=function(a){a=a?a:window.event;var c="which"in a?a.which:a.keyCode;a.shiftKey&&9==c&&(DEXTTOP.DEXT5.util.cancelEvent(a),b.focus())},b.onkeydown=function(b){b=b?b:window.event;var c="which"in b?b.which:b.keyCode;0==b.shiftKey&&9==c&&(DEXTTOP.DEXT5.util.cancelEvent(b),a.focus())}}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setMatchSelectedValue(a){try{var b=a.getElementsByTagName("select"),c=b.length;for(a=0;a<c;a++){for(var d=b[a].getElementsByTagName("option"),e=d.length,f=0;f<e;f++)1==d[f].selected?d[f].setAttribute("selected","selected"):d[f].removeAttribute("selected");if(DEXTTOP.DEXT5.browser.ie&&9==DEXTTOP.DEXT5.browser.ieVersion){var g=b[a].outerHTML,h=RegExp('(<option[^>]+)(selected="")(.*?>)',"gi");h.test(g)&&(g=g.replace(h,"$1$3"),b[a].outerHTML=g)}}}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&
RAONWIZDLW()}}
function setMatchInputValue(a,b){try{for(var c=a.getElementsByTagName("input"),d=c.length,e=0;e<d;e++){var f=c[e];if(-1<",,text,date,time,datetime-local,number,month,range,color,tel,url,week,".indexOf(","+f.type+",")){var g=f.value;""==g||null!=f.getAttribute("value")&&g==f.getAttribute("value")||f.setAttribute("value",g)}}for(var h=a.getElementsByTagName("textarea"),m=h.length,e=0;e<m;e++){var f=h[e],q=f.value;0==DEXTTOP.DEXT5.browser.ie?""==q||""!=f.innerHTML&&q==f.innerHTML||(f.innerHTML=q):1!=
b&&""==q&&f.placeholder&&""!=f.placeholder&&(f.innerHTML="")}}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function getBase64ImageCount(){var a=0;try{var b=DEXTTOP.G_CURREDITOR;if(b){var c=b._FRAMEWIN,d=b.getEditorMode();"source"!=d&&"text"!=d||b.setChangeMode("design");c.ReplaceImageToRealObject();c.changeBodyContenteditable(!1);c.changeBodyImageProperty(!0);var e=b._DOC.body.outerHTML,d="",f=RegExp("<img[^>]*src=(.*?)>","gi"),g=e.match(RegExp("<[^>]*url\\((.*?)\\)","gi")),h=e.match(f);if(g)for(var m=g.length,q=0;q<m;q++)d=g[q].match("url\\((.*?)\\)")[1].replace(/"/gi,"").replace(/'/gi,"").replace(/&quot;/gi,
""),null!=d&&void 0!=d&&""!=d&&(0==d.indexOf("data:")||"ieplugin"==b._config.runtimes&&0==d.indexOf("file://"))&&a++;if(h)for(var t=h.length,q=0;q<t;q++)d=h[q].match("src=\"(.*?)\"|src='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,""),null!=d&&void 0!=d&&""!=d&&(0==d.indexOf("data:")||"ieplugin"==b._config.runtimes&&0==d.indexOf("file://"))&&a++;G_BodyFit.noncreationAreaBackgroundStatus&&c.setBodyFitStyle(b,!0);c.changeBodyImageProperty(!1);c.ReplaceRealObjectToImage();c.changeBodyContenteditable(!0)}}catch(u){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return a}
function getBase64ImageCountEx(a){var b=DEXTTOP.G_CURREDITOR,c=0;try{var d="",e=RegExp("<img[^>]*src=(.*?)>","gi"),f=a.match(RegExp("<[^>]*url\\((.*?)\\)","gi")),g=a.match(e);if(f)for(var h=f.length,m=0;m<h;m++)d=f[m].match("url\\((.*?)\\)")[1].replace(/"/gi,"").replace(/'/gi,"").replace(/&quot;/gi,""),null!=d&&void 0!=d&&""!=d&&(0==d.indexOf("data:")||"ieplugin"==b._config.runtimes&&0==d.indexOf("file://"))&&c++;if(g)for(var q=g.length,m=0;m<q;m++)d=g[m].match("src=\"(.*?)\"|src='(.*?)'")[1].replace(/"/gi,
"").replace(/'/gi,""),null!=d&&void 0!=d&&""!=d&&(0==d.indexOf("data:")||"ieplugin"==b._config.runtimes&&0==d.indexOf("file://"))&&c++}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}
function setEditorIframeTitle(a){var b="";isViewMode(a)?b=dext5_lang.iframe_title.design:(b="","0"==a._config.top_menu&&(b=dext5_lang.iframe_title.title_menu),"3"!=a._config.tool_bar&&(b+=""==b?" - ":", ","0"==a._config.tool_bar?(b+=dext5_lang.iframe_title.title_tool1,b+=", "+dext5_lang.iframe_title.title_tool2):"1"==a._config.tool_bar?b+=dext5_lang.iframe_title.title_tool2:"2"==a._config.tool_bar&&(b+=dext5_lang.iframe_title.title_tool1)),b+=(""==b?" - ":", ")+dext5_lang.iframe_title.title_text,
"0"==a._config.status_bar&&(b+=(""==b?" - ":", ")+dext5_lang.iframe_title.title_status),b+=", "+dext5_lang.iframe_title.title_help,b=dext5_lang.iframe_title.design+" - "+b);try{document.getElementById("dext5_design_"+a.ID).title=b}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function changeFontFamily(a){a=a.split(",");for(var b="",c=0;c<a.length;c++){var d=a[c],d=DEXTTOP.DEXT5.util.trim(d);if(-1<d.indexOf(".")||-1<d.indexOf(" "))d=d.replace(/"/g,""),d=d.replace(/'/g,""),d="'"+d+"'";b+=d;c!=a.length-1&&(b+=", ")}return b}
function loadScript(a,b){var c=a.url,d=a.targetDocument.getElementsByTagName("head")[0],e=a.targetDocument.createElement("script");e.type="text/javascript";e.src=c;"undefined"!==typeof e.onreadystatechange?e.onreadystatechange=function(){if("loaded"==e.readyState||"complete"==e.readyState)e.onreadystatechange=null,"function"==typeof b&&b(!0)}:e.onload=function(){"function"==typeof b&&b(!0)};e.onerror=function(){"function"==typeof b&&b(!1)};d.appendChild(e)}
function loadPluginJs(a,b){G_DEPlugin[a]?b():loadScript({url:_dext_editor._config.webPath.plugin+a+"/js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+"/dext5plugin.js?t="+DEXTTOP.DEXT5.UrlStamp,targetDocument:document},function(){"function"==typeof G_DEPlugin[a].isRequiredOtherResource?G_DEPlugin[a].isRequiredOtherResource(function(){"function"==typeof b&&b(!0)}):"function"==typeof b&&b(!0)})}
function htmlCollectionToArray(a,b){try{a=a.concat(Array.prototype.slice.call(b,0))}catch(c){for(var d=b.length,e=0;e<d;e++)a.push(b[e])}return a}
function createImgPreViewPopup(){var a=getDialogDocument();if(0==DEXTTOP.DEXT5.isPopUpCssLoaded){var b=a.createElement("link");b.type="text/css";b.rel="stylesheet";b.href=DEXTTOP.DEXT5.isRelease?"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang?DEXTTOP.G_CURREDITOR._config.webPath.css+"editor_popup_"+DEXTTOP.G_CURREDITOR._config.lang+".css?t="+DEXTTOP.DEXT5.UrlStamp:DEXTTOP.G_CURREDITOR._config.webPath.css+"editor_popup.css?t="+DEXTTOP.DEXT5.UrlStamp:"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang?DEXTTOP.G_CURREDITOR._config.webPath.css_dev+
"editor_popup_"+DEXTTOP.G_CURREDITOR._config.lang+".css?t="+DEXTTOP.DEXT5.UrlStamp:DEXTTOP.G_CURREDITOR._config.webPath.css_dev+"editor_popup.css?t="+DEXTTOP.DEXT5.UrlStamp;var c=a.getElementsByTagName("head")[0];c.appendChild(b);"1"==DEXTTOP.G_CURREDITOR._config.customCssUrlDetailApply&&(a=a.createElement("link"),a.type="text/css",a.rel="stylesheet",a.href=DEXTTOP.G_CURREDITOR._config.style.customCssUrl+"?t="+DEXTTOP.DEXT5.UrlStamp,c.appendChild(a));DEXTTOP.DEXT5.isPopUpCssLoaded=!0}a=DEXTTOP.DEXTWIN;
null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(a=DEXTTOP.G_CURREDITOR.dialogWindow);null==a.document.getElementById("dext_imgPreView_popup")&&(c=document.createElement("div"),c.id="dext_imgPreView_popup",c.style.width=DEXTTOP.G_CURREDITOR._config.imgPreViewWidth,c.style.height=DEXTTOP.G_CURREDITOR._config.imgPreViewHeight,c.style.display="none",b=createImgPreviewDivHtml(DEXTTOP.G_CURREDITOR._config),c.innerHTML=b,a.document.body.appendChild(c),a=a.document,c=a.getElementById("dext_imgPreView_popup_close_btn"),
null!=a.getElementById("dext_imgPreView_popup")&&DEXTTOP.DEXT5.util.addEvent(c,"click",closeBtnPreViewMode))}
function createImgPreviewDivHtml(a){var b=parseInt(a.imgPreViewHeight)-2+"px";a=""+('<div class="DEXT_fiVe_PUi_imgPreView_popup_'+a.style.skinName+'" style="height:'+b+'">');a+='<strong class="DEXT_fiVe_imgPreView_tit_mode">Image Preview</strong><span class="DEXT_fiVe_imgPreView_img_box"></span>';a+='<span class="DEXT_fiVe_imgPreView_close_btn" id="dext_imgPreView_popup_close_btn"></span>';a+="</div>";b=DEXTTOP.DEXT5.util.getDefaultIframeSrc();return a+='<iframe frameborder="0" scrolling="no" style="position:absolute;left:0;top:0;width:100%;height:100%;z-index:-1" src="'+
b+'" title="Image Preview"></iframe>'}function closeBtnPreViewMode(){try{var a=getDialogDocument().getElementById("dext_imgPreView_popup");a.style.display="none";if(-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")){var b=a.getElementsByTagName("img")[0];b&&(b.style.display="none")}}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function event_dext_set_numbering_value(a,b,c,d,e,f){command_SetNumberingValue(a,b,c,d,e,f)}
function event_dext5editor_set_list_inoutdent_value(a,b,c,d,e){command_SetListInoutdent(a,b,c,d,e)};function setContextMenu(a,b){DEXTTOP.DEXT5.util.cancelEvent(a);"3"!=_dext_editor._config.contextMenuDisable&&("1"==DEXTTOP.G_CURREDITOR._config.usePasteToolbarAndContext&&checkImageInNavigatorClipboard?checkImageInNavigatorClipboard().then(function(b){DEXT5_CONTEXT.show(a,b.checked)}):DEXT5_CONTEXT.show(a,""))}
var DEXT5_CONTEXT={_reverse:!1,_context_id:"",_context_iframe:null,_context_zIndex:0,_context_bg_zIndex:0,_context_document:null,_context_main:null,_context_sub:null,_context_bg:null,_context_bg_id:"",_width:"",_height:"0",_item_disabled_list:[],_item_sub_list:{table_copy_paste:"table_copy  intable_paste table_content_paste table_content_paste_to_text table_content_paste_with_format".split(" "),table_copy_paste2:["table_copy","table_content_paste","table_content_paste_to_text","table_content_paste_with_format"],
table_copy_paste3:["intable_paste","table_content_paste","table_content_paste_to_text","table_content_paste_with_format"],table_insert:["insert_row_up","insert_row_down","insert_column_left","insert_column_right"],table_select:["table_select_cell","table_select_all","","table_select_row","table_select_column"],align_vertical:["valign_up","valign_center","valign_baseline","valign_bottom"],cell_size:["table_same_width","table_same_height","table_same_widthheight"],table_row_column:"table_row_clone  insert_row_column insert_row_up insert_row_down insert_column_left insert_column_right  insert_table_top_paragraph insert_table_bottom_paragraph".split(" "),
delete_table_and_row_column:["table_delete","delete_row","delete_column"],delete_row_column:["delete_row","delete_column"],table_row_column_cell_property:["table_property","cell_property","row_property","column_property"],table_row_column_cell_property2:["table_property","cell_property"],table_row_column_cell_property3:["cell_property"],table_tool:["table_adjust","convert_table_to_text"],calculation_formula:"horizontal_sum horizontal_avg horizontal_mul horizontal_sub horizontal_div  vertical_sum vertical_avg vertical_mul vertical_sub vertical_div".split(" "),
table_sticky:["sticky_table","sticky_top_row","sticky_first_column"]},_non_image_item:" cell_size insert_row insert_column align_vertical table_insert select_column select_row select_cell table_tool paste_to_image paste_to_image_detail calculation_formula table_copy_paste table_copy_paste2 table_row_column delete_table_and_row_column delete_row_column table_row_column_cell_property table_row_column_cell_property2 table_row_column_cell_property3".split(" "),_create:function(a){a&&""!=a&&(a=DEXTTOP.DEXT5.util._setDEXT5editor(a))&&
(DEXTTOP.G_CURREDITOR=a);getDialogWindow();var b=getDialogDocument();(a=b.getElementById("dext_context_iframe"))&&a.parentNode.removeChild(a);this._context_id="dext_context_iframe";this._context_bg_id="dext_context_background";this._context_zIndex=G_MAIN_ZINDEX+2E3;this._context_bg_zIndex=G_MAIN_ZINDEX+1E3;if(a=b.getElementById(this._context_id))_context_document=a.contentWindow.document,this._context_iframe=a,this._context_document=_context_document,this._context_main=_context_document.getElementById("ul_context_main"),
this._context_sub=_context_document.getElementById("ul_context_sub");else{try{a=b.createElement("iframe")}catch(c){a=b.createElement("<iframe>")}b.body.appendChild(a);a.id=this._context_id;a.title="DEXT5Editor Context";a.style.margin="0px";a.style.padding="0px";a.style.zIndex=this._context_zIndex;a.style.position="absolute";a.scrolling="no";a.style.overflow="auto";a.style.overflowX="hidden";a.style.display="none";a.allowTransparency="true";a.frameBorder="0";b="document.open();"+(isCustomDomain(document)?
'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";a.src=b;var b="",b=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,d="editor_context.css";"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(d="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var e=DEXTTOP.G_CURREDITOR._config.lang;-1<e.indexOf("-")&&
(e=e.split("-")[0]);var f="";isRTL(document)&&(f=' dir="rtl"');e=""+('<html lang="'+e+'" xml:lang="'+e+'"'+f+"><head>")+"<title>DEXT5Editor Context</title>";e+='<link rel="stylesheet" type="text/css" href="'+b+d+"?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">';"1"==DEXTTOP.G_CURREDITOR._config.customCssUrlDetailApply&&(e+='<link rel="stylesheet" type="text/css" href="'+DEXTTOP.G_CURREDITOR._config.style.customCssUrl+"?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">');e+='<link rel="stylesheet" type="text/css" href="'+
b+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">';isRTL(document)&&(e+='<link rel="stylesheet" type="text/css" href="'+b+"editor_context_rtl.css?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">');e+="</head>";e+='<body scroll="no" style="overflow-x:hidden; overflow-y:hidden; margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">';e+='<div onselectstart="return false;" style="width:100%; height:100%" id="context_iframe_bg">';
e+='<div class="DEXT_fiVe_ED_popup">';e+='<div id="div_main_context" class="DEXT_fiVe_EDP">';e+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'" id="div_main_context_skin1">';e+='<dl id="ul_context_main"></dl>';e+="</div>";e+="</div>";e+='<div class="DEXT_fiVe_EDP_s" id="div_sub_context" style="display:none; position:relative;">';e+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'" id="div_main_context_skin2">';e+='<dl id="ul_context_sub"></dl>';
e+="</div>";e+="</div>";e+="</div>";e+="</div>";e+='<iframe style="HEIGHT: 100%; WIDTH: 100%; POSITION: absolute; LEFT: 0px; FILTER: alpha(opacity = 0); Z-INDEX: -1; DISPLAY: block; TOP: 0px" frameBorder="0" scrolling="no" tabkey="-1" title="DEXT5Editor Context Iframe"></iframe>';e+="</body></html>";_context_document=a.contentWindow.document;_context_document.open("text/html","replace");isCustomDomain(document)&&(_context_document.domain=document.domain);_context_document.write(e);_context_document.close();
this._context_iframe=a;this._context_document=_context_document;this._context_main=_context_document.getElementById("ul_context_main");this._context_sub=_context_document.getElementById("ul_context_sub");var g=this;a=function(){return function(a){g.hide()}}();DEXTTOP.DEXT5.util.addEvent(this._context_document.getElementById("context_iframe_bg"),"click",a);DEXTTOP.DEXT5.util.addEvent(this._context_document.getElementById("context_iframe_bg"),"contextmenu",a);DEXTTOP.DEXT5.util.addEvent(_context_document,
"dragover",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1});DEXTTOP.DEXT5.util.addEvent(_context_document,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1})}this._context_main.innerHTML="";this._context_sub.innerHTML=""},_setMenu:function(a,b){var c=a.tagName.toLowerCase(),d="default",e=getFirstRange(),f=e.range;if("a"==c||"video"==c){var g=getFirstRange().sel;g.removeAllRanges();f.selectNode(a);g.addRange(f)}var h=!0;try{DEXTTOP.DEXTWIN!=top&&(h=!1)}catch(m){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}h&&setFocusTopWindow();var h=!1,g=DEXTTOP.G_CURREDITOR._config.tableNoActionClass,q=GetTableSelectionCells();if(0<q.length){""!=g&&(h=GetParentbyTagName(q[0],"table"),h=checkContainClass(h,g));if(1==q.length)d="selectedSingleCell";else for(var d="selectedMultiCell",t=!1,g=0;g<q.length-1;g++)q[g].tagName!=q[g+1].tagName&&(t=!0);DEXTTOP.DEXT5.browser.ie&&(e.sel.removeAllRanges(),setTimeout(function(){doSetCaretPosition(getMyFirstOrLastChildElementNode(q[q.length-1]),0)},1))}else{var u=
f?f.toString():"";"video"==c&&(u="");if(0<u.length&&"select"!=c&&"textarea"!=c)"table"==c?(""!=g&&(h=checkContainClass(a,g)),d="focustable",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a)):"a"==c?(d=a.getAttribute("DEXT5InsertFile"),d=""==a.href&&a.name==a.id?"focusbookmark":""==d?"focusinsertfile":"focusa",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a)):(g=e.sel)&&g.docSelection&&"Control"==g.docSelection.type?d="selectTable":(d="selectArea",setSelectoinElement(null));else if("img"==c)c=
a.getAttribute("dext5customdata"),null!=c&&void 0!=c?(c=getDextCustomData(c),"iframe"==c.type?(d="focusiframe",DEXTTOP.G_SELECTED_ELEMENT=a):"flash"==c.type?(d="focusflash",DEXTTOP.G_SELECTED_ELEMENT=a):"media"==c.type?(d="focusmedia",DEXTTOP.G_SELECTED_ELEMENT=a):"link_media"==c.type?(d="focuslinkmedia",DEXTTOP.G_SELECTED_ELEMENT=a):"hidden"==c.type?(d="input_hidden",DEXTTOP.G_SELECTED_ELEMENT=a):"video_media"==c.type&&(d="focusVideo",DEXTTOP.G_SELECTED_ELEMENT=a)):(G_DEPlugin[a.getAttribute("raon_plugin")]?
d="focusPluginImage":a.getAttribute("raon_chart")&&G_DEPlugin.chart?(d="focusPluginImage",a.setAttribute("raon_plugin","chart")):d="focusImage",DEXTTOP.G_SELECTED_ELEMENT=a,DEXTTOP.G_SELECTED_IMAGE_ELEMENT=a),setSelectoinElement(a);else if("a"==c)d=a.getAttribute("DEXT5InsertFile"),d=""==a.href&&a.name==a.id?"focusbookmark":""==d?"focusinsertfile":"focusa",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a);else if("table"==c)""!=g&&(h=checkContainClass(a,g)),d="focustable",DEXTTOP.G_SELECTED_ELEMENT=
a,setSelectoinElement(a);else if("embed"==c)d="focusEmbed",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a);else if("td"==c||"th"==c)""!=g&&(h=GetParentbyTagName(a,"table"),h=checkContainClass(h,g)),d=null!=DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag?"selectResizeTable":"focustd";else if("input"==c)""==a.type||"text"==a.type||"password"==a.type?d="input_textfield":"radio"==a.type?d="input_radio":"checkbox"==a.type?d="input_checkbox":"button"==
a.type||"reset"==a.type||"submit"==a.type?d="input_button":"hidden"==a.type?d="input_hidden":"image"==a.type&&(d="input_image"),setSelectoinElement(a),DEXTTOP.G_SELECTED_ELEMENT=a;else if("select"==c)d="input_select",setSelectoinElement(a),DEXTTOP.G_SELECTED_ELEMENT=a;else if("textarea"==c)d="input_textarea",setSelectoinElement(a),DEXTTOP.G_SELECTED_ELEMENT=a;else if("video"==c)d="focusVideo",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a);else if("span"==c)"raon_placeholder"==a.className&&(d=
"placeholder",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a)),"LI"!=a.parentNode.tagName||"OL"!=a.parentNode.parentNode.tagName&&"UL"!=a.parentNode.parentNode.tagName||(d="setNumbering",a=a.parentNode,"UL"==a.parentNode.tagName&&(d="setListPosition"),_dext_editor.orderedListObj.selectedNode=a,_dext_editor.orderedListObj.currNum=_dext_editor.orderedListObj.fnGetCurrIdx(a)+a.parentNode.start,_dext_editor.orderedListObj.changeVal=_dext_editor.orderedListObj.currNum,_dext_editor.orderedListObj.marker=
_dext_editor.orderedListObj.fnGetListStyleType(a),_dext_editor.orderedListObj.changeListPos=_dext_editor.orderedListObj.fnGetListStyleMargin(a.parentElement),_dext_editor.orderedListObj.changeListUnit=_dext_editor.orderedListObj.fnGetListUnit(a.parentElement),_dext_editor.orderedListObj.changeTextPos=_dext_editor.orderedListObj.fnGetListStyleMargin(a),_dext_editor.orderedListObj.changeTextUnit=_dext_editor.orderedListObj.fnGetListUnit(a),dext5_lang.context.set_numbering_from_first=_dext_editor.orderedListObj.defaultMessage);
else if("li"!=c||"OL"!=a.parentNode.tagName&&"UL"!=a.parentNode.tagName||"none"==a.parentNode.style.listStyleType)if("b"==c||"i"==c){if("LI"==a.parentNode.tagName||"LI"==a.parentNode.parentNode.tagName||"LI"==a.parentNode.parentNode.parentNode.tagName)d="setNumbering",a=getParentbyTagNameEx(a,"li"),"UL"==a.parentNode.tagName&&(d="setListPosition"),_dext_editor.orderedListObj.selectedNode=a,_dext_editor.orderedListObj.currNum=_dext_editor.orderedListObj.fnGetCurrIdx(a)+a.parentNode.start,_dext_editor.orderedListObj.changeVal=
_dext_editor.orderedListObj.currNum,_dext_editor.orderedListObj.marker=_dext_editor.orderedListObj.fnGetListStyleType(a),_dext_editor.orderedListObj.changeListPos=_dext_editor.orderedListObj.fnGetListStyleMargin(a.parentElement),_dext_editor.orderedListObj.changeListUnit=_dext_editor.orderedListObj.fnGetListUnit(a.parentElement),_dext_editor.orderedListObj.changeTextPos=_dext_editor.orderedListObj.fnGetListStyleMargin(a),_dext_editor.orderedListObj.changeTextUnit=_dext_editor.orderedListObj.fnGetListUnit(a),
dext5_lang.context.set_numbering_from_first=_dext_editor.orderedListObj.defaultMessage}else"div"==c?-1<a.className.indexOf("dext5-imgslider")&&(d="focusPluginImage"):"button"==c?-1<a.className.indexOf("dext5-imgslider")&&(d="focusPluginImage"):(d="default",g=getFirstRange().sel,g.removeAllRanges(),g.addRange(f));else d="setNumbering","UL"==a.parentNode.tagName&&(d="setListPosition"),_dext_editor.orderedListObj.selectedNode=a,_dext_editor.orderedListObj.currNum=_dext_editor.orderedListObj.fnGetCurrIdx(a)+
a.parentNode.start,_dext_editor.orderedListObj.changeVal=_dext_editor.orderedListObj.currNum,_dext_editor.orderedListObj.marker=_dext_editor.orderedListObj.fnGetListStyleType(a),_dext_editor.orderedListObj.changeListPos=_dext_editor.orderedListObj.fnGetListStyleMargin(a.parentElement),_dext_editor.orderedListObj.changeListUnit=_dext_editor.orderedListObj.fnGetListUnit(a.parentElement),_dext_editor.orderedListObj.changeTextPos=_dext_editor.orderedListObj.fnGetListStyleMargin(a),_dext_editor.orderedListObj.changeTextUnit=
_dext_editor.orderedListObj.fnGetListUnit(a),dext5_lang.context.set_numbering_from_first=_dext_editor.orderedListObj.defaultMessage}isViewMode(DEXTTOP.G_CURREDITOR)&&(d="viewModeContextMenu");c=[];this._item_disabled_list=[];try{for(var v in G_DEPlugin)if("function"===typeof G_DEPlugin[v].onBeforeSetRightMenuCmd){var w=G_DEPlugin[v].onBeforeSetRightMenuCmd({cmd:d,currElem:a});"string"===typeof w&&(d=w)}}catch(y){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}switch(d){case "default":c="paste cut copy text_copy  table_paste  paragraph_attribute  select_all  hyperlink_create".split(" ");
(DEXTTOP.DEXT5.browser.ie||canAccessClipboardEnv())&&c.splice(1,0,"text_paste");DEXTTOP.G_CURREDITOR.isUseApplyFormat&&c.splice(6,0,"format_painter");b?"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&c.splice(1,0,"paste_to_image","paste_to_image_detail"):checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&c.splice(1,0,"paste_to_image","paste_to_image_detail");this._item_disabled_list=["cut","copy","text_copy"];null==DEXTTOP.G_COPIEDCELLDATA&&this._item_disabled_list.push("table_paste");
this._height="150px";this._width="200px";break;case "selectArea":c="paste cut copy text_copy  paragraph_attribute  select_all".split(" ");if((v=GetParentbyTagName(a,"div"))&&v.className&&"DEXT_fiVe_Page_Break"==v.className)c=[],c.push("delete_pagebreak");else{(DEXTTOP.DEXT5.browser.ie||canAccessClipboardEnv())&&c.splice(1,0,"text_paste");DEXTTOP.G_CURREDITOR.isUseApplyFormat&&c.splice(4,0,"apply_format");v=!0;t=!1;if(DEXTTOP.DEXT5.browser.ie)try{var x=getNodesInRange(f);if(9==x[0].nodeType){if(f.startContainer==
f.endContainer&&3==f.startContainer.nodeType&&3==f.endContainer.nodeType){var z=GetParentbyTagName(f.startContainer,"a"),B=GetParentbyTagName(f.startContainer,"a");null==z&&null==B&&(t=!0)}}else if(1==x[0].nodeType&&f.startContainer!=f.endContainer&&3==f.startContainer.nodeType&&3==f.endContainer.nodeType){x=!1;if("A"==f.startContainer.parentNode.tagName){var x=!0,D=f.startContainer.parentNode.nextSibling;3==D.nodeType?f.setStart(D,0):1==D.nodeType?f.setStartAfter(D):f.setStartAfter(f.startContainer)}else"A"==
f.endContainer.parentNode.tagName&&(x=!0,D=f.endContainer.parentNode.previousSibling,3==D.nodeType?f.setEnd(D,D.length):1==D.nodeType?f.setEndBefore(D):f.setEndBefore(f.endContainer));x&&(e.sel.removeAllRanges(),e.sel.addRange(f),f=getFirstRange().range,DEXTTOP.G_CURREDITOR._LastRange=f,DEXTTOP.G_SELECTED_ELEMENT&&"A"==DEXTTOP.G_SELECTED_ELEMENT.tagName&&(DEXTTOP.G_SELECTED_ELEMENT=null))}}catch(A){t=!1}if(t)v=!0;else for(x=getNodesInRange(f),e=x.length,g=0;e>g;g++)if(x[g].tagName&&"a"==x[g].tagName.toLowerCase()){v=
!1;break}v&&(c.push(""),c.push("hyperlink_create"));b?"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&c.splice(1,0,"paste_to_image","paste_to_image_detail"):checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&c.splice(1,0,"paste_to_image","paste_to_image_detail");this._item_disabled_list=[];DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&this._item_disabled_list.push("apply_format")}this._height="130px";this._width="200px";break;case "selectTable":c=
"paste cut copy text_copy  select_all  table_indent table_outdent  table_adjust  table_property".split(" ");(DEXTTOP.DEXT5.browser.ie||canAccessClipboardEnv())&&c.splice(1,0,"text_paste");b?"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&c.splice(1,0,"paste_to_image","paste_to_image_detail"):checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&c.splice(1,0,"paste_to_image","paste_to_image_detail");this._item_disabled_list=[];this._height="130px";this._width="200px";break;case "selectedSingleCell":c=
"paste cut copy text_copy  paragraph_attribute  select_all  split_cell  table_tool table_copy_paste delete_row_column table_row_column_cell_property3 table_sticky  align_vertical".split(" ");DEXTTOP.G_CURREDITOR.isUseApplyFormat&&c.splice(11,0,"apply_format");DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion&&c.splice(c.indexOf("table_sticky"),1);this._item_disabled_list=["cut","copy","paste","text_copy"];null==DEXTTOP.G_COPIEDCELLDATA&&(this._item_disabled_list.push("table_content_paste"),
this._item_disabled_list.push("table_content_paste_to_text"),this._item_disabled_list.push("table_content_paste_with_format"),this._item_disabled_list.push("intable_paste"));DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&this._item_disabled_list.push("apply_format");e=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");"all"==e.getAttribute("sticky")&&(this._item_disabled_list.push("sticky_top_row"),this._item_disabled_list.push("sticky_first_column"));this._height=
"300px";this._width="400px";break;case "selectedMultiCell":c="paste cut copy text_copy  paragraph_attribute  select_all  merge_cell split_cell  table_tool table_copy_paste2 delete_row_column table_row_column_cell_property2 table_sticky cell_size  align_vertical".split(" ");DEXTTOP.G_CURREDITOR.isUseApplyFormat&&c.splice(7,0,"apply_format");DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion&&c.splice(c.indexOf("table_sticky"),1);this._item_disabled_list="cut copy paste table_content_paste table_content_paste_to_text table_content_paste_with_format text_copy".split(" ");
t&&this._item_disabled_list.push("merge_cell");DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&this._item_disabled_list.push("apply_format");e=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");"all"==e.getAttribute("sticky")&&(this._item_disabled_list.push("sticky_top_row"),this._item_disabled_list.push("sticky_first_column"));this._width=this._height="500px";break;case "focusImage":c=DEXTTOP.G_SELECTED_ELEMENT&&DEXTTOP.G_SELECTED_ELEMENT.parentNode&&"A"==
DEXTTOP.G_SELECTED_ELEMENT.parentNode.tagName?"paste cut copy text_copy  select_all  hyperlink_open hyperlink_property remove_hyperlink  save_as_image ".split(" "):"paste cut copy text_copy  select_all  hyperlink_create  save_as_image ".split(" ");DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile||c.push("image_property");"1"==DEXTTOP.G_CURREDITOR._config.useMiniImageEditor&&c.push("mini_photo_editor");"ieplugin"!=DEXTTOP.G_CURREDITOR._config.runtimes&&DEXTTOP.DEXTWIN.DEXT5PHOTO&&"IMG"==DEXTTOP.G_SELECTED_ELEMENT.tagName&&
(e=DEXTTOP.G_SELECTED_ELEMENT.src,0>e.indexOf("file://")&&(4<e.length&&"http"==e.substring(0,4).toLowerCase()?e.match(/:\/\/(.[^\/]+)/)[1]==DEXTTOP.window.location.href.match(/:\/\/(.[^\/]+)/)[1]&&c.push("photo_editor_property"):c.push("photo_editor_property")));this._item_disabled_list=["paste"];this._height="300px";this._width="200px";break;case "focusa":c="paste cut copy text_copy  select_all  hyperlink_open hyperlink_property remove_hyperlink".split(" ");this._item_disabled_list=["paste","cut",
"copy","text_copy"];this._height="300px";this._width="200px";break;case "focusbookmark":c="paste cut copy text_copy  select_all  bookmark".split(" ");this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="300px";this._width="200px";break;case "focustable":c="paste cut copy text_copy  select_all  table_adjust  table_property".split(" ");this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="300px";this._width="200px";break;case "focusembed":c="paste cut copy text_copy  select_all  flash_property".split(" ");
this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="300px";this._width="200px";break;case "focusVideo":c="paste cut copy text_copy  select_all  video_property".split(" ");this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="300px";this._width="200px";break;case "focustd":c="table_selection  table_indent table_outdent  cut copy text_copy paste  paragraph_attribute  split_cell  table_tool table_copy_paste3 table_row_column delete_table_and_row_column table_row_column_cell_property table_sticky  table_select align_vertical  calculation_formula".split(" ");
(DEXTTOP.DEXT5.browser.ie||canAccessClipboardEnv())&&c.splice(8,0,"text_paste");DEXTTOP.G_CURREDITOR.isUseApplyFormat&&c.splice(8,0,"format_painter");b?"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&c.splice(1,0,"paste_to_image","paste_to_image_detail"):checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&c.splice(1,0,"paste_to_image","paste_to_image_detail");DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion&&c.splice(c.indexOf("table_sticky"),1);this._item_disabled_list=
["cut","copy","table_copy","text_copy"];null==DEXTTOP.G_COPIEDCELLDATA&&(this._item_disabled_list.push("table_content_paste"),this._item_disabled_list.push("table_content_paste_to_text"),this._item_disabled_list.push("table_content_paste_with_format"),this._item_disabled_list.push("intable_paste"));e=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");"all"==e.getAttribute("sticky")&&(this._item_disabled_list.push("sticky_top_row"),this._item_disabled_list.push("sticky_first_column"));this._width=
"350px";this._height="500px";break;case "focusiframe":c="paste cut copy text_copy  select_all  iframe_property".split(" ");this._item_disabled_list=["paste"];this._height="300px";this._width="200px";break;case "focusflash":c="paste cut copy text_copy  select_all  flash_property".split(" ");this._item_disabled_list=["paste"];this._height="300px";this._width="200px";break;case "focusmedia":c="paste cut copy text_copy  select_all  media_property".split(" ");this._item_disabled_list=["paste"];this._height=
"300px";this._width="200px";break;case "focuslinkmedia":c="paste cut copy text_copy  select_all ".split(" ");this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="130px";this._width="200px";break;case "placeholder":c=["paste","cut","copy","text_copy"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(c.push(""),c.push("placeholder"));this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="130px";this._width="200px";break;case "input_textfield":c="paste cut copy text_copy  select_all".split(" ");
"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(c.push(""),c.push("input_textfield"));this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="130px";this._width="200px";break;case "input_radio":c="paste cut copy text_copy  select_all".split(" ");"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(c.push(""),c.push("input_radio"));this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="130px";this._width="200px";break;case "input_checkbox":c="paste cut copy text_copy  select_all".split(" ");
"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(c.push(""),c.push("input_checkbox"));this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="130px";this._width="200px";break;case "input_button":c="paste cut copy text_copy  select_all".split(" ");"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(c.push(""),c.push("input_button"));this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="130px";this._width="200px";break;case "input_select":c="paste cut copy text_copy  select_all".split(" ");
"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(c.push(""),c.push("input_select_property"));this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="130px";this._width="200px";break;case "input_textarea":c="paste cut copy text_copy  select_all".split(" ");"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(c.push(""),c.push("input_textarea_property"));this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="130px";this._width="200px";break;case "input_image":c="paste cut copy text_copy  select_all".split(" ");
"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(c.push(""),c.push("input_imagebutton"));this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="130px";this._width="200px";break;case "input_hidden":c="paste cut copy text_copy  select_all".split(" ");"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(c.push(""),c.push("input_hiddenfield"));this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="130px";this._width="200px";break;case "focusinsertfile":c="paste cut copy text_copy  select_all  insert_file_property filelink_open".split(" ");
this._item_disabled_list=["paste","cut","copy","text_copy"];this._height="300px";this._width="200px";break;case "selectResizeTable":c="table_indent table_outdent  table_adjust  table_property".split(" ");this._item_disabled_list=[];this._height="130px";this._width="200px";break;case "viewModeContextMenu":e=DEXTTOP.G_CURREDITOR._config.viewModeAllowShortcut;f=e.length;for(g=0;g<f;g++)0<g&&c.push(""),c.push(e[g]);break;case "setNumbering":case "setListPosition":c="paste cut copy  table_paste  paragraph_attribute  select_all  hyperlink_create".split(" ");
_dext_editor.isUseApplyFormat&&c.splice(6,0,"format_painter");b?"1"!=_dext_editor._config.pasteToImage&&c.splice(1,0,"paste_to_image"):1==_dext_editor.canPasteToImage&&"1"!=_dext_editor._config.pasteToImage&&c.splice(1,0,"paste_to_image");e=0==_dext_editor.orderedListObj.fnGetCurrIdx(a)?!0:!1;for(g=0;g<c.length;g++)if(""==c[g]){"setNumbering"==d?(c.splice(g+1,0,"set_list_adjustment"),c.splice(g+2,0,"continue_numbering"),c.splice(g+3,0,"set_numbering_value"),c.splice(g+4,0,""),e||(e=convertNumberToOther(a.parentNode.start,
_dext_editor.orderedListObj.marker),c.splice(g+2,0,"set_numbering_from_first"),dext5_lang.context.set_numbering_from_first=dext5_lang.context.set_numbering_from_first.replace("{0}",e))):"setListPosition"==d&&(c.splice(g+1,0,"set_list_adjustment"),c.splice(g+2,0,""));break}this._item_disabled_list=["cut","copy"];null==DEXTTOP.G_COPIEDCELLDATA&&this._item_disabled_list.push("table_paste");this._height="150px";this._width="200px";break;default:this._height=this._width="1px"}0===d.indexOf("p_")&&(v=d.split("|")[0],
v=v.replace("p_",""),G_DEPlugin[v]&&"function"===typeof G_DEPlugin[v].onSetContextMenuItem&&(e={cmd:d,items:c,disabledItems:this._item_disabled_list,width:this._width,height:this._height,currElem:a},e=G_DEPlugin[v].onSetContextMenuItem(e),"object"===typeof e&&(c=e.items,this._item_disabled_list=e.disabledItems,this._width=e.width,this._height=e.height)));"focusPluginImage"==d&&(v=a.getAttribute("raon_plugin"),G_DEPlugin[v]&&G_DEPlugin[v].onCreateContextMenu&&(e={items:c,disabledItems:this._item_disabled_list,
width:this._width,height:this._height,currElem:a},G_DEPlugin[v].onCreateContextMenu(e),c=e.items,this._item_disabled_list=e.disabledItems,this._width=e.width,this._height=e.height));"focustd"!=d&&"selectResizeTable"!=d||0!=isRTL()||(d=GetParentbyTagName(a,"table"),0>=parseIntOr0(d.style.marginLeft)&&this._item_disabled_list.push("table_outdent"));h&&(this._item_disabled_list=addDisalbeItemForNoActionTable(this._item_disabled_list));this._height="0px";h=this._context_document.createElement("dt");h.innerHTML=
"context_main_menu";this._context_main.appendChild(h);h=c.length;for(g=0;g<h;g++)this._addItem(c[g]);h=this._context_main.getElementsByTagName("dd");d=h.length;for(--d;0<=d;d--)0==d?"b_border"==h[d].className&&this._context_main.removeChild(h[d]):"b_border"==h[d].className&&"b_border"==h[d-1].className&&this._context_main.removeChild(h[d]);h=this._context_main.getElementsByTagName("dd");d=h.length;1<d&&"b_border"==h[d-1].className&&this._context_main.removeChild(h[d-1]);h=parseInt(this._height,10)+
2;1!=getDEXTWINZoomValue(DEXTTOP.G_CURREDITOR)&&(h+=1);this._height=h+"px";this._disableItem(this._item_disabled_list)},_disableItem:function(a){for(var b=a.length,c=0;c<b;c++){var d=this._context_document.getElementById("context_"+a[c]);d&&(d.className="item_disabled")}},_addItem:function(a){for(var b=DEXTTOP.G_CURREDITOR.remove_item.concat(DEXTTOP.G_CURREDITOR.remove_context_item),c=b.length,d=0;d<c;d++)if(b[d]==a)return;var b=this._context_document.createElement("dd"),e=this,c=this._getImageUrl(a),
d=this._getText(a),f=this._item_sub_list[a];if(""==d)b.className="b_border",this._height=parseInt(this._height,10)+1+"px";else{this._height=parseInt(this._height,10)+24+"px";var g=this._context_document.createElement("div"),h=this._context_document.createElement("div"),m=this._context_document.createElement("div"),q=this._context_document.createElement("span");0<c.length&&(q.className=a,g.appendChild(q),0==a.indexOf("p_")&&(q.style.background="url("+c+") transparent no-repeat"));"textContent"in h?
h.textContent=d:h.innerText=d;g.className="s_left";h.className="s_right ellipsis";b.appendChild(g);b.appendChild(h);f?(m.className="arrow",b.appendChild(m),c=function(a){return function(b){if("item_disabled"!=a.className){e._context_sub.innerHTML="";for(var c=f.length,d=0;d<c;d++){if(0==d){var g=e._context_document.createElement("dt");g.innerHTML="context_sub_menu";e._context_sub.appendChild(g)}e._addSubItem(f[d])}e._disableItem(e._item_disabled_list);c=b.target?b.target:b.srcElement;d=getClientRect(c);
0==d.top&&(d=getClientRect(c));e._context_document.getElementById("div_sub_context").style.display="";var g=getClientRect(e._context_document.getElementById("div_sub_context")),g=g.bottom-g.top,h=getClientRect(e._context_document.getElementById("div_main_context")),m=d.top;d.top+g>h.bottom&&(m=d.top-(d.top+g-h.bottom));e._context_document.getElementById("div_sub_context").style.top=m+"px";1==e._reverse?(c=getClientRect(c.parentElement),d=getClientRect(e._context_document.getElementById("div_sub_context")),
e._context_document.getElementById("div_sub_context").style.left=c.left-(d.right-d.left)+2+"px"):e._context_document.getElementById("div_sub_context").style.left="0px";c=getClientRect(e._context_document.getElementById("div_sub_context"));getClientRect(e._context_document.getElementById("div_main_context"));d=getClientRect(e._context_iframe);d=d.bottom-d.top;c.bottom>d&&(c=c.bottom-d,c=parseIntOr0(e._context_iframe.style.height)+c+2,e._context_iframe.style.height=c+"px");a.className="on_mouseover";
DEXTTOP.DEXT5.util.stopEvent(b)}}}(b),d=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),g=function(a){return function(a){DEXTTOP.DEXT5.util.stopEvent(a)}}(b)):(c=function(a){return function(b){e._context_document.getElementById("div_sub_context").style.display="none";"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),d=function(a){return function(b){"on_mouseover"==a.className&&(a.className=
"",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),e=this,g=function(b){return function(c){"on_mouseover"==b.className&&(DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,a,e),e.hide());null!=DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag&&"table_property"!=a&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag=!1,DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,!0))}}(b));DEXTTOP.DEXT5.util.addEvent(b,"mouseover",c);
DEXTTOP.DEXT5.util.addEvent(b,"mouseout",d);DEXTTOP.DEXT5.util.addEvent(b,"click",g)}0<a.length&&(b.id="context_"+a);b.unselectable="on";this._context_main.appendChild(b);b=this._context_main.getElementsByTagName("dd");for(c=b.length-1;0<=c;c--)0==c?"b_border"==b[c].className&&this._context_main.removeChild(b[c]):"b_border"==b[c].className&&"b_border"==b[c-1].className&&this._context_main.removeChild(b[c])},_addSubItem:function(a){for(var b=DEXTTOP.G_CURREDITOR.remove_item.concat(DEXTTOP.G_CURREDITOR.remove_context_item),
c=b.length,d=0;d<c;d++)if(b[d]==a)return;var b=this._context_document.createElement("dd"),e=this,c=this._getImageUrl(a),d=this._getText(a);if(""==d)b.className="b_border";else{var f=this._context_document.createElement("div"),g=this._context_document.createElement("div"),h=this._context_document.createElement("span");0<c.length&&(h.className=a,f.appendChild(h),0==a.indexOf("p_")&&(h.style.background="url("+c+") transparent no-repeat"));"textContent"in g?g.textContent=d:g.innerText=d;f.className="s_left";
g.className="s_right ellipsis";b.appendChild(f);b.appendChild(g);c=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(b);d=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(b);e=this;f=function(b){return function(c){"on_mouseover"==b.className&&(DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,a),e.hide());null!=DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag&&
(DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag=!1,DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,!0))}}(b);DEXTTOP.DEXT5.util.addEvent(b,"mouseover",c);DEXTTOP.DEXT5.util.addEvent(b,"mouseout",d);DEXTTOP.DEXT5.util.addEvent(b,"click",f);0<a.length&&(b.id="context_"+a);b.unselectable="on"}this._context_sub.appendChild(b)},_getImageUrl:function(a){var b="";if(0==a.indexOf("p_")){var b=a.split("_"),c=b[1],d="icon";2<b.length&&(d=b[2]);b=DEXTTOP.G_CURREDITOR._config.webPath.plugin+
c+"/images/"+d+".png"}else b=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif";c=this._non_image_item.length;for(d=0;d<c;d++)if(a==this._non_image_item[d]){b="";break}return b},_getText:function(a){var b="";""!=a&&(0==a.indexOf("p_")?(b=a.split("_")[1],b=dext5_lang.plugins[b].context[a]):b=dext5_lang.context[a]);return b},show:function(a,b){var c=getDialogWindow(),d=getDialogDocument();if(null==this._context_iframe)this._create();else{var d=d.getElementById(this._context_id),
e=d.contentWindow.document;this._context_iframe=d;this._context_document=e;this._context_main=e.getElementById("ul_context_main");this._context_sub=e.getElementById("ul_context_sub")}d=this._context_document.getElementById("div_main_context_skin1");e=this._context_document.getElementById("div_main_context_skin2");d.className="Dfe_popup DEXT_fiVe_"+DEXTTOP.G_CURREDITOR._config.style.skinName;e.className="Dfe_popup DEXT_fiVe_"+DEXTTOP.G_CURREDITOR._config.style.skinName;d=this._context_document.getElementsByTagName("link");
for(e=0;e<d.length;e++){var f=d[e].href;if(-1<f.lastIndexOf("editor_icon")){"icon_mono"==DEXTTOP.G_CURREDITOR._config.style.iconName?-1==f.lastIndexOf("editor_icon_mono")&&(f=f.replace("editor_icon.css","editor_icon_mono.css")):-1<f.lastIndexOf("editor_icon_mono")&&(f=f.replace("editor_icon_mono.css","editor_icon.css"));d[e].href=f;break}}this._context_main.innerHTML="";this._context_sub.innerHTML="";d=a.target?a.target:a.srcElement;null!=DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag&&
(d=DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem.getElementsByTagName("td")[0]);if(null!=d){try{var g=_dext_editor._FRAMEWIN.G_DEPlugin,h;for(h in g)if("function"===typeof g[h].onBeforeShowContextMenu&&!1===g[h].onBeforeShowContextMenu({_this:this,event:a,dialogWin:c,_iframeWin:_iframeWin,currElem:d,runFlag:!0}).runFlag)return}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}dext_src_init(DEXTTOP.G_CURREDITOR._EDITOR.design);restoreSelection();setFocusToBody();g=d.tagName.toLowerCase();
"img"!=g&&"hr"!=g&&"a"!=g&&"input"!=g&&"textarea"!=g&&"select"!=g&&(h=GetParentbyTagName(d,"a"))&&(d=h,g=d.tagName.toLowerCase());h=null;if("img"!=g&&"hr"!=g&&"a"!=g&&"input"!=g&&"textarea"!=g&&"select"!=g){if("table"!=g||"td"!=g||"th"!=g)h=GetTDTHCell(d);h&&(DEXTTOP.G_SELECTED_ELEMENT=h)}null==h?this._setMenu(d,b):this._setMenu(h,b);this._context_iframe.style.width=this._width;this._context_iframe.style.height=this._height;var q=Math.round(a.clientX);h=Math.round(a.clientY);var g={},g=getWindowScrollPos(c),
d=getClientRect(_iframeWin.parent.frameElement),e=getClientRect(_iframeWin.frameElement),t=0,f=0;if(null!=DEXTTOP.G_CURREDITOR.dialogWindow)for(var u=_iframeWin.parent.parent;u!=c;)var v=getClientRect(u.frameElement),t=t+v.left,f=f+v.top,u=u.parent;q=changeValueForZoom(q,DEXTTOP.G_CURREDITOR);h=changeValueForZoom(h,DEXTTOP.G_CURREDITOR);isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&(this._context_iframe.style.position="fixed",g[0]=0,g[1]=0);q=q+g[0]+d.left+e.left+t;isRTL(document)&&(t=DEXTTOP.DEXT5.util.parseIntOr0(this._context_iframe.style.width),
q-=t);h=h+g[1]+d.top+e.top+f;this._context_iframe.style.left=q+"px";this._context_iframe.style.top=h+"px";this._reverse=!1;h=parseInt(this._context_iframe.style.left,10)+parseInt(this._width,10);d=parseInt(this._context_iframe.style.top,10)+parseInt(this._height,10);e=getWindowClientSize(c);c=g[0]+e[0]-20;g=g[1]+e[1]-10;isRTL(document)?(c=parseInt(this._width,10),h<c&&(e=c-h,e=parseInt(this._context_iframe.style.left,10)+e,this._context_iframe.style.left=e+"px")):h>=c?(e=h-c,e=parseInt(this._context_iframe.style.left,
10)-e,h-c<parseInt(this._width,10)/2&&(e-=parseInt(this._width,10)/2),this._context_iframe.style.left=e+"px","cssFloat"in this._context_document.getElementById("div_main_context").style?this._context_document.getElementById("div_main_context").style.cssFloat="right":this._context_document.getElementById("div_main_context").style.styleFloat="right",this._reverse=!0):"cssFloat"in this._context_document.getElementById("div_main_context").style?this._context_document.getElementById("div_main_context").style.cssFloat=
"left":this._context_document.getElementById("div_main_context").style.styleFloat="left";d>=g&&(c=d-g,c=parseInt(this._context_iframe.style.top,10)-c,this._context_iframe.style.top=c+"px");this._makeBackground();this._context_iframe.style.display="";setZoomValueToBody(this._context_document,DEXTTOP.G_CURREDITOR);"object"==typeof DEXTTOP.NEXACROHTML&&(_iframeWin.focus(),_iframeDoc.body.focus());try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.afterPopupShow?DEXTTOP.G_CURREDITOR._config.event.afterPopupShow(DEXTTOP.G_CURREDITOR.ID,
a.target,"contextmenu"):"function"==typeof DEXTTOP.dext_editor_afterpopupshow_event&&DEXTTOP.dext_editor_afterpopupshow_event(DEXTTOP.G_CURREDITOR.ID,a.target,"contextmenu")}catch(w){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}},hide:function(a){this._context_document&&this._context_document.getElementById("div_sub_context")&&(this._context_document.getElementById("div_sub_context").style.display="none");this._context_iframe&&(this._context_iframe.style.display="none");this._context_bg&&
(this._context_bg.style.display="none");!1!==a&&(a=DEXTTOP.G_CURREDITOR._LastRange?DEXTTOP.G_CURREDITOR._LastRange:getFirstRange().range,restoreSelection(a,!0))},_makeBackground:function(){var a=this,b=getDialogWindow(),c=getDialogDocument();this._context_bg=c.getElementById(a._context_bg_id);DEXTTOP.G_CURREDITOR.dialogWindow&&this._context_bg&&(this._context_bg.parentNode.removeChild(this._context_bg),this._context_bg=null);this._context_bg&&(this._context_bg.style.display="",this._context_bg.style.overflow=
"visible");if(!this._context_bg){this._context_bg=c.createElement("div");this._context_bg.id=this._context_bg_id;this._context_bg.style.overflow="visible";this._context_bg.style.position="static";this._context_bg.innerHTML='<div oncontextmenu="return false" style="filter:alpha(opacity=0); opacity:0.0; -moz-opacity:0.0;  -khtml-opacity: 0.0; background-color:#ffffff; z-index:'+this._context_bg_zIndex+'; position:absolute; left:0px; top:0px;overflow:hidden; width:1px; height:1px; "></div>';c.body.appendChild(this._context_bg);
var d=function(){return function(b){a.hide()}}();DEXTTOP.DEXT5.util.addEvent(this._context_bg,"click",d);DEXTTOP.DEXT5.util.addEvent(this._context_bg,"contextmenu",d);DEXTTOP.DEXT5.util.addEvent(b,"resize",DEXTTOP.G_CURREDITOR.context_bg_resize);b="CSS1Compat"==c.compatMode?c.documentElement.scrollWidth:c.body.scrollWidth;c="CSS1Compat"==c.compatMode?c.documentElement.scrollHeight:c.body.scrollHeight;b=changeValueForZoom(b,DEXTTOP.G_CURREDITOR);c=changeValueForZoom(c,DEXTTOP.G_CURREDITOR);this._context_bg.firstChild.style.width=
b-10+"px";this._context_bg.firstChild.style.height=c-10+"px"}}};function setDoctypeProperty(a,b,c,d){var e=_iframeDoc.getElementsByTagName("head")[0],f=getHeadScriptSrc(e,!0),e=e.outerHTML,g=_iframeDoc.body.outerHTML;setGlobalTableDefaultValue();FixFlashError2(_iframeDoc);_iframeDoc.open("text/html","replace");isCustomDomain(document)&&(_iframeDoc.domain=document.domain);_iframeDoc.write(a+"<html>"+e+g+"</html>");_iframeDoc.close();setHeadScriptSrc(_iframeDoc,f);"rtl"==_dext_editor._config.direction.write&&(a=_iframeDoc.getElementsByTagName("html")[0],a.setAttribute("dir",
"rtl"));0<c.length&&(a=_iframeDoc.getElementsByTagName("html")[0],-1<c.indexOf("-")&&(c=c.split("-")[0]),a.setAttribute("lang",c),a.setAttribute("xml:lang",c),0<d.length&&a.setAttribute("xmlns",d));""==b&&(b="utf-8");try{var h=_iframeDoc.getElementsByTagName("meta")[0];h.setAttribute("http-equiv","Content-Type");h.setAttribute("content","text/html");h.setAttribute("charset",b)}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXTTOP.G_CURREDITOR._load_editor_frame(!1)}
function createEditorIframe(a,b,c,d,e,f,g,h,m,q,t,u,v){var w=document.createElement("iframe");""!=a.editingAreaBgColor&&(w.style.backgroundColor=a.editingAreaBgColor);b.appendChild(w);w.id=c;w.title=d;w.frameBorder=0;w.style.width="100%";w.style.height="100%";w.style.borderWidth="0px";if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)w.style.overflow="hidden",w.style.display="inline-block";b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";
b=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";w.src=b;b=getIframeDocument(w);""==t?t="1.2":-1<t.indexOf("%")&&(t=1*parseIntOr0(t,10)/100);c="";""==a.document.docTitle.toString()&&(a.document.docTitle=dext5_lang.document.no_title);c=(""==e?"":e+"\n")+("<html><head><title>"+a.document.docTitle+"</title>");""!=a.imageBaseUrl&&(c+='<base href="'+a.imageBaseUrl+'" />');""!=a.ieCompatible&&(c+='<meta http-equiv="X-UA-Compatible" content="IE='+
a.ieCompatible+'" />\n');c+='<style type="text/css" '+G_DEDefaultStyleData.fullName+'="'+G_DEDefaultStyleData.value+'">';c+=createEditorDefaultStyleInnerHTML(a,m,q,t,u,v);c+="</style>";""!=a.placeholder.content&&"edit"==a.mode&&(c+='<style type=text/css id="dext_placeholder">',c=1==a.placeholder.alignCenter?c+(".dext_placeholder:before { content: '"+a.placeholder.content+"'; color: "+a.placeholder.fontColor+"; font-size: "+(""==a.placeholder.fontSize?q:a.placeholder.fontSize)+"; font-family: "+changeFontFamily(""==
a.placeholder.fontFamily?m:a.placeholder.fontFamily)+"; display: block; position: absolute; white-space: pre; left: 50%; transform: translateX(-50%); text-align: center;}"):c+(".dext_placeholder:before { content: '"+a.placeholder.content+"'; color: "+a.placeholder.fontColor+"; font-size: "+(""==a.placeholder.fontSize?q:a.placeholder.fontSize)+"; font-family: "+changeFontFamily(""==a.placeholder.fontFamily?m:a.placeholder.fontFamily)+"; display: block; position: absolute; white-space: pre;}"),c+="</style>");
e="";e=DEXTTOP.DEXT5.isRelease?a.webPath.css:a.webPath.css_dev;c+='<link href="'+e+"editor_contents.css?t="+DEXTTOP.DEXT5.UrlStamp+'" rel="stylesheet" type="text/css" />';if("1"==DEXTTOP.G_CURREDITOR._config.formMode||"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use)c+='<link href="'+e+"editor_form.css?t="+DEXTTOP.DEXT5.UrlStamp+'" rel="stylesheet" type="text/css" />';c+="</head>";e="";switch(a.scrollOverflow){case "1":e='style="overflow-x:scroll;"';break;case "2":e='style="overflow-y:scroll;"';
break;case "3":e='style="overflow-x:scroll;overflow-y:scroll;"';break;case "4":e='style="overflow-x:hidden;"';break;case "5":e='style="overflow-y:hidden;"';break;case "6":e='style="overflow-x:hidden;overflow-y:hidden;"'}""!=a.editingAreaBgColor&&DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&(e=""==e?'style="background-color:'+a.editingAreaBgColor+';"':e.substr(0,e.length-1)+a.editingAreaBgColor+'"');c="1"==a.setDefaultStyle.value||"2"==a.setDefaultStyle.value?""!=a.defaultMessage?c+
('<body id="'+a.setDefaultStyle.body_id+'" '+e+">"):c+('<body id="'+a.setDefaultStyle.body_id+'" '+e+""+(""!=a.placeholder.content&&"edit"==a.mode?"class='dext_placeholder'":"")+">"):""!=a.defaultMessage?c+("<body "+e+">"):c+("<body "+e+""+(""!=a.placeholder.content&&"edit"==a.mode?"class='dext_placeholder'":"")+">");c+="<p></p></body></html>";getDocWindow(b);b.open("text/html","replace");isCustomDomain(document)&&(b.domain=document.domain);b.write(c);b.close();"rtl"==_dext_editor._config.direction.write&&
(e=b.getElementsByTagName("html")[0],e.setAttribute("dir","rtl"));g&&0<g.length&&(e=b.getElementsByTagName("html")[0],-1<g.indexOf("-")&&(g=g.split("-")[0]),e.setAttribute("lang",g),e.setAttribute("xml:lang",g),0<h.length&&e.setAttribute("xmlns",h));""==f&&(f="utf-8");h=b.getElementsByTagName("head")[0];g=b.createElement("meta");g.setAttribute("http-equiv","Content-Type");g.setAttribute("content","text/html");g.setAttribute("charset",f);h.appendChild(g);5<a.userCssUrl.length&&createDynamicCssLinkToHeadTag(b,
h,a.userCssUrl);5<a.webFontCssUrl.length&&createDynamicCssLinkToHeadTag(b,h,a.webFontCssUrl);5<a.userJsUrl.length&&createDynamicJsLinkToHeadTag(b,h,a.userJsUrl);f=DEXTTOP.DEXT5.util.getEditorByName(a.editor_id);!DEXTTOP.DEXT5.browser.ie&&0<DEXTTOP.document.querySelectorAll('[id^="app"], [id^="vue"], [class*="vue"]').length&&!f&&a.editor_id==_dext_editor.ID&&(f=DEXTTOP.DEXT5.DEXTMULTIPLE["dext_frame_"+a.editor_id]=_dext_editor);setZoomValueToBody(b,f);return w}
function setHtmlValueWithDocTypeToEditor(a,b,c,d){b=c?c:DEXTTOP.G_CURREDITOR;"1"==b._config.enforceDoctype&&(a=a.replace(/<!doctype *([^>?+])*>/gi,""));c=getRemoveHeadScript(a);a=c.html;a=addDefaultStyleToEditor(a,b,{htmlType:"htmlexwithdoctype"});FixFlashError2(_iframeDoc);setDesignAreaHtml(a,_iframeDoc,{setWriteMode:d&&"string"==typeof d.setWriteMode?d.setWriteMode:"1"});"rtl"==_dext_editor._config.direction.write&&_iframeDoc.getElementsByTagName("html")[0].setAttribute("dir","rtl");setHeadScriptSrc(_iframeDoc,
c.scriptsAry);setScrollStyleForIOS(b);showWordCount();b._load_editor_frame(!1);"base64"!=b._config.uploadMethod&&base64imageToLocalFile(_iframeDoc);"1"==b._config.horizontalLine.use?b._BODY.style.marginTop="0px":b._BODY.style.margin="";moveStyleTagToHead(b);setZoomValueToBody(_iframeDoc,b)}
function setHtmlValueToEditor(a,b,c,d,e){var f;f=c?c:DEXTTOP.G_CURREDITOR;"1"==f._config.enforceDoctype&&(a=a.replace(/<!doctype *([^>?+])*>/gi,""));c=f._docType[f._PageProp.doctype];var g=getRemoveHeadScript(a);a=g.html;!0!==d&&(a=addDefaultStyleToEditor(a,f,{htmlType:"htmlex"}));FixFlashError2(_iframeDoc);setDesignAreaHtml(c+a,_iframeDoc,{setWriteMode:e&&"string"==typeof e.setWriteMode?e.setWriteMode:"1"});"rtl"==_dext_editor._config.direction.write&&_iframeDoc.getElementsByTagName("html")[0].setAttribute("dir",
"rtl");setHeadScriptSrc(_iframeDoc,g.scriptsAry);setScrollStyleForIOS(f);showWordCount();DEXTTOP.DEXT5.util.setBodyBackground(f);if("1"==f._config.horizontalLine.use){var h=f._FRAMEWIN;setTimeout(function(){h.showRuler(f)},0)}f._load_editor_frame(!1);"1"==f._config.horizontalLine.use?f._BODY.style.marginTop="0px":f._BODY.style.margin="";!0!==d&&"base64"!=f._config.uploadMethod&&base64imageToLocalFile(_iframeDoc);"show_blocks"==f.ShowBlocks&&(f.ShowBlocks="",command_showBlocks(a,b));moveStyleTagToHead(f);
setZoomValueToBody(_iframeDoc,f)}
function setHeadValueToEditor(a,b,c){b=b?b:DEXTTOP.G_CURREDITOR;"1"==b._config.enforceDoctype&&(a=a.replace(/<!doctype *([^>?+])*>/gi,""));var d=b._docType[b._PageProp.doctype],e=b._PageProp.lang,f=b._PageProp.xmlnsname,g=_iframeDoc.getElementsByTagName("body")[0],h;h=g.style.padding;var g=g.style.margin,m=getRemoveHeadScript(a);a=m.html;a=addDefaultStyleToEditor(a,b,{htmlType:"html"});FixFlashError2(_iframeDoc);setDesignAreaHtml(d+"<html>"+a+"</html>",_iframeDoc,{setWriteMode:c&&"string"==typeof c.setWriteMode?
c.setWriteMode:"1"});setHeadScriptSrc(_iframeDoc,m.scriptsAry);setScrollStyleForIOS(b);showWordCount();"rtl"==_dext_editor._config.direction.write&&(a=_iframeDoc.getElementsByTagName("html")[0],a.setAttribute("dir","rtl"));0<e.length&&(a=_iframeDoc.getElementsByTagName("html")[0],c=e,-1<c.indexOf("-")&&(c=c.split("-")[0]),a.setAttribute("lang",c),a.setAttribute("xml:lang",c),0<f.length&&a.setAttribute("xmlns",f));0<h.length&&(_iframeDoc.body.style.padding=h);0<g.length&&(_iframeDoc.body.style.margin=
g);b._load_editor_frame(!1);"1"==b._config.horizontalLine.use?b._BODY.style.marginTop="0px":b._BODY.style.margin="";"base64"!=b._config.uploadMethod&&base64imageToLocalFile(_iframeDoc);moveStyleTagToHead(b);setZoomValueToBody(_iframeDoc,b)}
function setBodyValueToEditorEx(a,b,c){b=b?b:DEXTTOP.G_CURREDITOR;"1"==b._config.enforceDoctype&&(a=a.replace(/<!doctype *([^>?+])*>/gi,""));var d=b._docType[b._PageProp.doctype],e=b._PageProp.lang,f=b._PageProp.xmlnsname,g=_iframeDoc.getElementsByTagName("head")[0],h=getHeadScriptSrc(g,!0),g=g.outerHTML,m=_iframeDoc.getElementsByTagName("body")[0],q;q=m.style.padding;m=m.style.margin;FixFlashError2(_iframeDoc);setDesignAreaHtml(d+"<html>"+g+a+"</html>",_iframeDoc,{setWriteMode:c&&"string"==typeof c.setWriteMode?
c.setWriteMode:"1"});setHeadScriptSrc(_iframeDoc,h);setScrollStyleForIOS(b);showWordCount();"rtl"==_dext_editor._config.direction.write&&(a=_iframeDoc.getElementsByTagName("html")[0],a.setAttribute("dir","rtl"));0<e.length&&(a=_iframeDoc.getElementsByTagName("html")[0],c=e,-1<c.indexOf("-")&&(c=c.split("-")[0]),a.setAttribute("lang",c),a.setAttribute("xml:lang",c),0<f.length&&a.setAttribute("xmlns",f));0<q.length&&(_iframeDoc.body.style.padding=q);0<m.length&&(_iframeDoc.body.style.margin=m);-1<g.indexOf("#"+
b._config.setDefaultStyle.body_id)&&(_iframeDoc.body.id=b._config.setDefaultStyle.body_id);b._load_editor_frame(!1);"base64"!=b._config.uploadMethod&&base64imageToLocalFile(_iframeDoc);moveStyleTagToHead(b);setZoomValueToBody(_iframeDoc,b)}
function setBodyValueToEditor(a,b,c){b=b?b:DEXTTOP.G_CURREDITOR;"1"==b._config.enforceDoctype&&(a=a.replace(/<!doctype *([^>?+])*>/gi,""));var d=b._docType[b._PageProp.doctype],e=b._PageProp.lang,f=b._PageProp.xmlnsname,g=_iframeDoc.getElementsByTagName("head")[0],h=getHeadScriptSrc(g,!0),m=g.outerHTML,q=_iframeDoc.getElementsByTagName("body")[0],t,u,v,w,y,g=q.style.padding;t=q.style.margin;u=q.style.backgroundImage;v=q.style.backgroundColor;w=q.style.backgroundAttachment;y=q.style.backgroundRepeat;
FixFlashError2(_iframeDoc);var q=q.outerHTML,x=q.toLowerCase().indexOf("<body"),z=q.indexOf(">"),B="",B=-1<x&&-1<z?q.substring(x,z+1):"<body>";setDesignAreaHtml(d+"<html>"+m+B+a+"</body></html>",_iframeDoc,{setWriteMode:c&&"string"==typeof c.setWriteMode?c.setWriteMode:"1"});setHeadScriptSrc(_iframeDoc,h);setScrollStyleForIOS(b);showWordCount();"rtl"==_dext_editor._config.direction.write&&(a=_iframeDoc.getElementsByTagName("html")[0],a.setAttribute("dir","rtl"));0<e.length&&(a=_iframeDoc.getElementsByTagName("html")[0],
c=e,-1<c.indexOf("-")&&(c=c.split("-")[0]),a.setAttribute("lang",c),a.setAttribute("xml:lang",c),0<f.length&&a.setAttribute("xmlns",f));0<g.length&&(_iframeDoc.body.style.padding=g);0<t.length&&(_iframeDoc.body.style.margin=t);0<u.length&&(_iframeDoc.body.style.backgroundImage=u);0<v.length&&(_iframeDoc.body.style.backgroundColor=v);0<w.length&&(_iframeDoc.body.style.backgroundAttachment=w);0<y.length&&(_iframeDoc.body.style.backgroundRepeat=y);try{b._load_editor_frame(!1)}catch(D){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}"base64"!=b._config.uploadMethod&&base64imageToLocalFile(_iframeDoc);moveStyleTagToHead(b);setZoomValueToBody(_iframeDoc,b)}
function setHtmlToPreview(a){var b="",b=void 0!=a?a:DEXTTOP.G_CURREDITOR;""!=b._config.placeholder.content&&placeholderControl(b,"remove");a=b._EDITOR.preview.contentDocument?b._EDITOR.preview.contentDocument:b._EDITOR.preview.contentWindow.document;var c=b._docType[b._PageProp.doctype],d=b._PageProp.lang,e=b._PageProp.xmlnsname,f=_iframeDoc.getElementsByTagName("head")[0],g=getHeadScriptSrc(f,!1),f=f.outerHTML,f=f.replace(/<script[^>]*src=([\s\S]*?)[\s\S]*?>[\s\S]*?<\/script>/gi,"");setMatchSelectedValue(_iframeDoc.body);
setMatchInputValue(_iframeDoc.body);var h="",m="",q="";_iframeDoc.body.style.transformOrigin&&""!=_iframeDoc.body.style.transformOrigin&&(h=_iframeDoc.body.style.transformOrigin,_iframeDoc.body.style.transformOrigin="");_iframeDoc.body.style.transform&&""!=_iframeDoc.body.style.transform&&(m=_iframeDoc.body.style.transform,_iframeDoc.body.style.transform="");_iframeDoc.body.style.zoom&&""!=_iframeDoc.body.style.zoom&&(q=_iframeDoc.body.style.zoom,_iframeDoc.body.style.zoom="");var t=_iframeDoc.body.outerHTML;
""!=h&&(_iframeDoc.body.style.transformOrigin=h);""!=m&&(_iframeDoc.body.style.transform=m);""!=q&&(_iframeDoc.body.style.zoom=q);changeBodyImageProperty(!0);DEXTTOP.DEXT5.browser.ie&&"1"==b._config.plugInUse&&"1"==b._config.printPreview&&(h='<object id="dext5printpreview" classid="CLSID:2A28D4A1-467B-48C7-AF21-51F6D88456BD" width="0" height="0"><param name="saveFileType" value="">'+('<param name="serverDomain" value="'+b._config.serverDomain+'">'),h+='<param name="toSavePathUrl" value="'+b._config.toSavePathURL+
'">',h+='<param name="saveFolderNameRule" value="'+b._config.saveFolderNameRule+'">',h+='<param name="saveFileNameRule" value="'+b._config.saveFileNameRule+'">',h+='<param name="productKey" value="'+b._config.productKey+'">',h+='<param name="licenseKeyUrl" value="'+b._config.plugin_root+'">',h+='<param name="postPageURL" value="'+b._config.post_url+'">',h+='<param name="accessibility" value="'+b._config.accessibility+'">',h+='<param name="licenseKey" value="'+b._config.LicenseKey+'">',h+='<param name="strPrintMargin" value="'+
b._config.printMarginltrb+'">',h+='<param name="hasContainer" value="'+b._config.hasContainer+'">',h+='<param name="nUsePrintLandscape" value="'+b._config.printLandscape+'">',h+="</object>",t+=h);DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&(t=DEXTTOP.DEXT5.util.htmlRevision(t));G_BodyFit.noncreationAreaBackgroundStatus&&setBodyFitStyle(b,!0);b._PageProp.bshowgrid&&1==b._PageProp.bshowgrid&&changeBodyImageProperty(!1);FixFlashError(b);getDocWindow(a);a.open("text/html","replace");
isCustomDomain(document)&&(a.domain=document.domain);a.write(c+"<html>"+f+t+"</html>");a.close();G_BodyFit.noncreationAreaBackgroundStatus&&(a.documentElement.style.backgroundColor=b._DOC.documentElement.style.backgroundColor,a.documentElement.style.display=b._DOC.documentElement.style.display,a.documentElement.style.height=b._DOC.documentElement.style.height,a.documentElement.style.width=b._DOC.documentElement.style.width);""!=b._config.placeholder.content&&placeholderControl(b,"set");setHeadScriptSrc(a,
g);"rtl"==_dext_editor._config.direction.write&&(c=a.getElementsByTagName("html")[0],c.setAttribute("dir","rtl"));0<d.length&&(c=a.getElementsByTagName("html")[0],-1<d.indexOf("-")&&(d=d.split("-")[0]),(g=_iframeDoc.getElementsByTagName("html")[0])&&g.getAttribute("lang")&&""!=g.getAttribute("lang")?c.setAttribute("lang",d):c.removeAttribute("lang"),c.setAttribute("xml:lang",d),0<e.length&&c.setAttribute("xmlns",e));replaceClassForBorder(b,a.body,"hidden");replaceClassForBookmark(b,a.body,"hidden");
hiddenBlocks(a);if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)try{for(var u=a.getElementsByTagName("iframe"),v=u.length,e=0;e<v;e++){var w=u[e],y=a.createElement("div");y.style.height=w.height?w.height+"px":w.style.height+"px";y.style.width=w.width?w.width+"px":w.style.width+"px";y.style.overflow="scroll";y.style.overflowX="hidden";y.style.WebkitOverflowScrolling="touch";setWrapperToElement(w,y)}}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}"spellcheck"in a.body&&
(a.body.spellcheck=!1);"contentEditable"in a.body&&(a.body.contentEditable=!1);if(DEXTTOP.DEXT5.browser.ie)try{DEXTTOP.DEXT5.util.addEvent(b._EDITOR.preview.contentWindow,"unload",function(){FixFlashError()}),DEXTTOP.DEXT5.util.addEvent(_iframeWin,"unload",function(){FixFlashError2(_iframeDoc)})}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}setAdjustTableBorder(a);setZoomValueToBody(a,b);DEXTTOP.DEXT5.util.addEvent(a.body,"click",function(a){try{evt=a?a:event,evt.srcElement?elem=
evt.srcElement:evt.target&&(elem=evt.target)}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(elem&&("a"!=elem.tagName.toLowerCase()&&(elem=GetParentbyTagName(elem,"a")),elem&&elem.getAttribute("href")&&!(-1<elem.getAttribute("href").indexOf("#")))){var c=elem.getAttribute("target");elem.setAttribute("target","_blank");setTimeout(function(){c&&""!=c?elem.setAttribute("target",c):elem.removeAttribute("target")},1)}});DEXTTOP.DEXT5.util.addEvent(b._EDITOR.preview.contentWindow,"scroll",
function(a){moveRulerPosition(a)})}function setWrapperToElement(a,b){a.nextSibling?a.parentNode.insertBefore(b,a.nextSibling):a.parentNode.appendChild(b);b.appendChild(a)}
function changeBodyImageProperty(a){var b=DEXTTOP.G_CURREDITOR;if(a)b._PageProp.bodyimage&&0<b._PageProp.bodyimage.length?_iframeDoc.body.style.backgroundImage=b._PageProp.bodyimage:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-image"):_iframeDoc.body.style.removeAttribute("backgroundImage"),b._PageProp.bodycolor&&0<b._PageProp.bodycolor.length?_iframeDoc.body.style.backgroundColor=b._PageProp.bodycolor:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-color"):
_iframeDoc.body.style.removeAttribute("backgroundColor"),b._PageProp.bodyattachment&&0<b._PageProp.bodyattachment.length?_iframeDoc.body.style.backgroundAttachment=b._PageProp.bodyattachment:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-attachment"):_iframeDoc.body.style.removeAttribute("backgroundAttachment"),b._PageProp.bodyrepeat&&0<b._PageProp.bodyrepeat.length?_iframeDoc.body.style.backgroundRepeat=b._PageProp.bodyrepeat:_iframeDoc.body.style.removeProperty?
_iframeDoc.body.style.removeProperty("background-repeat"):_iframeDoc.body.style.removeAttribute("backgroundRepeat");else if(b._PageProp.gridimage&&0<b._PageProp.gridimage.length&&(_iframeDoc.body.style.backgroundImage=b._PageProp.gridimage),b._PageProp.gridattachment&&0<b._PageProp.gridattachment.length&&(_iframeDoc.body.style.backgroundAttachment=b._PageProp.gridattachment),b._PageProp.gridrepeat&&0<b._PageProp.gridrepeat.length&&(_iframeDoc.body.style.backgroundRepeat=b._PageProp.gridrepeat),"1"==
b._config.horizontalLine.use&&0<b._config.horizontalLine.url.length){a="";for(var c=0;c<b._config.horizontalLine.url.length;c++)0<c&&(a+=","),a+='url("'+b._config.horizontalLine.url[c]+'")';_iframeDoc.body.style.backgroundImage=a;_iframeDoc.body.style.backgroundRepeat="repeat";_iframeDoc.body.style.margin="0px 10px 10px 10px"}}
function changeBodyContenteditable(a){a?DEXTTOP.G_CURREDITOR._config.editorBodyEditable&&0==isViewMode(DEXTTOP.G_CURREDITOR)&&(_iframeDoc.body.contentEditable=a):(_iframeDoc.body.removeAttribute("contentEditable"),_iframeDoc.body.style.removeProperty?(_iframeDoc.body.style.removeProperty("margin-left"),_iframeDoc.body.style.removeProperty("margin-top"),_iframeDoc.body.style.removeProperty("margin-right"),_iframeDoc.body.style.removeProperty("margin-bottom"),_iframeDoc.body.style.removeProperty("margin")):
(_iframeDoc.body.style.removeAttribute("marginLeft"),_iframeDoc.body.style.removeAttribute("marginTop"),_iframeDoc.body.style.removeAttribute("marginRight"),_iframeDoc.body.style.removeAttribute("marginBottom"),_iframeDoc.body.style.removeAttribute("margin")))}
function fakeBodyDivForBackground(a,b){a=a.replace(/(\r\n|\n|\r)/gm,"");if(b){var c=a.substr(0,4),d=a.substr(a.length-6,6);"<div"==c.toLowerCase()&&"</div>"==d.toLowerCase()&&(c=c.replace(c,"<body"),d=d.replace(d,"</body>"),a=a.substring(4,a.length-6),a=c+a+d)}else c=a.substr(0,5),d=a.substr(a.length-7,7),"<body"==c.toLowerCase()&&"</body>"==d.toLowerCase()&&(c=c.replace(c,"<div"),d=d.replace(d,"</div>"),a=a.substring(5,a.length-7),a=c+a+d);return a}
function createDynamicCssLinkToHeadTag(a,b,c){try{if(""!=c){var d=a.createElement("link");d.type="text/css";d.rel="stylesheet";d.href=c;b.appendChild(d)}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function clearDynamicCssLinkToHeadTag(a,b){try{for(var c=a.getElementsByTagName("link"),d=c.length;0<d;d--){var e=c[d-1];0>e.href.indexOf("editor_contents.css")&&a.removeChild(e)}b&&0<c.length&&a.removeChild(c[0])}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function addDynamicCssToHeadTag(a,b,c){try{for(var d=b.getElementsByTagName("style"),e=d.length;0<e;e--){var f=d[e-1];f.getAttribute("data-destyle")||"dext_placeholder"==f.id||b.removeChild(f)}if(""!=c){var g=createStyleNode(a);setCssTextToStyleNode(c,g,a);b.appendChild(g)}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function createDynamicJsLinkToHeadTag(a,b,c){try{if(""!=c){var d=a.createElement("script");d.type="text/javascript";d.src=c;b.appendChild(d)}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function clearDynamicJsLinkToHeadTag(a){try{for(var b=a.getElementsByTagName("script"),c=b.length-1;0<=c;c--)a.removeChild(b[c])}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function addDynamicJsToHeadTag(a,b,c){try{for(var d=b.getElementsByTagName("script"),e=d.length-1;0<=e;e--){var f=d[e];f.src&&""!=f.src||b.removeChild(f)}if(""!=c){var g=a.createElement("script");g.type="text/javascript";g.appendChild(a.createTextNode(c));b.appendChild(g)}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function addDefaultStyleToEditor(a,b,c){if("0"!=b._config.setDefaultStyle.dext_set_style){var d=["body","p","li"];if(DEXTTOP.DEXT5.browser.DOMParserSupported){d=(new DOMParser).parseFromString(a,"text/html");isCustomDomain(document)&&(d.domain=document.domain);for(var e=d.getElementsByTagName("head")[0],f=e.querySelectorAll("style["+G_DEDefaultStyleData.fullName+'="'+G_DEDefaultStyleData.value+'"]'),g=f.length-1;0<=g;g--)f[g].parentNode.removeChild(f[g]);b=createDefaultStyleNodeForEditorArea(b);e.appendChild(b);
b="string"==c.htmlType?c.htmlType:"htmlex";"htmlexwithdoctype"==b?(b="",-1<a.toLowerCase().indexOf("<html")&&(b=a.substring(0,b)),a=b+d.documentElement.outerHTML):"htmlex"==b?a=d.documentElement.outerHTML:"html"==b&&(a=d.documentElement.innerHTML)}else{"0"!=b._config.setDefaultStyle.value&&(d="#"+b._config.setDefaultStyle.body_id,d=[d,d+" p",d+" li"]);c=[!1,!1,!1];for(var h=d.length,m=a.toLowerCase(),f=e=-1,q=m,g=0;-1<q.indexOf("<style");){var e=g+q.indexOf("<style"),f=g+q.indexOf("</style>"),t=q.indexOf("\x3c!--"),
u=q.indexOf("--\x3e");if(-1==t)break;else if(g+t<e&&g+u<e||e>g+t+4&&f+8<g+u)q=q.substring(u+3),g+=u+3;else break}q=b._setting.line_height;""!=q&&-1<q.indexOf("%")&&parseIntOr0(q,10);q="";if(-1<m.indexOf("<head")&&-1<e&&-1<f){for(var g="",g=a.substring(e,f),v=g.indexOf(">"),m=g.substring(0,v+1),g=g.substring(v+1),u=g.indexOf("/*"),t=g.indexOf("*/");-1<u&&-1<t;)u=g.substring(0,u),g=g.substring(t+2),g=u+g,u=g.indexOf("/*"),t=g.indexOf("*/");t=parsingCssString(g);u=t.length;for(g=0;g<u;g++){DEXTTOP.DEXT5.browser.ie&&
7>=DEXTTOP.DEXT5.browser.ieVersion&&(-1<t[g].indexOf("\x3c!--")&&(t[g]=t[g].replace("\x3c!--","")),-1<t[g].indexOf("--\x3e")&&(t[g]=t[g].replace("--\x3e","")));v=t[g].indexOf("{");if(-1<v)for(var v=t[g].substring(0,v),w=0;w<h;w++){var y=DEXTTOP.DEXT5.util.trim(v.replace("--\x3e","")),x=d[w].split(" ")[1];y==x&&(t[g]="");y==d[w]&&(t[g]=-1<v.indexOf("--\x3e")?"--\x3e":"")}q+=t[g]}t=c.length;h="";"2"==b._config.setDefaultStyle.dext_set_style&&(h="font-family:"+b._setting.font_family+"; font-size:"+b._setting.font_size+
";");b=createEditorDefaultStyleInnerHTML(b._config,"","","",b._setting.word_break_type,b._setting.word_wrap_type);for(g=0;g<t;g++)0==c[g]&&(u="",reg_exp=new RegExp(d[g]+" {([\\w\\W\\s]+?)}","gi"),(u=b.match(reg_exp))&&(u=u[0].replace(reg_exp,"$1")),d[g]==d[0]?q+=d[g]+" {"+u+"}":(q+=d[g]+" {"+u,q+=h,q+="}"));q=m+q;a=a.substring(0,e)+q+a.substring(f,a.length)}else-1<m.indexOf("<head")&&0>e&&(v=m.indexOf("</head"),0<v&&(h="","2"==b._config.setDefaultStyle.dext_set_style&&(h="font-family:"+b._setting.font_family+
"; font-size:"+b._setting.font_size+";"),b=createEditorDefaultStyleInnerHTML(b._config,"","","",b._setting.word_break_type,b._setting.word_wrap_type),b=b.replace("p {","p {"+h),b=b.replace("li {","li {"+h),q=q+'<style type="text/css">'+b,q+="</style>",a=a.substring(0,v)+q+a.substring(v,a.length)))}}return a}
function base64imageToLocalFile(a){if(G_dext5plugIn){a=a.body.getElementsByTagName("img");for(var b=a.length,c=0;c<b;c++){var d=a[c];if(!d.getAttribute("raon_chart"))try{var e=d.src;if("data:"==e.substring(0,5)){var f=e.split(",");if(2==f.length){var g=getExtFromImageDataSrc(f[0]);try{var h=G_dext5plugIn.getLocalImageFromBase64Image(f[1],g);0<h.length&&(d.src=h)}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}}
function setStyleForTableBorderNodeClass(a){try{if(0==checkIfIncluded("editor_contents.css")){var b="",b=DEXTTOP.DEXT5.isRelease?a._config.webPath.css:a._config.webPath.css_dev;DEXTTOP.DEXT5.addUserCssUrl(b+"editor_contents.css?t="+DEXTTOP.DEXT5.UrlStamp,a.ID)}}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setCssForFormMode(a){try{if(("1"==a._config.formMode||"1"==a._config.userTableLock.use)&&0==checkIfIncluded("editor_form.css")){var b="",b=DEXTTOP.DEXT5.isRelease?a._config.webPath.css:a._config.webPath.css_dev;DEXTTOP.DEXT5.addUserCssUrl(b+"editor_form.css?t="+DEXTTOP.DEXT5.UrlStamp,a.ID)}}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setHeadLinkUrlTimeStamp(a){a=a.childNodes;for(var b=a.length,c=0;c<b;c++){var d=a[c];if(d&&d.tagName&&"link"==d.tagName.toLowerCase()&&!(-1<d.href.indexOf("editor_contents.css")||-1<d.href.indexOf("editor_form.css"))){var e="";try{d.outerHTML.match(RegExp("(hrefs*=s*(?:\"|')(.*?)(?:\"|'))","gi")),e=RegExp.$2}catch(f){e=d.href}d=e.split("?");if(1<d.length){for(var e=d[1].split("&"),g=e.length,h=0;h<g;h++)-1<e[h].indexOf("t=")&&(e[h]="t="+(new Date).getTime());a[c].href=d[0]+"?"+e.join("&")}else a[c].href=
d[0]+"?t="+(new Date).getTime()}}}
function getHeadScriptSrc(a,b){for(var c=a.getElementsByTagName("script"),d=[],e=c.length;0<e;e--){var f=c[e-1];if(f.src&&""!=f.src){var g="";try{f.outerHTML.match(RegExp("(srcs*=s*(?:\"|')(.*?)(?:\"|'))","gi")),g=RegExp.$2}catch(h){g=f.src}g=g.split("?");if(1<g.length){for(var m=g[1].split("&"),q=m.length,t=0;t<q;t++)-1<m[t].indexOf("t=")&&(m[t]="t="+(new Date).getTime());g=g[0]+"?"+m.join("&")}else g=g[0]+"?t="+(new Date).getTime();d.push(g);b&&a.removeChild(f)}}return d}
function setHeadScriptSrc(a,b){var c=a.getElementsByTagName("head")[0];if(c)for(var d=0,e=b.length;d<e;d++)createDynamicJsLinkToHeadTag(a,c,b[d])}
function getRemoveHeadScript(a){var b={html:a,scriptsAry:[]},c=a.toLowerCase().indexOf("<head"),d=a.toLowerCase().indexOf("</head>"),e=a.substring(0,c),c=a.substring(c,d+7);a=a.substring(d+7,a.length);var d=RegExp("<script[^>]*src=([\\s\\S]*?)>[\\s\\S]*?\x3c/script>","gi"),f=c.match(d);if(f){for(var g=f.length,h=0;g>h;h++)d=RegExp('<script[^>]*src="([\\s\\SS]*?)"([\\s\\S]*?)>[sS]*?\x3c/script>',"gi"),d.test(f[h]),b.scriptsAry.push(RegExp.$1);d=RegExp("<script[^>]*src=([\\s\\S]*?)>[\\s\\S]*?\x3c/script>",
"gi");c=c.replace(d,"");b.html=e+c+a}return b}function addStyleTag(a,b){try{for(var c=!1,d=b._DOC.getElementsByTagName("head")[0],e=d.getElementsByTagName("style"),f=e.length,g=0;g<f;g++)if("mobile_style"==e[g].getAttribute("dext")){c=!0;break}if(!c){var h=a.cssText,m=createStyleNode(b._DOC),q;for(q in a.attrObj)a.attrObj[q]&&m.setAttribute(q,a.attrObj[q]);setCssTextToStyleNode(h,m,b._DOC);d.appendChild(m)}}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setScrollStyleForIOS(a){DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&addStyleTag({cssText:"1"==_dext_editor._config.removeBodyHeightForIos||"1"==_dext_editor._config.view_mode_auto_height?"html,body{ -webkit-overflow-scrolling : touch !important; }":"html,body{ -webkit-overflow-scrolling : touch !important; height: 100% !important; }",attrObj:{dext:"mobile_style"}},a)}
function removeScrollStyleForIOS(a){if(DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS){a=a._DOC.getElementsByTagName("head")[0];for(var b=a.getElementsByTagName("style"),c=b.length-1;0<=c;c--)"mobile_style"==b[c].getAttribute("dext")&&a.removeChild(b[c])}}
function setEmptyTagWhiteSpace(a,b){if("0"==a._config.removeEmptyTag&&"1"==a._config.removeEmptyTagReplaceDefaultParagraphValue){var c=a._DOC;b&&(c=b);for(var c=c.body.getElementsByTagName("p"),d=c.length,e=0;e<d;e++){var f=0,g=c[e].getElementsByTagName("br"),f=f+g.length;0==f&&(g=c[e].getElementsByTagName("input"),f+=g.length);0==f&&(g=c[e].getElementsByTagName("textarea"),f+=g.length);0==f&&(g=c[e].getElementsByTagName("img"),f+=g.length);if(!(0<f)&&"1"==a._config.removeEmptyTagInsertNbspForLineBreak&&
""==(void 0!=c[e].innerText?c[e].innerText:c[e].textContent).replace(unescape("%u200B"),"")){f=document.createTextNode("\u00a0");try{c[e].appendChild(f)}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}}}
function createEditorDefaultStyleInnerHTML(a,b,c,d,e,f){var g="";if(void 0==b||""==b)b=DEXTTOP.G_CURREDITOR._setting.font_family;if(void 0==c||""==c)c=DEXTTOP.G_CURREDITOR._setting.font_size;if(void 0==d||""==d)d=DEXTTOP.G_CURREDITOR._setting.line_height;if(void 0==e||""==e)e="normal";if(void 0==f||""==f)f="normal";var h="";"1"==a.defaultImemode&&(h="-ms-image-mode: active; ime-mode: active;");var m="";"1"==a.defaultBodySpace.use?(m="1"==a.defaultBodySpace.mode?"margin:":"2"==a.defaultBodySpace.mode?
G_BodyFit&&1==G_BodyFit.widthFixStatus&&"1"==a.ruler.use?"margin:10px 10px 10px 10px; padding:":"margin:0px; padding:":"margin:",m="1"==a.horizontalLine.use?m+("0px "+a.defaultBodySpace.configValue.right+" "+a.defaultBodySpace.configValue.bottom+" "+a.defaultBodySpace.configValue.left+";"):m+(a.defaultBodySpace.configValue.top+" "+a.defaultBodySpace.configValue.right+" "+a.defaultBodySpace.configValue.bottom+" "+a.defaultBodySpace.configValue.left+";")):m="margin:0px;";"1"==a.setDefaultStyle.value||
"2"==a.setDefaultStyle.value?(g+="#"+a.setDefaultStyle.body_id+" { cursor:text; "+m+" font-family:"+changeFontFamily(b)+"; font-size:"+c+";"+h+" word-break:"+e+"; word-wrap:"+f+"; }",g+="#"+a.setDefaultStyle.body_id+" p { line-height:"+d+"; margin-top:"+a.defaultFontMarginTop+"; margin-bottom:"+a.defaultFontMarginBottom+"; }",g+="#"+a.setDefaultStyle.body_id+" li { line-height:"+d+"; margin-top:"+a.defaultFontMarginTop+"; margin-bottom:"+a.defaultFontMarginBottom+"; }",g+="#"+a.setDefaultStyle.body_id+
" .raon_placeholder { display: inline-block; }",g+="#"+a.setDefaultStyle.body_id+" .raon_placeholder:empty:before { content: attr(placeholder); color: #EE0000; }",g+="#"+a.setDefaultStyle.body_id+" .raon_placeholder:focus:before { content: none; }"):(g+="body { cursor:text; "+m+" font-family:"+changeFontFamily(b)+"; font-size:"+c+";"+h+" word-break:"+e+"; word-wrap:"+f+"; }",g+="p { line-height:"+d+"; margin-top:"+a.defaultFontMarginTop+"; margin-bottom:"+a.defaultFontMarginBottom+"; }",g+="li { line-height:"+
d+"; margin-top:"+a.defaultFontMarginTop+"; margin-bottom:"+a.defaultFontMarginBottom+"; }",g+=".raon_placeholder { display: inline-block; }.raon_placeholder:empty:before { content: attr(placeholder); color: #EE0000; }",g+=".raon_placeholder:focus:before { content: none; }");"1"==a.highlight.use&&"undefined"!=typeof a.highlight.color&&""!=a.highlight.color&&(g+=" .raon_highlighter { background-color: "+a.highlight.color+"; } ");return g}
function defaultStyleSameCheck(a,b){var c=!1;"1"==b._config.setDefaultStyle.value||"2"==b._config.setDefaultStyle.value?-1<a.indexOf("#"+b._config.setDefaultStyle.body_id)&&(c=!0):0>a.indexOf("#"+b._config.setDefaultStyle.body_id)&&-1<a.indexOf("body {")&&-1<a.indexOf("p {")&&-1<a.indexOf("li {")&&(c=!0);return c}
function getDefaultStyleTag(a,b){var c=null,d=createEditorDefaultStyleInnerHTML(b._config,"","","",b._setting.word_break_type,b._setting.word_wrap_type),e=createStyleNode(a);setCssTextToStyleNode(d,e,a);for(var d=a.getElementsByTagName("style"),f=d.length-1;0<=f;f--){var g=!1,h=d[f];h.dataset?h.dataset[G_DEDefaultStyleData.name]==G_DEDefaultStyleData.value&&(g=!0):h.getAttribute(G_DEDefaultStyleData.fullName)==G_DEDefaultStyleData.value&&(g=!0);null==c&&h.innerHTML==e.innerHTML&&(g=!0);g&&(null==
c?c=h:h.parentNode.removeChild(h))}return c}function moveStyleTagToHead(a){try{if("1"==a._config.moveStyleTagToHead)for(var b=a._BODY.getElementsByTagName("style"),c=b.length-1;0<=c;c--)a._DOC.documentElement.getElementsByTagName("head")[0].appendChild(b[c])}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setDesignAreaHtml(a,b,c){var d="1";"string"==typeof c.setWriteMode&&(d=c.setWriteMode);"1"!=d&&0==DEXTTOP.DEXT5.browser.DOMParserSupported&&(d="1");c=function(){b.open("text/html","replace");isCustomDomain(document)&&(b.domain=document.domain);b.write(a);b.close()};var e=function(){var c=(new DOMParser).parseFromString(a,"text/html");isCustomDomain(document)&&(c.domain=document.domain);var d=c.doctype,e=b.doctype,d=b.documentElement;d.parentNode.replaceChild(c.documentElement,d);d=c.doctype;
e=b.doctype;d?null==e?b.insertBefore(d,b.documentElement):b.replaceChild(d,e):e&&b.removeChild(e)};if("1"==d)c();else try{e()}catch(f){c()}}
function createDefaultStyleNodeForEditorArea(a,b){var c=b?b:{},d=a._setting.word_break_type,e=a._setting.word_wrap_type;"string"==typeof c.wordBreakType&&(d=c.wordBreakType);"string"==typeof c.wordWrapType&&(e=c.wordWrapType);c=createEditorDefaultStyleInnerHTML(a._config,"","","",d,e);d=createStyleNode(_iframeDoc);setCssTextToStyleNode(c,d,_iframeDoc);d.dataset?d.dataset[G_DEDefaultStyleData.name]=G_DEDefaultStyleData.value:d.setAttribute(G_DEDefaultStyleData.fullName,G_DEDefaultStyleData.value);
return d};var g_findRepalceRange=null;
function command_find(a,b,c,d,e,f,g,h){dext_src_init(b);restoreSelection();setFocusToBody();if(0==c.length)return!1;try{a=null;if(null==g_findRepalceRange){var m=getFirstRange().range;a=rangy.createRange(_iframeDoc);a.selectNodeContents(_iframeDoc.body);f?a.setStart(m.startContainer,m.startOffset):a.setEnd(m.startContainer,m.startOffset)}else a=g_findRepalceRange;d={caseSensitive:d,wholeWordsOnly:e,direction:f?"forward":"backward"};var q=a.findText(c,d);if(q)a.select(),f?a.collapse(!1):a.collapse(!0),
setAutoScrollToRange(a),g_findRepalceRange=a;else if(g)if(a=f?moveCursorToTag(_iframeDoc.body,!0):moveCursorToTag(_iframeDoc.body,!1),q=a.findText(c,d))a.select(),f?a.collapse(!1):a.collapse(!0),setAutoScrollToRange(a),g_findRepalceRange=a;else return 0!=h&&alert(dext5_lang.find.msg.no_find),!1;else return 0!=h&&alert(dext5_lang.find.msg.no_find),!1}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_replace(a,b,c,d,e,f,g,h,m){dext_src_init(b);restoreSelection();setFocusToBody();if(0!=c.length)try{var q=null;if(null==g_findRepalceRange){var t=getFirstRange().range,q=rangy.createRange(_iframeDoc);q.selectNodeContents(_iframeDoc.body);q.setStart(t.startContainer,t.startOffset)}else q=g_findRepalceRange;var u={caseSensitive:e,wholeWordsOnly:f,direction:g?"forward":"backward"},v=!1,w=(t=getFirstRange().range)&&t.toString();!e&&t&&(c=c.toLowerCase(),w=w.toLowerCase());if(w==c){t.collapse(g);
q.setStart(t.startContainer,t.startOffset);if(v=q.findText(c,u)){q.select();q.deleteContents();var y=q.getDocument().createTextNode(d);q.insertNode(y);q.selectNode(y);q.select();g?q.collapse(!1):q.collapse(!0);m||command_find(a,b,c,e,f,g,h)}else g_findRepalceRange&&h&&(q=g?moveCursorToTag(_iframeDoc.body,!0):moveCursorToTag(_iframeDoc.body,!1),v=q.findText(c,u))&&(q.select(),q.deleteContents(),y=q.getDocument().createTextNode(d),q.insertNode(y),q.selectNode(y),q.select(),g?q.collapse(!1):q.collapse(!0),
command_find(a,b,c,e,f,g,h));onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0});onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"replace"})}else command_find(a,b,c,e,f,g,h)}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_replaceAll(a,b,c,d,e,f,g,h,m,q){dext_src_init(b);restoreSelection();setFocusToBody();if(0!=c.length)try{g_findRepalceRange=null;range=rangy.createRange(_iframeDoc);range.selectNodeContents(_iframeDoc.body);a={caseSensitive:e,wholeWordsOnly:f,direction:g?"forward":"backward"};for(b=0;range.findText(c,a);){range.select();range.deleteContents();var t=range.getDocument().createTextNode(d);range.insertNode(t);q&&range.selectNode(t);range.select();b+=1;g?range.collapse(!1):range.collapse(!0)}0<
b&&!m&&alert(b+dext5_lang.replace.replaceall_result);onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0});onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"replace"})}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_highlightAll(a,b,c,d,e,f){dext_src_init(b);restoreSelection();setFocusToBody();if(0!=d.length)try{doSetCaretPosition(_iframeDoc.body.firstChild,!1,null,!0);var g=getFirstRange().range,h=rangy.createRange(_iframeDoc);h.selectNodeContents(_iframeDoc.body);h.setStart(g.startContainer,g.startOffset);a={caseSensitive:e,wholeWordsOnly:f,direction:"forward"};var m=rangy.createCssClassApplier("raon_highlighter");for(0==h.findText(d,a)&&(h=moveCursorToTag(_iframeDoc.body,!0));h.findText(d,
a);)h.select(),"add"==c?m.applyToRange(h):"remove"==c&&m.undoToRange(h),h.collapse(!1);(_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection).removeAllRanges();"remove"==c&&doSetCaretPosition(_iframeDoc.body.firstChild,!1,null,!0)}catch(q){throw q;}}
function command_changeWordUpperLower(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();a=function(a,b){try{var d=b.startContainer;d.firstNode&&(d=d.firstNode);var e=b.startOffset,f=b.endContainer;f.lasttNode&&(f=f.lasttNode);for(var g=b.endOffset,h=a.length,m=0;m<h;m++){var q=a[m];if(3==q.nodeType){var A=q.nodeValue,C,E,H;C=E=H="";q==d&&q==f?(E=A.substring(0,e),C=A.substring(e,g),H=A.substring(g,A.length)):q==d&&0<e?(E=A.substring(0,e),C=A.substring(e,A.length)):q==f&&g<A.length?(C=A.substring(0,
g),E=A.substring(g,A.length)):C=A;if("UPPER"==c)C=C.toUpperCase();else if("LOWER"==c)C=C.toLowerCase();else if("FIRSTUPPER"==c){var M=C.substring(0,1),N=C.substring(1,C.length);C=M.toUpperCase()+N.toLowerCase()}else break;A=q==d&&q==f?E+C+H:q==d&&0<e?E+C:C+E;q.nodeValue=A}}}catch(I){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};b=getFirstRange();var d=b.range,e=GetTableSelectionCells(),f=e.length;if(!d.collapsed||0!=f){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
if(0<f)for(var g=d.cloneRange(),h=0;h<f;h++){var m=getAllTextNodeByNode(e[h]),q=m.length;0<q&&(b.sel.removeAllRanges(),d.selectNode(e[h]),b.sel.addRange(d),a(m,d),b.sel.removeAllRanges(),b.sel.addRange(g))}else m=getSelectionTextNodes(d),q=m.length,0<q&&(a(m,d),d.setStart(m[0],0),d.setEnd(m[q-1],m[q-1].length),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(d));DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;onChange({editor:DEXTTOP.G_CURREDITOR,
isPossibleDirty:!0});onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"tool_replace"})}}function moveCursorToTag(a,b){if(null!=a&&void 0!=a){var c=rangy.createRange(_iframeDoc);c.selectNodeContents(a);try{b?c.collapse(!0):c.collapse(!1),rangy.getSelection(_iframeWin).setSingleRange(c)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}}function getNextNode(a){if(a.firstChild)return a.firstChild;for(;a;){if(a.nextSibling)return a.nextSibling;a=a.parentNode}}
function getNodesInRange(a){var b=a.startContainer,c=a.endContainer;a=a.commonAncestorContainer;var d=[],e;for(e=b.parentNode;e&&(d.push(e),e!=a);e=e.parentNode);d.reverse();for(e=b;e&&(d.push(e),e!=c);e=getNextNode(e));return d}
function getAllNodesInBody(a,b){var c=[];if(b){var d=a.getElementsByTagName("*");if(d)for(var e=d.length,f=0;f<e;f++){var g=d[f];g.tagName.toLowerCase();1==g.nodeType&&c.push(g)}}else for(g=a.childNodes[0];null!=g;)if(1==g.nodeType&&c.push(g),g.hasChildNodes())g=g.firstChild;else{for(;null==g.nextSibling&&g!=a;)g=g.parentNode;g=g.nextSibling}return c}
function setAutoScrollToRange(a){try{var b=a.startContainer.parentNode;if(b){var c=getElementOffset(b);_iframeWin.scroll(c.left,c.top)}}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function getNextSiblings(a,b){for(;a=a.nextSibling;)1!=a.nodeType&&3!=a.nodeType||b.push(a)}function firstElementChild(a){var b=a.firstElementChild;if(!b)for(b=a.firstChild;b&&1!==b.nodeType;)b=b.nextSibling;return b}
function getTextNodesBetween(a){function b(a){var u=a.nodeValue;a==d&&a==e&&a!==c?(u&&q.push(u.substring(f,g)),h=m=!0):a==d?(u&&q.push(u.substring(f)),h=!0):a==e?(u&&q.push(u.substring(0,g)),m=!0):3==a.nodeType&&u&&h&&!m&&!/^\s*$/.test(u)&&q.push(u);for(var u=0,v=a.childNodes.length;!m&&u<v;++u)b(a.childNodes[u])}var c=a.commonAncestorContainer,d=a.startContainer,e=a.endContainer,f=a.startOffset,g=a.endOffset,h=!1,m=!1,q=[];b(c);return q}
function getSelectionTextNodes(a){function b(a){var q=a.nodeValue;a==d&&a==e&&a!==c?(q&&h.push(a),f=g=!0):a==d?(q&&h.push(a),f=!0):a==e?(q&&h.push(a),g=!0):3==a.nodeType&&q&&f&&!g&&!/^\s*$/.test(q)&&h.push(a);for(var q=0,t=a.childNodes.length;!g&&q<t;++q)b(a.childNodes[q])}var c=a.commonAncestorContainer,d=a.startContainer,e=a.endContainer,f=!1,g=!1,h=[];b(c);return h};var _iframeDoc,_iframeWin,G_CURSOR_BEFORE_INTABLE=!1,G_BEFORE_INTABLE=null,G_ImagesBase64Data=[],G_IMG_TOTAL_SIZE=-1,G_IMG_TOTAL_LIST={},G_IMG_CURRENT_LIST={},G_IMG_CURRENT_ARRAYLIST=[],G_IMG_TOTAL_COUNT=0,G_KEY_IMG_COUNT=-1,G_KeyDownUpSync=!1,G_HandleFilesCheck=!1,G_tempTotalFileSizeForHandleFilesProcess=0,G_tempTotalFileSizeForHandleFilesLength=0,G_FullScreenCheckObject=[],G_IsPossibleDirty=!1,G_FormData=[],G_CompleteImageQuality=!1,G_changeCount=0,G_workerCount=0,G_ImageWorkerArr=[],G_ChangeImageArr=
[],G_QualityFileObj=[],G_QualityImgElm=[],G_WorkingIdx=0,G_OriginalMultiImageSize_src={},G_Base64FileNameMap={},G_DEDefaultStyleData={name:"destyle",fullName:"data-destyle",value:"deDefaultStyle"},G_PPTConvertedSize={};
function saveSelection(a,b){if(0!=DEXTTOP.DEXT5.browser.ie||0!=!!b){var c=document.getElementById("dext5_design_"+a);dext_src_init(c);var c=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection,d;try{c&&(c.createRange?d=c.createRange():c.getRangeAt?d=c.getRangeAt(0):c.anchorNode&&c.focusNode&&doc.createRange&&(d=_iframeDoc.createRange(),d.setStart(c.anchorNode,c.anchorOffset),d.setEnd(c.focusNode,c.focusOffset),d.collapsed!==c.isCollapsed&&(d.setStart(c.focusNode,c.focusOffset),d.setEnd(c.anchorNode,
c.anchorOffset))))}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return d}}
function restoreSelection(a,b){if(0!=DEXTTOP.DEXT5.browser.ie||0!=!!b)try{var c=getEditrFromEvent(null),d=null,d=c?c._FRAMEWIN._iframeWin:_iframeWin;d.document.body.focus();var e=d.getSelection?d.getSelection():d.document.selection;if(null==a||void 0==a)a=c._LastRange;e&&a&&(a.select?a.select():e.removeAllRanges&&e.addRange&&(e.removeAllRanges(),e.addRange(a)),c._LastRange=null)}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function createBookmark(){var a=document.getElementById("dext5_design_"+G_USE_EDITOR_ID);dext_src_init(a);var a=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection,b;try{a&&(a.createRange?b=a.createRange():a.getRangeAt?b=a.getRangeAt(0):a.anchorNode&&a.focusNode&&doc.createRange&&(b=_iframeDoc.createRange(),b.setStart(a.anchorNode,a.anchorOffset),b.setEnd(a.focusNode,a.focusOffset),b.collapsed!==a.isCollapsed&&(b.setStart(a.focusNode,a.focusOffset),b.setEnd(a.anchorNode,a.anchorOffset))))}catch(c){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return b}function goToBookmark(a){if(0!=DEXTTOP.DEXT5.browser.ie)try{_iframeDoc.body.focus();var b=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection;b&&a&&(a.select?a.select():b.removeAllRanges&&b.addRange&&(b.removeAllRanges(),b.addRange(a)))}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function RemoveUnnecessaryChar(a){a=ReplaceAll(a,unescape("%uFEFF"),"");return a=ReplaceAll(a,unescape("%u200b"),"")}
function CleanZeroChar(a){if("0"==DEXTTOP.G_CURREDITOR._config.removeEmptyTag)return a;var b="span b strong i em strike u sup sub font".split(" "),c=new RegExp("(<span[^>]*?raon_placeholder.*?>)(?:\\s|<br>|<br />|  | |)</span>","gim");a=a.replace(c,"$1"+unescape("%u200B")+"</span>");for(var c=b.length,d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"font","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"b","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],
"");a=setCleanTagOrValue(a,"strong","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"i","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"em","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"strike","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"u","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"sup","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,
"sub","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");b="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>";c=new RegExp(b,"gim");return a=a.replace(c,"$1</span>")}function replaceEmptySpanTag(a){return a="1"==DEXTTOP.G_CURREDITOR._config.replaceEmptySpanTagInSetapiOnlyTable?a.replace(/<table [^>]+>([\s\S]*?)<\/table>/gim,function(a){return replaceEmptySpanTagEx(a)}):replaceEmptySpanTagEx(a)}
function replaceEmptySpanTagEx(a){return a.replace(RegExp("(<span[^>]*?>)(?:| |)</span>","gim"),"$1"+unescape("%u200B")+"</span>")}function setCleanTagOrValue(a,b,c){for(;;){var d,e;"span"==b?(d="<"+b+"></"+b+">",e="<"+b+" [^>]*></"+b+">"):(d="<"+b+">(?:\\s|<br>|<br />|  | |)</"+b+">",e="<"+b+" [^>]*>(?:\\s|<br>|<br />|  | |)</"+b+">");d=new RegExp(d,"gim");a=a.replace(d,c);e=new RegExp(e,"gim");a=a.replace(e,c);if(0==d.test(a)&&0==e.test(a))break}return a}
function getApplyDragResize(a){var b=!1;if("1"==a._config.dragResize&&!DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.mobile&&"1"==a._config.useAutoToolbar)if(0<a._config.dragResizeApplyBrowser.length)for(var c=a._config.dragResizeApplyBrowser.length,d=0,e;d<c;d++)switch(e=a._config.dragResizeApplyBrowser[d].toLowerCase(),e){case "ie":DEXTTOP.DEXT5.browser.ie&&7<=DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion&&(b=!0);break;case "edge":DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion&&
(b=!0);break;case "firefox":DEXTTOP.DEXT5.browser.gecko&&(b=!0);break;case "chrome":DEXTTOP.DEXT5.browser.chrome&&(b=!0);break;case "opera":DEXTTOP.DEXT5.browser.opera&&(b=!0);break;case "safari":DEXTTOP.DEXT5.browser.safari&&(b=!0)}else b=!0;a._config.useMouseTableInoutdent&&!DEXTTOP.DEXT5.browser.mobile&&(b=!0);return b}
function dext_src_init_once(a,b){rangy.init();_iframeWin=rangy.dom.getIframeWindow(a);_iframeDoc=rangy.dom.getIframeDocument(a);createTableResizeBar(_iframeDoc);if(getApplyDragResize(b))try{b.dext_dragresize&&b.dext_dragresize.remove(_iframeDoc),b.dext_dragresize=new DextDragResize,b.dext_dragresize.apply(_iframeDoc)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXTTOP.DEXT5.util.addEventEx(document,"keyup",_dextiframe_Keyup,!1);DEXTTOP.DEXT5.util.addEventEx(document,"keydown",
_dextiframe_Keydown,!1);DEXTTOP.DEXT5.util.addEventEx(window,"unload",_dextiframe_Unload);DEXTTOP.DEXT5.util.addEventEx(window,"beforeunload",_dextiframe_BeforeUnload);0==(DEXTTOP.DEXT5.browser.mobile&&"1"==b._config.useAutoToolbar&&DEXTTOP.DEXT5.browser.iOS)&&(DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mousedown",_iframeDoc_MouseDown,!0),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mouseup",_iframeDoc_MouseUp,!0),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mouseup",_iframeDoc_MouseUpMenu));DEXTTOP.DEXT5.util.addEvent(_iframeDoc,
"mousemove",_iframeDoc_MouseMove,!0);"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mouseout",_iframeDoc_MouseOut,!0);"1"!=b._config.contextMenuDisable&&DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"contextmenu",_iframeDoc_ContextMenu);DEXTTOP.DEXT5.util.addEventEx(document,"contextmenu",dext5ContextmenuEvt);DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"dblclick",_iframeDoc_DBClick);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"click",_iframeBody_Click);
DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keyup",_iframeDoc_Keyup);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keydown",_iframeDoc_Keydown);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keypress",_iframeDoc_Keypress);try{DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"input",_iframeDoc_input),DEXTTOP.DEXT5.util.addEvent(b._EDITOR.source,"input",_iframeDoc_input),DEXTTOP.DEXT5.util.addEvent(b._EDITOR.text,"input",_iframeDoc_input)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,
"paste",_iframeDoc_Paste);DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"beforepaste",_iframeDoc_BeforePaste);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"copy",_iframeDoc_Copy);DEXTTOP.DEXT5.util.addEventEx(document,"dragover",_iframeDoc_OnDropOver);"1"==b._config.dragAndDropAllow&&(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)||DEXTTOP.DEXT5.util.addEvent(_iframeWin,"dragover",_iframeDoc_OnDropOver);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"dragstart",_iframeDoc_DragStart);
DEXTTOP.DEXT5.util.addEvent(_iframeWin,"scroll",_iframeDoc_Scroll);DEXTTOP.DEXT5.browser.ie?(DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"blur",_iframeDoc_BlurHandler),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"focus",_iframeDoc_FocusHandler)):(DEXTTOP.DEXT5.util.addEvent(_iframeWin,"blur",_iframeDoc_BlurHandler),DEXTTOP.DEXT5.util.addEvent(_iframeWin,"focus",_iframeDoc_FocusHandler),DEXTTOP.DEXT5.util.addEvent(window,"blur",_window_blurHandler),DEXTTOP.DEXT5.util.addEvent(window,"focus",_window_focusHandler),
DEXTTOP.DEXT5.util.addEvent(b._EDITOR.source,"blur",_source_text_blurHandler),DEXTTOP.DEXT5.util.addEvent(b._EDITOR.text,"blur",_source_text_blurHandler),DEXTTOP.DEXT5.util.addEvent(b._EDITOR.source,"focus",_source_text_focusHandler),DEXTTOP.DEXT5.util.addEvent(b._EDITOR.text,"focus",_source_text_focusHandler));"0"==b._config.dragAndDropAllow||"view"==b._config.mode?(DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1}),DEXTTOP.DEXT5.util.addEventEx(document,
"drop",dext5DropEvt)):("1"==b._config.dragAndDropAllow&&0==DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"dragover",showFileDropArea),DEXTTOP.DEXT5.browser.gecko?1>DEXTTOP.G_CURREDITOR._config.imageQuality.quality&&"0"==DEXTTOP.G_CURREDITOR._config.plugInUse?(DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",insertDropImage_quality),DEXTTOP.DEXT5.util.addEventEx(document,"drop",insertDropImage_quality)):(DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",insertDropImage),DEXTTOP.DEXT5.util.addEventEx(document,
"drop",insertDropImage)):(DEXTTOP.DEXT5.browser.ie&&9<DEXTTOP.DEXT5.browser.ieVersion||0==DEXTTOP.DEXT5.browser.ie)&&"ieplugin"!=b._config.runtimes&&(1>DEXTTOP.G_CURREDITOR._config.imageQuality.quality&&"0"==DEXTTOP.G_CURREDITOR._config.plugInUse?(DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",insertDropImage_quality),DEXTTOP.DEXT5.util.addEventEx(document,"drop",insertDropImage_quality)):(DEXTTOP.DEXT5.util.addEventEx(document,"drop",insertDropImage),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",
insertDropImage))),"ieplugin"==b._config.runtimes&&(DEXTTOP.DEXT5.util.addEventEx(document,"drop",dropMousePosition),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",dropMousePosition)));if(("1"==b._config.view_mode_auto_height||"1"==b._config.view_mode_auto_width)&&"view"==b._config.mode){var e=document.getElementById("dext5_design_"+b.ID);DEXTTOP.DEXT5.util.addEventEx(e,"load",dext5LoadEvt)}DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&"1"==b._config.useAutoToolbar&&(DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,
"touchstart",_iframeDoc_MouseDown),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"touchmove",_iframeDoc_MouseMove),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"touchend",_iframeDoc_MouseUp),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"touchend",_iframeDoc_MouseUpMenu));DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.util.addEventEx(window.document.body,"keydown",dext5IEKeyDownEvt);"onselectionchange"in _iframeDoc&&DEXTTOP.DEXT5.util.addEventEx(_iframeDoc,"selectionchange",_iframeDoc_selectionchange);try{_iframeDoc.execCommand("MultipleSelection",
null,!0)}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("0"==DEXTTOP.G_CURREDITOR._config.autoUrlDetect)try{_iframeDoc.execCommand("AutoUrlDetect",!1,!1)}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(DEXTTOP.DEXT5.browser.gecko)try{_iframeDoc.execCommand("enableInlineTableEditing",!1,!1)}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(!isViewMode(b)){if("1"==b._config.defaultImemode&&(8>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks))try{var m=
_iframeDoc.createElement("input");m.style.width="100px";m.style.height="30px";m.type="text";m.style.display="none";m.style.imeMode="active";_iframeDoc.body.appendChild(m);m.focus();_iframeWin.focus();_iframeDoc.body.removeChild(m)}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}""!=b._config.tabIndexObjId?0==DEXTTOP.DEXT5.browser.ie&&setTimeout(function(){setBodyDefaultValue(b)},0):(!DEXTTOP.DEXT5.browser.ie||b._config.initFocus&&DEXTTOP.DEXT5.browser.ie)&&setTimeout(function(){setBodyDefaultValue(b);
onChange({editor:b})},0);setTimeout(function(){try{DEXTTOP.DEXT5.browser.ie?DEXTTOP.DEXT5.util.addEventEx(document.body,"focus",_dextiframe_Focus):DEXTTOP.DEXT5.util.addEventEx(window,"focus",_dextiframe_Focus)}catch(a){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},1E3)}onInitOnce({editor:b})}
function _dextiframe_Focus(a){setTimeout(function(){try{var b=getEditrFromEvent(a),c=document.activeElement;if(c&&1==c.nodeType&&-1<",a,button,".indexOf(","+c.tagName.toLowerCase()+",")){var d=b.isInitFocusHandler?!1:!0;"1"==b._config.tabSequenceMode&&(d=!0);if(0==d){1==b.isInitFocusHandler&&(b.isInitFocusHandler=!1);setFocusToBody();DEXTTOP.DEXT5.util.cancelEvent(a);DEXTTOP.DEXT5.util.stopEvent(a);if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){var e=document.getElementsByTagName("A");
0<e.length&&(e[0].className="")}checkDefaultMessage()}}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},0)}
function _iframeDoc_BeforePaste(a){setDEXTWINDOC();var b=getEditrFromEvent(a);if(isViewMode(b))DEXTTOP.DEXT5.util.cancelEvent(a);else if(a=a.target?a.target:a.srcElement,a=a.tagName?a.tagName.toLowerCase():null,!DEXTTOP.DEXT5.browser.ie||"textarea"!=a.toLowerCase()&&"input"!=a.toLowerCase())G_dext5plugIn||DEXTTOP.DEXT5.browser.ie&&"paste"!=G_LAST_CMD&&1==DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion&&setPasteBin()}
function setPasteBin(){try{if(DEXTTOP.DEXT5.browser.ie){DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID);var a=null,b=!1;DEXTTOP.G_CURREDITOR.setTextPaste&&"1"==DEXTTOP.G_CURREDITOR._config.pasteToTextMode&&(b=!0);a=b?document.createElement("textarea"):document.createElement("div");a.id="pasteDiv";var c=DEXTTOP.DEXT5.UserAgent;"10"==c.os.version&&"IE"==c.browser.name||0!=b||(a.innerHTML=unescape("%uFEFF"));a.style.position="absolute";a.style.filter="alpha(opacity=0)";a.style.overflow=
"hidden";DEXTTOP.DEXT5.browser.gecko?(a.style.left="0px",a.style.top="0px"):(a.style.left="-1000px",a.style.top="-1000px");DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion?(a.style.width="999px",a.style.height="999px"):(a.style.width="0px",a.style.height="0px");a.contentEditable=!0;a.onpaste=1>DEXTTOP.G_CURREDITOR._config.imageQuality.quality&&"0"==DEXTTOP.G_CURREDITOR._config.plugInUse?fn_PasteIE_quality:fn_PasteIE;document.body.appendChild(a);0==DEXTTOP.G_CURREDITOR.initPaste?document.body.focus():
DEXTTOP.G_CURREDITOR.initPaste=!1;a.focus();return!0}}catch(d){return!0}}
function setPasteBinForGecko(){if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion){DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID);var a=document.createElement("iframe");a.id="pasteIframe";a.frameBorder=0;a.style.width="0px";a.style.height="0px";a.style.position="absolute";a.style.left="0px";a.style.top="0px";if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)a.style.overflow="hidden",a.style.display="inline-block";var b="document.open();"+
(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",b=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";a.src=b;document.body.appendChild(a);a=getIframeDocument(a);a.open("text/html","replace");isCustomDomain(document)&&(a.domain=document.domain);a.write('<body contenteditable="true">'+unescape("%uFEFF")+"</body>");a.close();a.body.contentEditable=!0;a.body.onpaste=fn_PasteIE;a.body.focus()}}
function _iframeDoc_Paste(a){setDEXTWINDOC();var b=getEditrFromEvent(a);if("1"==b._config.useHtmlProcessByWorker){if(b.isPasting){DEXTTOP.DEXT5.util.cancelEvent(a);return}b.isPasting=!0}if(isViewMode(b))DEXTTOP.DEXT5.util.cancelEvent(a);else{if(DEXTTOP.DEXT5.browser.ie)return!0;var c=a.target?a.target:a.srcElement,c=c.tagName?c.tagName.toLowerCase():null;if("textarea"!=c.toLowerCase()&&"input"!=c.toLowerCase()){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
var c=!1,d="",e=!1;if(a&&a.clipboardData&&a.clipboardData.getData){for(var f=a.clipboardData.types,g=f.length,h=!1,m=!1,q=!1,t=0;t<g;t++){var u=f[t].toLowerCase();-1<u.indexOf("files")?h=!0:-1<u.indexOf("text/html")?m=!0:-1<u.indexOf("text/plain")&&(q=!0)}h&&(e=!0);if(m){d=a.clipboardData.getData("text/html");c=!0;try{var v=G_DEPlugin.wordchecking_seegene;v&&(v.util.clipboardData.text=a.clipboardData.getData("text/plain"))}catch(w){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else if(q&&
(d=a.clipboardData.getData("text/plain"),c=!0,v="",f=findUrlInText(d,DEXTTOP.G_CURREDITOR),""!=f.changedData&&(v=d,d=f.changedData),g=function(a){a="1"==DEXTTOP.G_CURREDITOR._config.pasteTextLineBreak?addLineBreaker("p",a,!0):DEXTTOP.DEXT5.util.escapeHtml(a);a=a.replace(/\t/g,DEXTTOP.G_CURREDITOR._config.tabSpace);a=a.replace(/ {2}/g,"&nbsp; ");a=a.replace(/  /g," &nbsp;");a=a.replace(/<br[ \/]*>\s/g,function(a){return a.replace(/> /g,">&nbsp;")});a=a.replace(/^ /,"&nbsp;");G_wordProcessorType="TEXT";
return a},d=g(d),""!=f.changedData)){f.changedData=d;try{d=replaceRealUrl(f)}catch(y){d=g(v)}}if(c)try{0>DEXTTOP.G_CURREDITOR._config.disableInsertImage.indexOf(",paste_image,")&&(v=function(a){var c=a.clipboardData.getData("text/rtf");b._config.clipImageHex=[];a=/\{\\pict[\s\S]+?\\bliptag\-?\d+(\\blipupi\-?\d+)?(\{\\\*\\blipuid\s?[\da-fA-F]+)?[\s\}]*?/;var d="";if(c=c.match(new RegExp("(?:("+a.source+"))([\\da-fA-F\\s]+)\\}","g")))for(var e=c.length,f=0;f<e;f++)if(a.test(c[f])){if(-1!==c[f].indexOf("\\pngblip"))d=
"image/png";else{if(-1===c[f].indexOf("\\jpegblip"))continue;d="image/jpeg"}b._config.clipImageHex.push({hex:d?c[f].replace(a,"").replace(/[^\da-fA-F]/g,""):null,type:d})}},RegExp("<img[^>]+file://[^>]+>","gi").test(d)?v(a):RegExp("<v:imagedata[^>]+file://[^>]+>","gi").test(d)&&v(a))}catch(x){b._config.clipImageHex=[]}0==DEXTTOP.DEXT5.browser.ie&&c&&""==d&&h&&(c=!1)}DEXTTOP.G_CURREDITOR.pasteEvt=a;DEXTTOP.G_CURREDITOR.clipData=d;DEXTTOP.G_CURREDITOR.bTextorHtmlData=c;DEXTTOP.G_CURREDITOR.clipImageBlob=
null;DEXTTOP.G_CURREDITOR.clipImageBeforePopup=null;DEXTTOP.G_CURREDITOR.hasClipSvgText=!1;if("1"==DEXTTOP.G_CURREDITOR._config.pasteToImage||"2"==DEXTTOP.G_CURREDITOR._config.pasteToImage){try{if(testCanvas=document.createElement("canvas"),"undefined"!=typeof testCanvas.toBlob)if(1==e){for(var z=[],B=a.clipboardData.items.length,t=0;t<B;t++)if(/image\//.test(a.clipboardData.items[t].type)){var D=a.clipboardData.items[t].getAsFile();D&&z.push(D)}if(0<z.length&&"1"==DEXTTOP.G_CURREDITOR._config.compatibility.autoResizePastedImage){for(var B=
a.clipboardData.items.length,A=!1,C=!1,t=0;t<B;t++)"image/svg+xml"==a.clipboardData.items[t].type?A=!0:"ppt/slides"==a.clipboardData.items[t].type&&(C=!0);A&&!1===C&&(DEXTTOP.G_CURREDITOR.hasClipSvgText=!0)}DEXTTOP.DEXT5.util.cancelEvent(a);if(1==z.length){DEXTTOP.G_CURREDITOR.clipImageBlob=z[0];if("usePasteToImage"==DEXTTOP.G_CURREDITOR.html5PasteImageType){DEXTTOP.G_CURREDITOR.html5PasteImageType="";command_pasteToImage(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.clipImageBlob);
return}if("usePasteToImageDetail"==DEXTTOP.G_CURREDITOR.html5PasteImageType){DEXTTOP.G_CURREDITOR.html5PasteImageType="";DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"pastetoimage");return}if(-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector){var E=DEXTTOP.G_CURREDITOR.clipImageBlob,H=E.name.split(".").pop(),M=function(){return function(a,b,c){0==c?setTimeout(function(){alert(dext5_lang.msg.message_file_ext_detect)},
10):DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"pastetoimage")}}();D5FileDetector(E,H,M)}else DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"pastetoimage")}else command_pasteHtml5(DEXTTOP.G_CURREDITOR)}else{if(("1"===_dext_editor._config.pasteToImage||"2"===_dext_editor._config.pasteToImage)&&"1"===_dext_editor._config.pasteToImageConvertHtmlToImage&&!0===m){DEXTTOP.DEXT5.util.cancelEvent(a);clipboardHtmlToImage({strData:_dext_editor.clipData,goDownload:!1,sizeFitToContents:!0},
function(a){a?(_dext_editor.clipImageBlob=a,_dext_editor._dextCommands(_dext_editor.ID,"pastetoimage")):command_pasteHtml5(DEXTTOP.G_CURREDITOR)});return}command_pasteHtml5(DEXTTOP.G_CURREDITOR)}else command_pasteHtml5(DEXTTOP.G_CURREDITOR)}catch(N){command_pasteHtml5(DEXTTOP.G_CURREDITOR)}testCanvas=void 0}else try{if(1==e){z=[];B=a.clipboardData.items.length;for(t=0;t<B;t++)/image\//.test(a.clipboardData.items[t].type)&&(D=a.clipboardData.items[t].getAsFile())&&z.push(D);if(0<z.length&&"1"==DEXTTOP.G_CURREDITOR._config.compatibility.autoResizePastedImage){B=
a.clipboardData.items.length;C=A=!1;for(t=0;t<B;t++)"image/svg+xml"==a.clipboardData.items[t].type?A=!0:"ppt/slides"==a.clipboardData.items[t].type&&(C=!0);A&&!1===C&&(DEXTTOP.G_CURREDITOR.hasClipSvgText=!0)}1==z.length?(DEXTTOP.G_CURREDITOR.clipImageBlob=z[0],"usePasteToImage"==DEXTTOP.G_CURREDITOR.html5PasteImageType?(DEXTTOP.G_CURREDITOR.html5PasteImageType="",command_pasteToImage(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.clipImageBlob)):"usePasteToImageDetail"==DEXTTOP.G_CURREDITOR.html5PasteImageType?
(DEXTTOP.G_CURREDITOR.html5PasteImageType="",DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"pastetoimage")):command_pasteHtml5(DEXTTOP.G_CURREDITOR)):command_pasteHtml5(DEXTTOP.G_CURREDITOR)}else command_pasteHtml5(DEXTTOP.G_CURREDITOR)}catch(I){command_pasteHtml5(DEXTTOP.G_CURREDITOR)}setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})},500)}}}
function _iframeDoc_Keypress(a){setDEXTWINDOC();var b="which"in a?a.which:a.keyCode;try{var c=getEditrFromEvent(a),d=c._config,e=a.target?a.target:a.srcElement,f=e.tagName?e.tagName.toLowerCase():null;if(!DEXTTOP.DEXT5.browser.ie||"textarea"!=f.toLowerCase()&&"input"!=f.toLowerCase()){if("1"!=d.formMode&&"1"==d.userTableLock.use){var g=getFirstRange().range.startContainer;3==g.nodeType&&(g=g.parentNode);var h=GetTDTHCell(g),m;h&&(m=GetParentbyTagName(g,"table"));var f=!0,q=d.userTableLock.defaultTableLockMode;
m&&("2"==d.userTableLock.tableLockMode?checkLockAttr(m,!0)||checkLockAttr(h,!0)?m.getAttribute("lock_mode")&&""!=m.getAttribute("lock_mode")&&(q=m.getAttribute("lock_mode")):q="0":m.getAttribute("lock_mode")&&""!=m.getAttribute("lock_mode")&&(q=m.getAttribute("lock_mode")));"1"==q?f=!1:"0"==q&&(f=!1,h=null);if(h){if(f&&checkLockAttr(m)){if(c.lastElemForLock)setFocusForLock(c.lastElemForLock);else{var t=findNoLockElem(m);t?setFocusForLock(t):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(event);
DEXTTOP.DEXT5.util.cancelEvent(event);return}if(checkLockAttr(h,!f)){c.lastElemForLock?setFocusForLock(c.lastElemForLock):setFocusForLock(findNoLockCell(m));DEXTTOP.DEXT5.util.stopEvent(event);DEXTTOP.DEXT5.util.cancelEvent(event);return}}}try{if(13==b&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion){var u=getFirstRange().range,v=getMyElementNode(u.startContainer);if(1==v.nodeType&&-1<",SPAN,U,I,STRONG,B,S,STRIKE,EM,SUP,SUB,".indexOf(","+
v.tagName+",")){var w=v.innerHTML.toLowerCase();""==w&&11>=DEXTTOP.DEXT5.browser.ieVersion?v.innerHTML=unescape("%u200B"):"<br>"!=w&&"<br/>"!=w&&"<br />"!=w||11!=DEXTTOP.DEXT5.browser.ieVersion||(v.innerHTML=unescape("%u200B"))}}}catch(y){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("1"==d.returnEvent.key_event){DEXTTOP.DEXT5.config.KeyEventCancel=!1;try{e=getFirstRange().range.startContainer,3==e.nodeType&&(e=e.parentNode),"function"===typeof DEXTTOP.G_CURREDITOR._config.event.key?
DEXTTOP.G_CURREDITOR._config.event.key("keypress",a,e,c.ID):"function"===typeof DEXTTOP.DEXTWIN.dext_key_event&&DEXTTOP.DEXTWIN.dext_key_event("keypress",a,e,c.ID)}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(1==DEXTTOP.DEXT5.config.KeyEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(""!=d.enterTag){var e=!1,z,B,D;D=d.enterTag;if(13==b){if(!a.shiftKey)if("undefined"!=typeof _iframeWin.getSelection){if(B=_iframeWin.getSelection(),B.getRangeAt&&B.rangeCount){z=B.getRangeAt(0);
z.deleteContents();var A=_iframeDoc.createElement(D);z.insertNode(A);z.setEndAfter(A);z.setStartAfter(A);z.collapse(!1);B.removeAllRanges();B.addRange(z);if(11<=DEXTTOP.DEXT5.browser.ieVersion||0==DEXTTOP.DEXT5.browser.ie){var C=A.nextSibling;if(null==C||3==C.nodeType&&""==C.nodeValue)A=_iframeDoc.createElement(D),z.insertNode(A),z.setEndBefore(A),z.setStartBefore(A),z.collapse(!1),B.removeAllRanges(),B.addRange(z)}var e=!0,E=A.nextSibling;1!=E.nodeType&&(E=E.parentElement);focusToElement(E)}}else"undefined"!=
typeof _iframeDoc.selection&&(B=_iframeDoc.selection,B.createRange&&(z=B.createRange(),"div"==D?(D=getDefaultParagraphValue(!0),pasteHtmlAtCaretHuge(A.outerHTML)):D="<"+D+" />",z.pasteHTML(D),z.collapse(!1),z.select(),e=!0));e&&DEXTTOP.DEXT5.util.cancelEvent(a)}}if("0"==c._config.removeEmptyTagReplaceDefaultParagraphValue&&13==b&&!a.shiftKey&&!a.ctrlKey){var H=getFirstRange().range.startContainer;3==H.nodeType&&(H=H.parentNode);""!=H.innerHTML&&H.innerHTML!=unescape("%u200B")||c.insertBrNodes.push(H)}try{var M=
G_DEPlugin.wordchecking_seegene;if(M)var N=M.onKeyPress({evt:a});!1===N&&DEXTTOP.DEXT5.util.cancelEvent(a)}catch(I){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}catch(S){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}var bCtrlKey=!1,startBookmark,endBookmark;
function _iframeDoc_Keydown(a){setDEXTWINDOC();var b="which"in a?a.which:a.keyCode;if(!checkDefaultMessage(a)){var c=getEditrFromEvent(a);if(1==c.setValueIsBusy)DEXTTOP.DEXT5.util.cancelEvent(a);else if("1"==c._config.disableUnnecessaryKeyEvt&&255==b&&"Unidentified"==a.key)DEXTTOP.DEXT5.util.cancelEvent(a);else if(isViewMode(c)){if(0==(9==b||38==b||40==b||37==b||39==b)){var d=!0;if(a.ctrlKey||a.metaKey){var e=c._config.viewModeAllowShortcut;switch(b){case 70:case 80:d=!1;break;case 67:-1<e.indexOf("copy")&&
(d=!1);break;case 65:-1<e.indexOf("select_all")&&(d=!1)}}d&&DEXTTOP.DEXT5.util.cancelEvent(a)}}else{var f;getApplyDragResize(c)&&c.dext_dragresize.G_dextResizeDiv&&(c.dext_dragresize.G_dextResize_elem&&(f=c.dext_dragresize.G_dextResize_elem),c.dext_dragresize.keyDown(a));try{G_KEY_IMG_COUNT=_iframeDoc.getElementsByTagName("img").length}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var h=a.target?a.target:a.srcElement,m=h.tagName?h.tagName.toLowerCase():null;if(0==checkContentEditable(c,
h)){d=!0;if(a.ctrlKey||a.metaKey)67==b&&(d=!1),70==b&&(d=!1),80==b&&(d=!1);d&&DEXTTOP.DEXT5.util.cancelEvent(a)}else{var q=!1;if("textarea"==m||"input"==m)q=!0;if(0==q&&"1"!=c._config.formMode&&"1"==c._config.userTableLock.use){var t=getFirstRange().range.startContainer;3==t.nodeType&&(t=t.parentNode);var u=GetTDTHCell(t),v;u&&(v=GetParentbyTagName(t,"table"));var w=c._config.userTableLock.defaultTableLockMode;v&&("2"==c._config.userTableLock.tableLockMode?checkLockAttr(v,!0)||checkLockAttr(u,!0)?
v.getAttribute("lock_mode")&&""!=v.getAttribute("lock_mode")&&(w=v.getAttribute("lock_mode")):w="0":v.getAttribute("lock_mode")&&""!=v.getAttribute("lock_mode")&&(w=v.getAttribute("lock_mode")));var y=!0;"1"==w?y=!1:"0"==w&&(y=!1,u=null);if(u){if(y&&checkLockAttr(v)){if(c.lastElemForLock)setFocusForLock(c.lastElemForLock);else{var x=findNoLockElem(v);x?setFocusForLock(x):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(u,
!y)){c.lastElemForLock?setFocusForLock(c.lastElemForLock):setFocusForLock(findNoLockCell(v));DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(8==b||46==b){for(var z=GetTableSelectionCells(),B=z.length,D=!1,A=0;A<B;A++)if(checkLockAttr(z[A],!y)){D=!0;break}if(D){DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}}}var C=a.target?a.target:a.srcElement,E=C.tagName?C.tagName.toLowerCase():null;if(DEXTTOP.DEXT5.browser.mobile&&13==b)if(DEXTTOP.DEXT5.browser.iOS)try{var H=
getFirstRange(),M=H.range,N=H.sel;if(1==M.collapsed){var I=M.startContainer;3==I.nodeType&&(I=I.parentNode);for(var S=!1;;)if("FONT"==I.tagName){S=!0;break}else if("P"==I.tagName||"BODY"==I.tagName)break;else I=I.parentNode;if(S){var F=_iframeDoc.createElement("span");for(I.parentNode.insertBefore(F,I);I.hasChildNodes();)F.appendChild(I.firstChild);I.getAttribute("color")&&""!=I.getAttribute("color")&&(F.style.color=I.getAttribute("color"));I.getAttribute("face")&&""!=I.getAttribute("face")&&(F.style.fontFamily=
I.getAttribute("face"));F.style.cssText=I.style.cssText;c.keydownStyleForIOS.currStyle=F.style.cssText;I.getAttribute("size")&&""!=I.getAttribute("size")&&(c.keydownStyleForIOS.fontSize=DEXTTOP.DEXT5.util.getStyle(I,"fontSize"),F.style.fontSize=c.keydownStyleForIOS.fontSize);N.removeAllRanges();I.parentNode.removeChild(I);N.addRange(M);var O=getFirstRange().range.startContainer,C=3==O.nodeType?O.parentNode:O,E=C.tagName.toLowerCase()}}}catch(P){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else if("android"==
DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase())try{var J=getFirstRange(),L;if(J.range.startContainer==J.range.endContainer&&J.range.startOffset==J.range.endOffset&&0==J.range.startOffset&&(L=J.range.startContainer,3==L.nodeType&&(L=L.parentNode),(L=GetParentbyTagName(L,"p",!0))&&_iframeDoc.body.firstChild==L)){var K=L.innerHTML.toLowerCase();if(""!=K&&"<br>"!=K&&"<br />"!=K){var W=rangy.createRange(_iframeDoc).getDocument().createTextNode(unescape("%u200B"));L.insertBefore(W,L.firstChild)}}}catch(G){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}"0"==c._config.removeEmptyTagReplaceDefaultParagraphValue&&(c.insertBrNodes=[]);"2"==c._config.olUlTagMode&&(0!=q||37!=b&&38!=b&&39!=b&&40!=b&&13!=b&&8!=b&&46!=b||adjustLiNodeForArrowKey("keydown",C,b,a));if("1"==c._config.returnEvent.key_event){DEXTTOP.DEXT5.config.KeyEventCancel=!1;try{C=getFirstRange().range.startContainer,3==C.nodeType&&(C=C.parentNode),"function"===typeof DEXTTOP.G_CURREDITOR._config.event.key?DEXTTOP.G_CURREDITOR._config.event.key("keydown",
a,C,c.ID):"function"===typeof DEXTTOP.DEXTWIN.dext_key_event&&DEXTTOP.DEXTWIN.dext_key_event("keydown",a,C,c.ID)}catch(Q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(1==DEXTTOP.DEXT5.config.KeyEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}try{var X=G_DEPlugin.mention;if(X)var ea=X.onKeyDown({evt:a});if(!1===ea){DEXTTOP.DEXT5.util.cancelEvent(a);return}}catch(V){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{var aa=G_DEPlugin.wordchecking_seegene;aa&&(ea=aa.onKeyDown({evt:a}));
if(!1===ea){DEXTTOP.DEXT5.util.cancelEvent(a);return}}catch(ga){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{if((aa=G_DEPlugin.customliststyle)&&(ea=aa.onKeyDown({evt:a})),!1===ea){DEXTTOP.DEXT5.util.cancelEvent(a);return}}catch(ba){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}-1<c.fixDEXTWINScroll.keyCodeArr.indexOf(b)&&(c.fixDEXTWINScroll.backupValue={top:DEXTTOP.DEXTWIN.pageYOffset||DEXTTOP.DEXTWIN.document.documentElement.scrollTop,left:DEXTTOP.DEXTWIN.pageXOffset||
DEXTTOP.DEXTWIN.document.documentElement.scrollLeft},DEXTTOP.DEXT5.util.addEventEx(DEXTTOP.DEXTWIN,"scroll",c.fixDEXTWINScroll.fn));if(DEXTTOP.DEXT5.browser.ie&&1==a.ctrlKey&&65==b)try{"undefined"!=typeof DEXTTOP.dialogArguments&&command_selectAll(c.ID,c)}catch(fa){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXTTOP.DEXT5.browser.gecko&&(J=getFirstRange().range,J.startContainer&&J.startContainer.tagName&&"BODY"==J.startContainer.tagName&&J.endContainer&&J.endContainer.tagName&&"BODY"==
J.endContainer.tagName&&J.endOffset==_iframeDoc.body.childNodes.length&&(a.ctrlKey&&86==b||!(0!=a.ctrlKey||0!=a.altKey||38==b||40==b||37==b||39==b||91<=b&&93>=b||33<=b&&36>=b||112<=b&&123>=b)&&(32<=b&&127>=b||0==b||13==b||9==b||190<=b&&192>=b||173==b||219<=b&&222>=b))&&(_iframeDoc.body.innerHTML="<p><br></p>",doSetCaretPosition(_iframeDoc.body.firstChild)));if(!E||"textarea"!=E&&"input"!=E&&"select"!=E)if("1"==c._config.disableKeydown&&8!=b&&46!=b)DEXTTOP.DEXT5.util.cancelEvent(a);else{if(0==a.ctrlKey&&
112<=b&&123>=b)return DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),!1;a.ctrlKey&&!a.altKey&&(d=nextTabKeyAccess(a,b))&&DEXTTOP.DEXT5.util.cancelEvent(a);if(d=setTableShortcut(a))return DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),!1;if(8==b){var ca=a.srcElement;if(ca){if(Mouse_Status==Mouse_IsControlSelecting&&1==ca.nodeType&&"IMG"==ca.tagName){DEXTTOP.DEXT5.util.cancelEvent(a);return}var ta=getFirstRange(),da=ta.range,na=ta.sel;if(na&&na.docSelection&&"Control"==
na.docSelection.type){DEXTTOP.DEXT5.util.cancelEvent(a);return}da&&"BODY"==da.startContainer.nodeName&&0<c.UndoManager.charCount&&c.UndoManager.putUndo()}}adjustIEEnterBug({keyCode:b,event:a});var Ja=c._config.undoMode;if("2"==Ja&&0==a.ctrlKey&&0==a.altKey){if(32==b||8==b)c.UndoManager.putUndo();else{var qa=getFirstRange().range,za=3==qa.startContainer.nodeType?qa.startContainer.parentNode:qa.startContainer,mb=3==qa.endContainer.nodeType?qa.endContainer.parentNode:qa.endContainer;c.UndoManager.tempSContainerText=
za.innerText||za.textContent;c.UndoManager.tempEContainerText=mb.innerText||mb.textContent}c.UndoManager.charCount=99}startBookmark=endBookmark=void 0;bCtrlKey=a.ctrlKey;var nb=229;DEXTTOP.DEXT5.browser.gecko&&(nb=0);"1"==Ja&&0==a.ctrlKey&&0==a.altKey&&0==c.UndoManager.arrImageHTML.length&&(32<=b&&127>=b||b==nb)?(c.UndoManager.putUndo(),c.UndoManager.charCount=0,c._iconEnable("")):8==b||46==b||a.shiftKey||1==a.ctrlKey||1==a.ctrlKey&&67==b?1==a.ctrlKey&&0==a.altKey&&0==a.shiftKey&&67==b&&0<GetTableSelectionCells().length&&
(command_tableCopy(c.ID,c),DEXTTOP.DEXT5.util.cancelEvent(a)):(ClearDraggingTableCellSelected(),ActiveCurrTable=null);0==a.shiftKey&&0==bCtrlKey&&9==b&&"1"!=c._config.EditorTabDisable&&(setTabkeyAction(),DEXTTOP.DEXT5.util.cancelEvent(a));a.shiftKey&&0==bCtrlKey&&9==b&&"1"!=c._config.EditorTabDisable&&(setShiftTabkeyAction(),DEXTTOP.DEXT5.util.cancelEvent(a));!DEXTTOP.DEXT5.browser.chrome||37!=b&&38!=b&&39!=b&&40!=b||setArrowKeyAction(37)&&DEXTTOP.DEXT5.util.cancelEvent(a);!DEXTTOP.DEXT5.browser.chrome&&
!DEXTTOP.DEXT5.browser.opera||39!=b&&37!=b&&38!=b||0!=a.ctrlKey||0!=a.altKey||0!=a.shiftKey||(da=getFirstRange().range,ca=null,da&&da.startContainer&&(ca=getMyElementNode(da.startContainer)),ca?(c.keydownNodeForTableCaret.tdNode=GetTDTHCell(ca),c.keydownNodeForTableCaret.backupRange=da.cloneRange()):(c.keydownNodeForTableCaret.tdNode=null,c.keydownNodeForTableCaret.backupRange=null));a.ctrlKey&&!a.altKey&&86==b&&0==c.UndoManager.arrImageHTML.length&&(c.UndoManager.putUndo(),c.UndoManager.charCount=
0,c._iconEnable(""));if(1==bCtrlKey&&0==a.altKey&&13==b&&(da=getFirstRange().range,ca=null,da&&da.startContainer&&(ca=getMyElementNode(da.startContainer)),ca)){var ra=GetTDTHCell(ca);if(null==ra&&"tr"==ca.tagName.toLowerCase()){var Ra=ca.cells.length;0<Ra&&(ra=ca.cells[Ra-1])}if(ra){var ub=GetParentbyTagName(ra,"tr");if(v=GetParentbyTagName(ra,"table")){var Ka=ra.cellIndex,vb=ub.cells.length,gb=ub.rowIndex,hb=v.rows.length;1==hb?0==Ka?insertPtagTableNear(!0,v):Ka==vb-1&&insertPtagTableNear(!1,v):
0==gb&&0==Ka?insertPtagTableNear(!0,v):(1<ra.rowSpan&&(gb+=ra.rowSpan-1),gb==hb-1&&Ka==vb-1&&insertPtagTableNear(!1,v));DEXTTOP.DEXT5.util.cancelEvent(a)}}}if(1==bCtrlKey)if(a.altKey&&191==b)c._dextCommands(c.ID,"about");else if(a.altKey&&220==b)c._dextCommands(c.ID,"symbol"),DEXTTOP.DEXT5.util.cancelEvent(a);else if(a.altKey&&48==b){DEXTTOP.DEXT5.util.cancelEvent(a);var ha="- DEXT5 Editor Information -\n  Client Ver. "+DEXTTOP.DEXT5.util.grvi("c"),ha=ha+("\n  Server Ver. "+DEXTTOP.DEXT5.util.grvi("s"));
if("ieplugin"==c._config.runtimes)try{ha+="\n  Client Cab Ver. "+G_dext5plugIn.getDext5PluginVersion()}catch(wb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}"string"===typeof DEXTTOP.DEXT5._nexacroCompVer&&(ha+="\n  Nexacro Module : "+DEXTTOP.DEXT5._nexacroCompVer);alert(ha)}else if(a.altKey&&57==b)c._config.useServerLicense||(DEXTTOP.DEXT5.util.cancelEvent(a),ha="DEXT5 Editor License Information",ha+="\n - Company : "+_0_[1],ha+="\n - System : "+_0_[2],ha+="\n - Domain : "+_0_[4],"0"!=
_0_[5]&&(ha+="\n - ExpireDate : "+_0_[5]),ha+="\n - User Count : "+_0_[6],alert(ha));else if(a.altKey&&80==b)try{G_dext5plugIn.SetLogLevel(1)}catch(Nb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else if(!a.altKey&&a.shiftKey&&67==b)DEXTTOP.DEXT5.util.cancelEvent(a),command_tableCopy(c.ID,c);else if(!a.altKey&&a.shiftKey&&86==b)DEXTTOP.DEXT5.util.cancelEvent(a),command_intablePaste(c.ID,c);else if(!a.altKey&&a.shiftKey&&(70==b||84==b))DEXTTOP.DEXT5.util.cancelEvent(a),command_tablePaste(c.ID,
c);else if(!a.altKey&&86==b){"paste"==G_LAST_CMD&&(G_LAST_CMD=null);if(G_dext5plugIn){DEXTTOP.DEXT5.util.cancelEvent(a);var U=G_dext5plugIn.getPasteHtml();if("3"==G_dext5plugIn.getHTMLFormatFromType&&"1"==c._config.removeTdStyleInPastePpt){for(var ma=RegExp("<(td|th)([^>]*?)style='([^']*?)(font-size: 18pt; )([^']*?)'>","gi");ma.test(U);)U=U.replace(ma,"<$1$2style='$3$5'>");for(ma=RegExp('<(td|th)([^>]*?)style="([^"]*?)(font-size: 18pt; )([^"]*?)">',"gi");ma.test(U);)U=U.replace(ma,'<$1$2style="$3$5">');
for(ma=RegExp("<(td|th)([^>]*?)style='([^']*?)(font-family: Arial; )([^']*?)'>","gi");ma.test(U);)U=U.replace(ma,"<$1$2style='$3$5'>");for(ma=RegExp('<(td|th)([^>]*?)style="([^"]*?)(font-family: Arial; )([^"]*?)">',"gi");ma.test(U);)U=U.replace(ma,'<$1$2style="$3$5">')}U=U.replace(/layout-flow:.*?;/gi,"");"1"==c._config.removeDummyFontTagInPaste&&6==G_dext5plugIn.getHTMLFormatFromType&&(c.hasFontNodeInPasteHtml=!1,-1<U.toLowerCase().indexOf("<font")&&(c.hasFontNodeInPasteHtml=!0));U=U.replace(RegExp('(text-underline.*?)(;|(?="))',
"gi"),"");"1"==c._config.paste_image_base64_remove&&(U=U.replace(/<img[^>]*src=["\']([^>]*:\\)([^>"\']+)["\']?[^>]*>/gi,""));if(100==G_dext5plugIn.getHTMLFormatFromType){var Sa="",Ea=findUrlInText(U,c);""!=Ea.changedData&&(Sa=U,U=Ea.changedData);U=adjustTextPasteForPlugin(U);if(""!=Ea.changedData){Ea.changedData=U;try{U=replaceRealUrl(Ea)}catch(Fa){U=Sa,U=adjustTextPasteForPlugin(U)}}}else{var Wa="";try{Wa=G_dext5plugIn.getDext5PluginVersion()}catch(ob){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&
RAONWIZDLW()}var Ga=!1;""!=Wa&&(Ga=DEXTTOP.DEXT5.util.compareVersion?0<=DEXTTOP.DEXT5.util.compareVersion(Wa,"5,0,0,9"):"5,0,0,9"<=Wa);Ga&&6!=G_dext5plugIn.getHTMLFormatFromType&&(U=U.replace(/\r\n/g,"\n"));"1"==c._config.removeHwpDummyTag&&(U=U.replace(/\&lt;!--\[if !supportEmptyParas\]--\&gt;/gi,""),U=U.replace(/\&lt;!--\[if !supportLists\]--\&gt;/gi,""),U=U.replace(/\&lt;!--\[endif\]--\&gt;/gi,""),U=U.replace(/\&lt;!\[if !supportEmptyParas\]\&gt;/gi,""),U=U.replace(/\&lt;!\[endif\]\&gt;/gi,""))}var Ha=
!1;if(G_dext5plugIn.getHTMLFormatFromType&&G_dext5plugIn.getPasteHtmlEx&&6==G_dext5plugIn.getHTMLFormatFromType&&(Ha=!0,DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion)){var ma=RegExp("<img[^>]*src=[\"']?([^>\"']+)[\"']?[^>]*>","gi"),pb=U.match(ma);if(pb)for(var Xa=pb.length,A=0;A<Xa;A++)if(-1<pb[A].indexOf("file://")){Ha=!1;break}}if(6==G_dext5plugIn.getHTMLFormatFromType&&DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion){var la=G_dext5plugIn.getPasteHtmlEx(),la=checkCopyInCellFormInertnNet(la);
""!=la&&(U=la,Ha=!1)}else 4==G_dext5plugIn.getHTMLFormatFromType&&(U=applyTableAlignInHwp(U));if(checkCanPasteToIamge())if("1"==c._config.pasteToImage||"2"==c._config.pasteToImage){var Ia=G_dext5plugIn.ShowImageSaveDlgFromClipboard("");try{if("HTML"==Ia&&"1"==c._config.limitPasteHtmlLength.value){var bb=c._config.limitPasteHtmlLength.length,La=G_dext5plugIn.getOriginalHtml("body");if(La.length>bb){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1);setFocusToBody();DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=
!1);return}}}catch(ia){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(""==Ia){DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1);return}""!=Ia&&"HTML"!=Ia&&(U=Ia,Ha=!1)}else{if("0"==c._config.pasteToImage&&"1"==c._config.limitPasteHtmlLength.value&&(bb=c._config.limitPasteHtmlLength.length,La=G_dext5plugIn.getOriginalHtml("body"),La.length>bb)){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1);setFocusToBody();DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=
!1);return}}else try{if("1"==c._config.limitPasteHtmlLength.value&&(bb=c._config.limitPasteHtmlLength.length,La=G_dext5plugIn.getOriginalHtml("body"),La.length>bb)){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2);setFocusToBody();DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1);return}}catch(Ma){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}"1"==c._config.ie_BugFixed_Hyfont&&(U=DEXTTOP.DEXT5.util.replaceHyFont(U,c));var U=replaceFontFamilyInHtml(U,c),Ya=!0;Ha&&(setPasteBin(),
c.isStopScroll=!0,(Ya=document.execCommand("paste",!1,null))?(Ya=!1,fn_PasteIE(),setTimeout(function(){c.isStopScroll=!1},1)):Ya=!0);if(Ya){var qb=!1;6==G_dext5plugIn.getHTMLFormatFromType&&(qb=!0);var Ca=document.createElement("div");Ca.innerHTML=U;var va=replaceSpanToDivContainAbsolute(Ca);va&&(U=Ca.innerHTML);if(-1<c._config.disableInsertImage.indexOf(",paste_image,")){for(var va=!1,xb=Ca.getElementsByTagName("img"),A=xb.length-1;0<=A;A--){var Ta=xb[A];Ta.src&&0==Ta.src.toLowerCase().indexOf("file:")&&
(va=!0,Ta.parentNode.removeChild(Ta))}va&&(U=Ca.innerHTML)}try{Ca.innerHTML="",Ca=null,delete Ca}catch(oa){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}U=execReplaceMsoStyle(U);"1"==c._config.useHtmlCorrection?"1"==c._config.useHtmlProcessByWorker?(showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:c._config,callFn:"htmlTagRevision",callFnParam:[U,!0,qb],callBackFn:fn_PastePlugin_htmlTagRevision_After})):
(U=htmlTagRevision(U,!0,qb),fn_PastePlugin_htmlTagRevision_After(U)):fn_PastePlugin_htmlTagRevision_After(U)}}DEXTTOP.DEXT5.browser.ie&&"12"<=DEXTTOP.DEXT5.browser.ieVersion&&setPasteBin()}else if(!a.altKey&&83==b){if("1"==c._config.setAutoSave.useManuallySaveShortcutKey)DEXTTOP.DEXT5.manuallyTempSave(c.ID);else{for(var cb=!1,Y=c.remove_item,wa=Y.length,A=0;A<wa;A++)if("save"==Y[A]){cb=!0;break}cb||command_saveAs("",c)}DEXTTOP.DEXT5.util.cancelEvent(a)}else{if(88==b){var pa=oneCellAndRowContentsDeleteAction(c,
b);pa&&(DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),c.UndoManager.putUndo(),c.UndoManager.charCount=0)}}else if(13==b){var yb=!1;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)yb=!0;if(yb&&!a.shiftKey)try{var db=getFirstRange().range.startContainer;3==db.nodeType&&(db=db.parentNode);for(var Db=c.checkEnterKeyTargetTagArr.length,A=0;A<Db;A++)if(GetParentbyTagName(db,c.checkEnterKeyTargetTagArr[A],!0)){c.isEnterKeyInTargetTag=!0;break}if(1==
c.isEnterKeyInTargetTag){var Za=db;if("DIV"==Za.tagName)c.changeDivTagArr.push(Za);else{for(var Na=Za;;){var eb=Na.tagName;if("BODY"==eb){Na=null;break}if(eb&&("LI"==eb||2==eb.length&&0==eb.indexOf("H")))break;else Na=Na.parentNode}null==Na&&(Za=GetParentbyTagName(Za,"div",!0))&&c.changeDivTagArr.push(Za)}}}catch(rb){c.isEnterKeyInTargetTag=!1,c.changeDivTagArr=[]}DEXTTOP.DEXT5.browser.ie&&setLineHeightForBgColor()}DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion&&moveRulerPosition(a);
try{if(229==b||"string"==typeof a.key&&0==a.ctrlKey&&1==a.key.length){var Eb=getFirstRange().range.startContainer,sb=GetTDTHCell(Eb);sb&&c.lastCellForUndoManager!=sb&&(c.lastCellForUndoManager=sb,c.UndoManager.putUndo(),c.UndoManager.charCount=0)}}catch(zb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(DEXTTOP.DEXT5.browser.ie&&13==b&&!bCtrlKey&&!a.altKey&&!a.shiftKey){var Oa=getFirstRange(),J=Oa.range;if(Oa.sel.isCollapsed&&3==J.startContainer.nodeType){var xa=getMyElementNode(J.startContainer);
"span"==xa.tagName.toLowerCase()&&xa.nextSibling&&null==xa.nextSibling.nextSibling&&1==xa.nextSibling.nodeType&&"br"==xa.nextSibling.tagName.toLowerCase()&&xa.nextSibling.removeNode(!0)}}if(1==bCtrlKey&&0==a.altKey&&89==b)c.UndoManager.execRedo(),DEXTTOP.DEXT5.util.cancelEvent(a);else if(1==bCtrlKey&&0==a.altKey&&90==b)getApplyDragResize(c)&&c.dext_dragresize.G_dextResize_elem&&c.dext_dragresize.resizeHandleClear(),"1"==c._config.undoMode&&0<c.UndoManager.charCount&&(c.UndoManager.putUndo(),c.UndoManager.charCount=
0),c.UndoManager.execUndo(),DEXTTOP.DEXT5.util.cancelEvent(a);else if(0==bCtrlKey&&13==b){var $a=!0;"1"==c._config.useUndoLightMode&&(isSelected()||($a=!1));$a&&(isSelected()&&setTimeout(function(){c.UndoManager.putUndo();c.UndoManager.charCount=0},1),c.UndoManager.putUndo(),c.UndoManager.charCount=0)}else if(0==bCtrlKey&&(46==b||8==b)){if(pa=oneCellAndRowContentsDeleteAction(c,b))DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),c.UndoManager.putUndo(),c.UndoManager.charCount=0;if(setDeleteKeyAction())return"1"==
c._config.allowDeleteCount?(c.UndoManager.charCount+=1,c.UndoManager.charCount>=G_PutUndoCharCount&&(c.UndoManager.putUndo(),c.UndoManager.charCount=0)):(c.UndoManager.putUndo(),c.UndoManager.charCount=0),DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),!0;if(46==b){var Aa=getFirstRange().range.startContainer;if(Aa&&Aa.nextElementSibling&&Aa.nextElementSibling.tagName&&-1<Aa.nextElementSibling.tagName.indexOf("DIAGONAL"))return f&&f.parentNode.removeChild(f),DEXTTOP.DEXT5.util.cancelEvent(a),
DEXTTOP.DEXT5.util.stopEvent(a),!0}}if(1!=deleteTableUsingKey(a,c)){if(0==bCtrlKey&&(46==b||8==b)){var Ua=getFirstRange().range.startContainer;3==Ua.nodeType&&(Ua=Ua.parentNode);!DEXTTOP.DEXT5.browser.ie||1!=Ua.childNodes.length||Ua.innerHTML!=unescape("%u200B")&&Ua.innerHTML!=unescape("%uFEFF")||(Ua.innerHTML="");if(!("0"==c._config.useHtmlCorrection&&DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion))try{var Aa=getFirstRange(),tb=Aa.range;if(tb.startContainer==tb.endContainer){var sa=
GetParentbyTagName(Ua,"p");if(sa)if(DEXTTOP.DEXT5.browser.ie){var Fb=Aa.sel;if(1==DEXTTOP.DEXT5.util.isEmptyContents(sa)){var ib=!1,Gb=!1;if(8==b&&sa.previousSibling){var ka=sa.previousSibling,Pa=null;if(1!=ka.nodeType||!ka.childNodes||0!=ka.childNodes.length)if(3==ka.nodeType)try{var Da=ka.nodeValue,Da=Da.replace(/\n/g,""),Da=Da.replace(/\r/g,""),Da=Da.replace(/\t/g,""),Da=Da.replace(/ /g,""),Da=Da.replace(/\s/g,"");if(""==Da)if(ka.previousSibling&&1==ka.previousSibling.nodeType)Pa=getMyChildElementNode(ka.previousSibling),
ka.parentNode.removeChild(ka);else{null==ka.previousSibling&&"BODY"==ka.parentNode.tagName&&(ka.parentNode.removeChild(ka),DEXTTOP.DEXT5.util.cancelEvent(a));return}else Pa=getMyChildElementNode(ka)}catch(Pb){return}else Pa=getMyChildElementNode(ka);null==Pa&&(Pa=ka,DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion&&a.srcElement&&"BODY"==a.srcElement.tagName&&(Gb=!0));"BR"==Pa.nodeName&&(Pa=ka);ib=!0;ka&&("HR"==ka.nodeName||"DIV"==ka.nodeName&&"DEXT_fiVe_Page_Break"==ka.className)&&(ib=
!1,fn_PrevOrNextNodeForkeyDownEvt(b,Aa,sa,!0)&&DEXTTOP.DEXT5.util.cancelEvent(a),Pa=ka.previousSibling);window.setTimeout(function(){doSetCaretPosition(Pa,1)},0)}else 46==b&&sa.nextSibling&&(ib=!0,"HR"==sa.nextSibling.nodeName&&(ib=!1,fn_PrevOrNextNodeForkeyDownEvt(b,Aa,sa,!0,11==DEXTTOP.DEXT5.browser.ieVersion)),"DIV"==sa.nextSibling.nodeName&&"DEXT_fiVe_Page_Break"==sa.nextSibling.className&&sa.nextSibling.parentNode.removeChild(sa.nextSibling));ib&&!Gb&&(Fb.removeAllRanges(),tb.selectNode(sa),
Fb.addRange(tb))}else fn_PrevOrNextNodeForkeyDownEvt(b,Aa,sa,!0)&&DEXTTOP.DEXT5.util.cancelEvent(a)}else 0==DEXTTOP.DEXT5.util.isEmptyContents(sa)&&fn_PrevOrNextNodeForkeyDownEvt(b,Aa,sa,!1)&&DEXTTOP.DEXT5.util.cancelEvent(a)}}catch(Qb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(DEXTTOP.DEXT5.browser.ie&&"1"==c._config.allowUnableToDeleteMsg){var da=getFirstRange().range,Ob=da.endContainer,Hb=GetParentbyTagName(da.startContainer,"table"),Ib=GetParentbyTagName(Ob,"table");(Hb||Ib)&&
Hb!=Ib&&alert(dext5_lang.msg.unable_to_delete)}"1"==c._config.allowDeleteCount?(c.UndoManager.charCount+=1,c.UndoManager.charCount>=G_PutUndoCharCount&&(c.UndoManager.putUndo(),c.UndoManager.charCount=0)):($a=!0,"1"==c._config.useUndoLightMode&&(isSelected()||($a=!1)),$a&&(isSelected()&&setTimeout(function(){c.UndoManager.putUndo();c.UndoManager.charCount=0},1),c.UndoManager.putUndo(),c.UndoManager.charCount=0));if(removePTagNearTable(b))return DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),
!0}"1"==Ja&&0==bCtrlKey&&(32<=b&&127>=b||b==nb)&&(0==c.UndoManager.index&&0<c.UndoManager.arrImageHTML.length?(c.UndoManager.arrImageHTML.length=1,c.UndoManager.charCount=0):c.UndoManager.index<c.UndoManager.arrImageHTML.length&&(c.UndoManager.arrImageHTML.length=c.UndoManager.index+1),32<b&&41>b||(c.UndoManager.charCount+=1),1==c.UndoManager.canRedo&&(c.UndoManager.canRedo=!1,c.UndoManager.canUndo=!0,c._iconEnable("")),c.UndoManager.charCount>=G_PutUndoCharCount&&(c.UndoManager.putUndo(),c.UndoManager.charCount=
0));!DEXTTOP.DEXT5.browser.ie||37!=b&&38!=b&&39!=b&&40!=b||setTableArrowKeyDownAction(a);if(1==c._config.adjustCursorInTable&&0==a.shiftKey&&0==a.ctrlKey&&0==a.altKey&&(38==b||40==b)){var J=getFirstRange().range,Ab=J.startContainer;if((ra=GetTDTHCell(Ab))&&0==isSelected()){var Va=!1,jb=!1,Bb=function(){try{var a=_iframeDoc.getElementsByTagName("dext_dummy");if(a)for(var b=a.length-1;0<=b;b--)a[b].parentNode.removeChild(a[b])}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};if(40==
b){t=Ab;if(1==t.nodeType&&0<t.childNodes.length){var Qa=t.childNodes[J.startOffset];if(0==!!Qa)for(A=J.startOffset-1;0<=A;A--){if(Qa=t.childNodes[A]){t=Qa;break}}else t=Qa}if(t.nodeType&&"BR"==t.tagName&&t.nextSibling){var kb=t.nextSibling;if(1==kb.nodeType&&"BR"==kb.tagName)null==kb.nextSibling?Va=!0:jb=!0;else if(3!=kb.nodeType||""!=kb.textContent.replace(/\s/g,""))jb=!0}if(0==jb&&0==Va){var Ba=_iframeDoc.createElement("dext_dummy");try{1==t.nodeType?t.nextSibling?t.parentNode.insertBefore(Ba,t.nextSibling):
t.parentNode.appendChild(Ba):3==t.nodeType&&J.insertNode(Ba)}catch(Rb){Bb()}try{var ja=ra.innerHTML.toLowerCase(),lb=ja.indexOf("</dext_dummy>");-1<lb&&(ja=ja.substring(lb+13),Ba.parentNode.removeChild(Ba),0==ja.indexOf("<br")&&(ja=ja.replace(/<br *([^>?+])*>/i,"")),ja=ja.replace(/<br *([^>?+])*><\//gi,"</"),0>ja.indexOf("<p")&&0>ja.indexOf("<br")&&0>ja.indexOf("<div")&&0>ja.indexOf("<table")&&(Va=!0))}catch(Sb){Va=!1}}}else if(38==b){t=Ab;if(1==t.nodeType&&0<t.childNodes.length)if(Qa=t.childNodes[J.startOffset],
0==!!Qa)for(A=J.startOffset-1;0<=A;A--){if(Qa=t.childNodes[A]){t=Qa;break}}else t=Qa;if(t.nodeType&&"BR"==t.tagName&&t.previousSibling){var Jb=t.previousSibling;1==Jb.nodeType&&"BR"==Jb.tagName&&(jb=!0)}if(0==jb&&0==Va){Ba=_iframeDoc.createElement("dext_dummy");try{1==t.nodeType?t.previousSibling?t.parentNode.insertBefore(Ba,t):t.parentNode.firstChild?t.parentNode.insertBefore(Ba,t.parentNode.firstChild):t.parentNode.appendChild(Ba):3==t.nodeType&&J.insertNode(Ba)}catch(Tb){Bb()}try{ja=ra.innerHTML.toLowerCase(),
lb=ja.indexOf("<dext_dummy>"),-1<lb&&(ja=ja.substring(0,lb),Ba.parentNode.removeChild(Ba),ja=ja.replace(/<br *([^>?+])*>$/i,""),ja=ja.replace(/<br *([^>?+])*><\//gi,"</"),0>ja.indexOf("</p")&&0>ja.indexOf("</div")&&0>ja.indexOf("</table")&&0>ja.indexOf("<br")&&(Va=!0))}catch(Ub){Va=!0}}}if(Va){DEXTTOP.DEXT5.util.cancelEvent(a);DEXTTOP.DEXT5.util.stopEvent(a);var Cb=getTopOrBottomBoundNextCell(ra,b);if(Cb.nextCell)if(40==b){for(var ua=Cb.nextCell;ua.firstChild;)if(ua.firstChild)ua=ua.firstChild;else break;
3==ua.nodeType?ua=ua.parentNode:1!=ua.nodeType||"BR"!=ua.tagName&&"IMG"!=ua.tagName||(ua=ua.parentNode);doSetCaretPosition(ua,0)}else 38==b&&(ua=Cb.nextCell,setFocusChildForStyle(ua,1,!0));else v=GetParentbyTagName(ra,"table"),40==b?v.nextSibling&&doSetCaretPosition(v.nextSibling,0):38==b&&v.previousSibling&&setFocusChildForStyle(v.previousSibling,1,!0)}Bb()}}if(32==b&&"1"==DEXTTOP.G_CURREDITOR.autoListUse)try{if(da=getFirstRange().range,1==da.collapsed&&(C=getMyElementNode(da.startContainer),C=GetParentbyTagName(C,
"p"))){var ab=function(b,d){DEXTTOP.DEXT5.util.cancelEvent(a);c.UndoManager.putUndo();var e=b.innerHTML.substring(0,b.innerHTML.indexOf("1.")),e=ReplaceAll(e,"&nbsp;",""),e=DEXTTOP.DEXT5.util.rtrim(DEXTTOP.DEXT5.util.ltrim(e)),e=e.replace(/>\s+</gi,"><"),e=e+b.innerHTML.substring(b.innerHTML.indexOf("1."),b.innerHTML.length);b.innerHTML=e;e=b;b.firstChild&&1==b.firstChild.nodeType&&(e=b.firstChild);doSetCaretPosition(e,0);try{for(var f=b.childNodes,g=f.length,h=0;h<g;h++)if(3==f[h].nodeType)if(0==
ReplaceAll(f[h].textContent.replace(/\s/g,""),unescape("%u200B"),"").length)f[h].textContent="";else{var m=d.replace(".","\\.").replace("*","\\*"),q=new RegExp(m,""),t=f[h].textContent.match(q);if(t&&0<t.length){f[h].textContent=f[h].textContent.replace(q,"");break}}doSetCaretPosition(e,0)}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},ya=C.innerText,fb=da.startContainer.nodeValue,fb=fb.substring(0,getFirstRange().range.startOffset),fb=DEXTTOP.DEXT5.util.ltrim(fb),ya=DEXTTOP.DEXT5.util.ltrim(ya),
ya=ya.substring(0,fb.length);if(fb==ya)switch(ReplaceAll(ya,unescape("%u200B"),"")){case "1.":ab(C,ya);command_insertOrderedList(c.ID,c);break;case "01.":ab(C,ya);command_listNumberBullets(c.ID,c,"N","decimal-leading-zero");break;case "i.":ab(C,ya);command_listNumberBullets(c.ID,c,"N","lower-roman");break;case "I.":ab(C,ya);command_listNumberBullets(c.ID,c,"N","upper-roman");break;case "a.":ab(C,ya);command_listNumberBullets(c.ID,c,"N","lower-alpha");break;case "A.":ab(C,ya);command_listNumberBullets(c.ID,
c,"N","upper-alpha");break;case "*":ab(C,ya),command_insertUnOrderedList(c.ID,c)}}}catch(Vb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}deleteOlUlUsingKey(a,c);removeEmptyTagByBackspace(a);putUndoWordCount(a);setTimeout(function(){bCtrlKey=!1},300);if(27==b){var Kb=DEXTTOP.document.getElementById("dext_context_background");Kb&&"none"!=Kb.style.display&&DEXT5_CONTEXT.hide()}var Lb=a.ctrlKey,Mb=a.altKey;setTimeout(function(){if(0==q){var a=getFirstRange().range.startContainer;3==a.nodeType&&
(a=a.parentNode);for(;a&&a.tagName&&-1<a.tagName.indexOf("DIAGONAL");)a=a.previousSibling;G_CURSOR_ELEMENT=a}a=!1;0==Lb&&0==Mb?a=8<=b&&13>=b||32==b||46<=b&&90>=b||96<=b&&111>=b||186<=b&&192>=b||219<=b&&222>=b||229==b:1==Lb&&0==Mb&&(a=66==b||68==b||69==b||72==b||73==b||76==b||85==b||86==b||88==b||89==b||90==b||222==b);onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:a});DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1)},10);"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&
c.isAOver.over&&!c.isAOver.linkStyle&&a.ctrlKey&&hyperLinkIn()}}}}}}
function _iframeDoc_input(a){setDEXTWINDOC();var b=getEditrFromEvent(a);if("1"==b._config.returnEvent.input_event){DEXTTOP.DEXT5.config.InputEventCancel=!1;var c,d=b.getEditorMode();"design"!=d?c=b._EDITOR[d]:(c=getFirstRange().range.startContainer,3==c.nodeType&&(c=c.parentNode));try{"function"==typeof b._config.event.input?b._config.event.input("input",a,c,b.ID):DEXTTOP.DEXTWIN.dext_input_event("input",a,c,b.ID)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(1==DEXTTOP.DEXT5.config.InputEventCancel)try{if("design"!=
d)null!=a.data&&a.data==c.value[c.selectionStart-1]&&(c.value=c.value.substring(0,c.selectionStart-1)+c.value.substring(c.selectionStart));else{var f=getFirstRange(),g=f.range,h=new RegExp(" "+a.data+"$","g");if(h.test(g.startContainer.data))g.startContainer.data=g.startContainer.data.replace(h,"\u00a0");else if(g.startContainer.data=g.startContainer.data.replace(new RegExp(a.data+"$","g"),""),0==getClientRect(g.startContainer.parentNode).height){g.setStart(g.startContainer,g.startContainer.length);
g.setEnd(g.endContainer,g.endContainer.length);var m=_iframeDoc.createElement("br");g.insertNode(m)}g.setStart(g.startContainer,g.startContainer.length);g.setEnd(g.endContainer,g.endContainer.length);f.sel.removeAllRanges();f.sel.addRange(g);b._LastRange=g}}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}try{var t=G_DEPlugin.mention;if(t)t.onInput({evt:a})}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function _iframeDoc_Copy(a){setDEXTWINDOC();var b=getEditrFromEvent(a),c=!0;try{for(var d in G_DEPlugin)if("function"===typeof G_DEPlugin[d].onBeforeCopy){var e=G_DEPlugin[d].onBeforeCopy({evt:a});if("boolean"===typeof e&&!1===e){c=!1;break}}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(!1===c)a.preventDefault();else if(c=DEXTTOP.G_CURREDITOR._config.replaceMsoStyle,d=c.settingStyle.length,0<d)try{for(var g=getFirstRange().range.toHtml(),e=0;e<d;e++){var h=getReplaceMsoStyleReg(c.settingStyle[e].replace("mso",
c.replaceAttributeName));reg_exp=new RegExp(h,"gi");if(reg_exp.test(g)){if(void 0==a.clipboardData){var m=0,q=0;if(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion)try{m=Math.max(_iframeDoc.documentElement.scrollLeft,_iframeDoc.body.scrollLeft),q=Math.max(_iframeDoc.documentElement.scrollTop,_iframeDoc.body.scrollTop)}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}var u=document.createElement("div");u.style.position="absolute";u.style.left="-5000px";u.style.top=q+"px";
u.id="dext_temp_copy_div_number";u.style.width="1px";u.style.height="1px";u.innerHTML=g;for(var v=0;v<d;v++)for(var w=c.settingStyle[e],y=u.querySelectorAll("span["+w.replace("mso",c.replaceAttributeName)+"]"),x=0;x<y.length;x++)if(y[x].parentNode){var z=y[x].outerHTML,B=z.substring(0,z.indexOf(">")+1),D=z.substring(z.indexOf(">")+1);if(!(-1<B.indexOf(w)))if(-1<B.indexOf("style")){var A=RegExp("(style=['\"])","gi");y[x].outerHTML=B.replace(A,"$1"+w+": "+DEXTTOP.G_CURREDITOR._config.replaceMsoStyle.styleValue[w]+
"; ")+D}else A=RegExp("(<span)","gi"),y[x].outerHTML=B.replace(A,'$1 style="'+w+": "+DEXTTOP.G_CURREDITOR._config.replaceMsoStyle.styleValue[w]+';"')+D}var C=u.getElementsByTagName("table")[0];ClearDraggingTable(C);void 0!=a.clipboardData?(a.clipboardData.setData("text/html",u.innerHTML),a.preventDefault()):setTimeout(function(){try{_iframeDoc.body.appendChild(u);var a=saveSelection(b.ID,!0),c=getFirstRange(),d=c.range,e=c.sel;d.setStartBefore(u.firstChild);d.setEndAfter(u.firstChild);e.removeAllRanges();
e.addRange(d);DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"copy",_iframeDoc_Copy);_iframeDoc.execCommand("copy");if(a){restoreSelection(a,!0);try{DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&_iframeWin.scroll(m,q)}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}u.parentNode.removeChild(u);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"copy",_iframeDoc_Copy)}catch(g){u&&u.parentNode&&u.parentNode.removeChild(u)}},0)}}}catch(E){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function fn_PrevOrNextNodeForkeyDownEvt(a,b,c,d,e){var f=b.range,g=b.sel;b=b.range.cloneRange();var h=!1;if(46==a)try{var m=f.getBoundingDocumentRect(),q=saveSelection(DEXTTOP.G_CURREDITOR.ID,!0);g.removeAllRanges();DEXTTOP.DEXT5.browser.ie?f.selectNode(c):f.selectNodeContents(c);1==e&&f.selectNodeContents(c);g.addRange(f);var t=f.getBoundingDocumentRect();restoreSelection(q,!0);0==Math.round(m.width)&&Math.round(m.left)==Math.round(m.right)&&Math.round(m.right)==Math.round(t.right)&&(h=!0)}catch(u){restoreSelection(b,
!0)}else 8==a&&0==f.startOffset&&0==f.endOffset&&(h=!0);if(h){G_KeyDownUpSync=d;var v;8==a&&c.previousSibling?v=c.previousSibling:46==a&&c.nextSibling&&(v=c.nextSibling);if(v)if(DEXTTOP.DEXT5.browser.ie&&1==DEXTTOP.DEXT5.util.isEmptyContents(v))v.innerHTML="";else if("FIGURE"==v.nodeName||"HR"==v.nodeName)DEXTTOP.DEXT5.browser.ie?(g.removeAllRanges(),f.selectNode(v),g.addRange(f)):"FIGURE"==v.nodeName&&v.parentNode.removeChild(v);else if("DIV"==v.nodeName&&"DEXT_fiVe_Page_Break"==v.className)return v.parentNode.removeChild(v),
!0}}
function fn_PastePlugin_htmlTagRevision_After(a){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();a=removeTagStyle(a);a=repairPasteTextInCell(a);0<a.length?(0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR._iconEnable("")),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?(a=DEXTTOP.DEXT5.util.officeCleanByDom(a,!0),showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,
gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:DEXTTOP.G_CURREDITOR._config,callFn:"DEXTTOP.DEXT5.util.officeClean",callFnParam:[a,!0],callBackFn:fn_PastePlugin_officeClean_After})):(a=DEXTTOP.DEXT5.util.officeClean(a,!0),fn_PastePlugin_officeClean_After(a),DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1))):"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?hideProcessingBackground():DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1)}
function fn_PastePlugin_officeClean_After(a){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();a=OfficePasteClean(a);G_dext5plugIn&&3!=G_dext5plugIn.getHTMLFormatFromType&&(a=DEXTTOP.DEXT5.util.emptyTagRemove(a));if("HWP"==getPasteFormatType()){for(var b=RegExp("(<p [^>]*)(background:#000000;)","gi");b.test(a);)a=a.replace(b,"$1");for(b=RegExp("(<p [^>]*)(background: rgb\\(0, 0, 0\\);)","gi");b.test(a);)a=a.replace(b,"$1")}a=IEPasteRemoveEmptyNodes(a);a=DEXTTOP.DEXT5.util.htmlRevision(a);
a=xssReplaceScript(null,a);a=adjustSizeInContainer({strHtml:a});a=getImageAutoFitForPasteHtml(a);if(0!=DEXTTOP.G_CURREDITOR._config.maxImageFileSize){b=document.createElement("div");b.innerHTML=a;for(var c=b.getElementsByTagName("img"),d=c.length,e=null,f=0,d=d-1;0<=d;d--)e=c[d],checkMaxImageFileSize(e.src)||(e.parentNode.removeChild(e),f++);0!=f&&(messageForMaxImageFileSize(f),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground());a=b.innerHTML;b=null;b=void 0}if(0!=
DEXTTOP.G_CURREDITOR._config.maxImageWidthSize||0!=DEXTTOP.G_CURREDITOR._config.maxImageHeightSize){b=document.createElement("div");b.innerHTML=a;c=b.getElementsByTagName("img");d=c.length;e=null;for(--d;0<=d;d--)e=c[d],DEXTTOP.G_CURREDITOR._FRAMEWIN.validateWidthHeight(DEXTTOP.G_CURREDITOR._config,e.style.width,e.style.height)&&(f=dext5_lang.msg.alert_exec_iamgesize,0!=DEXTTOP.G_CURREDITOR._config.maxImageWidthSize&&(f+=dext5_lang.msg.alert_width.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageWidthSize),
f+=" "),0!=DEXTTOP.G_CURREDITOR._config.maxImageHeightSize&&(f+=dext5_lang.msg.alert_height.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageHeightSize)),alert(f),e.parentNode.removeChild(e));a=b.innerHTML;b=null;b=void 0}if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&a&&""!=a&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount&&(b=getBase64ImageCountEx(a),0<b&&getBase64ImageCount()+b>parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,10))){var g=dext5_lang.msg.max_base64file_count,
g=g.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount);alert(g);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}a=removeEditorAttribute(a);"1"==DEXTTOP.G_CURREDITOR._config.removeAppleInterchangeNewlineBr&&(a=a.replace(/<br class="Apple-interchange-newline">/gi,""));"1"==DEXTTOP.G_CURREDITOR._config.compatibility.dingBatCharPaste&&(a=dingBatFont(a,DEXTTOP.G_CURREDITOR));try{for(var h in G_DEPlugin)if("function"===typeof G_DEPlugin[h].onBeforePaste){var m=
G_DEPlugin[h].onBeforePaste({html:a});if("string"==typeof m)a=m;else if(!1===m)return}}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{if("function"===typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event||"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste){h=a;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste?h=DEXTTOP.G_CURREDITOR._config.event.beforePaste(a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event&&(h=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(a))}catch(t){h=
a}if(h)a=h;else if(0==h||""==h){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}pasteWordCount(a)?(-1<a.indexOf("dext5customdata")&&(a=checkExistCustomData(a)),a=externalPageBreakDataRaplaceInEditor(a),m=GetTableSelectionCells(),h=document.createElement("div"),h.innerHTML=a,h=h.childNodes,1==h.length&&h[0].tagName&&"table"==h[0].tagName.toLowerCase()&&0<m.length?(0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&
DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),command_tablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,h[0]),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0):(m=!1,"1"==DEXTTOP.G_CURREDITOR._config.useTablePasteDialog&&(b=getFirstRange().range,g=null,b.startContainer==b.endContainer&&(g=b.startContainer,3==g.nodeType&&(g=g.parentNode),g=GetTDTHCell(g)),g&&1==h.length&&h[0].tagName&&"table"==h[0].tagName.toLowerCase()&&(m=!0)),m?(DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode=
h[0],DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml=a,DEXTTOP.G_CURREDITOR.pasteTableParam.currCellNode=g,DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode=GetParentbyTagName(g,"table"),DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.paste_table)):setTimeout(function(){pasteHtmlAtCaretHuge(a,!1,!1,!0)},0)),checkPasteImage(a),0>a.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),
ReplaceRealObjectToImage(!1),ClearDraggingTableAllTable()),"base64"!=DEXTTOP.G_CURREDITOR._config.uploadMethod&&base64imageToLocalFile(_iframeDoc),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground(),window.setTimeout(function(){try{contentChangeEventWrapper(),onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}catch(a){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},500)):"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}
function removePTagNearTable(a){var b=!1;try{var c=getFirstRange().range;if(0==c.collapsed)return b;var d=null;c&&c.startContainer&&(d=getMyElementNode(c.startContainer));if(d&&1==d.nodeType){var e=d.innerHTML;if(""==e||"<br>"==e||"<br/>"==e||"<br />"==e)if(46==a?nearElem=d.nextSibling:8==a&&(nearElem=d.previousSibling),nearElem&&1==nearElem.nodeType&&("table"==nearElem.tagName.toLowerCase()||"blockquote"==nearElem.tagName.toLowerCase())){if(46==a)"table"==nearElem.tagName.toLowerCase()?doSetCaretPosition(nearElem.rows[0].cells[0],
0):doSetCaretPosition(nearElem,0);else if(8==a)if("table"==nearElem.tagName.toLowerCase()){var f=nearElem.rows.length;doSetCaretPosition(nearElem.rows[f-1].cells[nearElem.rows[f-1].cells.length-1],0)}else{var g=nearElem.childNodes[nearElem.childNodes.length-1];g||(g=nearElem);doSetCaretPosition(g,1)}d.innerHTML="";d.parentNode.removeChild(d);b=!0}}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return b}
function setPasteCellData(a){var b=getFirstRange().range,c=null;if(b&&b.startContainer){if(c=DrageStartCell){var d=GetTDTHCell(c);if(d){if(null==DEXTTOP.G_COPIEDCELLDATA)return!1;for(var e=GetParentbyTagName(d,"tr"),b=GetParentbyTagName(d,"table"),d=d.cellIndex,e=e.rowIndex,f,g=DEXTTOP.G_COPIEDCELLDATA.length,h=0,m=0;m<g&&void 0!=b.rows[e+m];m++){for(var h=DEXTTOP.G_COPIEDCELLDATA[m].length,q=0;q<h&&!(h>b.rows[e+m].cells.length);q++){var t=b.rows[e+m].cells[d+q];if(void 0!=t){var u=document.createElement("td");
u.innerHTML=DEXTTOP.G_COPIEDCELLDATA[m][q];a.copiedText&&a.copiedText[m]&&a.copiedText[m][q]&&(u.innerHTML=a.copiedText[m][q]);var v=f=!1,w,y;if("1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal){var x=findDiagonal(t,!0);x&&0<x.diagonalUp.length&&(w=x.diagonalUp[0].style.borderTop,f=!0);x&&0<x.diagonalDown.length&&(y=x.diagonalDown[0].style.borderTop,v=!0);(f||v)&&deleteDiagonalLine(t,null,DEXTTOP.G_CURREDITOR);findDiagonal(u)&&deleteDiagonalLine(u,null,DEXTTOP.G_CURREDITOR)}t.innerHTML=
u.innerHTML;if(a.copiedCellFormat&&a.copiedCellFormat[m]&&a.copiedCellFormat[m][q]){var u=a.copiedCellFormat[m][q],z;for(z in u)t.style[z]=u[z]}f&&G_DEXT_Diagonal.makeDiagonal(t,"up",w);v&&G_DEXT_Diagonal.makeDiagonal(t,"down",y);f=t}}try{if(b.rows[e+(m+1)])for(var B=b.rows[e+(m+1)].cells,h=0;h<=B.length;h++){var D=getClientRect(B[h]),A=getClientRect(c);if(D.left<=A.left&&D.right>A.left){d=B[h].cellIndex;break}}}catch(C){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}null!=f&&(doSetCaretPosition(f.childNodes[0],
1),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&"&nbsp;"==f.innerHTML&&(f.innerHTML=""))}else{if(null==DEXTTOP.G_COPIEDTABLE)return!1;a=DEXTTOP.G_COPIEDTABLE.outerHTML;0==DEXTTOP.DEXT5.browser.gecko&&(a=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?a+"<p></p>":a+getDefaultParagraphValue(!0));pasteHtmlAtCaretHuge(a)}}else{if(null==DEXTTOP.G_COPIEDTABLE)return!1;restoreSelection();setFocusToBody();b=getFirstRange().range;getMyElementNode(b.startContainer);a=DEXTTOP.G_COPIEDTABLE.outerHTML;
0==DEXTTOP.DEXT5.browser.gecko&&(a=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?a+"<p></p>":a+getDefaultParagraphValue(!0));pasteHtmlAtCaretHuge(a)}return!0}return!1}function getEnterTagString(a){var b="",b=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?"&nbsp;":"<br />",c="";"br"==a?c="<br />":"p"==a?c="<p>"+b+"</p>":"div"==a&&(c="<div>"+b+"</div>");return c}
function _iframeDoc_Keyup(a){setDEXTWINDOC();var b=getEditrFromEvent(a);if(isViewMode(b)||b.dextiframeKeydown)b.dextiframeKeydown=!1,DEXTTOP.DEXT5.util.cancelEvent(a);else{var c="which"in a?a.which:a.keyCode,d=a.target?a.target:a.srcElement,e=d.tagName?d.tagName.toLowerCase():null;"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&(b.isAOver.openHelp&&17!=c?hyperHelpClose():b.isAOver.over&&(b.isAOver.node||b.isAOver.nodeChild)&&b.isAOver.linkStyle&&hyperLinkOut());if(0==checkContentEditable(b,
d)){var f=!0;if(a.ctrlKey||a.metaKey)67==c&&(f=!1),70==c&&(f=!1),80==c&&(f=!1);f&&DEXTTOP.DEXT5.util.cancelEvent(a)}else{var g=!1;if("textarea"==e||"input"==e)g=!0;if(0==g){var h=getFirstRange(),m=h.range.startContainer;3==m.nodeType&&(m=m.parentNode);for(;m&&m.tagName&&-1<m.tagName.indexOf("DIAGONAL");)m=m.previousSibling;G_CURSOR_ELEMENT=m;set_ruler_vertical_height(b);set_ruler_horizontal_width(b);try{if(m&&1==m.nodeType&&"hr"==m.tagName.toLowerCase()&&!a.shiftKey&&!a.ctrlKey){var q=m;if(37==c){for(;q&&
(1!=q.nodeType||"hr"==q.tagName.toLowerCase());){if(3==q.nodeType){q=q.parentNode;break}if(!q.previousSibling){var t=_iframeDoc.createElement("p");if(DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion)t.innerHTML="&nbsp;";else{var u=_iframeDoc.createElement("br");t.appendChild(u)}q.parentNode.insertBefore(t,q)}q=q.previousSibling}if(q){if(q&&"table"==q.tagName.toLowerCase())var v=q.rows,w=v[v.length-1].cells,y=w[w.length-1],q=y.lastChild;else if("ul"==q.tagName.toLowerCase()||"ol"==q.tagName.toLowerCase())q=
q.lastChild;if(q.lastChild&&1==q.lastChild.nodeType&&"br"==q.lastChild.tagName.toLowerCase()){for(var x=q.lastChild.previousSibling;x;)if(1==x.nodeType&&"br"==x.tagName.toLowerCase())x=x.previousSibling;else break;x?x&&1==x.nodeType?q=x:x&&3==x.nodeType&&(q=x):(doSetCaretPosition(q,0),m=q,q=null)}q&&(doSetCaretPosition(q,1),m=q)}}else if(39==c){for(;q&&(1!=q.nodeType||"hr"==q.tagName.toLowerCase());){if(3==q.nodeType){q=q.parentNode;break}q.nextSibling||(t=_iframeDoc.createElement("p"),DEXTTOP.DEXT5.browser.ie&&
11>DEXTTOP.DEXT5.browser.ieVersion?t.innerHTML="&nbsp;":(u=_iframeDoc.createElement("br"),t.appendChild(u)),q.parentNode.appendChild(t));q=q.nextSibling}if(q){if("table"==q.tagName.toLowerCase())v=q.rows,w=v[0].cells,y=w[0],q=y.firstChild;else if("ul"==q.tagName.toLowerCase()||"ol"==q.tagName.toLowerCase())q=q.firstChild;doSetCaretPosition(q,0);m=q}}}}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}if(0==g&&"1"!=b._config.formMode&&"1"==b._config.userTableLock.use){h=getFirstRange();
m=h.range.startContainer;3==m.nodeType&&(m=m.parentNode);var B=GetTDTHCell(m),D;B&&(D=GetParentbyTagName(m,"table"));var A=b._config.userTableLock.defaultTableLockMode;D&&("2"==b._config.userTableLock.tableLockMode?checkLockAttr(D,!0)||checkLockAttr(B,!0)?D.getAttribute("lock_mode")&&""!=D.getAttribute("lock_mode")&&(A=D.getAttribute("lock_mode")):A="0":D.getAttribute("lock_mode")&&""!=D.getAttribute("lock_mode")&&(A=D.getAttribute("lock_mode")));var C=!0;"1"==A?C=!1:"0"==A&&(C=!1,B=null);if(B){if(C&&
checkLockAttr(D)){if(b.lastElemForLock)setFocusForLock(b.lastElemForLock);else{var E=findNoLockElem(D);E?setFocusForLock(E):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(B,!C)){var H=c;if(229==H){var M=a.code?a.code.toLowerCase():"";if(-1<M.indexOf("tab"))H=9;else if(-1<M.indexOf("arrow"))switch(M=M.split("arrow"),M[1]){case "up":H=38;break;case "down":H=40;break;case "right":H=39;break;case "left":H=37}}var N=!1;if(9==
H&&0==a.shiftKey||40==H||39==H)N=!0;var I=null;switch(H){case 9:I=findNextNoLockCell(B,N,A);break;case 37:case 39:0==a.shiftKey&&(I=findNextNoLockCell(B,N,A));break;case 38:case 40:0==a.shiftKey&&(I=findNextNoLockCell(B,N,A,H))}I&&(b.lastElemForLock=I);b.lastElemForLock?N?setFocusForLock(b.lastElemForLock):setFocusChildForStyle(b.lastElemForLock,1,!0):setFocusForLock(findNoLockCell(D));DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}b.lastElemForLock=B}else"0"!=A&&checkLockElemInSelectionRange()}var S=
a.target?a.target:a.srcElement,F=S.tagName?S.tagName.toLowerCase():null;if(DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&13==c)try{var O=getFirstRange(),P=O.range,J=O.sel,L=P.startContainer;3==L.nodeType&&(L=L.parentNode);if("SPAN"==L.tagName&&L.firstChild&&1==L.firstChild.nodeType&&"BR"==L.firstChild.tagName){L.removeChild(L.firstChild);var K=rangy.createRange(_iframeDoc).getDocument().createTextNode(unescape("%uFEFF"));L.appendChild(K);doSetCaretPosition(L,1)}for(var W=!1;;)if("FONT"==
L.tagName){W=!0;break}else if("P"==L.tagName||"BODY"==L.tagName)break;else L=L.parentNode;if(W){var G=_iframeDoc.createElement("span");for(L.parentNode.insertBefore(G,L);L.hasChildNodes();)G.appendChild(L.firstChild);L.getAttribute("color")&&""!=L.getAttribute("color")&&(G.style.color=L.getAttribute("color"));L.getAttribute("face")&&""!=L.getAttribute("face")&&(G.style.fontFamily=L.getAttribute("face"));L.getAttribute("size")&&""!=L.getAttribute("size")&&(G.style.fontSize=b.keydownStyleForIOS.fontSize);
null!=b.keydownStyleForIOS.currStyle&&(G.style.cssText=b.keydownStyleForIOS.currStyle);J.removeAllRanges();L.parentNode.removeChild(L);J.addRange(P);var Q=getFirstRange().range.startContainer,S=3==Q.nodeType?Q.parentNode:Q,F=S.tagName.toLowerCase()}b.keydownStyleForIOS.currStyle=null;b.keydownStyleForIOS.fontSize=""}catch(X){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var ea=!1;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)ea=!0;if(ea&&13==
c&&!a.shiftKey&&b.isEnterKeyInTargetTag){b.isEnterKeyInTargetTag=!1;try{var V=getFirstRange().range.startContainer;3==V.nodeType&&(V=V.parentNode);var aa=V,ga=!1;if("DIV"==aa.tagName)ga=!0;else{for(var ba=aa;;){var fa=ba.tagName;if("BODY"==fa){ba=null;break}if(fa&&("LI"==fa||2==fa.length&&0==fa.indexOf("H")))break;else ba=ba.parentNode}if(null==ba){var ca=GetParentbyTagName(aa,"div",!0);ca&&(ga=!0,aa=ca)}}if(ga){var ta=b.changeDivTagArr.length;if(0<ta){for(var da=ta-1;0<=da;da--){var na=_iframeDoc.createElement("p"),
Ja=b.changeDivTagArr[da];setCopyAllObjectAtributes(Ja,na,!0);Ja.parentNode.replaceChild(na,Ja)}b.changeDivTagArr=[]}makeRangeSelectionMarkInDesign();var qa=_iframeDoc.createElement("p"),za=aa;setCopyAllObjectAtributes(za,qa,!0);za.parentNode.replaceChild(qa,za);setRangeSelectionMarkInDesign(!0)}}catch(mb){setRangeSelectionMarkInDesign(!0),b.isEnterKeyInTargetTag=!1,b.changeDivTagArr=[]}}if("1"==b._config.returnEvent.key_event){DEXTTOP.DEXT5.config.KeyEventCancel=!1;try{S=getFirstRange().range.startContainer,
3==S.nodeType&&(S=S.parentNode),"function"===typeof DEXTTOP.G_CURREDITOR._config.event.key?DEXTTOP.G_CURREDITOR._config.event.key("keyup",a,S,b.ID):"function"===typeof DEXTTOP.DEXTWIN.dext_key_event&&DEXTTOP.DEXTWIN.dext_key_event("keyup",a,S,b.ID)}catch(nb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(1==DEXTTOP.DEXT5.config.KeyEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(F&&("textarea"==F||"input"==F||"select"==F))return!1;try{var ra=G_DEPlugin.mention;if(ra)var Ra=ra.onKeyUp({evt:a});
if(!1===Ra){DEXTTOP.DEXT5.util.cancelEvent(a);return}}catch(ub){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{var Ka=G_DEPlugin.wordchecking_seegene;Ka&&(Ra=Ka.onKeyUp({evt:a}));if(!1===Ra){DEXTTOP.DEXT5.util.cancelEvent(a);return}}catch(vb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{if((Ka=G_DEPlugin.customliststyle)&&(Ra=Ka.onKeyUp({evt:a})),!1===Ra){DEXTTOP.DEXT5.util.cancelEvent(a);return}}catch(gb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("0"==
b._config.removeEmptyTagReplaceDefaultParagraphValue&&13==c&&!a.shiftKey&&!a.ctrlKey){var hb=getFirstRange().range,ha=hb.startContainer;3==ha.nodeType&&(ha=ha.parentNode);var wb=b.insertBrNodes?b.insertBrNodes.length:0;if(0<wb){try{for(da=0;da<wb;da++)b.insertBrNodes[da].innerHTML=DEXTTOP.DEXT5.browser.ie&&10>=DEXTTOP.DEXT5.browser.ieVersion?"&nbsp;":"<br>"}catch(Nb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}b.insertBrNodes=[]}""==ha.innerHTML&&(ha.innerHTML=DEXTTOP.DEXT5.browser.ie&&
10>=DEXTTOP.DEXT5.browser.ieVersion?"&nbsp;":"<br>",hb.collapse(!1))}if(8==c||46==c||DEXTTOP.DEXT5.browser.gecko&&a.ctrlKey&&88==c){if(3>_iframeDoc.body.childNodes.length){var U=_iframeDoc.body.innerHTML;if(""==U||"<br>"==U||"<div><br></div>"==U)_iframeDoc.body.innerHTML="",setBodyDefaultValue()}if(G_KeyDownUpSync&&DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion)try{G_KeyDownUpSync=!1;var ma=getFirstRange().range,V=getMyElementNode(ma.startContainer);if("SPAN"==V.nodeName){var Sa=V.style.cssText,
Ea;if(V.nextSibling){var Fa=V.nextSibling;if(("SPAN"==Fa.nodeName||"FONT"==Fa.nodeName)&&""==Fa.className&&""==Fa.id&&null==Fa.nextSibling&&(Ha=Fa.style.cssText,-1<Sa.indexOf(Ha))){for(Ea=saveSelection(b.ID);0<Fa.childNodes.length;)V.appendChild(Fa.childNodes[0]);DEXTTOP.DEXT5.util.removeElement(Fa);restoreSelection(Ea)}}else if(V.childNodes){var Wa=!1;Ea=saveSelection(b.ID);for(var ob=V.childNodes.length-1,Ga,Ha;0<=ob;ob--)Ga=V.childNodes[ob],"SPAN"!=Ga.nodeName&&"FONT"!=Ga.nodeName||""!=Ga.className||
""!=Ga.id||(Ha=Ga.style.cssText,-1<Sa.indexOf(Ha)&&(DEXTTOP.DEXT5.util.removeElement(Ga),Wa=!0));Wa&&restoreSelection(Ea)}}}catch(pb){G_KeyDownUpSync=!1}}if(!a.ctrlKey&&!bCtrlKey||a.altKey){if(46==c||8==c)removeEmptyTagByBackspace(a),_iframeDoc_MouseUpMenu(a),DEXTTOP.G_SELECTED_ELEMENT=null;if(!a.shiftKey&&13==c&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion){setLineHeightForBgColor();try{if(ma=getFirstRange().range,V=getMyElementNode(ma.startContainer),
1==V.nodeType&&-1<",SPAN,U,I,STRONG,B,S,STRIKE,EM,SUP,SUB,".indexOf(","+V.tagName+",")){var Xa=V.innerHTML.toLowerCase();if(""==Xa&&11>=DEXTTOP.DEXT5.browser.ieVersion)V.innerHTML=unescape("%u200B");else if(("<br>"==Xa||"<br/>"==Xa||"<br />"==Xa)&&11==DEXTTOP.DEXT5.browser.ieVersion)"1"==b._config.removeEmptyTagReplaceDefaultParagraphValue&&(V.innerHTML=unescape("%u200B"));else if(""!=Xa&&"SPAN"==V.nodeName&&(Sa=V.style.cssText,V.childNodes&&3>=V.childNodes.length&&(1!=V.childNodes.length||"#text"!=
V.childNodes[0].nodeName))){var la=V.childNodes,Ia=null;"SPAN"!=la[0].nodeName&&"FONT"!=la[0].nodeName||""!=la[0].className||""!=la[0].id?"#text"==la[0].nodeName&&("SPAN"!=la[1].nodeName&&"FONT"!=la[1].nodeName||""!=la[1].className||""!=la[1].id?2==la.length&&"BR"==la[1].nodeName&&la[1].parentNode.removeChild(la[1]):(_currFCStyle=la[1].style.cssText,-1<Sa.indexOf(_currFCStyle)&&(Ia=la[1]))):(_currFCStyle=V.firstChild.style.cssText,-1<Sa.indexOf(_currFCStyle)&&(Ia=la[0]));Ia&&(DEXTTOP.DEXT5.util.removeElement(Ia),
doSetCaretPosition(V,0))}}}catch(bb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}else if(86==c&&G_dext5plugIn){DEXTTOP.DEXT5.util.cancelEvent(a);return}DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion&&moveRulerPosition(a);if(32==c||13==c||46==c||8==c||37==c||38==c||39==c||40==c||36==c||35==c||33==c||34==c){"2"==b._config.olUlTagMode&&(0!=g||37!=c&&38!=c&&39!=c&&40!=c&&13!=c||adjustLiNodeForArrowKey("keyup",S,c));try{var La=getFirstRange(),ia=La.range,Ma=null;if(ia&&ia.startContainer){var Ya=
!0;32==c&&(Ya=!1);if(Ya){if((Ma=La.sel.focusNode)&&3==Ma.nodeType)for(;1!=Ma.nodeType;)if(Ma.parentNode)Ma=Ma.parentNode;else break;else Ma=getMyElementNode(ia.startContainer);setMenuIconRealable(Ma)}}b._iconEnableForTextInRange()}catch(qb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion&&0==(32==c||13==c)?setTableArrowKeyUpAction(a):(!DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion)&&1==
(32==c||13==c)&&setAutoUrlHyperLink(a,La)}var Ca=229;DEXTTOP.DEXT5.browser.gecko&&(Ca=0);0==a.ctrlKey&&0==a.altKey&&1==b.UndoManager.arrImageHTML.length&&b.isInitKeydownForSetApi&&(32<=c&&127>=c||c==Ca)&&(b.isInitKeydown=!1,b.UndoManager.canUndo=!0);if(a.shiftKey&&35==c){ia=getFirstRange().range;try{if(1==ia.endContainer.nodeType&&"BODY"==ia.endContainer.tagName){for(var va=ia.endContainer.childNodes[ia.endOffset-1];3!=va.nodeType;)va=va.lastChild,1==va.nodeType&&"BR"==va.tagName&&(va=va.previousSibling);
ia.setEndAfter(va);getFirstRange().sel.addRange(ia);ia.collapse(!0)}}catch(xb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}-1<b.fixDEXTWINScroll.keyCodeArr.indexOf(c)&&null!=b.fixDEXTWINScroll.backupValue&&(DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTWIN,"scroll",b.fixDEXTWINScroll.fn),b.fixDEXTWINScroll.backupValue=null);try{var Ta=!1;if(DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.browser.quirks){if(37==c||38==c||39==c||40==c||36==c||35==c||33==c||34==c||a.ctrlKey)Ta=!0}else Ta=!0;if(Ta){var oa=
null;(ia=getFirstRange().range)&&1==ia.collapsed&&ia.startContainer&&(oa=getMyElementNode(ia.startContainer));if((DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)&&(39==c||37==c||38==c)&&0==a.ctrlKey&&0==a.altKey&&0==a.shiftKey)if(b.keydownNodeForTableCaret.tdNode){var cb=GetParentbyTagName(b.keydownNodeForTableCaret.tdNode,"table");if(oa==cb.parentNode)if(39==c){var Y=cb.nextSibling;try{if(null==Y)restoreSelection(b.keydownNodeForTableCaret.backupRange,!0);else{var wa=!1;if(3==Y.nodeType){var pa=
Y.nodeValue,pa=pa.replace(/\n/g,""),pa=pa.replace(/\t/g,""),pa=pa.replace(/ /g,"");if(""==pa)try{Y=oa.childNodes[ia.startOffset+1],0==!!Y&&(wa=!0)}catch(yb){wa=!0}}0==wa&&("P"==Y.tagName||"TABLE"==Y.tagName||"DIV"==Y.tagName?Y.firstChild&&(Y=getFirstChildNodeForCaret(Y.firstChild),doSetCaretPosition(Y,0),setMenuIconRealable(Y),oa=Y):wa=!0);wa&&restoreSelection(b.keydownNodeForTableCaret.backupRange,!0)}}catch(db){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else if(37==c||38==c){Y=cb.previousSibling;
try{if(null==Y)restoreSelection(b.keydownNodeForTableCaret.backupRange,!0);else{wa=!1;if(3==Y.nodeType&&(pa=Y.nodeValue,pa=pa.replace(/\n/g,""),pa=pa.replace(/\t/g,""),pa=pa.replace(/ /g,""),""==pa))try{1==ia.startContainer.nodeType?Y=oa.childNodes[ia.startOffset-2]:3==ia.startContainer.nodeType&&(Y=ia.startContainer.previousSibling),0==!!Y&&(wa=!0)}catch(Db){wa=!0}0==wa&&("P"==Y.tagName||"TABLE"==Y.tagName||"DIV"==Y.tagName?(Y=getLastChildNodeForCaret(Y),doSetCaretPosition(Y,1),setMenuIconRealable(Y),
oa=Y):wa=!0);wa&&restoreSelection(b.keydownNodeForTableCaret.backupRange,!0)}}catch(Za){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}else if(("BODY"==oa.tagName||"DIV"==oa.tagName)&&1==ia.startContainer.nodeType)if(37==c&&0<ia.startOffset)try{var Na=oa.childNodes[ia.startOffset-1];Na&&"TABLE"==Na.tagName&&(Y=getLastChildNodeForCaret(Na),doSetCaretPosition(Y,1),setMenuIconRealable(Y),oa=Y)}catch(eb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else if(39==c)try{var rb=oa.childNodes[ia.startOffset];
rb&&"TABLE"==rb.tagName&&(Y=rb.rows[0].cells[0],Y.firstChild&&(Y=getFirstChildNodeForCaret(Y.firstChild),doSetCaretPosition(Y,0),setMenuIconRealable(Y),oa=Y))}catch(Eb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("2"==b._config.toolBarEnableDisableMode)try{8==c?(ma=getFirstRange().range,0==ma.collapsed&&_iframeDoc_MouseUpMenu(a,oa)):!a.ctrlKey&&!a.shiftKey||40!=c&&38!=c&&37!=c&&39!=c&&35!=c&&36!=c&&34!=c&&33!=c?65==c&&"body"==F&&_iframeDoc_MouseUpMenu(a,oa):_iframeDoc_MouseUpMenu(a,
oa)}catch(sb){_iframeDoc_MouseUpMenu(a,oa)}else _iframeDoc_MouseUpMenu(a,oa)}var zb=getFirstRange();if("2"==b._config.undoMode&&0==a.ctrlKey&&0==a.altKey&&32!=c&&13!=c&&46!=c&&null!=b.UndoManager.tempSContainerText&&null!=b.UndoManager.tempEContainerText){var Oa=zb.range.startContainer,xa=zb.range.endContainer,Oa=3==Oa.nodeType?Oa.parentNode:Oa,xa=3==xa.nodeType?xa.parentNode:xa,$a=xa.innerText||xa.textContent;if((Oa.innerText||Oa.textContent)!=b.UndoManager.tempSContainerText||$a!=b.UndoManager.tempEContainerText)b.UndoManager.isInsertData=
!0,b.UndoManager.clearNextImgData()}}catch(Aa){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}showWordCount(a);G_Ruler&&"2"==b._config.ruler.mode&&G_Ruler.SetRulerPosition();setContentChangeKeyEvent(a,c);onChange({editor:b})}}}
function _iframeDoc_selectionchange(a){"0"===DEXTTOP.G_CURREDITOR._config.useSelectionContents&&(a=getFirstRange().range,0==a.collapsed&&rangy.getSelection(_iframeWin).removeAllRanges());!1===G_IsCollapsedInMouseup&&(a=getFirstRange().range,1==a.collapsed&&(a=a.startContainer,3==a.nodeType?a=a.parentNode:9==a.nodeType&&((a=getMyFirstOrLastChildElementNode(DEXTTOP.G_CURREDITOR._BODY))?setMenuIconRealable(a):a=null),a&&_iframeDoc_MouseUpMenu(null,a),G_IsCollapsedInMouseup=!0))}
function recursionBase64ImageToServer(){if(DEXTTOP.DEXT5.browser.ie)dummy=document.getElementById("pasteDiv");else try{var a=document.getElementById("pasteIframe");a&&(dummy=getIframeDocument(a).body)}catch(b){dummy=null}var c=null,c=dummy?dummy.getElementsByTagName("img"):_iframeDoc.getElementsByTagName("img"),d=c.length,a=0,e=DEXTTOP.G_CURREDITOR.addedTotalFileSize,f=0;DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.messageType="paste";DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currFileSize=
0;for(var g=d-1;0<=g;g--){var d=c[g],h=d.src;if("data:"==h.substring(0,5))if(-1<DEXTTOP.G_CURREDITOR._config.disableInsertImage.indexOf(",paste_image,"))d.parentNode.removeChild(d);else if("1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64_remove)d.parentNode.removeChild(d);else if(checkMaxImageFileSize(h))if(0!=DEXTTOP.G_CURREDITOR._config.maxTotalFileSize&&-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&!checkMaxTotalFileSizeByImageSize(parseInt(getImageFileSize(h)),e))d.parentNode.removeChild(d),
f++;else{if(h=h.split(","),2==h.length){var m=getExtFromImageDataSrc(h[0]);if(DEXTTOP.G_CURREDITOR._FRAMEWIN.validateWidthHeight(_dext_editor._config,d.width,d.height))h=dext5_lang.msg.alert_exec_iamgesize,0!=_dext_editor._config.maxImageWidthSize&&(h+=dext5_lang.msg.alert_width.replace("{0}",_dext_editor._config.maxImageWidthSize),h+=" "),0!=_dext_editor._config.maxImageHeightSize&&(h+=dext5_lang.msg.alert_height.replace("{0}",_dext_editor._config.maxImageHeightSize)),alert(h),d.parentNode.removeChild(d);
else{c=DEXTTOP.DEXT5.util.makeGuid()+"."+m;DEXTTOP.G_CURREDITOR._FRAMEWIN.G_OriginalMultiImageSize_src[c]={width:d.width,height:d.height};postBase64ImageToServer(h[1],m,d,!0,null,null,null,null,c);break}}}else d.parentNode.removeChild(d),a++}0!=a&&messageForMaxImageFileSize(a);0!=f&&(a=setMessageForMaxTotalFileSize(DEXTTOP.G_CURREDITOR),alert(a))}
function fn_PasteIE_quality(a){var b=DEXTTOP.G_CURREDITOR;if("1"==b._config.useHtmlProcessByWorker){if(b.isPasting){DEXTTOP.DEXT5.util.cancelEvent(a);return}b.isPasting=!0}setTimeout(function(a){var b=null,b=document.getElementById("pasteDiv"),e=b.getElementsByTagName("img"),f=e.length;if(0<f){showProcessingBackground();G_QualityFileObj=[];for(var g=0;g<f;g++){var h=DEXTTOP.DEXT5.util.makeGuid(),m=e[g].src.split(";")[0].replace("data:image/",""),q=e[g].src;-1<q.indexOf("data:image/"+m+";base64,")&&
(q=q.replace("data:image/"+m+";base64,",""));var t=3*Math.ceil(q.length/4);"=="==q.substr(q.length-2,2)&&(t-=2);t=imageQualityBool(t,m);G_QualityFileObj.push({beforeRawData:q,originalExtension:m,originalFileName:h,idx:g,changeBool:t})}DEXTTOP.DEXT5.browser.WorkerSupported&&"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?changeImageQuality():changeImageQualityWithoutWorker();var u=setInterval(function(){if(G_CompleteImageQuality){for(var g=0;g<f;g++)e[g].src=G_QualityFileObj[g].afterRawData;
clearInterval(u);G_QualityFileObj=[];G_changeCount=0;G_CompleteImageQuality=!1;hideProcessingBackground();fn_PasteIE(a,b)}},300)}else fn_PasteIE(a)},0,a)}
function fn_PasteIE(a,b){var c=DEXTTOP.G_CURREDITOR;if("1"==c._config.useHtmlProcessByWorker){if(c.isPasting&&1<=c._config.imageQuality.quality){a&&DEXTTOP.DEXT5.util.cancelEvent(a);return}c.isPasting=!0}if(a&&a.clipboardData&&a.clipboardData.getData){try{a.clipboardData.items&&0<a.clipboardData.types.length&&(c.AccessClipboardForIEGecko=!0)}catch(d){c.AccessClipboardForIEGecko=!1}if(0==c.AccessClipboardForIEGecko){var e=a.clipboardData.types,f=e.length;if(1<f)for(var g=0;g<f;g++)if("text/html"==
e[g].toLowerCase()){c.AccessClipboardForIEGecko=!0;break}}}if(c.AccessClipboardForIEGecko){try{c.isPasting=!1,DEXTTOP.DEXT5.browser.ie?(document.getElementById("pasteDiv").blur(),document.body.removeChild(document.getElementById("pasteDiv"))):document.body.removeChild(document.getElementById("pasteIframe")),_iframeWin.focus()}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}_iframeDoc_Paste(a)}else setTimeout(function(a,b){if(!b)if(DEXTTOP.G_CURREDITOR=c,b=null,DEXTTOP.DEXT5.browser.ie)b=
document.getElementById("pasteDiv");else try{var d=document.getElementById("pasteIframe");d&&(b=getIframeDocument(d).body)}catch(e){b=null}if(b){b.blur();var f="",d=!1;DEXTTOP.G_CURREDITOR.setTextPaste&&"1"==DEXTTOP.G_CURREDITOR._config.pasteToTextMode&&(d=!0);d?(f=b.value,f=DEXTTOP.DEXT5.util.escapeHtml(f),b.parentNode.removeChild(b),b=null,b=document.createElement("div"),b.id="pasteDiv",document.body.appendChild(b)):f=b.innerHTML;if("html5"==c._config.runtimes)var g=RegExp("(<p [^>]*)(background:#000000;)",
"gi"),f=f.replace(g,function(a,b){return-1<a.indexOf('class="0"')?b:a}),g=RegExp("(<p [^>]*)(background: rgb\\(0, 0, 0\\);)","gi"),f=f.replace(g,function(a,b){return-1<a.indexOf('class="0"')?b:a});G_dext5plugIn&&"1"==DEXTTOP.G_CURREDITOR._config.removeDummyFontTagInPaste&&6==G_dext5plugIn.getHTMLFormatFromType&&0==DEXTTOP.G_CURREDITOR.hasFontNodeInPasteHtml&&-1<f.toLowerCase().indexOf("<font")&&(f=f.replace(/<\/?font(\s|\S)*?>/gi,""));"1"==DEXTTOP.G_CURREDITOR._config.removeHwpDummyTag&&(f=f.replace(/\&lt;!--\[if !supportEmptyParas\]--\&gt;/gi,
""),f=f.replace(/\&lt;!--\[if !supportLists\]--\&gt;/gi,""),f=f.replace(/\&lt;!--\[endif\]--\&gt;/gi,""),f=f.replace(/\&lt;!\[if !supportEmptyParas\]\&gt;/gi,""),f=f.replace(/\&lt;!\[endif\]\&gt;/gi,""));f=removeDummyDivInHwp(f);if(DEXTTOP.G_CURREDITOR.setTextPaste)if(DEXTTOP.G_CURREDITOR.setTextPaste=!1,"1"==DEXTTOP.G_CURREDITOR.setTextPasteMode)for(var d="span font strong i em u strike s sub sup".split(" "),g=d.length,f=f.replace(/<b>/gi,""),f=f.replace(/<b ([^>?+])*>/gi,""),f=f.replace(/<\/b>/gi,
""),h=0;h<g;h++)var x=new RegExp("</"+d[h]+">","gi"),f=f.replace(new RegExp("<"+d[h]+" *([^>?+])*>","gi"),""),f=f.replace(x,"");else d?(f=f.replace(/\r\n/g,"<br>"),f=f.replace(/\n/g,"<br>")):f=DEXTTOP.DEXT5.convertHtmlToText(f),b.innerHTML=f;f=f.replace(RegExp('(text-underline.*?)(;|(?="))',"gi"),"");f=f.replace(RegExp("(<colgroup*[^>?+]*>)<span*[^>?+]*>","gim"),"$1");f=f.replace(RegExp("(<col*[^>?+]*>)</span>","gim"),"$1");"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(f=f.replace(/--\x3e\s</gi,
"--\x3e<"));f=dummyTagClassClear(f);restoreSelection(DEXTTOP.G_CURREDITOR._LastRange);d=b.getElementsByTagName("img");g=d.length;if(0==g&&1==f.length&&"undefined"!=typeof a&&1==DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion)try{for(var x=-1,z=!0,h=0;h<a.clipboardData.items.length;h++)"file"==a.clipboardData.items[h].kind&&"image/png"==a.clipboardData.items[h].type?x=h:z=!1;if(z&&-1!=x){var B=a.clipboardData.items[x].getAsFile(),D=new FileReader;D.onload=function(){var a=document.createElement("img");
a.src=D.result;b.appendChild(a);var c=D.result;if("data:"==c.substring(0,5)&&(c=c.split(","),2==c.length)){var d=getExtFromImageDataSrc(c[0]);a.parentNode.removeChild(a);postBase64ImageToServer(c[1],d);checkPasteImage(b.innerHTML);pasteHtmlAtCaretHuge(b.innerHTML);document.body.removeChild(b);DEXTTOP.G_CURREDITOR.UndoManager.putUndo()}D=void 0};D.readAsDataURL(B);return null}}catch(A){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}checkPasteImage(f);for(var C=!1,h=0;h<g;h++){var E=d[h],
B=E.src;if("data:"==B.substring(0,5)&&(B=B.split(","),2==B.length)){C=!0;break}}var H=function(){!C||G_dext5plugIn&&"base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod||(recursionBase64ImageToServer(),f=b.innerHTML);f=removeDummyfontTagInTable(f);"1"==DEXTTOP.G_CURREDITOR._config.ie_BugFixed_Hyfont&&(f=DEXTTOP.DEXT5.util.replaceHyFont(f,DEXTTOP.G_CURREDITOR));f=replaceFontFamilyInHtml(f,DEXTTOP.G_CURREDITOR);b.innerHTML=f;"2"==DEXTTOP.G_CURREDITOR._config.olUlTagMode&&(adjustOlUlTag(b),f=b.innerHTML);
var a=b.innerHTML,c=RegExp("<li.*?(mso-list).*?>","gi");if(DEXTTOP.DEXT5.browser.ie&&11<=DEXTTOP.DEXT5.browser.ieVersion&&c.test(a)){for(var a=b.getElementsByTagName("ol"),c=a.length,d=b.getElementsByTagName("ul"),e=d.length,g=0;g<c;g++){var h=a[g].getElementsByTagName("li")[0];if(""==h.style.fontFamily){var m=h.innerHTML,t=RegExp("mso-hansi-font-family:([^;]*)","g"),u="";t.exec(m)&&(u=RegExp.$1);h.style.fontFamily=""!=u?u:"\ub9d1\uc740 \uace0\ub515"}h.firstChild.style&&""==h.firstChild.style.fontFamily&&
(h.firstChild.style.fontFamily=""!=u?u:"\ub9d1\uc740 \uace0\ub515")}for(g=0;g<e;g++)h=d[g].getElementsByTagName("li")[0],""==h.style.fontFamily&&(m=h.innerHTML,t=RegExp("mso-hansi-font-family:([^;]*)","g"),u="",t.exec(m)&&(u=RegExp.$1),h.style.fontFamily=""!=u?u:"\ub9d1\uc740 \uace0\ub515"),h.firstChild.style&&""==h.firstChild.style.fontFamily&&(h.firstChild.style.fontFamily=""!=u?u:"\ub9d1\uc740 \uace0\ub515")}u=replaceSpanToDivContainAbsolute(b);g=!1;a="";c=b.childNodes.length;for(d=0;d<c;d++)e=
b.childNodes[d],1==e.nodeType&&"FONT"==e.tagName?(g="",""!=e.color&&(g+="color:"+e.color+";"),""!=e.face&&(g+="font-family:"+e.face+";"),""!=e.style.cssText&&(g+=e.style.cssText),0<g.length&&(g=" style='"+g+"'"),a+="<span"+g+">"+e.innerHTML+"</span>",g=!0):3==e.nodeType?a+=e.nodeValue:8==e.nodeType?"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(a=void 0!=e.text?a+e.text:a+e.nodeValue):a+=e.outerHTML;if(1==g||u)f=a;if(DEXTTOP.DEXT5.browser.ie)document.body.removeChild(b);else try{document.body.removeChild(document.getElementById("pasteIframe"))}catch(w){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}setFocusToBody();f=execReplaceMsoStyle(f);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlCorrection?(u=!1,G_dext5plugIn&&6==G_dext5plugIn.getHTMLFormatFromType&&(u=!0),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?(showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:DEXTTOP.G_CURREDITOR._config,callFn:"htmlTagRevision",callFnParam:[f,
!0,u],callBackFn:fn_PasteIE_htmlTagRevision_After})):(f=htmlTagRevision(f,!0,u),fn_PasteIE_htmlTagRevision_After(f))):fn_PasteIE_htmlTagRevision_After(f)};"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector?1==g?(E=d[h],B=E.src,h=DEXTTOP.DEXT5.util.dataURItoBlob(B),B=B.split(","),B=getExtFromImageDataSrc(B[0]),D5FileDetector(h,B,function(a,b,c){0==c&&(alert(dext5_lang.msg.message_file_ext_detect),E.parentNode.removeChild(E));executeMaxTotalFileSizeCheckProcess({editor:DEXTTOP.G_CURREDITOR,
finalCallBackFn:H})})):(h={editor:DEXTTOP.G_CURREDITOR,finalCallBackFn:H},executeMaxTotalFileSizeCheckProcess(h)):(h={editor:DEXTTOP.G_CURREDITOR,finalCallBackFn:H},executeMaxTotalFileSizeCheckProcess(h))}},0,a),setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})},500)}
function fn_PasteIE_htmlTagRevision_After(a){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();a=removeTagStyle(a);a=ReplaceAll(a,unescape("%uFEFF"),"");a=ReplaceAll(a,unescape("%u200B"),"");if(0<a.length){a=SetCorrectOfficeHtml(a);a=SetCorrectOfficeHtmlForDOM(a);var b=!1;G_dext5plugIn&&(b=!0);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?(a=DEXTTOP.DEXT5.util.officeCleanByDom(a,b),showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,
ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:DEXTTOP.G_CURREDITOR._config,callFn:"DEXTTOP.DEXT5.util.officeClean",callFnParam:[a,b],callBackFn:fn_PasteIE_officeClean_After})):(a=DEXTTOP.DEXT5.util.officeClean(a,b),fn_PasteIE_officeClean_After(a))}else"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}
function fn_PasteIE_officeClean_After(a){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();if(-1<DEXTTOP.G_CURREDITOR._config.imgDefaultWidth.indexOf("%")){var b=document.createElement("div");b.innerHTML=a;a=b.getElementsByTagName("img");for(var c=a.length,d=0;d<c;d++){var e=a[d],f=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.G_CURREDITOR._config.imgDefaultWidth),g=DEXTTOP.DEXT5.util.getEditSpacePx(DEXTTOP.G_CURREDITOR);tempImgW="string"==typeof e.style.width&&-1<e.style.width.indexOf("%")?
DEXTTOP.DEXT5.util.parseFloatOr0(e.style.width):Math.round(DEXTTOP.DEXT5.util.parseFloatOr0(e.style.width)/g*1E4)/100;e.style.width=0!=f&&f<tempImgW?DEXTTOP.G_CURREDITOR._config.imgDefaultWidth:tempImgW+"%";e.style.height=""}a=b.innerHTML}0==/<span[^>]*?mso-bidi-font-family: \+mn-cs;.*?>/i.test(a)&&(a=DEXTTOP.DEXT5.util.emptyTagRemove(a));a=IEPasteRemoveEmptyNodes(a);a=DEXTTOP.DEXT5.util.htmlRevision(a);a=xssReplaceScript(null,a);a=adjustSizeInContainer({strHtml:a});if(DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.gecko){a=
OfficePasteClean(a);if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&a&&""!=a&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount&&(b=getBase64ImageCountEx(a),0<b&&getBase64ImageCount()+b>parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,10))){var h=dext5_lang.msg.max_base64file_count,h=h.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount);alert(h);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}a=removeEditorAttribute(a);
"1"==DEXTTOP.G_CURREDITOR._config.removeAppleInterchangeNewlineBr&&(a=a.replace(/<br class="Apple-interchange-newline">/gi,""));"1"==DEXTTOP.G_CURREDITOR._config.compatibility.dingBatCharPaste&&(a=dingBatFont(a,DEXTTOP.G_CURREDITOR));try{for(var m in G_DEPlugin)if("function"===typeof G_DEPlugin[m].onBeforePaste){var q=G_DEPlugin[m].onBeforePaste({html:a});if("string"==typeof q)a=q;else if(!1===q)return}}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{if("function"===typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event||
"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste){m=a;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste?m=DEXTTOP.G_CURREDITOR._config.event.beforePaste(a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event&&(m=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(a))}catch(u){m=a}if(m)a=m;else if(0==m||""==m){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&
RAONWIZDLW()}if(!pasteWordCount(a)){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}-1<a.indexOf("dext5customdata")&&(a=checkExistCustomData(a));a=externalPageBreakDataRaplaceInEditor(a);q=GetTableSelectionCells();m=document.createElement("div");m.innerHTML=a;m=m.childNodes;1==m.length&&m[0].tagName&&"table"==m[0].tagName.toLowerCase()&&0<q.length?(0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),command_tablePaste(DEXTTOP.G_CURREDITOR.ID,
DEXTTOP.G_CURREDITOR,m[0]),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0):(q=!1,"1"==DEXTTOP.G_CURREDITOR._config.useTablePasteDialog&&(b=getFirstRange().range,h=null,b.startContainer==b.endContainer&&(h=b.startContainer,3==h.nodeType&&(h=h.parentNode),h=GetTDTHCell(h)),h&&1==m.length&&m[0].tagName&&"table"==m[0].tagName.toLowerCase()&&(q=!0)),q?(DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode=m[0],DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml=a,DEXTTOP.G_CURREDITOR.pasteTableParam.currCellNode=
h,DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode=GetParentbyTagName(h,"table"),DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.paste_table)):pasteHtmlAtCaretHuge(a,!1,!1,!0));0>a.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1),ClearDraggingTableAllTable());setAdjustTableBorder(DEXTTOP.G_CURREDITOR._DOC)}"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&
hideProcessingBackground();try{contentChangeEventWrapper()}catch(w){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function IEPasteRemoveEmptyNodes(a){function b(a){function b(a){for(var c=a.childNodes,d=[],e=0,f=c.length;e<f;++e)a=c[e],a.TEXT_NODE==a.nodeType?d.push(a.data):a.ELEMENT_NODE==a.nodeType&&d.push(b(a));return d.join("").replace(/\s+/g," ")}"string"==typeof a&&(a=_iframeDoc.getElementById(a));return"string"==typeof a.textContent?a.textContent:"string"==typeof a.innerText?a.innerText:b(a)}if(DEXTTOP.DEXT5.browser.ie&&"1"==DEXTTOP.G_CURREDITOR._config.pasteRemoveEmptyTag)try{var c=_iframeDoc.createElement("div");
c.innerHTML=a;for(var d,e=c.getElementsByTagName("*"),f,g=newline=!1,h=/^\s*$/,m,q,t=0;t<e.length;t++)if(d=e[t],m=new RegExp("\\b"+d.tagName+"\\b","i"),!m.test("base basefont body br col hr html img input isindex link meta param title")&&m.test("span div b strong i em strike u sup sub")&&h.test(b(d))){f=d.getElementsByTagName("*");for(var u=0,v=f.length;u<v;u++)if(q=new RegExp("\\b"+f[u].tagName+"\\b","i"),q.test("base basefont body br col hr html img input isindex link meta param title")){g=!0;break}var w=
d.innerHTML;-1<w.indexOf("&nbsp;")&&(newline=!0);w=w.replace(/(<([^>]+)>)/gi,"");" "==w&&(g=!0);g||newline||(d.parentNode.removeChild(d),--t);newline=g=!1}a=c.innerHTML}catch(y){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return a}
function pasteHtmlAtCaretHuge(a,b,c,d,e){try{if(0!=a.length){var f,g,h=getFirstRange();f=h.sel;g=h.range;if(f.getRangeAt&&f.rangeCount){var m=getBlockContainer(g.startContainer),q,t,u,v;if(m){var w=_iframeDoc.createElement("div");w.innerHTML=a;t=_iframeDoc.createDocumentFragment();for(var y=!1;v=w.firstChild;)if(t.appendChild(v),0==y&&1==v.nodeType){var x=v.tagName.toLowerCase(),z=",p,table,div,hr,ol,ul,figure,h1,h2,h3,h4,h5,h6";1!=b&&(z+="input,select,button,textarea,");-1<z.indexOf(","+x+",")&&
(y=!0)}try{w&&(w.innerHTML="",delete null)}catch(B){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var D=m.tagName.toLowerCase();"div"==D&&(y=!1);if(y){if("1"==DEXTTOP.G_CURREDITOR._config.pasteWhenTableIsLast&&1==d&&t.lastChild&&1==t.lastChild.nodeType&&"TABLE"==t.lastChild.tagName){var A=_iframeDoc.createElement("p");A.innerHTML=getDefaultParagraphValue(!1);A.id="dext_paste_caret_node";t.appendChild(A)}g.deleteContents();try{q=extractBlockContentsFromCaret(!0);u=extractBlockContentsFromCaret(!1);
b="";var C=q.childNodes.length,E,H;E=H;h=getFirstRange();f=h.sel;g=h.range;g.selectNode(m);g.deleteContents();if(0<C){var M=q.childNodes[0];if(1!=C||3!=M.nodeType||0!=M.nodeValue.length){var N=!0;if("p"==D&&1==C)try{if(0==(M.tagName&&-1<",area,base,basefont,frame,hr,img,input,isindex,link,meta,param,embed,br,".indexOf(","+M.tagName.toLowerCase()+","))){var I=M.innerHTML.toLowerCase(),I=I.replace(/<(span|strong|font|i|u|strike|sup|sub|b|em|s|)>/gi,""),I=I.replace(/<(span .*?|strong .*?|font .*?|i .*?|u .*?|strike .*?|sup .*?|sub .*?|b .*?|em .*?|s .*?)>/gi,
""),I=I.replace(/<(\/span|\/strong|\/font|\/i|\/u|\/strike|\/sup|\/sub|\/b|\/em|\/s|)>/gi,"");if(""==I||"<br>"==I||"<br />"==I)N=!1}}catch(S){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}N&&(E=_iframeDoc.createElement(D),E.appendChild(q),setCopyAllObjectAtributes(m,E,!1),g.insertNode(E),g.setStartAfter(E),C=u?u.childNodes.length:0,0==C&&doSetCaretPosition(E,1),g.collapse(!0),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(g))}}var F;if(DEXTTOP.DEXT5.browser.gecko||
DEXTTOP.DEXT5.browser.ie||c)F=_iframeDoc.createElement("span"),F.innerHTML=DEXTTOP.DEXT5.browser.gecko?"<br>":"&nbsp;",g.insertNode(F),g.setStartAfter(F),g.collapse(!0);C=u?u.childNodes.length:0;if(0<C&&(M=u.childNodes[0],1!=C||3!=M.nodeType||0!=M.nodeValue.length)){N=!0;if("p"==D&&1==C)try{0==(M.tagName&&-1<",area,base,basefont,frame,hr,img,input,isindex,link,meta,param,embed,br,".indexOf(","+M.tagName.toLowerCase()+","))&&(I=M.innerHTML.toLowerCase(),I=I.replace(/<(span|strong|font|i|u|strike|sup|sub|b|em|s|)>/gi,
""),I=I.replace(/<(span .*?|strong .*?|font .*?|i .*?|u .*?|strike .*?|sup .*?|sub .*?|b .*?|em .*?|s .*?)>/gi,""),I=I.replace(/<(\/span|\/strong|\/font|\/i|\/u|\/strike|\/sup|\/sub|\/b|\/em|\/s|)>/gi,""),""==I||"<br>"==I||"<br />"==I)&&(N=!1)}catch(O){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}N&&(H=_iframeDoc.createElement(D),H.appendChild(u),setCopyAllObjectAtributes(m,H,!1),g.insertNode(H),rangy.getSelection(_iframeWin).removeAllRanges(),g.selectNode(H),g.setEndBefore(H),f.addRange(g),
g.collapse(!0))}b="";var P=t.childNodes.length;f=!1;for(h=0;h<P;h++){var J=t.childNodes[h];if(1==J.nodeType&&checkBlockTag(J.tagName))1==f&&(b+="</p>",f=!1),b+=J.outerHTML;else if(1==J.nodeType&&0==checkBlockTag(J.tagName))0==f&&(b+="<p>",f=!0),b+=J.outerHTML;else if(3==J.nodeType&&0<J.nodeValue.length){var L=J.nodeValue,L=L.replace(/\r\n/g,""),L=L.replace(/\r/g,""),L=L.replace(/\n/g,""),L=L.replace(/\t/g,""),L=L.replace(/ /g,"");""!=L&&(0==f&&(b+="<p>",f=!0),b+=J.nodeValue)}else 8==J.nodeType&&"0"==
DEXTTOP.G_CURREDITOR._config.removeComment&&(b=void 0!=J.text?b+J.text:b+J.nodeValue);h==P-1&&1==f&&(b+="</p>",f=!1)}if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie||c)rangy.getSelection(_iframeWin).removeAllRanges(),g.setStartBefore(F),g.setEndBefore(F),F.parentNode.removeChild(F),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(g);pasteHtmlAtCaretMini(b,d,e);try{if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie)F.removeNode?F.removeNode():
F.outerHTML="";else if(!(_iframeWin.getSelection||9<=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks)){var K=m.lastChild;K&&"table"==K.tagName.toLowerCase()&&doSetCaretPosition(K.cells[0],1)}}catch(W){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}catch(G){pasteHtmlAtCaretMini(a,!1,e)}}else pasteHtmlAtCaretMini(a,!1,e)}else pasteHtmlAtCaretMini(a,!1,e)}}}catch(Q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function pasteHtmlAtCaretMini(a,b,c){if(0!=a.length){a=insertCarriageReturnBeforeCloseCell(a);var d,e,f=getFirstRange();d=f.sel;e=f.range;if(_iframeWin.getSelection||9<=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks){if(d.getRangeAt&&d.rangeCount||9<=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks){e.deleteContents(!0);var g;try{if(""==_iframeDoc.body.innerHTML){g=_iframeDoc.createElement("div");g.innerHTML=a;for(var h=g.childNodes,f="",m=!0,q=h.length,t=0;t<q;t++){var u=
h[t];if(!u||1!=u.nodeType||"P"!=u.tagName&&"TABLE"!=u.tagName&&"DIV"!=u.tagName&&"HR"!=u.tagName&&"OL"!=u.tagName&&"UL"!=u.tagName&&"H1"!=u.tagName&&"H2"!=u.tagName&&"H3"!=u.tagName&&"H4"!=u.tagName&&"H5"!=u.tagName&&"H6"!=u.tagName)if(3==u.nodeType){var v=u.nodeValue,v=v.replace(/&/g,"&amp;"),v=v.replace(/</g,"&lt;"),v=v.replace(/>/g,"&gt;"),v=v.replace(/\r\n/g,"<br />"),v=v.replace(/\r?\n/g,"<br />"),v=v.replace(/\n/g,"<br />");0==m?f+=v:(f=f+"<p>"+v,m=!1)}else 8!=u.nodeType?0==m?f+=u.outerHTML:
(f=f+"<p>"+u.outerHTML,m=!1):"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(f+=u.text);else 0==m&&(f+="</p>",m=!0),f+=u.outerHTML,m=!0}0==m&&(f+="</p>");0<f.length&&(a=f)}}catch(w){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{g&&(g.innerHTML="",delete null)}catch(y){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}g=_iframeDoc.createElement("div");g.innerHTML=a;if((a=getMyElementNode(e.startContainer))&&1==a.nodeType&&"BODY"==a.tagName){h=g.childNodes;f="";m=!0;q=h.length;
for(t=0;t<q;t++)!(u=h[t])||1!=u.nodeType||"P"!=u.tagName&&"TABLE"!=u.tagName&&"DIV"!=u.tagName&&"HR"!=u.tagName&&"OL"!=u.tagName&&"UL"!=u.tagName?3==u.nodeType?(v=u.nodeValue,v=v.replace(/&/g,"&amp;"),v=v.replace(/</g,"&lt;"),v=v.replace(/>/g,"&gt;"),v=v.replace(/\r\n/g,"<br />"),v=v.replace(/\r?\n/g,"<br />"),v=v.replace(/\n/g,"<br />"),0==m?f+=v:(f=f+"<p>"+v,m=!1)):8!=u.nodeType&&(0==m?f+=u.outerHTML:(f=f+"<p>"+u.outerHTML,m=!1)):(0==m&&(f+="</p>",m=!0),f+=u.outerHTML,m=!0);0==m&&(f+="</p>");0<
f.length&&(a=f)}a=_iframeDoc.createDocumentFragment();for(var x;u=g.firstChild;)x=a.appendChild(u);try{e.insertNode(a)}catch(z){d.collapse(_iframeDoc.body.firstChild,0),e=d.getRangeAt(0),e.insertNode(a)}if(x)if(3==x.nodeType){e.selectNodeContents(x);e=e.cloneRange();try{e.setEnd(e.endContainer,e.endOffset),e.collapse(!1)}catch(B){e.setStartBefore(x),e.collapse(!0)}d.removeAllRanges();d.addRange(e)}else if(!x||1!=x.nodeType||0!=x.outerHTML.indexOf("<table")&&0!=x.outerHTML.indexOf("<TABLE")){e.selectNodeContents(x);
e=e.cloneRange();try{"IMG"==x.tagName||"HR"==x.tagName||"IFRAME"==x.tagName||"EMBED"==x.tagName?("0"==DEXTTOP.G_CURREDITOR._config.afterPasteCaretPosition?e.setStartBefore(x):e.setStartAfter(x),e.collapse(!0)):(DEXTTOP.DEXT5.browser.gecko||8<DEXTTOP.DEXT5.browser.ieVersion?("0"==DEXTTOP.G_CURREDITOR._config.afterPasteCaretPosition?e.setEnd(e.startContainer,e.startOffset):e.setEnd(e.endContainer,e.endOffset),e.collapse(!1)):("0"==DEXTTOP.G_CURREDITOR._config.afterPasteCaretPosition?e.setStartBefore(x):
e.setStartAfter(x),e.collapse(!0)),"OL"!=x.tagName&&"UL"!=x.tagName||setTimeout(function(){doSetCaretPosition(e.endContainer.lastChild.lastChild,1)},0))}catch(D){e.setStartBefore(x),e.collapse(!0)}try{d.removeAllRanges(),d.addRange(e)}catch(A){e.startContainer&&1==e.startContainer.nodeType&&setTimeout(function(){doSetCaretPosition(e.startContainer,1)},0)}}else if(a=x.getElementsByTagName("td")){var C=null,C="0"==DEXTTOP.G_CURREDITOR._config.afterPasteCaretPosition?x.rows[x.rows.length-1].cells[0].childNodes[0]:
a[a.length-1].childNodes[0];if(0==C.length)doSetCaretPosition(cell,1);else{for(;0!=C.childNodes.length&&"BR"!=C.childNodes[0].tagName;)C=C.childNodes[0];doSetCaretPosition(C,0)}}try{g&&(g.innerHTML="",delete null)}catch(E){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}else(d=_iframeDoc.selection)&&"Control"!=d.type&&(u=d.createRange(),u.collapse(!0),d.createRange().pasteHTML(a),e=d.createRange(),e.setEndPoint("StartToStart",u));try{if(b){if(C=_iframeDoc.getElementById("dext_paste_caret_node")){var H=
getFirstRange().range;H.setStart(C,0);H.setEnd(C,0);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(H);C.removeAttribute("id")}}else if(e.startContainer&&e.startContainer.tagName&&"BR"==e.startContainer.tagName){for(var M=e.startContainer;;){if(null==M||void 0==M){M=M.parentNode;break}if("BR"!=M.tagName)break;M=M.previousSibling}e.setStartAfter(M);e.collapse(!0);d.removeAllRanges();d.addRange(e)}if(e.startContainer&&e.startContainer.tagName&&"TD"==e.startContainer.tagName){var N=
x?x.nextSibling:null;N&&N.tagName&&("P"==N.tagName||"BR"==N.tagName)&&IsEmptyNodes(N)&&e.startContainer.removeChild(N)}}catch(I){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXTTOP.G_CURREDITOR.isTablePaste=!1;adjustTableAfterPaste(DEXTTOP.G_CURREDITOR);showWordCount();try{for(var S in G_DEPlugin)if("function"===typeof G_DEPlugin[S].onAfterPaste)G_DEPlugin[S].onAfterPaste({})}catch(F){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}"function"===typeof _dext_editor._config.event.afterPaste?
_dext_editor._config.event.afterPaste({},_dext_editor.ID):"function"===typeof DEXTTOP.DEXTWIN.dext_after_paste_event&&DEXTTOP.DEXTWIN.dext_after_paste_event({},_dext_editor.ID);c||DEXTTOP.G_CURREDITOR.UndoManager.putUndo()}}function getBlockContainer(a){for(;a;){if(1==a.nodeType&&/^(P|H[1-6]|DIV)$/i.test(a.nodeName))return a;a=a.parentNode}}function getContainerForRemoveCss(a){for(;a;){if(1==a.nodeType&&/^(P|H[1-6]|DIV|LI|BLOCKQUOTE|HR|OL|UL|TD|TH)$/i.test(a.nodeName))return a;a=a.parentNode}}
function extractBlockContentsFromCaretForRemoveCss(a){var b=getFirstRange(),c=b.range;if(b.sel.rangeCount)if(a){if(a=getContainerForRemoveCss(c.startContainer))return b=c.cloneRange(),b.selectNodeContents(a),b.setEnd(c.startContainer,c.startOffset),b.extractContents()}else if(a=getContainerForRemoveCss(c.endContainer))return b=c.cloneRange(),b.selectNodeContents(a),b.setStart(c.endContainer,c.endOffset),b.extractContents()}
function extractBlockContentsFromCaret(a){var b=getFirstRange(),c=b.range;if(b.sel.rangeCount)if(a){if(b=getBlockContainer(c.startContainer))return a=c.cloneRange(),a.selectNodeContents(b),a.setEnd(c.startContainer,c.startOffset),a.extractContents()}else if(b=getBlockContainer(c.endContainer)){a=c.cloneRange();a.selectNodeContents(b);if(DEXTTOP.DEXT5.browser.ie)a.setStart(c.endContainer,c.endOffset);else{b=c.endOffset;try{0<c.endOffset&&c.endContainer.childNodes.length>=c.endOffset&&(b=c.endContainer.childNodes.length-
1-c.endOffset,0>b&&(b=0))}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}a.setStart(c.endContainer,b)}return a.extractContents()}}function insertNodeAtCaret(a){var b=DEXTTOP.G_CURREDITOR._DOC.createElement("span");b.id=a;b.innerHTML="&nbsp;";if(a=getFirstRange().range)a.collapse(!1),a.insertNode(b)}
function replacePasteHTML(){if(null!=startBookmark&&null!=endBookmark)try{var a=getFirstRange().range;a.setStart(startBookmark.startContainer,startBookmark.startOffset);a.setEnd(endBookmark.startContainer,endBookmark.startOffset);var b=a.toHtml();if(0<b.length){var b=SetCorrectOfficeHtml(b),b=SetCorrectOfficeHtmlForDOM(b),c=DEXTTOP.DEXT5.util.officeClean(b,!1),c=DEXTTOP.DEXT5.util.htmlRevision(c),c=xssReplaceScript(null,c);a&&(a.deleteContents(),a.pasteHtml(c))}}catch(d){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}}function dext_src_init(a){_iframeWin=rangy.dom.getIframeWindow(a);_iframeDoc=rangy.dom.getIframeDocument(a)}
function setBodyDefaultValue(a){try{if(0!=getFirstRange().range.collapsed){var b=_iframeDoc.body.childNodes.length,c=_iframeDoc.body.childNodes,d=a=null;if(0==b)a=_iframeDoc.createElement("p"),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?a.innerHTML="&nbsp;":(d=_iframeDoc.createElement("br"),a.appendChild(d)),_iframeDoc.body.appendChild(a);else if(3!==c[0].nodeType&&1==b&&1===c[0].nodeType)if(a=c[0],"p"==a.nodeName.toLowerCase())""!=a.innerHTML&&" "!=a.innerHTML&&"&nbsp;"!=a.innerHTML||
DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion||(d=_iframeDoc.createElement("br"),a.appendChild(d));else if("br"==a.nodeName.toLowerCase()){var e=_iframeDoc.createElement("p");_iframeDoc.body.appendChild(e);e.appendChild(a)}}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setFocusToBody(a,b){var c=!0;try{var d=DEXTTOP.G_CURREDITOR;a&&(d=a);1!=b&&(1==isViewMode(d)?c=!1:1==DEXTTOP.DEXT5.config.ForceSkipFocus?c=!1:0==d._config.initFocus&&d.isInitFocusHandler?c=!1:d.notFocusToEditor&&(c=!1));if(1==c)if(DEXTTOP.DEXT5.browser.ie)try{_iframeWin.focus(),_iframeDoc.focus(),_iframeDoc.body.focus()}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else try{_iframeWin.focus(),_iframeDoc.body.focus()}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&
RAONWIZDLW()}}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}
function _iframeDoc_ContextMenu(a){setDEXTWINDOC();var b=getEditrFromEvent(a);DEXTTOP.G_CURREDITOR=b;if(isViewMode(b)){var c=b._config,d=DEXTTOP.G_CURREDITOR._config.viewModeAllowShortcut;if("0"==c.viewModeContextMenu||0==d.length){DEXTTOP.DEXT5.util.cancelEvent(a);return}if("2"==c.viewModeContextMenu)return}if("2"!=b._config.contextMenuDisable){c=a?a:_iframeWin.event;currElem=c.target?c.target:c.srcElement;if("dextResizeDiv"==currElem.id||null!=DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag)currElem=
DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem;if(0!=checkContentEditable(DEXTTOP.G_CURREDITOR,currElem)){var e=!1;if("textarea"==currElem||"input"==currElem)e=!0;var f=GetParentbyTagName(currElem,"div");setTimeout(function(){if(0==e){var a=getFirstRange().range.startContainer;3==a.nodeType&&(a=a.parentNode);for(;a&&a.tagName&&-1<a.tagName.indexOf("DIAGONAL");)a=a.previousSibling;G_CURSOR_ELEMENT=f&&"DEXT_fiVe_Page_Break"==f.className?f:a;onChange({editor:b})}},10);if("1"!=b._config.formMode&&
"1"==b._config.userTableLock.use){var d=GetTDTHCell(currElem),g;d&&(g=GetParentbyTagName(currElem,"table"));var h=b._config.userTableLock.defaultTableLockMode;g&&("2"==b._config.userTableLock.tableLockMode?checkLockAttr(g,!0)||checkLockAttr(d,!0)?g.getAttribute("lock_mode")&&""!=g.getAttribute("lock_mode")&&(h=g.getAttribute("lock_mode")):h="0":g.getAttribute("lock_mode")&&""!=g.getAttribute("lock_mode")&&(h=g.getAttribute("lock_mode")));var m=!0;"1"==h?m=!1:"0"==h&&(m=!1,d=null);if(d){if(checkLockAttr(g)){if(b.lastElemForLock)setFocusForLock(b.lastElemForLock);
else{var q=findNoLockElem(g);q?setFocusForLock(q):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(d,!m)){b.lastElemForLock?setFocusForLock(b.lastElemForLock):setFocusForLock(findNoLockCell(g));DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}b.lastElemForLock=d}}if("1"==b._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.mouse?
DEXTTOP.G_CURREDITOR._config.event.mouse("contextmenu",c,currElem):"function"===typeof DEXTTOP.DEXTWIN.dext_mouse_event&&DEXTTOP.DEXTWIN.dext_mouse_event("contextmenu",c,currElem)}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(c);return}}g=GetParentbyTagName(currElem,"table");null==g?(ClearDraggingTableCellSelected(),ActiveCurrTable=null):(DEXTTOP.G_SELECTED_ELEMENT=currElem,ActiveCurrTable=g);try{var u=
currElem.tagName.toLowerCase();if("html"==u||"body"==u){g=!1;500>a.clientX&&10>a.clientY&&(g=!0);repairBodyFirstLastTag(g);if(DEXTTOP.DEXT5.browser.ie&&0==DEXTTOP.DEXT5.browser.quirks&&7!=DEXTTOP.DEXT5.browser.ieVersion){if((q=getFirstRange().range)&&1==q.collapsed&&_iframeDoc.body.createTextRange){var q=_iframeDoc.body.createTextRange(),v=a.clientX,w=a.clientY;"None"==b._setting.doctype&&(v<q.boundingLeft&&(v=q.boundingLeft),"html"==u&&w>q.boundingHeight-(q.offsetTop-q.boundingTop)&&("None"!=b._setting.doctype&&
(v=q.boundingWidth+q.boundingLeft),w=q.boundingHeight-(q.offsetTop-q.boundingTop),"None"==b._setting.doctype&&--w));q.moveToPoint(v,w);q.select()}setFocusToBody()}else if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){var y=getFirstRange().range;if(1==y.collapsed){u=null;try{createSelectionFromPoint(a.clientX,a.clientY,a.clientX,a.clientY),setFocusToBody(),y=getFirstRange().range,u=_iframeDoc.createElement("dexttemp"),y.insertNode(u),null!=u.nextSibling&&doSetCaretPosition(u.nextSibling,
!1)}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}u&&u.parentNode.removeChild(u)}}else setFocusToBody();(q=getFirstRange().range)&&q.startContainer==q.endContainer&&1==q.collapsed&&(currElem=getMyElementNode(q.startContainer));setMenuIconRealable(currElem)}else setTimeout(function(){var a=getFirstRange().range;a&&a.startContainer==a.endContainer&&1==a.collapsed&&(currElem=getMyElementNode(a.startContainer));setMenuIconRealable(currElem)},0)}catch(z){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}if(!IsMousePointOnBorder(a)){if(getApplyDragResize(DEXTTOP.G_CURREDITOR)&&!DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_showContext){DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_showContext=!0;DEXTTOP.DEXT5.util.cancelEvent(a);return}if(DEXTTOP.DEXT5.browser.mobile)return;setContextMenu(a)}"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&(DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&hyperLinkOut(),DEXTTOP.G_CURREDITOR.isAOver.openHelp&&hyperHelpClose())}}DEXTTOP.DEXT5.util.cancelEvent(a)}
function _iframeDoc_BlurHandler(a){var b=getEditrFromEvent(a);"object"==typeof DEXTTOP.NEXACROHTML&&"undefined"===typeof DEXTTOP.nexacro&&0==isViewMode(_dext_editor)&&(_dext_editor._BODY.contentEditable=!1,_dext_editor._BODY.contentEditable=!0);if(!b._LastRange&&!b._RangeBlurBug){b._LastRange=saveSelection(b.ID);try{"1"==b._config.returnEvent.focus_event&&("function"==typeof b._config.event.focus?b._config.event.focus("blur",a):DEXTTOP.DEXTWIN.dext_focus_event("blur",a))}catch(c){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}execEditorWholeFocusEvent("blur",b)}}
function _iframeDoc_FocusHandler(a){if(a.target?a.target:a.srcElement){var b=getEditrFromEvent(a);setCurrentEditor(b);1==b.isInitFocusHandler&&(b.isInitFocusHandler=!1);if(1==b._config.initFocus&&b._LastRange){var c=null;1==b.isCloseTopMenu&&(c=b._LastRange);restoreSelection(b._LastRange);1==b.isCloseTopMenu&&(b._LastRange=c,b.isCloseTopMenu=!1)}}try{"1"==b._config.returnEvent.focus_event&&("function"==typeof b._config.event.focus?b._config.event.focus("focus",a):DEXTTOP.DEXTWIN.dext_focus_event("focus",
a))}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}execEditorWholeFocusEvent("focus",b)}var G_focusStateInEditorWhole="";function _window_blurHandler(a){a=getEditrFromEvent(a);execEditorWholeFocusEvent("blur",a)}function _window_focusHandler(a){a=getEditrFromEvent(a);execEditorWholeFocusEvent("focus",a)}
function _source_text_focusHandler(a){var b=getEditrFromEvent(a);try{"1"==b._config.returnEvent.focus_event&&("function"==typeof b._config.event.focus?b._config.event.focus("focus",a):DEXTTOP.DEXTWIN.dext_focus_event("focus",a))}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function _source_text_blurHandler(a){var b=getEditrFromEvent(a);try{"1"==b._config.returnEvent.focus_event&&("function"==typeof b._config.event.focus?b._config.event.focus("blur",a):DEXTTOP.DEXTWIN.dext_focus_event("blur",a))}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setCurrentEditor(a){var b=a._EDITOR.design;a._DOC=b.contentDocument?b.contentDocument:b.contentWindow.document;a._BODY=a._DOC.body;DEXTTOP.G_CURREDITOR=a;G_USE_EDITOR_ID=a.ID;LayerFrame=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+DEXTTOP.G_CURREDITOR.ID);dext_src_init(b)}
function InsertFontElement(a,b){var c=getFirstRange(),d=c.range;if(d){d.collapse(!1);var e=null,e=GetParentbyTagName(d.startContainer,"span");!e||e.innerHTML!=unescape("%u200B")&&e.innerHTML!=unescape("%uFEFF")&&""!=e.innerText&&"\n"!=e.innerHTML&&"<br>"!=e.innerHTML&&"<br />"!=e.innerHTML&&"<br>"!=e.innerHTML?(e=_iframeDoc.createElement("span"),0==DEXTTOP.DEXT5.browser.gecko&&(DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?e.innerHTML=unescape("%u200B"):e.innerHTML=
unescape("%uFEFF")),e.style[a]=b,d.insertNode(e),d.selectNodeContents(e),rangy.getSelection(_iframeWin).removeAllRanges(),c.sel.addRange(d),doSetCaretPosition(e,1),!DEXTTOP.DEXT5.browser.ie||"fontFamily"!=a&&"fontSize"!=a||(DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID))):(e.style[a]=b,DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?e.innerHTML=unescape("%u200B"):e.innerHTML=unescape("%uFEFF"),d.selectNodeContents(e),rangy.getSelection(_iframeWin).removeAllRanges(),
c.sel.addRange(d),doSetCaretPosition(e,1))}}function execCommand(a,b,c){b.document=_iframeDoc;rangy.execCommand(a,b,c)}
function getFirstRange(){retValue={};try{var a=rangy.getSelection(_iframeWin);retValue.sel=a;if(0==a.rangeCount){var b=rangy.createRange(_iframeDoc),a=rangy.getSelection(_iframeWin);a.setSingleRange(b);retValue.sel=a;retValue.range=b}else retValue.range=a.getRangeAt(0),DEXTTOP.DEXT5.browser.chrome&&retValue.range.startContainer==retValue.range.endContainer&&retValue.range.startOffset==retValue.range.endOffset&&retValue.range.startContainer.tagName&&"br"==retValue.range.startContainer.tagName.toLowerCase()&&
retValue.range.startContainer.parentNode&&retValue.range.startContainer.parentNode.lastChild==retValue.range.startContainer&&(retValue.range.setStartBefore(retValue.range.startContainer),retValue.range.setEndBefore(retValue.range.endContainer),retValue.sel.removeAllRanges(),retValue.sel.addRange(retValue.range))}catch(c){try{b=rangy.createRange(_iframeDoc),a=rangy.getSelection(_iframeWin),a.setSingleRange(b),retValue.sel=a,retValue.range=b}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}return retValue}
function setRestoreCaretPos(a){var b=getFirstRange().range;b&&(0==a&&b.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b))}
function DoExecuteCommand(a,b,c,d){var e=function(a){return"underline"!=a&&"strikeThrough"!=a||"2"!=DEXTTOP.G_CURREDITOR._config.underlineAndStrikeThroughMode||!(0==DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.ie&&11<=DEXTTOP.DEXT5.browser.ieVersion)?!1:!0},f=function(a,b,c){if(DEXTTOP.DEXT5.browser.ie){var d="";b=c="";"underline"==a?(d="u",c="underline",b="textDecoration"):"strikeThrough"==a&&(d="strike",c="line-through",b="textDecoration");if(""!=d)for(a=_iframeDoc.getElementsByTagName(d),d=
a.length-1;0<=d;d--){var e=a[d],f=_iframeDoc.createElement("span");f.style[b]=c;for(e.parentNode.insertBefore(f,e);e.hasChildNodes();)f.appendChild(e.firstChild);e.parentNode.removeChild(e)}}else{if(b)for(b=b.getElementsByTagName("span"),a=b.length,d=0;d<a;d++)b[d].style.textDecorationLine&&(b[d].style.textDecoration=b[d].style.textDecorationLine);c&&c.style.textDecorationLine&&(c.style.textDecoration=c.style.textDecorationLine)}},g=function(a,b){var c=GetTDTHCell(a),d;d=b;"strikeThrough"==b&&(d=
"line-through");var e=getAllTextNodeByNode(a);if(e&&0<e.length&&c){for(var e=e[0],f="none",g="none";e!=c;)if(e=e.parentNode,f=DEXTTOP.DEXT5.util.getStyle(e,"textDecorationLine"),(g=DEXTTOP.DEXT5.util.getStyle(e,"textDecoration"))&&-1!=g.indexOf(d)||f&&-1!=f.indexOf(d))return!0;if(e==c)return!1}else return!1};e(c)&&_iframeDoc.execCommand("styleWithCSS",!1,!0);var h=function(a){if(a=GetTDTHCell(a).getElementsByTagName("span"))for(var b=a.length,c=0;c<b;c++)if(a[c].style&&"normal"==a[c].style.fontWeight)return!0;
return!1};try{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var m="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode,q=DEXTTOP.DEXT5.browser.quirks;if(1==b.collapsed){var t=GetTableSelectionCells();if(0==t.length){try{DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&
1==b.startContainer.nodeType&&""==b.startContainer.innerHTML&&(b.startContainer.innerHTML=unescape("%u200B"))}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(e(c)){var v;b.startContainer&&3==b.startContainer.nodeType&&"%uFEFF"==escape(b.startContainer.nodeValue)?v=b.startContainer:(v=_iframeDoc.createTextNode(unescape("%uFEFF")),b.insertNode(v),v.previousSibling&&(3==v.previousSibling.nodeType&&"%uFEFF"==escape(v.previousSibling.nodeValue)||"BR"==v.previousSibling.nodeName)&&
v.parentNode.removeChild(v.previousSibling));b.setStart(v,0);b.setEnd(v,v.length);a.removeAllRanges();a.addRange(b);_iframeDoc.execCommand(c,!1,null);var w=v.parentNode;f(c,w.parentNode);b.setStart(v,v.length);b.setEnd(v,v.length);a.removeAllRanges();a.addRange(b);setMenuIconRealable(w)}else _iframeDoc.execCommand(c,!1,null),setMenuIconRealable(getMyElementNode(b.startContainer))}else{var y=[];switch(c){case "bold":y=["b","strong"];break;case "italic":y=["em","i"];break;case "underline":y=["u"];break;
case "strikeThrough":y=["strike"];break;case "superscript":y=["sup"];break;case "subscript":y=["sub"]}v=!0;if(0<t.length){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag)for(var x=0;x<t.length;x++){var z="<(p|span|b|strong|em|i|u|strike|sup|sub)([^>]*?>)<br ?/?></(p|span|b|strong|em|i|u|strike|sup|sub)>",B=new RegExp(z,"gim");t[x].innerHTML=t[x].innerHTML.replace(B,"<$1$2&nbsp;</$3>")}for(var D=!1,x=0;x<t.length;x++){var A=t[x],C=getAllTextNodeByNode(A);if(C&&0<C.length){D=e(c)?g(A,c):"th"==
A.nodeName.toLowerCase()&&"bold"==c?!h(A):getElementInParentTag(C[0].parentNode,y);break}}D&&(v=!1)}for(x=0;x<t.length;x++)if(a.removeAllRanges(),b.selectNode(t[x]),a.addRange(b),"0"!=DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag||""!=DEXTTOP.DEXT5.util.replaceAll(t[x].innerHTML," ","")&&t[x].innerHTML!=getCellDefValue()&&"<p><br></p>"!=t[x].innerHTML.toLowerCase()&&"<p><br/></p>"!=t[x].innerHTML.toLowerCase()&&"<p><br /></p>"!=t[x].innerHTML.toLowerCase()){DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||
1==m||1==q)&&("<p></p>"==t[x].innerHTML.toLowerCase()?t[x].innerHTML="<p>&nbsp;</p>":"<span></span>"==t[x].innerHTML.toLowerCase()&&(t[x].innerHTML="<span>&nbsp;</span>"));"underline"==c||"strikeThrough"==c?_iframeDoc.execCommand(c,!1,null):(d.ignoreWhiteSpace=!0,rangy.queryCommandValue(c,d),execCommand(c,d,b));A=!1;switch(c){case "bold":if(0<t[x].getElementsByTagName("b").length||0<t[x].getElementsByTagName("strong").length||"th"==t[x].nodeName.toLowerCase()&&!h(t[x]))A=!0;break;case "italic":if(0<
t[x].getElementsByTagName("em").length||0<t[x].getElementsByTagName("i").length)A=!0;break;case "underline":e(c)?v||DEXTTOP.DEXT5.browser.ie?(A=g(t[x],"underline"))||0<t[x].getElementsByTagName("u").length&&(A=!0):A=_iframeDoc.queryCommandState(c):0<t[x].getElementsByTagName("u").length&&(A=!0);break;case "strikeThrough":e(c)?v||DEXTTOP.DEXT5.browser.ie?(A=g(t[x],"strikeThrough"))||0<t[x].getElementsByTagName("strike").length&&(A=!0):A=_iframeDoc.queryCommandState(c):0<t[x].getElementsByTagName("strike").length&&
(A=!0);break;case "superscript":0<t[x].getElementsByTagName("sup").length&&(A=!0);break;case "subscript":0<t[x].getElementsByTagName("sub").length&&(A=!0)}if(v&&!A||!v&&A)"underline"==c||"strikeThrough"==c?_iframeDoc.execCommand(c,!1,null):(d.ignoreWhiteSpace=!0,rangy.queryCommandValue(c,d),execCommand(c,d,b))}else DEXTTOP.G_CURREDITOR._formatPainterList&&"1"==DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying&&(DEXTTOP.DEXT5.browser.ie&&(t[x].innerHTML="<p>&nbsp;</p>"),"underline"==c||"strikeThrough"==
c?_iframeDoc.execCommand(c,!1,null):(d.ignoreWhiteSpace=!0,rangy.queryCommandValue(c,d),execCommand(c,d,b)));if(e(c)){var E=GetParentbyTagName(t[0],"table");f(c,E)}if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag&&!(DEXTTOP.DEXT5.browser.ie&&10>=DEXTTOP.DEXT5.browser.ieVersion))for(x=0;x<t.length;x++)z="<(span|b|strong|em|i|u|strike|sup|sub)([^>]*?>)&nbsp;</(span|b|strong|em|i|u|strike|sup|sub)>",B=new RegExp(z,"gim"),t[x].innerHTML=t[x].innerHTML.replace(B,"<$1$2<br></$3>");a.removeAllRanges();
var H=DrageEndCell.lastChild;try{for(;H;){if(3==H.nodeType){H=H.parentNode;break}else if(1==H.nodeType&&void 0!=H.tagName&&-1<",img,br,".indexOf(","+H.tagName.toLowerCase()+",")){H=H.parentNode;break}H=H.lastChild}if(!DEXTTOP.DEXT5.browser.ie||"td"!=H.nodeName.toLowerCase()&&"th"!=H.nodeName.toLowerCase())"<br>"==H.innerHTML?doSetCaretPosition(H,0):doSetCaretPosition(H,1);else{var M=getCellLastChildNode(H);doSetCaretPosition(M.node,M.position)}}catch(N){doSetCaretPosition(DrageEndCell.lastChild,1)}DEXTTOP.DEXT5.browser.ie&&
(8>=DEXTTOP.DEXT5.browser.ieVersion||1==m||1==q)&&(DEXTTOP.G_CURREDITOR._LastRange=null);var I=getFirstRange().range,S=getMyChildElementNode(I.startContainer);S&&I.selectNode(S);_iframeDoc_MouseUpMenu(null,DrageEndCell);setMenuIconRealable(H)}}else{if("underline"!=c&&"strikeThrough"!=c&&DEXTTOP.DEXT5.browser.ie)if(d.ignoreWhiteSpace=!0,rangy.queryCommandValue(c,d),execCommand(c,d,b),DEXTTOP.DEXT5.browser.ie&&3==b.startContainer.nodeType&&1==b.endContainer.nodeType&&(b.endContainer.lastChild&&"br"==
b.endContainer.lastChild.tagName.toLowerCase()||0==b.endContainer.childNodes.length&&"strong"==b.endContainer.tagName.toLowerCase()&&"bold"==c||0==b.endContainer.childNodes.length&&"i"==b.endContainer.tagName.toLowerCase()&&"italic"==c||0==b.endContainer.childNodes.length&&"sup"==b.endContainer.tagName.toLowerCase()&&"superscript"==c||0==b.endContainer.childNodes.length&&"sub"==b.endContainer.tagName.toLowerCase()&&"subscript"==c))try{var F=getFirstRange(),y=F.range,D=F.sel,O=null,P;if(y.endContainer&&
1==y.endContainer.nodeType){var J=getNodeLastChildNode(y.endContainer);J&&(1==J.nodeType?(v=y.endContainer.innerText||y.endContainer.textContent,G=v.length,J=J.firstChild):3==J.nodeType&&(G=J.length));O=J;P=G}else y.endContainer&&3==y.endContainer.nodeType&&(O=y.endContainer,P=y.endContainer.length);null==O?(DEXTTOP.DEXT5.browser.gecko&&a.removeAllRanges(),a.addRange(b)):(y.setStart(b.startContainer,b.startOffset),y.setEnd(O,P),D.removeAllRanges(),D.addRange(y))}catch(L){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}else DEXTTOP.DEXT5.browser.gecko&&a.removeAllRanges(),a.addRange(b);else if(_iframeDoc.execCommand(c,!1,null),e(c)){f(c,_iframeDoc);var F=getFirstRange();if(F.sel.isCollapsed)try{var K=b.endContainer;F.range.setStartBefore(b.startContainer);F.range.setEndAfter(K);F.sel.removeAllRanges();F.sel.addRange(F.range)}catch(W){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else try{F=getFirstRange();y=F.range;D=F.sel;a=!1;y.startContainer!=b.startContainer&&1==y.startContainer.nodeType&&
3==b.startContainer.nodeType&&(y.setStart(b.startContainer,b.startOffset),a=!0);if(y.endContainer&&1==y.endContainer.nodeType){var O=y.endContainer.childNodes[y.endOffset-1],G;O&&(1==O.nodeType?(v=y.endContainer.innerText||y.endContainer.textContent,G=v.length,O=O.firstChild):3==O.nodeType&&(G=O.length));y.setEnd(O,G);a=!0}a&&(D.removeAllRanges(),D.addRange(y))}catch(Q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}setMenuIconRealable(getMyElementNode(b.startContainer))}e(c)&&_iframeDoc.execCommand("styleWithCSS",
!1,!1);if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0});onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:c})},10)}catch(X){e(c)&&_iframeDoc.execCommand("styleWithCSS",!1,!1)}}
function getCommandIconState(a){"strikeThrough"==a&&(a="strike_through");return-1<document.getElementById("dext_span_"+DEXTTOP.G_CURREDITOR.ID+a).className.indexOf("uebutton_span_enter")?!0:!1}
function DoExecuteCommandFormatting(a,b,c){try{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=function(a){"SPAN"==a.tagName&&""!=a.style.fontSize&&(a.style.fontSize=null);for(var b=a.childNodes.length,c=0;c<b;c++)d(a.childNodes[c]);return a},e=rangy.getSelection(_iframeWin);if(1==a.collapsed){var f=GetTableSelectionCells();
if(0==f.length)if(c){DEXTTOP.DEXT5.browser.ie&&(b="<"+b+">");try{if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&a.startContainer==a.endContainer){var g,h="";1==a.startContainer.nodeType?(g=a.startContainer,h=a.startContainer.innerHTML):3==a.startContainer.nodeType&&(g=a.startContainer.parentNode,h=g.innerHTML);g&&""!=h&&(h=h.replace(/<br>$/ig,""),g.innerHTML=h)}}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}_iframeDoc.execCommand("formatBlock",!1,b);if("0"!=
DEXTTOP.G_CURREDITOR._config.removeFontSizeApplyHTag){var q=DEXTTOP.DEXT5.getCaretElement(DEXTTOP.G_CURREDITOR.ID);if(q){var t=GetParentbyTagName(q,"h1");null==t&&(t=GetParentbyTagName(q,"h2"));null==t&&(t=GetParentbyTagName(q,"h3"));null==t&&(t=GetParentbyTagName(q,"h4"));null==t&&(t=GetParentbyTagName(q,"h5"));null==t&&(t=GetParentbyTagName(q,"h6"));null!=t&&(q=t);q=d(q)}}}else if(DEXTTOP.DEXT5.browser.ie){var u=GetParentbyTagName(a.startContainer,"h1");null==u&&(u=GetParentbyTagName(a.startContainer,
"h2"));null==u&&(u=GetParentbyTagName(a.startContainer,"h3"));null==u&&(u=GetParentbyTagName(a.startContainer,"h4"));null==u&&(u=GetParentbyTagName(a.startContainer,"h5"));null==u&&(u=GetParentbyTagName(a.startContainer,"h6"));if(u){var q=u,v=_iframeDoc.createElement(b);v.innerHTML=q.innerHTML;"0"!=DEXTTOP.G_CURREDITOR._config.removeFontSizeApplyHTag&&(v=d(v));_iframeDoc.body.appendChild(v);q.parentNode.replaceChild(v,q);doSetCaretPosition(v,0)}}else{if(_iframeDoc.execCommand("formatBlock",!1,b),
"0"!=DEXTTOP.G_CURREDITOR._config.removeFontSizeApplyHTag&&(q=DEXTTOP.DEXT5.getCaretElement(DEXTTOP.G_CURREDITOR.ID)))t=GetParentbyTagName(q,"h1"),null==t&&(t=GetParentbyTagName(q,"h2")),null==t&&(t=GetParentbyTagName(q,"h3")),null==t&&(t=GetParentbyTagName(q,"h4")),null==t&&(t=GetParentbyTagName(q,"h5")),null==t&&(t=GetParentbyTagName(q,"h6")),null!=t&&(q=t),q=d(q)}else{var w=f.length,y=0;for(a=0;a<w;a++){for(var x=getFormattingNode(f[a],b,c,!0),y=x.length,z=0;z<y;z++){q=x[z];v=_iframeDoc.createElement(b);
h=1==q.nodeType?q.innerHTML:q.nodeValue;if(DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&11==DEXTTOP.DEXT5.browser.ieVersion)try{h=h.replace(/<br>$/ig,""),""==h&&(h=unescape("%u200B"))}catch(B){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}v.innerHTML=h;"0"!=DEXTTOP.G_CURREDITOR._config.removeFontSizeApplyHTag&&(v=d(v));_iframeDoc.body.appendChild(v);q.parentNode.replaceChild(v,q)}0==x.length&&c&&(v=_iframeDoc.createElement(b),v.innerHTML=""==f[a].innerHTML?
DEXTTOP.DEXT5.browser.ie?"&nbsp;":"<br />":f[a].innerHTML,f[a].innerHTML="","0"!=DEXTTOP.G_CURREDITOR._config.removeFontSizeApplyHTag&&(v=d(v)),f[a].appendChild(v))}if("td"==f[w-1].nodeName.toLowerCase()||"th"==f[w-1].nodeName.toLowerCase()){e.removeAllRanges();var D=getCellLastChildNode(f[w-1]);doSetCaretPosition(D.node,D.position)}}}else{f=[];x=getFormattingNode(a,b,c);y=x.length;if(0==y&&0==b.indexOf("h")&&2==b.length){for(;"BODY"!=a.commonAncestorContainer.parentNode.tagName;)a.commonAncestorContainer=
a.commonAncestorContainer.parentNode;x=getFormattingNode(a,b,c);y=x.length}for(z=0;z<y;z++)if(q=x[z],v=_iframeDoc.createElement(b),!c||"td"!=q.tagName.toLowerCase()&&"th"!=q.tagName.toLowerCase()||!DEXTTOP.DEXT5.browser.ie||""!=q.innerHTML&&"&nbsp;"!=q.innerHTML&&q.innerHTML!=q.innerText){if(DEXTTOP.DEXT5.browser.ie&&c&&1==q.nodeType){var A=q.tagName.toLowerCase();if("h1"!=A&&"h2"!=A&&"h3"!=A&&"h4"!=A&&"h5"!=A&&"h6"!=A&&GetTDTHCell(q))continue}try{if(q&&1==q.nodeType){h=q.innerHTML;if(DEXTTOP.DEXT5.browser.ie&&
"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&11==DEXTTOP.DEXT5.browser.ieVersion)try{h=q.innerHTML.replace(/<br>$/ig,""),""==h&&(h=unescape("%u200B"))}catch(C){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}v.innerHTML=h}}catch(E){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}"0"!=DEXTTOP.G_CURREDITOR._config.removeFontSizeApplyHTag&&(v=d(v));_iframeDoc.body.appendChild(v);q.parentNode.replaceChild(v,q);f.push(v)}else v.innerHTML=q.innerHTML,""==v.innerHTML&&(v.innerHTML=
"&nbsp;"),q.innerHTML="","0"!=DEXTTOP.G_CURREDITOR._config.removeFontSizeApplyHTag&&(v=d(v)),q.appendChild(v);y=f.length;if(0<y){e.removeAllRanges();a.selectNodeContents(f[0]);var H=a.cloneRange();a.selectNodeContents(f[y-1]);a.setStart(H.startContainer,H.startOffset);a.setEnd(a.endContainer,a.endOffset);e.addRange(a)}}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0});onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"formatting"})},10)}catch(M){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function adjustSelectionExcludingNextLineStart(a,b){var c=["body","td","th","div"],d="p table h1 h2 h3 h4 h5 h6".split(" ");makeRangeSelectionMarkInDesign();var e=_iframeDoc.body.getElementsByTagName("dextmark");if(e){var f=getFirstRange().range;b.setStartBefore(e[0]);b.setEndBefore(e[0]);var g=b.startContainer;if(1==g.nodeType){var h=g.tagName.toLowerCase(),m=null;try{-1<c.indexOf(h)?m=g.childNodes[b.startOffset+1]:-1<d.indexOf(h)&&1==b.startOffset&&(m=g.nextSibling)}catch(q){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}m?(h=_iframeDoc.createElement("span"),h.id="de_temp_start_span",h.innerHTML="&nbsp;",m.appendChild(h),b.setStart(h,0),b.setEnd(f.endContainer,f.endOffset),a.sel.removeAllRanges(),a.sel.addRange(b)):(a.sel.removeAllRanges(),a.sel.addRange(f),b=getFirstRange().range)}b.setStartBefore(e[1]);b.setEndBefore(e[1]);e=b.endContainer;if(1==e.nodeType){h=e.tagName.toLowerCase();m=null;try{-1<c.indexOf(h)?m=e.childNodes[b.endOffset-1]:-1<d.indexOf(h)&&0==b.endOffset&&(m=e.previousSibling)}catch(t){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}m?(h=_iframeDoc.createElement("span"),h.id="de_temp_end_span",h.innerHTML="&nbsp;",m.appendChild(h),b.setStart(f.startContainer,f.startOffset),b.setEnd(h,0),a.sel.removeAllRanges(),a.sel.addRange(b)):(a.sel.removeAllRanges(),a.sel.addRange(f),getFirstRange())}}}
function getFormattingNode(a,b,c,d){b=[];var e=null;if(d){if(e=a.childNodes,0==e.length)return e}else e=getNodesInRange(a);for(var f=!1,g=e.length,h=0;h<g;h++){var m=e[h];if(1==m.nodeType){var q=m.tagName.toLowerCase();"html"!=q&&"body"!=q&&(f=!0,c?("h1"==q||"h2"==q||"h3"==q||"h4"==q||"h5"==q||"h6"==q||"p"==q||"pre"==q||DEXTTOP.DEXT5.browser.ie&&1!=d&&("td"==q||"th"==q))&&b.push(m):"h1"!=q&&"h2"!=q&&"h3"!=q&&"h4"!=q&&"h5"!=q&&"h6"!=q||b.push(m))}else d&&3==m.nodeType&&(!DEXTTOP.DEXT5.browser.ie||
"td"!=a.nodeName.toLowerCase()&&"th"!=a.nodeName.toLowerCase()||"\n"!=m.data)&&c&&(f=!0,b.push(m))}if(0==f)for(e=getAllNodesInBody(_iframeDoc.body,!0),g=e.length,h=0;h<g;h++)m=e[h],1==m.nodeType?(q=m.tagName.toLowerCase(),c?("h1"==q||"h2"==q||"h3"==q||"h4"==q||"h5"==q||"h6"==q||"p"==q||"pre"==q||DEXTTOP.DEXT5.browser.ie&&1!=d&&("td"==q||"th"==q))&&b.push(m):"h1"!=q&&"h2"!=q&&"h3"!=q&&"h4"!=q&&"h5"!=q&&"h6"!=q||b.push(m)):d&&3==m.nodeType&&(!DEXTTOP.DEXT5.browser.ie||"td"!=a.nodeName.toLowerCase()&&
"th"!=a.nodeName.toLowerCase()||"\n"!=m.data)&&c&&b.push(m);return b}
function DoExecuteCommand2(a,b,c,d,e){try{(0==!!e&&null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if(1==b.collapsed||0!=b.endOffset){var f=GetTableSelectionCells();-1<c.indexOf("justify")&&7==DEXTTOP.DEXT5.browser.ieVersion&&null!=ActiveCurrTable&&0==d&&(d=!1,"0"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjust&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust=
"1",d=!0),setAdjustTableWidthHeight(ActiveCurrTable),d&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="0"));if(0==f.length)"justifyLeft"!=c||DEXTTOP.DEXT5.browser.ie||_iframeDoc.execCommand("justifyFull",!1,null),-1<c.indexOf("justify")?b.commonAncestorContainer&&"BODY"!=b.commonAncestorContainer.tagName&&_iframeDoc.execCommand(c,!1,null):_iframeDoc.execCommand(c,!1,null),-1<c.indexOf("justify")&&executeTextAlign(b,c),setMenuIconRealable(getMyElementNode(b.startContainer));else{var g=f.length;d=[];
for(var h=0;h<g;h++){var m=f[h].innerHTML,m=ReplaceAll(m,unescape("\r\n"),""),m=ReplaceAll(m,unescape("\r"),""),m=ReplaceAll(m,unescape("\n"),""),m=ReplaceAll(m,unescape("%20%20"),"");f[h].innerHTML=m;a.removeAllRanges();b.selectNodeContents(f[h]);a.addRange(b);"removeFormat"==c&&d.push(f[h].getAttribute("cellOrgBgColor"));_iframeDoc.execCommand(c,!1,null);if(-1<c.indexOf("justify")){for(var q=f[h].getElementsByTagName("p"),t=q.length,u=f[h].getElementsByTagName("div"),v=u.length,w="",w="justifyFull"==
c?"justify":c.substring(7),y=null,x=0;x<t;x++)y=q[x],y.style.textAlign!=w&&(y.style.textAlign=w);for(x=0;x<v;x++)y=u[x],y.style.textAlign!=w&&(y.style.textAlign=w)}}a.removeAllRanges();if("removeFormat"==c)for(g=f.length,a=0;a<g;a++){var z=f[a];z.setAttribute("cellOrgBgColor",d[a]);z.style.backgroundColor=ColorCellBackColor;z.setAttribute("dext_select","true")}if(!DEXTTOP.DEXT5.browser.ie||"td"!=DrageEndCell.nodeName.toLowerCase()&&"th"!=DrageEndCell.nodeName.toLowerCase())doSetCaretPosition(DrageEndCell.childNodes[0],
1);else{var B=getCellLastChildNode(DrageEndCell);doSetCaretPosition(B.node,B.position)}var D=getFirstRange().range,A=getMyChildElementNode(D.startContainer);D.selectNode(A);setMenuIconRealable(A);_iframeDoc_MouseUpMenu(null,DrageEndCell)}}else _iframeDoc.execCommand(c,!1,null),-1<c.indexOf("justify")&&executeTextAlign(b,c);if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)if(D=getFirstRange().range,f=null,D&&D.startContainer&&(f=getMyElementNode(D.startContainer)),
f){var C=GetParentbyTagName(f,"td");if(C){for(var E=C.getElementsByTagName("li"),h=E.length-1;0<=h;h--)if("OL"!=E[h].parentNode.tagName&&"UL"!=E[h].parentNode.tagName){m=_iframeDoc.createElement("div");m.innerHTML=E[h].innerHTML;var H=m.firstChild;E[h].parentNode.replaceChild(H,E[h]);doSetCaretPosition(H,1)}if("<p></p>"==C.innerHTML||""==C.innerHTML)C.innerHTML=getCellDefValue()}}if(0==!!e&&null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0});onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:c})},10)}catch(M){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function DoExecuteCommand3(a,b,c,d,e){try{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if(1==b.collapsed){var f=GetTableSelectionCells();if(0==f.length)"fontcolor"==c&&(c="color"),"fontbgcolor"==c&&(c="backgroundColor"),"lineheight"==c&&(c="lineHeight"),InsertFontElement(c,e);else{var g=f.length;e=[];var h="BackCompat"==
DEXTTOP.G_CURREDITOR._DOC.compatMode,m=DEXTTOP.DEXT5.browser.quirks;if(DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||1==h||1==m))for(var q=0;q<g;q++){var t=f[q];"<p></p>"==t.innerHTML.toLowerCase()?t.innerHTML="<p>&nbsp;</p>":"<span></span>"==t.innerHTML.toLowerCase()?t.innerHTML="<span>&nbsp;</span>":""==t.innerHTML.toLowerCase()&&(t.innerHTML="&nbsp;")}for(q=0;q<g;q++){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var u="<(p|span)([^>]*?>)<br ?/?></(p|span)>",v=new RegExp(u,
"gim");f[q].innerHTML=f[q].innerHTML.replace(v,"<$1$2&nbsp;</$3>")}a.removeAllRanges();b.selectNode(f[q]);a.addRange(b);rangy.queryCommandValue(c,d);if("fontbgcolor"==c&&(e.push(f[q].getAttribute("cellOrgBgColor")),DEXTTOP.DEXT5.browser.ie)){var w=colorToHex(d.fontcolor),y=colorToHex(f[q].style.backgroundColor);w==y&&(f[q].style.backgroundColor="")}execCommand(c,d);rangy.getSelection(_iframeWin).removeAllRanges();"1"!=DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag||DEXTTOP.DEXT5.browser.ie&&10>=
DEXTTOP.DEXT5.browser.ieVersion||(u="(<span[^>]*?>)&nbsp;</span>",v=new RegExp(u,"gim"),f[q].innerHTML=f[q].innerHTML.replace(v,"$1<br></span>"))}a.removeAllRanges();if("fontbgcolor"==c)for(g=f.length,a=0;a<g;a++){var x=f[a];x.setAttribute("cellOrgBgColor",e[a]);x.style.backgroundColor=ColorCellBackColor;x.setAttribute("dext_select","true")}var z=DrageEndCell.lastChild;try{for(;z;){if(3==z.nodeType){z=z.parentNode;break}else if(1==z.nodeType&&void 0!=z.tagName&&-1<",img,br,".indexOf(","+z.tagName.toLowerCase()+
",")){z=z.parentNode;break}z=z.lastChild}if(!DEXTTOP.DEXT5.browser.ie||"td"!=z.nodeName.toLowerCase()&&"th"!=z.nodeName.toLowerCase())"<br>"==z.innerHTML?doSetCaretPosition(z,0):doSetCaretPosition(z,1);else{var B=getCellLastChildNode(z);doSetCaretPosition(B.node,B.position)}}catch(D){doSetCaretPosition(DrageEndCell.childNodes[0],1)}!DEXTTOP.DEXT5.browser.ie||8!=DEXTTOP.DEXT5.browser.ieVersion&&1!=h&&1!=m||(DEXTTOP.G_CURREDITOR._LastRange=null)}}else{f=h=!1;g="";"1"==DEXTTOP.G_CURREDITOR._config.applyStyleToLiNode&&
_iframeDoc.createTreeWalker&&(h=!0);h&&-1<",fontSize,fontFamily,fontcolor,".indexOf(","+c+",")&&-1<getNodesInRange(b).toString().indexOf("LIElement")&&(f=!0,g=c,"fontcolor"==g&&(g="color"));d.ignoreWhiteSpace=!0;rangy.queryCommandValue(c,d);h=null;m="";try{if("fontbgcolor"==c){var A=b.commonAncestorContainer.parentNode;A&&1==A.nodeType&&(h=GetTDTHCell(A));h&&(m=h.style.backgroundColor)}}catch(C){h=null}if(!b.commonAncestorContainer.tagName||"BODY"!=b.commonAncestorContainer.tagName&&"DIV"!=b.commonAncestorContainer.tagName)execCommand(c,
d,b);else try{var E=b.getNodes(),H=E.length;if(500<H){A=[];for(q=0;q<H;q++)if(3==E[q].nodeType){var M=E[q].parentNode;1==M.nodeType&&"BODY"!=M.tagName&&A.push(M)}for(q=0;q<A.length;q++)"fontcolor"==c?A[q].style.color=e:"fontbgcolor"==c?A[q].style.backgroundColor=e:"lineheight"==c?A[q].style.lineHeight=e:"fontSize"==c?A[q].style.fontSize=e:"fontFamily"==c&&(A[q].style.fontFamily=e)}else execCommand(c,d,b)}catch(N){execCommand(c,d,b)}1==f&&getLiNodesForStyle(g);h&&(h.style.backgroundColor=m);DEXTTOP.DEXT5.browser.ie&&
(9>DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)||a.removeAllRanges();a.addRange(b);!DEXTTOP.DEXT5.browser.ie||"fontFamily"!=c&&"fontSize"!=c||(DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID))}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;setTimeout(function(){onChange({editor:DEXTTOP.G_CURREDITOR,
isPossibleDirty:!0});onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:c})},10)}catch(I){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function getSelectionTable(a){if(DEXTTOP.DEXT5.browser.ie&&!(11<DEXTTOP.DEXT5.browser.ieVersion)){a=getFirstRange().range;var b,c,d=a.collapsed,e;try{if(!d){b=_iframeDoc.createElement("span");b.style.display="none";b.innerHTML="&nbsp;";c=a.cloneRange();c.collapse();c.insertNode(b);var f;b&&(f=b.previousSibling);f&&1==f.nodeType&&"table"==f.tagName.toLowerCase()&&(e=f)}}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}b&&b.parentNode&&b.parentNode.removeChild(b);return e}}
function setBlockTag(a,b,c,d){for(var e="p li dt dd h1 h2 h3 h4 h5 h6 pre table hr blockquote address iframe figure".split(" "),f=["body","td","th","div"],g="b big i small tt abbr acronym cite code dfn em kbd strong samp var a bdo br img map object q script span sub sup button input label select textarea u s strike".split(" "),h=a.length,m=0;m<h;m++)if(a[m]){var q=a[m].tagName;q&&(q=q.toLowerCase());if(3!=a[m].nodeType||/\S/.test(a[m].nodeValue))if(3==a[m].nodeType||-1<g.indexOf(q)){for(var t=a[m];;){if(-1<
e.indexOf(t.parentNode.tagName.toLowerCase())){-1<b.indexOf(t.parentNode.tagName.toLowerCase())&&("lineHeight"==c?"span"==t.parentNode.tagName.toLowerCase()?""!=t.parentNode.style.lineHeight&&(t.parentNode.style.lineHeight=d):t.parentNode.style.lineHeight=d:"letterSpacing"==c?"span"==t.parentNode.tagName.toLowerCase()?""!=t.parentNode.style.letterSpacing&&(t.parentNode.style.letterSpacing=d):t.parentNode.style.letterSpacing=d:"align"==c?(""!=t.parentNode.style.layoutGridMode&&(t.parentNode.style.layoutGridMode=
"none"),t.parentNode.style.textAlign=d):"paragraphAttribute"==c&&(""!=d.marginLeft.toString()&&(t.parentNode.style.marginLeft=d.marginLeft+d.marginLeftType),""!=d.marginRight.toString()&&(t.parentNode.style.marginRight=d.marginRight+d.marginRightType),""!=d.marginTop.toString()&&(t.parentNode.style.marginTop=d.marginTop+d.marginTopType),""!=d.marginBottom.toString()&&(t.parentNode.style.marginBottom=d.marginBottom+d.marginBottomType),""!=d.letterSpacing.toString()&&(t.parentNode.style.letterSpacing=
d.letterSpacing+"px"),""!=d.wordSpacing.toString()&&(t.parentNode.style.wordSpacing=d.wordSpacing+"px"),""!=d.textIndent.toString()&&(t.parentNode.style.textIndent=d.textIndent+d.textIndentType),""!=d.fontSize.toString()&&(t.parentNode.style.fontSize=d.fontSize+d.fontType),""!=d.fontFamily.toString()&&("default"==d.fontFamily?t.parentNode.style.fontFamily="":t.parentNode.style.fontFamily=d.fontFamily)));t=null;break}else if(-1<f.indexOf(t.parentNode.tagName.toLowerCase()))break;t=t.parentNode}if(t){for(var q=
[t],u=t.previousSibling;;){try{if(null==u||-1<e.indexOf(u.tagName.toLowerCase())||"div"==u.tagName.toLowerCase())break}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}q.unshift(u);u=u.previousSibling}for(t=t.nextSibling;;){try{if(null==t||-1<e.indexOf(t.tagName.toLowerCase())||"div"==t.tagName.toLowerCase())break}catch(w){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}q.push(t);t=t.nextSibling}t=_iframeDoc.createElement("p");"lineHeight"==c?t.style.lineHeight=d:"letterSpacing"==
c?t.style.letterSpacing=d:"align"==c?t.style.textAlign=d:"indent"==c?(u=parseIntOr0(t.style.marginLeft),0<u?t.style.marginLeft=u+d+"px":(u=parseIntOr0(t.style.paddingLeft),t.style.paddingLeft=u+d+"px")):"paragraphAttribute"==c&&(""!=d.marginLeft.toString()&&(t.style.marginLeft=d.marginLeft+d.marginLeftType),""!=d.marginRight.toString()&&(t.style.marginRight=d.marginRight+d.marginRightType),""!=d.marginTop.toString()&&(t.style.marginTop=d.marginTop+d.marginTopType),""!=d.marginBottom.toString()&&(t.style.marginBottom=
d.marginBottom+d.marginBottomType),""!=d.letterSpacing.toString()&&(t.style.letterSpacing=d.letterSpacing+"px"),""!=d.wordSpacing.toString()&&(t.style.wordSpacing=d.wordSpacing+"px"),""!=d.textIndent.toString()&&(t.style.textIndent=d.textIndent+d.textIndentType),""!=d.fontSize.toString()&&(t.style.fontSize=d.fontSize+d.fontType),""!=d.fontFamily.toString()&&("default"==d.fontFamily?t.style.fontFamily="":t.style.fontFamily=d.fontFamily));q[0].parentNode.insertBefore(t,q[0]);var u=q.length,y,x,z;if("lineHeight"==
c||"align"==c||"letterSpacing"==c)try{y=getFirstRange(),x=y.range,z=y.sel}catch(B){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}for(var D=0;D<u;D++)t.appendChild(q[D]);if("lineHeight"==c||"align"==c||"letterSpacing"==c)if(q=DEXTTOP.G_CURREDITOR.beforeOffset)try{var A=GetTableSelectionCells();if(A&&0==A.length){var C,E,u=!0;"TD"==q[2].tagName?C=t:(C=q[2],u=!1);if("TD"==q[3].tagName){if(E=t,0==u){for(var u=C,H=u.parentNode;H!=t;)u=H,H=H.parentNode;E=u.nextSibling;for(var M=q[4],M=M-((C.innerText||
C.textContent).length-q[0]),t=0;null!=E;){var N=(E.innerText||E.textContent).length;if(M<N){t=M;q[1]=t;break}else M-=N,E=E.nextSibling}}}else E=q[3];x.setStart(C.firstChild,q[0]);1==E.nodeType&&(E=E.firstChild);x.setEnd(E,q[1]);z.removeAllRanges();z.addRange(x);DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID)}else DEXTTOP.G_CURREDITOR.beforeOffset=null}catch(I){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}}}
function GetParentbyTagName(a,b,c){null==a&&1==c&&(c=getFirstRange().range)&&c.startContainer&&(a=getMyElementNode(c.startContainer),a=GetTDTHCell(a),DEXTTOP.G_SELECTED_ELEMENT=a);for(;!(null==a||a.tagName&&a.tagName.toLowerCase()==b||a.tagName&&a.tagName.toLowerCase()==b&&null==a.parentNode);)a=a.parentNode;return a}
function getParentbyTagNameEx(a,b){for(var c=a,d=","+b+",";!(null==c||c.tagName&&-1<d.indexOf(","+c.tagName.toLowerCase()+",")||c.tagName&&-1<d.indexOf(","+c.tagName.toLowerCase()+",")&&null==c.parentNode);)c=c.parentNode;return c}
function _iframeDoc_DBClick(a){setDEXTWINDOC();var b=getEditrFromEvent(a);if(!isViewMode(b)){var c,d=a?a:event;c=d.target?d.target:d.srcElement;if(0==checkContentEditable(b,c))DEXTTOP.DEXT5.util.cancelEvent(a);else{if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){a=GetTDTHCell(c);var e;a&&(e=GetParentbyTagName(c,"table"));b=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;e&&("2"==DEXTTOP.G_CURREDITOR._config.userTableLock.tableLockMode?
checkLockAttr(e,!0)||checkLockAttr(a,!0)?e.getAttribute("lock_mode")&&""!=e.getAttribute("lock_mode")&&(b=e.getAttribute("lock_mode")):b="0":e.getAttribute("lock_mode")&&""!=e.getAttribute("lock_mode")&&(b=e.getAttribute("lock_mode")));var f=!0;"1"==b?f=!1:"0"==b&&(f=!1,a=null);if(a){if(f&&checkLockAttr(e)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):(c=findNoLockElem(e))?setFocusForLock(c):(window.focus(),document.body.focus());DEXTTOP.DEXT5.util.stopEvent(d);
DEXTTOP.DEXT5.util.cancelEvent(d);return}if(checkLockAttr(a,!f)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):setFocusForLock(findNoLockCell(e));DEXTTOP.DEXT5.util.stopEvent(d);DEXTTOP.DEXT5.util.cancelEvent(d);return}}}e=c.tagName.toLowerCase();"img"!=e&&"hr"!=e&&"a"!=e&&"input"!=e&&"textarea"!=e&&"select"!=e&&(a=GetParentbyTagName(c,"a"))&&(c=a,e=c.tagName.toLowerCase());if("1"==DEXTTOP.G_CURREDITOR._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=
!1;try{"function"==typeof DEXTTOP.G_CURREDITOR._config.event.mouse?DEXTTOP.G_CURREDITOR._config.event.mouse("dblclick",d,c):"function"===typeof DEXTTOP.DEXTWIN.dext_mouse_event&&DEXTTOP.DEXTWIN.dext_mouse_event("dblclick",d,c)}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(d);return}}if(c.getAttribute("raon_plugin")){var h=c.getAttribute("raon_plugin"),m=_dext_editor._FRAMEWIN.G_DEPlugin;switch(e){case "img":try{if("function"===
typeof m[h].onDbClickImage){var q={elem:c,runFlag:!0},t=m[h].onDbClickImage(q);if(!1===t.runFlag)return}}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}break;default:try{if("function"===typeof m[h].onDbClickElement&&(q={elem:c,runFlag:!0},t=m[h].onDbClickElement(q),!1===t.runFlag))return}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}switch(e){case "img":DEXTTOP.G_SELECTED_ELEMENT=c;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){d=!0;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.managerImg?
d=DEXTTOP.G_CURREDITOR._config.event.managerImg(c,DEXTTOP.G_CURREDITOR.ID):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_img_event&&(d=DEXTTOP.DEXTWIN.dext_editor_img_event(c,DEXTTOP.G_CURREDITOR.ID))}catch(w){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}null!=d&&void 0!=d&&0==d&&(d=!1);if(!d)return}setSelectoinElement(c);d=c.getAttribute("dext5customdata");if(null!=d&&void 0!=d)if(h=getDextCustomData(d),"iframe"==h.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.iframe);else if("flash"==h.type)DEXTTOP.G_CURREDITOR.dialogOpenCmd="DBClick_flash",DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.flash);else if("media"==h.type)DEXTTOP.G_CURREDITOR.dialogOpenCmd="DBClick_media",DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.media);else if("link_media"==h.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.insert_link_media);else if("hidden"==h.type){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){d=!0;c={};c.type=h.type;c.id=h.id;c.name=h.name;c.value=h.value;c.className=h.className;c.title=h.title;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.managerInput?d=DEXTTOP.G_CURREDITOR._config.event.managerInput(c,DEXTTOP.G_CURREDITOR.ID):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_input_event&&(d=DEXTTOP.DEXTWIN.dext_editor_input_event(c,DEXTTOP.G_CURREDITOR.ID))}catch(y){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}null!=d&&void 0!=d&&0==d&&(d=!1);if(!d)return;DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_hidden)}}else"video_media"==h.type&&(DEXTTOP.G_CURREDITOR.dialogOpenCmd="DBClick_video_media",DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.video));else{try{for(h in m=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_DEPlugin,m)if("function"===
typeof m[h].onDbClickImage&&(q={elem:c,runFlag:!0},t=m[h].onDbClickImage(q),!1===t.runFlag))return}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}""==DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick||c.className!=DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick&&c.alt!=DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick?G_dext5plugIn&&"0"==DEXTTOP.G_CURREDITOR._config.userPluginModeSetting.useHtml5ModeForImage?showSetImageProperty(c):(DEXTTOP.G_CURREDITOR.dialogOpenCmd=
"DBClick_img",DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.image)):command_custom(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick,c)}break;case "flash":DEXTTOP.G_CURREDITOR.dialogOpenCmd="DBClick_flash";DEXTTOP.G_SELECTED_ELEMENT=c;setSelectoinElement(c);DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.flash);break;
case "media":DEXTTOP.G_CURREDITOR.dialogOpenCmd="DBClick_media";DEXTTOP.G_SELECTED_ELEMENT=c;setSelectoinElement(c);DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.media);break;case "hr":DEXTTOP.G_SELECTED_ELEMENT=c;setSelectoinElement(c);DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.horizontal_line);break;case "a":DEXTTOP.G_SELECTED_ELEMENT=c;setSelectoinElement(c);h=
getFirstRange();h=h.range;m=getFirstRange().sel;m.removeAllRanges();h.selectNode(c);m.addRange(h);h=c.getAttribute("DEXT5InsertFile");""==DEXTTOP.G_CURREDITOR._config.customEventCmd.hyperLink.ondbclick||c.className!=DEXTTOP.G_CURREDITOR._config.customEventCmd.hyperLink.ondbclick&&c.title!=DEXTTOP.G_CURREDITOR._config.customEventCmd.hyperLink.ondbclick?""==c.href&&c.name==c.id?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.bookmark):
""==h?(DEXTTOP.G_CURREDITOR.dialogOpenCmd="DBClick_a",DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.insert_file)):(DEXTTOP.G_CURREDITOR.dialogOpenCmd="DBClick_a",DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.hyperlink)):command_custom(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._config.customEventCmd.hyperLink.ondbclick,c);break;case "iframe":DEXTTOP.G_SELECTED_ELEMENT=
c;setSelectoinElement(c);DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.iframe);break;case "table":DEXTTOP.G_SELECTED_ELEMENT=c;if(null==GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table",!0)||null==GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"td",!0))break;if("1"==DEXTTOP.G_CURREDITOR._config.formMode||"1"!=DEXTTOP.G_CURREDITOR._config.userTableLock.use)h=getFirstRange(),(m=h.sel)&&m.docSelection&&"Control"==m.docSelection.type?
DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,DEXTTOP.G_SELECTED_ELEMENT):(m._ranges.length=m.rangeCount=m.nativeSelection.rangeCount,m.rangeCount&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,DEXTTOP.G_SELECTED_ELEMENT));break;case "input":DEXTTOP.G_SELECTED_ELEMENT=c;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){d=!0;try{"function"===
typeof DEXTTOP.G_CURREDITOR._config.event.managerInput?d=DEXTTOP.G_CURREDITOR._config.event.managerInput(c,DEXTTOP.G_CURREDITOR.ID):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_input_event&&(d=DEXTTOP.DEXTWIN.dext_editor_input_event(c,DEXTTOP.G_CURREDITOR.ID))}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}null!=d&&void 0!=d&&0==d&&(d=!1);if(!d)return}"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(""==c.type||"text"==c.type||"password"==c.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.input_text):"radio"==c.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_radio):"checkbox"==c.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_checkbox):"button"==c.type||"reset"==c.type||"submit"==c.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_button):
"hidden"==c.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_hidden):"image"==c.type&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_image));break;case "select":DEXTTOP.G_SELECTED_ELEMENT=c;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){d=!0;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.managerSelect?d=DEXTTOP.G_CURREDITOR._config.event.managerSelect(c,
DEXTTOP.G_CURREDITOR.ID):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_select_event&&(d=DEXTTOP.DEXTWIN.dext_editor_select_event(c,DEXTTOP.G_CURREDITOR.ID))}catch(B){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}null!=d&&void 0!=d&&0==d&&(d=!1);if(!d)return}"1"==DEXTTOP.G_CURREDITOR._config.formMode&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_select);break;case "textarea":DEXTTOP.G_SELECTED_ELEMENT=c;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){d=
!0;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.managerTextArea?d=DEXTTOP.G_CURREDITOR._config.event.managerTextArea(c,DEXTTOP.G_CURREDITOR.ID):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_textarea_event&&(d=DEXTTOP.DEXTWIN.dext_editor_textarea_event(c,DEXTTOP.G_CURREDITOR.ID))}catch(D){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}null!=d&&void 0!=d&&0==d&&(d=!1);if(!d)return}"1"==DEXTTOP.G_CURREDITOR._config.formMode&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.input_textarea)}"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&(DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&hyperLinkOut(),DEXTTOP.G_CURREDITOR.isAOver.openHelp&&hyperHelpClose())}}}function setSelectoinElement(a){var b=getFirstRange().range;if(b)if(""==b.toString()&&a){var c=getFirstRange().sel;c.removeAllRanges();b.selectNode(a);c.addRange(b)}else rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b)}
function _iframeBody_Click(a){setDEXTWINDOC();var b=_dext_editor;_dext_editor.ID!=b.ID&&(DEXTTOP.G_CURREDITOR=b);if(!checkDefaultMessage(a)){var c,d;try{d=a?a:event,d.srcElement?c=d.srcElement:d.target&&(c=d.target)}catch(e){setFocusToBody();return}if(isViewMode(b)&&c){if("a"!=c.tagName.toLowerCase()&&(c=GetParentbyTagName(c,"a")),c&&c.getAttribute("href")&&!(-1<c.getAttribute("href").indexOf("#"))){var f=c.getAttribute("target");c.setAttribute("target","_blank");setTimeout(function(){f&&""!=f?c.setAttribute("target",
f):c.removeAttribute("target")},1)}}else{var g=!1;if(c.tagName&&"INPUT"==c.tagName&&(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari?g=!0:0==c.isContentEditable&&(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.gecko)&&(g=!0),g)){var h=null,m=a?a:_iframeWin.event,h=m.target?m.target:m.srcElement;if("checkbox"==h.type.toLowerCase()||"radio"==h.type.toLowerCase())if(1==h.checked){if("radio"==h.type.toLowerCase())for(var q=_iframeDoc.getElementsByName(h.name),
t=q.length,u=0;u<t;u++)q[u].checked=!1,q[u].removeAttribute("checked");h.checked=!0;h.setAttribute("checked","checked")}else h.checked=!1,h.removeAttribute("checked")}if("1"!=b._config.formMode&&"1"==b._config.userTableLock.use){var q=GetTDTHCell(c),v;q&&(v=GetParentbyTagName(c,"table"));t=b._config.userTableLock.defaultTableLockMode;v&&("2"==b._config.userTableLock.tableLockMode?checkLockAttr(v,!0)||checkLockAttr(q,!0)?v.getAttribute("lock_mode")&&""!=v.getAttribute("lock_mode")&&(t=v.getAttribute("lock_mode")):
t="0":v.getAttribute("lock_mode")&&""!=v.getAttribute("lock_mode")&&(t=v.getAttribute("lock_mode")));u=!0;"1"==t?u=!1:"0"==t&&(u=!1,q=null);if(q){if(u&&checkLockAttr(v)){b.lastElemForLock?setFocusForLock(b.lastElemForLock):(a=findNoLockElem(v))?setFocusForLock(a):(window.focus(),document.body.focus());g||(DEXTTOP.DEXT5.util.stopEvent(d),DEXTTOP.DEXT5.util.cancelEvent(d));return}if(checkLockAttr(q,!u)){b.lastElemForLock?setFocusForLock(b.lastElemForLock):setFocusForLock(findNoLockCell(v));g||(DEXTTOP.DEXT5.util.stopEvent(d),
DEXTTOP.DEXT5.util.cancelEvent(d));return}b.lastElemForLock=q}}if(g=repairCaretNearTable())c=g,3==c.nodeType&&(c=c.parentNode);if("1"==b._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{"function"===typeof b._config.event.mouse?b._config.event.mouse("click",m,h):"function"===typeof DEXTTOP.DEXTWIN.dext_mouse_event&&DEXTTOP.DEXTWIN.dext_mouse_event("click",m,h)}catch(w){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(d);
return}}if((g=c.tagName?c.tagName.toLowerCase():null)&&("textarea"==g||"input"==g||"select"==g||"div"==g))return setMenuIconRealable(c),!1;if(0==DEXTTOP.DEXT5.browser.ie&&3==d.detail&&GetParentbyTagName(c,"table")){d=getFirstRange();var y=d.range;d=d.sel;y.collapse(!0);d.removeAllRanges();y.selectNode(c);d.addRange(y)}if(DEXTTOP.DEXT5.browser.ie&&7==DEXTTOP.DEXT5.browser.ieVersion)try{if((y=getFirstRange().range)&&y.startContainer&&(c=getMyElementNode(y.startContainer)),void 0==c)return}catch(x){return}d=
c.tagName.toLowerCase();try{if("html"==d||"body"==d){g=!1;500>a.clientX&&10>a.clientY&&(g=!0);repairBodyFirstLastTag(g);var z=getFirstRange().range,B=z.startOffset,D=z.endOffset;if("body"==z.endContainer.nodeName.toLowerCase()&&B==D){var A=_iframeDoc.body,z=null;if(A.childNodes[B]&&"table"==A.childNodes[B].nodeName.toLowerCase())z=A.childNodes[B].getElementsByTagName("td")[0];else if(A.childNodes[B-1]&&"table"==A.childNodes[B-1].nodeName.toLowerCase())var C=A.childNodes[B-1].getElementsByTagName("td"),
z=C[C.length-1];doSetCaretPosition(z,1)}if(DEXTTOP.DEXT5.browser.ie&&0==DEXTTOP.DEXT5.browser.quirks&&7!=DEXTTOP.DEXT5.browser.ieVersion){if((y=getFirstRange().range)&&1==y.collapsed&&_iframeDoc.body.createTextRange){var y=_iframeDoc.body.createTextRange(),E=a.clientX,H=a.clientY;"None"==b._setting.doctype&&(E<y.boundingLeft&&(E=y.boundingLeft),"html"==d&&H>y.boundingHeight-(y.offsetTop-y.boundingTop)&&("None"!=b._setting.doctype&&(E=y.boundingWidth+y.boundingLeft),H=y.boundingHeight-(y.offsetTop-
y.boundingTop),"None"==b._setting.doctype&&--H));try{y.moveToPoint(E,H),y.select()}catch(M){b.isInitFocusHandler=!1,setFocusToBody()}}setFocusToBody()}else if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){var N=getFirstRange().range;if(1==N.collapsed){b=null;try{createSelectionFromPoint(a.clientX,a.clientY,a.clientX,a.clientY),setFocusToBody(),N=getFirstRange().range,b=_iframeDoc.createElement("dexttemp"),N.insertNode(b),null!=b.nextSibling&&doSetCaretPosition(b.nextSibling,!1)}catch(I){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}b&&b.parentNode.removeChild(b)}}else setFocusToBody();if((c=getFirstRange().sel.focusNode)&&3==c.nodeType)for(;1!=c.nodeType;)if(c.parentNode)c=c.parentNode;else break;else(y=getFirstRange().range)&&y.startContainer==y.endContainer&&1==y.collapsed&&(c=getMyElementNode(y.startContainer));setMenuIconRealable(c)}else setTimeout(function(){if((c=getFirstRange().sel.focusNode)&&3==c.nodeType)for(;1!=c.nodeType;)if(c.parentNode)c=c.parentNode;else break;else{var a=
getFirstRange().range;a&&a.startContainer==a.endContainer&&1==a.collapsed&&(c=getMyElementNode(a.startContainer))}setMenuIconRealable(c)},0)}catch(S){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}}
function createCollapsedRangeFromPoint(a,b){var c=_iframeDoc,d,e=null;if("undefined"!=typeof c.body.createTextRange)e=c.body.createTextRange(),e.moveToPoint(a,b);else if("undefined"!=typeof c.caretPositionFromPoint)d=c.caretPositionFromPoint(a,b),e=c.createRange(),e.setStart(d.offsetNode,d.offset),e.collapse(!0);else if("undefined"!=typeof c.caretRangeFromPoint)c.caretRangeFromPoint(a,b);else return e}
function insertPtagTableNear(a,b){var c=getFirstRange().range;if(c&&b){c.selectNode(b);a?(c.setStartBefore(b),c.collapse(!0)):(c.setEndAfter(b),c.collapse(!1));var d=_iframeDoc.createElement("p");DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion||(d.innerHTML=getDefaultParagraphValue(!1));c.insertNode(d);doSetCaretPosition(d,0)}}
function moveCaret(a){var b;if(_iframeWin.getSelection){if(b=_iframeWin.getSelection(),0<b.rangeCount){var c=b.focusNode;b.collapse(c,Math.min(c.length,b.focusOffset+a))}}else(b=_iframeDoc.selection)&&"Control"!=b.type&&(b=b.createRange(),b.move("character",a),b.select())}
function setMenuIconRealable(a){if(null!=a&&void 0!=a){if("body"==a.tagName.toLowerCase()){var b=getSelectionTable(DEXTTOP.G_CURREDITOR);b&&(a=b)}DEXTTOP.DEXT5.browser.ie&&("td"==a.nodeName.toLowerCase()||"th"==a.nodeName.toLowerCase())&&a.lastChild&&a.lastChild.previousSibling&&(3==a.lastChild.nodeType&&"\n"==a.lastChild.data&&3!=a.lastChild.previousSibling.nodeType?a=a.lastChild.previousSibling:3!=a.lastChild.nodeType&&(a=a.lastChild));G_DEPlugin.customformatting&&G_DEPlugin.customformatting.getCustomformattingName(_dext_editor.ID,
a);var b=getElementInParentTag(a,G_FORMATTING),c="";try{c=getFontStyle(a).fontFamily}catch(d){c=getElementInParentStyleProperty(a,"fontFamily")}var e=getElementInParentStyleProperty(a,"fontSize"),f=getElementInParentStyleProperty(a,"lineHeight");"1"!=DEXTTOP.G_CURREDITOR._config.lineHeightMode&&(c=getFontFamilyStyle(c),""==e&&(e=DEXTTOP.DEXT5.util.getStyle(a,"fontSize")),""==f&&(f=DEXTTOP.DEXT5.util.getStyle(a,"lineHeight")),e=getFontSizeStyle(e,f),f=getLineHeightStyle(e,f,a),-1<f.toString().indexOf("normal")||
-1<f.toString().indexOf("inherit"))&&(f=dext5_lang.icon.line_height);var g=getElementInParentStyleProperty(a,"letterSpacing");""==g&&(g=dext5_lang.icon.letter_spacing);if("0"==DEXTTOP.G_CURREDITOR._setting.show_font_real)e==DEXTTOP.G_CURREDITOR._setting.font_size&&(e=dext5_lang.icon.font_size),c==DEXTTOP.G_CURREDITOR._setting.font_family&&(c=dext5_lang.icon.font_family),""==e&&(e=dext5_lang.icon.font_size),""==c&&(c=dext5_lang.icon.font_family),""==f&&(f=dext5_lang.icon.line_height);else{var h,m,
q;if(""==e||""==c||""==f)m=getFontStyle(a),h=m.fontFamily,q=m.lineHeight,m=getFontStyle(a,!0),m=m.fontSize;""==e&&(e=""!=m&&void 0!=m?m:dext5_lang.icon.font_size);""==c&&(c=""!=h?h:dext5_lang.icon.font_family);""==f&&(f=q&&""!=q&&"normal"!=q?q:dext5_lang.icon.line_height);if(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion){try{f=f.toString()}catch(t){f=""}try{if(h=!1,0>f.indexOf("%")&&0>f.indexOf("px")&&0>f.indexOf("pt")&&0>f.indexOf("em")&&(h=!0),
"1"!=DEXTTOP.G_CURREDITOR._config.lineHeightMode)if(h)u=DEXTTOP.G_CURREDITOR._setting.line_height,v="",-1<u.indexOf("%")?v=parseInt(u,10)/100+.01:0>u.indexOf("px")&&0>u.indexOf("pt")&&0>u.indexOf("em")&&(v=parseFloat(u)+.01),v=v.toString(),f==v&&(-1<u.indexOf("%")?f=parseFloat(u)/100:0>u.indexOf("px")&&0>u.indexOf("pt")&&0>u.indexOf("em")&&(f=u));else{if(-1<f.indexOf("%")){var u=DEXTTOP.G_CURREDITOR._setting.line_height,v="";-1<u.indexOf("%")?v=parseInt(u,10)+1:0>u.indexOf("px")&&0>u.indexOf("pt")&&
0>u.indexOf("em")&&(v=100*parseFloat(u)+1);v=v.toString();f==v+"%"&&(-1<u.indexOf("%")?f=u+"%":0>u.indexOf("px")&&0>u.indexOf("pt")&&0>u.indexOf("em")&&(f=100*parseFloat(u)+"%"))}}else u=DEXTTOP.G_CURREDITOR._setting.line_height,v="",-1<u.indexOf("%")?v=parseInt(u,10)/100+.01:0>u.indexOf("px")&&0>u.indexOf("pt")&&0>u.indexOf("em")&&(v=parseFloat(u)+.01),v=v.toString(),f==v&&(f=100*parseFloat(u)+"%")}catch(w){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}""==b&&(b=dext5_lang.icon.formatting);
if(u=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"formatting"))u.innerHTML="<span>"+b+"</span>";u=null;if("1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin){if(u=document.getElementById("txtara_"+DEXTTOP.G_CURREDITOR.ID+"line_height"))u.value=f}else if(u=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"line_height"))u.innerHTML="<span>"+f+"</span>";u=null;if(u="1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?document.getElementById("txtara_"+DEXTTOP.G_CURREDITOR.ID+"font_size"):
document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"font_size")){try{if(-1<e.indexOf(".")&&(v="",-1<e.indexOf("px")||-1<e.indexOf("pt")||-1<e.indexOf("em")?v=e.substring(e.length-2):-1<e.indexOf("%")&&(v=e.substring(e.length-1)),"pt"!=v))var y=parseFloat(e),y=Math.round(10*y)/10,e=y+v}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}"1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?u.value=e:u.innerHTML="<span>"+e+"</span>"}y=null;if("1"==DEXTTOP.G_CURREDITOR._config.useFontFamilyKeyin){if(y=
document.getElementById("txtara_"+DEXTTOP.G_CURREDITOR.ID+"font_family"))u=getDisplayFontName(c),y.value=u}else if(y=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"font_family"))u=getDisplayFontName(c),y.innerHTML="<span>"+u+"</span>";if(y=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"letter_spacing"))y.innerHTML="<span>"+g+"</span>";v=GetTDTHCell(a);y=[];u=a;DEXTTOP.DEXT5.browser.ie&&(u=getNodeLastChildNode(a));if(!(h=""!=getElementInParentTag(u,["b","strong"]))&&(h=v&&"th"==v.nodeName.toLowerCase())){a:{if(v=
GetTDTHCell(v).getElementsByTagName("span"))for(h=v.length,q=0;q<h;q++)if(v[q].style&&"normal"==v[q].style.fontWeight){v=!0;break a}v=!1}h=!v}h&&y.push("bold");""!=getElementInParentTag(u,["em","i"])&&y.push("italic");""!=getElementInParentTag(u,["u"])&&y.push("underline");""!=getElementInParentTag(u,["strike"])&&y.push("strike_through");""!=getElementInParentTag(u,["sup"])&&y.push("superscript");""!=getElementInParentTag(u,["sub"])&&y.push("subscript");""!=getElementInParentTag(u,["ol"])&&y.push("list_number");
""!=getElementInParentTag(u,["ul"])&&y.push("list_bullets");var z;DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem&&(z=GetParentbyTagName(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem,"figure"));if("table"==a.tagName.toLowerCase()){if(z=a.getAttribute("align"),null==z||""==z)z="justify"}else z?(z="cssFloat"in z.style?z.style.cssFloat:z.style.styleFloat,""==z&&(z=DEXTTOP.DEXT5.util.getStyle(a,"textAlign"),""==z&&(z=getElementInParentProperty(a,"align")))):
(z=DEXTTOP.DEXT5.util.getStyle(a,"textAlign"),""==z&&(z=getElementInParentProperty(a,"align")));"left"==z&&y.push("align_left");"center"==z&&y.push("align_center");"right"==z&&y.push("align_right");"justify"==z&&y.push("align_full");z=getElementInParentProperty(a,"dir").toLowerCase();"rtl"==z&&y.push("dirrtl");"ltr"==z&&y.push("dirltr");try{null==DrageEndCell&&""==getElementInParentTag(a,"h1 h2 h3 h4 h5 h6".split(" "))&&(_iframeDoc.queryCommandState("bold")?y.push("bold"):removeArrayItemByValue(y,
"bold"))}catch(B){removeArrayItemByValue(y,"bold")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("italic")?y.push("italic"):removeArrayItemByValue(y,"italic"))}catch(D){removeArrayItemByValue(y,"italic")}try{_iframeDoc.queryCommandState("underline")?y.push("underline"):removeArrayItemByValue(y,"underline")}catch(A){removeArrayItemByValue(y,"underline")}try{_iframeDoc.queryCommandState("strikeThrough")?y.push("strike_through"):removeArrayItemByValue(y,"strike_through")}catch(C){removeArrayItemByValue(y,
"strike_through")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("superscript")?y.push("superscript"):removeArrayItemByValue(y,"superscript"))}catch(E){removeArrayItemByValue(y,"superscript")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("subscript")?y.push("subscript"):removeArrayItemByValue(y,"subscript"))}catch(H){removeArrayItemByValue(y,"subscript")}if(G_DEPlugin.customliststyle)z=G_DEPlugin.customliststyle.util.getCaretState(),z.sItemNode&&(z=z.sItemNode.dataset[G_DEPlugin.customliststyle.util.datasetNames.format],
"number"===z?(y.push("list_number"),removeArrayItemByValue(y,"list_bullets")):("bullet"===z?y.push("list_bullets"):removeArrayItemByValue(y,"list_bullets"),removeArrayItemByValue(y,"list_number")));else{try{null==DrageEndCell&&(_iframeDoc.queryCommandState("insertOrderedList")?y.push("list_number"):removeArrayItemByValue(y,"list_number"))}catch(M){removeArrayItemByValue(y,"list_number")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("insertUnOrderedList")?y.push("list_bullets"):removeArrayItemByValue(y,
"list_bullets"))}catch(N){removeArrayItemByValue(y,"list_bullets")}}"full_size"==DEXTTOP.G_CURREDITOR.FrameStatus?y.push("full_screen"):removeArrayItemByValue(y,"full_screen");"show_blocks"==DEXTTOP.G_CURREDITOR.ShowBlocks?y.push("show_blocks"):removeArrayItemByValue(y,"show_blocks");1==DEXTTOP.G_CURREDITOR.ShowTableBorder?y.push("table_border"):removeArrayItemByValue(y,"table_border");z=GetTDTHCell(a);checkLockAttr(z,!0)?y.push("cell_lock"):removeArrayItemByValue(y,"cell_lock");a=GetParentbyTagName(a,
"table");checkLockAttr(a,!0)?y.push("table_lock"):removeArrayItemByValue(y,"table_lock");DEXTTOP.G_CURREDITOR._iconSelected(y);return{formattingVal:b,lineHeightVal:f,fontSizeVal:e,fontFamilyVal:c,fontLetterSpacingVal:g}}}Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;b<c;){if(this[b]===a)return b;++b}return-1});DEXTTOP.Array.prototype.indexOf||(DEXTTOP.Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;b<c;){if(this[b]===a)return b;++b}return-1});
try{HTMLCanvasElement&&!HTMLCanvasElement.prototype.toBlob&&Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(a,b,c){var d=this;setTimeout(function(){for(var e=atob(d.toDataURL(b,c).split(",")[1]),f=e.length,g=new Uint8Array(f),h=0;h<f;h++)g[h]=e.charCodeAt(h);a(new Blob([g],{type:b||"image/png"}))})}})}catch(e$$248){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}
function removeArrayItemByValue(a){for(var b,c=arguments,d=c.length,e;1<d&&a.length;)for(b=c[--d];-1!==(e=a.indexOf(b));)a.splice(e,1)}function dialogCancel(){var a=getEditrFromEvent(null);"shortcut"==G_LAST_CMD&&G_ShortCutClick?(G_ShortCutClose=!0,G_ShortCutClick=!1,0==DEXTTOP.DEXT5.browser.ie&&window.focus(),document.getElementById("ue_"+a.ID+"shortcut").focus()):((a._LastRange||void 0!=a._LastRange)&&restoreSelection(a._LastRange),setFocusToBody())}
function RepaireTagInTag(a,b){for(var c=_iframeDoc.body.getElementsByTagName(b),d=c.length,e=null,f=0;f<d;f++){var e=c[f],g=GetParentbyTagName(e,a);g&&(g.removeChild(e),e=getFirstRange().range)&&(e.selectNode(g),e.setStartBefore(g),e.collapse(!0),g=_iframeDoc.createElement("hr"),e.insertNode(g),e.selectNode(g),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges())}}
function doSetCaretPosition(a,b,c,d){try{var e=DEXTTOP.G_CURREDITOR;c&&(e=c);if(0!=e._config.initFocus||!e.isInitFocusHandler)if("view"!=e._config.mode||null!=d&&void 0!=d&&1==d)c=!0,0<b&&(c=!1),moveCursorToTag(a,c)}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function setFocusTopWindow(){try{DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXTWIN.focus(),DEXTTOP.DEXTDOC.body.focus()}catch(a){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setDextCustomData(a,b){b.keyid=getNextNumber();a.setAttribute("dext5customdata",b.keyid);DEXTTOP.G_CURREDITOR._dextCustomData.push(b);0!=DEXTTOP.G_CURREDITOR._config.maxTotalFileSize&&b.attributes&&b.attributes.dext5customdata_origin&&DEXTTOP.G_SELECTED_ELEMENT&&b.attributes.dext5customdata_origin.value==DEXTTOP.G_SELECTED_ELEMENT.getAttribute("dext5customdata")&&(DEXTTOP.G_SELECTED_ELEMENT.setAttribute("dext5customdata",b.keyid),DEXTTOP.G_CURREDITOR.targetElemOriginDataForReplaceImage=b,
b.attributes.removeNamedItem("dext5customdata_origin"));return b.keyid}function getDextCustomData(a){for(var b=DEXTTOP.G_CURREDITOR._dextCustomData.length,c=0;c<b;c++)if(DEXTTOP.G_CURREDITOR._dextCustomData[c].keyid==a)return DEXTTOP.G_CURREDITOR._dextCustomData[c];return null}function removeDextCustomData(a){for(var b=DEXTTOP.G_CURREDITOR._dextCustomData.length,c=0;c<b;c++)DEXTTOP.G_CURREDITOR._dextCustomData[c].keyid===a&&DEXTTOP.G_CURREDITOR._dextCustomData.splice(c,1)}
function getDextVideoData(a){var b={};if(a){b.type="video_media";b.src="";b.source=[];try{if(null!=a.getAttribute("src"))b.src=a.getAttribute("src");else if(0!=a.getElementsByTagName("source").length){var c=a.getElementsByTagName("source");if(null!=c[0].getAttribute("src")){b.source.push({src:c[0].getAttribute("src")});try{"undefined"!=typeof c[1]&&(c[1].src=""),"undefined"!=typeof c[2]&&(c[2].src="")}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}}catch(e){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}b.width="";b.height="";""!=a.style.width?b.width=a.style.width:null!=a.getAttribute("width")&&(b.width=a.getAttribute("width"));""!=a.style.height?b.height=a.style.height:null!=a.getAttribute("height")&&(b.height=a.getAttribute("height"));b.autoPlay=null==a.getAttribute("autoplay")?!1:!0;b.loop=null==a.getAttribute("loop")?!1:!0;b.controls=null==a.getAttribute("controls")?!1:!0;b.muted=null==a.getAttribute("muted")?!1:!0;b.poster=null==a.getAttribute("poster")?"":a.getAttribute("poster");
b.allowDownload=null!==a.getAttribute("controlslist")&&"nodownload"===a.getAttribute("controlslist")?!1:!0;"object"==typeof a.attributes&&(b.attributes=a.attributes)}return b}function removeAllDextCustomData(){DEXTTOP.G_CURREDITOR._dextCustomData=[]}var getNextNumber=function(){var a=0;return function(){return++a+""}}();
function isSameCustomData(a){for(var b=DEXTTOP.G_CURREDITOR._dextCustomData.length,c=0;c<b;c++)if(DEXTTOP.G_CURREDITOR._dextCustomData[c].keyid===a)return DEXTTOP.G_CURREDITOR._dextCustomData[c];return null}
function ReplaceImageToRealObject(a,b){if((0!=!!b||"0"!=DEXTTOP.G_CURREDITOR._config.useReplaceImage)&&1!=DEXTTOP.G_CURREDITOR._dextCustomDataMode){DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0;displayPageBreak(!1);for(var c=_iframeDoc.getElementsByTagName("img"),d=c.length-1;0<=d;d--){var e=c[d],f=e.getAttribute("dext5customdata");if(null!=f&&void 0!=f){var g=getDextCustomData(f);if(g)if("iframe"==g.type||"iframe"==g.type2){var h=_iframeDoc.createElement("iframe");if("undefined"!=typeof g.attributes)for(var m=
",src,id,name,title,class,width,height,align,scrolling,frameborder,caption,",q=g.attributes.length,t=0;t<q;t++){var u=g.attributes[t];u.specified&&0>m.indexOf(","+u.name.toLowerCase()+",")&&("style"==u.name.toLowerCase()?h.style.cssText=u.value:h.setAttribute(u.name,u.value))}h.style.width=""!=e.style.width?0==parseIntOr0(e.style.width)?e.width:e.style.width:"";h.style.height=""!=e.style.height?0==parseIntOr0(e.style.height)?e.height:e.style.height:"";if(-1<g.src.indexOf("dext5player/media_player")){var v=
g.src.lastIndexOf("&"),v=g.src.substring(0,v),v=v+("&size="+parseIntOr0(h.width)+"^"+parseIntOr0(h.height));h.src=v}else h.src=g.src;h.id=g.id;h.name=g.name;h.title=g.title;h.className=g.className;null!=e.align&&void 0!=e.align&&(g.align=e.align);h.align=g.align;h.scrolling=g.scrolling;h.frameBorder=g.frameBorder?1:0;g.caption&&""!=g.caption&&h.setAttribute("DEXT_fiVe_Media_Caption",g.caption);h.style.position=e.style.position;h.style.left=e.style.left;h.style.top=e.style.top;e.parentNode.replaceChild(h,
e)}else if("flash"==g.type||"flash"==g.type2){h=_iframeDoc.createElement("div");v="";v+="<embed src='"+g.src+"'";""!=g.hspace&&(v+=" hspace='"+g.hspace+"px'");""!=g.vspace&&(v+=" vspace='"+g.vspace+"px'");""!=g.scale&&(v+=" scale='"+g.scale+"'");""!=g.allowScriptAccess&&(v+=" allowScriptAccess='"+g.allowScriptAccess+"'");""!=g.quality&&(v+=" quality='"+g.quality+"'");""!=g.align&&(v+=" align='"+g.align+"'");v=0==g.menu?v+" menu='false'":v+" menu='true'";v=0==g.play?v+" play='false'":v+" play='true'";
v=0==g.loop?v+" loop='false'":v+" loop='true'";v=0==g.allowFullScreen?v+" allowFullScreen='false'":v+" allowFullScreen='true'";g.flashvars&&""!=g.flashvars&&(v+=" flashvars='"+g.flashvars+"'");g.caption&&""!=g.caption&&(v+=" DEXT_fiVe_Media_Caption='"+g.caption+"'");0>g.src.indexOf("dext5player/")&&(v+=' wmode="transparent"');0!=DEXTTOP.G_CURREDITOR._config.maxTotalFileSize&&DEXTTOP.G_SELECTED_ELEMENT&&DEXTTOP.G_SELECTED_ELEMENT.getAttribute("dext5customdata")==f&&(v+=" dext5customdata_origin='"+
f+"'");v+=" pluginspage='http://www.macromedia.com/go/getflashplayer' type='application/x-shockwave-flash' />";h.innerHTML=v;h=h.firstChild;if("undefined"!=typeof g.attributes)for(m=",src,width,height,hspace,vspace,marginLeft,marginright,marginTop,marginbottom,scale,allowscriptaccess,quality,menu,play,loop,allowfullscreen,flashvars,caption,",q=g.attributes.length,t=0;t<q;t++)u=g.attributes[t],u.specified&&0>m.indexOf(","+u.name.toLowerCase()+",")&&("style"==u.name.toLowerCase()?h.style.cssText=u.value:
"class"==u.name.toLowerCase()?h.className=u.value:h.setAttribute(u.name,u.value));h.style.marginLeft=e.style.marginLeft;h.style.marginRight=e.style.marginRight;h.style.marginTop=e.style.marginTop;h.style.marginBottom=e.style.marginBottom;h.style.width=""!=e.style.width?0==parseIntOr0(e.style.width)?e.width:e.style.width:"";h.style.height=""!=e.style.height?0==parseIntOr0(e.style.height)?e.height:e.style.height:"";h.style.position=e.style.position;h.style.left=e.style.left;h.style.top=e.style.top;
e.parentNode.replaceChild(h,e)}else if("media"==g.type){var h=_iframeDoc.createElement("div"),w="",w=w+("<embed style='width:"+g.width+"px; height:"+g.height+"px;' "),w=w+" type='application/x-mplayer2'",w=w+" pluginspage='http://www.microsoft.com/windows/windowsmedia/download/' ",w=w+(" src='"+g.src+"'"),v=1==g.autoStart?"1":"0",w=w+(" AutoStart='"+v+"'"),v=1==g.playCount?"1":"0",w=w+(" loop='"+v+"'"),v=1==g.showTracker?"1":"0",w=w+(" ShowTracker='"+v+"'"),v=1==g.showStatusBar?"1":"0",w=w+(" ShowStatusBar='"+
v+"'"),v=1==g.showControls?"1":"0",w=w+(" ShowControls='"+v+"'"),v=1==g.showAudioControls?"1":"0",w=w+(" ShowAudioControls='"+v+"'"),v=1==g.showDisplay?"1":"0",w=w+(" ShowDisplay='"+v+"'"),v=1==g.showPositionControls?"1":"0",w=w+(" ShowPositionControls='"+v+"'");0!=DEXTTOP.G_CURREDITOR._config.maxTotalFileSize&&DEXTTOP.G_SELECTED_ELEMENT&&DEXTTOP.G_SELECTED_ELEMENT.getAttribute("dext5customdata")==f&&(w+=" dext5customdata_origin='"+f+"'");w+=" />";h.innerHTML=w;v=h.firstChild;if("undefined"!=typeof g.attributes)for(m=
",src,width,height,autostart,playcount,showtracker,showstatusbar,showcontrols,showaudiocontrols,showdisplay,showpositioncontrols,",q=g.attributes.length,t=0;t<q;t++)u=g.attributes[t],u.specified&&0>m.indexOf(","+u.name.toLowerCase()+",")&&("style"==u.name.toLowerCase()?v.style.cssText=u.value:"class"==u.name.toLowerCase()?v.className=u.value:v.setAttribute(u.name,u.value));v.style.width=""!=e.style.width?0==parseIntOr0(e.style.width)?e.width:e.style.width:"";v.style.height=""!=e.style.height?0==parseIntOr0(e.style.height)?
e.height:e.style.height:"";v.style.position=e.style.position;v.style.left=e.style.left;v.style.top=e.style.top;e.parentNode.replaceChild(v,e);h.innerHTML=""}else if("hidden"==g.type)try{var y=_iframeDoc.createElement("input");if("undefined"!=typeof g.attributes)for(m=",id,name,value,class,title,",q=g.attributes.length,t=0;t<q;t++)u=g.attributes[t],u.specified&&0>m.indexOf(","+u.name.toLowerCase()+",")&&("style"==u.name.toLowerCase()?y.style.cssText=u.value:y.setAttribute(u.name,u.value));y.type=g.type;
y.id=g.id;y.name=g.name;y.value=g.value;y.className=g.className;y.title=g.title;e.parentNode.replaceChild(y,e)}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else if("video_media"==g.type){h=_iframeDoc.createElement("div");v="";v+="<video";if(""!=g.width||""!=g.height){var w=' style="#style#"',z="";""!=g.width&&(z+="width:"+g.width+";");""!=g.height&&(z+="height:"+g.height+";");w=w.replace("#style#",z);v+=" "+w}w=g.source?g.source.length:0;""!=g.src&&0==w&&("1"==DEXTTOP.G_CURREDITOR._config.insertSourceTagInVideo?
g.isFirst||(v+=" src='"+g.src+"'"):v+=" src='"+g.src+"'");1==g.autoPlay&&(v+=" autoplay=''");1==g.loop&&(v+=" loop=''");1==g.controls&&(v+=" controls=''");1==g.muted&&(v+=" muted=''");void 0!=g.poster&&""!=g.poster&&(v+=" poster='"+g.poster+"'");0==g.allowDownload&&(v+=" controlslist='nodownload'");0!=DEXTTOP.G_CURREDITOR._config.maxTotalFileSize&&DEXTTOP.G_SELECTED_ELEMENT&&DEXTTOP.G_SELECTED_ELEMENT.getAttribute("dext5customdata")==f&&(v+=" dext5customdata_origin='"+f+"'");v+=">";if(""!=g.src||
"undefined"!=typeof g.source&&0<g.source.length){f="";if(g.isFirst&&"1"==DEXTTOP.G_CURREDITOR._config.insertSourceTagInVideo){w=g.src.slice(g.src.lastIndexOf(".")+1,g.src.length);if(g.isUrl)v+="<source src='"+g.src+"' type='video/"+("ogv"==w?"ogg":w)+"' />";else for(v+="<source src='"+g.src+"' type='video/"+("ogv"==w?"ogg":w)+"' />",z=DEXTTOP.G_CURREDITOR._config.allowVideoFileType.length,t=0;t<z;t++)f=DEXTTOP.G_CURREDITOR._config.allowVideoFileType[t],f!=w&&(v+="<source src='"+g.src.slice(0,g.src.lastIndexOf("."))+
"."+f+"' type='video/"+("ogv"==f?"ogg":f)+"' />");v+="HTML5 Video\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ube0c\ub77c\uc6b0\uc800"}else{for(z=0;z<w;z++)f=g.source[z].src.slice(g.source[z].src.lastIndexOf(".")+1),v+="<source src='"+g.source[z].src.slice(0,g.source[z].src.lastIndexOf("."))+"."+f+"' type='video/"+("ogv"==f?"ogg":f)+"' />";v+=g.textContent}v+="</video>"}h.innerHTML=v;v=h.firstChild;if("undefined"!=typeof g.attributes)for(m=",src,width,height,autoplay,loop,controls,muted,poster,",
q=g.attributes.length,t=0;t<q;t++)u=g.attributes[t],u.specified&&0>m.indexOf(","+u.name.toLowerCase()+",")&&("style"==u.name.toLowerCase()?v.style.cssText=u.value:"class"==u.name.toLowerCase()?v.className=u.value:v.setAttribute(u.name,u.value));v.style.width=""!=e.style.width?0==parseIntOr0(e.style.width)?e.width:e.style.width:"";v.style.height=""!=e.style.height?0==parseIntOr0(e.style.height)?e.height:e.style.height:"";v.style.position=e.style.position;v.style.left=e.style.left;v.style.top=e.style.top;
e.parentNode.replaceChild(v,e);h.innerHTML=""}}}}}
function ReplaceRealObjectToImage(a){if("0"!=DEXTTOP.G_CURREDITOR._config.useReplaceImage&&"view"!=DEXTTOP.G_CURREDITOR._config.mode&&0!=DEXTTOP.G_CURREDITOR._dextCustomDataMode){DEXTTOP.G_CURREDITOR._dextCustomDataMode=!1;0!=a&&removeAllDextCustomData();displayPageBreak(!0);var b=_iframeDoc.getElementsByTagName("iframe");for(a=b.length-1;0<=a;a--){var c=b[a],d={},e=getLinkMediaType(c.src);d.type=""==e?"iframe":e;d.type2="iframe";d.src=c.getAttribute("src");try{d.src||(d.src=""),c.src=""}catch(f){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}d.id=c.id;d.name=c.name;d.title=c.title;d.className=c.className;d.width=""==c.style.width&&0==parseIntOr0(c.style.width)?c.width:c.style.width;d.height=""==c.style.height&&0==parseIntOr0(c.style.height)?c.height:c.style.height;d.align=c.align;d.scrolling=c.scrolling;d.frameBorder="1"==c.frameBorder?!0:!1;c.getAttribute("DEXT_fiVe_Media_Caption")&&(d.caption=c.getAttribute("DEXT_fiVe_Media_Caption"));d.attributes=c.attributes;d=makeImageElementForObject(d);
d.style.position=c.style.position;d.style.left=c.style.left;d.style.top=c.style.top;c.parentNode.replaceChild(d,c)}b=_iframeDoc.getElementsByTagName("embed");for(a=b.length-1;0<=a;a--){c=b[a];d=c.getAttribute("type");if(void 0==d||null==d)d="";e=c.getAttribute("pluginspage");if(void 0==e||null==e)e="";if(c.getAttribute("wmode")||-1<d.indexOf("x-shockwave-flash")||-1<c.src.indexOf("dext5player/")){d={};e=getLinkMediaType(c.src);d.type=""==e?"flash":e;d.type2="flash";d.src=c.getAttribute("src");try{c.src=
""}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}d.width=""==c.style.width&&0==parseIntOr0(c.style.width)?c.width:c.style.width;d.height=""==c.style.height&&0==parseIntOr0(c.style.height)?c.height:c.style.height;d.hspace=null==c.getAttribute("hspace")?"":c.getAttribute("hspace").replace("px","");d.vspace=null==c.getAttribute("vspace")?"":c.getAttribute("vspace").replace("px","");d.scale=null==c.getAttribute("scale")?"":c.getAttribute("scale");d.allowScriptAccess=null==c.getAttribute("allowScriptAccess")?
"":c.getAttribute("allowscriptaccess");d.quality=null==c.getAttribute("quality")?"":c.getAttribute("quality");d.align=null==c.getAttribute("align")?"":c.getAttribute("align");d.margin_left=c.style.marginLeft;d.margin_right=c.style.marginRight;d.margin_top=c.style.marginTop;d.margin_bottom=c.style.marginBottom;null==c.getAttribute("menu")?d.menu=!0:d.menu=c.getAttribute("menu");null==c.getAttribute("play")?d.play=!0:d.play=c.getAttribute("play");null==c.getAttribute("loop")?d.loop=!0:d.loop=c.getAttribute("loop");
null==c.getAttribute("allowFullScreen")?d.allowFullScreen=!0:d.allowFullScreen=c.getAttribute("allowFullScreen");null==c.getAttribute("DEXT_fiVe_Media_Caption")?d.caption="":d.caption=c.getAttribute("DEXT_fiVe_Media_Caption");c.getAttribute("flashvars")&&(d.flashvars=c.getAttribute("flashvars"));d.attributes=c.attributes;d=makeImageElementForObject(d);d.style.position=c.style.position;d.style.left=c.style.left;d.style.top=c.style.top;c.parentNode.replaceChild(d,c)}else if(c.getAttribute("AutoStart")||
-1<d.indexOf("application/")||-1<e.indexOf("windowsmedia")){d={type:"media"};d.src=c.getAttribute("src");try{c.src=""}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}d.width=""==c.style.width&&0==parseIntOr0(c.style.width)?c.width:c.style.width;d.height=""==c.style.height&&0==parseIntOr0(c.style.height)?c.height:c.style.height;1==c.getAttribute("AutoStart")?d.autoStart=!0:d.autoStart=!1;1==c.getAttribute("loop")?d.playCount=!0:d.playCount=!1;1==c.getAttribute("ShowTracker")?d.showTracker=
!0:d.showTracker=!1;1==c.getAttribute("ShowStatusBar")?d.showStatusBar=!0:d.showStatusBar=!1;1==c.getAttribute("ShowControls")?d.showControls=!0:d.showControls=!1;1==c.getAttribute("ShowAudioControls")?d.showAudioControls=!0:d.showAudioControls=!1;1==c.getAttribute("ShowDisplay")?d.showDisplay=!0:d.showDisplay=!1;1==c.getAttribute("ShowPositionControls")?d.showPositionControls=!0:d.showPositionControls=!1;d.attributes=c.attributes;d=makeImageElementForObject(d);d.style.position=c.style.position;d.style.left=
c.style.left;d.style.top=c.style.top;c.parentNode.replaceChild(d,c)}}b=_iframeDoc.getElementsByTagName("input");for(a=b.length-1;0<=a;a--)c=b[a],"hidden"==c.type&&(d={type:"hidden"},d.id=c.id,d.name=c.name,d.value=c.value,d.className=c.className,d.title=c.title,d.attributes=c.attributes,d=makeImageElementForObject(d),c.parentNode.replaceChild(d,c));b=_iframeDoc.getElementsByTagName("video");for(a=b.length-1;0<=a;a--){c=b[a];d={type:"video_media",source:[],src:"",isFirst:!1};d.textContent=c.textContent?
c.textContent:"";var m=c.getElementsByTagName("source");if(0!=m.length)for(e=0,m=m.length;e<m;e++)null!=c.getElementsByTagName("source")[e].getAttribute("src")&&d.source.push({src:c.getElementsByTagName("source")[e].getAttribute("src")});else e=c.getAttribute("src"),null!=e&&(d.src=e);d.width="";d.height="";""!=c.style.width?d.width=c.style.width:null!=c.getAttribute("width")&&(d.width=c.getAttribute("width"));""!=c.style.height?d.height=c.style.height:null!=c.getAttribute("height")&&(d.height=c.getAttribute("height"));
d.autoPlay=null==c.getAttribute("autoplay")?!1:!0;d.loop=null==c.getAttribute("loop")?!1:!0;d.controls=null==c.getAttribute("controls")?!1:!0;d.muted=null==c.getAttribute("muted")?!1:!0;d.allowDownload=null!==c.getAttribute("controlslist")&&"nodownload"===c.getAttribute("controlslist")?!1:!0;d.poster=null==c.getAttribute("poster")?"":c.getAttribute("poster");"object"==typeof c.attributes&&(d.attributes=c.attributes);d.isUrl=1==d.source.length&&1!=DEXTTOP.G_CURREDITOR._config.allowVideoFileType.length;
d=makeImageElementForObject(d);d.style.position=c.style.position;d.style.left=c.style.left;d.style.top=c.style.top;c.parentNode.replaceChild(d,c)}}}
function ReplaceBase64ImageToArray(a,b){if("html5"==a.runtimes&&"base64"==a.uploadMethod)try{var c=b.getElementsByTagName("img");if(c&&0<c.length){G_ImagesBase64Data=[];for(var d=0,e=c.length;d<e;d++)G_ImagesBase64Data.push(c[d].src),c[d].removeAttribute("src"),c[d].setAttribute("raon-tsrc","DEXT5ImagesBase64Data_"+d.toString())}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function ReplaceArrayToBase64Image(a,b,c){var d=c;if("html5"==a.runtimes&&"base64"==a.uploadMethod){try{var e=b.getElementsByTagName("img");if(e&&0<e.length)for(var f=0,g=e.length;f<g;f++)e[f].src=G_ImagesBase64Data[f],d=d.replace(new RegExp("<img[^>]*DEXT5ImagesBase64Data_"+f,"i"),function(a){return a.replace("raon-tsrc","src").replace("DEXT5ImagesBase64Data_"+f,G_ImagesBase64Data[f])})}catch(h){d=c}G_ImagesBase64Data=[]}return d}
function FixFlashError(a){var b="",b=void 0!=a?a:DEXTTOP.G_CURREDITOR;if(null!=b&&(b=b._EDITOR.preview.contentDocument?b._EDITOR.preview.contentDocument:b._EDITOR.preview.contentWindow.document)){var c=b.getElementsByTagName("iframe");for(a=c.length-1;0<=a;a--){var d=c[a];try{d.src="",d.parentNode.removeChild(d)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}b=b.getElementsByTagName("embed");for(a=b.length-1;0<=a;a--){c=b[a];try{c.src="",c.parentNode.removeChild(c)}catch(f){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}}function FixFlashError2(a){if(a){for(var b=a.getElementsByTagName("iframe"),c=b.length-1;0<=c;c--){var d=b[c];try{d.src="",d.parentNode.removeChild(d)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}a=a.getElementsByTagName("embed");for(c=a.length-1;0<=c;c--){b=a[c];try{b.src="",b.parentNode.removeChild(b)}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}}
function makeImageElementForObject(a){var b="";"iframe"==a.type?b=-1<a.src.indexOf("dext5player/media_player")?"dialog/custom_insert_image.jpg":"dialog/objectiframe.jpg":"flash"==a.type?b=-1<a.src.indexOf("dext5player/")?"dialog/custom_insert_image.jpg":"dialog/objectflash.jpg":"media"==a.type?b="dialog/objectmedia.jpg":"youtube"==a.type?b="dialog/youtube.jpg":"daum"==a.type?b="dialog/daum.jpg":"naver"==a.type?b="dialog/naver.jpg":"link_media"==a.type?b=-1!=a.src.search("youtube.com/embed/")?"dialog/youtube.jpg":
-1!=a.src.search("naver.com/embed/")?"dialog/naver.jpg":"dialog/link_media.jpg":"hidden"==a.type?b="dialog/hidden.jpg":"video_media"==a.type&&(b="dialog/video.jpg");var c=_iframeDoc.createElement("img");c.src=DEXTTOP.G_CURREDITOR._config.webPath.image+b;b={};b.attributes=a.attributes;""!=a.width&&null!=a.width&&void 0!=a.width&&(a.width=a.width.toString(),-1<a.width.indexOf("px")||-1<a.width.indexOf("%")||-1<a.width.indexOf("pt")?c.style.width=a.width:c.style.width=a.width+"px");""!=a.height&&null!=
a.height&&void 0!=a.height&&(a.height=a.height.toString(),-1<a.height.indexOf("px")||-1<a.height.indexOf("%")||-1<a.height.indexOf("pt")?c.style.height=a.height:c.style.height=a.height+"px");"iframe"==a.type||"iframe"==a.type2?(b.type=a.type,b.type2=a.type2,b.src=a.src?a.src:"",b.width=a.width?a.width:"",b.height=a.height?a.height:"",b.id=a.id?a.id:"",b.name=a.name?a.name:"",b.title=a.title?a.title:"",b.className=a.className?a.className:"",b.align=a.align?a.align:"",b.scrolling=a.scrolling?a.scrolling:
"",b.frameBorder=a.frameBorder?a.frameBorder:"",b.caption=a.caption?a.caption:"",c.align=a.align):"flash"==a.type||"flash"==a.type2?(b.type=a.type,b.type2=a.type2,b.src=a.src,b.width=a.width,b.height=a.height,b.hspace=a.hspace?a.hspace:"",b.vspace=a.vspace?a.vspace:"",b.margin_left=a.margin_left,b.margin_right=a.margin_right,b.margin_top=a.margin_top,b.margin_bottom=a.margin_bottom,b.scale=a.scale,b.allowScriptAccess=a.allowScriptAccess,b.quality=a.quality,b.menu=a.menu,b.play=a.play,b.loop=a.loop,
b.allowFullScreen=a.allowFullScreen,b.flashvars=a.flashvars,b.caption=a.caption,b.align="",a.hspace&&(c.hspace=a.hspace),a.vspace&&(c.vspace=a.vspace),a.margin_left&&(-1<a.margin_left.indexOf("px")||-1<a.margin_left.indexOf("%")||-1<a.margin_left.indexOf("pt")?c.style.marginLeft=a.margin_left:c.style.marginLeft=a.margin_left+"px"),a.margin_right&&(-1<a.margin_right.indexOf("px")||-1<a.margin_right.indexOf("%")||-1<a.margin_right.indexOf("pt")?c.style.marginRight=a.margin_right:c.style.marginRight=
a.margin_right+"px"),a.margin_top&&(-1<a.margin_top.indexOf("px")||-1<a.margin_top.indexOf("%")||-1<a.margin_top.indexOf("pt")?c.style.marginTop=a.margin_top:c.style.marginTop=a.margin_top+"px"),a.margin_bottom&&(-1<a.margin_bottom.indexOf("px")||-1<a.margin_bottom.indexOf("%")||-1<a.margin_bottom.indexOf("pt")?c.style.marginBottom=a.margin_bottom:c.style.marginBottom=a.margin_bottom+"px"),c.align="",-1<",absbottom,absmiddle,absmiddle,bottom,left,middle,right,texttop,top,".indexOf(","+a.align+",")&&
(c.align=a.align,b.align=a.align)):"media"==a.type?(b.type=a.type,b.src=a.src,b.width=a.width,b.height=a.height,b.autoStart=a.autoStart,b.playCount=a.playCount,b.showTracker=a.showTracker,b.showStatusBar=a.showStatusBar,b.showControls=a.showControls,b.showAudioControls=a.showAudioControls,b.showDisplay=a.showDisplay,b.showPositionControls=a.showPositionControls):"hidden"==a.type?(b.type=a.type,b.id=a.id,b.name=a.name,b.value=a.value,b.className=a.className,b.title=a.title):"video_media"==a.type&&
(b.type=a.type,b.src=a.src,b.width=a.width,b.height=a.height,b.autoPlay=a.autoPlay,b.loop=a.loop,b.controls=a.controls,b.muted=a.muted,b.allowDownload=a.allowDownload,b.isUrl=a.isUrl,b.isFirst=a.isFirst,b.textContent=a.textContent?a.textContent:"",b.poster=a.poster,b.source=a.source,"object"==typeof a.attributes&&(b.attributes=a.attributes),""!=a.width&&null!=a.width&&void 0!=a.width&&(a.width=a.width.toString(),-1<a.width.indexOf("px")||-1<a.width.indexOf("%")||-1<a.width.indexOf("pt")?c.style.width=
a.width:c.style.width=a.width+"px"),""!=a.height&&null!=a.height&&void 0!=a.height&&(a.height=a.height.toString(),-1<a.height.indexOf("px")||-1<a.height.indexOf("%")||-1<a.height.indexOf("pt")?c.style.height=a.height:c.style.height=a.height+"px"));setDextCustomData(c,b);return c}var dragPopup=null,currentScrollPos;
function startDrag(a){var b=getDialogWindow(),c=getDialogDocument();a||(a=b.event);offsetX=a.clientX;offsetY=a.clientY;0==isMobileAndFixBottom()&&(dragPopup.style.left||(dragPopup.style.left="0px"),dragPopup.style.top||(dragPopup.style.top="0px"));""!=dragPopup.style.transition&&DEXTTOP.DEXT5.util.removeStyleAttribute(dragPopup,"transition");var b=dragPopup.getElementsByTagName("div")[1],d=!1;b&&(b=getClientRect(b),d=point_in_rectagnle(offsetX,offsetY,b.left,b.top,b.right,b.bottom));0==d&&(coordX=
parseInt(dragPopup.style.left),coordY=parseInt(dragPopup.style.top),drag=!0,DEXTTOP.DEXT5.util.addEventEx(c,"mousemove",dragDiv),DEXTTOP.DEXT5.util.addEventEx(c,"mouseup",stopDrag),11<=DEXTTOP.DEXT5.browser.ieVersion&&dragPopup.getElementsByTagName("iframe")[0].focus());DEXTTOP.DEXT5.util.cancelEvent(a)}
function dragDiv(a){if(drag){var b=getDialogWindow();getDialogDocument();a||(a=b.event);var c=dragPopup.getElementsByTagName("iframe")[0],d=dragPopup.getElementsByTagName("div")[2],e=dragPopup.getElementsByTagName("iframe")[1];d.style.width="100%";d.style.height="100%";c&&d&&e&&(c.style.zIndex="-1");c=getWindowClientSize(b,"dragDiv");d=[dragPopup.offsetWidth||0,dragPopup.offsetHeight||0];currentScrollPos=getWindowScrollPos(b);isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&(dragPopup.style.position=
"fixed",currentScrollPos[0]=0,currentScrollPos[1]=0);b=coordX+a.clientX-offsetX;e=coordY+a.clientY-offsetY;0>=b-currentScrollPos[0]&&(b=currentScrollPos[0]);0>=e-currentScrollPos[1]&&(e=currentScrollPos[1]);b+d[0]>=c[0]+currentScrollPos[0]&&(b=c[0]-d[0]+currentScrollPos[0]);e+d[1]>=c[1]+currentScrollPos[1]&&(e=c[1]-d[1]+currentScrollPos[1]);dragPopup.style.left=b+"px";1==DEXTTOP.G_CURREDITOR._config.dialogWindowScroll&&(e=0>e?0:e);dragPopup.style.top=e+"px";DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a)}}
function stopDrag(a){a=getDialogDocument();drag=!1;dragPopup.style.cursor="";var b=dragPopup.getElementsByTagName("iframe")[0],c=dragPopup.getElementsByTagName("div")[2],d=dragPopup.getElementsByTagName("iframe")[1];b&&c&&d&&(b.style.zIndex="1");DEXTTOP.DEXT5.util.removeEvent(a,"mousemove",dragDiv);DEXTTOP.DEXT5.util.removeEvent(a,"mouseup",stopDrag)}
function makeDragPopup(a){drag=!1;var b=getDialogWindow();DEXTTOP.DEXT5.util.addEventEx(a,"mousedown",startDrag);DEXTTOP.DEXT5.util.addEventEx(b,"scroll",dext5DialogScrollEvt);dragPopup=a}var dragPreviewPopup=null;
function startDragPreviewPopup(a){var b=getDialogWindow(),c=getDialogDocument();a||(a=b.event);offsetX=a.clientX;offsetY=a.clientY;var b=dragPreviewPopup.getElementsByTagName("div")[0].children[2],d=!1;b&&(b=getClientRect(b),d=point_in_rectagnle(offsetX,offsetY,b.left,b.top,b.right,b.bottom));0==d&&(coordX=parseInt(dragPreviewPopup.style.left),coordY=parseInt(dragPreviewPopup.style.top),drag=!0,DEXTTOP.DEXT5.util.addEventEx(c,"mousemove",dragDivPreviewPopup),DEXTTOP.DEXT5.util.addEventEx(c,"mouseup",
stopDragPreviewPopup),11<=DEXTTOP.DEXT5.browser.ieVersion&&dragPreviewPopup.getElementsByTagName("iframe")[0].focus());DEXTTOP.DEXT5.util.cancelEvent(a)}
function dragDivPreviewPopup(a){if(drag){var b=getDialogWindow();getDialogDocument();a||(a=b.event);var c=dragPreviewPopup.getElementsByTagName("iframe")[0],d=dragPreviewPopup.getElementsByTagName("div")[0],e=dragPreviewPopup.getElementsByTagName("iframe")[0];c&&d&&e&&(c.style.zIndex="-1");c=getWindowClientSize(b);d=[dragPreviewPopup.offsetWidth||0,dragPreviewPopup.offsetHeight||0];currentScrollPos=getWindowScrollPos(b);b=coordX+a.clientX-offsetX;e=coordY+a.clientY-offsetY;0>=b-currentScrollPos[0]&&
(b=currentScrollPos[0]);0>=e-currentScrollPos[1]&&(e=currentScrollPos[1]);b+d[0]>=c[0]+currentScrollPos[0]&&(b=c[0]-d[0]+currentScrollPos[0]);e+d[1]>=c[1]+currentScrollPos[1]&&(e=c[1]-d[1]+currentScrollPos[1]);dragPreviewPopup.style.left=b+"px";dragPreviewPopup.style.top=e+"px";DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a)}}
function stopDragPreviewPopup(a){a=getDialogDocument();drag=!1;dragPreviewPopup.style.cursor="";DEXTTOP.DEXT5.util.removeEvent(a,"mousemove",dragDivPreviewPopup);DEXTTOP.DEXT5.util.removeEvent(a,"mouseup",stopDragPreviewPopup)}function makeDragPreviewPopup(a){drag=!1;var b=null,b=a.getElementsByTagName("strong")[0];DEXTTOP.DEXT5.util.addEventEx(b,"mousedown",startDragPreviewPopup);dragPreviewPopup=a}var originScrollSize=null,originfull={},relativePos=!1,originStylebackup=[];
function isRelativePosition(a){for(;null!=a&&(!a.tagName||"body"!=a.tagName.toLowerCase());)if(a=a.parentNode,"relative"==a.style.position)return!0;return!1}
function setBackupHiddenStyle(a,b){originStylebackup=[];for(var c=a;null!=c&&(!c.tagName||"body"!=c.tagName.toLowerCase());){if(c!=a){var d;(d=b.getComputedStyle?b.getComputedStyle(c,""):c.currentStyle)&&d.overflow&&"hidden"==d.overflow&&(originStylebackup.push(c),c.style.setProperty?c.style.setProperty("overflow","visible",null):c.style.setAttribute("overflow","visible"))}c=c.parentNode}}
function setRestorreHiddenStyle(){for(var a=originStylebackup.length,b=0;b<a;b++){var c=originStylebackup[b];c.style.setProperty?c.style.setProperty("overflow","hidden",null):c.style.setAttribute("overflow","hidden")}originStylebackup=[]}
function resizeDextWin(){var a=_dext_editor._config.fullScreenTop,b=_dext_editor._config.fullScreenLeft,c=_dext_editor._config.fullScreenRight,d=_dext_editor._config.fullScreenBottom,e=window.frameElement,f=getWindowClientSize(DEXTTOP.DEXTWIN);if(relativePos){e.style.left="0px";e.style.top="0px";var g=getClientRect(e),h=0,m=0,h=-1*g.left,m=-1*g.top;e.style.left=parseIntOr0(e.style.left)+h+"px";e.style.top=parseIntOr0(e.style.top)+m+"px"}else 1==DEXTTOP.DEXT5.browser.ie&&1==DEXTTOP.DEXT5.browser.quirks?
(e.style.left=originScrollSize[0]+"px",e.style.top=originScrollSize[1]+"px"):(e.style.left="0px",e.style.top="0px");0<b&&(e.style.left=DEXTTOP.DEXT5.util.parseIntOr0(e.style.left)+b+"px");0<a&&(e.style.top=DEXTTOP.DEXT5.util.parseIntOr0(e.style.top)+a+"px");0<c&&(e.style.right=DEXTTOP.DEXT5.util.parseIntOr0(e.style.right)+c+"px");0<d&&(e.style.bottom=DEXTTOP.DEXT5.util.parseIntOr0(e.style.bottom)+d+"px");document.getElementById("ue_editor_holder_"+_dext_editor.ID);0<f[0]-b-c&&(e.style.width=f[0]-
b-c+"px");0<f[1]-a-d&&(e.style.height=f[1]-a-d+"px");setTimeout(function(){setEditorHeight(_dext_editor,!1)},50)}
function getCustomParam(a,b){var c={},d=getDocumentForDummy().createElement("div");d.innerHTML=a;var e=d.getElementsByTagName("embed")[0],f=d.getElementsByTagName("iframe")[0];if(null!=e){var g=e.getAttribute("src")?e.getAttribute("src"):"",h=checkXssContentType(g);if(h)return null;c.src=g;c.attributes=e.attributes;g=0!=parseIntOr0(e.style.width)?e.style.width:e.getAttribute("width");0==parseIntOr0(g)&&(g="300");c.width=g;g=0!=parseIntOr0(e.style.height)?e.style.height:e.getAttribute("height");0==
parseIntOr0(g)&&(g="300");c.height=g;c.hspace=e.getAttribute("hspace")?e.getAttribute("hspace"):"";c.vspace=e.getAttribute("vspace")?e.getAttribute("vspace"):"";c.margin_left=e.style.marginLeft;c.margin_right=e.style.marginRight;c.margin_top=e.style.marginTop;c.margin_bottom=e.style.marginBottom;c.scale=e.getAttribute("scale")?e.getAttribute("scale"):"";c.allowScriptAccess=e.getAttribute("allowScriptAccess")?e.getAttribute("allowScriptAccess"):"";c.quality=e.getAttribute("quality")?e.getAttribute("quality"):
"";c.align=e.getAttribute("align")?e.getAttribute("align"):"";c.menu=e.getAttribute("menu")?e.getAttribute("menu"):!1;c.play=e.getAttribute("play")?e.getAttribute("play"):!1;c.loop=e.getAttribute("loop")?e.getAttribute("loop"):!1;c.allowFullScreen=e.getAttribute("allowFullScreen")?e.getAttribute("allowFullScreen"):!0;e.getAttribute("flashvars")&&(c.flashvars=e.getAttribute("flashvars"));e=getLinkMediaType(c.src);c.type=""==e?"flash":e;c.type2="flash"}else if(null!=f){b&&b.forceFullSreenAllow&&f.setAttribute("allowFullscreen",
"true");c.attributes=f.attributes;g=f.getAttribute("src")?f.getAttribute("src"):"";if(h=checkXssContentType(g))return null;c.src=g;c.id=f.getAttribute("id")?f.getAttribute("id"):"";c.name=f.getAttribute("name")?f.getAttribute("name"):"";c.title=f.getAttribute("title")?f.getAttribute("title"):"";g=0!=parseIntOr0(f.style.width)?f.style.width:f.getAttribute("width");0==parseIntOr0(g)&&(g="300");c.width=g;g=0!=parseIntOr0(f.style.height)?f.style.height:f.getAttribute("height");0==parseIntOr0(g)&&(g="300");
c.height=g;c.align=f.getAttribute("align")?f.getAttribute("align"):"";c.scrolling=f.getAttribute("scrolling")?f.getAttribute("scrolling"):"no";f.getAttribute("frameBorder")&&("yes"==f.getAttribute("frameBorder").toLowerCase()||"1"==f.getAttribute("frameBorder")?c.frameBorder=!0:("no"==f.getAttribute("frameBorder")||f.getAttribute("frameBorder"),c.frameBorder=!1));e=getLinkMediaType(c.src);c.type=""==e?"iframe":e;c.type2="iframe"}d.innerHTML="";return c}
function getLinkMediaType(a){var b="";-1!=a.search("youtube.com/embed/")?b="link_media":-1!=a.search("videofarm.daum.net/")?b="link_media":-1!=a.search("naver.com/flash/")?b="link_media":-1!=a.search("channel.pandora.tv/")||-1!=a.search("flvr.pandora.tv/")?b="link_media":-1!=a.search("mgoon.com/Video")?b="link_media":-1!=a.search("dext5player/media_player")&&(b="iframe");return b}
function showSetImageProperty(a){if(null==a){a=!1;if(DEXTTOP.DEXT5.browser.ie&&DEXT5_TOPMENU){var b=DEXTTOP.DEXTDOC.getElementById(DEXT5_TOPMENU._topmenu_id);b&&""==b.style.display&&(a=!0)}var c,d="";try{d=G_dext5plugIn.getDext5PluginVersion()}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var f=!1;""==d?f=!0:(f={maj:3,l:23,mi1:"6",mi2:"0"},f=DEXTTOP.DEXT5.util.compareVersion?0>DEXTTOP.DEXT5.util.compareVersion(d,DEXTTOP.DEXT5.util.makeCRV(f)):d<DEXTTOP.DEXT5.util.makeCRV(f));c=
f?G_dext5plugIn.showImageProperty("","","","","","","","","","","",""):G_dext5plugIn.showImagePropertyEx("","","","","","","","","","","","","","","","");if(-1<DEXTTOP.G_CURREDITOR._config.disableInsertImage.indexOf(",image,")){var g=document.createElement("div");g.innerHTML=c;for(var h=!1,m=g.getElementsByTagName("img"),q=m.length,q=q-1;0<=q;q--){var t=m[q];if(t.src&&0==t.src.toLowerCase().indexOf("file:/")){var h=!0,u=t;"A"==t.parentNode.tagName&&(u=t.parentNode);u.nextSibling&&3==u.nextSibling.nodeType&&
u.parentNode.removeChild(u.nextSibling);u.parentNode.removeChild(u)}}h&&(c=g.innerHTML)}if(""!=c){dialogCancel();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();-1<c.toLowerCase().indexOf("<br")&&(c=c.replace(/<br.*?>/gim,""));if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod){var g=c.indexOf('src="')+5,h=g+c.substr(g).indexOf('"'),g=c.substring(g,h),v;try{v=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_dext5plugIn.getBase64ImageFromLocalImage(g)}catch(w){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(v&&""!=v){v=v.replace(/\r\n/g,"");v=v.replace(/\n/g,"");v=v.replace(/\t/g,"");try{var y;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?y=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,v):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&(y=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,v));null!=y&&void 0!=y&&(v=y)}catch(x){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}}v&&""!=v&&(c=c.replace(g,v))}insertNodeLikePasteHtml(c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper()}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else dialogCancel();a&&setTimeout(function(){DEXTTOP.focus();setFocusToBody()},0)}else{var b=null,b=a.parentNode,B=a.getAttribute("src");(c=a.outerHTML.match(RegExp("srcs*=s*(\"|')(([^\"']*))(\"|')","gi")))&&0<c.length&&(B=c[0].replace("src=",
""),B=B.replace(/\'/g,""),B=B.replace(/\"/g,""),B=B.replace(/\&amp;/g,"&"));c=B;var g=a.style.width,h=a.style.height,B=a.border,m=a.align,D=a.vspace,A=a.hspace,t=a.style.marginTop,u=a.style.marginRight,C=a.style.marginBottom,E=a.style.marginLeft,H=a.id,M=a.className,N=a.title,I=a.alt,S="",F="",O="";""!=g&&null!=g||0!=(null!=h&&""!=h&&-1<h.indexOf("%"))||(g=a.width+"");""!=h&&null!=h||0!=(null!=g&&""!=g&&-1<g.indexOf("%"))||(h=a.height+"");try{b&&"a"==b.tagName.toLowerCase()?(F=b.getAttribute("href"),
S=b.title,O=b.target):b=null}catch(P){b=null}d="";try{d=G_dext5plugIn.getDext5PluginVersion()}catch(J){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}f=!1;""==d?f=!0:(f={maj:3,l:23,mi1:"6",mi2:"0"},f=DEXTTOP.DEXT5.util.compareVersion?0>DEXTTOP.DEXT5.util.compareVersion(DEXTTOP.DEXT5.util.grvi("p"),DEXTTOP.DEXT5.util.makeCRV(f)):DEXTTOP.DEXT5.util.grvi("p")<DEXTTOP.DEXT5.util.makeCRV(f));f?c=G_dext5plugIn.showImageProperty(c,g,h,B,m,D,A,N,I,S,F,O):(""==t.toString()&&(""==D.toString()?t="":
t=D),""==C.toString()&&(""==D.toString()?C="":C=D),""==u.toString()&&(""==A.toString()?u="":u=A),""==E.toString()&&(""==A.toString()?E="":E=A),D=f=d=B="",B=a.style.borderStyle,""==B?a.getAttribute("border")&&""!=a.getAttribute("border")&&(B="solid",d="",f="#000000",D=a.getAttribute("border")):(f=0>a.style.borderColor.indexOf("rgb")&&0>a.style.borderColor.indexOf("#")?"":a.style.borderColor,""!=a.style.borderWidth&&(-1<a.style.borderWidth.indexOf("px")?D=a.style.borderWidth:d=a.style.borderWidth)),
""==B&&(B="solid"),""==d&&(d="default"),""==f&&(f="#000000"),""!=f&&-1<f.indexOf("rgb")&&(f=DEXTTOP.DEXT5.util.rgb2hex(f)),""==D&&(D="0"),-1<D.indexOf("px")&&(D=DEXTTOP.DEXT5.util.parseIntOr0(D)),B=D+"^"+B+"^"+d+"^"+f,c=G_dext5plugIn.showImagePropertyEx(c,g,h,B,m,t,u,C,E,H,M,N,I,S,F,O));if(-1<DEXTTOP.G_CURREDITOR._config.disableInsertImage.indexOf(",image,")){g=document.createElement("div");g.innerHTML=c;h=!1;m=g.getElementsByTagName("img");q=m.length;for(--q;0<=q;q--)t=m[q],t.src&&0==t.src.toLowerCase().indexOf("file:/")&&
(h=!0,u=t,"A"==t.parentNode.tagName&&(u=t.parentNode),u.parentNode.removeChild(u));h&&(c=g.innerHTML)}if(""!=c){setTimeout(function(){dialogCancel()},100);if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&(g=c.indexOf('src="')+5,h=g+c.substr(g).indexOf('"'),g=c.substring(g,h),0==g.indexOf("file:/"))){try{v=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_dext5plugIn.getBase64ImageFromLocalImage(g)}catch(L){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(v&&""!=v){v=v.replace(/\r\n/g,"");v=v.replace(/\n/g,
"");v=v.replace(/\t/g,"");try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?y=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,v):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&(y=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,v)),null!=y&&void 0!=y&&(v=y)}catch(K){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}v&&""!=v&&(c=c.replace(g,v))}y=getBorderAndCustomInfo(c);v=y.borderJson;
c=y.imageText;try{var W=document.createElement("div");W.innerHTML=c;var G=W.getElementsByTagName("img")[0];y="";G.getAttribute("border")&&""!=G.getAttribute("border")&&(y=G.getAttribute("border"));for(var Q=a.attributes.length,q=0;q<Q;q++){var X=a.attributes[q];X.specified&&!G.getAttribute(X.name)&&0>",id,class,align,alt,title,".indexOf(X.name)&&G.setAttribute(X.name,X.value)}""==y&&""!=B&&""==v.borderColor&&""==v.borderKind&&""==v.borderStyle&&""==v.borderWidth?""!=a.style.border&&(G.style.border=
a.style.border):setImageBorder(G,v);c=W.innerHTML}catch(ea){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();q=getFirstRange().range;b?q.selectNode(b):q.selectNode(a);q.deleteContents();q.collapse(!0);q.pasteHtml(c);q.collapse(!1);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper()}catch(V){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&
RAONWIZDLW()}}else setTimeout(function(){dialogCancel()},100)}}
function insertNodeLikePasteHtml(a){if(""!=a&&null!=a){dialogCancel();var b=getFirstRange().range;if(b){b.deleteContents();var c=getBorderAndCustomInfo(a),d=c.originalSizeCheck,e=c.borderJson;a=c.imageText;c=_iframeDoc.createElement("span");c.innerHTML=a;a=a.match(RegExp("srcs*=s*(\"|')(([^\"']*))(\"|')","gi"));var f=a.length;if(a&&0<a.length)for(var g=0;g<f;g++)a[g]=a[g].replace("src=",""),a[g]=a[g].replace(/\'/g,""),a[g]=a[g].replace(/\"/g,""),a[g]=a[g].replace(/\&amp;/g,"&");f=c.childNodes.length;
for(g=0;g<f;g++){var h=c.childNodes[g];h.src=a[g];h=h.cloneNode(!0);h.src=a[g];d||pluginInsertImageAutoFit(h);h=setImageBorder(h,e);adjustSizeInContainer({nodes:h});try{b.insertNode(h),b.selectNode(h)}catch(m){b.pasteHtml(h.outerHTML)}b.collapse(!1)}setFocusToBody()}}}
function getEditrFromEvent(a){var b=null;try{if(null!=a){var c=a.target?a.target:a.srcElement;if(c){a=null;c.document&&9==c.document.nodeType&&(c=c.document);a=9!=c.nodeType?c.ownerDocument:c;try{a=a.defaultView?a.defaultView:a.parentWindow,b=DEXTTOP.DEXT5.DEXTMULTIPLE[a==window?a.frameElement.id:a.parent.frameElement.id],0==!!b&&(b=DEXTTOP.G_CURREDITOR)}catch(d){b=DEXTTOP.G_CURREDITOR}}else b=DEXTTOP.G_CURREDITOR}else b=DEXTTOP.G_CURREDITOR}catch(e){b=DEXTTOP.G_CURREDITOR}return b}
function getEditorFromUnloadEvent(a){var b=null;try{if(null!=a){var c=a.target?a.target:a.srcElement;if(c)try{a="",c._dext_editor?a="dext_frame_"+c._dext_editor.ID:c.defaultView&&(a="dext_frame_"+c.defaultView.G_USE_EDITOR_ID),b=DEXTTOP.DEXT5.DEXTMULTIPLE[a]}catch(d){b=DEXTTOP.G_CURREDITOR}else b=DEXTTOP.G_CURREDITOR}else b=DEXTTOP.G_CURREDITOR}catch(e){b=DEXTTOP.G_CURREDITOR}return b}
function setPasteImageFromClipboard_quality(a,b,c){var d=DEXTTOP.G_CURREDITOR.clipImageBlob;if(d){G_QualityFileObj=[];var e=DEXTTOP.DEXT5.util.getExtensionFromFileName(d.name),f=imageQualityBool(d.size,e);G_QualityFileObj.push({fileObj:d,originalExtension:e,originalFileName:d.name,idx:0,changeBool:f});DEXTTOP.DEXT5.browser.WorkerSupported&&"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?changeImageQuality():changeImageQualityWithoutWorker();var g=setInterval(function(){G_CompleteImageQuality&&
(DEXTTOP.G_CURREDITOR.clipImageBlob=G_QualityFileObj[0].fileObj,clearInterval(g),G_QualityFileObj=[],G_changeCount=0,G_CompleteImageQuality=!1,c(a,b))},300)}else c(a,b)}
function setPasteImageFromClipboard(a,b){if(-1<DEXTTOP.G_CURREDITOR._config.disableInsertImage.indexOf(",paste_image,"))"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1);else try{if(0==DEXTTOP.DEXT5.browser.ie){var c=a.clipboardData.items,d=c.length;0==d&&null!=DEXTTOP.G_CURREDITOR.clipImageBlob&&(d=1);if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&c&&0<d&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount){for(var e=
0,f=0;f<d;++f)(1==d&&DEXTTOP.G_CURREDITOR.clipImageBlob||"file"==c[f].kind&&-1!==c[f].type.indexOf("image/"))&&e++;if(0<e&&getBase64ImageCount()+e>parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,10)){var g=dext5_lang.msg.max_base64file_count,g=g.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount);alert(g);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1);return}}for(var h=0,m=[],f=0;f<d;++f)if(1==
d&&DEXTTOP.G_CURREDITOR.clipImageBlob||"file"==c[f].kind&&-1!==c[f].type.indexOf("image/"))g=null,g=DEXTTOP.G_CURREDITOR.clipImageBlob?DEXTTOP.G_CURREDITOR.clipImageBlob:c[f].getAsFile(),m.push(g);for(var q=execBlobCheckMaxImageFileSize(m),t=q.length,u=[],f=0;f<t;f++)1==q[f]?h++:u.push(m[f]);executeMaxTotalFileSizeCheckProcess({editor:DEXTTOP.G_CURREDITOR,finalCallBackFn:function(a){a=0;var c=[];if(0!=DEXTTOP.G_CURREDITOR._config.maxTotalFileSize&&0<u.length){var d=execImgMaxTotalFileSizeCheck(u,
DEXTTOP.G_CURREDITOR.addedTotalFileSize),e=d.length;DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.messageType="multi_img";DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currFilteredFiles=[];DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currPassedFiles=[];DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currAddedTotalFileSize=DEXTTOP.G_CURREDITOR.addedTotalFileSize;for(var f=0;f<e;f++){var g=d[f],q={size:0};0!=g.filteredFileSize?(q.size=g.filteredFileSize,DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currFilteredFiles.push(q),
a++):(0!=g.passedFileSize&&(q.size=g.passedFileSize,DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currPassedFiles.push(q)),c.push(u[f]));1==e&&(DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.messageType="default",DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currFileSize=q.size)}}0<h&&messageForMaxImageFileSize(h);0<a&&(u=c,a=setMessageForMaxTotalFileSize(DEXTTOP.G_CURREDITOR),alert(a));m=u;0==m.length?"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&DEXTTOP.G_CURREDITOR.isPasting&&
(DEXTTOP.G_CURREDITOR.isPasting=!1):execBlobD5FileDetector(m,function(a){if(-1<a.indexOf(!0)){alert(dext5_lang.msg.message_file_ext_detect);for(var c=[],d=0;d<a.length;d++)0==a[d]&&c.push(m[d]);m=c}0==m.length?"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1):execBlobToBase64(m,function(a){for(var c=a.length,d=0;d<c;d++){var e=a[d];if("error"!=e){var f=e.split(",");if(2==f.length){checkPasteImage('<img src="'+e+'" />');var g=
getExtFromImageDataSrc(f[0]);if("1"==DEXTTOP.G_CURREDITOR._config.compatibility.autoResizePastedImage)if(1==DEXTTOP.G_CURREDITOR.hasClipSvgText)if(0==!!b||"undefined"==typeof b.width){var h=new Image;h.onload=function(){var a=h.width,c=h.height;if(void 0==b||null==b)b={checkOriginSize:!1};b.width=getChangedSizeForPPTImage(a);b.height=getChangedSizeForPPTImage(c);DEXTTOP.G_CURREDITOR.clipImageBeforePopup=h;DEXTTOP.G_CURREDITOR._FRAMEWIN.G_PPTConvertedSize[h.src]={width:b.width,height:b.height};postBase64ImageToServer(f[1],
g,void 0,void 0,b,null,null,null,h.alt)};h.onerror=function(){postBase64ImageToServer(f[1],g,void 0,void 0,b,null,null,null,h.alt)};h.src=e;h.alt=m[d].name}else postBase64ImageToServer(f[1],g,void 0,void 0,b,null,null,null,m[d].name);else postBase64ImageToServer(f[1],g,void 0,void 0,b,null,null,null,m[d].name);else postBase64ImageToServer(f[1],g,void 0,void 0,b,null,null,null,m[d].name)}}}})})}})}else if(11<=DEXTTOP.DEXT5.browser.ieVersion)for(var c=_iframeWin.clipboardData,e=c.files,v=e.length,f=
0;f<v;f++){var w=e[f],y=URL.createObjectURL(w);a.msConvertURL(w,"base64",y);var x=new FileReader;x.onload=function(a){a=a.target.result.split(",");if(2==a.length){var b=getExtFromImageDataSrc(a[0]);postBase64ImageToServer(a[1],b)}x=void 0};x.readAsDataURL(w)}}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function postBase64ImageToServer(a,b,c,d,e,f,g,h,m){if(G_dext5plugIn&&!c.getAttribute("raon_chart"))try{var q=G_dext5plugIn.getLocalImageFromBase64Image(a,b);if(0<q.length)if(void 0==c||null==c){var t=_iframeDoc.createElement("img");t.src=q;t.alt="1"==DEXTTOP.G_CURREDITOR._config.autoInsertAlt?void 0!=f&&null!=f?f.name:void 0!=m&&null!=m?m:"":"";var u=getFirstRange().range;u.deleteContents();u.collapse(!0);u.pasteHtml(t.outerHTML);u.collapse(!1)}else c=SetImageAutoFitSize(c,q)}catch(v){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else{if("1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64&&!h&&(void 0==c||null==c?(t=_iframeDoc.createElement("img"),t.onload=function(a){t&&(0==!!e&&""==t.style.width&&t.width&&(e={width:0,height:0,checkOriginSize:!1},e.width=t.width,""==t.style.height&&t.height&&(e.height=t.height)),e&&0<e.width&&0<e.height&&(t=SetImageAutoFitSize(t,t.src,e)),adjustSizeInContainer({nodes:t}),a=t.outerHTML,t=null,t=void 0,DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||
DEXTTOP.DEXT5.browser.gecko?_iframeDoc.execCommand("inserthtml",!1,a):pasteHtmlAtCaretHuge(M,!0))},t.src="data:image/"+b+";base64,"+a,t.alt="1"==DEXTTOP.G_CURREDITOR._config.autoInsertAlt?void 0!=f&&null!=f?f.name:void 0!=m&&null!=m?m:"":""):void 0!=b&&""!=b&&void 0!=a&&""!=a&&(c.src="data:image/"+b+";base64,"+a,""==c.style.width&&c.width&&(c.src+="?"+c.width,""==c.style.height&&c.height&&(c.src+="^"+c.height)),c=SetImageAutoFitSize(c,c.src,e),adjustSizeInContainer({nodes:c})),"0"==DEXTTOP.G_CURREDITOR._config.uploadImageFileObject||
"1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64&&!f)){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1);return}h="";h=null;q=DEXTTOP.G_CURREDITOR._config.image_convert_width;u=DEXTTOP.G_CURREDITOR._config.image_convert_height;if("1"==DEXTTOP.G_CURREDITOR._config.imageAutoConvert)u=q="";else if(DEXTTOP.G_CURREDITOR.clipImageBeforePopup&&G_PPTConvertedSize[DEXTTOP.G_CURREDITOR.clipImageBeforePopup.src]){var w=G_PPTConvertedSize[DEXTTOP.G_CURREDITOR.clipImageBeforePopup.src];
if(""==q||"0"==q)q=w.width+"";if(""==u||"0"==u)u=w.height+"";delete G_PPTConvertedSize[DEXTTOP.G_CURREDITOR.clipImageBeforePopup.src]}if("undefined"==typeof FormData||null==h&&""!=DEXTTOP.G_CURREDITOR._config.proxy_url&&"1"!=DEXTTOP.G_CURREDITOR._config.uploadImageFileObject){var y=document.createElement("form");y.method="post";y.target="upload_frame";y.enctype="multipart/form-data";var x='<input type="hidden" id="imagedata" name="imagedata" value="'+a+'" />';"0"!=DEXTTOP.G_CURREDITOR._config.security.encryptParam?
(x+='<input type="hidden" id="pe" name="pe" value="'+DEXTTOP.G_CURREDITOR._config.security.encryptParam+'" />',x+='<input type="hidden" id="savefileext" name="savefileext" value="'+DEXTTOP.DEXT5.util._fn_$mEPF(b)+'" />',x+='<input type="hidden" id="serverdomain" name="serverdomain" value="'+DEXTTOP.DEXT5.util._fn_$mEPF(DEXTTOP.G_CURREDITOR._config.serverDomain)+'" />',x+='<input type="hidden" id="tosavepathurl" name="tosavepathurl" value="'+DEXTTOP.DEXT5.util._fn_$mEPF(DEXTTOP.G_CURREDITOR._config.toSavePathURL)+
'" />',x+='<input type="hidden" id="savafoldernamerule" name="savafoldernamerule" value="'+DEXTTOP.DEXT5.util._fn_$mEPF(DEXTTOP.G_CURREDITOR._config.saveFolderNameRule)+'" />',x+='<input type="hidden" id="savafilenamerule" name="savafilenamerule" value="'+DEXTTOP.DEXT5.util._fn_$mEPF(DEXTTOP.G_CURREDITOR._config.saveFileNameRule)+'" />',x+='<input type="hidden" id="proxy_url" name="proxy_url" value="'+DEXTTOP.DEXT5.util._fn_$mEPF(DEXTTOP.G_CURREDITOR._config.proxy_url)+'" />',x+='<input type="hidden" id="image_convert_format" name="image_convert_format" value="'+
DEXTTOP.DEXT5.util._fn_$mEPF(DEXTTOP.G_CURREDITOR._config.image_convert_format)+'" />',x+='<input type="hidden" id="image_convert_width" name="image_convert_width" value="'+DEXTTOP.DEXT5.util._fn_$mEPF(DEXTTOP.G_CURREDITOR._config.image_convert_width)+'" />',x+='<input type="hidden" id="image_convert_height" name="image_convert_height" value="'+DEXTTOP.DEXT5.util._fn_$mEPF(DEXTTOP.G_CURREDITOR._config.image_convert_height)+'" />',x+='<input type="hidden" id="uploadtype" name="uploadtype" value="'+
DEXTTOP.DEXT5.util._fn_$mEPF("image")+'" />',x+='<input type="hidden" id="cd" name="cd" value="'+DEXTTOP.DEXT5.util._fn_$mEPF("1")+'" />',q=f?f.name:"",q=getUploadOriginalFileName(q,DEXTTOP.G_CURREDITOR._config),x+='<input type="hidden" id="originalfilename" name="originalfilename" value="'+DEXTTOP.DEXT5.util._fn_$mEPF(q)+'" />',G_OriginalMultiImageSize_src[m]&&(x+='<input type="hidden" id="original_image_width" name="original_image_width" value="'+DEXTTOP.DEXT5.util._fn_$mEPF(""+G_OriginalMultiImageSize_src[m].width)+
'" />',x+='<input type="hidden" id="original_image_height" name="original_image_height" value="'+DEXTTOP.DEXT5.util._fn_$mEPF(""+G_OriginalMultiImageSize_src[m].height)+'" />')):(x=x+('<input type="hidden" id="savefileext" name="savefileext" value="'+b+'" />')+('<input type="hidden" id="serverdomain" name="serverdomain" value="'+DEXTTOP.G_CURREDITOR._config.serverDomain+'" />'),x+='<input type="hidden" id="tosavepathurl" name="tosavepathurl" value="'+DEXTTOP.G_CURREDITOR._config.toSavePathURL+'" />',
x+='<input type="hidden" id="savafoldernamerule" name="savafoldernamerule" value="'+DEXTTOP.G_CURREDITOR._config.saveFolderNameRule+'" />',x+='<input type="hidden" id="savafilenamerule" name="savafilenamerule" value="'+DEXTTOP.G_CURREDITOR._config.saveFileNameRule+'" />',x+='<input type="hidden" id="proxy_url" name="proxy_url" value="'+DEXTTOP.G_CURREDITOR._config.proxy_url+'" />',x+='<input type="hidden" id="image_convert_format" name="image_convert_format" value="'+DEXTTOP.G_CURREDITOR._config.image_convert_format+
'" />',x+='<input type="hidden" id="image_convert_width" name="image_convert_width" value="'+DEXTTOP.G_CURREDITOR._config.image_convert_width+'" />',x+='<input type="hidden" id="image_convert_height" name="image_convert_height" value="'+DEXTTOP.G_CURREDITOR._config.image_convert_height+'" />',x+='<input type="hidden" id="uploadtype" name="uploadtype" value="image" />',x+='<input type="hidden" id="cd" name="cd" value="1" />',q=f?f.name:"",q=getUploadOriginalFileName(q,DEXTTOP.G_CURREDITOR._config),
x+='<input type="hidden" id="originalfilename" name="originalfilename" value="'+q+'" />',G_OriginalMultiImageSize_src[m]&&(x+='<input type="hidden" id="original_image_width" name="original_image_width" value="'+G_OriginalMultiImageSize_src[m].width+'" />',x+='<input type="hidden" id="original_image_height" name="original_image_height" value="'+G_OriginalMultiImageSize_src[m].height+'" />'));x+='<input type="hidden" id="pe" name="pe" value="'+DEXTTOP.G_CURREDITOR._config.security.encryptParam+'" />';
x+='<input type="hidden" id="'+DEXTTOP.G_CURREDITOR._config.userFieldID+'" name="'+DEXTTOP.G_CURREDITOR._config.userFieldID+'" value="'+DEXTTOP.G_CURREDITOR._config.userFieldValue+'" />';x+='<iframe id="upload_frame" name="upload_frame" frameborder="0" style="width:0px; height:0px;" title="DEXT5Editor Upload"></iframe>';y.innerHTML=x;document.body.appendChild(y);y.action=DEXTTOP.G_CURREDITOR._config.post_url;y.submit();var z=document.getElementById("upload_frame"),B="",B="1"==DEXTTOP.G_CURREDITOR._config.security.postMessageTargetOriginMode?
DEXTTOP.DEXT5.util.getDomainInUrl(DEXTTOP.G_CURREDITOR._config.post_url).fullDomain2:"*";if(window.postMessage){var D=function(a){try{if(0==DEXTTOP.G_CURREDITOR._config.post_url.indexOf(a.origin)){var b=a.data.replace("*","?");_web_url=DEXTTOP.DEXT5.util.trim(b);document.body.removeChild(y);if(_web_url&&""!=_web_url)try{var e;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?e=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,_web_url):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&
(e=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,_web_url));null!=e&&void 0!=e&&(_web_url=e)}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("[FAIL]"==_web_url.substring(0,6))try{if("function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError)DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:_web_url,response:getXhrResponseData()});else"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,
{type:"imageUpload",message:_web_url,response:getXhrResponseData()})}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(void 0==c||null==c){var q=_iframeDoc.createElement("img"),q=SetImageAutoFitSize(q,_web_url);"1"==DEXTTOP.G_CURREDITOR._config.autoInsertAlt&&(void 0!=f&&null!=f?q.alt=f.name:void 0!=m&&null!=m&&(q.alt=m));adjustSizeInContainer({nodes:q});var t=getFirstRange().range;t.collapse(!0);t.insertNode(q);t.selectNode(q);t.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();
rangy.getSelection(_iframeWin).addRange(t)}else{var u=_iframeDoc.getElementsByTagName("img");if(u){var v=u.length;for(a=0;a<v;a++)if(u[a].src==c.src){var w=_iframeDoc.createElement("img");try{w.attributes=u[a].attributes}catch(x){w.outerHTML=u[a].outerHTML}w.src=_web_url;u[a].parentNode.replaceChild(w,u[a]);c=w}}c=SetImageAutoFitSize(c,_web_url);adjustSizeInContainer({nodes:c});d&&recursionBase64ImageToServer()}}}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXTTOP.DEXT5.util.removeEvent(window,
"message",D)};DEXTTOP.DEXT5.util.addEventEx(window,"message",D)}DEXTTOP.DEXT5.util.addEventEx(z,"load",function(){z.contentWindow.postMessage("check",B)},!0)}else{h=new FormData;w=DEXTTOP.G_CURREDITOR._config.proxy_url;"1"==DEXTTOP.G_CURREDITOR._config.uploadImageFileObject&&(w="");"0"!=DEXTTOP.G_CURREDITOR._config.security.encryptParam?(h.append("savefileext",DEXTTOP.DEXT5.util._fn_$mEPF(b)),h.append("serverdomain",DEXTTOP.DEXT5.util._fn_$mEPF(DEXTTOP.G_CURREDITOR._config.serverDomain)),h.append("tosavepathurl",
DEXTTOP.DEXT5.util._fn_$mEPF(DEXTTOP.G_CURREDITOR._config.toSavePathURL)),h.append("savafoldernamerule",DEXTTOP.DEXT5.util._fn_$mEPF(DEXTTOP.G_CURREDITOR._config.saveFolderNameRule)),h.append("savafilenamerule",DEXTTOP.DEXT5.util._fn_$mEPF(DEXTTOP.G_CURREDITOR._config.saveFileNameRule)),h.append("proxy_url",DEXTTOP.DEXT5.util._fn_$mEPF(w)),h.append("image_convert_format",DEXTTOP.DEXT5.util._fn_$mEPF(DEXTTOP.G_CURREDITOR._config.image_convert_format)),h.append("image_convert_width",DEXTTOP.DEXT5.util._fn_$mEPF(q)),
h.append("image_convert_height",DEXTTOP.DEXT5.util._fn_$mEPF(u)),q=f?f.name:"",q=getUploadOriginalFileName(q,DEXTTOP.G_CURREDITOR._config),h.append("originalfilename",DEXTTOP.DEXT5.util._fn_$mEPF(q)),h.append("uploadtype",DEXTTOP.DEXT5.util._fn_$mEPF("image")),h.append("pe",DEXTTOP.G_CURREDITOR._config.security.encryptParam),h.append("cd",DEXTTOP.DEXT5.util._fn_$mEPF("0")),G_OriginalMultiImageSize_src[m]&&(h.append("original_image_width",DEXTTOP.DEXT5.util._fn_$mEPF(""+G_OriginalMultiImageSize_src[m].width)),
h.append("original_image_height",DEXTTOP.DEXT5.util._fn_$mEPF(""+G_OriginalMultiImageSize_src[m].height)))):(h.append("savefileext",b),h.append("serverdomain",DEXTTOP.G_CURREDITOR._config.serverDomain),h.append("tosavepathurl",DEXTTOP.G_CURREDITOR._config.toSavePathURL),h.append("savafoldernamerule",DEXTTOP.G_CURREDITOR._config.saveFolderNameRule),h.append("savafilenamerule",DEXTTOP.G_CURREDITOR._config.saveFileNameRule),h.append("proxy_url",w),h.append("image_convert_format",DEXTTOP.G_CURREDITOR._config.image_convert_format),
h.append("image_convert_width",q),h.append("image_convert_height",u),q=f?f.name:"",q=getUploadOriginalFileName(q,DEXTTOP.G_CURREDITOR._config),h.append("originalfilename",q),h.append("uploadtype","image"),h.append("cd","0"),G_OriginalMultiImageSize_src[m]&&(h.append("original_image_width",G_OriginalMultiImageSize_src[m].width),h.append("original_image_height",G_OriginalMultiImageSize_src[m].height)));""!=DEXTTOP.G_CURREDITOR._config.userFieldID&&h.append(DEXTTOP.G_CURREDITOR._config.userFieldID,DEXTTOP.G_CURREDITOR._config.userFieldValue);
q=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_FormData;u=q.length;for(w=0;w<u;w++)formValue=encodeURIComponent(q[w].form_value),h.append(q[w].form_name,formValue);"1"==DEXTTOP.G_CURREDITOR._config.uploadImageFileObject?0==!!f?(q=a,0>q.indexOf("data:image/")&&(q=b,"jpg"==q&&(q="jpeg"),q="data:image/"+b+";base64,"+a),a=DEXTTOP.DEXT5.util.dataURItoBlob(q),h.append(DEXTTOP.G_CURREDITOR._config.fileFieldID,a,"image."+b)):(q=f.name,q=getUploadOriginalFileName(q,DEXTTOP.G_CURREDITOR._config),h.append(DEXTTOP.G_CURREDITOR._config.fileFieldID,
f,q)):h.append("imagedata",a);h=DEXTTOP.DEXT5.ajax.postMultiPart(DEXTTOP.G_CURREDITOR._config.post_url,h,!0,DEXTTOP.G_CURREDITOR._config.addHttpHeader);b=null;"number"==typeof h.status&&(200!=h.status&&(b=getXhrResponseData(h)),h=h.responseText);if(h&&""!=h){h=web_url_remove_char(h);if(g&&(g=[],"0"!=DEXTTOP.G_CURREDITOR._config.imageCustomPropertyDelimiter&&(g=h.split(DEXTTOP.G_CURREDITOR._config.imageCustomPropertyDelimiter),1<g.length&&(h=g[0])),a=h.split("?"),2==a.length)){h=a[0];a=a[1].split("^");
if(1==a.length)h+="?"+a[0];else if(2==a.length)h+="?"+DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.util.replacePtOrCmToPx(c.style.width))+"^"+DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.util.replacePtOrCmToPx(c.style.height));else if(3==a.length)if(-1<a[1].indexOf("|")){var A=a[1].indexOf("|"),A=a[1].substring(A,a[1].length)+"^"+a[2];h+="?"+DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.util.replacePtOrCmToPx(c.style.width))+"^"+DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.util.replacePtOrCmToPx(c.style.height))+
A}else h+="?"+DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.util.replacePtOrCmToPx(c.style.width))+"^"+DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.util.replacePtOrCmToPx(c.style.height))+"^"+a[2];else if(3<a.length&&(q=0,u=!1,-1<a[q].indexOf("|")&&(A=a[q].indexOf("|"),u=!0),0==u&&(q=1,-1<a[q].indexOf("|")&&(A=a[q].indexOf("|"),u=!0)),u)){0>A&&(A=0);A=a[q].substring(A,a[q].length);u=a.length;for(q+=1;q<u;q++)A+="^"+a[q];h+="?"+DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.util.replacePtOrCmToPx(c.style.width))+
"^"+DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.util.replacePtOrCmToPx(c.style.height))+A}if(1<g.length)for(A=1;A<g.length;A++)h+=DEXTTOP.G_CURREDITOR._config.imageCustomPropertyDelimiter+g[A]}try{var C;"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?C=DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,h):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event&&(C=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,
h));null!=C&&void 0!=C&&(h=C)}catch(E){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}if("[FAIL]"==h.substring(0,6)||b)try{if(C={type:"imageUpload",message:h},C.response=b?b:getXhrResponseData(),"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError)DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,C);else"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event&&DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,C)}catch(H){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}if(void 0==c||null==c){t=_iframeDoc.createElement("img");t=SetImageAutoFitSize(t,h,e);"1"==DEXTTOP.G_CURREDITOR._config.autoInsertAlt&&(void 0!=f&&null!=f?t.alt=f.name:void 0!=m&&null!=m&&(t.alt=m));adjustSizeInContainer({nodes:t});var M=t.outerHTML;"1"==DEXTTOP.G_CURREDITOR._config.removeAppleInterchangeNewlineBr&&(M=M.replace(/<br class="Apple-interchange-newline">/gi,""));try{for(x in G_DEPlugin)if("function"===typeof G_DEPlugin[x].onBeforePaste){var N=G_DEPlugin[x].onBeforePaste({html:M});
if("string"==typeof N)M=N;else if(!1===N)return}}catch(I){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{if("function"===typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event||"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste){x=M;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste?x=DEXTTOP.G_CURREDITOR._config.event.beforePaste(M):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event&&(x=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(M))}catch(S){x=
M}if(x)M=x;else if(0==x||""==x){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1);return}}}catch(F){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(!pasteWordCount(M)){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1);return}M=externalPageBreakDataRaplaceInEditor(M);DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.gecko?
(_iframeDoc.execCommand("inserthtml",!1,M),""!=M&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)):pasteHtmlAtCaretHuge(M,!0);onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0});if(u=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(u)}else c=SetImageAutoFitSize(c,h),adjustSizeInContainer({nodes:c}),d&&recursionBase64ImageToServer()}}"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&
DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1)}
function SetImageAutoFitSize(a,b,c){var d=0,e=0,f="";null!=b&&void 0!=b&&(b=b.replace(/\r\n/g,""),b=b.replace(/\n/g,""),b=b.replace(/\t/g,""));var f=b,g=[];"0"!=DEXTTOP.G_CURREDITOR._config.imageCustomPropertyDelimiter&&(g=b.split(DEXTTOP.G_CURREDITOR._config.imageCustomPropertyDelimiter),1<g.length&&(b=g[0]));b=b.split("?");2==b.length&&(f=b[0],b=b[1].split("^"),1==b.length?f+="?"+b[0]:2==b.length?(d=b[0],e=b[1]):3==b.length&&(d=b[0],e=b[1],f+="?"+b[2]));var h=!1;c&&0<c.width&&0<c.height&&(d=c.width,
e=c.height,h=c.checkOriginSize);var m=b="",q=d;b=DEXTTOP.G_CURREDITOR._config.imgDefaultWidth;m=DEXTTOP.G_CURREDITOR._config.imgDefaultHeight;c?"string"==typeof c.width&&-1<c.width.indexOf("%")&&(d=c.width,e=0):""!=b?"string"==typeof b&&-1<b.indexOf("%")?(d=b,e=0):DEXTTOP.DEXT5.util.parseIntOr0(d)>DEXTTOP.DEXT5.util.parseIntOr0(b)&&(d=DEXTTOP.DEXT5.util.parseIntOr0(e,10)*DEXTTOP.DEXT5.util.parseIntOr0(b,10)/DEXTTOP.DEXT5.util.parseIntOr0(d,10),e=isNaN(d)?e:Math.round(d),d=DEXTTOP.DEXT5.util.parseIntOr0(b),
h=!0):""!=m&&DEXTTOP.DEXT5.util.parseIntOr0(e)>DEXTTOP.DEXT5.util.parseIntOr0(m)&&(e=DEXTTOP.DEXT5.util.parseIntOr0(d,10)*DEXTTOP.DEXT5.util.parseIntOr0(m,10)/DEXTTOP.DEXT5.util.parseIntOr0(e,10),d=isNaN(e)?d:Math.round(e),e=DEXTTOP.DEXT5.util.parseIntOr0(m),h=!0);if(0==h){var t=getWidthForAutoBodyFit(DEXTTOP.G_CURREDITOR,"img");if("1"==DEXTTOP.G_CURREDITOR._config.imageAutoConvert){var t=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.G_CURREDITOR._config.image_convert_width),u=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.G_CURREDITOR._config.image_convert_height),
v=!1,w=!1,m=e,h=DEXTTOP.DEXT5.util.parseIntOr0(d),m=DEXTTOP.DEXT5.util.parseIntOr0(m);if(0!=t&&0==u)h>t&&(v=!0);else if(0==t&&0!=u)m>u&&(w=!0);else{var y=1*t/h,x=1*u/m;y<x?1>y&&(v=!0):1>x&&(w=!0)}v?(h=t/h,d=t,e=DEXTTOP.DEXT5.util.parseIntOr0(h*m)):w&&(e=u,d=DEXTTOP.DEXT5.util.parseIntOr0(u/m*h))}else"1"==DEXTTOP.G_CURREDITOR._config.image_auto_fit&&d>t?(h=t/d,d=t,e=parseInt(h*e)):"2"==DEXTTOP.G_CURREDITOR._config.image_auto_fit&&(h=d,m=e,h>t||m>DEXTTOP.G_CURREDITOR._defaultHeight)&&(d=DEXTTOP.G_CURREDITOR._defaultHeight,
e=d/t,u=m/h,u>e?m>d?(e=d,d=Math.round(h*e/m)):(d=h,e=m):u<e?h>t?(d=t,e=Math.round(m*d/h)):(d=h,e=m):(d=h,e=m))}a.src=f;0<d&&0<e?(a.style.width=d+"px",a.style.height=e+"px",a.removeAttribute("width"),a.removeAttribute("height")):"string"==typeof d&&-1<d.indexOf("%")&&(c?a.style.width=d:(c=DEXTTOP.DEXT5.util.parseIntOr0(b),d=DEXTTOP.DEXT5.util.getEditSpacePx(DEXTTOP.G_CURREDITOR),q=Math.round(q/d*1E4)/100,a.style.width=0!=c&&c<q?b:q+"%"),a.style.height="",a.removeAttribute("width"),a.removeAttribute("height"));
"0"==DEXTTOP.G_CURREDITOR._config.allowImgSize&&(a.style.width="",a.style.height="");if(g&&1<g.length)for(c=g.length,b=1;b<c;b++)q=g[b].split("^"),2==q.length&&a.setAttribute(q[0],q[1]);insertImageSrc(DEXTTOP.G_CURREDITOR,f);return a}
function SetCorrectOfficeHtmlForDOM(a){var b=a;"HWP"==G_wordProcessorType&&(a=applyTableAlignInHwp(a));try{var c=document.createElement("div");c.innerHTML=a;for(var d=c.getElementsByTagName("table"),e=d.length,f=0;f<e;f++){var g=0,h=0;null!=d[f].getAttribute("width")&&""!=d[f].getAttribute("width")&&0>d[f].getAttribute("width").indexOf("%")&&(g=parseInt(d[f].getAttribute("width"),10),d[f].removeAttribute("width"));null!=d[f].getAttribute("height")&&""!=d[f].getAttribute("height")&&(h=parseInt(d[f].getAttribute("height"),
10),d[f].removeAttribute("height"));""==d[f].style.width&&0!=g&&(d[f].style.width=g+"px");""==d[f].style.height&&0!=h&&(d[f].style.height=h+"px")}if("HWP"==G_wordProcessorType){for(var m=c.getElementsByTagName("span"),q=m.length,f=0;f<q;f++){var t=m[f];if("#ffffff"==colorToHex(t.style.backgroundColor)||"#ffffff"==t.style.backgroundColor)t.style.backgroundColor=""}removeDummyDivInHwp(c)}else if("XLS"==G_wordProcessorType)for(var u=c.getElementsByTagName("table"),f=u.length-1;1<=f;f--){var v=u[f],w=
v.parentNode;if(w&&"SPAN"==w.tagName){var y=v.getElementsByTagName("td");if(1==y.length){var d="",x=w.outerHTML.indexOf(">"),d=w.outerHTML.substring(0,x+1);if(-1<d.indexOf("mso-ignore:vglayout2")){var z=v.parentNode.parentNode,B=y[0];if(z&&"TD"==z.tagName){for(var d=["borderBottom","borderLeft","borderTop","borderRight","backgroundColor"],D=d.length,e=0;e<D;e++)z.style[d[e]]=B.style[d[e]],B.style[d[e]]="";(""==B.innerHTML||/^\s$/.test(B.innerHTML))&&u[f].parentNode.removeChild(u[f])}}}}}try{u=/class=".*SpellingError.*"/i;
if(u.test(a)){var A=getElementsByClassNameEx(c,"SpellingError");if(A)for(var C=A.length,f=0;f<C;f++)v=A[f],""!=v.style.backgroundImage&&DEXTTOP.DEXT5.util.removeStyleAttribute(v,"background-image"),"0px"==v.style.lineHeight&&DEXTTOP.DEXT5.util.removeStyleAttribute(v,"line-height"),"relative"==v.style.position&&DEXTTOP.DEXT5.util.removeStyleAttribute(v,"position")}u=/TableCellRelativePosition/i;if(u.test(a)&&(A=getElementsByClassNameEx(c,"TableCellRelativePosition")))for(C=A.length,f=0;f<C;f++)v=A[f],
"relative"==v.style.position&&DEXTTOP.DEXT5.util.removeStyleAttribute(v,"position");u=/class=".*TextRun.*"/i;if(u.test(a)){if(A=getElementsByClassNameEx(c,"NormalTextRun"))for(C=A.length,f=0;f<C;f++)v=A[f],"0px"==v.style.lineHeight&&DEXTTOP.DEXT5.util.removeStyleAttribute(v,"line-height"),"relative"==v.style.position&&DEXTTOP.DEXT5.util.removeStyleAttribute(v,"position");if(A=getElementsByClassNameEx(c,"TextRun"))for(C=A.length,f=0;f<C;f++)v=A[f],"0px"==v.style.lineHeight&&DEXTTOP.DEXT5.util.removeStyleAttribute(v,
"line-height"),"rgb(237, 235, 233)"==v.style.backgroundColor&&DEXTTOP.DEXT5.util.removeStyleAttribute(v,"background-color"),"relative"==v.style.position&&DEXTTOP.DEXT5.util.removeStyleAttribute(v,"position")}u=/class=".*TableWordWrap.*"/i;if(u.test(a)&&(A=getElementsByClassNameEx(c,"TableWordWrap")))for(C=A.length,f=0;f<C;f++){v=A[f];"0px"==v.style.width&&DEXTTOP.DEXT5.util.removeStyleAttribute(v,"width");var E=v.parentNode;if("DIV"==E.tagName&&E.parentNode){for(;E.hasChildNodes();)E.parentNode.insertBefore(E.firstChild,
E);E.parentNode.removeChild(E)}}u=/class=".*OutlineElement.*"/i;if(u.test(a)&&(A=getElementsByClassNameEx(c,"OutlineElement")))for(C=A.length,f=C-1;0<=f;f--)if(v=A[f],"DIV"==v.tagName){for(;v.hasChildNodes();)v.parentNode.insertBefore(v.firstChild,v);v.parentNode.removeChild(v)}else if("LI"==v.tagName){var H=v.parentNode;"rgb(237, 235, 233)"==H.style.backgroundColor&&DEXTTOP.DEXT5.util.removeStyleAttribute(H,"background-color")}u=/class=".*EOP.*"/i;if(u.test(a)&&(A=getElementsByClassNameEx(c,"EOP")))for(C=
A.length,f=0;f<C;f++)if(v=A[f],v.innerHTML==unescape("%u200b")||""==v.innerHTML){var E=v.parentNode,M=E.textContent||E.innerText;if(M==unescape("%u200b")||""==M)v.innerHTML="&nbsp;","0px"==v.style.lineHeight&&DEXTTOP.DEXT5.util.removeStyleAttribute(v,"line-height")}u=/data-sessionid/i;if(u.test(a)&&(A=c.getElementsByTagName("a")))for(C=A.length,f=C-1;0<=f;f--)v=A[f],null==v.getAttribute("href")&&v.getAttribute("data-sessionid")&&"&nbsp;"==v.innerHTML&&v.parentNode.removeChild(v)}catch(N){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}a=c.innerHTML}catch(I){a=b}if("undefined"!=typeof c)try{c.innerHTML="",delete null}catch(S){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return a}
function GetMsPptHtml(a){var b=a,b=a.indexOf("\x3c!--StartFragment--\x3e"),c=a.indexOf("\x3c!--EndFragment--\x3e");if(-1<b&&-1<c&&(b=a.substr(b+20),c=b.indexOf("\x3c!--EndFragment--\x3e"),-1<c)){for(;;)if(a=b.indexOf("\x3c!--EndFragment--\x3e",c+18),-1<a)c=a;else break;a=b=b.substring(0,c)}return a}function ReplaceAll(a,b,c){a&&""!=a&&(a=a.split(b).join(c));return a}
function getExtFromImageDataSrc(a){var b="";a=a.replace("data:","").split(";");0<a.length&&(a=a[0].split("/"),2==a.length&&(b=a[1]));return b}function htmlAsciiToChar(a){return a=a.replace(/&#39;/g,"'")}
function xssReplaceScript(a,b){var c="",d=b;try{var c=b=removeGarbageTag(b),e=DEXTTOP.G_CURREDITOR._config.xss_use,f=DEXTTOP.G_CURREDITOR._config.xss_remove_tags,g=DEXTTOP.G_CURREDITOR._config.xss_remove_events;if("1"!=e&&""==f&&""==g||null==a&&""==b)return c;if(a){var h=getAllNodesInBody(a,!0);DEXTTOP.DEXT5.util.removeTags(a,f);DEXTTOP.DEXT5.util.removeEvents(a,g,h);if("1"==e)for(var m=","+DEXTTOP.G_CURREDITOR._config.xss_check_attribute.join(",")+",",q=h.length,t=0;t<q;t++){if(-1<m.indexOf(",src,")){var u;
try{u=h[t].src}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(void 0!=u&&xssCheckPattern(u)){var w=!0,y=DEXTTOP.G_CURREDITOR._config.xss_allow_url.length;if(0<y){var x=h[t].src.toLowerCase(),z=x.indexOf("?t=");-1<z&&(x=x.substring(0,z));for(var B=0;B<y;B++)if(DEXTTOP.G_CURREDITOR._config.xss_allow_url[B].toLowerCase()==x){w=!1;break}}1==w&&(h[t].src="")}}-1<m.indexOf(",background,")&&(h[t].background&&xssCheckPattern(h[t].background)&&(h[t].background=""),h[t].style.backgroundImage&&
xssCheckPattern(h[t].style.backgroundImage)&&(h[t].style.backgroundImage=""));-1<m.indexOf(",url,")&&h[t].url&&xssCheckPattern(h[t].url)&&(h[t].url="");-1<m.indexOf(",href,")&&h[t].href&&xssCheckPattern(h[t].href)&&(h[t].href="")}}h="";"1"==e&&(h="script,vbscript");m=!1;void 0==b||""==b?a&&(e=!1,1==RegExp("<[^>]+\\sdext5customdata\\b[^>]*>","gim").test(a.innerHTML)&&(e=!0,ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData()),b=a==_iframeDoc.body?a.innerHTML:
a.body.innerHTML,b=DEXTTOP.DEXT5.util.replaceForXSS(b,h,f,g,m),""!=b?DEXTTOP.DEXT5.setBodyValue(b,DEXTTOP.G_CURREDITOR._config.editor_id,!0,null,e):e&&ReplaceRealObjectToImage(!1)):("1"==e&&(m=!0),b=DEXTTOP.DEXT5.util.replaceForXSS(b,h,f,g,m),""!=b&&(c=b))}catch(D){c=d}return c}
function removeGarbageTag(a){var b=a;if("string"==typeof a)try{var c=RegExp("<\\?xml[^>]*/>","gim");1==c.test(b)&&(b=b.replace(c,""));c=RegExp("</ustyle[^>]*>","gim");1==c.test(b)&&(b=b.replace(c,""));c=RegExp("<ustyle[^>]*>","gim");1==c.test(b)&&(b=b.replace(c,""))}catch(d){b=a}return b}function xssCheckPattern(a){return-1<a.indexOf("javascript")||-1<a.indexOf("vbscript")||-1<a.indexOf(".js?")||a.lastIndexOf(".js")+3==a.length?!0:!1}
function checkCellBRValue(){var a=!1;"<p><br /></p>"==getCellDefValue()&&(a=!0);return a}function checkCellBRValue2(a){var b=!1;a=a.toLowerCase();a=ReplaceAll(a," ","");a=ReplaceAll(a,"<br>","<br />");a=ReplaceAll(a,"<br/>","<br />");"<p><br /></p>"==a&&(b=!0);return b}
function checkCellDefValue(a){var b=!1,c=getCellDefValue();a=a.toLowerCase();DEXTTOP.DEXT5.browser.ie&&(a=a.replace(RegExp("<\\/p>\\n$","gi"),"</p>"));a=ReplaceAll(a," ","");a=ReplaceAll(a,"<br>","<br />");a=ReplaceAll(a,"<br/>","<br />");c==a&&(b=!0);return b}
function getCellDefValue(){var a=10;"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&DEXTTOP.DEXT5.browser.ie&&"0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_typing_bug_in_table&&(a=12);return DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.browser.ieVersion<=a?"<p>&nbsp;</p>":"<p><br /></p>"}function setCellDefValue(a){DEXTTOP.DEXT5.browser.ie&&a&&(""==a.innerHTML||"<p></p>"==a.innerHTML)&&(a.innerHTML=getCellDefValue())}
function setTableAllCellDefValue(a){if(DEXTTOP.DEXT5.browser.ie){var b=GetParentbyTagName(a,"table");if(b){var c=a.cellIndex,d=GetParentbyTagName(a,"tr").cells;a=[];for(var e=b.rows.length,f=0;f<e;f++)b.rows[f]&&b.rows[f].cells[c]&&a.push(b.rows[f].cells[c]);b=d.length;for(f=0;f<b;f++)setCellDefValue2(d[f]);b=a.length;for(f=0;f<b;f++)setCellDefValue2(a[f])}}}
function setCellDefValue2(a){RegExp("<p([^>?+]*)></p>","gi").test(a.innerHTML);var b=ReplaceAll(a.innerHTML,RegExp.$1,"");if(""!=RegExp.$1&&"<p></p>"==b)-1<getCellDefValue().indexOf("&nbsp;")?a.innerHTML="<p "+RegExp.$1+">&nbsp;</p>":a.innerHTML="<p "+RegExp.$1+"><br /></p>";else if(""==a.innerHTML||"<p></p>"==a.innerHTML)a.innerHTML=getCellDefValue();"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&(RegExp("<p([^>?+]*)><br /></p>","gi").test(b),b=ReplaceAll(a.innerHTML,RegExp.$1,""),checkCellBRValue2(b)&&
(""!=RegExp.$1?-1<getCellDefValue().indexOf("&nbsp;")?a.innerHTML="<p "+RegExp.$1+">&nbsp;</p>":a.innerHTML="<p "+RegExp.$1+"><br /></p>":a.innerHTML=getCellDefValue()))}
function createTableCellDefValue(a){if(a&&DEXTTOP.DEXT5.browser.ie){var b=GetParentbyTagName(a,"table");if(b)for(var c=b.rows.length,d=0;d<c;d++)for(var e=b.rows[d],f=e.cells.length,g=0;g<f;g++){var h=e.cells[g];h!=a&&""==h.innerHTML&&(h.innerHTML=getCellDefValue())}3==a.childNodes[0].nodeType?a.innerHTML="":""==a.innerHTML&&(a.innerHTML=getCellDefValue())}return""}
function removeCellDefValue(a,b){var c="";if(a)if(1==b)var d=c=a.innerHTML,c=c.replace(/<p *([^>?+])*>(\s+)*(&nbsp;+)*(\s+)*<\/p>/i,""),d=d.replace(/<p *([^>?+])*>(<br *\/*>+)*<\/p>/i,""),c=1==checkCellDefValue(a.innerHTML)||""==a.innerHTML||""==c||""==d?"":a.innerHTML;else{var e=GetParentbyTagName(a,"table");if(e)for(var f=e.rows.length,d=0;d<f;d++)for(var g=e.rows[d],h=g.cells.length,m=0;m<h;m++){var q=g.cells[m],t=RegExp("<p([^>?+]*)></p>","gi");t.test(q.innerHTML);t=ReplaceAll(q.innerHTML,RegExp.$1,
"");if(q!=a&&("<p></p>"==t||""==t))if(""!=RegExp.$1)-1<getCellDefValue().indexOf("&nbsp;")?q.innerHTML="<p "+RegExp.$1+">&nbsp;</p>":q.innerHTML="<p "+RegExp.$1+"><br /></p>";else{var u;"0"==DEXTTOP.G_CURREDITOR._config.setDefaultTagInEmptyCell&&(u=getClientRect(q),u=u.bottom-u.top);q.innerHTML=getCellDefValue();"0"==DEXTTOP.G_CURREDITOR._config.setDefaultTagInEmptyCell&&(t=getClientRect(q),t=t.bottom-t.top,t>u&&(q.innerHTML=""))}}if(0<a.childNodes.length)for(e=a.childNodes.length,d=0;d<e&&1!=a.childNodes[d].nodeType;d++);
if(200>a.innerHTML.length)if(t=RegExp("<p([^>?+]*)>&nbsp;</p>","gi"),t.test(a.innerHTML),t=ReplaceAll(a.innerHTML,RegExp.$1,""),1==checkCellDefValue(t)){""!=RegExp.$1?checkCellBRValue()?a.innerHTML="<p "+RegExp.$1+"><br></p>":a.innerHTML="<p "+RegExp.$1+"></p>":0==checkCellBRValue()&&(a.innerHTML="<p></p>");try{"view"!=DEXTTOP.G_CURREDITOR._config.mode&&(a.childNodes[0]&&"p"==a.childNodes[0].tagName.toLowerCase()&&"br"==a.childNodes[0].firstChild.tagName.toLowerCase()?moveCursorToTag(a.childNodes[0].firstChild,
!0):moveCursorToTag(a.childNodes[0],!0)),c=!0}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else c=!1}return c}
function setShiftTabkeyAction(){try{var a=null,b=getFirstRange(),c=b.range,d=b.sel;c&&c.startContainer&&(a=getMyElementNode(c.startContainer));if(a){var e=GetTDTHCell(a);if(null==e&&"tr"==a.tagName.toLowerCase()){var f=a.cells.length;0<f&&(e=a.cells[f-1])}var b=!1,g=GetParentbyTagName(a,"li");if(g)if(e)for(var h=e.getElementsByTagName("li"),m=h.length,q=0;q<m;q++){if(g==h[q]){b=!0;break}}else b=!0;var t=a.tagName.toLowerCase();if(-1<",li,ul,ol,".indexOf(","+t+",")||b)if(G_DEPlugin.customliststyle)G_DEPlugin.customliststyle.changeListItemLevel({mode:"shifttabkey"});
else if("2"==DEXTTOP.G_CURREDITOR._config.olUlTagMode)if(1==c.collapsed){var u=c.startContainer;3==u.nodeType&&(u=u.parentNode);if("OL"==u.tagName||"UL"==u.tagName)u=u.getElementsByTagName("li")[0];var u=GetParentbyTagName(u,"li"),v=createNodeForCaret(1)[0];c.collapse(!0);c.insertNode(v);moveLiNode(u,0);c.setStartBefore(v);c.setEndBefore(v);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c);v.parentNode.removeChild(v);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else{var v=createNodeForCaret(2),w=v[0],y=v[1],x=!0,z=c.cloneRange();try{c.collapse(!1);c.insertNode(y);d.removeAllRanges();d.addRange(z);c=getFirstRange().range;c.collapse(!0);for(c.insertNode(w);;){var B=y.previousSibling;if(!B||"LI"!=B.tagName&&"OL"!=B.tagName&&"UL"!=B.tagName)break;else B.appendChild(y)}c.setStartBefore(w);c.setEndBefore(y);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c)}catch(D){removeNodeForCaret(),
x=!1}if(0==x)try{x=!0;v=createNodeForCaret(2);w=v[0];y=v[1];try{c.setStart(c.endContainer,c.endOffset),c.setEnd(c.endContainer,c.endOffset)}catch(A){3==c.endContainer.nodeType&&(c.setStart(c.endContainer,c.endContainer.length),c.setEnd(c.endContainer,c.endContainer.length))}c.insertNode(y);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(z);c=getFirstRange().range;try{c.setStart(c.startContainer,c.startOffset),c.setEnd(c.startContainer,c.startOffset)}catch(C){3==
c.startContainer.nodeType&&(c.setStart(c.startContainer,0),c.setEnd(c.startContainer,0))}c.insertNode(w);(B=y.previousSibling)&&"LI"==B.tagName&&B.appendChild(y);c.setStartBefore(w);c.setEndBefore(y);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c)}catch(E){removeNodeForCaret(),x=!1}if(x){c=getFirstRange().range;u=c.startContainer;3==u.nodeType&&(u=u.parentNode);var H=c.endContainer;3==H.nodeType&&(H=H.parentNode);u=GetParentbyTagName(u,"li");H=GetParentbyTagName(H,
"li");if(u&&H){if(u==H)moveLiNode(u,0);else{x=[];if(u.parentNode==H.parentNode){x.push(u);for(var M=u.nextSibling;M!=H;)x.push(M),M=M.nextSibling;x.push(H)}for(var N=x.length,q=0;q<N;q++)moveLiNode(x[q],0)}c.setStartBefore(w);c.setEndAfter(y);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c);removeNodeForCaret();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else removeNodeForCaret()}else rangy.getSelection(_iframeWin).removeAllRanges(),
rangy.getSelection(_iframeWin).addRange(z)}else{for(var I=getNodesInRange(c),x=[],S=I.length,q=0;q<S;q++)"1"==I[q].nodeType&&"li"==I[q].tagName.toLowerCase()&&x.push(I[q]);for(var N=x.length,F=x[0],O=x[N-1],d=!0,q=0;q<N;q++){for(var P=x[q],J=P.parentNode,L=P.nextSibling,K=P.previousSibling;K&&!K.tagName;)K=K.previousSibling;for(;L&&!L.tagName;)L=L.nextSibling;var W=K&&K.tagName?K.tagName.toLowerCase():"",G=L&&L.tagName?L.tagName.toLowerCase():"";if(!(0>",li,ul,ol,".indexOf(","+J.parentNode.tagName.toLowerCase()+
","))){if(L&&K&&(-1<",ul,ol,".indexOf(","+W+",")||-1<",ul,ol,".indexOf(","+G+","))||!L&&"li"==W||!K&&"li"==G||"li"==W&&"li"==G||!L&&!K){for(var Q=document.createElement(P.parentNode.tagName);P.previousSibling;)Q.childNodes?Q.insertBefore(P.previousSibling,Q.firstChild):Q.appendChild(P.previousSibling);for(var X=document.createElement(P.parentNode.tagName);P.nextSibling;)X.appendChild(P.nextSibling);for(var ea=J.attributes,V=ea.length,u=0;u<V;u++){var aa=ea[u];aa.specified&&("style"==aa.name.toLowerCase()?
(Q.style.cssText=J.style.cssText,X.style.cssText=J.style.cssText):(Q.setAttribute(aa.name,aa.value),X.setAttribute(aa.name,aa.value)))}J.parentNode.insertBefore(X,J);X.parentNode.insertBefore(Q,X);X.parentNode.insertBefore(P,X);0==X.childNodes.length&&X.parentNode.removeChild(X);0==Q.childNodes.length&&Q.parentNode.removeChild(Q)}else!K&&-1<",ul,ol,".indexOf(","+J.parentNode.tagName.toLowerCase()+",")?J.parentNode.insertBefore(P,J):!L&&-1<",ul,ol,".indexOf(","+J.parentNode.tagName.toLowerCase()+",")&&
(J.nextSibling?J.parentNode.insertBefore(P,J.nextSibling):J.parentNode.appendChild(P));1==N&&""==P.innerText&&(d=!1,doSetCaretPosition(P,0));0==J.childNodes.length&&J.parentNode.removeChild(J)}}d&&(c.setStartBefore(F.firstChild),c.setEndAfter(O.lastChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(c));DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else if(e&&"1"!=DEXTTOP.G_CURREDITOR._config.disableTabletap){var ga=
GetParentbyTagName(e,"tr");if(ga){var ba=e.cellIndex,fa=ga.rowIndex;if(0<ba){var ca=ga.cells[ba-1];if(ca){ca.focus();removeCellDefValue(ca,!1);var ta=getFirstChildNodeForCaret(ca);doSetCaretPosition(ta,0)}}else{var da=GetParentbyTagName(ga,"table");if(da&&(fa=ga.rowIndex,0<fa)){var na=da.rows[fa-1];na&&(ca=na.cells[na.cells.length-1])&&(ca.focus(),removeCellDefValue(ca,!1),ta=getFirstChildNodeForCaret(ca),doSetCaretPosition(ta,0))}}}}}}catch(Ja){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setTabkeyAction(){try{var a=null,b=getFirstRange().range;b&&b.startContainer&&(a=getMyElementNode(b.startContainer));if(a){var c=GetTDTHCell(a);if(null==c&&"tr"==a.tagName.toLowerCase()){var d=a.cells.length;0<d&&(c=a.cells[d-1])}var d=!1,e=GetParentbyTagName(a,"li");if(e)if(c)for(var f=c.getElementsByTagName("li"),g=f.length,h=0;h<g;h++){if(e==f[h]){d=!0;break}}else d=!0;var m=a.tagName.toLowerCase();if(-1<",li,ul,ol,".indexOf(","+m+",")||d)if(G_DEPlugin.customliststyle)G_DEPlugin.customliststyle.changeListItemLevel({mode:"tabkey"});
else if("2"==DEXTTOP.G_CURREDITOR._config.olUlTagMode)if(1==b.collapsed){var q=b.startContainer;3==q.nodeType&&(q=q.parentNode);if("OL"==q.tagName||"UL"==q.tagName)q=q.getElementsByTagName("li")[0];var q=GetParentbyTagName(q,"li"),t=createNodeForCaret(1)[0];b.collapse(!0);b.insertNode(t);canMoveLiNode(q,1)&&moveLiNode(q,1);b.setStartBefore(t);b.setEndBefore(t);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b);t.parentNode.removeChild(t);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else{var t=createNodeForCaret(2),u=t[0],v=t[1],w=!0,y=b.cloneRange();try{b.collapse(!1);b.insertNode(v);sel.removeAllRanges();sel.addRange(y);b=getFirstRange().range;b.collapse(!0);b.insertNode(u);var x=v.previousSibling;x&&"LI"==x.tagName&&x.appendChild(v);b.setStartBefore(u);b.setEndBefore(v);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b)}catch(z){removeNodeForCaret(),w=!1}if(0==w)try{w=!0;t=createNodeForCaret(2);
u=t[0];v=t[1];try{b.setStart(b.endContainer,b.endOffset),b.setEnd(b.endContainer,b.endOffset)}catch(B){3==b.endContainer.nodeType&&(b.setStart(b.endContainer,b.endContainer.length),b.setEnd(b.endContainer,b.endContainer.length))}b.insertNode(v);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(y);b=getFirstRange().range;try{b.setStart(b.startContainer,b.startOffset),b.setEnd(b.startContainer,b.startOffset)}catch(D){3==b.startContainer.nodeType&&(b.setStart(b.startContainer,
0),b.setEnd(b.startContainer,0))}b.insertNode(u);(x=v.previousSibling)&&"LI"==x.tagName&&x.appendChild(v);b.setStartBefore(u);b.setEndBefore(v);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b)}catch(A){removeNodeForCaret(),w=!1}if(w){b=getFirstRange().range;q=b.startContainer;3==q.nodeType&&(q=q.parentNode);var C=b.endContainer;3==C.nodeType&&(C=C.parentNode);q=GetParentbyTagName(q,"li");C=GetParentbyTagName(C,"li");if(q&&C){if(q==C)canMoveLiNode(q,1)&&moveLiNode(q,
1);else{w=[];if(q.parentNode==C.parentNode&&canMoveLiNode(q,1)){w.push(q);for(var E=q.nextSibling;E!=C;)w.push(E),E=E.nextSibling;w.push(C)}for(var H=w.length,h=0;h<H;h++)moveLiNode(w[h],1)}b.setStartBefore(u);b.setEndAfter(v);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b);removeNodeForCaret();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else removeNodeForCaret()}else rangy.getSelection(_iframeWin).removeAllRanges(),
rangy.getSelection(_iframeWin).addRange(y)}else{for(var M=getNodesInRange(b),w=[],N=M.length,h=0;h<N;h++)"1"==M[h].nodeType&&"li"==M[h].tagName.toLowerCase()&&w.push(M[h]);for(var H=w.length,I,S,q=!0,h=0;h<H;h++){for(var F,O=w[h],P=O.previousSibling,J=O.nextSibling;P&&!P.tagName;)P=P.previousSibling;for(;J&&!J.tagName;)J=J.nextSibling;var L=P&&P.tagName?P.tagName.toLowerCase():"",K=J&&J.tagName?J.tagName.toLowerCase():"";if(!J&&"li"==L||!P&&"li"==K||"li"==L&&"li"==K||!J&&!P){var W=O.parentNode.style.listStyleType.toLowerCase(),
G=DEXTTOP.G_CURREDITOR._config.olListStyleTypeSequence[W]?DEXTTOP.G_CURREDITOR._config.olListStyleTypeSequence[W]:"";""==G&&(G=DEXTTOP.G_CURREDITOR._config.ulListStyleTypeSequence[W]?DEXTTOP.G_CURREDITOR._config.ulListStyleTypeSequence[W]:"upper-alpha");var Q=document.createElement(O.parentNode.tagName),X=_dext_editor._config.listSpaceSize;"40px"!==X&&(Q.style.paddingLeft="0",Q.style.marginLeft=X);Q.style.listStyleType=G;Q.innerHTML=O.outerHTML;O.parentNode.replaceChild(Q,O);F=Q.firstChild}else P&&
-1<",ul,ol,".indexOf(","+L+",")?(P.appendChild(O),F=P.lastChild):J&&-1<",ul,ol,".indexOf(","+K+",")&&(J.insertBefore(O,J.firstChild),F=J.firstChild);0==h&&(I=F);if(h==H-1){S=F;var ea=S.parentNode,V=ea.nextSibling;if(V&&V.tagName&&V.tagName==ea.tagName){for(;V.childNodes[0];)ea.appendChild(V.childNodes[0]);V.parentNode.removeChild(V)}}1==H&&""==F.innerText&&(q=!1,doSetCaretPosition(F,0))}q&&(b.setStartBefore(I.firstChild),b.setEndAfter(S.lastChild),rangy.getSelection(_iframeWin).removeAllRanges(),
rangy.getSelection(_iframeWin).addRange(b));DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else if(c&&"1"!=DEXTTOP.G_CURREDITOR._config.disableTabletap){var aa=GetParentbyTagName(c,"tr");if(aa){var ga=c.cellIndex,ba=aa.rowIndex;if(aa.cells.length>ga+1){var fa=aa.cells[ga+1];if(fa){fa.focus();removeCellDefValue(fa,!1);var ca=getFirstChildNodeForCaret(fa);doSetCaretPosition(ca,0)}}else{var ta=GetParentbyTagName(aa,"table");if(ta&&(ba=aa.rowIndex,ta.rows.length>
ba+1)){var da=ta.rows[ba+1];da&&(fa=da.cells[0])&&(fa.focus(),removeCellDefValue(fa,!1),ca=getFirstChildNodeForCaret(fa),doSetCaretPosition(ca,0))}}}}else 0==GetTableSelectionCells().length&&(pasteHtmlAtCaretMini(DEXTTOP.G_CURREDITOR._config.tabSpace),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}}catch(na){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setTableArrowKeyDownAction(a){G_CURSOR_BEFORE_INTABLE=!1;G_BEFORE_INTABLE=null;a="which"in a?a.which:a.keyCode;var b=getFirstRange().range;try{var c=null;b&&(c=getMyElementNode(b.startContainer));if(c){var d=GetTDTHCell(c);if(null==d&&"tr"==c.tagName.toLowerCase()){var e=c.cells.length;0<e&&(d=c.cells[e-1])}if(d){G_CURSOR_BEFORE_INTABLE=!0;G_BEFORE_INTABLE=GetParentbyTagName(d,"table");var f=GetParentbyTagName(d,"tr");if(f){var g=f.cells[d.cellIndex],h=getTopOrBottomBoundNextCell(d,a);if(null!=
h.nextCell){var m=GetParentbyTagName(f,"table");if(m){var q=m.rows[h.rowIndex];if(q){var t=q.cells[h.cellIndex];t&&200>t.innerHTML.length&&(""==ReplaceAll(t.innerHTML," ","")||1==checkCellDefValue(t.innerHTML))&&0==checkCellBRValue()&&"1"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&(t.innerHTML="<p></p>")}else setCellDefValue(g)}}else setCellDefValue(g)}}}}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setTableArrowKeyUpAction(a){a="which"in a?a.which:a.keyCode;var b=getFirstRange().range;try{var c=null;b&&(c=getMyElementNode(b.startContainer));if(c){var d=GetTDTHCell(c);if(null==d&&"tr"==c.tagName.toLowerCase()){var e=c.cells.length;0<e&&(d=c.cells[e-1])}if(d){var f=GetParentbyTagName(d,"tr");if(f){var g=f.cells[d.cellIndex];"1"==DEXTTOP.G_CURREDITOR._config.setDefaultTagInEmptyCell&&setTableAllCellDefValue(g);if(200>g.innerHTML.length){RegExp("<p([^>?+]*)>&nbsp;</p>","gi").test(g.innerHTML);
var h=ReplaceAll(g.innerHTML,RegExp.$1,"");if(""==ReplaceAll(g.innerHTML," ","")||1==checkCellDefValue(h)||h=="<p>"+unescape("%u200B")+"</p>")DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&h=="<p>"+unescape("%u200b")+"</p>"&&(g.innerHTML=""!=RegExp.$1?"<p "+RegExp.$1+"></p>":"<p></p>"),0==checkCellBRValue()&&(g.innerHTML=""!=RegExp.$1?"<p "+RegExp.$1+"></p>":"<p></p>"),doSetCaretPosition(g.childNodes[0],0)}}}else if(G_CURSOR_BEFORE_INTABLE&&
"body"==c.tagName.toLowerCase()&&(d=!0,37==a||38==a?null==G_BEFORE_INTABLE.previousSibling&&(d=!1):39!=a&&40!=a||null!=G_BEFORE_INTABLE.nextSibling||(d=!1),0==d)){var m=_iframeDoc.createElement("p");m.innerHTML=getDefaultParagraphValue(!1);b.insertNode(m);doSetCaretPosition(m,0)}}}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function getTopOrBottomBoundNextCell(a,b){var c={rowIndex:-1,cellIndex:-1,nextCell:null},d;switch(b){case 38:d=1;break;case 39:d=2;break;case 40:d=3;break;case 37:d=4;break;default:return c}try{var e=GetParentbyTagName(a,"tr");if(e){var f=GetParentbyTagName(a,"table");if(f){var g=f.rows.length,h=e.rowIndex,m=a.cellIndex,q=e.cells.length,t=0;if(""==f.style.borderCollapse||"separate"==f.style.borderCollapse){var u=f.cellSpacing;1<u&&(t=DEXTTOP.DEXT5.util.parseIntOr0(u))}if(1==d){if(0==h)return c;for(var v=
h-1;0<=v;v--)for(var w=f.rows[v],y=w.cells.length,x=getClientRect(a),z=0;z<y;z++){var B=w.cells[z],D=getClientRect(B);if(isSameRect(x.top,D.bottom,t)&&(x.left<=D.left&&x.right>=D.right||x.left>=D.left&&x.right<=D.right&&1<B.colSpan)){var A=GetParentbyTagName(B,"tr");if(A)return c.rowIndex=A.rowIndex,c.cellIndex=B.cellIndex,c.nextCell=B,c}}}else if(2==d){if(m!=q-1?(c.rowIndex=h,c.cellIndex=m+1):(c.rowIndex=e.rowIndex+1,c.cellIndex=0),f&&(w=f.rows[c.rowIndex]))if(B=w.cells[c.cellIndex])return c.nextCell=
B,c}else if(3==d){if(g==h)return c;for(v=h+1;v<g;v++)for(w=f.rows[v],y=w.cells.length,x=getClientRect(a),z=0;z<y;z++)if(B=w.cells[z],D=getClientRect(B),isSameRect(x.bottom,D.top,t)&&(x.left<=D.left&&x.right>=D.right||x.left>=D.left&&x.right<=D.right&&1<B.colSpan)&&(A=GetParentbyTagName(B,"tr")))return c.rowIndex=A.rowIndex,c.cellIndex=B.cellIndex,c.nextCell=B,c}else if(4==d)if(0!=m){if(c.rowIndex=h,c.cellIndex=m-1,f&&(w=f.rows[c.rowIndex]))if(B=w.cells[c.cellIndex])return c.nextCell=B,c}else if(c.rowIndex=
h-1,f&&(w=f.rows[c.rowIndex]))return c.cellIndex=w.cells.length-1,c.nextCell=w.cells[w.cells.length-1],c}}}catch(C){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}function setArrowKeyAction(a){return!1}
function setDeleteKeyAction(a){a=!1;try{for(var b=GetTableSelectionCells(),c=b.length,d=0;d<c;d++){var e=b[d];if(DEXTTOP.DEXT5.browser.ie||"1"!=DEXTTOP.G_CURREDITOR._config.diagonal.use)e.innerHTML=getCellDefValue();else{var f=findDiagonal(e,!0),g=f?f.diagonalUp:[],h=f?f.diagonalDown:[],m=!1,q=null,t=null;1==g.length&&(q=g[0].cloneNode(!0),m=!0);1==h.length&&(t=h[0].cloneNode(!0),m=!0);e.innerHTML=getCellDefValue();q&&e.appendChild(q);t&&e.appendChild(t);m&&G_DEXT_Diagonal.setResizeForDiagonal(e)}}0<
c&&(ClearDraggingTableCellSelected(),removeCellDefValue(b[0],!1),removeCellDefValue(b[c-1],!1),doSetCaretPosition(b[0].childNodes[0],0),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&"&nbsp;"==b[0].innerHTML&&(b[0].innerHTML=""),a=!0)}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return a}
function getCopyCellData(a){DEXTTOP.G_COPIEDTABLE=null;DEXTTOP.G_COPIEDCELLDATA=null;a=!1;if(null!=ActiveLastTable){var b=CellSelectedCopy(ActiveLastTable);1==b.selected&&(DEXTTOP.G_COPIEDTABLE=b.Table,DEXTTOP.G_COPIEDCELLDATA=b.cellValue,a=!0)}return a}
function dextWriteLog(a,b){void 0==b&&(b=!1);if(0==DEXTTOP.DEXT5.isRelease)try{b?parent.parent.document.getElementById("txtTestValue").value+=a:parent.parent.document.getElementById("txtTestValue").value=a}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function _dextiframe_BeforeUnload(a){try{var b=getEditorFromUnloadEvent(a);if(b)try{if(b._config.auditLogEnable&&"1"==b._config.auditLogEnable&&DEXTTOP&&DEXTTOP.DEXT5&&DEXTTOP.DEXT5.browser.LocalStorageSupported){var c=ALS.toString(),c=c.replace(/,/gi,""),d=DEXTTOP.window.localStorage[c];a=!1;if(null!=d&&void 0!=d&&""!=d)for(var e=d.split(","),f=e.length,g=0;g<f;g++)if(e[g]==b._config.productKey){a=!0;break}if(null==d||void 0==d||""==d||!a){DEXTTOP.window.localStorage[c]=null==d||void 0==d||""==d?
b._config.productKey:d+","+b._config.productKey;c=___;-1<c.indexOf("?")&&(c=c.substring(0,c.indexOf("?")));var h=c.indexOf("//"),c=-1<h?c.substring(0,c.substring(h+2).indexOf("/")+(h+2)+1):c.substring(0,c.indexOf("/")+1),m=DEXTTOP.DEXT5.util._fn_$mEP("ED"+b._config.unitAttributeDelimiter+c+b._config.unitAttributeDelimiter+b._config.productKey);try{_C="https:"!=location.protocol?C1.toString():C2.toString(),_C=_C.replace(/,/gi,""),_C=_C+"?p="+m,(new Image).src=_C}catch(q){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}}}}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function _dextiframe_Unload(a){try{var b=getEditorFromUnloadEvent(a);if(b&&"1"==b._config.autoDestroy.use)try{"0"!=b._config.autoDestroy.restoreHtml&&(null==DEXTTOP.DEXT5.AutoDestroyHtmlHashTable&&(DEXTTOP.DEXT5.AutoDestroyHtmlHashTable=new DEXTTOP.DEXT5.util.hashTable),DEXTTOP.DEXT5.AutoDestroyHtmlHashTable.setItem(b.ID,b._DOC.documentElement.outerHTML)),DEXTTOP.DEXT5.destroy(b)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&
RAONWIZDLW()}}
function _dextiframe_Keyup(a){var b="which"in a?a.which:a.keyCode,c=a.target?a.target:a.srcElement,d=null,d=9!=c.nodeType?c.ownerDocument:c;if((d=d.activeElement)&&d.tagName&&"body"!=d.tagName.toLowerCase()&&"html"!=d.tagName.toLowerCase()){var e=d.parentNode,f=d.tagName.toLowerCase(),e=e.tagName.toLowerCase();if(!("span"!=e&&"li"!=e||"a"!=f&&"button"!=f))if(13==b){f=d.id.split(":")[0];e=d.id.split(":")[1];void 0==e&&(e=f.replace("ue_"+DEXTTOP.G_CURREDITOR.ID,""));"1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&-1<
e.indexOf("tool_bar_grouping")&&(DEXTTOP.G_CURREDITOR.groupingBoxOpen=!0);var g=isMenuItemEnable(f,e);!g||"shortcut"==e&&1==G_ShortCutClose||(DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,e),DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),G_ShortCutClose=!1)}else if(9==b)f=d.id.split(":")[0],e=d.id.split(":")[1],void 0==e&&(e=f.replace("ue_"+DEXTTOP.G_CURREDITOR.ID,"")),g=isMenuItemEnable(f,e),g||(a=moveNextMenu(f,e))&&a.focus();else if(39==b){if(f=d.id.split(":")[0],
e=d.id.split(":")[1],void 0==e&&(e=f.replace("ue_"+DEXTTOP.G_CURREDITOR.ID,"")),d=moveNextMenu(f,e))for(f=d.id.split(":")[0],e=d.id.split(":")[1];;)if(g=isMenuItemEnable(f,e)){d.focus();break}else if(d=moveNextMenu(f,e))f=d.id.split(":")[0],e=d.id.split(":")[1];else break}else if(37==b&&(f=d.id.split(":")[0],e=d.id.split(":")[1],void 0==e&&(e=f.replace("ue_"+DEXTTOP.G_CURREDITOR.ID,"")),d=movePrevMenu(f,e)))for(f=d.id.split(":")[0],e=d.id.split(":")[1];;)if(g=isMenuItemEnable(f,e)){d.focus();break}else if(d=
movePrevMenu(f,e))f=d.id.split(":")[0],e=d.id.split(":")[1];else break;if(27==b&&"1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping){b=c;for(c=!1;"BODY"!=b.tagName;)if(-1<b.id.indexOf("dext_div_tool_bar_grouping_box")){c=!0;break}else b=b.parentNode;c&&(hideGroupingBox(),setTimeout(function(){setFocusToBody()},1))}}}
function _dextiframe_Keydown(a){var b=a.target||a.srcElement,c="which"in a?a.which:a.keyCode;try{var d=DEXTTOP.G_CURREDITOR,e=d.getEditorMode();if(b&&b.tagName&&"textarea"==b.tagName.toLowerCase()){if(13==c){var f=b.id;switch(f){case "ue_"+d.ID+"zoom_text":case "txtara_"+d.ID+"font_family":case "txtara_"+d.ID+"font_size":case "txtara_"+d.ID+"line_height":DEXTTOP.DEXT5.util.stopEvent(a),DEXTTOP.DEXT5.util.cancelEvent(a),d.dextiframeKeydown=!0}switch(f){case "ue_"+d.ID+"zoom_text":command_zoom(d.ID,
d);break;case "txtara_"+d.ID+"font_family":d._dextFontFamily.click_func(d.ID,null,b.value);break;case "txtara_"+d.ID+"font_size":d._dextFontSize.click_func(d.ID,null,b.value);break;case "txtara_"+d.ID+"line_height":d._dextLineHeight.click_func(d.ID,null,b.value)}}return}if(8==c&&"design"==e){DEXTTOP.DEXT5.util.cancelEvent(a);return}}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}a.ctrlKey&&!a.altKey&&nextTabKeyAccess(a,c)&&DEXTTOP.DEXT5.util.cancelEvent(a)}
function nextTabKeyAccess(a,b){var c=!1;try{var d=null;switch(b){case 48:var e=DEXTTOP.DEXTDOC.getElementById(DEXTTOP.G_CURREDITOR._config.nextTabElementId);e?setTimeout(function(){e.focus()},0):setFocusTopWindow();var f=getEditrFromEvent(a);f&&(f._dextframeHasFocus=!1);c=!0;break;case 49:d=getFirstCmdElementInBar("dext_tab_menu_"+DEXTTOP.G_CURREDITOR.ID);c=!0;break;case 50:d=getFirstCmdElementInBar("dext_tab_tool1_"+DEXTTOP.G_CURREDITOR.ID);c=!0;break;case 51:d=getFirstCmdElementInBar("dext_tab_tool2_"+
DEXTTOP.G_CURREDITOR.ID);c=!0;break;case 52:setFocusToBody();c=!0;break;case 53:d=getFirstCmdElementInBar("dext_tab_status_"+DEXTTOP.G_CURREDITOR.ID);c=!0;break;case 54:var g=document.getElementById("dext_topstatusbar_"+DEXTTOP.G_CURREDITOR.ID),d=g&&g.getElementsByTagName("a")[0]?g.getElementsByTagName("a")[0]:null,c=!0;break;case 123:DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"shortcut");c=!0;break;case 66:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"bold"),c=!0;break;case 73:if(f=
getEditrFromEvent(a))f._dextCommands(f.ID,"italic"),c=!0;break;case 85:if(f=getEditrFromEvent(a))a.shiftKey?f._dextCommands(f.ID,"insert_row_up"):f._dextCommands(f.ID,"underline"),c=!0;break;case 68:if(f=getEditrFromEvent(a))a.shiftKey?f._dextCommands(f.ID,"insert_row_down"):f._dextCommands(f.ID,"strike_through"),c=!0;break;case 76:if(f=getEditrFromEvent(a))a.shiftKey?f._dextCommands(f.ID,"insert_column_left"):f._dextCommands(f.ID,"align_left"),c=!0;break;case 69:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,
"align_center"),c=!0;break;case 72:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"align_right"),c=!0;break;case 75:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"hyperlink_property"),c=!0;break;case 222:if(f=getEditrFromEvent(a))a.shiftKey?f._dextCommands(f.ID,"superscript"):f._dextCommands(f.ID,"subscript"),c=!0;break;case 221:(f=getEditrFromEvent(a))&&a.shiftKey&&(f._dextCommands(f.ID,"table_indent"),c=!0);break;case 219:(f=getEditrFromEvent(a))&&a.shiftKey&&(f._dextCommands(f.ID,"table_outdent"),
c=!0);break;case 70:(f=getEditrFromEvent(a))&&"1"==f._config.useFindReplaceShortcut&&(f._dextCommands(f.ID,"replace"),c=!0);break;case 82:(f=getEditrFromEvent(a))&&a.shiftKey&&(f._dextCommands(f.ID,"insert_column_right"),c=!0)}if(d){var h=d.id.split(":")[0],m=d.id.split(":")[1];if(isMenuItemEnable(h,m)){if(DEXTTOP.DEXT5.browser.chrome)try{window.focus()}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}d.focus()}else{var t=moveNextMenu(h,m);if(t){if(DEXTTOP.DEXT5.browser.chrome)try{window.focus()}catch(u){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}t.focus()}}}}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}function isMenuItemEnable(a,b){var c=!0,d=document.getElementById("dext_span_"+a+b);d&&(d=DEXTTOP.DEXT5.util.getClass(d))&&-1<d.indexOf("_off")&&(c=!1);return c}
function moveNextMenu(a,b){var c=null,d=document.getElementById("dext_span_"+a+b);if(d&&d.nextSibling){var d=d.nextSibling,e="";d.tagName&&(e=d.tagName.toLowerCase());"span"==e&&1==d.childNodes.length&&(d=d.nextSibling);if("span"==e&&1<d.childNodes.length&&(c=d.childNodes[1],d=c.id.split(":")[1],!isMenuItemEnable(a,d)))return moveNextMenu(a,d)}return c}
function movePrevMenu(a,b){var c=null,d=document.getElementById("dext_span_"+a+b);if(d&&d.previousSibling){var d=d.previousSibling,e=d.tagName.toLowerCase();"span"==e&&1==d.childNodes.length&&(d=d.previousSibling);if("span"==e&&1<d.childNodes.length&&(c=d.childNodes[1],d=c.id.split(":")[1],!isMenuItemEnable(a,d)))return movePrevMenu(a,d)}return c}
function getFirstCmdElementInBar(a){var b=null;try{var c=document.getElementById(a),d=c.childNodes.length;for(a=0;a<d;a++){var e=c.childNodes[a];if(1===e.nodeType&&0<e.childNodes.length){for(var f=e.childNodes.length,g=0;g<f;g++){var h=e.childNodes[g];if(1===h.nodeType&&("a"==h.tagName.toLowerCase()||"button"==h.tagName.toLowerCase())){b=h;break}}if(b)break}}}catch(m){b=null}return b}
function getImageAutoFitForPasteHtml(a){var b=document.createElement("div");b.innerHTML=a;a=!1;1==b.firstChild.nodeType&&"IMG"==b.firstChild.tagName&&3==b.lastChild.nodeType&&"|"==b.lastChild.nodeValue&&2==b.childNodes.length&&(a=!0,b.removeChild(b.lastChild));for(var c=b.getElementsByTagName("img"),d=null,e=c.length,f=0;f<e;f++)d=c[f],a||pluginInsertImageAutoFit(d);return a=b.innerHTML}function removeHistory(a){}
function set_view_mode_auto_height(a){try{setTimeout(function(){var b=DEXTTOP.G_CURREDITOR;a&&(b=a);if(("1"==b._config.view_mode_auto_height||"1"==b._config.view_mode_auto_width)&&"view"==b._config.mode){var d=b._BODY,e=b._DOC.documentElement,f=b._config.style.height,g=b._config.style.width,h=0;0>f.indexOf("%")&&(h=parseInt(f,10));var m=0;0>g.indexOf("%")&&(m=parseInt(g,10));var q=0,t=0,q=DEXTTOP.document.getElementById(b._config.holderID),t=getClientRect(q),u,v;void 0==t.height?u=q.offsetHeight:
u=t.height;void 0==t.width?v=q.offsetWidth:v=t.width;u=Math.round(u);v=Math.round(v);if("1"==b._config.view_mode_auto_height){f="";DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&(f=d.style,d.style="overflow:initial !important");q=Math.max(d.scrollHeight,d.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight);u>q&&(q=u);DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&(d.style=f);var w=document.body.offsetWidth<d.scrollWidth,y=document.body.offsetHeight<d.scrollHeight;if(w||
y)q+=30}else q=h,-1<f.indexOf("%")&&(q=f);if("1"==b._config.view_mode_auto_width){if(t=Math.max(d.scrollWidth,d.offsetWidth,e.clientWidth,e.scrollWidth,e.offsetWidth),w||y)t+=10}else t=m,-1<g.indexOf("%")&&(t=g);v>t&&(t=v);DEXTTOP.DEXT5.setSize(t,q,b.ID)}},250)}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function getFontStyle(a,b){var c,d={fontFamily:"",fontSize:"",lineHeight:""};b?window.getComputedStyle?c=window.getComputedStyle(a,""):a.currentStyle&&(c=a.currentStyle):a.currentStyle?c=a.currentStyle:window.getComputedStyle&&(c=window.getComputedStyle(a,""));d.fontFamily=getFontFamilyStyle(c.fontFamily);d.fontSize=getFontSizeStyle(c.fontSize,c.lineHeight);d.lineHeight=getLineHeightStyle(d.fontSize,c.lineHeight,a);return d}
function getFontFamilyStyle(a){0<a.length&&(a=a.replace(/"/gi,""),a=a.replace(/'/gi,""));return a}
function getFontSizeStyle(a,b){var c,d="pt";try{-1<DEXTTOP.G_CURREDITOR._dextFontSize._fontSize[DEXTTOP.G_CURREDITOR.ID][0].indexOf("px")&&(d="px")}catch(e){-1<DEXTTOP.G_CURREDITOR._config.defaultFontSize.indexOf("px")&&(d="px")}a=a.toString();-1<a.indexOf("px")?"pt"==d?(c=.75*parseFloat(a),c=Math.round(10*c)/10+"pt"):"px"==d&&(c=a):-1<a.indexOf("pt")?"pt"==d?c=a:"px"==d&&(c=parseFloat(a)*(4/3),c=Math.round(10*c)/10+"px"):-1<a.indexOf("em")?"pt"==d?-1<b.indexOf("px")?(c=.75*parseFloat(b),c*=parseFloat(a),
c=Math.round(10*c)/10+"pt"):-1<b.indexOf("pt")?(c=parseFloat(b)*parseFloat(a),c=Math.round(10*c)/10+"pt"):c="":"px"==d&&(-1<b.indexOf("px")?(c=parseFloat(b)*parseFloat(a),c=Math.round(10*c)/10+"px"):-1<b.indexOf("pt")?(c=parseFloat(b)*(4/3),c*=parseFloat(a),c=Math.round(10*c)/10+"px"):c=""):c="";return c}
function getLineHeightStyle(a,b,c){if(!DEXTTOP.DEXT5.browser.ie){if(1==c.nodeType&&0>",p,li,dt,dd,h1,h2,h3,h4,h5,h6,pre,table,hr,blockquote,address,body,td,th,div,".indexOf(","+c.tagName.toLowerCase()+","))for(;null!=c.parentNode&&0>",p,li,dt,dd,h1,h2,h3,h4,h5,h6,pre,table,hr,blockquote,address,body,td,th,div,".indexOf(","+c.tagName.toLowerCase()+",");)c=c.parentNode;c.currentStyle?compStyle=c.currentStyle:window.getComputedStyle&&(compStyle=window.getComputedStyle(c,""));a=compStyle.fontSize;b=compStyle.lineHeight}var d=
!0,e=DEXTTOP.G_CURREDITOR._config.lineHeightList[0];e&&0>e.indexOf("%")&&(d=!1);e=b;-1<b.indexOf("px")?(e=parseFloat(a),b=parseFloat(b),-1<a.indexOf("pt")&&(e=96*e/72),b=Math.round(b/e*10)/10,e=d?parseInt(100*b,10)+"%":b):-1<b.indexOf("pt")?(e=parseFloat(a),b=parseFloat(b),-1<a.indexOf("pt")&&(e=96*e/72),b=96*b/72/e,b=Math.round(10*b)/10,e=d?parseInt(100*b,10)+"%":b):-1<b.indexOf("normal")||-1<b.indexOf("inherit")?e=b:"1"!=DEXTTOP.G_CURREDITOR._config.lineHeightMode?e=-1<b.indexOf("%")?d?b:parseInt(b,
10)/100:d?parseInt(100*b,10)+"%":b:d&&(e=Math.round(100*parseFloat(b))+"%");c=c.tagName.toLowerCase();if("h1"==c||"h2"==c||"h3"==c||"h4"==c||"h5"==c||"h6"==c||""==a)e="";return e}
function setAutoSave(a,b,c){try{var d=a._setting.auto_save;if(d&&(a._setting.auto_save_fn&&DEXTTOP.DEXTWIN.clearInterval(a._setting.auto_save_fn),DEXTTOP.DEXT5.browser.LocalStorageSupported)){DEXTTOP.DEXTWIN.localStorage.setItem("dext_"+a.ID+"_auto_save",JSON.stringify(d));var e=!1;"on"===d.userSetting?e=!0:"off"===d.userSetting?e=!1:"1"===d.defaultUse&&(e=!0);if(e){var f=a._config.setAutoSave.use_encrypt,g=a._config.setAutoSave.unique_key,h="dext_"+a.ID;""!=g&&(h+="_"+g);if(b){var m=DEXTTOP.DEXTWIN.localStorage["dext_"+
a.ID];null!=m&&void 0!=m&&""==g&&(DEXTTOP.DEXT5.util.saveJsonToLocalStorage(h+"_0",{date:a._DOC.lastModified,html:m}),DEXTTOP.DEXTWIN.localStorage.removeItem("dext_"+a.ID))}localSaveValue(h,f,a._config.setAutoSave.maxCount);a._setting.auto_save_fn=fn_AutoSaveInterval(a,h);1==c&&DEXTTOP.DEXT5.manuallyTempSave(a.ID);var q=DEXTTOP.DEXTWIN.localStorage[h+"_0"];null!=q&&void 0!=q&&autoSaveEnable(a.ID)}}}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function getAutoSaveHtml(a){var b=void 0;try{b=DEXTTOP.DEXTWIN.localStorage["dext_"+a]}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return b}
function getAutoSaveHtml_userID(a,b,c){var d=void 0,e=[],f,g={};a="dext_"+a;""!=b&&null!=b&&void 0!=b&&(a+="_"+b);try{for(b=0;b<parseIntOr0(c);b++)if(d=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage(a+"_"+b),null!=d&&void 0!=d){var h=d.html.toLowerCase().indexOf("<html");-1<h?f=d.html:0>h&&(f=DEXTTOP.DEXT5.util._fn_$mDRM(d.html));g={date:d.date,html:f};e.push(g)}}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return 0<e.length?e:d}
function getAutoSave(a){var b={time:a._config.setAutoSave.interval,userSetting:null,defaultUse:a._config.setAutoSave.defaultUse};if("0"===a._config.setAutoSave.mode)b=null;else if("1"===a._config.setAutoSave.mode)b.defaultUse="1";else{a="dext_"+a.ID+"_auto_save";var c;try{c=DEXTTOP.DEXTWIN.localStorage.getItem(a)}catch(d){b=null}if(null!==b&&"string"===typeof c&&0<c.length)if(0!==c.indexOf("{"))c=DEXTTOP.DEXT5.util.parseIntOr0(c),0<c?(b.time=c,b.userSetting="on"):DEXTTOP.DEXTWIN.localStorage.removeItem(a);
else try{c=JSON.parse(c),c.defaultUse===b.defaultUse&&(b=c)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}return b}
function _iframeDoc_Scroll(a){setDEXTWINDOC();try{if(DEXTTOP.G_CURREDITOR.isStopScroll){var b=Math.max(_iframeDoc.documentElement.scrollLeft,_iframeDoc.body.scrollLeft);_iframeWin.scroll(b,DEXTTOP.G_CURREDITOR.previousScrollTop);DEXTTOP.DEXT5.util.cancelEvent(a);DEXTTOP.DEXT5.util.stopEvent(a);return!1}DEXTTOP.DEXT5.browser.ie&&(DEXTTOP.G_CURREDITOR.previousScrollTop=Math.max(_iframeDoc.documentElement.scrollTop,_iframeDoc.body.scrollTop))}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(getApplyDragResize(DEXTTOP.G_CURREDITOR))if(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv){var b=
getElementOffset(_iframeWin.frameElement),d=getClientRect(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem);DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv.style.left=b.left+d.left-DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDivBorder+"px";DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv.style.top=b.top+d.top-DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDivBorder+"px";DEXTTOP.G_CURREDITOR.dext_dragresize.setDragResizeDivSize(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv);
DEXTTOP.G_CURREDITOR.dext_dragresize.setHandlePosition()}else null!=DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag=!0),DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear();moveRulerPosition(a);"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&DEXTTOP.G_CURREDITOR.isAOver.over&&(DEXTTOP.G_CURREDITOR.isAOver.node||DEXTTOP.G_CURREDITOR.isAOver.nodeChild)&&DEXTTOP.G_CURREDITOR.isAOver.openHelp&&
hyperHelpClose();if(1==DEXTTOP.G_CURREDITOR.preventScrollMove.use)return _iframeDoc.documentElement.scrollTop=DEXTTOP.G_CURREDITOR.preventScrollMove.beforeTop,_iframeDoc.documentElement.scrollLeft=DEXTTOP.G_CURREDITOR.preventScrollMove.beforeLeft,DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),!1;b=DEXTTOP.DEXTWIN.dext_editor_scroll_event||_dext_editor._config.event.scroll;"function"===typeof b&&b({event:a},_dext_editor.ID)}
function moveRulerPosition(a){var b=getEditrFromEvent(a);if(null==b||void 0==b)b=DEXTTOP.G_CURREDITOR;set_horizontal_line_2(b,a);if(G_Ruler&&G_Ruler.viewRulerStatus&&"view"!=b._config.mode){getEditorFrameDoc(b);var c=G_Ruler.rulerArea;if(c&&"none"!=c.style.display||"1"==b._config.ruler.viewGuideLine){var d,e;"preview"==b.getEditorMode()?(d=b._EDITOR.preview.contentWindow.document.documentElement,e=b._EDITOR.preview.contentWindow.document.body):(d=b._DOC.documentElement,e=b._BODY);var f=c.style.backgroundPosition,
g=c.style.backgroundPosition.indexOf("px"),f=-1<g?parseInt(f.substring(0,g),10):0;d=d.scrollLeft||e.scrollLeft||0;f!=d&&(c.style.backgroundPosition=-1*d+"px top",G_Ruler.SetRulerPosition())}set_ruler_vertical_height(b,a)}}
function set_ruler_horizontal_width(a,b){if(G_Ruler&&G_Ruler.viewRulerStatus&&("design"==a._currentMode||"preview"==a._currentMode)){var c=getEditorFrameDoc(a),d,e,f=c.getElementById("dext_ruler_horizontal_scroll_"+a.ID);if(null!=f){"preview"==a.getEditorMode()?(d=a._EDITOR.preview.contentWindow.document.documentElement,e=a._EDITOR.preview.contentWindow.document.body):(d=_iframeDoc.documentElement,e=_iframeDoc.body);var g=getClientRect(e);if(0!=g.top||0!=g.right||0!=g.bottom||0!=g.left){d=d.scrollLeft||
e.scrollLeft||0;for(var h=c.getElementById("h_plus_ruler_area"),m=h.childNodes.length,q=(a._BODY.scrollWidth>parseIntOr0(getCurrEditorWidth())?a._BODY.scrollWidth:parseIntOr0(getCurrEditorWidth()))/50;m<=q+1;m++){var t=c.createElement("div");t.className="ruler_horizontal_num";t.innerHTML="<span>"+50*m+"</span>";h.appendChild(t)}h=c.getElementById("h_minus_ruler_area");t=h.childNodes.length;m=t+1;G_Ruler.hRuler0PositionLeft=g.left+d+DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.util.getStyle(e,"padding"));
isRTL()&&(g=getClientRect(_iframeWin.frameElement).right-g.right,G_Ruler.hRuler0PositionLeft=g+d+DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.util.getStyle(e,"padding")));for(e=Math.ceil(1*G_Ruler.hRuler0PositionLeft/50);m<=e;m++)t=c.createElement("div"),t.className="ruler_horizontal_num",t.innerHTML="<span>"+-50*m+"</span>",h.hasChildNodes()?h.insertBefore(t,h.firstChild):h.appendChild(t);t=h.childNodes.length;c=50*t-G_Ruler.hRuler0PositionLeft;isRTL()?(c=50*t-G_Ruler.hRuler0PositionLeft,f.style.right=
-1*(d+c)+"px",f.style.left="auto"):f.style.left=-1*(d+c)+"px"}}}}function set_ruler_point_position(a){if("1"==a._config.ruler.mode&&"1"==a._config.ruler.viewPointer){var b=getEditorFrameDoc(a),c=G_Ruler.rulerPositionArr,d=G_Ruler.rulerPositionLen,e="marginLeft",f=0;isRTL()&&(e="marginRight",f=1);for(var g=0;g<d;g++){var h=b.getElementById("dext_ruler_point_"+g+"_"+a.ID);h&&(position=G_Ruler.GetLeftPosition(h,c[g])+f,h.style[e]=position+"px",h.style.display=0==position?"none":"")}}}
function set_ruler_pointline_position(a){if("1"==a._config.ruler.viewGuideLine){var b=getEditorFrameDoc(a),c=G_Ruler.rulerPositionArr,d=G_Ruler.rulerPositionLen,e="left",f=0;isRTL()&&(e="right",f=2);for(var g=0;g<d;g++){var h=0,m=0,q=b.getElementById("dext_ruler_point_"+g+"_"+a.ID);q&&(h=parseIntOr0(q.style.width),m=G_Ruler.GetLeftPosition(q,c[g])+f);if(q=b.getElementById("dext_ruler_pointline_"+g+"_"+a.ID))q.style[e]=m+h/2+"px",0==m?q.style.display="none":"1"==a._config.ruler.viewGuideLine&&"1"==
a._config.ruler.defaultView&&(q.style.display="")}}}
function set_ruler_vertical_height(a,b){if(G_Ruler&&G_Ruler.viewRulerStatus&&"1"==a._config.ruler.useVertical&&"view"!=a._config.mode&&("design"==a._currentMode||"preview"==a._currentMode)){var c=getEditorFrameDoc(a),d,e,f=c.getElementById("dext_ruler_vertical_scroll_"+a.ID);if(null!=f){"design"==a._currentMode?(d=a._DOC.documentElement,e=a._BODY):"preview"==a._currentMode&&(e=a._EDITOR.preview.contentWindow.document,d=e.documentElement,e=e.body);var g=getClientRect(e);if(0==g.top&&0==g.right&&0==
g.bottom&&0==g.left)return;d=d.scrollTop;0==d&&(d=e.scrollTop);for(var h=c.getElementById("v_plus_ruler_area"),m=h.childNodes.length,q=(a._BODY.scrollHeight>a._defaultHeight?a._BODY.scrollHeight:a._defaultHeight)/50;m<=q+1;m++){var t=c.createElement("div");t.className="ruler_vertical_num";t.innerText=50*m;h.appendChild(t)}h=c.getElementById("v_minus_ruler_area");t=h.childNodes.length;m=t+1;G_Ruler.vRuler0PositionTop=g.top+d+DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.util.getStyle(e,"padding"));
for(e=Math.ceil(1*G_Ruler.vRuler0PositionTop/50);m<=e;m++)t=c.createElement("div"),t.className="ruler_vertical_num",t.innerHTML="<span>"+-50*m+"</span>",h.hasChildNodes()?h.insertBefore(t,h.firstChild):h.appendChild(t);t=h.childNodes.length;f.style.top=-1*(d+(50*t-G_Ruler.vRuler0PositionTop))+"px"}if("2"==a._config.ruler.mode){e=f="0px";e={top:0,bottom:0};try{if(null!=G_CURSOR_ELEMENT){for(var u=getParentbyTagNameEx(G_CURSOR_ELEMENT,"p,li,h1,h2,h3,h4,h5,h6");u&&u.tagName&&-1<u.tagName.indexOf("DIAGONAL");)u=
u.previousSibling;null!=u&&(e=u.getBoundingClientRect())}}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}f=(0<e.top?e.top:0)+"px";e=(0<e.bottom?e.bottom:0)+"px";u=c.getElementById("dext_ruler_vertical_area_0_"+a.ID);null!=u&&(u.style.height=f);u=c.getElementById("dext_ruler_vertical_area_1_"+a.ID);null!=u&&(u.style.top=e)}"undefined"==typeof b&&(u=c.getElementById("dext_ruler_vertical_"+a.ID),null!=u&&(u.style.height=a._defaultHeight+"px"),u=c.getElementById("ue_editor_holder_"+
a.ID),null!=u&&("1"==a._config.ruler.view?isRTL()?u.style.marginRight="18px":u.style.marginLeft="18px":u.style.marginLeft="0px"),u=c.getElementById("dext_tab_tool3_"+a.ID),null!=u&&(isRTL()?(u.style.right="17px",u.style.borderRight="1px solid #b8babc"):(u.style.left="17px",u.style.borderLeft="1px solid #b8babc")),"2"==a._config.ruler.mode&&(u=c.getElementById("dext_tab_tool4_"+a.ID),null!=u&&(isRTL()?(u.style.right="17px",u.style.borderRight="1px solid #b8babc"):(u.style.left="17px",u.style.borderLeft=
"1px solid #b8babc"))),u="marginLeft",isRTL()&&(u="marginRight"),f=c.getElementById("dext_ruler_pointline_0_"+a.ID),null!=f&&(f.style[u]="18px"),f=c.getElementById("dext_ruler_pointline_1_"+a.ID),null!=f&&(f.style[u]="18px"),f=c.getElementById("dext_ruler_pointline_2_"+a.ID),null!=f&&(f.style[u]="18px"),f=c.getElementById("dext_ruler_pointline_3_"+a.ID),null!=f&&(f.style[u]="18px"),c=c.getElementById("dext_horizontal_line_"+a.ID),null!=c&&(c.style.marginLeft="1"==a._config.ruler.view?"18px":"0px"))}}
function set_ruler_mouse_guide(a,b){if(G_Ruler&&G_Ruler.viewRulerStatus&&"1"==a._config.ruler.useMouseGuide){var c=getEditorFrameDoc(a).getElementById("dext_ruler_mouse_guide_"+a.ID);null!=c&&(c.style.left=b.clientX+"px")}}
function set_horizontal_line_2(a){if("2"==a._config.horizontalLine.use&&"view"!=a._config.mode){var b=getEditorFrameDoc(a),c=b.getElementById("dext_horizontal_line_"+a.ID);null==c&&(c=document.createElement("div"),c.id="dext_horizontal_line_"+a.ID,(b=b.getElementById("ue_editor_holder_"+a.ID))&&b.parentNode.insertBefore(c,b));if(null!=c){var b=1*a._config.horizontalLine.height,d;d="preview"==a._currentMode?getWindowClientSize(a._EDITOR.preview.contentWindow):getWindowClientSize(a._FRAMEWIN._iframeWin);
var e=d[0];DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&(e=a._FRAMEWIN._iframeWin.frameElement.clientWidth);d=d[1];var f=!1,g=d/b,h=0;"design"==a._currentMode?(h=a._DOC.documentElement.scrollTop,0==h&&(h=a._BODY.scrollTop),f=d<a._BODY.scrollHeight):"preview"==a._currentMode&&(f=a._EDITOR.preview.contentWindow.document,h=f.documentElement.scrollTop,0==h&&(h=f.body.scrollTop),f=d<f.body.scrollHeight);for(var m=c.childNodes;c.firstChild;)c.removeChild(c.firstChild);for(var q=0;q<g;q++){var t;
m[q]?t=m[q]:(t=document.createElement("div"),t.className="horizontal_line_2",""!=a._config.horizontalLine.style&&(t.style.borderBottom=a._config.horizontalLine.style),c.appendChild(t));var u=b*(q+1)-h%b;d>=u?t.style.marginTop=u+"px":(t.style.marginTop=u+30+"px",u+=30);t.style.width=f?e-16+"px":"";if("0"==a._config.horizontalLine.repeat){u+h!=DEXTTOP.DEXT5.util.parseIntOr0(a._config.horizontalLine.height)?t.style.display="none":t.style.display="";break}}}}}
function changeSpanPageBreakProperty(a){var b=function(a){for(var b=a.length,c=0;c<b;c++){var g=a[c];if("always"==g.style.pageBreakAfter||"page"==g.style.breakAfter)g.getElementsByTagName("span")[0].innerText="",g.style.borderStyle="none",g.style.borderWidth="0px"}},c=a.getElementsByTagName("span");a=a.getElementsByTagName("div");b(c);b(a)}
function restoreSpanPageBreakProperty(a){a=a.getElementsByTagName("span");for(var b=a.length,c=0;c<b;c++){var d=a[c];"always"==d.style.pageBreakAfter&&(d.getElementsByTagName("span")[0].innerText=dext5_lang.icon.pagebreak,d.style.borderColor="red",d.style.borderStyle="dashed",d.style.borderWidth="1px")}}
function setLineHeightForBgColor(){if(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion)try{var a=getFirstRange().range,b=getMyElementNode(a.startContainer);if("SPAN"==b.tagName&&(""!=b.style.color||""!=b.style.backgroundColor)){for(var c,a=b;"BODY"!=a.parentNode.tagName;)if("P"==a.parentNode.tagName){c=a;break}else a=a.parentNode;currLineHeight=getFontStyle(b).lineHeight;var d=DEXTTOP.G_CURREDITOR._setting.line_height,a=!1;if(""==currLineHeight)a=!0;
else{var e=currLineHeight.indexOf("%");if(-1<e){var f=parseInt(currLineHeight,10);currLineHeight=f/=100}e=d.indexOf("%");-1<e&&(f=parseInt(d,10),d=f/100)}currLineHeight==d&&(a=!0);var g;1==a&&(g=1*currLineHeight+.01);g&&c&&"SPAN"==c.tagName&&a&&(c.style.lineHeight=g,c!=b&&(b.style.lineHeight=currLineHeight))}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function isMsHtmlorHugeHtml(a){var b=!0;return 11>DEXTTOP.DEXT5.browser.ieVersion?b:b=RegExp('mso-[^:]+:[^;">]+;',"gi").test(a.innerHTML)}
function setEditorBorder(a){for(var b=a._config.style.skinName,c=[],d=document.getElementById("dext_menu_"+a.ID),b=getElementsByClass("ue_tg_"+b,document)[0],e=document.getElementById("dext_toolbar_"+a.ID),f=document.getElementById("ue_editor_holder_"+a.ID),g=document.getElementById("dext_statusbar_"+a.ID),f=[d,e,f,g],g=f.length,d=0;d<g;d++)null!=f[d]&&"none"!=f[d].style.display&&(f[d]==e?c.push(b):c.push(f[d]));b=c.length;for(d=0;d<b;d++)"0px"==c[d].style.borderTopWidth&&DEXTTOP.DEXT5.util.removeStyleAttribute(c[d],
"border-top-width"),"1"==a._config.editorborder?(DEXTTOP.DEXT5.util.removeStyleAttribute(c[d],"border-top-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(c[d],"border-right-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(c[d],"border-bottom-width"),DEXTTOP.DEXT5.util.removeStyleAttribute(c[d],"border-left-width")):(0==d&&(c[d].style.borderTopWidth="0px"),d==b-1&&(c[d].style.borderBottomWidth="0px"),c[d].style.borderRightWidth="0px",c[d].style.borderLeftWidth="0px");"0"!=a._config.top_status_bar||
isViewMode(a)||(c[0].style.borderTopWidth="0px")}function getDefaultParagraphValue(a){var b="";return b=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?a?"<p>&nbsp;</p>":"&nbsp;":a?"<p><br /></p>":"<br />"}
function repairBodyFirstLastTag(a){try{if(0!=DEXTTOP.G_CURREDITOR._config.editorBodyEditable){var b=_iframeDoc.body.childNodes,c=b.length,d=!1,e,f;if(0==c.length)d=!0;else{f=b[0];e=b[c-1];if(1==a&&1==f.nodeType&&("table"==f.tagName.toLowerCase()||"blockquote"==f.tagName.toLowerCase()||0==f.className.indexOf("dext5-imgslider"))){insertPtagTableNear(!0,f);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;return}if(1!=e.nodeType||"p"!=e.tagName.toLowerCase())d=!0;
if(1==e.nodeType&&"p"==e.tagName.toLowerCase()){var g=e.childNodes,h=g.length;""==e.innerText&&0<h&&1==g[h-1].nodeType&&("img"==g[h-1].tagName.toLowerCase()||"table"==g[h-1].tagName.toLowerCase())&&(d=!0)}}if(d){var m=_iframeDoc.createElement("p");DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion||(m.innerHTML=getDefaultParagraphValue(!1));_iframeDoc.body.appendChild(m)}}}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function OfficePasteClean(a){var b=a;try{a=ReplaceAll(a,unescape("%uFEFF"),"");a=ReplaceAll(a,unescape("%u200B"),"");a=a.replace(/\r\n/g,"");a=a.replace(/\r/g,"");a=removeDummyTag(a);"HWP"==getPasteFormatType()&&(a=replaceNotRenderedSpaceToNbsp(a));if("ieplugin"==DEXTTOP.G_CURREDITOR._config.runtimes&&G_dext5plugIn&&4==G_dext5plugIn.getHTMLFormatFromType||"HWP"==G_wordProcessorType)a=a.replace(/<p[^>]*><\/p>/gi,""),a=a.replace(/(<p[^>]*>)<span[^>]*> <\/span>(<\/p>)/gi,"$1<br>$2");var c=RegExp("<span *([^>?+])*>(\\n)</span>",
"gi"),d=RegExp("<span *([^>?+])*>(\\n)<span","gi"),e=a,f=!1;try{var g=a.match(c);if(g)for(var h=g.length,m=0;m<h;m++)var q=g[m],t=/>\n</.exec(q),u=t[0].replace(RegExp("\\n","gi")," "),q=q.replace(t,u),e=e.replace(g[m],q);if(g=a.match(d))for(h=g.length,m=0;m<h;m++)q=g[m],t=/>\n</.exec(q),u=t[0].replace(RegExp("\\n","gi")," "),q=q.replace(t,u),e=e.replace(g[m],q)}catch(v){f=!0}f||(a=e);a=a.replace(/>\n+</g,"><");a=a.replace(/\t/g,"");a=-1<a.indexOf("<")?a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,""):a.replace(/^[\xa0]+|[\xa0]+$/g,
"");a=a.replace(/<font/gi,'<span dext_fonttag="true"');a=a.replace(/<\/font/gi,"</span");d="(<span[^>]*?raon_placeholder.*?>)(?:\\s|<br>|<br />|  | |)</span>";c=new RegExp(d,"gim");a=a.replace(c,"$1"+unescape("%u200B")+"</span>");if(DEXTTOP.DEXT5.browser.ie){a=ReplaceAll(a,unescape("%u3000"),"");d="<font[^>]*>(?:\\s|&nbsp;|  |)</font>";a=a.replace(new RegExp(d,"gim"),"");var d="<span[^>]*>(?:|  |)</span>",w=new RegExp(d,"gim")}else"PPT"==G_wordProcessorType&&(a=ReplaceAll(a,unescape("%u3000"),""),
a=ReplaceAll(a,"\u3000","<p><br></p>")),d="<span[^>]*>(?:|  |)</span>",w=new RegExp(d,"gim");a=a.replace(w,"");if("ieplugin"==DEXTTOP.G_CURREDITOR._config.runtimes&&G_dext5plugIn&&2==G_dext5plugIn.getHTMLFormatFromType||"XLS"==G_wordProcessorType){var y=DEXTTOP.G_CURREDITOR._config.removeFontType.fontFamily,x=DEXTTOP.G_CURREDITOR._config.removeFontType.type,z=y.length,B=x.length;if(0<z&&0<B){w=!1;for(e=0;e<z;e++)if((new RegExp("(<[^>]*)("+y[e]+")([^/>]*>)","gi")).test(a)){w=!0;break}if(w)for(y=0;y<
B;y++)c=new RegExp("(<[^>]*)(,\\s?"+x[y]+")([^/>]*>)","gi"),c.test(a)&&(a=a.replace(c,"$1$3"))}}if("ieplugin"==DEXTTOP.G_CURREDITOR._config.runtimes&&G_dext5plugIn&&3==G_dext5plugIn.getHTMLFormatFromType||"PPT"==G_wordProcessorType)a=setFontSizeForPpt(a);B=["gfxdata","spid","title"];for(x=0;x<B.length;x++)d="(<[^>]*?)(o:"+B[x]+'=?"[\\s\\S]*?")',c=new RegExp(d,"gim"),a.match(c)&&(a=a.replace(c,"$1"));d="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>";c=new RegExp(d,"gim");a=a.replace(c,
"$1</span>");a=applyFakeImgSrc(a);var D=document.createElement("div");D.innerHTML=a;for(var A=D.getElementsByTagName("span"),C=A.length,x=0;x<C;x++){null!=A[x].getAttribute("face")&&void 0!=A[x].getAttribute("face")&&""!=A[x].getAttribute("face")&&(""==A[x].style.fontFamily&&(A[x].style.fontFamily=A[x].getAttribute("face")),removeAttribute(A[x],"face"));null!=A[x].getAttribute("color")&&void 0!=A[x].getAttribute("color")&&""!=A[x].getAttribute("color")&&(""==A[x].style.color&&(A[x].style.color=A[x].getAttribute("color")),
removeAttribute(A[x],"color"));if(null!=A[x].getAttribute("dext_fonttag")&&void 0!=A[x].getAttribute("dext_fonttag")&&""!=A[x].getAttribute("dext_fonttag")){null==A[x].getAttribute("size")||void 0==A[x].getAttribute("size")||A[x].getAttribute("size");for(var E=A[x].getElementsByTagName("span"),H=E.length,m=0;m<H;m++)null!=E[m].getAttribute("size")&&void 0!=E[m].getAttribute("size")&&""!=E[m].getAttribute("size")||removeAttribute(E[m],"dext_fonttag");removeAttribute(A[x],"dext_fonttag")}if(null!=A[x].getAttribute("size")&&
void 0!=A[x].getAttribute("size")&&""!=A[x].getAttribute("size")){var M;switch(A[x].getAttribute("size")){case "1":M="8pt";break;case "2":M="10pt";break;case "3":M="12pt";break;case "4":M="14pt";break;case "5":M="18pt";break;case "6":M="24pt";break;case "7":M="36pt";break;default:M=""}""!=M&&""==A[x].style.fontSize&&(A[x].style.fontSize=M);removeAttribute(A[x],"size")}}if("1"==DEXTTOP.G_CURREDITOR._config.useCorrectInOutdent){var N=D.innerHTML,I=D.getElementsByTagName("p"),S=I.length;try{for(x=0;x<
S;x++){var F=I[x].style.textIndent,O,P;F&&0<F.length&&(O=parseFloat(F),P=F.replace(O,"").toLowerCase());var J=I[x].style.marginLeft,L,K;J&&0<J.length&&(L=parseFloat(J),K=J.replace(L,"").toLowerCase());if(O&&L){if(P==K)var W=O+L;else"pt"==P?O=4*O/3:"cm"==P&&(O*=37.795275593333),"pt"==K?L=4*L/3:"cm"==K&&(L*=37.795275593333),W=O+L;0>W&&(I[x].style.textIndent="",I[x].style.marginLeft="")}else O?0>O&&(I[x].style.textIndent=""):L&&0>L&&(I[x].style.marginLeft="")}}catch(G){D.innerHTML=N}}if("1"==DEXTTOP.G_CURREDITOR._config.adjustTextIndentInPaste&&
(G_dext5plugIn&&1==G_dext5plugIn.getHTMLFormatFromType||"DOC"==G_wordProcessorType))for(I=D.getElementsByTagName("p"),S=I.length,x=0;x<S;x++){var Q=I[x].style.textIndent,X=DEXTTOP.DEXT5.util.parseIntOr0(I[x].style.marginLeft),ea=DEXTTOP.DEXT5.util.parseIntOr0(Q);if(0!=ea){var V=Q.replace(ea,"");I[x].style.marginLeft=X+ea+V;I[x].style.textIndent=""}}for(var aa=D.getElementsByTagName("a"),x=0;x<aa.length;x++){for(var ga=aa[x].childNodes,m=c=0;m<ga.length;m++)if(1==ga[m].nodeType&&"SPAN"==ga[m].tagName){c++;
var ba=ga[m];""!=ba.style.color&&""==ba.style.textDecoration&&(ba.style.textDecoration="underline")}1==c&&ba&&"none"==ba.style.textDecoration&&(aa[x].style.textDecoration="none")}"ieplugin"==DEXTTOP.G_CURREDITOR._config.runtimes&&G_dext5plugIn&&4==G_dext5plugIn.getHTMLFormatFromType&&(removeDummyDivInHwp(D),D.innerHTML=GetHanHwpHtml(D.innerHTML));copyImageToTempFolder(D);a=D.innerHTML;a=applyFakeImgSrc(a,!0);a=officePasteCleanForTable(a)}catch(fa){a=b}return a}
function removeAttributeForPasteTable(a){var b=!1;"none"==a.style.display&&(b=!0);for(var c=["height","style"],d=c.length,e=0;e<d;e++)removeAttribute(a,c[e]);b&&(a.style.display="none")}
function makeRangeSelectionMarkInDesign(){try{restoreSelection();setFocusToBody();var a=getFirstRange().range,b=getFirstRange().sel;if(a&&0==a.collapsed)if(a.startContainer==a.endContainer&&3==a.startContainer.nodeType){var c=a.startOffset,d=a.endOffset,e=a.cloneRange(),f=_iframeDoc.createElement("dextmark");f.setAttribute("class","dextmark");a.collapse(!0);a.insertNode(f);a.selectNode(f);a.setStartAfter(f);a.setEndAfter(f);a.setStart(f.nextSibling,d-c);a.setEnd(f.nextSibling,d-c);var g=_iframeDoc.createElement("dextmark");
g.setAttribute("class","dextmark");a.insertNode(g)}else e=a.cloneRange(),g=_iframeDoc.createElement("dextmark"),g.setAttribute("class","dextmark"),a.collapse(!1),a.insertNode(g),b.removeAllRanges(),b.addRange(e),a=getFirstRange().range,f=_iframeDoc.createElement("dextmark"),f.setAttribute("class","dextmark"),a.collapse(!0),a.insertNode(f);else c=a.startOffset,d=a.endOffset,a.cloneRange(),f=_iframeDoc.createElement("dextmark"),f.setAttribute("class","dextmark"),a.collapse(!0),a.insertNode(f),a.selectNode(f),
a.setStartAfter(f),f.nextSibling&&1!=f.nextSibling.nodeType&&(a.setEndAfter(f),a.setStart(f.nextSibling,d-c),a.setEnd(f.nextSibling,d-c)),g=_iframeDoc.createElement("dextmark"),g.setAttribute("class","dextmark"),a.insertNode(g)}catch(h){removeDextMarkInFrame()}}
function setRangeSelectionMarkInDesign(a){try{_iframeDoc.body.innerHTML.match(/<dextmark ([^>]+)><\/dextmark>/i);var b=getElementsByClass("dextmark",_iframeDoc,"dextmark"),c=b.length;if(0<c){var d,e,f=!0;1==c?(d=b[0],e=b[0]):2==c&&(f=!1,d=b[0],e=b[1]);setTimeout(function(){var g=getFirstRange().range;getFirstRange();g.setStartAfter(d);g.setEndBefore(e);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(g);try{var m=g.startContainer;3==m.nodeType&&(m=m.parentNode);
setMenuIconRealable(m)}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}for(m=c-1;0<=m;m--){var t=b[m];t.parentNode.removeChild(t)}b=_iframeDoc.getElementsByTagName("/dextmark");c=b.length;for(m=c-1;0<=m;m--){var t=b[m],u=t.parentNode;u.removeChild(t);DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion&&1==c&&("P"==u.tagName||"SPAN"==u.tagName)&&""==u.innerHTML&&(u.innerHTML=unescape("%uFEFF"),doSetCaretPosition(u,!0))}m=null;0==DEXTTOP.DEXT5.browser.ie&&(m=getFirstRange().range);
var v=g.startContainer,g=function(){if(0==!!a){var b=getSelectionCoords(_iframeWin);if(b&&0!=b.x&&0!=b.y){var c=getClientRect(_iframeDoc.body),d=0,e=b.y;b.x>=c.right-c.left&&(d=b.x);_iframeWin.scroll(d,e)}else b=getElementOffset(v),_iframeWin.scroll(b.left,b.top)}};f?"BODY"==v.tagName?setFocusChildForStyle(v):g():g();m&&(rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(m))},0)}}catch(g){removeDextMarkInFrame()}}
function makeRangeSelectionMarkInSource(a){try{var b=a.value,c,d,e='<dextmark class="dextmark"></dextmark>',f=a.value.match(/<dextmark class=(.+?)><\/dextmark>/i);null!=f&&(e=f[0]);c=d=e;if(document.selection){a.focus();var g=document.selection.createRange(),h=g.text,m=h.indexOf("<"),q=h.indexOf(">");-1<q&&(m>q||-1==m)&&g.moveStart("character",q+1);m=q=-1;m=h.lastIndexOf("<");q=h.lastIndexOf(">");-1<m&&(m>q||-1==q)&&g.moveEnd("character",-(h.length-m));var t=g.duplicate();if(preCheckSpecialCharTextAreaOld(t))return;
g=checkSpecialCharTextAreaOldIE(g);h=g.text;g.text=c+h;""!=h&&(g.text+=d)}else if(a.selectionStart||"0"==a.selectionStart){var u=a.selectionStart,v=a.selectionEnd,w=a.value.substring(0,u),y=a.value.substring(u,v),x=a.value.substring(v,a.value.length),m=y.indexOf("<"),q=y.indexOf(">");-1<q&&(m>q||-1==m)&&(u+=q+1);m=q=-1;m=y.lastIndexOf("<");q=y.lastIndexOf(">");-1<m&&(m>q||-1==q)&&(v-=y.length-m);if(preCheckSpecialCharTextArea(a))return;w=a.value.substring(0,u);y=a.value.substring(u,v);x=a.value.substring(v,
a.value.length);if(""==y){var z=checkSpecialCharTextArea(w,x);0<z&&(u-=z,v-=z)}else z=checkSpecialCharTextArea(w,y),0<z&&(u-=z),z=0,z=checkSpecialCharTextArea(y,x),0<z&&(v-=z);w=a.value.substring(0,u);y=a.value.substring(u,v);x=a.value.substring(v,a.value.length);a.value=w+c+y;a.value=u!=v?a.value+(d+x):a.value+x}var B=document.createElement("div"),D=a.value,D=applyFakeImgSrc(D);B.innerHTML=D;0==RegExp("<dextmark[^>]+class=.*?dextmark.*?></dextmark>","gi").test(B.innerHTML)&&(a.value=b)}catch(A){a.value=
removeDextMarkInString(a.value)}}
function preCheckSpecialCharTextArea(a){var b=["&nbsp;","&lt;","&gt;","&quot;","&amp;"],c=!1,d=a.selectionStart,e=a.selectionEnd,f=a.value.substring(0,d),d=a.value.substring(d,e);a=a.value.substring(e,a.value.length);e=f.lastIndexOf("<");f=f.lastIndexOf(">");if(e>=f)return!0;f=a.lastIndexOf(">");a=a.lastIndexOf("<");if(f<a&&-1<f)return!0;d=d.toLowerCase();if(""!=d&&-1==d.indexOf("&")&&-1==d.indexOf(";")&&4>=d.length)for(f=0;f<b.length;f++)if(-1<b[f].indexOf(d)){c=!0;break}return c}
function preCheckSpecialCharTextAreaOld(a){var b=["&nbsp;","&lt;","&gt;","&quot;","&amp;"],c=!1,d=a.duplicate(),e=a.text,e=ReplaceAll(e,unescape("\r"),""),e=e.toLowerCase();a.moveEnd("character",-e.length);for(var f=1;1E4>=f;f++){a.moveStart("character",-f);var g=a.text;if(/>\s*</.test(g))return d.duplicate(),!0;if(-1<g.lastIndexOf(">"))break;if(-1<g.lastIndexOf("<"))return d.duplicate(),!0}a=d.duplicate();a.moveStart("character",e.length);for(f=1;1E4>=f;f++){a.moveEnd("character",f);g=a.text;if(/>\s*</.test(g))return d.duplicate(),
!0;if(-1<g.lastIndexOf("<"))break;if(-1<g.lastIndexOf(">"))return d.duplicate(),!0}if(""!=e&&-1==e.indexOf("&")&&-1==e.indexOf(";")&&4>=e.length)for(a=b.length,f=0;f<a;f++)if(-1<b[f].indexOf(e)){c=!0;break}d.duplicate();return c}
function checkSpecialCharTextArea(a,b){var c=["&nbsp;","&lt;","&gt;","&quot;","&amp;"],d=0;a=a.toLowerCase();b=b.toLowerCase();var e=a.split("&");if(1>=e.length)return d;var f=b.split(";");if(1>=f.length)return d;for(var g=!1,h="",h="&"+e[e.length-1]+f[0]+";",f=0;f<c.length;f++)if(c[f]==h){g=!0;break}g&&(d=e[e.length-1].length+1);return d}
function checkSpecialCharTextAreaOldIE(a){var b=a.duplicate(),c=a.text,c=ReplaceAll(c,unescape("\r"),"");a.moveStart("character",-7);a.moveEnd("character",-c.length);var d=a.text;a=b.duplicate();a.moveStart("character",c.length);a.moveEnd("character",7);var e=a.text;a=b.duplicate();b=checkSpecialCharTextArea(d,c);0<b&&a.moveStart("character",-b);b=checkSpecialCharTextArea(c,e);0<b&&a.moveEnd("character",-b);return a}
function setRangeSelectionMarkInSource(a){try{var b=a.value,c='<dextmark class="dextmark"></dextmark>',d=b.match(/<dextmark ([^>]+)><\/dextmark>/i);null!=d&&(c=d[0]);var b=ReplaceAll(b,unescape("\r"),""),e,f;e=f=0;var g=b.indexOf(c);if(-1!=g){e=g;var b=b.replace(c,""),h=b.indexOf(c,e);-1!=h&&(f=h,b=b.replace(c,""),1<b.split(/^\s/g).length&&(b=b.replace(/^\s/g,""),--e),a.value=b,setTimeout(function(){a.focus();if(e==f)if(a.createTextRange){var b=a.createTextRange();b.move("character",e);b.select()}else a.selectionStart?
setTimeout(function(){window.focus();a.focus();a.setSelectionRange(e,e)},1):a.focus();else"setSelectionRange"in a?setTimeout(function(){window.focus();a.focus();a.setSelectionRange(e,f)},1):(b=a.createTextRange(),b.collapse(!0),b.moveEnd("character",f),b.moveStart("character",e),a.focus(),b.select());if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)window.focus(),document.body.focus(),a.focus();if(DEXTTOP.DEXT5.browser.ie&&9<=DEXTTOP.DEXT5.browser.ieVersion&&
e!=f||!DEXTTOP.DEXT5.browser.ie&&!DEXTTOP.DEXT5.browser.gecko){var b=a.value.substr(0,e),b=b.replace(/&/gi,"&amp;"),b=b.replace(/</gi,"&lt;"),b=b.replace(/>/gi,"&gt;"),b=b.replace(/\t/gi,"<tempTab>"),b=b.replace(/<tempTab>/gi,"\t"),c=document.createElement("div"),d="";"2"==DEXTTOP.G_CURREDITOR._config.sourceViewtype&&(d='style="word-wrap: break-word; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-break: normal;"');c.innerHTML="<pre "+d+"></pre>";
c=c.firstChild;c.style.width=DEXTTOP.G_CURREDITOR._config.style.width;c.style.height="auto";c.style.fontSize=a.style.fontSize;c.style.fontFamily=a.style.fontFamily;document.body.appendChild(c);c.innerHTML="&lt;test&gt;";var g=getClientRect(c),d=g.bottom-g.top;c.innerHTML=b;g=getClientRect(c);b=g.bottom-g.top;b-=d;0>b&&(b=0);document.body.removeChild(c);c=null;a.scrollTop=b}},0))}}catch(m){a.value=removeDextMarkInString(a.value)}}
function removeDextMarkInFrame(a){a=a?a:_iframeDoc;for(var b=a.getElementsByTagName("dextmark"),c=b.length,c=c-1;0<=c;c--)b[c].parentNode.removeChild(b[c]);b=a.getElementsByTagName("/dextmark");c=b.length;for(--c;0<=c;c--)b[c].parentNode.removeChild(b[c])}function removeDextMarkInString(a){return a.replace(/<dextmark ([^>]+)><\/dextmark>/ig,"")}
function getSelectionCoords(a){try{a=a||window;var b=a.document,c=b.selection,d,e,f,g=0,h=0;if(c)"Control"!=c.type&&(d=c.createRange(),d.collapse(!0),g=d.boundingLeft,h=d.boundingTop);else if(a.getSelection&&(c=a.getSelection(),c.rangeCount&&(d=c.getRangeAt(0).cloneRange(),d.getClientRects&&(d.collapse(!0),e=d.getClientRects(),0<e.length&&(f=e[0]),f?(g=f.left,h=f.top):h=g=0),0==g&&0==h))){var m=b.createElement("span");if(m.getClientRects){m.appendChild(b.createTextNode("\u200b"));d.insertNode(m);
f=m.getClientRects()[0];var g=f.left,h=f.top,q=m.parentNode;q.removeChild(m);q.normalize()}}return{x:g,y:h}}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setRemoveClass(a,b){if(checkIfIncluded("editor_layout.css")){for(var c=DEXTTOP.G_CURREDITOR.remove_item.length,d=0;d<c;d++)if("layout"==DEXTTOP.G_CURREDITOR.remove_item[d])return;for(var c=b.length,e=!1,f=_iframeDoc.body.innerHTML,d=0;d<c;d++)if(-1<f.indexOf(b[d])){e=!0;break}if(e)for(e=a.length,d=0;d<e;d++)for(var f=_iframeDoc.getElementsByTagName(a[d]),g=f.length,h=0;h<g;h++)for(var m=0;m<c;m++){var q=new RegExp("(\\s|^)"+b[m]+"(\\s|$)");q.test(f[h].className)&&(f[h].className=DEXTTOP.DEXT5.util.trim(f[h].className.replace(q,
" ")));""==DEXTTOP.DEXT5.util.trim(f[h].className)&&f[h].removeAttribute("class")}}}
function setAddClass(a,b){if(checkIfIncluded("editor_layout.css")){for(var c=DEXTTOP.G_CURREDITOR.remove_item.length,d=0;d<c;d++)if("layout"==DEXTTOP.G_CURREDITOR.remove_item[d])return;c=a.length;for(d=0;d<c;d++)for(var e=_iframeDoc.getElementsByTagName(a[d]),f=e.length,g=0;g<f;g++)for(var h=b.length,m=0;m<h;m++)(new RegExp("(\\s|^)"+b[m]+"(\\s|$)")).test(e[g].className)||(e[g].className+=" "+b[m],e[g].className=DEXTTOP.DEXT5.util.trim(e[g].className))}}
function checkIfIncluded(a,b){var c;c=void 0==b?_iframeDoc.getElementsByTagName("link"):b.getElementsByTagName("link");for(var d=0;d<c.length;d++)if(-1<c[d].href.indexOf(a))return!0;return!1}
function getDirectionNode(a,b,c,d){a=[];c=GetTDTHCell(c);b=GetTableSelectionCells();if(null==c&&0==b.length){b=",body,";var e=d.length;for(c=0;c<e;c++)null!=d[c]&&null!=d[c].parentNode&&void 0!=d[c].parentNode.tagName&&-1<b.indexOf(","+d[c].parentNode.tagName.toLowerCase()+",")&&-1<",a,abbr,acronym,address,applet,area,b,baseFont,bdo,big,blink,blockQuote,body,button,caption,center,cite,code,col,colGroup,dd,del,dfn,dir,div,dl,dt,em,embed,fieldSet,font,form,H1,H2,H3,H4,H5,H6,head,hr,html,i,iframe,img,input:button,input:checkbox,input:file,input:image,input:password,input:radio,input:range,input:reset,input:search,input:submit,input:text,ins,isIndex,kbd,keygen,label,legend,li,link,listing,map,marquee,menu,meta,nobr,noFrames,noScript,object,ol,optGroup,option,p,plainText,pre,q,rt,ruby,s,samp,select,small,span,strike,strong,style,sub,sup,table,tBody,td,textArea,tFoot,th,tHead,title,tr,tt,u,ul,var,xmp,".indexOf(","+d[c].tagName.toLowerCase()+
",")&&a.push(d[c])}else if(null!=c&&0==b.length)for(b=",th,td,",e=d.length,c=0;c<e;c++)null!=d[c]&&null!=d[c].parentNode&&void 0!=d[c].parentNode.tagName&&-1<b.indexOf(","+d[c].parentNode.tagName.toLowerCase()+",")&&(null==d[c].firstChild?a.push(d[c].parentNode):-1<",a,abbr,acronym,address,applet,area,b,baseFont,bdo,big,blink,blockQuote,body,button,caption,center,cite,code,col,colGroup,dd,del,dfn,dir,div,dl,dt,em,embed,fieldSet,font,form,H1,H2,H3,H4,H5,H6,head,hr,html,i,iframe,img,input:button,input:checkbox,input:file,input:image,input:password,input:radio,input:range,input:reset,input:search,input:submit,input:text,ins,isIndex,kbd,keygen,label,legend,li,link,listing,map,marquee,menu,meta,nobr,noFrames,noScript,object,ol,optGroup,option,p,plainText,pre,q,rt,ruby,s,samp,select,small,span,strike,strong,style,sub,sup,table,tBody,td,textArea,tFoot,th,tHead,title,tr,tt,u,ul,var,xmp,".indexOf(","+
d[c].tagName.toLowerCase()+",")?a.push(d[c]):void 0==d[c].firstChild.tagName?a.push(d[c].parentNode):a.push(d[c]));else if(null!=c&&0<b.length)for(c=0;c<b.length;c++){d=b[c].getElementsByTagName("*");for(idx2=0;idx2<d.length;idx2++)d[idx2].dir="";a.push(b[c])}return a}
function CheckCommand(a,b){if("bold"==a){var c=b.getElementsByTagName("b"),d=b.getElementsByTagName("strong");return 0<c.length+d.length?!0:!1}return"italic"==a?(c=b.getElementsByTagName("em"),d=b.getElementsByTagName("i"),0<c.length+d.length?!0:!1):"underline"==a?0<b.getElementsByTagName("u").length?!0:!1:"strike_through"==a?0<b.getElementsByTagName("strike").length?!0:!1:"superscript"==a?0<b.getElementsByTagName("sup").length?!0:!1:"subscript"==a?0<b.getElementsByTagName("sub").length?!0:!1:"list_number"==
a?0<b.getElementsByTagName("ol").length?!0:!1:"list_bullets"==a?0<b.getElementsByTagName("ul").length?!0:!1:!1}
function officePasteCleanForTable(a){var b;b=applyFakeImgSrc(a);a=document.createElement("div");a.innerHTML=b;if("1"==DEXTTOP.G_CURREDITOR._config.removeImageInPasteExcel&&(G_dext5plugIn&&2==G_dext5plugIn.getHTMLFormatFromType||"XLS"==G_wordProcessorType)){b=a.getElementsByTagName("table");var c=b.length,d=b[0];if(0<c){for(var e=a.getElementsByTagName("img"),f=e.length-1;0<=f;f--)e[f].parentNode.removeChild(e[f]);for(f=c-1;0<=f;f--)b[f]!=d&&b[f].parentNode.removeChild(b[f])}}b=a.getElementsByTagName("table");
c=b.length;for(f=0;f<c;f++){"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&adjustTableForIEJASOBug(b[f]);adjustTableBeforePaste(DEXTTOP.G_CURREDITOR,{tables:[b[f]]});"left"!=b[f].align&&"1"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign||"2"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO||(b[f].align="",b[f].removeAttribute("align"));"fixed"==b[f].style.tableLayout&&"0px"!=b[f].style.width&&(b[f].style.removeAttribute?b[f].style.removeAttribute("table-layout"):(b[f].style.removeProperty("tableLayout"),
b[f].style.removeProperty("table-layout")));d=getPasteFormatType();e="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode;if((DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&!e||DEXTTOP.DEXT5.browser.gecko)&&"1"==DEXTTOP.G_CURREDITOR._config.removeColgroup&&"PPT"!=d&&(d=b[f].getElementsByTagName("colgroup"),e=d.length,0<e)){d=!1;try{for(var g=b[f].getElementsByTagName("td"),h=g.length,e=0;e<h;e++)if(g[e].getAttribute("width")&&""!=g[e].getAttribute("width")||""!=g[e].style.width){d=!0;
break}}catch(m){d=!0}if(d)for(d=b[f].getElementsByTagName("colgroup"),e=d.length,--e;0<=e;e--)try{b[f].removeChild(d[e])}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}for(var t=b[f].rows.length,e=0;e<t;e++){var u=b[f].rows[e],v=u.getAttribute("height"),w=u.style.height;removeAttributeForPasteTable(u);var y=u.cells.length;if(0==y)u.innerHTML="";else for(d=0;d<y;d++){var x=u.cells[d],z=x.getAttribute("rowspan"),z=null==z||void 0==z||""==z?1:parseIntOr0(z),B=x.getAttribute("height");
null==v||void 0==v||"0"==v||null!=B&&void 0!=B&&""!=B||("PPT"==getPasteFormatType()&&1<z?x.setAttribute("height",parseIntOr0(v)/z):x.setAttribute("height",parseIntOr0(v)*z));B=x.style.height;null==w||void 0==w||"0px"==w||null!=B&&void 0!=B&&""!=B||("PPT"==getPasteFormatType()&&1<z?x.style.height=parseIntOr0(w)/z+"px":x.style.height=parseIntOr0(w)*z+"px");1==x.childNodes.length?""!=x.childNodes[0].innerHTML&&"&nbsp;"!=x.childNodes[0].innerHTML||0!=x.innerHTML.indexOf("<p")||(x.innerHTML=getCellDefValue()):
0!=x.childNodes.length||""!=x.innerHTML&&"&nbsp;"!=x.innerHTML||(x.innerHTML=getCellDefValue());z=!1;if(G_dext5plugIn){if(1==G_dext5plugIn.getHTMLFormatFromType||4==G_dext5plugIn.getHTMLFormatFromType||3==G_dext5plugIn.getHTMLFormatFromType)z=!0}else if("DOC"==G_wordProcessorType||"HWP"==G_wordProcessorType||"PPT"==G_wordProcessorType)z=!0;if(z){var z=0,B=x.style.paddingLeft,D=x.style.paddingRight,A=x.style.width;try{if(-1<B.indexOf("px")||-1<B.indexOf("pt")||-1<B.indexOf("cm"))z++,B=DEXTTOP.DEXT5.util.replacePtOrCmToPx(B),
D=DEXTTOP.DEXT5.util.replacePtOrCmToPx(D);if(-1<A.indexOf("px")||-1<A.indexOf("pt")||-1<A.indexOf("cm"))z++,A=DEXTTOP.DEXT5.util.replacePtOrCmToPx(A);2==z&&(A=parseFloat(A)-parseFloat(B)-parseFloat(D),x.getAttribute("width")&&x.setAttribute("width",A),x.style.width=A+"px")}catch(C){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}}if(DEXTTOP.DEXT5.browser.gecko)for(""==b[f].style.borderCollapse&&(b[f].style.borderCollapse="collapse"),t=b[f].rows.length,e=0;e<t;e++)for(u=b[f].rows[e],removeAttribute(u,
"width"),removeAttribute(u,"height"),removeAttribute(u,"style"),v=u.cells.length,d=0;d<v;d++)x=u.cells[d],""==x.style.borderTop&&(x.style.borderTop="1px solid #000000"),""==x.style.borderRight&&(x.style.borderRight="1px solid #000000"),""==x.style.borderBottom&&(x.style.borderBottom="1px solid #000000"),""==x.style.borderLeft&&(x.style.borderLeft="1px solid #000000"),"\u3000"==x.innerHTML&&(x.innerHTML="<p><br /></p>"),0==parseIntOr0(x.style.height)&&0==parseIntOr0(x.height)&&(x.style.height="20px");
if("0"!=DEXTTOP.G_CURREDITOR._config.showLineForBorderNone)for(e=b[f].rows.length,d=0;d<e;d++)for(t=b[f].rows[d].cells.length,u=0;u<t;u++)showBorderForNoneClass(b[f].rows[d].cells[u],"dext_table_border_t"),showBorderForNoneClass(b[f].rows[d].cells[u],"dext_table_border_l"),showBorderForNoneClass(b[f].rows[d].cells[u],"dext_table_border_r"),showBorderForNoneClass(b[f].rows[d].cells[u],"dext_table_border_b")}b=a.innerHTML;return b=applyFakeImgSrc(b,!0)}
function checkExistCustomData(a){var b="",b=_iframeDoc.createElement("div");b.innerHTML=a;a=b.getElementsByTagName("img");for(var c=!1,d=a.length-1;0<=d;d--){var e=a[d].getAttribute("dext5customdata");null!=e&&void 0!=e&&(e=getDextCustomData(e),null==e||void 0==e)&&(c=a[d].parentNode,c.removeChild(a[d]),""==c.innerHTML&&(c.innerHTML="&nbsp;"),c=!0)}c&&alert(dext5_lang.msg.checkCustomData);""==b.innerHTML&&(b.innerHTML="&nbsp");return b=b.innerHTML}
function getEditorFrameDoc(a){setDEXTWINDOC();a=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+a.ID);return getIframeDocument(a)}
function getMyFirstOrLastChildElementNode(a,b){try{var c=!1;1==b&&(c=!0);if(3==a.nodeType)return a.parentNode;var d="nextSibling",e="firstChild";c&&(d="previousSibling",e="lastChild");for(var f=a;null!=f.childNodes&&0<f.childNodes.length;){for(f=f[e];f&&f.tagName&&-1<f.tagName.indexOf("DEXT_DIAGONAL");)f=f.previousSibling;if(3==f.nodeType||8==f.nodeType){if(!(3!=f.nodeType||""==f.data&&"BODY"==f.parentNode.tagName||""==textCheckInString(f.data)&&""!=f.data.replace(/ /,"")&&""!=f.data.replace(/\u00A0/,
"")))return f.parentNode;f=f[d]}else if("P"==f.tagName){var g=getClientRect(f);if(0==g.bottom-g.top)f=f[d];else{for(d=f;d[e];){if(d.tagName&&-1<",SPAN,A,U,B,I,STRONG,STRIKE,SUB,SUP,".indexOf(","+d.tagName+",")&&d[e]&&(3==d[e].nodeType||1==d[e].nodeType&&"BR"==d[e].tagName)){f=d;break}d=d[e];c&&d&&"BR"==d.tagName&&d.previousSibling&&(d=d.previousSibling)}return f}}else{if("BR"==f.tagName||"IMG"==f.tagName)return f.parentNode;if("TABLE"==f.tagName){var h=null;if(c)var m=f.getElementsByTagName("td"),
h=m[m.length-1];else h=f.getElementsByTagName("th")[0]?f.getElementsByTagName("th")[0]:f.getElementsByTagName("td")[0];return getMyFirstOrLastChildElementNode(h,c)}if("OL"==f.tagName||"UL"==f.tagName)return h=null,m=f.getElementsByTagName("li"),h=c?m[m.length-1]:m[0],getMyFirstOrLastChildElementNode(h,c);if("STYLE"==f.tagName){h=null;for(h=f[d];null!=h;)if(1==h.nodeType){f=h;break}else h=h[d];if(null==h||3==h.nodeType)return _iframeDoc.body}}}return 1==f.nodeType&&f.parentNode&&"BODY"!=f.parentNode.tagName?
f:null}catch(q){return null}}
function setFocusChildForStyle(a,b,c){var d=!1;1==b&&(d=!0);var e=getMyFirstOrLastChildElementNode(a,d);if(e){b=0;1==d&&(b=1);var f=function(a,b){var d=!0;try{var e=GetParentbyTagName(a,"body");e?e!=_iframeDoc.body&&(d=!1):d=!1}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(!1!==d){d=!0;if(1==b){a.lastChild&&"BR"==a.lastChild.tagName&&(a=a.lastChild,d=!1);try{c||_iframeWin.scrollTo(0,_iframeDoc.body.scrollHeight)}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}if(d){doSetCaretPosition(a,
b);try{"design"!=DEXTTOP.G_CURREDITOR.getEditorMode()||c||setMenuIconRealable(a)}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else{e=getFirstRange();d=e.range;e=e.sel;d.setStartBefore(a);d.setEndBefore(a);e.removeAllRanges();e.addRange(d);try{c||setMenuIconRealable(d.startContainer)}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}};if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use&&"BODY"==a.tagName){for(var d=
a.childNodes,g=d.length,h=!0,m=function(a,b){for(;b&&b.tagName&&"BODY"!=b.tagName;){if(b.parentNode==a)return!0;b=b.parentNode}return!1},q=0;q<g;q++){var t=1==b?g-1-q:q;if(1==d[t].nodeType&&-1<",p,h1,h2,h3,h4,h5,h6,pre,b,big,i,small,strong,span,sub,sup,u,s,strike,".indexOf(","+d[t].tagName.toLowerCase()+",")){g=d[t];g!=e&&m(d[t],e)&&(g=e);f(g,b);setMenuIconRealable(g);h=!1;break}}if(h){d=a.lastChild;if(3==d.nodeType||"table"==d.tagName.toLowerCase())d=_iframeDoc.createElement("p"),DEXTTOP.DEXT5.browser.ie&&
11>DEXTTOP.DEXT5.browser.ieVersion?d.innerHTML="&nbsp;":(m=_iframeDoc.createElement("br"),d.appendChild(m)),a.appendChild(d);f(d,b);setMenuIconRealable(d)}}else"TEXTAREA"!=e.tagName&&("BODY"==a.tagName?setTimeout(function(){f(e,b)},2):f(e,b),c||setMenuIconRealable(e))}}
function repairPasteTextInCell(a){if(0==DEXTTOP.DEXT5.browser.ie||DEXTTOP.G_CURREDITOR.AccessClipboardForIEGecko||6!=G_dext5plugIn.getHTMLFormatFromType)return a;var b=a,c=a.substring(0,6);if("<TABLE"==c||"<table"==c){if(getFirstRange(),c=document.createElement("div"),c.innerHTML=a,1==c.childNodes.length&&1==c.childNodes[0].nodeType&&"TABLE"==c.childNodes[0].tagName){a=c.getElementsByTagName("td");if(1==a.length){var b=a[0].innerHTML,d=a[0].childNodes,e=a[0].getElementsByTagName("p");1==e.length&&
d[0]&&1==d[0].nodeType&&"P"==d[0].tagName&&(b=d[0].innerHTML)}0==a.length&&(a=c.getElementsByTagName("th"),1==a.length&&(b=a[0].innerHTML,d=a[0].childNodes,e=a[0].getElementsByTagName("p"),1==e.length&&d[0]&&1==d[0].nodeType&&"P"==d[0].tagName&&(b=d[0].innerHTML)))}}else c=a.toLowerCase(),-1<c.indexOf("starthtml")&&-1<c.indexOf("startfragment")&&-1<c.indexOf("<body ")&&-1<c.indexOf("</body")&&(c="<BODY",-1==a.indexOf(c)&&(c="<body"),b="</BODY>",-1==a.indexOf(b)&&(b="</body>"),a=a.substring(a.indexOf(c)),
a=a.substring(a.indexOf(">")+1),b=a=a.substring(0,a.indexOf(b)));return b}function findParentNode(a,b){var c=b.parentNode;if("HTML"==c.tagName||"BODY"==c.tagName)return!1;for(;"BODY"!=c.tagName;){if(c==a)return!0;c=c.parentNode}return!1}
function executeTextAlign(a,b){var c=null,c=DEXTTOP.DEXT5.browser.ie?getElementsFromSelection():getNodesInRange(a),d=GetTDTHCell(a.startContainer);if(null!=d)for(var e=c,f=e.length,c=[],g=0;g<f;g++)1==findParentNode(d,e[g])&&c.push(e[g]);d=c.length;e=chkAlign="";e=null;for(g=0;g<d;g++)if(e=c[g].nodeName.toLowerCase(),"p"==e||"div"==e)chkAlign="justifyFull"==b?"justify":b.substring(7).toLowerCase(),e=c[g],e.style.textAlign!=chkAlign&&(e.style.textAlign=chkAlign)}
function removeNbspInPTag(a){try{if(DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion){var b=a._BODY.childNodes,c=b.length;for(a=0;a<c;a++){var d=b[a];1==d.nodeType&&-1<",p,h1,h2,h3,h4,h5,".indexOf(","+d.tagName.toLowerCase()+",")&&"&nbsp;"==d.innerHTML&&(d.innerHTML="")}}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function _iframeDoc_OnDropOver(a){DEXTTOP.DEXT5.util.cancelEvent(a)}
function _iframeDoc_DragStart(a){"1"==DEXTTOP.G_CURREDITOR._config.clickCtrlHyperlink&&DEXTTOP.G_CURREDITOR.isAOver.linkStyle&&DEXTTOP.DEXT5.util.cancelEvent(a);try{if("1"==DEXTTOP.G_CURREDITOR._config.returnEvent.drag_event&&(DEXTTOP.DEXT5.config.DragEventCancel=!1,"function"===typeof DEXTTOP.G_CURREDITOR._config.event.drag?DEXTTOP.G_CURREDITOR._config.event.drag("dragstart",a):"function"===typeof DEXTTOP.DEXTWIN.dext_drag_event&&DEXTTOP.DEXTWIN.dext_drag_event("dragstart",a),1==DEXTTOP.DEXT5.config.DragEventCancel)){DEXTTOP.DEXT5.util.cancelEvent(a);
return}}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}0!=dragMoveStart(a)&&(DEXTTOP.G_CURREDITOR.isDragStartedInEditor=!0)}
function getElementsFromSelection(a){function b(a){var b=null;a.parentElement?b=a.parentElement():a.commonAncestorContainer?b=a.commonAncestorContainer:a.commonParentElement&&(b=a.commonParentElement());return b}function c(a,b){var c=null;a.compareEndPoints?c={method:"compareEndPoints",StartToStart:"StartToStart",StartToEnd:"StartToEnd",EndToEnd:"EndToEnd",EndToStart:"EndToStart"}:a.compareBoundaryPoints&&(c={method:"compareBoundaryPoints",StartToStart:0,StartToEnd:1,EndToEnd:2,EndToStart:3});return c&&
!(1==b[c.method](c.StartToStart,a)&&1==b[c.method](c.EndToEnd,a)&&1==b[c.method](c.StartToEnd,a)&&1==b[c.method](c.EndToStart,a)||-1==b[c.method](c.StartToStart,a)&&-1==b[c.method](c.EndToEnd,a)&&-1==b[c.method](c.StartToEnd,a)&&-1==b[c.method](c.EndToStart,a))}function d(a){var b=null;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion?_iframeDoc.body.createTextRange?(b=_iframeDoc.body.createTextRange(),b.moveToElementText(a)):_iframeDoc.createRange&&(b=_iframeDoc.createRange(),b.selectNodeContents(a)):
_iframeDoc.createRange?(b=_iframeDoc.createRange(),b.selectNodeContents(a)):_iframeDoc.body.createTextRange&&(b=_iframeDoc.body.createTextRange(),b.moveToElementText(a));return b}var e=null,f=[],g,h;a||(a="body");if(h=function(){var a=null;_iframeWin.getSelection?(a=_iframeWin.getSelection())&&a.rangeCount&&a.getRangeAt&&(a=a.getRangeAt(0)):_iframeDoc.selection&&(a=_iframeDoc.selection.createRange());return a}())if(g=b(h)){for(;1!=g.nodeType;)g=g.parentNode;if(g.nodeName.toLowerCase()!=a.toString()){e=
g;do e=e.parentNode,f[f.length]=e;while(e.nodeName.toLowerCase()!=a.toString())}e=g.all||g.getElementsByTagName("*");for(a=0;a<e.length;a++)f[f.length]=e[a];e=[g];for(g=0;g<f.length;g++)(a=d(f[g]))&&c(h,a)&&(e[e.length]=f[g])}return e}
function checkCopyInCellFormInertnNet(a){var b="";if(DEXTTOP.DEXT5.browser.ie&&/body[^>]*>(\s+)*<div *([^>])*>/i.test(a)){var c=a.indexOf("\x3c!--StartFragment--\x3e"),d=a.lastIndexOf("\x3c!--EndFragment--\x3e");-1<c&&-1<d&&(a=a.substr(c+20),d=a.lastIndexOf("\x3c!--EndFragment--\x3e"),-1<d&&(b=a=a.substring(0,d)))}return b}function setGlobalTableDefaultValue(){try{ActiveLastTable=ActiveCurrTable=DrageEndCell=DrageStartCell=null}catch(a){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function fn_IEJASOBug(a){if("0"!=a._config.ie11_BugFixed_JASO)try{var b=a._DOC;if("1"==a._config.ie11_BugFixed_JASO){for(var c=b.getElementsByTagName("table"),d=c.length,e=0;e<d;e++)adjustTableForIEJASOBug(c[e]);c=b.getElementsByTagName("p");d=c.length;for(e=0;e<d;e++)endBrForIEJASOBug(c[e])}else if("2"==a._config.ie11_BugFixed_JASO)for(c=b.getElementsByTagName("table"),d=c.length,e=0;e<d;e++)if("left"==c[e].align||"1"==a._config.ie11_BugFixed_DeleteTableAlign){if("1"==a._config.ie11_BugFixed_ReplaceAlignMargin&&
("center"==c[e].align||"right"==c[e].align)){var f=getReplaceAlignMargin(a,c[e]);0!=f&&(c[e].style.marginLeft=f+"px")}c[e].align="";c[e].removeAttribute("align")}}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function replaceBrTag(a){if("1"==a._config.wrapPtagToSource||"2"==a._config.wrapPtagToSource)try{var b=a._DOC,c=a._BODY,d=c.childNodes;for(i=d.length-1;0<=i;i--){var e=d[i];if(1==e.nodeType&&"BR"==e.tagName&&(null==e.previousSibling||e.previousSibling&&3!=e.previousSibling.nodeType)){var f=b.createElement("p");c.insertBefore(f,e);DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?(f.innerHTML="&nbsp;",c.removeChild(e)):f.appendChild(e)}}}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&
RAONWIZDLW()}}function showImageEditor(){if(G_dext5plugIn){setFocusTopWindow();var a=G_dext5plugIn.setScreenCapture(1);""!=a?(dialogCancel(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),insertNodeLikePasteHtml(a),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0):dialogCancel()}}function checkCanPasteToIamge(){var a=!1;try{G_dext5plugIn&&1==G_dext5plugIn.canPasteImageFromClipBoard()&&(a=!0)}catch(b){a=!1}return a}
function removeEmptySpanBRTag(a){if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&a.childNodes)for(var b=a.childNodes.length,c=0;c<b;c++){var d=a.childNodes[c];if(1===d.nodeType&&"p"==d.tagName.toLowerCase()){var e=d.innerHTML;if(""==(d.innerText||d.textContent))for(;;){var f=RegExp("<span[^>]*>(?:\\s|<br>|<br />|  | |)(</span>)","gim"),e=e.replace(f,"$1"+unescape("%u200B")+"</span>");if(0==f.test(e))break}""==e&&"1"==DEXTTOP.G_CURREDITOR._config.removeEmptyTagReplaceDefaultParagraphValue&&
(e=DEXTTOP.DEXT5.browser.ie&&10>=DEXTTOP.DEXT5.browser.ieVersion?"&nbsp;":"<br />",d.innerHTML=e)}}}
function wrapPtagForNotBlockTag(a){if("1"==a._config.wrapPtagToSource||"2"==a._config.wrapPtagToSource)try{for(var b=a._BODY.innerHTML,c=a._BODY.childNodes,d=[],e=c.length-1;0<=e;e--){if(c[e].tagName&&checkBlockTag(c[e].tagName)){if(0<d.length){for(var f=_iframeDoc.createElement("p"),g=d.length-1;0<=g;g--)if(f.appendChild(d[g]),c[e].nextSibling?_iframeDoc.body.insertBefore(f,c[e].nextSibling):_iframeDoc.body.appendChild(f),3==d[g].nodeType){var h=getClientRect(f);0==h.bottom-h.top&&f.parentNode.removeChild(f)}d=
[]}}else if(3==c[e].nodeType){var m=c[e].data;"0"==a._config.keepOriginalHtml&&(m=m.replace(/\r\n/,"\n"),m=m.replace(/^\n/,""),m=m.replace(/\n$/,""),c[e].data=m);""!=m&&d.push(c[e])}else if(8!=c[e].nodeType){var q=",li,details,";""!=a._config.wrapPtagSkipTag&&(q+=a._config.wrapPtagSkipTag+",");var t=c[e].tagName?c[e].tagName:"",t=t.toLowerCase();0>q.indexOf(","+t+",")&&d.push(c[e])}if(0==e&&0<d.length){f=_iframeDoc.createElement("p");for(g=d.length-1;0<=g;g--)f.appendChild(d[g]),_iframeDoc.body.insertBefore(f,
_iframeDoc.body.firstChild),3==d[g].nodeType&&(h=getClientRect(f),0==h.bottom-h.top&&f.parentNode.removeChild(f));d=[]}if(c[e].tagName&&"P"==c[e].tagName){try{"<p>"==c[e].outerHTML.toLowerCase()&&(c[e].outerHTML="<p></p>")}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var v=void 0!=c[e].innerText?c[e].innerText:c[e].textContent,v=v.replace(/\r\n/gi,""),v=v.replace(/\r/gi,""),v=v.replace(/\n/gi,""),q=!1;try{-1<c[e].innerHTML.toLowerCase().indexOf("<dextmark")&&(q=!0)}catch(w){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(""==v&&!q&&"1"==a._config.removeEmptyTag){for(var y=c[e].innerHTML,q="(<span[^>]*?raon_placeholder.*?>)(?:\\s|<br>|<br />|  | |)</span>",x=new RegExp(q,"gim"),y=y.replace(x,"$1"+unescape("%u200B")+"</span>");q="<span[^>]*>(?:\\s|<br>|<br />|  | |)</span>","0"==a._config.removeEmptyTagReplaceDefaultParagraphValue&&(q="<span[^>]*>(?:\\s|  | |)</span>"),x=new RegExp(q,"gim"),y=y.replace(x,""),0!=x.test(y););q="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+
"?)</span>";x=new RegExp(q,"gim");for(y=y.replace(x,"$1</span>");q="<font[^>]*>(?:\\s|<br>|<br />|  | |)</font>",x=new RegExp(q,"gim"),y=y.replace(x,""),0!=x.test(y););y=CleanZeroChar(y);""==y&&"1"==a._config.removeEmptyTagReplaceDefaultParagraphValue&&(y=getDefaultParagraphValue(!1));c[e].innerHTML=y}}}}catch(z){a._BODY.innerHTML=b}}
function checkBlockTag(a){if(void 0!=a&&""!=a){var b=!1,c="p div table ol ul hr h1 h2 h3 h4 h5 h6 dl blockquote iframe pre xmp c:if c:choose c:foreach c:set script style center dextmark /dextmark figure figcaption nav section article".split(" "),d=c.length;a=a.toLowerCase();for(var e=0;e<d;e++)if(c[e]==a){b=!0;break}return b}}function checkExistClassName(a,b){for(var c=a.split(" "),d=c.length,e=!1,f=0;f<d;f++)if(c[f]==b){e=!0;break}return e}
function setClassName(a,b){for(var c=b,d=a.className,e=!1,f=d.split(" "),g=f.length,h=0;h<g;h++)if(f[h]==b){e=!0;break}0==e&&(""!=d&&(c=" "+c),a.className=d+c)}function removeClassName(a,b){var c=b,d=a.className;0<d.indexOf(c)&&(c=" "+c);d=d.replace(c,"");""==d?a.getAttribute("class")?a.removeAttribute("class"):a.removeAttribute("className"):a.className=d}
function showBorderForNoneClass(a,b){if("0"!=DEXTTOP.G_CURREDITOR._config.showLineForBorderNone){if(""!=DEXTTOP.DEXT5.util.trim(DEXTTOP.G_CURREDITOR._config.showLineForBorderNoneSkipClass))for(var c=DEXTTOP.G_CURREDITOR._config.showLineForBorderNoneSkipClass.split(","),d=c.length,e=0;e<d;e++)if(checkExistClassName(a.className,c[e]))return;if(""!=DEXTTOP.DEXT5.util.trim(DEXTTOP.G_CURREDITOR._config.showLineForBorderNoneSkipAttribute))for(c=DEXTTOP.G_CURREDITOR._config.showLineForBorderNoneSkipAttribute.split(","),
e=0;e<d;e++)if(a.getAttribute(c[e])&&""!=a.getAttribute(c[e]))return;e="";switch(b){case "dext_table_border_b":e="Bottom";break;case "dext_table_border_t":e="Top";break;case "dext_table_border_l":e="Left";break;case "dext_table_border_r":e="Right"}d=checkExistClassName(a.className,b);""==a.style["border"+e+"Width"]&&""==a.style["border"+e+"Style"]?(e=a.parentNode.parentNode.parentNode,!d&&(""==e.border||0>=parseInt(e.border))&&setClassName(a,b)):-1<a.style["border"+e+"Width"].indexOf("0")&&0==parseFloat(a.style["border"+
e+"Width"])||"none"==a.style["border"+e+"Style"]?d||setClassName(a,b):d&&removeClassName(a,b)}}
function setBorderTableAndAllCell(a,b){for(var c=a.rows.length,d=0;d<c;d++)for(var e=a.rows[d],f=e.cells.length,g=0;g<f;g++){var h=e.cells[g];0==g&&(""!=b.outsideLeft&&(h.style.borderLeft=b.outsideLeft,showBorderForNoneClass(h,"dext_table_border_l")),g!=f-1&&""!=b.insideCol&&(h.style.borderRight=b.insideCol,showBorderForNoneClass(h,"dext_table_border_r")),""!=b.insideRow&&(0==d&&d!=c-1&&(h.style.borderBottom=b.insideRow,showBorderForNoneClass(h,"dext_table_border_b")),0<d&&d==c-1&&(h.style.borderTop=
b.insideRow,showBorderForNoneClass(h,"dext_table_border_t")),0<d&&d!=c-1&&(h.style.borderTop=b.insideRow,showBorderForNoneClass(h,"dext_table_border_t"),h.style.borderBottom=b.insideRow,showBorderForNoneClass(h,"dext_table_border_b"))));g==f-1&&(""!=b.outsideRight&&(h.style.borderRight=b.outsideRight,showBorderForNoneClass(h,"dext_table_border_r")),0!=g&&""!=b.insideCol&&(h.style.borderLeft=b.insideCol,showBorderForNoneClass(h,"dext_table_border_l")),""!=b.insideRow&&(0==d&&d!=c-1&&(h.style.borderBottom=
b.insideRow,showBorderForNoneClass(h,"dext_table_border_b")),0<d&&d==c-1&&(h.style.borderTop=b.insideRow,showBorderForNoneClass(h,"dext_table_border_t")),0<d&&d!=c-1&&(h.style.borderTop=b.insideRow,showBorderForNoneClass(h,"dext_table_border_t"),h.style.borderBottom=b.insideRow,showBorderForNoneClass(h,"dext_table_border_b"))));0<g&&g!=f-1&&""!=b.insideCol&&(h.style.borderLeft=b.insideCol,showBorderForNoneClass(h,"dext_table_border_l"),h.style.borderRight=b.insideCol,showBorderForNoneClass(h,"dext_table_border_r"));
0==d&&(""!=b.outsideTop&&(h.style.borderTop=b.outsideTop,showBorderForNoneClass(h,"dext_table_border_t")),d!=c-1&&""!=b.insideRow&&(h.style.borderBottom=b.insideRow,showBorderForNoneClass(h,"dext_table_border_b")));d==c-1&&(""!=b.outsideBottom&&(h.style.borderBottom=b.outsideBottom,showBorderForNoneClass(h,"dext_table_border_b")),0!=d&&""!=b.insideRow&&(h.style.borderTop=b.insideRow,showBorderForNoneClass(h,"dext_table_border_t")));0<d&&d!=c-1&&0<g&&g!=f-1&&(""!=b.insideRow&&(h.style.borderTop=b.insideRow,
showBorderForNoneClass(h,"dext_table_border_t"),h.style.borderBottom=b.insideRow,showBorderForNoneClass(h,"dext_table_border_b")),""!=b.insideCol&&(h.style.borderLeft=b.insideCol,showBorderForNoneClass(h,"dext_table_border_l"),h.style.borderRight=b.insideCol,showBorderForNoneClass(h,"dext_table_border_r")))}}
function replaceClassForBorder(a,b,c){var d=["dext_table_border_t","dext_table_border_r","dext_table_border_b","dext_table_border_l"];if("0"!=a._config.showLineForBorderNone&&"show"==c){var e=b.getElementsByTagName("table"),f=e.length;for(a=0;a<f;a++)for(var g=e[a].rows.length,h=0;h<g;h++)for(var m=e[a].rows[h].cells.length,q=0;q<m;q++){var t=e[a].rows[h].cells[q].className,t=t.replace("_"+d[0],""),t=t.replace("_"+d[1],""),t=t.replace("_"+d[2],""),t=t.replace("_"+d[3],""),t=t.replace(d[0],""),t=t.replace(d[1],
""),t=t.replace(d[2],""),t=t.replace(d[3],""),t=DEXTTOP.DEXT5.util.trim(t);if(""==t){if(e[a].rows[h].cells[q].getAttribute("class")?e[a].rows[h].cells[q].removeAttribute("class"):e[a].rows[h].cells[q].removeAttribute("className"),""!=e[a].rows[h].cells[q].className||e[a].rows[h].cells[q].className!=t)e[a].rows[h].cells[q].className=""}else e[a].rows[h].cells[q].className!=t&&(e[a].rows[h].cells[q].getAttribute("class")?e[a].rows[h].cells[q].setAttribute("class",t):e[a].rows[h].cells[q].setAttribute("className",
t),e[a].rows[h].cells[q].className!=t&&(e[a].rows[h].cells[q].className=t));showBorderForNoneClass(e[a].rows[h].cells[q],d[0]);showBorderForNoneClass(e[a].rows[h].cells[q],d[1]);showBorderForNoneClass(e[a].rows[h].cells[q],d[2]);showBorderForNoneClass(e[a].rows[h].cells[q],d[3])}}if("hidden"==c)for(a=0;a<d.length;a++)for(c=[],c=getElementsByClass(d[a],b),e=c.length,f=0;f<e;f++)removeClassName(c[f],d[a]),t=c[f].className,""==DEXTTOP.DEXT5.util.trim(t)?(c[f].className="",c[f].getAttribute("class")?
c[f].removeAttribute("class"):c[f].removeAttribute("className")):c[f].className=DEXTTOP.DEXT5.util.trim(t)}
function attachFileImage(a,b){var c="url("+DEXTTOP.G_CURREDITOR._config.webPath.image+"icon/",c=-1<b.file_ext.indexOf("doc")?c+"word.png":-1<b.file_ext.indexOf("ppt")?c+"ppt.png":-1<b.file_ext.indexOf("xls")?c+"excel.png":-1<b.file_ext.indexOf("hwp")?c+"hwp.png":-1<b.file_ext.indexOf("pdf")?c+"pdf.png":-1<b.file_ext.indexOf("txt")?c+"txt.png":c+"file.png";a.style.paddingLeft="22px";a.style.paddingTop="3px";a.style.paddingBottom="3px";a.style.background=c+")";a.style.backgroundRepeat="no-repeat";a.style.backgroundPosition=
"0% 50%";a.style.lineHeight="1.4"}function replaceClassForBookmark(a,b,c){a=a._contentsClass;for(var d=a.length,e=0;e<d;e++){var f=[];"hidden"==c?f=getElementsByClass(a[e],b):"show"==c&&(f=getElementsByClass("_"+a[e],b));for(var g=f.length,h=0;h<g;h++){var m=f[h].className;"hidden"==c?m=m.replace(a[e],"_"+a[e]):"show"==c&&(m=m.replace("_"+a[e],a[e]));f[h].className=m}}}
function removeIncorrectSpaceInTag(a){var b=a;if("1"==DEXTTOP.G_CURREDITOR._config.removeSpaceInTagname)if(void 0==a||""==a)b="";else try{var c=RegExp("<(\\s+)[a-z|/]","gi"),d=b.match(c);if(d)for(var e=d.length,f=0;f<e;f++)var g=d[f],h=/\s+/.exec(g),m=h[0].replace(RegExp("\\s","gi"),""),g=g.replace(h,m),b=b.replace(d[f],g);c=RegExp("<\\/(\\s+)[a-z]","gi");if(d=b.match(c))for(e=d.length,f=0;f<e;f++)g=d[f],h=/\s+/.exec(g),m=h[0].replace(RegExp("\\s","gi"),""),g=g.replace(h,m),b=b.replace(d[f],g)}catch(q){b=
a}return b}
function removeDummyfontTagInTable(a){var b=a;try{var c=RegExp("(<font ([^>]+)>\\s+</font>(s+)?)(<colgroup>)","gi");a=a.replace(c,"$4");c=RegExp("(<font ([^>]+)>\\s+</font>(\\s+)?)(<tbody>)","gi");a=a.replace(c,"$4");c=RegExp("(<font ([^>]+)>\\s+</font>(\\s+)?)(<td)","gi");a=a.replace(c,"$4");c=RegExp("(<font ([^>]+)>\\s+</font>(\\s+)?)(</tr>)","gi");a=a.replace(c,"$4");c=RegExp("(<font ([^>]+)>\\s+</font>(\\s+)?)(</tbody>)","gi");a=a.replace(c,"$4");c=RegExp("<font ([^>]+)>\\s</font>","gi");a=a.replace(c,
"<font $1>&nbsp;</font>");c=RegExp("<font ([^>]+)>\\s+</font>","gi");b=a=a.replace(c,"<font $1></font>")}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return b}
function setChangeModeForSetApi(a,b){if(1!=b&&"design"!=a._currentMode){var c="design";ClearDraggingTableCellSelected();Mouse_Status=Mouse_IsPlain;g_findRepalceRange=ActiveCurrTable=DrageStartCell=null;a._iconSelected();for(var d=null,e=["top_design","top_source","top_preview","top_text"],f=0,g=e.length;f<g;f++)d=document.getElementById("ue_"+a.ID+e[f]),null!=d&&((0>c.indexOf("top_")?"top_"+c:c)==e[f]?d.className="on":d.className="");for(var h=e=null,d=["design","source","preview","text"],c=c.replace("top_",
""),f=0,g=d.length;f<g;f++)e=document.getElementById("ue_"+a.ID+d[f]),h=document.getElementById("dext5_"+d[f]+"_"+a.ID),null!=e&&(c==d[f]?(e.className=a._config.style.skinName,e.getElementsByTagName("A")[0].className="color_on",e.style.backgroundImage="url("+a._config.webPath.image+"skin/"+a._config.style.skinName+"/ue_btn_bg.gif)",h.style.height="100%",h.style.width="100%",h.style.display="",h.style.overflow="",a._LastRange=null,setFocusToBody()):(e.className="",e.getElementsByTagName("A")[0].className=
"",e.style.backgroundImage="",h.style.width="0px",h.style.height="0px",h.style.display="none",h.style.overflow="hidden",h.blur()),e=document.getElementById("ue_diabled_div_"+a.ID),"BackCompat"==document.compatMode&&(e.style.height=document.getElementById("ue_toolbar_"+a.ID).scrollHeight+"px"),document.getElementById("ue_toolbar_"+a.ID).style.position="relative",e.style.width="design"==c?"0px":document.getElementById("ue_toolbar_"+a.ID).scrollWidth+"px");switch(a._currentMode){case "source":switch(c){case "design":ReplaceRealObjectToImage(),
xssReplaceScript(_iframeDoc),setAddClass(["td","th"],["DEXT_dot"])}break;case "preview":switch(c){case "design":FixFlashError(),ReplaceRealObjectToImage(),setAddClass(["td","th"],["DEXT_dot"])}}a._currentMode=c;-1<c.indexOf("design")&&setFocusChildForStyle(a._BODY)}onChange({editor:a})}function insertElementsSrc(a,b){b&&0>b.indexOf("file:/")&&0>b.indexOf(DEXTTOP.DEXT5.rootPath+"images")&&a.setElementsArr.push(b)}
function insertImageSrc(a,b,c){if(1!=c)try{if(b)0>b.indexOf("file:/")&&0>b.indexOf(DEXTTOP.DEXT5.rootPath+"images")&&(a.setImageArr.push(b),a.setElementsArr.push(b));else{ReplaceImageToRealObject();a.setImageArr=[];a.setElementsArr=[];var d=a._DOC.getElementsByTagName("img"),e=d.length;for(b=0;b<e;b++)"1"==DEXTTOP.G_CURREDITOR._config.xss_use&&(d[b].alt&&(d[b].alt=DEXTTOP.DEXT5.util.replaceAll(d[b].alt,"<",""),d[b].alt=DEXTTOP.DEXT5.util.replaceAll(d[b].alt,">","")),d[b].title&&(d[b].title=DEXTTOP.DEXT5.util.replaceAll(d[b].title,
"<",""),d[b].title=DEXTTOP.DEXT5.util.replaceAll(d[b].title,">",""))),""==d[b].style.marginRight.toString()&&""==d[b].style.marginLeft.toString()&&d[b].getAttribute("hspace")&&""!=d[b].hspace.toString()&&(d[b].style.marginLeft=d[b].hspace+"px",d[b].style.marginRight=d[b].hspace+"px",d[b].removeAttribute("hspace")),""==d[b].style.marginTop.toString()&&""==d[b].style.marginBottom.toString()&&d[b].getAttribute("vspace")&&""!=d[b].vspace.toString&&(d[b].style.marginTop=d[b].vspace+"px",d[b].style.marginBottom=
d[b].vspace+"px",d[b].removeAttribute("vspace"));var f=a._DOC.body.outerHTML,d="",g=RegExp("<[^>]*url\\((.*?)\\)","gi"),h=RegExp("<img[^>]*src=(.*?)>","gi"),m=RegExp("<embed[^>]*src=(.*?)>","gi"),q=RegExp("<a[^>]*href=(.*?)>","gi");regExp5=RegExp("<video[^>]*src=(.*?)>","gi");var t=f.match(g),u=f.match(h),v=f.match(m),w=f.match(q),y=f.match(regExp5);if(t){var x=t.length;for(b=0;b<x;b++)d="",0>t[b].indexOf(DEXTTOP.DEXT5.rootPath+"images")&&t[b].match("url\\((.*?)\\)")&&(d=t[b].match("url\\((.*?)\\)")[1].replace(/"/gi,
"").replace(/'/gi,"").replace(/&quot;/gi,"")),d&&""!=d&&(a.setImageArr.push(d),a.setElementsArr.push(d))}if(u){var z=u.length;for(b=0;b<z;b++)d="",u[b].match("src=\"(.*?)\"|src='(.*?)'")&&(d=u[b].match("src=\"(.*?)\"|src='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,"")),d&&""!=d&&(a.setImageArr.push(d),a.setElementsArr.push(d))}if(v){var B=v.length;for(b=0;b<B;b++)d="",v[b].match("src=\"(.*?)\"|src='(.*?)'")&&(d=v[b].match("src=\"(.*?)\"|src='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,"")),d&&""!=
d&&a.setElementsArr.push(d)}if(w){var D=w.length;for(b=0;b<D;b++)d="",-1<w[b].toLowerCase().indexOf("dext5insertfile")&&w[b].match("href=\"(.*?)\"|href='(.*?)'")&&(d=w[b].match("href=\"(.*?)\"|href='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,"")),d&&""!=d&&a.setElementsArr.push(d)}if(y){var A=y.length;for(b=0;b<A;b++)y[b].match("src=\"(.*?)\"|src='(.*?)'")&&(d=y[b].match("src=\"(.*?)\"|src='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,"")),d&&""!=d&&a.setElementsArr.push(d)}ReplaceRealObjectToImage()}}catch(C){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function checkPasteImage(a){if("1"==DEXTTOP.G_CURREDITOR._config.eventForPasteImage){var b=_iframeDoc.createElement("div");b.innerHTML=a;a=b.getElementsByTagName("img");if(0<a.length)try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.pasteImage?DEXTTOP.G_CURREDITOR._config.event.pasteImage(a):"function"===typeof DEXTTOP.DEXTWIN.dext_paste_image_event&&DEXTTOP.DEXTWIN.dext_paste_image_event(a)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}
function replaceSpanToDivContainAbsolute(a){var b=a.innerHTML,c=!1;try{for(var d=a.getElementsByTagName("table"),e=d.length-1;0<=e;e--)if("1"==DEXTTOP.G_CURREDITOR._config.pasteRemoveSpanAbsolute){for(var f=!1,g=d[e].getElementsByTagName("span"),h=g.length-1;0<=h;h--)g&&"absolute"==g[h].style.position&&(g[h].style.position="",f=!0);c=c?c:f}else if((g=GetParentbyTagName(d[e],"span"))&&"absolute"==g.style.position){var m=document.createElement("div");setCopyAllObjectAtributes(g,m,!0);g.parentNode.insertBefore(m,
g);g.parentNode.removeChild(g);c=!0}}catch(q){a.innerHTML=b}return c}function insertCarriageReturn(a,b){"1"==a._config.insertCarriageReturn&&(b=b.replace(/<\/style>/gi,"</style>\r\n"),b=b.replace(/<\/p>/gi,"</p>\r\n"),b=b.replace(/<br>/gi,"<br>\r\n"),b=b.replace(/<br \/>/gi,"<br />\r\n"),b=b.replace(/<br\/>/gi,"<br/>\r\n"),b=b.replace(/<\/span><\/span>/gi,"</span></span\r\n>"),b=b.replace(/<\/tr>/gi,"</tr>\r\n"),b=b.replace(/<\/td>/gi,"</td>\r\n"),b=b.replace(/<\/th>/gi,"</th>\r\n"));return b}
function removeCarriageReturn(a,b){if("1"==a._config.keepOriginalHtml)return b;"1"==a._config.insertCarriageReturn&&(b=b.replace(/<\/style>\r\n/gi,"</style>"),b=b.replace(/<\/p>\r\n/gi,"</p>"),b=b.replace(/<br>\r\n/gi,"<br>"),b=b.replace(/<br \/>\r\n/gi,"<br />"),b=b.replace(/<br\/>\r\n/gi,"<br/>"),b=b.replace(/<\/style>\s/gi,"</style>"),b=b.replace(/<\/p>\s/gi,"</p>"),b=b.replace(/<br>\s/gi,"<br>"),b=b.replace(/<br \/>\s/gi,"<br />"),b=b.replace(/<br\/>\s/gi,"<br/>"),b=b.replace(/<\/tr>\r\n/gi,"</tr>"),
b=b.replace(/<\/tr>\s/gi,"</tr>"),b=b.replace(/<\/td>\r\n/gi,"</td>"),b=b.replace(/<\/td>\s/gi,"</td>"),b=b.replace(/<\/th>\r\n/gi,"</th>"),b=b.replace(/<\/th>\s/gi,"</th>"));var c=RegExp("(<table *[^>?+]*>)\\s+<","gi");b=b.replace(c,"$1<");c=RegExp("(<caption *[^>?+]*>)\\s+<","gi");b=b.replace(c,"$1<");c=RegExp("(<tbody *[^>?+]*>)\\s+<","gi");b=b.replace(c,"$1<");c=RegExp("(<tr *[^>?+]*>)\\s+<","gi");b=b.replace(c,"$1<");c=RegExp("(<td *[^>?+]*>)\\s+<","gi");b=b.replace(c,"$1<");c=RegExp("(<th *[^>?+]*>)\\s+<",
"gi");b=b.replace(c,"$1<");c=RegExp("</tbody>\\s+<","gi");b=b.replace(c,"</tbody><");c=RegExp("</caption>\\s+<","gi");b=b.replace(c,"</caption><");c=RegExp("</tr>\\s+<","gi");b=b.replace(c,"</tr><");c=RegExp("</td>\\s+<","gi");b=b.replace(c,"</td><");c=RegExp("</th>\\s+<","gi");b=b.replace(c,"</th><");c=RegExp("</div>\\s+<","gi");b=b.replace(c,"</div><");c=RegExp("</p>\\s+</td","gi");b=b.replace(c,"</p></td");c=RegExp("(<span *[^>?+]*>)([\r\n]+)(</ ?span>)","gi");return b=b.replace(c,"$1&nbsp;$3")}
function removeStripTags(a,b){a=a.replace(RegExp("<%|%>","gi"),"");var c=b&&0!=b.length?"<\\/?(?!("+b.join("|")+"))\\b[^>]*>":"</?[^>]*>";return a.replace(new RegExp(c,"gi"),"")}function unhtmlSpecialChars(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;/g,"&")}function htmlSpecialChars(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;")}var StringBuffer=function(){this.buffer=[]};
StringBuffer.prototype.append=function(a){this.buffer[this.buffer.length]=a};StringBuffer.prototype.toString=function(){return this.buffer.join("")};
function addLineBreaker(a,b,c){if("br"===a.toLowerCase())return"<p>"+b.replace(/\r?\n/g,"<BR />")+"</p>";b=b.replace(/\r?\n/g,"\n");a=new StringBuffer;b=b.split("\n");for(var d=b.length,e="",f=0;f<d;f++){e=DEXTTOP.DEXT5.util.trim(b[f]);if(f===d-1&&""===e)break;null!==e&&""!==e?(e=c?DEXTTOP.DEXT5.util.escapeHtml(b[f]):b[f],a.append("<P>"),a.append(e),a.append("</P>")):DEXTTOP.DEXT5.browser.ie&&10>=DEXTTOP.DEXT5.browser.ieVersion?a.append("<P>&nbsp;</P>"):a.append("<P><BR></P>")}return a.toString()}
function checkContainClass(a,b){var c=!1;if(""!=b&&a.className&&""!=a.className)for(var d=a.className.split(" "),e=d.length,f=0;f<e;f++)if(d[f]==b){c=!0;break}return c}
function addDisalbeItemForNoActionTable(a){return a=a.concat("table_selection table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight table_group table_group_detail insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column convert_table_to_text cell_border cell_bg_color table_indent table_outdent table_tool insert_row insert_column table_select align_vertical table_copy cell_size detail_cell_bg_color".split(" "))}
function dropMousePosition(a){try{var b=getEditrFromEvent(a),c=_iframeDoc.body.topMargin,d=_iframeDoc.body.leftMargin;b.mouseDropPosition.clientX=a.clientX<d?d:a.clientX;b.mouseDropPosition.clientY=a.clientY<c?c:a.clientY}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function dext5LoadEvt(a){try{var b=getEditrFromEvent(a);DEXTTOP.G_CURREDITOR=b;set_view_mode_auto_height(b)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function dext5ContextmenuEvt(a){try{DEXTTOP.DEXT5.util.cancelEvent(a)}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function dext5DropEvt(a){try{return DEXTTOP.DEXT5.util.cancelEvent(a),!1}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function dext5IEKeyDownEvt(a){var b=a.target?a.target:a.srcElement;if(b&&-1<b.id.indexOf("dext5_design")&&"iframe"==b.nodeName.toLowerCase())return DEXTTOP.DEXT5.util.cancelEvent(a),!1}
function dext5DialogMouseoverEvt(a){(a.target?a.target:a.srcElement).style.cursor="move"}function dext5DialogMouseoutEvt(a){(a.target?a.target:a.srcElement).style.cursor="pointer"}function dext5DialogScrollEvt(a){a=getDialogWindow();drag&&a.scroll(currentScrollPos[0],currentScrollPos[1])}
function insertDropImage_quality(a){var b=a.dataTransfer.files,c=b.length;if(1>DEXTTOP.G_CURREDITOR._config.imageQuality.quality&&0<c){showProcessingBackground();G_QualityFileObj=[];for(var d=0;d<c;d++){var e=DEXTTOP.DEXT5.util.getExtensionFromFileName(b[d].name),f=imageQualityBool(b[d].size,e);G_QualityFileObj.push({fileObj:b[d],originalExtension:e,originalFileName:b[d].name,idx:d,changeBool:f})}a&&DEXTTOP.DEXT5.util.cancelEvent(a);DEXTTOP.DEXT5.browser.WorkerSupported&&"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?
changeImageQuality():changeImageQualityWithoutWorker();var g=setInterval(function(){if(G_CompleteImageQuality){b=[];for(var d=0;d<c;d++)b.push(G_QualityFileObj[d].fileObj);clearInterval(g);G_QualityFileObj=[];G_changeCount=0;G_CompleteImageQuality=!1;hideProcessingBackground();insertDropImage(a,b)}},300)}else insertDropImage(a)}
function insertDropImage(a,b){var c=getEditrFromEvent(a);c.isDragStartedInEditor=!1;showFileDropArea(!1);try{if("1"==c._config.returnEvent.drag_event&&(DEXTTOP.DEXT5.config.DragEventCancel=!1,"function"==typeof c._config.event.drag?c._config.event.drag("drop",a):DEXTTOP.DEXTWIN.dext_drag_event("drop",a),1==DEXTTOP.DEXT5.config.DragEventCancel)){DEXTTOP.DEXT5.util.cancelEvent(a);return}}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}b||(b=a.dataTransfer.files);if(0<b.length&&(DEXTTOP.G_CURREDITOR=
c,c._DOC.body.isContentEditable)){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();if(DEXTTOP.DEXT5.browser.ie)try{if(dropMousePosition(a),_iframeDoc.caretPositionFromPoint){var e=_iframeDoc.caretPositionFromPoint(c.mouseDropPosition.clientX,c.mouseDropPosition.clientY),f=_iframeDoc.createRange();f.setStart(e.offsetNode,e.offset);f.collapse()}else if(_iframeDoc.caretRangeFromPoint)f=_iframeDoc.caretRangeFromPoint(c.mouseDropPosition.clientX,c.mouseDropPosition.clientY);else if(_iframeDoc.body.createTextRange){var f=
_iframeDoc.body.createTextRange();f.moveToPoint(c.mouseDropPosition.clientX,c.mouseDropPosition.clientY);f.select()}}catch(g){var h=c._BODY.lastChild;if(1!=h.nodeType||"P"!=h.tagName)h=c._DOC.createElement("p"),c._BODY.appendChild(h);doSetCaretPosition(h,1)}else if(e=getFirstRange().range,1==e.collapsed){f=null;try{var h=a.clientX,m=a.clientY;if(a.view==window){var q=a.target;if(q&&1==q.nodeType&&"editor_drop_area"==q.id){q.style.display="block";var t=getClientRect(q);q.style.display="none";h-=t.left;
m-=t.top;createSelectionFromPoint(h,m)}}else createSelectionFromPoint(h,m);c.isInitFocusHandler&&(createSelectionFromPoint(0,0),c.isInitFocusHandler=!1);setFocusToBody(c);e=getFirstRange().range;h=!0;e.collapsed&&1==e.startContainer.nodeType&&0==e.startOffset&&1==e.startContainer.childNodes.length&&(h=!1);h&&(f=_iframeDoc.createElement("dexttemp"),e.insertNode(f),null!=f.nextSibling&&"BR"!=f.nextSibling.tagName&&doSetCaretPosition(f.nextSibling,!1))}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&
RAONWIZDLW()}f&&f.parentNode.removeChild(f)}a.stopPropagation();a.preventDefault();G_HandleFilesCheck=!1;var v=b.length,w=!1;G_tempTotalFileSizeForHandleFilesProcess=0;G_tempTotalFileSizeForHandleFilesLength=v;DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currFileSize=0;executeMaxTotalFileSizeCheckProcess({editor:c,finalCallBackFn:function(a){for(a=0;a<v;a++)a==v-1&&(w=!0),function(a,b){var d=setInterval(function(){try{if(0==G_HandleFilesCheck){G_HandleFilesCheck=!0;var e=new FileReader;e.onload=
function(d){var f=new Image;f.onload=function(e){e=f.width;var g=f.height,h=f.fileName;G_OriginalMultiImageSize_src[h]={width:e,height:g};G_Base64FileNameMap[d.target.result]=h;DEXTTOP.G_CURREDITOR._FRAMEWIN.validateWidthHeight(_dext_editor._config,e,g)?(e=dext5_lang.msg.alert_exec_iamgesize,0!=_dext_editor._config.maxImageWidthSize&&(e+=dext5_lang.msg.alert_width.replace("{0}",_dext_editor._config.maxImageWidthSize),e+=" "),0!=_dext_editor._config.maxImageHeightSize&&(e+=dext5_lang.msg.alert_height.replace("{0}",
_dext_editor._config.maxImageHeightSize)),alert(e)):handleFiles(a,c,b);f=null;f=void 0};f.fileName=e.fileName;f.src=d.target.result};e.onerror=function(){oneComplete("error")};e.fileName=a.name;e.readAsDataURL(a);clearInterval(d)}}catch(f){clearInterval(d)}},100)}(b[a],w)}})}}
function handleFiles(a,b,c){var d=getFirstRange().range;try{1==d.collapsed&&setRestoreCaretPos(!1)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var f=b._config.allowImageFileType.concat([]),g=!1,d=a.name.substring(a.name.lastIndexOf(".")+1).toLowerCase();-1<b._config.disableInsertImage.indexOf(",paste_image,")&&(f=[]);for(var h=0;h<f.length;h++)if(f[h]==d){g=!0;break}if(1==g)if("txt"==d)if(-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector)f=
function(){return function(d,e,f){if(0==f)c&&setTimeout(function(){alert(dext5_lang.msg.message_file_ext_detect)},10),g=void 0,G_HandleFilesCheck=!1;else{var g=new FileReader;g.onload=function(a){a=htmlSpecialChars(a.target.result);a=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,a);DEXTTOP.DEXT5.browser.ie?pasteHtmlAtCaretHuge(a):b._DOC.execCommand("inserthtml",!1,a);g=void 0;G_HandleFilesCheck=!1};g.readAsText(a)}}}(),D5FileDetector(a,d,f);else{var m=new FileReader;m.onload=function(a){a=
htmlSpecialChars(a.target.result);a=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,a);DEXTTOP.DEXT5.browser.ie?pasteHtmlAtCaretHuge(a):b._DOC.execCommand("inserthtml",!1,a);m=void 0;G_HandleFilesCheck=!1};m.readAsText(a)}else if(a&&DEXTTOP.DEXT5.browser.HTML5Supported&&0!=DEXTTOP.G_CURREDITOR._config.maxImageFileSize&&a.size>DEXTTOP.G_CURREDITOR._config.maxImageFileSize)d=dext5_lang.msg.max_file_size,d=d.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(DEXTTOP.G_CURREDITOR._config.maxImageFileSize).toString),
alert(d);else{if(0!=DEXTTOP.G_CURREDITOR._config.maxTotalFileSize&&a&&DEXTTOP.DEXT5.browser.HTML5Supported){f=0;0==G_tempTotalFileSizeForHandleFilesProcess&&(G_tempTotalFileSizeForHandleFilesProcess=b.addedTotalFileSize);f=G_tempTotalFileSizeForHandleFilesProcess+=a.size;if(f>b._config.maxTotalFileSize){c||(G_tempTotalFileSizeForHandleFilesProcess-=a.size);DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currAddedTotalFileSize=0<G_tempTotalFileSizeForHandleFilesLength&&c?G_tempTotalFileSizeForHandleFilesProcess-
a.size:G_tempTotalFileSizeForHandleFilesProcess;DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currFileSize=a.size;c&&(G_tempTotalFileSizeForHandleFilesProcess=0);d=setMessageForMaxTotalFileSize(b);alert(d);G_HandleFilesCheck=!1;return}DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currAddedTotalFileSize=G_tempTotalFileSizeForHandleFilesProcess}"base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&a&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount&&getBase64ImageCount()>=parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,
10)?(d=dext5_lang.msg.max_base64file_count,d=d.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount),alert(d)):"1"==DEXTTOP.G_CURREDITOR._config.uploadImageFileObject?-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector?(f=function(){return function(a,b,d){0==d?(c&&setTimeout(function(){alert(dext5_lang.msg.message_file_ext_detect)},10),m=void 0):(postBase64ImageToServer("",b,null,null,null,a,null,null,a.name),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(a){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},500));G_HandleFilesCheck=!1}}(),D5FileDetector(a,d,f)):(postBase64ImageToServer("",d,null,null,null,a,null,null,a.name),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(a){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},500),G_HandleFilesCheck=!1):-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector?(f=function(){return function(a,d,e){if(0==e)c&&setTimeout(function(){alert(dext5_lang.msg.message_file_ext_detect)},
10),f=void 0,G_HandleFilesCheck=!1;else{var f=new FileReader;f.onload=function(c){b!=DEXTTOP.G_CURREDITOR&&(DEXTTOP.G_CURREDITOR=b);c=c.target.result;if("data:"==c.substring(0,5)&&(c=c.split(","),2==c.length)){var e=getExtFromImageDataSrc(c[0]);"jpeg"==e&&"jpg"==d&&(e="jpg");postBase64ImageToServer(c[1],e,null,null,null,a);window.setTimeout(function(){try{contentChangeEventWrapper()}catch(a){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},500)}f=void 0;G_HandleFilesCheck=!1};f.readAsDataURL(a)}}}(),
D5FileDetector(a,d,f)):(m=new FileReader,m.onload=function(c){b!=DEXTTOP.G_CURREDITOR&&(DEXTTOP.G_CURREDITOR=b);c=c.target.result;if("data:"==c.substring(0,5)&&(c=c.split(","),2==c.length)){var d=getExtFromImageDataSrc(c[0]);if("jpeg"==d){var e=a.name;"jpg"==e.substring(e.lastIndexOf(".")+1).toLowerCase()&&(d="jpg")}postBase64ImageToServer(c[1],d,null,null,null,a,void 0,void 0,e);window.setTimeout(function(){try{contentChangeEventWrapper()}catch(a){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},
500)}m=void 0;G_HandleFilesCheck=!1},m.readAsDataURL(a))}else G_HandleFilesCheck=!1}
function setScrollOverflow(a){switch(a._config.scrollOverflow){case "0":a._BODY.style.overflowX="";a._BODY.style.overflowY="";break;case "1":a._BODY.style.overflowX="scroll";break;case "2":a._BODY.style.overflowY="scroll";break;case "3":a._BODY.style.overflowX="scroll";a._BODY.style.overflowY="scroll";break;case "4":a._BODY.style.overflowX="hidden";break;case "5":a._BODY.style.overflowY="hidden";break;case "6":a._BODY.style.overflowX="hidden",a._BODY.style.overflowY="hidden"}}
function removeEditorCss(a,b){var c=a,d;try{var e=["editor_layout.css","editor_contents.css","editor_showblocks.css","editor_form.css","editor_adjust_table.css"],f=e.length,g=a.match(new RegExp(/<link [^<>]*>/gi)),h=g.length;if(g)for(var m=0;m<f;m++)for(var q=0;q<h;q++)-1<g[q].indexOf(e[m])&&(a=a.replace(g[q],""));d=a}catch(t){d=c}return d}
function createEvent(a,b,c){var d=document.createElement("script");d.setAttribute("for",a);d.event=b;d.appendChild(document.createTextNode(c));document.body.appendChild(d)}function PL_Event_BeforeOpenHtmlConvert(a,b){try{a&&0==a.indexOf("htm")&&(DEXTTOP.G_CURREDITOR.strOldSaveFileName=b)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{DEXTTOP.DEXTWIN.dext5EventBeforeOpenHtmlConvert(a,b)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function PL_Event_AfterOpenHtmlConvert(a,b){try{setFileOpenData(a)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function PL_Event_dropZone_drop(a,b,c){if(!isViewMode(DEXTTOP.G_CURREDITOR)&&a&&0<a.length&&(b=a.lastIndexOf("."),-1<b&&(b=a.substring(b+1),c=",jpg,jpeg,png,bmp,gif,tif,tiff,",-1<DEXTTOP.G_CURREDITOR._config.disableInsertImage.indexOf(",paste_image,")&&(c=""),-1<c.indexOf(b.toLowerCase()))))if(a.indexOf("\\")&&(a=a.replace(/\\/g,"/")),0!=a.indexOf("file://")&&(a="file:///"+a),"base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount&&getBase64ImageCount()+
1>parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,10))a=dext5_lang.msg.max_base64file_count,a=a.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount),alert(a);else{b=_iframeDoc.createElement("img");c=G_dext5plugIn.getImageWidthHeight(a);SetImageAutoFitSize(b,a+"?"+c);b.src=a;b.alt="";dext_src_init(DEXTTOP.G_CURREDITOR._EDITOR.design);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();try{9>DEXTTOP.DEXT5.browser.ieVersion&&(DEXTTOP.G_CURREDITOR.mouseDropPosition.clientX=
_iframeWin.event.clientX,DEXTTOP.G_CURREDITOR.mouseDropPosition.clientY=_iframeWin.event.clientY);var d=_iframeDoc.body.createTextRange();d.moveToPoint(DEXTTOP.G_CURREDITOR.mouseDropPosition.clientX,DEXTTOP.G_CURREDITOR.mouseDropPosition.clientY);d.select()}catch(e){a=DEXTTOP.G_CURREDITOR._BODY.lastChild;if(1!=a.nodeType||"P"!=a.tagName)a=DEXTTOP.G_CURREDITOR._DOC.createElement("p"),DEXTTOP.G_CURREDITOR._BODY.appendChild(a);doSetCaretPosition(a,1)}d=getFirstRange().range;d.collapse(!0);d.insertNode(b);
d.selectNode(b);d.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(d);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper(b)}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}
function setEnableDrapDropFile(){try{G_dext5plugIn.SetEnableDrapDropFile(),11<=DEXTTOP.DEXT5.browser.ieVersion?createEvent(G_dext5plugIn.id,"d5_event_dropZone_drop(strFileFolderName, bFolder, nOrder)","PL_Event_dropZone_drop(strFileFolderName, bFolder, nOrder)"):G_dext5plugIn.attachEvent("d5_event_dropZone_drop",PL_Event_dropZone_drop)}catch(a){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function file_open_plugin(){if("1"==DEXTTOP.G_CURREDITOR._config.openDocument.beforeOpenEvent)try{11<=DEXTTOP.DEXT5.browser.ieVersion?createEvent(G_dext5plugIn.id,"DEXT5_Event_BeforeOpenHtmlConvert(strFileFormat, strFileFullPath)","PL_Event_BeforeOpenHtmlConvert(strFileFormat, strFileFullPath)"):G_dext5plugIn.attachEvent("DEXT5_Event_BeforeOpenHtmlConvert",PL_Event_BeforeOpenHtmlConvert)}catch(a){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}11<=DEXTTOP.DEXT5.browser.ieVersion?createEvent(G_dext5plugIn.id,
"DEXT5_Event_AfterOpenHtmlConvert(strHTML, strReserved)","PL_Event_AfterOpenHtmlConvert(strHTML, strReserved)"):G_dext5plugIn.attachEvent("DEXT5_Event_AfterOpenHtmlConvert",PL_Event_AfterOpenHtmlConvert);var b=G_dext5plugIn.openDocumentDialog();"0"==DEXTTOP.G_CURREDITOR._config.useHybrid&&setFileOpenData(b)}
function setFileOpenData(a){if(a){var b=!0;0==DEXTTOP.DEXT5.isEmpty()&&0==confirm(dext5_lang.msg.newDocument)&&(b=!1);b&&(b=a.substring(0,3).toLowerCase(),a=a.substring(3),"txt"==b&&(a=htmlSpecialChars(a),a=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,a)),"doc"==b||"ppt"==b||"xls"==b?(setGlobalTableDefaultValue(),a=a.replace(/\x3c!--\[if supportMisalignedColumns\]--\x3e/gi,""),a=a.replace(/\x3c!--\[endif\]--\x3e/gi,""),a=execReplaceMsoStyle(a),a=OfficePasteClean(a),setBodyValueToEditor(a)):
DEXTTOP.DEXT5.setHtmlContents(a,DEXTTOP.G_CURREDITOR.ID))}}function removeLastBrTag(a){if("1"==a._config.removeLastBrTag)try{var b=a._DOC.getElementsByTagName("p"),c=b.length;for(a=0;a<c;a++){var d=b[a].lastChild;if(1==d.nodeType&&"BR"==d.tagName){var e=d.previousSibling;!e||1==e.nodeType&&"BR"==e.tagName||d.parentNode.removeChild(d)}}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function changeRealTagToReplaceString(a){var b=a;if(a){var c=a.match(RegExp("<textarea *([^>?+])*>*([^>?+])*</textarea>","gi"));if(c){DEXTTOP.G_CURREDITOR.sTextareaArr=c;for(var d=c.length,e=0;e<d;e++)b=a.replace(c[e],"{_dext5_textarea_"+e+"}")}}return b}function changeReplaceStringToRealTag(a){var b=a;if(a){for(var c=DEXTTOP.G_CURREDITOR.sTextareaArr,d=c.length,e=0;e<d;e++)b=a.replace("{_dext5_textarea_"+e+"}",c[e]);DEXTTOP.G_CURREDITOR.sTextareaArr=[]}return b}
function getViolationNodes(a){dext_src_init(a._EDITOR.design);var b=[];if(""==a._config.accessibilityValidationItems)b=["table","frame","iframe","img","a"];else for(var c=a._config.accessibilityValidationItems.split(","),d=c.length,e=0;e<d;e++)if("duplicate_id"!=c[e].toLowerCase()){var f=c[e].split("_")[0];0>b.indexOf(f)&&b.push(f)}d=b.length;c=[];for(e=0;e<d;e++)for(var f="iframe"==b[e]?_iframeDoc.body.getElementsByTagName("img"):_iframeDoc.body.getElementsByTagName(b[e]),g=f.length,h=0;h<g;h++){var m=
f[h].getAttribute("dext5webaccskip");if(null==m||void 0==m)if("table"==b[e])-1<a._config.accessibilityValidationItems.indexOf("table_caption")&&-1<a._config.accessibilityValidationItems.indexOf("table_summary")||""==a._config.accessibilityValidationItems?null!=f[h].caption&&""!=f[h].caption.innerHTML&&""!=f[h].summary||c.push(f[h]):-1<a._config.accessibilityValidationItems.indexOf("table_caption")?null!=f[h].caption&&""!=f[h].caption.innerHTML||c.push(f[h]):-1<a._config.accessibilityValidationItems.indexOf("table_summary")&&
""==f[h].summary&&c.push(f[h]);else if(-1<"frame,a".indexOf(b[e]))"a"==b[e]?null!=f[h].href&&""!=f[h].href&&""==f[h].title&&c.push(f[h]):""==f[h].title&&c.push(f[h]);else if("iframe"==b[e]){if(m=f[h].getAttribute("dext5customdata"),null!=m&&void 0!=m&&(elemData=getDextCustomData(m),"iframe"==elemData.type||"iframe"==elemData.type2))void 0!=elemData.title&&""!=elemData.title||c.push(f[h])}else"img"==b[e]&&(m=f[h].getAttribute("dext5customdata"),void 0==m||null==m)&&(void 0!=f[h].alt&&""!=f[h].alt||
c.push(f[h]))}b=[];if(-1<a._config.accessibilityValidationItems.indexOf("duplicate_id")||""==a._config.accessibilityValidationItems)for(a=_iframeDoc.body.getElementsByTagName("*"),d=a.length,f=[],e=0;e<d;e++)!a[e].getAttribute("id")||-1<f.indexOf(a[e].getAttribute("id"))||(g=getElementsById(a[e].getAttribute("id"),_iframeDoc))&&1<g.length&&(b.push(g),f.push(a[e].getAttribute("id")));return{violateNodes:c,idSamNodes:b}}
function setAdjustTableBorder(a){for(var b=a.getElementsByTagName("link"),c=null,d=b.length-1;0<=d;d--)-1<b[d].href.indexOf("editor_adjust_table.css")&&(c=b[d],c.parentNode.removeChild(c));DEXTTOP.DEXT5.browser.ie&&(11>DEXTTOP.DEXT5.browser.ieVersion&&7<DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)&&0<a.getElementsByTagName("table").length&&(b=DEXTTOP.G_CURREDITOR._config.webPath.css,DEXTTOP.DEXT5.isRelease||(b=DEXTTOP.G_CURREDITOR._config.webPath.css_dev),c=a.getElementsByTagName("head")[0],
createDynamicCssLinkToHeadTag(a,c,b+"editor_adjust_table.css?t="+DEXTTOP.DEXT5.UrlStamp),setTimeout(function(){for(var b=a.getElementsByTagName("link"),c=null,d=b.length-1;0<=d;d--)-1<b[d].href.indexOf("editor_adjust_table.css")&&(c=b[d],c.parentNode.removeChild(c))},0))}function hiddenBlocks(a){a=a.getElementsByTagName("link");for(var b=null,c=a.length-1;0<=c;c--)-1<a[c].href.indexOf("editor_showblocks.css")&&(b=a[c],b.parentNode.removeChild(b))}
function removeDummyTag(a){a=DEXTTOP.DEXT5.util.replaceAll(a,"<![if !mso]>","");a=DEXTTOP.DEXT5.util.replaceAll(a,"<![if !mso & !vml]>","");var b=DEXTTOP.G_CURREDITOR._config.removeDummyTag;if(""!=b)for(var b=b.split(","),c=b.length,d=0;d<c;d++){var e=DEXTTOP.DEXT5.util.trim(b[d]),f=new RegExp("<"+e+".*?>","gi");a=a.replace(f,"");f=new RegExp("</"+e+".*?>","gi");a=a.replace(f,"")}return a}
function dummyTagClassClear(a){"1"==DEXTTOP.G_CURREDITOR._config.useSelectionMark&&(a=a.replace(RegExp("<dextmark[^>]+class=.*?dextmark.*?></dextmark>","gi"),""));1==DEXTTOP.G_CURREDITOR.ShowTableBorder&&(a=a.replace(" DEXT_tableborder",""),a=a.replace("DEXT_tableborder ",""),a=a.replace("DEXT_tableborder",""),a=a.replace('class=""',""));return a}
function ReplaceCustomDataToRealEvent(a){try{var b=_iframeDoc;a&&(b=a);for(var c=b.getElementsByTagName("input"),d=c.length-1;0<=d;d--){var e=c[d],f=e.getAttribute("dext5customdata");if(null!=f&&void 0!=f){var g=getDextCustomData(f);if(g.type&&"event"==g.type){var h=g.eventName,m=g.eventFunction,q=h.split("\x0B"),t=m.split("\x0B"),u=q.length;for(i=0;i<u;i++)e.setAttribute(q[i],t[i])}e.removeAttribute("dext5customdata")}}for(var v=b.getElementsByTagName("textarea"),d=v.length-1;0<=d;d--){var w=v[d],
f=w.getAttribute("dext5customdata");if(null!=f&&void 0!=f){g=getDextCustomData(f);if(g.type&&"event"==g.type)for(h=g.eventName,m=g.eventFunction,q=h.split("\x0B"),t=m.split("\x0B"),u=q.length,i=0;i<u;i++)w.setAttribute(q[i],t[i]);w.removeAttribute("dext5customdata")}}for(var y=b.getElementsByTagName("select"),d=y.length-1;0<=d;d--){var x=y[d],f=x.getAttribute("dext5customdata");if(null!=f&&void 0!=f){g=getDextCustomData(f);if(g.type&&"event"==g.type)for(h=g.eventName,m=g.eventFunction,q=h.split("\x0B"),
t=m.split("\x0B"),u=q.length,i=0;i<u;i++)x.setAttribute(q[i],t[i]);x.removeAttribute("dext5customdata")}}}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function ReplaceRealEventToCustomData(){for(var a=_iframeDoc.getElementsByTagName("input"),b=a.length-1;0<=b;b--){for(var c=a[b],d=DEXTTOP.G_CURREDITOR._config.eventList.length,e="",f="",g=!1,h=0;h<d;h++)c.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h])&&(g&&(e+="\x0B",f+="\x0B"),g=!0,e+=DEXTTOP.G_CURREDITOR._config.eventList[h],f+=c.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h]));""!=e&&(d={type:"event"},d.eventName=e,d.eventFunction=f,setDextCustomData(c,d))}a=_iframeDoc.getElementsByTagName("textarea");
for(b=a.length-1;0<=b;b--){c=a[b];d=DEXTTOP.G_CURREDITOR._config.eventList.length;f=e="";g=!1;for(h=0;h<d;h++)c.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h])&&(g&&(e+="\x0B",f+="\x0B"),g=!0,e+=DEXTTOP.G_CURREDITOR._config.eventList[h],f+=c.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h]));""!=e&&(d={type:"event"},d.eventName=e,d.eventFunction=f,setDextCustomData(c,d))}a=_iframeDoc.getElementsByTagName("select");for(b=a.length-1;0<=b;b--){c=a[b];d=DEXTTOP.G_CURREDITOR._config.eventList.length;
f=e="";g=!1;for(h=0;h<d;h++)c.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h])&&(g&&(e+="\x0B",f+="\x0B"),g=!0,e+=DEXTTOP.G_CURREDITOR._config.eventList[h],f+=c.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h]));""!=e&&(d={type:"event"},d.eventName=e,d.eventFunction=f,setDextCustomData(c,d))}}
function checkLockAttr(a,b,c){for(var d=!1,e=[],e="1"==DEXTTOP.G_CURREDITOR._config.formMode?DEXTTOP.G_CURREDITOR._config.adminTableLock.checkLockName:DEXTTOP.G_CURREDITOR._config.userTableLock.lockName,f=e.length;null!=a;){for(var g=0;g<f;g++)if(void 0!=a.getAttribute(e[g])){if(c&&a.tagName&&"TABLE"==a.tagName&&"2"!=c)break;d=!0;break}if(b)break;else a=!a.tagName||"TD"!=a.tagName&&"TH"!=a.tagName?a.tagName&&"TABLE"==a.tagName?GetTDTHCell(a):null:GetParentbyTagName(a,"table")}return d}
function removeLockAttr(a){var b=DEXTTOP.G_CURREDITOR._config.adminTableLock.checkLockName,c=b.length;if(a)for(var d=0;d<c;d++)a.removeAttribute(b[d])}
function setClassTableAndCellLock(a){if("0"!=a._config.formMode||"0"!=a._config.userTableLock.use){""==a._config.tableNoResizeClass&&(a._config.tableNoResizeClass="dext_no_resize");""==a._config.tableNoActionClass&&(a._config.tableNoActionClass="dext_no_action");for(var b=a._config.tableNoResizeClass,c=a._config.tableNoActionClass,d=a._DOC.getElementsByTagName("table"),e=d.length,f=0;f<e;f++)if(checkLockAttr(d[f],!0))if("1"==a._config.formMode)setClassName(d[f],"DEXT_five_table_lock");else{if("1"==
a._config.userTableLock.use){var g=a._config.userTableLock.defaultShowLockIcon;d[f].getAttribute("show_icon")&&""!=d[f].getAttribute("show_icon")&&(g=d[f].getAttribute("show_icon"));"1"==g?setClassName(d[f],"DEXT_five_table_lock"):removeClassName(d[f],"DEXT_five_table_lock");"2"==a._config.userTableLock.tableLockMode?(g=a._config.userTableLock.defaultTableLockMode,d[f].getAttribute("lock_mode")&&""!=d[f].getAttribute("lock_mode")&&(g=d[f].getAttribute("lock_mode")),removeClassName(d[f],b),removeClassName(d[f],
c),setClassName(d[f],b),"2"==g&&setClassName(d[f],c)):(setClassName(d[f],b),setClassName(d[f],c))}}else"1"==a._config.userTableLock.use&&("2"==a._config.userTableLock.tableLockMode?(removeClassName(d[f],b),removeClassName(d[f],c)):(g=a._config.userTableLock.defaultTableLockMode,d[f].getAttribute("lock_mode")&&""!=d[f].getAttribute("lock_mode")&&(g=d[f].getAttribute("lock_mode")),"2"==g?checkLockAttr(d[f])&&(setClassName(d[f],b),setClassName(d[f],c)):(removeClassName(d[f],b),removeClassName(d[f],c))));
b=a._DOC.getElementsByTagName("td");c=b.length;for(f=0;f<c;f++)checkLockAttr(b[f],!0)&&("1"==a._config.formMode?setClassName(b[f],"DEXT_five_cell_lock"):(d=a._config.userTableLock.defaultShowLockIcon,e=GetParentbyTagName(b[f],"table"),e.getAttribute("show_icon")&&""!=e.getAttribute("show_icon")&&(d=e.getAttribute("show_icon")),"1"==a._config.userTableLock.use&&("1"==d?setClassName(b[f],"DEXT_five_cell_lock"):removeClassName(b[f],"DEXT_five_cell_lock"))))}}
function findNoLockCell(a){var b=null;if(a){var c=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;a.getAttribute("lock_mode")&&""!=a.getAttribute("lock_mode")&&(c=a.getAttribute("lock_mode"));var d=!0;"1"==c&&(d=!1);a=a.getElementsByTagName("td");for(var c=a.length,e=0;e<c;e++)if(0==checkLockAttr(a[e],!d)){b=a[e];break}}return b}
function findNextNoLockCell(a,b,c,d){var e=null,f=a.cellIndex,g=a.parentNode;a=g.rowIndex;g=g.parentNode;if(b)for(b=a;b<g.rows.length;b++){var h=0;b==a&&(h=f);var m=g.rows[b];if("1"==DEXTTOP.G_CURREDITOR._config.adjustCursorInTable&&d&&40==d)if(m=getTopOrBottomBoundNextCell(m.cells[f],40).nextCell,checkLockAttr(m,!1,c)||(e=m),e)break;else continue;for(;h<m.cells.length;h++)if(!checkLockAttr(m.cells[h],!1,c)){e=m.cells[h];break}if(e)break}else for(b=a;0<=b;b--){m=g.rows[b];h=m.cells.length-1;b==a&&
(h=f);if("1"==DEXTTOP.G_CURREDITOR._config.adjustCursorInTable&&d&&38==d)if(m=getTopOrBottomBoundNextCell(m.cells[f],38).nextCell,checkLockAttr(m,!1,c)||(e=m),e)break;else continue;for(;0<=h;h--)if(!checkLockAttr(m.cells[h],!1,c)){e=m.cells[h];break}if(e)break}return e}
function setFocusForLock(a){try{if(a)if("TD"==a.tagName||"TH"==a.tagName){var b=GetParentbyTagName(a,"table");checkLockAttr(b,!0)?("P"==a.firstChild.tagName?doSetCaretPosition(a.firstChild,0):doSetCaretPosition(a,0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCellLockTable")):"P"==a.firstChild.tagName?(doSetCaretPosition(a.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")):(doSetCaretPosition(a,0),DEXTTOP.G_CURREDITOR._iconEnable(""))}else doSetCaretPosition(a,0),DEXTTOP.G_CURREDITOR._iconEnable("")}catch(c){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function findNoLockElem(a){var b=null;if(a){var c=a.previousSibling;c&&1==c.nodeType&&!checkLockAttr(c)&&(b=c);null==b&&(a=a.nextSibling)&&1==a.nodeType&&!checkLockAttr(a)&&(b=a)}return b}
function checkLockElemInSelectionRange(){try{var a=getFirstRange(),b=a.range;if(0==b.collapsed){var c=[[],[]];c[0]=getNodesInRange(b);if(null!=b.startContainer.previousSibling&&"HEAD"==b.startContainer.previousSibling.tagName&&null==b.endContainer.nextSibling){var d=_iframeDoc.getElementsByTagName("table"),e=_iframeDoc.getElementsByTagName("td");c[0]=d;c[1]=e}for(var f=c.length-1;0<=f;f--)for(var g=c[f].length-1;0<=g;g--){var h;h="TD"==c[f][g].tagName||"TABLE"==c[f][g].tagName;if(c[f][g].tagName&&
h&&checkLockAttr(c[f][g],!0)){a.sel.removeAllRanges();DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):(window.focus(),document.body.focus());break}}}}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function IsExistTableLock(a){var b=!1,c=a._DOC;a=c.getElementsByTagName("table");var d=c.getElementsByTagName("td"),c=c.getElementsByTagName("th");a=[a,d,c];d=a.length;for(c=0;c<d;c++){for(var e=a[c].length,f=0;f<e;f++)if(checkLockAttr(a[c][f],!0)){b=!0;break}if(b)break}return b}function setDEXTWINDOC(){null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(setDEXTWINwindow(),setDEXTDOCdocument())}
function groupingIcon(){"1"==_dext_editor._config.tool_bar_grouping&&("0"!=_dext_editor._config.tool_bar&&"2"!=_dext_editor._config.tool_bar||makeGrouping(1),"0"!=_dext_editor._config.tool_bar&&"1"!=_dext_editor._config.tool_bar||makeGrouping(2))}
function makeGrouping(a){if(DEXTTOP.DEXT5.util.DEXT5_CheckEditorVisible(_dext_editor.ID)){var b=_dext_editor._FRAMEWIN.document.getElementById("ue_editor_main_"+_dext_editor.ID),b=getClientRect(b);if(!(200>b.right-b.left)){for(var c=_dext_editor._FRAMEWIN.document.getElementById("dext_tab_tool"+a+"_"+_dext_editor.ID),d=_dext_editor.Toolbar_group[a-1].length,d=d-1;0<=d;d--)c.appendChild(_dext_editor.Toolbar_group[a-1][d]);_dext_editor.Toolbar_group[a-1]=[];_dext_editor._FRAMEWIN.document.getElementById("ul_tool_bar_grouping_list"+
a).innerHTML="";for(var e=c.childNodes,f=e.length,c=[],d=0;d<f;d++)1==e[d].nodeType&&(-1<e[d].className.indexOf("uebutton")||-1<e[d].className.indexOf("ue_SM"))&&c.push(e[d]);for(d=c.length-1;0<=d;d--)if(e=getClientRect(c[d]),0==isRTL(document))if(e.right>=b.right-18)-1<c[d].id.indexOf("detail_table_insert")?(_dext_editor.Toolbar_group[a-1].push(c[d]),_dext_editor.Toolbar_group[a-1].push(c[d-1]),--d):-1<c[d].id.indexOf("detail_list_")||-1<c[d].id.indexOf("_group_detail")||-1<c[d].id.indexOf("detail_font_")||
-1<c[d].id.indexOf("detail_cell_")?(_dext_editor.Toolbar_group[a-1].push(c[d]),_dext_editor.Toolbar_group[a-1].push(c[d-1]),--d):_dext_editor.Toolbar_group[a-1].push(c[d]);else{if("none"!=c[d].style.display)break}else if(e.left<=b.left+18)-1<c[d].id.indexOf("detail_table_insert")?(_dext_editor.Toolbar_group[a-1].push(c[d]),_dext_editor.Toolbar_group[a-1].push(c[d-1]),--d):-1<c[d].id.indexOf("detail_list_")||-1<c[d].id.indexOf("_group_detail")||-1<c[d].id.indexOf("detail_font_")||-1<c[d].id.indexOf("detail_cell_")?
(_dext_editor.Toolbar_group[a-1].push(c[d]),_dext_editor.Toolbar_group[a-1].push(c[d-1]),--d):_dext_editor.Toolbar_group[a-1].push(c[d]);else if("none"!=c[d].style.display)break;d=_dext_editor.Toolbar_group[a-1].length;b=_dext_editor._FRAMEWIN.document.getElementById("dext_span_"+_dext_editor.ID+"tool_bar_grouping"+a);if(0==d)b.style.display="none";else{for(--d;0<=d;d--)c=_dext_editor._FRAMEWIN.document.createElement("li"),-1<_dext_editor.Toolbar_group[a-1][d].id.indexOf("list_")?(c.appendChild(_dext_editor.Toolbar_group[a-
1][d]),c.appendChild(_dext_editor.Toolbar_group[a-1][d-1]),--d):c.appendChild(_dext_editor.Toolbar_group[a-1][d]),_dext_editor._FRAMEWIN.document.getElementById("ul_tool_bar_grouping_list"+a).appendChild(c);b.style.display=""}}}}
function setPositionGroupingDiv(a){var b=document.getElementById("dext_div_tool_bar_grouping_box"+a),c=document.getElementById("dext_span_"+_dext_editor.ID+"tool_bar_grouping"+a),c=getClientRect(c);a=getClientRect(document.getElementById("ul_tool_bar_grouping_list"+a));isRTL()?b.style.left="0px":b.style.left=c.right-(a.right-a.left)-2+"px";b.style.top=c.bottom+"px"}
function showGroupingBackground(){var a=document.getElementById("dext_grouping_background");a||(a=document.createElement("div"),a.setAttribute("id","dext_grouping_background"),a.style.zIndex=G_MAIN_ZINDEX+800,document.body.appendChild(a),DEXTTOP.DEXT5.util.addEventEx(a,"click",function(){hideGroupingBox()}),a.onmousedown=function(){return!1},a.unselectable="on");DEXT5_EDITOR.prototype.dialog.set_full_size(a);a.style.display="block"}
function hideGroupingBox(){dialogCancel();var a=document.getElementById("dext_div_tool_bar_grouping_box1");a&&(a.style.display="none");if(a=document.getElementById("dext_div_tool_bar_grouping_box2"))a.style.display="none";if(a=document.getElementById("dext_grouping_background"))a.style.display="none"}
function isGroupingIcon(a,b,c){var d=!1;"1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&(a=c?c:document.getElementById("ue_"+a+b),(a=GetParentbyTagName(a,"ul"))&&-1<a.id.indexOf("ul_tool_bar_grouping")&&(d=!0));return d}
function userCssSet(a,b){var c=strRetvalue=a,d='<link href="'+b+'" rel="stylesheet" type="text/css">';try{if(-1==a.indexOf(d)){var e=a.indexOf("</head>");if(-1==e){var f=a.indexOf("<body");strRetvalue=-1==f?"<head>"+d+"</head><body>"+a+"</body>":a.substring(0,f)+"<head>"+d+"</head>"+a.substring(f)}else strRetvalue=a.substring(0,e)+d+a.substring(e)}}catch(g){strRetvalue=c}return strRetvalue}
function loadDirectEditHtmlUrl(a){if(""!=a.directEditHtmlUrl){var b=DEXTTOP.G_CURREDITOR._EDITOR.design;DEXTTOP.DEXT5.util.addEventEx(b,"load",loadDirectEditHtmlUrlEvent);"1"==DEXTTOP.G_CURREDITOR._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){b.src=a.directEditHtmlUrl},G_Progress_LoadTime)):b.src=a.directEditHtmlUrl}}
function loadDirectEditHtmlUrlEvent(){try{var a=DEXTTOP.G_CURREDITOR._EDITOR.design,b=DEXTTOP.G_CURREDITOR._setting.encoding,c=DEXTTOP.G_CURREDITOR._setting.lang,d=DEXTTOP.G_CURREDITOR._setting.xmlnsname,e=DEXTTOP.G_CURREDITOR._setting.font_family,f=DEXTTOP.G_CURREDITOR._setting.font_size,g=DEXTTOP.G_CURREDITOR._setting.line_height,h=a.contentWindow,m=getIframeDocument(a),q=h.document.documentElement.getElementsByTagName("head")[0];if(null==q||void 0==q)q=m.createElement("head"),m.insertBefore(q,
m.body);if(""!=DEXTTOP.G_CURREDITOR._config.imageBaseUrl){for(var t=q.getElementsByTagName("base"),u=t.length,v=0;v<u;v++)if(t[v].href&&-1<t[v].href.indexOf(DEXTTOP.G_CURREDITOR._config.imageBaseUrl)){sameCheck=!0;break}var w=m.createElement("base");w.href=DEXTTOP.G_CURREDITOR._config.imageBaseUrl;q.appendChild(w)}if(""!=DEXTTOP.G_CURREDITOR._config.ieCompatible){for(var y=q.getElementsByTagName("meta"),x=y.length,v=0;v<x;v++)if(y[v].getAttribute("content")&&-1<y[v].getAttribute("content").indexOf("IE="+
DEXTTOP.G_CURREDITOR._config.ieCompatible)){sameCheck=!0;break}var z=m.createElement("meta");z.setAttribute("http-equiv","X-UA-Compatible");z.setAttribute("content","IE="+DEXTTOP.G_CURREDITOR._config.ieCompatible);q.appendChild(z)}for(var B=q.getElementsByTagName("style"),D=B.length,h=!1,v=0;v<D;v++)if(1==defaultStyleSameCheck(B[v].innerHTML,DEXTTOP.G_CURREDITOR)){h=!0;break}if(!h){var A=createEditorDefaultStyleInnerHTML(DEXTTOP.G_CURREDITOR._config,e,f,g);addDynamicCssToHeadTag(m,q,A)}e="";e=DEXTTOP.DEXT5.isRelease?
DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev;createDynamicCssLinkToHeadTag(m,q,e+"editor_contents.css?t="+DEXTTOP.DEXT5.UrlStamp);"1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"!=DEXTTOP.G_CURREDITOR._config.userTableLock.use||createDynamicCssLinkToHeadTag(m,q,e+"editor_form.css?t="+DEXTTOP.DEXT5.UrlStamp);if(c&&0<c.length){var C=m.getElementsByTagName("html")[0];C&&(-1<c.indexOf("-")&&(c=c.split("-")[0]),C.setAttribute("lang",c),C.setAttribute("xml:lang",
c),0<d.length&&C.setAttribute("xmlns",d))}""==b&&(b="utf-8");var E=m.createElement("meta");E.setAttribute("http-equiv","Content-Type");E.setAttribute("content","text/html");E.setAttribute("charset",b);q.appendChild(E);5<DEXTTOP.G_CURREDITOR._config.userCssUrl.length&&createDynamicCssLinkToHeadTag(m,q,DEXTTOP.G_CURREDITOR._config.userCssUrl);5<DEXTTOP.G_CURREDITOR._config.webFontCssUrl.length&&createDynamicCssLinkToHeadTag(m,q,DEXTTOP.G_CURREDITOR._config.webFontCssUrl);5<DEXTTOP.G_CURREDITOR._config.userJsUrl.length&&
createDynamicJsLinkToHeadTag(m,q,DEXTTOP.G_CURREDITOR._config.userJsUrl);DEXT5_EDITOR.prototype._load_editor_frame(!1);0==isViewMode(DEXTTOP.G_CURREDITOR)&&(DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,"1"==DEXTTOP.G_CURREDITOR._config.formMode?(ReplaceRealEventToCustomData(),ReplaceRealObjectToImage(!1)):ReplaceRealObjectToImage(),0==h&&xssReplaceScript(_iframeDoc));setScrollOverflow(DEXTTOP.G_CURREDITOR);setStyleForTableBorderNodeClass(DEXTTOP.G_CURREDITOR);setCssForFormMode(DEXTTOP.G_CURREDITOR);
DEXTTOP.G_CURREDITOR._iconEnable("");setBodyDefaultValue();try{var H=DEXTTOP.G_CURREDITOR._BODY.innerHTML,H=addHtmlToSetValue(DEXTTOP.G_CURREDITOR,H),H=removeDummyTag(H),H=removeIncorrectSpaceInTag(H),H=DEXT5_EDITOR.HTMLParser.RemoveOfficeTag2(H);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlCorrection&&0==h&&(H=htmlTagRevision(H,!1));H=removeTagStyle(H);H=htmlAsciiToChar(H);H=RemoveUnnecessaryChar(H);0==h&&(H=CleanZeroChar(H));b=!1;"1"==DEXTTOP.G_CURREDITOR._config.replaceEmptyTagWithSpace&&(b=!0);H=
DEXTTOP.DEXT5.util.htmlRevision(H,b);DEXTTOP.G_CURREDITOR._BODY.innerHTML=H}catch(M){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}wrapPtagForNotBlockTag(DEXTTOP.G_CURREDITOR);replaceBrTag(DEXTTOP.G_CURREDITOR);fn_IEJASOBug(DEXTTOP.G_CURREDITOR);removeLastBrTag(DEXTTOP.G_CURREDITOR);0==isViewMode(DEXTTOP.G_CURREDITOR)&&(removeNbspInPTag(DEXTTOP.G_CURREDITOR),replaceClassForBorder(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._BODY,"show"),replaceClassForBookmark(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._BODY,
"show"));setFocusToBody();setFocusChildForStyle(DEXTTOP.G_CURREDITOR._BODY);DEXTTOP.DEXT5.util.setBodyBackground(DEXTTOP.G_CURREDITOR);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR.UndoManager.canUndo=!1;DEXTTOP.G_CURREDITOR.UndoManager.canRedo=!1;DEXTTOP.G_CURREDITOR._iconEnable("");insertImageSrc(DEXTTOP.G_CURREDITOR);showRuler(DEXTTOP.G_CURREDITOR);setClassTableAndCellLock(DEXTTOP.G_CURREDITOR);setAdjustTableBorder(DEXTTOP.G_CURREDITOR._DOC);
"show_blocks"==DEXTTOP.G_CURREDITOR.ShowBlocks&&(DEXTTOP.G_CURREDITOR.ShowBlocks="",command_showBlocks(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR));var N=DEXTTOP.G_CURREDITOR;setTimeout(function(){try{"function"==typeof N._config.event.setComplete?N._config.event.setComplete(N.ID):DEXTTOP.dext_editor_set_complete_event(N.ID)}catch(a){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},300)}catch(I){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}finally{DEXTTOP.DEXT5.util.removeEvent(a,
"load",loadDirectEditHtmlUrlEvent),"1"==DEXTTOP.G_CURREDITOR._config.statusBarLoading&&hideProcessingBackground()}}
function showProcessingBackground(){var a=document.getElementById("dext_Processing_background"),b=document.getElementById("dext_Processing_text");a||(a=document.createElement("div"),a.setAttribute("id","dext_Processing_background"),a.style.zIndex=G_MAIN_ZINDEX+900,a.style.verticalAlign="middle",b=document.createElement("div"),b.setAttribute("id","dext_Processing_text"),b.style.zIndex=parseIntOr0(a.style.zIndex)+100,b.innerHTML=DEXTTOP.G_CURREDITOR._config.style.htmlprocessCustomText,b.className="dext_Processing_text_"+
DEXTTOP.G_CURREDITOR._config.style.skinName,document.body.appendChild(a),document.body.appendChild(b));DEXT5_EDITOR.prototype.dialog.set_full_size(a);a.style.display="block";b.style.display="block"}
function hideProcessingBackground(){var a=document.getElementById("dext_Processing_background"),b=document.getElementById("dext_Processing_text");a&&(a.style.display="none",b.style.display="none");""!=DEXTTOP.G_CURREDITOR._config.placeholder.content&&placeholderControl(DEXTTOP.G_CURREDITOR,"class");DEXTTOP.G_CURREDITOR.isPasting&&(DEXTTOP.G_CURREDITOR.isPasting=!1);try{for(var c in G_DEPlugin)if("function"===typeof G_DEPlugin[c].onChange)G_DEPlugin[c].onChange()}catch(d){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}}function textCheckInString(a){a=a.replace(/\r\n/g,"");a=a.replace(/\r/g,"");a=a.replace(/\n/g,"");a=a.replace(/\t/g,"");return a=a.replace(/\s/g,"")}function getDialogWindow(){var a=DEXTTOP.window;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(a=DEXTTOP.G_CURREDITOR.dialogWindow);return a}function getDialogDocument(){var a=DEXTTOP.window.document;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(a=DEXTTOP.G_CURREDITOR.dialogWindow.document);return a}
function addHtmlToSetValue(a,b){var c=backValue=b;try{var d=a._config.addHtmlToSetValue.html;if(""!=d){var e=a._config.addHtmlToSetValue.preOrSub,f=-1;if(0==e){var g=b.toLowerCase().indexOf("<body");-1<g&&(f=g+b.substring(g).indexOf(">"))}else f=b.toLowerCase().indexOf("</body")-1;c=0<f?b.substring(0,f+1)+d+b.substring(f+1):0==e?d+b:b+d;a._config.addHtmlToSetValue.html=""}}catch(h){c=backValue}return c}
function adjustTableForIEJASOBug(a){try{if("1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign){if("1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_ReplaceAlignMargin&&("center"==a.align||"right"==a.align)){var b=getReplaceAlignMargin(DEXTTOP.G_CURREDITOR,a);0!=b&&(a.style.marginLeft=b+"px")}a.align="";a.removeAttribute("align");try{"cssFloat"in a.style?a.style.cssFloat="":a.style.styleFloat=""}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}for(var b=["td","th","p",
"span"],d=b.length,e=0;e<d;e++){var f=a.getElementsByTagName(b[e]),g=f.length;if("span"!=b[e])for(var h=0;h<g;h++)1==f[h].childNodes.length&&1==f[h].childNodes[0].nodeType&&"BR"==f[h].childNodes[0].tagName&&(f[h].innerHTML="P"==f[h].tagName?"&nbsp;":"<p>&nbsp;</p>");else for(h=0;h<g;h++)if(1!=f[h].childNodes.length||"br"!=f[h].childNodes[0].tagName.toLowerCase()){var m=f[h].innerHTML,m=m.replace(/<br>$/ig,""),m=m.replace(/<br ([^>]+)>$/ig,"");11==DEXTTOP.DEXT5.browser.ieVersion&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&
""==m&&(m=unescape("%u200B"));f[h].innerHTML=m}}}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function getReplaceAlignMargin(a,b){var c=0;(c=GetTDTHCell(b))?c=parseIntOr0(c.clientWidth):(c=getWidthForAutoBodyFit(a,"table"),"1"!=a._config.autoBodyFit&&(c+=30),DEXTTOP.DEXT5.browser.ie||(c-=20));var d;""!=b.style.width&&-1<b.style.width.indexOf("px")?d=parseIntOr0(b.style.width):(d=getClientRect(b),d=d.right-d.left);d=c-d;0<d?"center"==b.align?c=d/2:"right"==b.align&&(c=d):c=0;return c}
function endBrForIEJASOBug(a){if(a.hasChildNodes()&&1==a.lastChild.nodeType&&1<a.childNodes.length)try{var b=a.lastChild;if("br"==b.tagName.toLowerCase()){var c=!0;if(2<a.childNodes.length&&b.previousSibling){var d=b.previousSibling;d&&1==d.nodeType&&"br"==d.tagName.toLowerCase()&&(c=!1)}c&&a.removeChild(b)}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function startCreationPluginObject(a){if(DEXTTOP.DEXT5UPLOAD)try{var b=!0,c="",d=DEXTTOP.DEXT5.util.makeRV({maj:2.7,m1:7,l:"00",mi1:["16","04","28"],mi2:"0000"}),c=DEXTTOP.DEXT5UPLOAD.rvi&&"object"==typeof DEXTTOP.DEXT5UPLOAD.rvi?DEXTTOP.DEXT5UPLOAD.util.grvi("c"):DEXTTOP.DEXT5UPLOAD.ReleaseVer;if(b=DEXTTOP.DEXT5.util.compareVersion?0<=DEXTTOP.DEXT5.util.compareVersion(c,d):c>=d)var e=0,f=null,g=function(b){var c=b.length,d=0,e=!1,g=setInterval(function(){try{var b=DEXTTOP.DEXT5UPLOAD.DEXTMULTIPLE["dext5uploader_frame_"+
f[d]];b&&b._config&&("1"==b._config.hybridDownload&&(e=!0,clearInterval(g)),d++,0==e&&d==c&&(clearInterval(g),fn_createPluginObject(a)))}catch(h){clearInterval(g),fn_createPluginObject(a)}},100)},h=setInterval(function(){try{f=DEXTTOP.DEXT5UPLOAD.DEXTMULTIPLEID,0<f.length&&(clearInterval(h),g(f)),e++,10<=e&&(clearInterval(h),fn_createPluginObject(a))}catch(b){clearInterval(h),fn_createPluginObject(a)}},200);else fn_createPluginObject(a)}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else fn_createPluginObject(a)}
function fn_createPluginObject(a){if(!G_dext5plugIn){var b=a.plugin_root+"dext5editor.cab";!a.pluginInstallType||"1"!=a.pluginInstallType.toString()&&"2"!=a.pluginInstallType.toString()||(b="");var c=document.createElement("div");c.style.display="none";var d="";"1"==a.autoPluginUpdate&&(d=b+"#version="+DEXTTOP.DEXT5.util.getRV(a.pv));b='<object id="dext5plugin" classid="CLSID:2A28D4A1-467B-48C7-AF21-51F6D88456BD" codebase="'+d+'" width="0" height="0"><param name="saveFileType" value="">';b+='<param name="serverDomain" value="'+
a.serverDomain+'">';b+='<param name="toSavePathUrl" value="'+a.toSavePathURL+'">';b+='<param name="saveFolderNameRule" value="'+a.saveFolderNameRule+'">';b+='<param name="saveFileNameRule" value="'+a.saveFileNameRule+'">';b+='<param name="productKey" value="'+a.productKey+'">';b+='<param name="licenseKeyUrl" value="'+a.plugin_root+'">';b+='<param name="postPageURL" value="'+a.post_url+'">';b+='<param name="accessibility" value="'+a.accessibility+'">';b+='<param name="trustSitesEx" value="'+a.trustSites+
'">';b+='<param name="licenseKey" value="'+a.LicenseKey+'">';b+='<param name="openDialogTitle" value="'+a.userOpenDlgTitle+'">';b+='<param name="mimeBaseURL" value="'+a.mimeBaseURL+'">';b+='<param name="openDialogType" value="'+a.userOpenDlgType+'">';b+='<param name="openDialogInitDir" value="'+a.userOpenDlgInitDir+'">';b+='<param name="imagePropStyle" value="'+a.userImageDlgStyle+'">';b+='<param name="imgDefaultWidth" value="'+a.imgDefaultWidth+'">';b+='<param name="imgDefaultHeight" value="'+a.imgDefaultHeight+
'">';b+='<param name="officeLineFix" value="'+a.officeLineFix+'">';b+='<param name="systemTitle" value="'+a.system_title+'">';b+='<param name="useLog" value="'+a.useLog+'">';b+='<param name="editphotouse" value="'+a.imageEditorUse+'">';DEXTTOP.DEXT5.util.grvi("p")<=DEXTTOP.DEXT5.util.makeCRV({maj:3,l:23,mi1:"5",mi2:"0"})?(d="",d=-1<a.lang.indexOf("ko")?"ko":-1<a.lang.indexOf("en")?"en":-1<a.lang.indexOf("ja")?"ja":a.lang,b+='<param name="sLang" value="'+d+'">'):b+='<param name="sLang" value="'+a.lang+
'">';d=a.style.skinName;"mono"==d&&(d="gray");b+='<param name="skinName" value="'+d+'">';b+='<param name="sFileDataID" value="'+a.fileFieldID+'">';b+='<param name="sUserFieldID" value="'+a.userFieldID+'">';b+='<param name="sUserFieldValue" value="'+a.userFieldValue+'">';b="1"==a.limitPasteHtmlLength.value&&0<a.limitPasteHtmlLength.length?b+('<param name="nLimitPasteLength" value="'+a.limitPasteHtmlLength.length+'">'):b+'<param name="nLimitPasteLength" value="0">';b+='<param name="sMaxWordFileSize" value="'+
a.openDocument.word.maxSize+'">';b+='<param name="nMaxWordPageSize" value="'+a.openDocument.word.maxPage+'">';b+='<param name="sMaxExcelFileSize" value="'+a.openDocument.excel.maxSize+'">';b+='<param name="nMaxExcelSheetSize" value="'+a.openDocument.excel.maxSheet+'">';b+='<param name="sMaxPowerPointFileSize" value="'+a.openDocument.powerpoint.maxSize+'">';b+='<param name="nMaxPowerPointSlideSize" value="'+a.openDocument.powerpoint.maxSlide+'">';b+='<param name="nWordToHtml" value="1">';b+='<param name="nUseHwpApp" value="'+
a.openDocument.useHwp+'">';b+='<param name="hasContainer" value="'+a.hasContainer+'">';b+='<param name="nUsePostContentType" value="'+a.imgUploadContenttype+'">';"0"!=a.security.encryptParam&&(b+='<param name="nPe" value="'+a.security.encryptParam+'">');"2"==a.viewModeContextMenu&&(b+='<param name="keyInterface" value="ShowIEContextMenu">');b+='<param name="nUseDragDrop" value="'+a.dragAndDropAllow+'">';d="";try{d=window.location.protocol+"//"+window.location.host}catch(e){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}b+='<param name="strCookieURL" value="'+d+'">';b+='<param name="nUseHybrid" value="'+a.useHybrid+'">';b+='<param name="nModalWindow" value="'+a.hybridWindowMode+'">';b+='<param name="strPrintMargin" value="'+a.printMarginltrb+'">';b+='<param name="strKeepVersion" value="'+a.pluginKeepVersion+'">';""!=a.buttonText001&&(b+='<param name="sButtonText001" value="'+a.buttonText001+'">');""!=a.maxImageFileSize&&"0"!=a.maxImageFileSize&&(b+='<param name="sMaxImageFileSize" value="'+
a.maxImageFileSize+'">');b+='<param name="nAllowedMultiImg" value="'+a.insertMultiImage+'">';b+='<param name="sOpenDocFilter" value="'+a.allowOpenFileType+'">';b+='<param name="nExcelImageCorrectly" value="'+a.excelImageFix+'">';""!=a.pluginTempPath&&(b+='<param name="sTempDirRoot" value="'+a.pluginTempPath+'">');b+='<param name="nTempFolderCleanDay" value="'+a.removeTempFolderDataDay+'">';b+='<param name="nImgPopupViewMode" value="'+a.pasteToImagePopupMode+'">';DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&
(b+='<param name="sProtectionMsoStyle" value="mso-spacerun\fmso-border-">');a.fileFilterPlugin&&""!=a.fileFilterPlugin&&(b+='<param name="sOpenImageFilter" value="'+a.fileFilterPlugin+'">');"2"==a.compatibility.hwpProcessTypeInPlugin&&(b+='<param name="nHwpAutomation" value="1">');b+="</object>";c.innerHTML=b;document.body.appendChild(c);G_dext5plugIn=document.getElementById("dext5plugin");if("1"==a.dragAndDropAllow&&"ieplugin"==a.runtimes)var f=setInterval(function(){a.isLoadedEditor&&(setEnableDrapDropFile(),
clearInterval(f))},100)}}function fn_createDialogHelperObject(){if(!G_dialogHelper){var a=document.createElement("div");a.innerHTML='<object id="dlgHelper" classid="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" width="0px" height="0px"></object>';document.body.appendChild(a);G_dialogHelper=document.getElementById("dlgHelper")}}
function requestPluginInstall(a,b,c){var d=null,d=c?c:a.DEXTTOP.G_CURREDITOR._config;a=b.createElement("iframe");a.name="download_frame";a.id="download_frame";a.style.display="none";b.body.appendChild(a);a=b.createElement("form");a.target="download_frame";c="";c=""!=d.pluginInstallUrl?d.pluginInstallUrl:d.plugin_root+d.pluginInstallFileName;a.action=c;b.body.appendChild(a);a.submit();b.body.removeChild(a)}
function fnCommaExec(a){a=a.toString();var b=!1;0===a.indexOf("-")&&(b=!0,a=a.substring(1));if(3<a.length){var c=a.length%3,d=0<c?a.substring(0,c):"";for(i=0;i<Math.floor(a.length/3);i++)d=0==c&&0==i?d+a.substring(c+3*i,c+3*i+3):d+(","+a.substring(c+3*i,c+3*i+3));return b?"-"+d:d}return b?"-"+a:a}
function cleanHTML(a){var b=a.match(RegExp("<img .*?>","ig"));if(b&&0<b.length)for(var c=b.length,d=0;d<c;d++)a=a.replace(b[d].toString(),"<dext_temp_tag"+d+">");a=a.replace(/(\n|\r| class=(")?Mso[a-zA-Z]+(")?)/g," ");a=a.replace(RegExp("\x3c!--(.*?)--\x3e","g"),"");c=RegExp("<(/)*(meta|link|span|\\?xml:|st1:|o:|font)(.*?)>","gi");a=a.replace(c,"");for(var e="style script applet embed noframes noscript".split(" "),d=0;d<e.length;d++)c=new RegExp("<"+e[d]+".*?"+e[d]+"(.*?)>","gi"),a=a.replace(c,"");
c=["style","start"];for(d=0;d<c.length;d++)a=a.replace(new RegExp(" "+c[d]+'="(.*?)"',"gi"),"");if(b&&0<b.length)for(c=b.length,d=0;d<c;d++)a=a.replace("<dext_temp_tag"+d+">",b[d]);return a}function removeCssInSelection(a){a=cleanHTML(a);null!=a&&void 0!=a&&""!=a&&replaceSelectionWithHtml(a)}
function replaceSelectionWithHtml(a){var b=getFirstRange().range;if(1!=b.collapsed){var c=!1,d=!1,e=getContainerForRemoveCss(b.startContainer),f=getContainerForRemoveCss(b.endContainer),g,h=!1;e&&0==!!f&&1==b.endContainer.nodeType&&"BODY"==b.endContainer.tagName&&(f=b.endContainer.childNodes[b.endOffset],g=f.cloneNode(!0),h=!0);b.startContainer==b.endContainer&&1==b.startContainer.nodeType&&"BODY"==b.startContainer.tagName?(e=f=b.startContainer,b.selectNodeContents(e)):DEXTTOP.DEXT5.browser.ie&&9>
DEXTTOP.DEXT5.browser.ieVersion&&3==b.startContainer.nodeType&&1==b.endContainer.nodeType&&"BODY"==b.endContainer.tagName&&(e=f=b.startContainer,b.selectNodeContents(e));b.deleteContents();var m=extractBlockContentsFromCaretForRemoveCss(!0);0==!!g&&(g=extractBlockContentsFromCaretForRemoveCss(!1));if(e!=f){var q=!1,t=!1;findParentNode(f,e)&&(q=!0);findParentNode(e,f)&&(t=!0);t?e=f:q&&(f=e)}var u=_iframeDoc.createElement("div");u.innerHTML=a;a=_iframeDoc.createDocumentFragment();for(var v,q=_iframeDoc.createDocumentFragment(),
t=_iframeDoc.createDocumentFragment(),w=u.childNodes.length,y=0;v=u.firstChild;)y+=1,1==y?a.appendChild(v):1<w&&w==y?(DEXTTOP.DEXT5.browser.ie||""!=v.innerHTML||(v.innerHTML="<br>"),t.appendChild(v),h&&(v=f.cloneNode(!0),v.innerHTML=f.innerHTML,t.appendChild(v))):q.appendChild(v);DEXTTOP.G_CURREDITOR.selectionDextmark[0]=_iframeDoc.createElement("dextmark");DEXTTOP.G_CURREDITOR.selectionDextmark[0].innerHTML=unescape("%u200B");DEXTTOP.G_CURREDITOR.selectionDextmark[1]=_iframeDoc.createElement("dextmark");
DEXTTOP.G_CURREDITOR.selectionDextmark[1].innerHTML=unescape("%u200B");if(e==f){e.innerHTML="";if(m&&0<m.childNodes.length)if(IsEmptyNodes(m))c=!0;else for(;0<m.childNodes.length;)e.appendChild(m.childNodes[0]);else c=!0;!c||"P"!=e.tagName&&"DIV"!=e.tagName||(removeAttribute(e,"align"),removeAttribute(e,"style"),removeAttribute(e,"className"),removeAttribute(e,"bgcolor"));try{b.setStartAfter(e.lastChild)}catch(x){b.selectNodeContents(e)}e.appendChild(DEXTTOP.G_CURREDITOR.selectionDextmark[0]);m=a.childNodes.length;
0<m&&e.appendChild(a);m=q.childNodes.length;0<m&&e.appendChild(q);m=t.childNodes.length;0<m&&e.appendChild(t);e.appendChild(DEXTTOP.G_CURREDITOR.selectionDextmark[1]);e.lastChild?b.setEndAfter(e.lastChild):b.setEnd(e,e.innerHTML.length);g&&0<g.childNodes.length&&e.appendChild(g)}else{e.innerHTML="";f.innerHTML="";if(m&&0<m.childNodes.length)if(IsEmptyNodes(m))c=!0;else for(;0<m.childNodes.length;)e.appendChild(m.childNodes[0]);else c=!0;if(0==c){e.appendChild(DEXTTOP.G_CURREDITOR.selectionDextmark[0]);
try{b.setStartAfter(e.lastChild)}catch(z){b.selectNodeContents(e)}}else b.setStartAfter(e);h=b.cloneRange();if(c)b.insertNode(a),b.insertNode(DEXTTOP.G_CURREDITOR.selectionDextmark[0]),b.setEndBefore(f),b.collapse(!1);else if(0<a.childNodes.length)if(v=a.childNodes[0],checkBlockTag(v.tagName))for(;0<v.childNodes.length;)e.appendChild(v.childNodes[0]);else e.appendChild(a);m=q.childNodes.length;0<m&&(b.setEndBefore(f),b.collapse(!1),b.insertNode(q));g&&(0==g.childNodes.length||IsEmptyNodes(g))&&(d=
!0);if(d)b.setEndBefore(f),b.collapse(!1),b.insertNode(DEXTTOP.G_CURREDITOR.selectionDextmark[1]),b.insertNode(t),b.setEndBefore(f);else{if(0<t.childNodes.length&&(v=t.childNodes[0],checkBlockTag(v.tagName)))if(0<v.childNodes.length)for(;0<v.childNodes.length;)f.appendChild(v.childNodes[0]);else f.appendChild(t);f.lastChild?b.setEndAfter(f.lastChild):b.setEnd(f,f.innerHTML.length)}0==d&&f.appendChild(DEXTTOP.G_CURREDITOR.selectionDextmark[1]);g&&0<g.childNodes.length&&!IsEmptyNodes(g)&&f.appendChild(g);
c?(b.setStartBefore(e),e.parentNode.removeChild(e)):b.setStart(h.startContainer,h.startOffset);d&&(b.setEndAfter(f.previousSibling),f.parentNode.removeChild(f))}setSelectionWithDextmark(b)}}function IsEmptyNodes(a){a=a.childNodes;for(var b=a.length,c=!0,d=null,e=0;e<b;e++){if(d=a[e])3===d.nodeType&&d.nodeValue&&0<d.nodeValue.length?c=!1:1===d.nodeType&&"IMG"!=d.tagName&&(d.hasChildNodes()&&0!=d.innerText.length?c=IsEmptyNodes(d):(d.parentNode.removeChild(a[e]),--e,--b));if(0==c)break}return c}
function setSelectionWithDextmark(a,b){2==DEXTTOP.G_CURREDITOR.selectionDextmark.length?(0==!!a&&(getFirstRange().sel.removeAllRanges(),a=getFirstRange().range),1==b?(a.setStart(DEXTTOP.G_CURREDITOR.selectionDextmark[0],1),a.setEnd(DEXTTOP.G_CURREDITOR.selectionDextmark[1],0)):(a.setStartAfter(DEXTTOP.G_CURREDITOR.selectionDextmark[0]),a.setEndBefore(DEXTTOP.G_CURREDITOR.selectionDextmark[1])),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(a)):0<DEXTTOP.G_CURREDITOR.selectionDextmark.length&&
2!=DEXTTOP.G_CURREDITOR.selectionDextmark.length&&(removeDextmark(),rangy.getSelection(_iframeWin).removeAllRanges())}
function removeDextmark(a){for(var b=_iframeDoc.getElementsByTagName("dextmark"),c=b.length,d=c-1;0<=d;d--){if(d==c-1&&a)if(b[d].previousSibling)try{for(var e=b[d].previousSibling;;){if(null==e){e=e.parentNode;break}if(3==e.nodeType)break;if(e.lastChild)e=e.lastChild;else break}var f=getFirstRange(),g=f.range,h=f.sel;3==e.nodeType?g.setEnd(e,e.length):g.setEndAfter(e);g.collapse(!1);h.removeAllRanges();h.addRange(g)}catch(m){doSetCaretPosition(b[d].previousSibling,1)}else b[d].parentNode&&doSetCaretPosition(b[d].parentNode,
0);b[d].parentNode.removeChild(b[d])}DEXTTOP.G_CURREDITOR.selectionDextmark=[]}function parentTouchEndEvent(a){try{DEXTTOP.G_CURREDITOR._DOC.hasFocus()&&(DEXTTOP.G_CURREDITOR._BODY.blur(),setTimeout(function(){DEXTTOP.window.focus()},1))}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}var G_IsTouchMoved=!1;function touchEndEvent(a){try{G_IsTouchMoved&&setTimeout(setFocusToBody,0),G_IsTouchMoved=!1}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function touchMoveEvent(a){try{G_IsTouchMoved=!0}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function adjustInputChecked(a){var b=a,c="";try{var d=a.match(RegExp("<input *([^>?+])*>","gi"));if(d&&0<d.length){for(var e=d.length,f=0;f<e;f++){a=a.replace(d[f],"<dext_temp_input>");var g=d[f].toString();if(-1<g.toLowerCase().indexOf("radio")&&-1<g.toLowerCase().indexOf("checked=")){var h=">";-1<d[f].indexOf("/>")&&(h="/>");d[f]=g.replace(h,' dext5checked=""'+h)}}for(f=0;f<e;f++)a=a.replace("<dext_temp_input>",d[f].toString())}c=a}catch(m){c=b}return c}
function Dext5_PopupCenter(a,b,c,d,e,f,g,h){a=window.open(a,b,g+", width="+c+", height="+d+", top="+(void 0!=e?e:screen.height/2-d/2-40)+", left="+(void 0!=f?f:screen.width/2-c/2));window.focus&&a&&a.focus();return a}
function closePluginInstall(){var a=getDialogDocument();a.getElementById("d5editor_install_div")&&a.getElementById("d5editor_install_div").parentNode.removeChild(a.getElementById("d5editor_install_div"));a.getElementById("d5editor_install_div_back")&&a.getElementById("d5editor_install_div_back").parentNode.removeChild(a.getElementById("d5editor_install_div_back"));a=getDialogWindow();DEXTTOP.DEXT5.util.removeEvent(a,"resize",DEXTTOP.DEXT5.installGuideResizeEvt)}
function adjustScroll(a){try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion){var b=Math.max(a._DOC.documentElement.scrollLeft,a._DOC.body.scrollLeft),c=Math.max(a._DOC.documentElement.scrollTop,a._DOC.body.scrollTop),d=getClientRect(a._EDITOR.design),e=d.bottom-d.top,f=0,g=0;b>d.right-d.left&&(f=b);c>e&&(g=c);(a._DOC.defaultView?a._DOC.defaultView:a._DOC.parentWindow).scroll(f,g)}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setImageBorder(a,b){try{if(""!=b.borderStyle){var c="";if("none"==b.borderStyle){var d=newNode.style.border;""!=d?0==d.indexOf("0px")||0==d.indexOf("none")?b.borderStyle="":c="0px solid rgb(0,0,0)":b.borderStyle=""}else d="",""!=b.borderKind?d=b.borderKind+" ":(""==b.borderWidth&&(b.borderWidth="0"),d=b.borderWidth+"px "),c=d+b.borderStyle+" "+b.borderColor;""!=c&&(a.style.border=c)}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return a}
function getBorderAndCustomInfo(a){var b={originalSizeCheck:!1,borderJson:{borderStyle:"",borderWidth:"",borderColor:"",borderKind:""},imageText:a};try{var c="",d=a.lastIndexOf(">");-1<d&&(c=a.substring(d+1));""!=c&&(b.imageText=a.substring(0,d+1));0==c.indexOf("|")&&(b.originalSizeCheck=!0,c=c.substring(1));if(-1<c.indexOf("\f")){var e,f,g=c.split("\f");b.borderJson.borderWidth=g[0];f=g[1];"dot"==f?f="dotted":"dash"==f&&(f="dashed");b.borderJson.borderStyle=f;e=g[2];"default"==e?e="":"normal"==e&&
(e="medium");b.borderJson.borderKind=e;b.borderJson.borderColor=g[3]}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return b}
function setAutoBodyFit(a){try{if("1"==a._config.autoBodyFit||G_BodyFit.widthFixStatus){var b=createDefaultStyleNodeForEditorArea(a,{newWordBreak:"normal"==a._setting.word_break_type?"break-all":a._setting.word_break_type,newWordWrap:"break-word;"}),c=getDefaultStyleTag(_iframeDoc,a);if(c)c.parentNode.insertBefore(b,c),c.parentNode.removeChild(c);else{var d=_iframeDoc.getElementsByTagName("head")[0];d&&d.appendChild(b)}}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function removeDivInLiTag(a){var b=getFirstRange().range,c=null,d=!1;if(a)for(var c=[],b=["ol","ul","div"],e=b.length,f=0;f<e;f++){var g=a.getElementsByTagName(b[f]);try{c=c.concat(Array.prototype.slice.call(g,0))}catch(h){for(var m=g.length,q=0;q<m;q++)c.push(g[q])}}else c=getNodesInRange(b);b=c.length;try{for(f=0;f<b;f++)if(c[f].tagName&&"DIV"==c[f].tagName&&c[f].parentNode&&c[f].parentNode.tagName&&"LI"==c[f].parentNode.tagName){d=!0;break}}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&
RAONWIZDLW()}if(d){0==!!a&&makeRangeSelectionMarkInDesign();try{for(var u=c.length,d=0;d<u;d++){var v=c[d].nodeName.toLowerCase();if("ol"==v||"ul"==v){for(var w=c[d].getElementsByTagName("li"),y=w.length,u=0;u<y;u++)w[u].firstChild&&w[u].firstChild.tagName&&"DIV"==w[u].firstChild.tagName&&(w[u].innerHTML=w[u].firstChild.innerHTML,5>w[u].innerHTML.length&&0==w[u].innerHTML.indexOf("<br")&&(w[u].innerHTML=""));break}}}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}0==!!a&&setRangeSelectionMarkInDesign(!0)}}
function isSelected(a){var b=!1;try{var c=null,c=a?a:getFirstRange().range;if(c.startContainer!=c.endContainer||c.startOffset!=c.endOffset)b=!0}catch(d){b=!1}return b}
function correctionRange(a){DEXTTOP.DEXT5.browser.chrome&&a.startContainer==a.endContainer&&a.startOffset==a.endOffset&&a.startContainer.tagName&&"br"==a.startContainer.tagName.toLowerCase()&&(a.setStartBefore(a.startContainer),a.setEndAfter(a.startContainer),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(a))}
function removeTagStyle(a){if("1"==DEXTTOP.G_CURREDITOR._config.removeStyle.use)if(""==DEXTTOP.G_CURREDITOR._config.removeStyle.tag)for(var b=DEXTTOP.G_CURREDITOR._config.removeStyle.style.split(","),c=b.length,d=0;c>d;d++)""!=b[d]&&(a=a.replace(new RegExp(b[d]+':(([^;"]*;)|([^"]*))',"gi"),""));else for(var e=DEXTTOP.G_CURREDITOR._config.removeStyle.tag.split(","),f=e.length,b=DEXTTOP.G_CURREDITOR._config.removeStyle.style.split(","),c=b.length,d=0;f>d;d++)if(""!=e[d])for(var g=0;c>g;g++)""!=b[g]&&
(a=a.replace(new RegExp("(<"+e[d]+"[^>]*)("+b[g]+':(([^;"]*;)|([^"]*)))',"gi"),"$1"));return a}function displayPageBreak(a){var b=null,c="";a?(b=getElementsByClass("DEXT_fiVe_Page_Break_None",_iframeDoc),c="DEXT_fiVe_Page_Break"):(b=getElementsByClass("DEXT_fiVe_Page_Break",_iframeDoc),c="DEXT_fiVe_Page_Break_None");a=b.length;for(var d=0;a>d;d++)b[d].className=c}
function getPersonalData(a){var b={};try{var c=getInnerText(_iframeDoc.body);"undefined"==typeof DEXT_PERSONAL_DATA_CONFIG&&(DEXT_PERSONAL_DATA_CONFIG={},-1<a._config.personalData.toLowerCase().indexOf("email")&&(DEXT_PERSONAL_DATA_CONFIG.email={regexp:RegExp("[_A-Za-z0-9-\\\\+]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})","ig")}),-1<a._config.personalData.toLowerCase().indexOf("phone")&&(DEXT_PERSONAL_DATA_CONFIG.phone={regexp:RegExp("((\\+\\d{1,3}(-| |\\.)?\\(?\\d\\)?(-| |\\.)?\\d{1,5})|(\\d{2,6}\\)?))(-| |\\.)?(\\d{3,4})(-| |\\.)?(\\d{4})",
"g"),ignore:/(:?^\d{6}-\d{7})/}),-1<a._config.personalData.toLowerCase().indexOf("rrn")&&(DEXT_PERSONAL_DATA_CONFIG.rrn={regexp:RegExp("(\\d{2}(:?1[0-2]|0[1-9])(:?0[1-9]|[1-2]\\d|3[0-1])-?[1-4]\\d{6})","gm")}));for(var d in DEXT_PERSONAL_DATA_CONFIG)try{if(b[d]=c.match(DEXT_PERSONAL_DATA_CONFIG[d].regexp),b[d]&&DEXT_PERSONAL_DATA_CONFIG[d].ignore){for(var e=b[d].length-1;0<=e;e--)DEXT_PERSONAL_DATA_CONFIG[d].ignore.test(b[d][e])&&b[d].splice(e,1);0==b[d].length&&(b[d]=null)}}catch(f){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return b}function getForbiddenWord(a){dext_src_init(a._EDITOR.design);var b=null;try{var c=getInnerText(_iframeDoc.body),d=a._config.forbiddenWord.split(","),e=d.length;for(a=0;a<e;a++){var f=null;(f=c.match(new RegExp(""+d[a]+"","ig")))&&(b=b?b.concat(f):f)}}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return b}
function getInnerText(a,b){var c="";try{c=a.innerHTML,c=c.replace(/\r/g,""),c=c.replace(/[\n|\t]/g,""),c=c.replace(/[\v|\f]/g,""),c=c.replace(/<span[^>]*>/gi,""),c=c.replace(/<\/span(\s[^\/]*)?>/gi,""),c=c.replace(/<p[^>]*><br><\/p(\s[^\/]*)?>/gi,"\n"),b||(c=c.replace(/<p[^>]*>&nbsp;<\/p(\s[^\/]*)?>/gi,"\n")),c=c.replace(/<br(\s)*\/?><\/p(\s[^\/]*)?>/gi,"\n"),c=c.replace(/<br(\s[^\/]*)?><\/p(\s[^\/]*)?>/gi,"\n"),c=c.replace(/<br(\s)*\/?><\/li(\s[^\/]*)?>/gi,"\n"),c=c.replace(/<br(\s[^\/]*)?><\/li(\s[^\/]*)?>/gi,
"\n"),c=c.replace(/<br(\s)*\/?>/gi,"\n"),c=c.replace(/<br(\s[^\/]*)?>/gi,"\n"),c=c.replace(/<\/p(\s[^\/]*)?>/gi,"\n"),c=c.replace(/<\/li(\s[^\/]*)?>/gi,"\n"),c=c.replace(/<\/tr(\s[^\/]*)?>/gi,"\n"),c=ReplaceAll(c,unescape("%u200B"),""),c=removeStripTags(c,null),c=unhtmlSpecialChars(c)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}
function removeFindText(a,b){try{dext_src_init(b)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}restoreSelection();setFocusToBody();if(0!=a.length)try{var d=rangy.createRange(_iframeDoc);d.selectNodeContents(_iframeDoc.body);for(var e={caseSensitive:!1,wholeWordsOnly:!1,direction:"forward"};d.findText(a,e);){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();d.select();d.deleteContents();try{var f="dexttemp",g=_iframeDoc.createElement(f);d.insertNode(g);
d.setStartBefore(g);d.setEndBefore(g);g.parentNode.removeChild(g)}catch(h){for(var m=_iframeDoc.getElementsByTagName(f),q=m.length-1;0<=q;q--){var t=m[q];t.parentNode.removeChild(t)}}var u=getFirstRange().range.commonAncestorContainer;!u||1!=u.nodeType||""!=u.innerText&&" "!=u.innerText||(u.innerHTML="&nbsp;");d=rangy.createRange(_iframeDoc);d.selectNodeContents(_iframeDoc.body);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}onChange({editor:DEXTTOP.G_CURREDITOR,
isPossibleDirty:!0})}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function canConversion(){var a=!0,b;try{b=getFirstRange().range,"BODY"==b.commonAncestorContainer.tagName&&1<b.commonAncestorContainer.childNodes.length&&(a=!1),a&&-1<b.text().indexOf("\n")&&(a=!1)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return a}
function getCheckSpelling(a){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();if(null!=a.DEXT5WordApp){var b=_iframeDoc.body.innerText,b=b.replace(/[\r\n]+/gi,"\n"),b=b.split("\n"),c=b.length,d=[];try{for(var e=0;e<c;++e){var f=[],g=b[e];if(!/^\s*$/.test(g)&&!a.DEXT5WordApp.Application.CheckSpelling(g)){a.DEXT5WordDoc.Content=g;for(var h=1;h<=a.DEXT5WordDoc.SpellingErrors.Count;h++)for(var m=a.DEXT5WordDoc.SpellingErrors.Item(h),q=m.Words.Count,t=1;t<=q;t++){var u=m.Words.Item(t),
v={};v.word=DEXTTOP.DEXT5.util.trim(u.Text);v.start=u.Start;v.length=DEXTTOP.DEXT5.util.trim(u.Text).length;v.suggestions=[];for(var w=u.GetSpellingSuggestions(),y=w.Count,x=1;x<=y;x++)v.suggestions.push(w.Item(x).Name);0<y&&1<DEXTTOP.DEXT5.util.trim(v.word).length&&f.push(v)}0<f.length&&(d=d.concat(f))}}}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}finally{a.DEXT5WordApp&&a.DEXT5WordApp.Quit(0),a.DEXT5WordApp=null,a.DEXT5WordDoc=null}return d}}
function getAllTextNodeByNode(a){var b=[];if(a)for(a=a.firstChild;null!=a;)3==a.nodeType?b[b.length]=a:b=b.concat(getAllTextNodeByNode(a)),a=a.nextSibling;return b}
function putUndoWordCount(a){if("1"==DEXTTOP.G_CURREDITOR._config.wordCount.use&&"1"==DEXTTOP.G_CURREDITOR._config.wordCount.limit&&"undefined"!=typeof a){var b="which"in a?a.which:a.keyCode;if(b&&(-1==",18,19,20,27,33,34,35,36,37,38,39,40,91,92,93,144,145,".indexOf(","+b+",")||a.shiftKey&&16!=b))try{if(0<DEXTTOP.G_CURREDITOR._config.wordCount.limitcount||0<DEXTTOP.G_CURREDITOR._config.wordCount.limitline){var c=DEXTTOP.G_CURREDITOR._config.wordCount.limitcount,d=DEXTTOP.G_CURREDITOR._config.wordCount.limitline,
e=getInnerText(_iframeDoc.body,!0);a=0;e.match(/\n/gi)&&(a=e.match(/\n/gi).length);e=e.replace(/\r\n/gi,"");e=e.replace(/\n/gi,"");0==DEXTTOP.G_CURREDITOR._config.wordCount.countwhitespace&&(e=e.replace(/\s/gim,""));var b=!1,f;f="char"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?e.length:DEXTTOP.DEXT5.getByteLength(e);"byte"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit&&0<c&&f+3>c?b=!0:0<c&&f==c?b=!0:0<d&&a==d&&(b=!0);b&&0<c&&f>c&&(b=!1);b&&(DEXTTOP.G_CURREDITOR.WordCountUndoManager.reset(),
DEXTTOP.G_CURREDITOR.WordCountUndoManager.putUndo())}}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}
function showWordCount(a){try{if("1"==DEXTTOP.G_CURREDITOR._config.wordCount.use&&(0<=DEXTTOP.G_CURREDITOR._config.wordCount.limitcount||0<DEXTTOP.G_CURREDITOR._config.wordCount.limitline)){if("undefined"!=typeof a){var b="which"in a?a.which:a.keyCode;if(0<=",18,19,20,27,33,34,35,36,37,38,39,40,91,92,93,144,145,".indexOf(","+b+",")||a.shiftKey&&16==b)return}var c=DEXTTOP.G_CURREDITOR._config.wordCount.limitcount,d=DEXTTOP.G_CURREDITOR._config.wordCount.limitline,e=getInnerText(_iframeDoc.body,!0);
a=0;e.match(/\n/gi)&&(a=e.match(/\n/gi).length);e=e.replace(/\r\n/gi,"");e=e.replace(/\n/gi,"");0==DEXTTOP.G_CURREDITOR._config.wordCount.countwhitespace&&(e=e.replace(/\s/gim,""));b=!0;""!=DEXTTOP.G_CURREDITOR._config.defaultMessage&&(b=!1);var f="",g=dext5_lang.wordCount.Maximum_Line_Exceed.replace("{0}",d),f="byte"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?dext5_lang.wordCount.Maximum_Bytes_Exceed.replace("{0}",c):dext5_lang.wordCount.Maximum_Characters_Exceed.replace("{0}",c);if(b){var h;
h="char"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?e.length:DEXTTOP.DEXT5.getByteLength(e);if(0<c&&h>c||0<d&&a>d){if("1"==DEXTTOP.G_CURREDITOR._config.wordCount.limitmessage){var m="";0<c&&h>c&&(m=f+"\n");0<d&&a>d&&(m+=g);alert(m)}0==DEXTTOP.G_CURREDITOR.WordCountUndoManager.charCount&&DEXTTOP.G_CURREDITOR.WordCountUndoManager.putUndo();DEXTTOP.G_CURREDITOR.WordCountUndoManager.execUndo()}}b&&(e=getInnerText(_iframeDoc.body,!0),a=0,e.match(/\n/gi)&&(a=e.match(/\n/gi).length),e=e.replace(/\r\n/gi,
""),e=e.replace(/\n/gi,""),0==DEXTTOP.G_CURREDITOR._config.wordCount.countwhitespace&&(e=e.replace(/\s/gim,"")));g="";0<d&&(g="/"+d);var q="["+dext5_lang.wordCount.Line+a+g+"]",t=document.getElementById("count_line_span_"+DEXTTOP.G_CURREDITOR.ID);t.innerHTML=q;t.style.color=0!=d&&a>=d?"red":"black";d="";0<c&&(d="/"+c);h="char"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?e.length:DEXTTOP.DEXT5.getByteLength(e);var e="",e="byte"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?"["+dext5_lang.wordCount.Bytes+
h+d+"]":"["+dext5_lang.wordCount.Characters+h+d+"]",u=document.getElementById("count_characters_span_"+DEXTTOP.G_CURREDITOR.ID);u.innerHTML=e;u.style.color=0!=c&&h>=c?"red":"black"}}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function pasteWordCount(a){var b=!0;if("1"==DEXTTOP.G_CURREDITOR._config.wordCount.use&&"1"==DEXTTOP.G_CURREDITOR._config.wordCount.limit)try{if(0<DEXTTOP.G_CURREDITOR._config.wordCount.limitcount||0<DEXTTOP.G_CURREDITOR._config.wordCount.limitline){var c=DEXTTOP.G_CURREDITOR._config.wordCount.limitcount,d=DEXTTOP.G_CURREDITOR._config.wordCount.limitline,e=getInnerText(_iframeDoc.body,!0),f=document.createElement("div");f.innerHTML=a;a=getInnerText(f,!0);e.match(/\n/gi);a.match(/\n/gi)&&a.match(/\n/gi);
e=e.replace(/\r\n/gi,"");e=e.replace(/\n/gi,"");a=a.replace(/\r\n/gi,"");a=a.replace(/\n/gi,"");0==DEXTTOP.G_CURREDITOR._config.wordCount.countwhitespace&&(e=e.replace(/\s/gim,""),a=a.replace(/\s/gim,""));var g,h,m;"char"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?(g=e.length,h=a.length,m=getFirstRange().range.toString().length):(g=DEXTTOP.DEXT5.getByteLength(e),h=DEXTTOP.DEXT5.getByteLength(a),m=DEXTTOP.DEXT5.getByteLength(getFirstRange().range.toString()));a="";dext5_lang.wordCount.Maximum_Line_Exceed.replace("{0}",
d);a="byte"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?dext5_lang.wordCount.Maximum_Bytes_Exceed.replace("{0}",c):dext5_lang.wordCount.Maximum_Characters_Exceed.replace("{0}",c);0<c&&c<g-m+h&&("1"==DEXTTOP.G_CURREDITOR._config.wordCount.limitmessage&&alert(a),b=!1)}}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return b}
function pushAutoSave(a,b,c){for(;b<parseIntOr0(c)-1;b++){var d=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage(a+"_"+(b+1));""!=d&&null!=d&&void 0!=d&&(DEXTTOP.DEXT5.util.saveJsonToLocalStorage(a+"_"+b,d),localStorage.removeItem(a+"_"+(b+1)))}}function delAutoSaveHtml(a,b,c){localStorage.removeItem(a+"_"+b);pushAutoSave(a,b,c);return null==localStorage[a+"_"+b]||void 0==localStorage[a+"_"+b]?!1:!0}
function localSaveValue(a,b,c){for(var d=0;d<parseIntOr0(c);d++){var e=a+"_"+d,f=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage(e),g={};null!=f&&void 0!=f&&(g="",g=f.html.toLowerCase().indexOf("<html"),g="1"==b?-1<g?DEXTTOP.DEXT5.util._fn_$mEP(f.html):f.html:0>g?DEXTTOP.DEXT5.util._fn_$mDRM(f.html):f.html,g={date:f.date,html:g},localStorage.removeItem(e),DEXTTOP.DEXT5.util.saveJsonToLocalStorage(e,g))}}
function autoSaveEnable(a){if(a=document.getElementById("dext_span_"+a+"load_auto_save")){var b=DEXTTOP.DEXT5.util.getClass(a);b&&-1<b.indexOf("_off")&&DEXTTOP.DEXT5.util.setClass(a,"uebutton_span_on")}}
function setImageSizeForProperty(){for(var a=_iframeDoc.body.getElementsByTagName("img"),b=a.length,c=0;c<b;c++){var d=a[c];try{var e=d.style.width,f=d.style.height;if(-1<e.indexOf("px"))e=DEXTTOP.DEXT5.util.parseIntOr0(e);else var g=getClientRect(d),e=DEXTTOP.DEXT5.util.parseIntOr0(g.right-g.left);-1<f.indexOf("px")?f=DEXTTOP.DEXT5.util.parseIntOr0(f):(g=getClientRect(d),f=DEXTTOP.DEXT5.util.parseIntOr0(g.bottom-g.top));d.setAttribute("width",e);d.setAttribute("height",f)}catch(h){d.removeAttribute("width"),
d.removeAttribute("height")}}}
function removeBackgroundColorInNodes(a,b,c){for(var d=_iframeDoc.createElement("div"),e=a.childNodes.length,f=0;f<e;f++){var g=a.childNodes[f];1==g.nodeType?("P"==g.tagName&&""==g.innerHTML&&("xp"==DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?g.innerHTML=unescape("%uFEFF"):g.innerHTML=DEXTTOP.DEXT5.browser.ie?unescape("%u200B"):"<br>"),d.innerHTML+=g.outerHTML):3==g.nodeType&&(d.innerHTML+=g.data)}d.innerHTML=CleanZeroChar(d.innerHTML);a=[];e=d.getElementsByTagName("*");g=e.length;for(f=0;f<
g;f++){var h=e[f].tagName.toLowerCase();0>c.indexOf(","+h+",")&&""!=e[f].style.backgroundColor&&(e[f].style.removeAttribute?e[f].style.removeAttribute(b):"backgroundColor"==b&&e[f].style.removeProperty("background-color"),void 0!=e[f].style.length?0==e[f].style.length&&1==e[f].attributes.length&&a.push(e[f]):(h=e[f].outerHTML.toLowerCase(),"span"==e[f].tagName.toLowerCase()&&0==h.indexOf("<"+e[f].tagName.toLowerCase()+">")&&a.push(e[f])))}for(f=a.length-1;0<=f;f--){for(;a[f].firstChild;)a[f].parentNode.insertBefore(a[f].firstChild,
a[f]);a[f].parentNode.removeChild(a[f])}return d}
function getApplyNodes(a){try{var b=getFirstRange().range,c,d;c=1==b.collapsed?[b.startContainer]:b.getNodes();if(1==c.length){var e=c[0];if(!(e.tagName&&-1<a.indexOf(e.tagName.toLowerCase())))for(;e=e.parentNode,!e.tagName||"body"!=e.tagName.toLowerCase();)if(e.tagName&&-1<a.indexOf(e.tagName.toLowerCase())){c=[e];break}}else{for(var f=c[0],g=c[c.length-1],e=f,h=g;!e.tagName||"body"!=e.tagName.toLowerCase();){if(e.tagName&&-1<a.indexOf(e.tagName.toLowerCase())){f=e;break}e=e.parentNode}for(;!h.tagName||
"body"!=h.tagName.toLowerCase();){if(h.tagName&&-1<a.indexOf(h.tagName.toLowerCase())){g=h;break}h=h.parentNode}f==g&&(c=[f])}null!=b.startContainer.previousSibling&&"HEAD"==b.startContainer.previousSibling.tagName&&null==b.endContainer.nextSibling&&(c=b.getNodes());if(0==b.collapsed&&1<c.length&&1==c[0].nodeType&&"P"==c[0].tagName){var m=c[0].innerText||c[0].textContent;3==b.startContainer.nodeType&&null==b.startContainer.nextSibling&&(m=b.startContainer.nodeValue);f=!1;m.length==b.startOffset&&
(f=!0);!f&&DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&2<=c.length&&0<b.startOffset&&3!=c[1].nodeType&&1==b.startContainer.nodeType&&(f=!0);f&&(b.setStartAfter(c[0]),c=b.getNodes())}d=c.length;b=[];for(m=0;m<d;m++)null!=c[m].parentNode&&1==c[m].nodeType&&c[m].tagName&&"body"!=c[m].tagName.toLowerCase()&&c[m].tagName&&-1<a.indexOf(c[m].tagName.toLowerCase())&&b.push(c[m]);return b}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function mouseMoveCaret(a,b){if(DEXTTOP.DEXT5.browser.ie)try{if(_iframeDoc.caretPositionFromPoint){var c=_iframeDoc.caretPositionFromPoint(a,b),d=_iframeDoc.createRange();d.setStart(c.offsetNode,c.offset);d.collapse()}else if(_iframeDoc.caretRangeFromPoint)d=_iframeDoc.caretRangeFromPoint(a,b);else if(_iframeDoc.body.createTextRange){var d=_iframeDoc.body.createTextRange();d.moveToPoint(a,b);d.select()}var e=_iframeDoc.getElementById("raonCaretTemp");e&&e.parentNode.removeChild(e);d.pasteHTML('<span id="raonCaretTemp" style="border:1px solid red;"></span>')}catch(f){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else if(c=getFirstRange().range,1==c.collapsed)try{createSelectionFromPoint(a,b,a,b);setFocusToBody();(e=_iframeDoc.getElementById("raonCaretTemp"))&&e.parentNode.removeChild(e);var c=getFirstRange().range,g=_iframeDoc.createElement("span");g.id="raonCaretTemp";g.style.border="1px solid red";c.insertNode(g);null!=g.nextSibling&&doSetCaretPosition(g.nextSibling,!1)}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setUserSetting(a,b){if(DEXTTOP.DEXT5.browser.LocalStorageSupported){var c="",d="";"personalSetting"==b?(c="dext_personal_setting",d={fontFamily:a._setting.personal_font_family.toString(),fontSize:a._setting.personal_font_size.toString(),lineHeight:a._setting.personal_line_height.toString(),pasteToImage:a._setting.personal_paste_to_image}):"lineBreak"==b&&"1"==a._config.saveLineBreakToLocalStorage&&(c="dext_"+a.ID+"_line_break",d={word_break_type:a._setting.word_break_type.toString(),word_wrap_type:a._setting.word_wrap_type.toString()});
DEXTTOP.DEXT5.util.saveJsonToLocalStorage(c,d)}}function createNodeForCaret(a){for(var b=[],c=0;c<a;c++){var d=_iframeDoc.createElement("dextmark");d.setAttribute("class","dext_temp_caret");d.innerHTML=unescape("%u200B");b.push(d)}return b}function removeNodeForCaret(){for(var a=getElementsByClass("dext_temp_caret",_iframeDoc,"dextmark"),b=a.length-1;0<=b;b--)a[b].parentNode.removeChild(a[b])}
function canMoveLiNode(a,b){var c=!1;if(1==b){var d=a.previousSibling;d&&(d=d.tagName,"LI"==d||"OL"==d||"UL"==d)&&(c=!0)}return c}
function moveLiNode(a,b){var c=a.previousSibling;if(1==b){if(c){var d=c.tagName,e;if("LI"==d)e=c.getElementsByTagName(c.parentNode.tagName),d=c.innerHTML,d=d.replace(/(<([^>]+)>)/ig,""),"<br>"!=d&&""!=d||c.removeChild(c.firstChild),0<e.length?e=e[0]:(e=_iframeDoc.createElement(c.parentNode.tagName),e.style.listStyleType=getNextOlUlListStyle(c.parentNode),c.appendChild(e)),e.appendChild(a);else if("OL"==d||"UL"==d)e=c,e.appendChild(a);c=e.parentNode.innerHTML;c=c.replace(/<[oul].*/gim,"");c=c.replace(/[\r\n]/gim,
"");0>c.indexOf(unescape("%u200B"))&&(c=_iframeDoc.createTextNode(unescape("%u200B")),e.parentNode.insertBefore(c,e));setChildOlUlListStyle(a)}}else{e=a.parentNode;for(var c=e.parentNode,d=getFirstRange().range,f=a;null!=f.nextSibling;)f=f.nextSibling;d.setStartBefore(a);d.setEndAfter(f);for(var g=d.extractContents(),d=g.childNodes.length,f=[],h=d-1;0<=h;h--)f.push(g.childNodes[h]);for(var m=f[f.length-1].childNodes,q=m.length,g=null,t=[],h=0;h<q;h++)if("OL"==m[h].tagName||"UL"==m[h].tagName){g=m[h];
break}else t.push(m[h]);q=t.length;"LI"==c.tagName?(m=c.cloneNode(),m.innerHTML=""):m=_iframeDoc.createElement("p");for(h=0;h<q;h++)m.appendChild(t[h]);"LI"==c.tagName?(h=c.parentNode,c.nextSibling?h.insertBefore(m,c.nextSibling):h.appendChild(m)):e.nextSibling?c.insertBefore(m,e.nextSibling):c.appendChild(m);t=e.cloneNode();t.innerHTML="";if(g){q=g.childNodes;for(h=q.length-1;0<=h;h--)t.firstChild?t.insertBefore(q[h],t.firstChild):t.appendChild(q[h]);g.parentNode.removeChild(g)}for(h=d-2;0<=h;h--)t.appendChild(f[h]);
for(d=!1;e.firstChild;)if(e.firstChild&&"DEXTMARK"==e.firstChild.tagName)e.removeChild(e.firstChild);else{d=!0;break}0==d&&c.removeChild(e);0!=t.hasChildNodes()&&("LI"==m.tagName?(m.appendChild(t),setChildOlUlListStyle(m)):(m.nextSibling?c.insertBefore(t,m.nextSibling):c.appendChild(t),setChildOlUlListStyle(t)))}}
function getNextOlUlListStyle(a){var b="",b=a.tagName.toLowerCase();a=a.style.listStyleType.toLowerCase();return b="ol"==b?DEXTTOP.G_CURREDITOR._config.olListStyleTypeSequence[a]?DEXTTOP.G_CURREDITOR._config.olListStyleTypeSequence[a]:"upper-alpha":DEXTTOP.G_CURREDITOR._config.ulListStyleTypeSequence[a]?DEXTTOP.G_CURREDITOR._config.ulListStyleTypeSequence[a]:"circle"}
function setChildOlUlListStyle(a){var b=[],c=a.tagName;if("LI"==c)b=a.getElementsByTagName(a.parentNode.tagName);else if("OL"==c||"UL"==c)for(var d=a.getElementsByTagName(c),e=d.length,c=0;c<e;c++)0==c&&b.push(a),b.push(d[c]);a=b.length;for(c=0;c<a;c++)if(d=b[c],e=GetParentbyTagName(d.parentNode,d.tagName.toLowerCase()))d.style.listStyleType=getNextOlUlListStyle(e)}var G_LastNodeForLi=null,G_IsMulitSelectionInLi=!1;
function checkLastCaretForLi(a,b){if(3==a.nodeType&&a.nodeValue.length==b.endOffset)isLastOfNode=!0;else if(1==a.nodeType){var c=a.childNodes[b.endOffset];3==c.nodeType&&(b=getFirstRange().range,c.nodeValue.length!=b.endOffset||null!=c.nextSibling&&"OL"!=c.nextSibling.tagName&&"UL"!=c.nextSibling.tagName||(isLastOfNode=!0))}}
function adjustLiNodeForArrowKey(a,b,c,d){b=getFirstRange().range;if("keydown"==a)if(1==b.collapsed){G_IsMulitSelectionInLi=!1;var e=b.startContainer,f=e;3==f.nodeType&&(f=f.parentNode);a=GetParentbyTagName(f,"li");if("OL"==f.tagName||"UL"==f.tagName)a=f.getElementsByTagName("li")[0];G_LastNodeForLi=a?a:null;if(a)if(13==c)if("LI"==a.parentNode.parentNode.tagName){if(e=a.innerHTML,e=e.replace(/(<([^>]+)>)/ig,""),""==e||e==unescape("%u200B")||"<br>"==e)DEXTTOP.DEXT5.util.cancelEvent(d),d=a.cloneNode(),
d.id="",d.innerHTML=unescape("%u200B"),a.nextSibling?a.parentNode.insertBefore(d,a.nextSibling):a.parentNode.appendChild(d),b.setStartBefore(d.firstChild),b.setEndBefore(d.firstChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b)}else 0!=DEXTTOP.DEXT5.browser.ie||null!=a.previousSibling||null!=a.nextSibling||""!=a.innerHTML&&a.innerHTML!=unescape("%u200B")&&"<br>"!=a.innerHTML||(DEXTTOP.DEXT5.util.cancelEvent(d),moveLiNode(a,0));else if(8==c){if(0==b.startOffset){a=
!1;for(e=3==e.nodeType?e.parentNode:e;;){if("LI"==e.tagName){a=!0;break}if("BODY"==e.tagName)break;if(e.parentNode.firstChild!=e)break;e=e.parentNode}if(a){("<br>"==e.innerHTML||"<br />"==e.innerHTML)&&e.firstChild&&e.removeChild(e.firstChild);a=e;var e=null,g=a.previousSibling;if(g){var e=g.getElementsByTagName("OL"),h=e.length,g=g.getElementsByTagName("UL");c=g.length;0<h||0<c?(f=null,0<h&&0==c?f=e[h-1]:0<c&&0==h&&(f=g[c-1]),e=f.lastChild):e=a.previousSibling}else"LI"==a.parentNode.parentNode.tagName&&
a.parentNode.previousSibling&&(e=a.parentNode.parentNode);if(e){DEXTTOP.DEXT5.util.cancelEvent(d);for(d=null;a.hasChildNodes();)null==d&&(d=a.firstChild),a.parentNode.parentNode==e?e.insertBefore(a.firstChild,a.parentNode):e.appendChild(a.firstChild);h=a.parentNode;h.removeChild(a);0==h.getElementsByTagName("li").length&&h.parentNode.removeChild(h);d?(b.setStartBefore(d),b.setEndBefore(d)):(d=e.lastChild)?(b.setStartAfter(d),b.setEndAfter(d)):(d=_iframeDoc.createTextNode("%u200B"),e.appendChild(d),
b.setStartBefore(d),b.setEndBefore(d),e.removeChild(d));rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b);setChildOlUlListStyle(e)}}}}else if(46==c&&(c=!1,3==e.nodeType?e.nodeValue.length==b.endOffset?c=!0:e.nodeValue==unescape("%u200B")&&e.nodeValue.length==b.endOffset+1&&(c=!0):1==e.nodeType&&(b=getFirstRange().range,f=b.endContainer,3==f.nodeType?g=f.nodeValue.length:1==f.nodeType&&(g=f.childNodes.length,f.childNodes[b.endOffset]&&(1==f.childNodes[b.endOffset].nodeType&&
"BR"==f.childNodes[b.endOffset].tagName?--g:3==f.childNodes[b.endOffset].nodeType&&f.childNodes[b.endOffset].nodeValue==unescape("%u200B")&&--g)),g==b.endOffset&&(null==f.nextSibling||"OL"==f.nextSibling.tagName||"UL"==f.nextSibling.tagName?(e=f,c=!0):"LI"==f.tagName&&(e=f,c=!0))),c)){for(g=c=!1;;){if(e.parentNode&&"LI"==e.parentNode.tagName){e.parentNode.lastChild==e?c=!0:!e.nextSibling||"OL"!=e.nextSibling.tagName&&"UL"!=e.nextSibling.tagName||(g=c=!0);break}if(null==e.parentNode||"BODY"==e.parentNode.tagName)break;
e=e.parentNode}c&&(h=null,g?h=e.nextSibling:a.nextSibling?h=a.nextSibling:a.parentNode.parentNode.nextSibling?h=a.parentNode.parentNode.nextSibling:DEXTTOP.DEXT5.util.cancelEvent(d));if(h){DEXTTOP.DEXT5.util.cancelEvent(d);e=null;e=g?h.getElementsByTagName("li")[0]:h;for(d=null;e.hasChildNodes();)null==d&&(d=e.firstChild),g?h.parentNode.insertBefore(e.firstChild,h):a.appendChild(e.firstChild);h=e.parentNode;h.removeChild(e);g&&0==h.hasChildNodes()&&h.parentNode.removeChild(h);setChildOlUlListStyle(a);
d&&(b.setStartBefore(d),b.setEndBefore(d),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b))}}}else!DEXTTOP.DEXT5.browser.ie||13!=c&&8!=c&&46!=c||(f=e=b.startContainer,3==f.nodeType&&(f=f.parentNode),a=GetParentbyTagName(f,"li"),b=b.endContainer,3==b.nodeType&&(b=b.parentNode),b=GetParentbyTagName(b,"li"),(a||b)&&a!=b&&(isMulitSelectionInLi=!0,DEXTTOP.DEXT5.util.cancelEvent(d),alert(dext5_lang.msg.canNotDeleteLi)));else if("keyup"==a&&1==b.collapsed)if(f=
e=b.startContainer,3==f.nodeType&&(f=f.parentNode),a=GetParentbyTagName(f,"li"),G_LastNodeForLi&&a&&G_LastNodeForLi!=a)if(d=a.innerHTML,d=d.replace(/<[oul].*/gim,""),d=d.replace(/[\r\n]/gim,""),""==d&&(d=_iframeDoc.createTextNode(unescape("%u200B")),a.firstChild?a.insertBefore(d,a.firstChild):a.appendChild(d),d=unescape("%u200B")),-1<d.indexOf(unescape("%u200B")))d==unescape("%u200B")?(b.setStartBefore(a.firstChild),b.setEndBefore(a.firstChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b)):
3==e.nodeType?(d=e.nodeValue.indexOf(unescape("%u200B")),0==d&&1==e.nodeValue.length?((d=e.previousSibling)?3==d.nodeType&&(b.setStart(d,d.nodeValue.length),b.setEnd(d,d.nodeValue.length)):(b.setStartBefore(e),b.setEndBefore(e)),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b)):-1<d&&b.startOffset-1==d&&(b.setStart(e,b.startOffset-1),b.setEnd(e,b.startOffset-1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b))):
1==e.nodeType&&(e=e.childNodes[b.startOffset-1],b.setStart(e,e.nodeValue.length-1),b.setEnd(e,e.nodeValue.length-1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b));else{if(e=null,0>d.indexOf(unescape("%u200B"))){a=a.childNodes;h=a.length;for(d=0;d<h;d++)if(a[d].tagName&&("OL"==a[d].tagName||"UL"==a[d].tagName)){e=a[d];break}e&&(d=_iframeDoc.createTextNode(unescape("%u200B")),e.parentNode.insertBefore(d,e),b.setStartBefore(d),b.setEndBefore(d),rangy.getSelection(_iframeWin).removeAllRanges(),
rangy.getSelection(_iframeWin).addRange(b))}}else if(a)if(39==c){if(3==e.nodeType&&(d=e.nodeValue.indexOf(unescape("%u200B")),-1<d&&b.startOffset>d)){e=null;h=a.childNodes;g=h.length;for(d=0;d<g;d++)if(h[d].tagName&&("OL"==h[d].tagName||"UL"==h[d].tagName)){e=h[d];break}h=null;e?h=e.getElementsByTagName("li")[0]:a.nextSibling&&(h=a.nextSibling);h&&(h.firstChild?(e=h.firstChild,b.setStartBefore(e),b.setEndBefore(e)):(e=_iframeDoc.createTextNode(unescape("%u200B")),h.appendChild(e),b.setStartBefore(e),
b.setEndBefore(e),h.removeChild(e)),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b))}}else 37==c&&(3==e.nodeType?(d=e.nodeValue.indexOf(unescape("%u200B")),0==d&&1==e.nodeValue.length?((d=e.previousSibling)?3==d.nodeType&&(b.setStart(d,d.nodeValue.length-1),b.setEnd(d,d.nodeValue.length-1)):a!=G_LastNodeForLi&&(b.setStartBefore(e),b.setEndBefore(e)),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b)):-1<d&&b.startOffset-
1==d&&(d=b.startOffset-2,0>d&&(d=0),b.setStart(e,d),b.setEnd(e,d),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b))):1==e.nodeType&&0<=b.startOffset-1&&(e=e.childNodes[b.startOffset-1],b.setStart(e,e.nodeValue.length),b.setEnd(e,e.nodeValue.length),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b)));else if(G_LastNodeForLi&&null==a&&13==c&&(d=null,DEXTTOP.DEXT5.browser.gecko)){if(d=GetParentbyTagName(f,"div"))if(a=
GetParentbyTagName(f,"ol"),e=GetParentbyTagName(f,"ul"),""!=d.innerHTML&&"<br>"!=d.innerHTML||null!=a||null!=e)d=null;d&&(a=_iframeDoc.createElement("p"),a.innerHTML="<br>",d.parentNode.insertBefore(a,d),d.parentNode.removeChild(d),b.setStartBefore(a.firstChild),b.setEndBefore(a.firstChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b))}}
function adjustOlUlTag(a){var b=[];b.push(a.getElementsByTagName("ol"));b.push(a.getElementsByTagName("ul"));a=b.length;for(var c=0;c<a;c++){var d=b[c];for(j=d.length-1;0<=j;j--){var e=d[j],f=e.parentNode;if(f&&("OL"==f.tagName||"UL"==f.tagName)){for(var g=e.previousSibling;null!=g&&"LI"!=g.tagName;)g=g.previousSibling;if(g){if(""==g.innerHTML||"<br>"==g.innerHTML)g.innerHTML=unescape("%u200B")}else g=_iframeDoc.createElement("li"),g.innerHTML=unescape("%u200B"),f.insertBefore(g,e);g.appendChild(e)}}}}
var G_RULER_OFFSET_X,G_RULER_COORD_X,G_RULER_DRAG=!1,G_CURR_DRAGGIN_RULER,G_RULER_MOVE_AREA={realX1:0,x1:0,realX2:0,x2:0};
function rulerStartDrag(a){G_CURR_DRAGGIN_RULER=a.target?a.target:a.srcElement;var b="",c=G_CURR_DRAGGIN_RULER.id.split("_");if(c[4]){for(var d=c.length,e=4;e<d;e++)b+=c[e],e!=d-1&&(b+="_");DEXTTOP.G_CURREDITOR=DEXTTOP.DEXT5.util._setDEXT5editor(b)}dext_src_init(DEXTTOP.G_CURREDITOR._EDITOR.design);restoreSelection();setFocusToBody();b=getFirstRange().range.startContainer;3==b.nodeType?b=b.parentNode:1!=b.nodeType&&(b=_iframeDoc.body);if(0!=b.isContentEditable){d=getDialogWindow();getDialogDocument();
b=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.width);document.getElementById(G_CURR_DRAGGIN_RULER.id.replace("_point_","_pointline_")).style.display="";e="marginLeft";c="left";isRTL()&&(e="marginRight",c="right");if(0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_0")||0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_1")||0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_3")){var f=document.getElementById("dext_ruler_point_2_"+DEXTTOP.G_CURREDITOR.ID),f=DEXTTOP.DEXT5.util.parseIntOr0(f.style[e]),
g=document.getElementById("dext_ruler_area_0"),h=DEXTTOP.DEXT5.util.parseIntOr0(g.style[c]),g=DEXTTOP.DEXT5.util.parseIntOr0(g.style.width);G_RULER_MOVE_AREA.x1=h+g-b/2;G_RULER_MOVE_AREA.x2=f-30}else 0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_2")&&(h=document.getElementById("dext_ruler_point_0_"+DEXTTOP.G_CURREDITOR.ID),f=document.getElementById("dext_ruler_point_1_"+DEXTTOP.G_CURREDITOR.ID),h=DEXTTOP.DEXT5.util.parseIntOr0(h.style[e]),f=DEXTTOP.DEXT5.util.parseIntOr0(f.style[e]),G_RULER_MOVE_AREA.x1=
(h>f?h:f)+30,g=document.getElementById("dext_ruler_area_1"),h=DEXTTOP.DEXT5.util.parseIntOr0(g.style[c])-b/2,G_RULER_MOVE_AREA.x2=h);a||(a=d.event);G_RULER_OFFSET_X=a.clientX;isRTL()&&(G_BASE_RULER_OFFSET_X=a.clientX);G_CURR_DRAGGIN_RULER.style[e]||(G_CURR_DRAGGIN_RULER.style[e]="0px");G_RULER_COORD_X=parseInt(G_CURR_DRAGGIN_RULER.style[e]);G_RULER_DRAG=!0;"1"==DEXTTOP.G_CURREDITOR._config.ruler.usePointerValue&&(d=document.getElementById("ruler_pointer_value_"+DEXTTOP.G_CURREDITOR.ID),d.style.display=
"",d.innerHTML=G_RULER_COORD_X+b/2+(_iframeDoc.documentElement.scrollLeft||_iframeDoc.body.scrollLeft||0)-G_Ruler.hRuler0PositionLeft,e=d.getClientRects()[0],e=e.right-e.left,f=0,"1"==DEXTTOP.G_CURREDITOR._config.ruler.useVertical&&(f+=17),G_RULER_COORD_X+e+f>DEXTTOP.DEXT5.util.parseIntOr0(getCurrEditorWidth())?d.style[c]=G_RULER_COORD_X-e+"px":d.style[c]=G_RULER_COORD_X+b+"px");b=document.getElementById("ue_ruler_back_div");b.style.display="";c=DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+
DEXTTOP.G_CURREDITOR.ID);b.style.width=c.style.width;b.style.height=c.style.height;DEXTTOP.DEXT5.util.addEventEx(document,"mousemove",rulerDrag,!0);DEXTTOP.DEXT5.util.addEventEx(document,"mouseup",rulerStopDrag,!0);DEXTTOP.DEXT5.util.addEventEx(DEXTTOP.DEXTDOC,"mousemove",rulerDrag,!0);DEXTTOP.DEXT5.util.addEventEx(DEXTTOP.DEXTDOC,"mouseup",rulerStopDrag,!0)}DEXTTOP.DEXT5.util.cancelEvent(a)}
function rulerDrag(a){if(G_RULER_DRAG){var b=getDialogWindow();getDialogDocument();a||(a=b.event);getWindowClientSize(b);currentScrollPos=getWindowScrollPos(b);b=a.clientX;isRTL()&&(b+=-2*(b-G_BASE_RULER_OFFSET_X));var c=G_RULER_COORD_X+b-G_RULER_OFFSET_X,b="marginLeft",d="left";isRTL()&&(b="marginRight",d="right");try{if(!(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion)&&a.currentTarget==DEXTTOP.DEXTDOC)var e=getClientRect(DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+DEXTTOP.G_CURREDITOR.ID)),
c=c-e.left}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}c<=G_RULER_MOVE_AREA.x1?c=G_RULER_MOVE_AREA.x1:c>=G_RULER_MOVE_AREA.x2&&(c=G_RULER_MOVE_AREA.x2);var e=!1,g=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.G_CURREDITOR._config.ruler.moveGap);1<g?c==G_RULER_MOVE_AREA.x1?e=!0:c==G_RULER_MOVE_AREA.x2?e=!0:0==(c+DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.width)/2)%g&&(e=!0):e=!0;e&&(G_CURR_DRAGGIN_RULER.style[b]=c+"px");var g=G_CURR_DRAGGIN_RULER.id,e=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.width),
g=g.replace("_point_","_pointline_"),h=document.getElementById(g),g=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style[b])+e/2;h.style[d]=g+"px";if("1"==DEXTTOP.G_CURREDITOR._config.ruler.usePointerValue){h=document.getElementById("ruler_pointer_value_"+DEXTTOP.G_CURREDITOR.ID);h.innerHTML=g+(_iframeDoc.documentElement.scrollLeft||_iframeDoc.body.scrollLeft||0)-G_Ruler.hRuler0PositionLeft;var m=h.getClientRects()[0],m=m.right-m.left,q=0;"1"==DEXTTOP.G_CURREDITOR._config.ruler.useVertical&&
(q+=17);g+m+q>DEXTTOP.DEXT5.util.parseIntOr0(getCurrEditorWidth())?h.style[d]=g-7-m+"px":h.style[d]=g+7+"px"}if(0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_0")){var e=document.getElementById("dext_ruler_point_3_"+DEXTTOP.G_CURREDITOR.ID),t=document.getElementById("dext_ruler_pointline_3_"+DEXTTOP.G_CURREDITOR.ID),c=c-parseIntOr0(e.style[b]);e.style[b]=parseIntOr0(e.style[b])+c+"px";t.style[d]=parseIntOr0(t.style[d])+c+"px"}else if(0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_3")){var g=
document.getElementById("dext_ruler_point_0_"+DEXTTOP.G_CURREDITOR.ID),h=document.getElementById("dext_ruler_pointline_0_"+DEXTTOP.G_CURREDITOR.ID),m=document.getElementById("dext_ruler_point_1_"+DEXTTOP.G_CURREDITOR.ID),q=document.getElementById("dext_ruler_pointline_1_"+DEXTTOP.G_CURREDITOR.ID),c=parseIntOr0(G_CURR_DRAGGIN_RULER.style[b])-parseIntOr0(g.style[b]),t=!0,u=parseIntOr0(m.style[b])+c;u<=G_RULER_MOVE_AREA.x1?(u=G_RULER_MOVE_AREA.x1,t=!1):u>=G_RULER_MOVE_AREA.x2&&(u=G_RULER_MOVE_AREA.x2,
t=!1);t?(m.style[b]=u+"px",q.style[d]=u+e/2+"px",g.style[b]=parseIntOr0(g.style[b])+c+"px",h.style[d]=parseIntOr0(h.style[d])+c+"px"):(e=document.getElementById("dext_ruler_point_3_"+DEXTTOP.G_CURREDITOR.ID),t=document.getElementById("dext_ruler_pointline_3_"+DEXTTOP.G_CURREDITOR.ID),u-=parseIntOr0(m.style[b]),e.style[b]=parseIntOr0(e.style[b])-c+u+"px",t.style[d]=parseIntOr0(t.style[d])-c+u+"px",m.style[b]=parseIntOr0(m.style[b])+u+"px",q.style[d]=parseIntOr0(q.style[d])+u+"px",g.style[b]=parseIntOr0(g.style[b])+
u+"px",h.style[d]=parseIntOr0(h.style[d])+u+"px")}DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a)}}
function rulerStopDrag(a){getDialogDocument();G_RULER_DRAG=!1;document.getElementById("ue_ruler_back_div").style.display="none";var b="marginLeft";a="left";isRTL()&&(b="marginRight",a="right");var c=document.getElementById("dext_ruler_pointline_0_"+DEXTTOP.G_CURREDITOR.ID),d=document.getElementById("dext_ruler_pointline_1_"+DEXTTOP.G_CURREDITOR.ID),e=document.getElementById("dext_ruler_pointline_2_"+DEXTTOP.G_CURREDITOR.ID),c=DEXTTOP.DEXT5.util.parseIntOr0(c.style[a]),d=DEXTTOP.DEXT5.util.parseIntOr0(d.style[a]),
e=DEXTTOP.DEXT5.util.parseIntOr0(e.style[a]);G_Ruler.rulerPositionArr=[c,d,e];e=G_CURR_DRAGGIN_RULER.id;c=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.width);d=e.replace("_point_","_pointline_");d=document.getElementById(d);b=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style[b])+c/2;d.style[a]=b+"px";0==e.indexOf("dext_ruler_point_0")||0==e.indexOf("dext_ruler_point_1")||0==e.indexOf("dext_ruler_point_3")?"1"==DEXTTOP.G_CURREDITOR._config.ruler.useInoutdent&&setNodeStyleForRulerMode(1):
0==e.indexOf("dext_ruler_point_2")&&"1"==DEXTTOP.G_CURREDITOR._config.ruler.useInoutdent&&setNodeStyleForRulerMode(2);document.getElementById(G_CURR_DRAGGIN_RULER.id.replace("_point_","_pointline_")).style.display="none";"1"==DEXTTOP.G_CURREDITOR._config.ruler.usePointerValue&&(b=document.getElementById("ruler_pointer_value_"+DEXTTOP.G_CURREDITOR.ID),b.style.display="none",b.style[a]="0px");DEXTTOP.DEXT5.util.removeEvent(document,"mousemove",rulerDrag,!0);DEXTTOP.DEXT5.util.removeEvent(document,"mouseup",
rulerStopDrag,!0);DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTDOC,"mousemove",rulerDrag,!0);DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTDOC,"mouseup",rulerStopDrag,!0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function setNodeStyleForRulerMode(a){var b="marginLeft",c="marginRight",d="left";isRTL()&&(b="marginRight",c="marginLeft",d="right");var e=document.getElementById("dext_ruler_area_0"),f=DEXTTOP.DEXT5.util.parseIntOr0(e.style[d])+DEXTTOP.DEXT5.util.parseIntOr0(e.style.width),e=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("dext_ruler_pointline_0_"+DEXTTOP.G_CURREDITOR.ID).style[d])-f,f=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("dext_ruler_pointline_1_"+DEXTTOP.G_CURREDITOR.ID).style[d])-
f-e,g=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("dext_ruler_pointline_2_"+DEXTTOP.G_CURREDITOR.ID).style[d]),h=document.getElementById("dext_ruler_area_1"),d=DEXTTOP.DEXT5.util.parseIntOr0(h.style[d])-g,g=getFirstRange().range,h=!1;g.startContainer&&"BODY"==g.startContainer.tagName&&g.endContainer&&"BODY"==g.endContainer.tagName&&(h=!0);for(var g=h?DEXTTOP.G_CURREDITOR._BODY.childNodes:getNodesInRange(g),h=g.length,m=0;m<h;m++){var q=g[m];if("P"==q.tagName||"LI"==q.tagName)1==a?(q.style[b]=
e+"px",q.style.textIndent=f+"px"):q.style[c]=d+"px"}}
function setRulerMode2Position(a,b){if("design"==b._newMode){var c=b._DOC.documentElement.scrollLeft||b._BODY.scrollLeft||0,d=function(a){var b=0;a=a.toLowerCase();-1<a.indexOf("px")?b=parseFloat(a):-1<a.indexOf("cm")?(b=parseFloat(a),b=DEXTTOP.DEXT5.util.cmToMm(b),b=DEXTTOP.DEXT5.util.mmToPx(b)):-1<a.indexOf("mm")&&(b=parseFloat(a),b=DEXTTOP.DEXT5.util.mmToPx(b));return b},e=d(a.style.textIndent),f=d(a.style.marginLeft),d=d(a.style.marginRight),g=getClientRect(a),h=DEXTTOP.DEXT5.util.parseIntOr0(g.left),
m=DEXTTOP.DEXT5.util.parseIntOr0(g.right),q=document.getElementById("dext_ruler_point_0_"+b.ID),t=document.getElementById("dext_ruler_point_1_"+b.ID),u=document.getElementById("dext_ruler_point_2_"+b.ID),v=document.getElementById("dext_ruler_point_3_"+b.ID),w=DEXTTOP.DEXT5.util.parseIntOr0(q.style.width),g=document.getElementById("dext_ruler_pointline_0_"+b.ID),y=document.getElementById("dext_ruler_pointline_1_"+b.ID),x=document.getElementById("dext_ruler_pointline_2_"+b.ID),z=document.getElementById("dext_ruler_pointline_3_"+
b.ID);if("1"==b._config.ruler.useInoutdent)if(isRTL()){var B=getClientRect(_iframeWin.frameElement),D=B.right-m,A=B.right-h;q.style.marginRight=D-w/2+"px";g.style.right=D+"px";t.style.marginRight=D+e-w/2+"px";y.style.right=D+e+"px";u.style.marginRight=A-w/2+"px";x.style.right=A+"px";v.style.marginRight=D-w/2+"px";z.style.right=D+"px"}else q.style.marginLeft=h-w/2+"px",g.style.left=h+"px",t.style.marginLeft=h+e-w/2+"px",y.style.left=h+e+"px",u.style.marginLeft=m-w/2+"px",x.style.left=m+"px",v.style.marginLeft=
h-w/2+"px",z.style.left=h+"px";e=document.getElementById("dext_ruler_area_0");q=document.getElementById("dext_ruler_area_1");D=u=A=t=0;isRTL()?(D=B.right-m,A=B.right-h,B=getClientRect(_iframeWin.frameElement),e.style.left="auto",q.style.left="auto",t=0,A+=f,f=getCurrEditorWidth(),u=D-d,0>u&&(u=0),e.style.width=u+"px",q.style.width="100%",e.style.right=t+"px",q.style.right=A+"px",G_RULER_MOVE_AREA.x1=t+u,G_RULER_MOVE_AREA.x2=A,f=0==t+u?D:t+u,G_RULER_MOVE_AREA.realX1=f,G_RULER_MOVE_AREA.realX2=A,"1"==
b._config.ruler.useInoutdent&&(G_Ruler.rulerPositionArr=[DEXTTOP.DEXT5.util.parseIntOr0(g.style.right)+c,DEXTTOP.DEXT5.util.parseIntOr0(y.style.right)+c,DEXTTOP.DEXT5.util.parseIntOr0(x.style.right)+c])):(t=0,A=m+d,u=h-f,0>u&&(u=0),f=getCurrEditorWidth(),D=f-A,0>D&&(D=0),e.style.width=u+"px",q.style.width="100%",e.style.left=t+"px",q.style.left=A+"px",G_RULER_MOVE_AREA.x1=t+u,G_RULER_MOVE_AREA.x2=A,f=0==t+u?h+c:t+u+c,G_RULER_MOVE_AREA.realX1=f,G_RULER_MOVE_AREA.realX2=A+c,"1"==b._config.ruler.useInoutdent&&
(G_Ruler.rulerPositionArr=[DEXTTOP.DEXT5.util.parseIntOr0(g.style.left)+c,DEXTTOP.DEXT5.util.parseIntOr0(y.style.left)+c,DEXTTOP.DEXT5.util.parseIntOr0(x.style.left)+c]))}}
function setRulerPositionForNode(a,b){var c;c=a?a:DEXTTOP.G_CURREDITOR;if("2"==c._config.ruler.mode&&G_Ruler.rulerArea&&"none"!=G_Ruler.rulerArea.style.display){var d=null!=b&&void 0!=b&&b&&0==c._config.initFocus&&DEXTTOP.DEXT5.browser.ie,e=null;d||(e=getFirstRange().range);if(e||d){var f=null;d?f=c._DOC.getElementsByTagName("p")[0]:(f=e.startContainer,3==f.nodeType&&(f=f.parentNode));d=GetParentbyTagName(f,"p");null==d&&(d=GetParentbyTagName(f,"li"));null!=d||"BODY"!=f.tagName&&9!=f.nodeType||(d=
c._DOC.getElementsByTagName("p")[0]);d&&setRulerMode2Position(d,c)}}}function getCurrEditorWidth(){var a=null,a=getClientRect(document.getElementById("editorContentArea"));return a=a.right-a.left}
function setAutoUrlHyperLink(a,b){if("0"!=DEXTTOP.G_CURREDITOR._config.autoUrlDetect){var c=null;try{var d="which"in a?a.which:a.keyCode,e="",f=null,g=b.range,h=!1,m=function(a){a=null!=a?a:e;-1<a.toLowerCase().indexOf("http:")?(a=a.substring(a.toLowerCase().lastIndexOf("http:")),t=!0,u=0):-1<a.toLowerCase().indexOf("https:")?(a=a.substring(a.toLowerCase().lastIndexOf("https:")),t=!0,u=0):-1<a.toLowerCase().indexOf("www.")&&(a=a.substring(a.toLowerCase().lastIndexOf("www.")),t=!0,u=1);t&&(e=a)};if(32==
d&&g.startOffset==g.endOffset&&"3"==g.endContainer.nodeType)f=g.startContainer,e=g.endContainer.nodeValue,e=e.substring(0,g.endOffset-1);else if(13==d&&!a.shiftKey){var q=GetParentbyTagName(g.startContainer,"p");q&&q.previousSibling&&q.previousSibling.lastChild&&(f=q.previousSibling.lastChild,"1"==f.nodeType?e=f.textContent:"3"==f.nodeType&&(e=f.nodeValue),!/\s/g.test(e)&&f.previousSibling&&"A"==f.previousSibling.tagName&&(h=!0,e=f.previousSibling.textContent+e))}if(!("A"==f.tagName||3!=f.nodeType&&
f.previousSibling&&"A"==f.previousSibling.tagName||f.parentNode&&"A"==f.parentNode.tagName)){var t=!1,u=0;m();if(t){if(t&&null!=e&&void 0!=e&&""!=DEXTTOP.DEXT5.util.trim(e)){var v;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertHyperlink?v=DEXTTOP.G_CURREDITOR._config.event.beforeInsertHyperlink(DEXTTOP.G_CURREDITOR.ID,e):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_before_insert_hyperlink_event&&(v=DEXTTOP.DEXTWIN.dext_editor_before_insert_hyperlink_event(DEXTTOP.G_CURREDITOR.ID,
e))}catch(w){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}null!=v&&void 0!=v&&(d=e,m(v),t&&(f.textContent=f.textContent.replace(d,v)))}e=e.replace(/[,!@#^&*()_+={}[;:".~`><]$/g,"");e=e.replace(/\u00A0/g,"");m=null;0==u?m=e.match(/^(https?|ftp):\/\/(-\.)?([^\s\/?\.#]+\.?)+(\/[^\s]*)?[^\s\.,]$/i):1==u&&(m=e.match(/(www\.)?([^\s\/?\.#]+\.?)+(\/[^\s]*)?[^\s\.,]$/i));if(m){var c=saveSelection(DEXTTOP.G_CURREDITOR.ID,!0),y=rangy.createRange(_iframeDoc);0==h&&y.selectNodeContents(f);y.findText(e,
{caseSensitive:!1,wholeWordsOnly:!1,direction:"forward"})&&(y.select(),1==u&&(e="http://"+e),f={type:"hyperlink",url:e,target:"_blank",attr_info_arr:[]},command_InsertHyperLink(DEXTTOP.G_CURREDITOR.ID,document.getElementById("dext5_design_"+DEXTTOP.G_CURREDITOR.ID),f));restoreSelection(c,!0)}}}}catch(x){null!=c&&restoreSelection(c,!0)}}}
function setContentChangeKeyEvent(a,b){if(("function"===typeof DEXTTOP.dext_editor_contentsize_change_event||"function"===typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange)&&38!=b&&40!=b&&37!=b&&39!=b&&36!=b&&35!=b&&33!=b&&34!=b)try{0<G_KEY_IMG_COUNT&&G_KEY_IMG_COUNT!=_iframeDoc.getElementsByTagName("img").length&&(G_KEY_IMG_COUNT=-1,contentChangeEventWrapper())}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function contentChangeEventWrapper(a,b){if("function"===typeof DEXTTOP.dext_editor_contentsize_change_event||"function"===typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange){var c=[],d=0,e=_iframeDoc.getElementsByTagName("img"),f=!0;"undefined"!=typeof DEXTTOP.DEXT5.config.ContentSizeChangeEvent&&!1===DEXTTOP.DEXT5.config.ContentSizeChangeEvent.UseGetContentSize&&(f=!1);if(G_IMG_TOTAL_COUNT==e.length){var g=!0;try{for(var h=0,m=e.length;h<m;h++)if("undefined"==typeof G_IMG_CURRENT_LIST[e[h].src]){g=
!1;G_IMG_CURRENT_LIST[e[h].src]=0;break}else if(G_IMG_CURRENT_ARRAYLIST.length==m&&G_IMG_CURRENT_ARRAYLIST[h]!=e[h].src){g=!1;break}}catch(q){g=!1}if(g)return}if(null!=a&&"object"==typeof a){if("img"!=a.nodeName.toLowerCase())return;d=0;DEXTTOP.DEXT5.util.checkUrlForContentSizeCheckEvent(a.src)&&c.push(a)}else if(null==a||"undefined"==typeof a){if(null==e||e&&0==e.length){if(-1==G_IMG_TOTAL_SIZE||0!=G_IMG_TOTAL_SIZE||0==f){G_IMG_TOTAL_COUNT=G_IMG_TOTAL_SIZE=0;G_IMG_CURRENT_LIST={};G_IMG_CURRENT_ARRAYLIST=
[];try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange?DEXTTOP.G_CURREDITOR._config.event.contentSizeChange(DEXTTOP.G_CURREDITOR.ID,{image:0}):"function"===typeof DEXTTOP.dext_editor_contentsize_change_event&&DEXTTOP.dext_editor_contentsize_change_event(DEXTTOP.G_CURREDITOR.ID,{image:0})}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}return}h=0;for(m=e.length;h<m;h++)DEXTTOP.DEXT5.util.checkUrlForContentSizeCheckEvent(e[h].src)&&c.push(e[h]);d=1}if(0==
c.length){G_IMG_CURRENT_LIST={};G_IMG_TOTAL_SIZE=0;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange?DEXTTOP.G_CURREDITOR._config.event.contentSizeChange(DEXTTOP.G_CURREDITOR.ID,{image:0}):"function"===typeof DEXTTOP.dext_editor_contentsize_change_event&&DEXTTOP.dext_editor_contentsize_change_event(DEXTTOP.G_CURREDITOR.ID,{image:0})}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else{for(var v=[],w=[],h=0,m=c.length;h<m;h++)"undefined"==typeof G_IMG_TOTAL_LIST[c[h].src]?
v.push(c[h].src):w.push(c[h].src);var y=0;G_IMG_TOTAL_COUNT=e.length;-1==G_IMG_TOTAL_SIZE&&(G_IMG_TOTAL_SIZE=0);if(0==v.length){G_IMG_CURRENT_LIST={};G_IMG_CURRENT_ARRAYLIST=[];h=0;for(m=e.length;h<m;h++)"undefined"!=typeof G_IMG_TOTAL_LIST[e[h].src]&&(y+=G_IMG_TOTAL_LIST[e[h].src],G_IMG_CURRENT_LIST[e[h].src]=G_IMG_TOTAL_LIST[e[h].src],G_IMG_CURRENT_ARRAYLIST.push(e[h].src));if(G_IMG_TOTAL_SIZE!=y){G_IMG_TOTAL_SIZE=y;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange?DEXTTOP.G_CURREDITOR._config.event.contentSizeChange(DEXTTOP.G_CURREDITOR.ID,
{image:y}):"function"===typeof DEXTTOP.dext_editor_contentsize_change_event&&DEXTTOP.dext_editor_contentsize_change_event(DEXTTOP.G_CURREDITOR.ID,{image:y})}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}else if(0==f)try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange?DEXTTOP.G_CURREDITOR._config.event.contentSizeChange(DEXTTOP.G_CURREDITOR.ID,{image:y}):"function"===typeof DEXTTOP.dext_editor_contentsize_change_event&&DEXTTOP.dext_editor_contentsize_change_event(DEXTTOP.G_CURREDITOR.ID,
{image:y})}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else DEXTTOP.DEXT5.GetFileSizeEx(v,function(a){if(0==d)y=G_IMG_TOTAL_SIZE+parseInt(a),G_IMG_TOTAL_LIST[v]=parseInt(a),G_IMG_CURRENT_LIST[v]=parseInt(a);else if(1==d){G_IMG_CURRENT_LIST={};G_IMG_CURRENT_ARRAYLIST=[];for(var b=0,c=w.length;b<c;b++)"undefined"!=G_IMG_TOTAL_LIST[w[b]]&&(y+=G_IMG_TOTAL_LIST[w[b]],G_IMG_CURRENT_LIST[w[b]]=G_IMG_TOTAL_LIST[w[b]],G_IMG_CURRENT_ARRAYLIST.push(w[b]));b=0;c=v.length;for(a=(a+"").split(",");b<
c;b++)""==a[b]&&(a[b]=0),y+=parseInt(a[b]),G_IMG_TOTAL_LIST[v[b]]=parseInt(a[b]),G_IMG_CURRENT_LIST[v[b]]=parseInt(a[b]),G_IMG_CURRENT_ARRAYLIST.push(v[b])}if(G_IMG_TOTAL_SIZE!=y){G_IMG_TOTAL_SIZE=y;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange?DEXTTOP.G_CURREDITOR._config.event.contentSizeChange(DEXTTOP.G_CURREDITOR.ID,{image:y}):"function"===typeof DEXTTOP.dext_editor_contentsize_change_event&&DEXTTOP.dext_editor_contentsize_change_event(DEXTTOP.G_CURREDITOR.ID,{image:y})}catch(e){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}},DEXTTOP.G_CURREDITOR.ID)}}}function getWidthForAutoBodyFit(a,b){var c;c="table"==b?a._defTableWidth:a._defaultWidth;if("1"==a._config.autoBodyFit){var d=DEXTTOP.DEXT5.util.parseIntOr0(a._BODY.style.width);0==d&&"0"==a._config.ruler.fixEditorWidth&&(d=getClientRect(a._BODY),d=d.right-d.left);0<d&&(c=d,"1"==a._config.defaultBodySpace.use&&(c-=DEXTTOP.DEXT5.util.parseIntOr0(a._config.defaultBodySpace.configValue.left)))}return c}
function findUrlInText(a,b){var c={changedData:"",matchArr:null,tempUrlPattern:unescape("%u200B")+"dext5_url_{0}"+unescape("%u200B")};if("1"==b._config.autoUrlDetect)try{var d=a,e=d.match(/((^https?:\/\/)|(\shttps?:\/\/))[\S]{1,}/gi);if(e){for(var f=e.length,g=0;g<f;g++){var h=DEXTTOP.DEXT5.util.trim(e[g]),d=d.replace(h,c.tempUrlPattern.replace("{0}",g));e[g]=h.replace(/&/g,"&amp;")}c.changedData=d;c.matchArr=e}}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}
function replaceRealUrl(a){for(var b=a.matchArr.length,c=0;c<b;c++){var d='<a href="'+(0>a.matchArr[c].indexOf("://")?"http://"+a.matchArr[c]:a.matchArr[c])+'">'+a.matchArr[c]+"</a>";a.changedData=a.changedData.replace(a.tempUrlPattern.replace("{0}",c),d)}return a.changedData}
function getFirstChildNodeForCaret(a){if(a.firstChild)for(a=a.firstChild;;)if(3==a.nodeType||-1<",img,input,iframe,object,video,".indexOf(","+a.tagName.toLowerCase()+",")){a=a.parentNode;break}else if("BR"==a.tagName){a=a.parentNode;break}else if(null!=a.firstChild)a=a.firstChild;else break;return a}
function getLastChildNodeForCaret(a){"TABLE"==a.tagName&&(a=a.getElementsByTagName("td"),a=a[a.length-1]);for(;null!=a.lastChild;)a=a.lastChild;if(3==a.nodeType||a.tagName&&-1<",br,img,input,iframe,object,video,".indexOf(","+a.tagName.toLowerCase()+","))a=a.parentNode;return a}var G_Toolbar_Scrolling;
function setToolbarScroll(a,b){if(DEXTTOP.DEXT5.browser.mobile&&"1"==a._config.useAutoToolbar){var c=document.getElementById("ue_editor_main_"+a.ID),d=getClientRect(c),c=document.getElementById("dext_tab_tool1_"+a.ID),e=document.getElementById("dext_tab_tool2_"+a.ID);c.style.width=d.width-10+"px";e.style.width=d.width-10+"px";b&&(d=document.createElement("div"),d.id="toolbar2_hidden",d.style.display="none",document.body.appendChild(d),hiddenIconForAutoToolbar(a),c.style.overflowX="auto",e.style.overflowX=
"auto",DEXTTOP.DEXT5.util.addEventEx(c,"scroll",toolbarScrollEvent),DEXTTOP.DEXT5.util.addEventEx(e,"scroll",toolbarScrollEvent),createMobileScrollIcon(a,c),createMobileScrollIcon(a,e));showMobileScrollIcon(c);showMobileScrollIcon(e)}}function createMobileScrollIcon(a,b){for(var c=1;2>=c;c++){var d=document.createElement("div");d.id=b.id+"_scroll_icon_"+c;d.className="scroll_icon_"+a._config.style.skinName+"_"+c;d.style.display="none";b.appendChild(d)}}
function showMobileScrollIcon(a){var b=a.clientWidth,c=a.scrollWidth;document.getElementById(a.id+"_scroll_icon_2").style.display=c>b&&b+a.scrollLeft<c?"":"none"}
function toolbarScrollEvent(a){var b=a.srcElement;a=DEXTTOP.DEXT5.util.parseIntOr0(b.clientWidth);var c=DEXTTOP.DEXT5.util.parseIntOr0(b.scrollLeft),d=DEXTTOP.DEXT5.util.parseIntOr0(b.scrollWidth),e=document.getElementById(b.id+"_scroll_icon_1"),b=document.getElementById(b.id+"_scroll_icon_2");e.style.display=0==c?"none":"";1>=Math.abs(c-(d-a))?b.style.display="none":c<d-a&&(b.style.display="")}
function hiddenIconForAutoToolbar(a){var b=document.getElementById("dext_tab_tool2_"+a.ID);a=document.getElementById("toolbar2_hidden");for(var b=b.childNodes,c=b.length-1;0<=c;c--){var d=b[c];"SPAN"==d.tagName&&("ue_SM"==d.className?d.parentNode.removeChild(d):a.appendChild(d))}}
function adjustTextPasteForPlugin(a){var b=G_dext5plugIn.getDext5PluginVersion(),c=!0,c={maj:5,l:45,mi1:"0",mi2:"0"};(c=DEXTTOP.DEXT5.util.compareVersion?0<=DEXTTOP.DEXT5.util.compareVersion(DEXTTOP.DEXT5.util.grvi("p"),DEXTTOP.DEXT5.util.makeCRV(c)):b>=DEXTTOP.DEXT5.util.makeCRV(c))?a="1"==DEXTTOP.G_CURREDITOR._config.pasteTextLineBreak?addLineBreaker("p",a,!0):DEXTTOP.DEXT5.util.escapeHtml(a):(a=a.replace(/&lt;/g,"<DeXt5_Lt>"),a=a.replace(/&gt;/g,"<DeXt5_Gt>"),a=a.replace(/&nbsp;&nbsp;/g,"<DeXt5_NbSp>"),
a=a.replace(/&/g,"&amp;"),a=a.replace(/<DeXt5_Lt>/g,"&lt;"),a=a.replace(/<DeXt5_Gt>/g,"&gt;"),a=a.replace(/<DeXt5_NbSp>/g,"&nbsp;&nbsp;"));return a}
function getHTMLForAutoSave(a,b){var c="";ReplaceImageToRealObject(!1,!1);DEXTTOP.DEXT5.util.postimageToServer(a._DOC,a._config.mimeUse,a._config);var d=a._DOC.cloneNode(!0);try{for(var e in G_DEPlugin)if("function"===typeof G_DEPlugin[e].onBeforeGetApi)G_DEPlugin[e].onBeforeGetApi({targetDoc:d})}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var g={docNode:d};beforeGetApi(a,g);""!=a._config.placeholder.content&&placeholderControl(a,"remove",g);ReplaceRealObjectToImage();clearAllFormControlSelected(d);
ClearDraggingTableAllTable(d);"1"==a._config.formMode&&ReplaceCustomDataToRealEvent(d);setMatchSelectedValue(d);setMatchInputValue(d,!0);adjustInputNodeForFF(d,!1);setEmptyTagWhiteSpace(a,d);d.body.removeAttribute("contentEditable");c=d.body;c.style.transformOrigin&&""!=c.style.transformOrigin&&(c.style.transformOrigin="");c.style.transform&&""!=c.style.transform&&(c.style.transform="");c.style.zoom&&""!=c.style.zoom&&(c.style.zoom="");"1"==a._config.widthFix.alignCenter&&(d.documentElement.style.marginLeft=
"",d.documentElement.style.marginRight="");switch(b){case "doctype":c="";void 0!=a._PageProp.doctype&&0<a._docType[a._PageProp.doctype].length&&(c=a._docType[a._PageProp.doctype]);c+=d.documentElement.outerHTML;break;case "htmlEx":c=d.documentElement.outerHTML;break;case "html":c=d.documentElement.innerHTML;break;case "bodyEx":c=d.body.outerHTML;break;default:c=d.body.innerHTML}c=insertCarriageReturn(a,c);delete d;""!=a._config.placeholder.content&&(placeholderControl(a,"set",g),placeholderControl(a,
"class",g));try{for(e in G_DEPlugin)if("function"===typeof G_DEPlugin[e].onAfterGetApi){var h=G_DEPlugin[e].onAfterGetApi({isAuto:!0,html:c});"string"==typeof h&&(c=h)}}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}c=removeDomainFromIMGObjectInVirtualDom(a,c);afterGetApi(a,g);return c}
function setBodyFitStyle(a,b,c){if(G_BodyFit.useNoncreationAreaBackground&&!(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion)){var d={};c&&(d=c);c=a._DOC;d.docNode&&(c=d.docNode);d=c.body;if(b){b=parseIntOr0(document.getElementById("ue_editor_holder_"+a.ID).style.height);var e=parseIntOr0(a._config.defaultBodySpace.configValue.top)+parseIntOr0(a._config.defaultBodySpace.configValue.bottom);0<a._config.widthFix.padding&&(e+=2*a._config.widthFix.padding);d.style.minHeight=(b-e)/b*100+"%";
b=null;a._config.widthFix&&a._config.widthFix.border&&(b=a._config.widthFix.border);b&&(d.style[b.styleName]=b.styleValue);0<a._config.widthFix.padding&&(d.style.padding=a._config.widthFix.padding+"px",G_Ruler&&G_Ruler.viewRulerStatus&&"view"!=a._config.mode&&G_Ruler.SetRulerPosition());c.documentElement.style.height="100%";c.documentElement.style.display=DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.gecko?"block":"table";a._config.editingAreaBgColor&&""!=a._config.editingAreaBgColor&&(d.style.backgroundColor=
a._config.editingAreaBgColor);if(null==d.style.backgroundColor||void 0==d.style.backgroundColor||""==d.style.backgroundColor)d.style.backgroundColor="#ffffff";d.parentNode.style.backgroundColor=G_BodyFit.noncreationAreaBackgroundColor;"2"==a._config.ruler.mode&&(b=getEditorFrameDoc(a),b.getElementById("dext_tab_tool4_"+a.ID).style.backgroundColor=G_BodyFit.noncreationAreaBackgroundColor);G_BodyFit.noncreationAreaBackgroundStatus=!0}else d.style.minHeight="","#ffffff"==d.style.backgroundColor&&(d.style.backgroundColor=
""),d.parentNode.style.backgroundColor="","2"==a._config.ruler.mode&&(b=getEditorFrameDoc(a),b.getElementById("dext_tab_tool4_"+a.ID).style.backgroundColor="rgb(255, 255, 255)"),G_BodyFit.noncreationAreaBackgroundStatus=!1,b=null,a._config.widthFix&&a._config.widthFix.border&&(b=a._config.widthFix.border),b&&(d.style[b.styleName]=""),d.style.padding="",c.documentElement.style.height="",c.documentElement.style.display=""}}
var G_MIME_OBJ={_subject:"DEXT5 Editor Mime 1.0",_getDate:function(){var a=new Date,b=a.toDateString().split(" "),a=a.toTimeString().split(" "),c=[];c.push(b[0]+",");c.push(1*b[2]);c.push(b[1]);c.push(b[3]);c.push(a[0]);c.push(a[1].substring(3));return c.join(" ")},_mimeVersion:"1.0",_contentType:"multipart/related",_boundary:"",_boundaryIndex:1,getBoundary:function(a){if(""==this._boundary||a)9<this._boundaryIndex&&(this._boundaryIndex=1),a=function(){if("undefined"!=typeof crypto&&"undefined"!=
typeof crypto.randomUUID){var a="";do a+=crypto.randomUUID().replace(/-/g,"").replace(/[a-zA-Z]/g,"");while(5>a.length);return a.substring(0,5)}return Math.random().toString().slice(2,7)},this._boundary="__=_Part_Boundary_00",this._boundary+=this._boundaryIndex++,this._boundary+="_",this._boundary+="0"+a(),this._boundary+=".",this._boundary+="0"+a();return this._boundary},_xGenerator:"DEXT5 Editor MIME Control for HTML5 V1.0 by RAONWIZ Inc.",_EOL:"\r\n",getHeader:function(){var a=[];a.push("Subject: "+
this._subject);a.push("Date: "+this._getDate());a.push("MIME-Version: "+this._mimeVersion);a.push("Content-Type: "+this._contentType+";");a.push('\tboundary="'+this.getBoundary()+'"');a.push("X-Generator: "+this._xGenerator);a.push("");a.push("");return a.join(this._EOL)},_body:"",getBody:function(a,b){var c=this,d=[];d.push("--"+c.getBoundary());d.push("Content-Type: text/html;");d.push('\tcharset="utf-8"');d.push("Content-Transfer-Encoding: base64");d.push("");c._contentBuffer=[];c._createContentImage(a,
function(a){d.push(DEXTTOP.DEXT5.util.base64_encode(a));d.push("");for(a=0;a<c._contentBuffer.length;a++){var f=c._contentBuffer[a];d.push("--"+c.getBoundary());d.push("Content-Type: "+f.type+";");d.push('\tname="'+f.name+'"');d.push("Content-Transfer-Encoding: "+f.encoding);d.push("Content-ID: <"+f.id+">");d.push("Content-Disposition: "+f.disposition+";");d.push('\tfilename="'+f.filename+'"');d.push("");d.push(f.data);d.push("")}d.push("--"+c.getBoundary()+"--");c._body=d.join(c._EOL);a=c._breakLine(c._body);
"function"===typeof b&&b(a)})},_contentBuffer:[],_createContentImage:function(a,b){var c=this,d=document.createElement("div");d.innerHTML=a;var e=d.getElementsByTagName("img"),f=0,g=function(h){if("undefined"===typeof h)d.innerHTML="","function"===typeof b&&b(a);else{var m=h.src;if(0==m.indexOf("data:")){h=m.replace(/^data:image\/.+;base64,/,"");var q=m.match(/:.+;/)[0],t="."+q.substring(q.indexOf("/")+1,q.length-1);h={type:q.substring(1,q.length-1),name:c._makeRandomString()+t,encoding:"base64",
id:c._makeRandomString()+"@raonwiz.com",disposition:"inline",filename:c._makeRandomString()+t,data:h};c._contentBuffer.push(h);t=a.indexOf(m);q=a.substring(0,t);t=a.substring(t+m.length);a=q+"cid:"+h.id+t}else if(0==m.indexOf("http://")||0==m.indexOf("https://"))if(h=m.replace(/https?:\/\//,"").split("/")[0],q=window.location.href.replace(/https?:\/\//,"").split("/")[0],0==m.indexOf("/")||h==q)try{var u=m.split("/"),u=u[u.length-1],v=new XMLHttpRequest;v.open("GET",m,!0);v.responseType="blob";v.onload=
function(){try{var b=v.response.type.toLowerCase(),d="";switch(b){case "image/gif":d=".gif";break;case "image/jpeg":d=".jpg";break;case "image/png":d=".png";break;case "image/tiff":d=".tif";break;case "image/bmp":d=".bmp"}if(-1<",image/gif,image/jpeg,image/png,image/tiff,image/bmp,".indexOf(""+b+"")){var h=new FileReader;h.readAsDataURL(v.response);h.onload=function(b){var h=b.target.result.replace(/^data:image\/.+;base64,/,"");b=b.target.result.match(/:.+;/)[0];u=u.replace(/[<>:"/\\|?*]/g,"");250<
u.length&&(u=c._makeRandomString()+d);h={type:b.substring(1,b.length-1),name:u,encoding:"base64",id:c._makeRandomString()+"@raonwiz.com",disposition:"inline",filename:c._makeRandomString()+d,data:h};c._contentBuffer.push(h);var q=a.indexOf(m);b=a.substring(0,q);q=a.substring(q+m.length);a=b+"cid:"+h.id+q;g(e[++f])}}else g(e[++f])}catch(q){g(e[++f])}};v.send();return}catch(w){g(e[++f]);return}g(e[++f])}};g(e[f])},_makeRandomString:function(){return"undefined"!=typeof crypto&&"undefined"!=typeof crypto.randomUUID?
crypto.randomUUID().replace(/-/g,""):Math.random().toString(16).substring(2,10)+Math.random().toString(16).substring(2,10)+Math.random().toString(16).substring(2,10)+Math.random().toString(16).substring(2,10)},_breakLine:function(a){var b=[];a=a.replace(/\r/g,"").split("\n");for(var c=0;c<a.length;c++)if(76<a[c].length){for(var d=a[c];76<d.length;)b.push(d.substring(0,76)),d=d.substring(76);b.push(d)}else b.push(a[c]);return b.join(this._EOL)},toMIME:function(a,b,c){var d="",d=d+this.getHeader();
this.getBody(a,function(a){d+=a;"function"===typeof c&&c(d)})},toHTML:function(a){try{a=a.replace(/\r/g,"").replace(/;\n\s/g,";");var b=a.match(/boundary\=.+\n/);null==b&&(b=a.match(/--.*\n/));if(b&&0<b.length)b=b[0];else return"";var c=b.replace(/["']/g,""),c=c.replace(/\n/,""),c=/boundary=/.test(c)?c.replace(/boundary=/,""):c.replace(/^--/,""),d=a.split("--"+c),e=this._parseObj(d[1],{"Content-Type":"","Content-Transfer-Encoding":""}),f=e["Content-Type"];a="";if(f){var g=f.match(/charset="(.*)"/i);
g&&g[1]&&(a=g[1])}if(""!=a&&"euc-kr"==a.toLowerCase()){var h=DEXTTOP.DEXT5.util.base64_decode(e.data,!0);if("function"!=typeof RAONTextEncoder){var m=DEXTTOP.G_CURREDITOR._config.webPath,q=DEXTTOP.DEXT5.isRelease?m.js:m.js_dev,t=DEXTTOP.DEXT5.isRelease?"editor_textencoding.min.js":"editor_textencoding.js",t=t+("?t="+DEXTTOP.DEXT5.UrlStamp),u=new XMLHttpRequest;u.open("GET",q+t,!1);u.send();var v=document.createElement("script");v.type="text/javascript";v.text=u.responseText;document.getElementsByTagName("head")[0].appendChild(v)}try{var w=
(new RAONTextEncoder("windows-1252",{NONSTANDARD_allowLegacyEncoding:!0})).encode(h);e.data=(new RAONTextDecoder("euc-kr")).decode(w)}catch(y){throw y;}}else e.data=DEXTTOP.DEXT5.util.base64_decode(e.data);f=[];if(3<d.length)for(var x=2;x<d.length-1;x++)f.push(d[x]);d={"Content-Type":"","Content-Transfer-Encoding":"","Content-ID":"","Content-Disposition":"","Content-Location":""};for(x=0;x<f.length;x++){var z=this._parseObj(f[x],d);if(z["Content-ID"]){var B="cid:"+z["Content-ID"].replace(/[\<\>]/g,
"");if(-1<e.data.indexOf(B)){for(var D=z["Content-Type"].split(";"),g=0;g<D.length;g++)if(-1<D[g].indexOf("/")){D=D[g];break}e.data=e.data.replace(B,"data:"+D+";"+z["Content-Transfer-Encoding"]+","+z.data)}}}return e.data}catch(A){return"0"}},_parseObj:function(a,b){var c={},d;for(d in b){var e=a.match(d+":.+");e&&0<e.length&&(c[d]=e[0].replace(d+":","").trim(),a=a.replace(e,""))}c.data=a.replace(/\n/g,"").trim();return c}};
function removeEmptyTagByBackspace(a){"keydown"==a.type&&(G_KeydownNode=null);var b="which"in a?a.which:a.keyCode;if(DEXTTOP.DEXT5.browser.ie&&(8==b||46==b))try{var c=getFirstRange().range;if(c.startContainer==c.endContainer&&0==c.startOffset&&0==c.endOffset){var d=3==c.startContainer.nodeType?c.startContainer.parentNode:c.startContainer;d==(3==c.endContainer.nodeType?c.endContainer.parentNode:c.endContainer)&&(0==d.childNodes.length||1==d.childNodes.length&&"BR"==d.childNodes[0].tagName)&&-1<",span,b,strong,i,italic,underline,u,strike,em,sup,sub,".indexOf(","+
d.tagName.toLowerCase()+",")&&("keyup"==a.type?(G_KeydownNode==d&&(c.setStartBefore(d),c.setEndBefore(d),getFirstRange().sel.removeAllRanges(),getFirstRange().sel.addRange(c),d.parentNode.removeChild(d)),G_KeydownNode=null):G_KeydownNode=d)}}catch(e){G_KeydownNode=null}}
function fn_saveToLocalStorage(a,b){var c=!0,d=a._config.setAutoSave.use_encrypt,e=a._config.setAutoSave.unique_key,f="dext_"+a.ID;""!=e&&(f+="_"+e);for(var g=DEXTTOP.DEXT5.isEmpty(a.ID,!0),h="",e=parseIntOr0(a._config.setAutoSave.maxCount),m=parseIntOr0(a._config.setAutoSave.maxCount)-1;0<=m;m--)h=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage(f+"_"+m),null==h&&void 0==h&&(e=m);0==g?(g="",g="1"==d?DEXTTOP.DEXT5.util._fn_$mEP(b):b,d={date:a._DOC.lastModified,html:g},e>parseIntOr0(a._config.setAutoSave.maxCount)-
1&&(--e,pushAutoSave(f,0,a._config.setAutoSave.maxCount)),DEXTTOP.DEXT5.util.saveJsonToLocalStorage(f+"_"+e,d),showTemporarilySaveMessage(a),autoSaveEnable(a.ID)):c=!1;return c}
function fn_AutoSaveInterval(a,b){var c,d=a._setting.auto_save;d&&("0"===d.defaultUse?"on"===d.userSetting&&(c=d.time):"off"!==d.userSetting&&(c=d.time));return"number"===typeof c?DEXTTOP.DEXTWIN.setInterval(function(){if(DEXTTOP&&DEXTTOP.G_CURREDITOR){if(!isViewMode(DEXTTOP.G_CURREDITOR)){var b="",c=a.getEditorMode();if("design"==c)b=DEXTTOP.DEXT5.getHtmlValueExWithDocType(a.ID,!0);else if("source"==c){c=a._EDITOR.source.value;c=c.replace(/\t/g,"");if("1"==a._config.sourceViewtype||"2"==a._config.sourceViewtype)c=
removeCRLFChar(c);c=DEXTTOP.DEXT5.util.htmlRevision(c);c=xssReplaceScript(null,c);"0"==DEXTTOP.G_CURREDITOR._config.viewImgBase64Source&&(c=DEXTTOP.DEXT5.util.ImageSrcConvert(c,!0,DEXTTOP.G_CURREDITOR.ID));var b=a._docType[a._PageProp.doctype],d=a._PageProp.lang,h=a._PageProp.xmlnsname,m=_iframeDoc.getElementsByTagName("head")[0].outerHTML,q=_iframeDoc.getElementsByTagName("body")[0],t="<html";0<d.length&&(-1<d.indexOf("-")&&(d=d.split("-")[0]),t+=' lang="'+d+'" xml:lang="'+d+'"');0<h.length&&(t+=
' xmlns="'+h+'"');h=q.id;d="<body>";""!=h&&null!=h&&void 0!=h&&(d="<body id='"+q.id+"'>");b=b+(t+">")+m+d+c+"<body></html>"}else"preview"==c?(c=a._EDITOR.preview.contentDocument?a._EDITOR.preview.contentDocument:a._EDITOR.preview.contentWindow.document,b=a._docType[a._PageProp.doctype],b+=c.documentElement.outerHTML):"text"==c&&(b=a._EDITOR.text.value);fn_saveToLocalStorage(a,b)}}else try{clearInterval(a._setting.auto_save_fn)}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},6E4*
c):null}
function showTemporarilySaveMessage(a){try{var b=a._FRAMEWIN.document.getElementById("editor_temporarily_message");if(b){for(var c=b.parentNode.childNodes,d=c.length,e=0;e<d;e++)1==c[e].nodeType&&c[e]!=b&&"none"!=c[e].style.display&&(c[e].setAttribute("d_temp_display",c[e].style.display),c[e].style.display="none");b.innerHTML='<span style="color:black; margin-top:1px; margin-right:10px;">'+a._FRAMEWIN.dext5_lang.msg.manually_temp_save+"</span>";b.style.display="";setTimeout(function(){try{b.style.display="none";
for(var a=0;a<d;a++)1==c[a].nodeType&&c[a]!=b&&null!=c[a].getAttribute("d_temp_display")&&(c[a].style.display=c[a].getAttribute("d_temp_display"),c[a].removeAttribute("d_temp_display"))}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},2E3)}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function adjustInputNodeForFF(a,b){if(0!=DEXTTOP.DEXT5.browser.gecko)try{if(b)for(var c=a.getElementsByTagName("input"),d=c.length-1;0<=d;d--){if(c[d].isContentEditable&&"checkbox"==c[d].type||"radio"==c[d].type&&"dextinputholder"!=c[d].parentNode.tagName.toLowerCase()){var e=a.createElement("dextinputholder");e.contentEditable=!1;var f=c[d].parentNode;f.insertBefore(e,c[d]);e.appendChild(c[d])}}else for(var g=a.getElementsByTagName("dextinputholder"),d=g.length-1;0<=d;d--)f=g[d].parentNode,f.insertBefore(g[d].firstChild,
g[d]),f.removeChild(g[d])}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function setColorPickerHeight(a,b){a.getElementById("popupCover").style.height=b+5+"px"}
function replaceLineBreak(a,b){var c=b;if("0"!=a._config.replaceLineBreak)try{"1"==a._config.replaceLineBreak&&(c=c.replace(/([\r\n ]{2,}|[\r\n])</g,"<temp_text2><"));for(var d=["pre","textarea"],e=d.length,f=0;f<e;f++)c=c.replace(new RegExp("(<"+d[f]+"[^>]*>)([\\s\\S]*?)<\\/"+d[f]+">","gi"),function(a){a=DEXTTOP.DEXT5.util.trim(a).replace(/\r\n/g,"<temp_text>");a=DEXTTOP.DEXT5.util.trim(a).replace(/\n/g,"<temp_text>");return a=DEXTTOP.DEXT5.util.trim(a).replace(/\r/g,"<temp_text>")});c=DEXTTOP.DEXT5.util.trim(c).replace(/\n/g,
" ");c=DEXTTOP.DEXT5.util.trim(c).replace(/<temp_text>/g,"\n");"1"==a._config.replaceLineBreak&&(c=c.replace(/<temp_text2>/g,"\r\n"))}catch(g){c=str}return c}
function AdjustDesignBodyWidth(a){if("ios"==DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()&&"13">DEXTTOP.DEXT5.UserAgent.os.version){var b=a.editor;a.isApply?(a=document.body.clientWidth,a<b._BODY.clientWidth&&(b.backupWidthForIOS.backupWidth=""!=b._BODY.style.width?b._BODY.style.width:"",b._BODY.style.width=a+"px",b._BODY.setAttribute("iosWidth","true"))):((a=b._BODY.getAttribute("iosWidth"))&&"true"==a&&(b._BODY.style.width=""!=b.backupWidthForIOS.backupWidth?b.backupWidthForIOS.backupWidth:"",b._BODY.removeAttribute("iosWidth")),
b.backupWidthForIOS.isPopup=!1)}}function checkContentEditable(a,b){var c=!0;if("2"==a._config.editorBodyEditableMode){if("HTML"==b.tagName)return!0;DEXTTOP.DEXT5.browser.ie?c=b.isContentEditable:"TEXTAREA"==b.tagName?1==b.disabled&&(c=!1):"INPUT"==b.tagName?""!=b.type&&"text"!=b.type||1!=b.disabled||(c=!1):c=b.isContentEditable}return c}
function copyImageToTempFolder(a){if(G_dext5plugIn&&1==G_dext5plugIn.getHTMLFormatFromType||G_dext5plugIn&&2==G_dext5plugIn.getHTMLFormatFromType){a=a.getElementsByTagName("img");for(var b=a.length,c=0;c<b;c++){var d=a[c].src;if(0==d.indexOf("file:")&&0>d.indexOf("\\dext5Temp\\")){var e="";try{e=G_dext5plugIn.GetCopyImageToTemp(d)}catch(f){d=G_dext5plugIn.getBase64ImageFromLocalImage(d).split(","),e=getExtFromImageDataSrc(d[0]),e=G_dext5plugIn.getLocalImageFromBase64Image(d[1],e)}e="file:///"+e;a[c].src=
e}}}}
function hyperHelpOpen(a,b){var c=DEXTTOP.G_CURREDITOR,d=getDialogDocument();if(d.getElementById("dext_context_iframe")&&"none"==d.getElementById("dext_context_iframe").style.display)if((c.isAOver.node||c.isAOver.nodeChild)&&c.isAOver.over){currElem=c.isAOver.node;d=document.getElementById("dext_div_hyper_link_help");document.getElementById("dext_div_hyper_link_help_content").innerHTML=currElem.getAttribute("href");d.style.display="block";c.isAOver.nodeChild&&(currElem=c.isAOver.nodeChild);var e=getClientRect(_iframeWin.frameElement),
f=Math.round(a+document.body.scrollLeft+document.documentElement.scrollLeft),g=Math.round(b+document.body.scrollTop+document.documentElement.scrollTop),h=0;e.right-f<d.clientWidth&&(h=d.clientWidth-(e.right-f)+10);e.bottom-(g+e.top)<d.clientHeight?d.style.bottom=e.bottom-(g+e.top)+d.clientHeight+2+"px":d.style.top=g+e.top+2+"px";d.style.left=f-h+3+"px";c.isAOver.openHelp=!0}else DEXTTOP.G_CURREDITOR.isAOver.node=null,DEXTTOP.G_CURREDITOR.isAOver.nodeChild=null}
function hyperHelpClose(){var a=DEXTTOP.G_CURREDITOR,b=document.getElementById("dext_div_hyper_link_help");b.style.display="none";removeAttribute(b.style,"bottom");removeAttribute(b.style,"top");removeAttribute(b.style,"left");a.isAOver={over:!1,node:null,nodeChild:null,openHelp:!1}}
function hyperLinkIn(){var a=DEXTTOP.G_CURREDITOR;a.isAOver.node&&(null==a.isAOver.node.getAttribute("target")&&(a.isAOver.node.setAttribute("target","_blank"),a.isAOver.addTarget=!0),a.isAOver.node.setAttribute("contenteditable","false"),a.isAOver.node.style.cursor="pointer",a.isAOver.nodeChild&&(a.isAOver.nodeChild.setAttribute("contenteditable","false"),a.isAOver.nodeChild.style.cursor="pointer",null==a.isAOver.node.getAttribute("target")&&(a.isAOver.nodeChild.setAttribute("target","_blank"),a.isAOver.addTarget=
!0)),a.isAOver.linkStyle=!0)}
function hyperLinkOut(){var a=DEXTTOP.G_CURREDITOR;a.isAOver.node&&(1==a.isAOver.node.style.length?a.isAOver.node.removeAttribute("style"):removeAttribute(a.isAOver.node.style,"cursor"),removeAttribute(a.isAOver.node,"contenteditable"),a.isAOver.addTarget&&a.isAOver.node.removeAttribute("target"),a.isAOver.nodeChild&&(1==a.isAOver.nodeChild.style.length?removeAttribute(a.isAOver.nodeChild,"style"):removeAttribute(a.isAOver.nodeChild.style,"cursor"),removeAttribute(a.isAOver.nodeChild,"contenteditable"),
a.isAOver.addTarget&&a.isAOver.nodeChild.removeAttribute("target")),a.isAOver.addTarget=!1,a.isAOver.linkStyle=!1)}function focusToElement(a){if(a&&a.getBoundingClientRect){a=a.getBoundingClientRect();var b=getWindowClientSize(_iframeWin);0>a.top?scrollToTop(getScrollTop()+a.top):a.bottom>b[1]&&scrollToTop(getScrollTop()+a.bottom-b[1])}}function getScrollTop(){return DEXTTOP.DEXT5.util.browser.ie?_iframeWin.documentElement.scrollTop:_iframeDoc.body.scrollTop}
function scrollToTop(a){DEXTTOP.DEXT5.util.browser.ie?_iframeWin.documentElement.scrollTop=a:_iframeDoc.body.scrollTop=a}
function adjustIEEnterBug(a){var b=a.event;try{if(DEXTTOP.DEXT5.browser.ie&&0==b.ctrlKey&&0==b.altKey&&13==a.keyCode){var c=getFirstRange(),d=c.range.startContainer;if(d==c.range.endContainer&&1==d.nodeType&&"SPAN"==d.tagName&&""==(void 0!=d.innerText?d.innerText:d.textContent)&&1==d.childNodes.length){for(a=null;null!=d;)if(null==d.lastChild&&"BR"==d.tagName){a=d;break}else if(d=d.lastChild,d.childNodes&&1<d.childNodes.length)break;a&&(c.range.setStartAfter(a),c.range.setEndAfter(a),c.sel.removeAllRanges(),
c.sel.addRange(c.range))}}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function removeDummyDivInHwp(a){if("1"==DEXTTOP.G_CURREDITOR._config.removeDummyDivInHwpPaste)if("string"==typeof a){var b=RegExp('<div [^>].*id="hwpEditorBoardContent".*>\x3c!--(:?.|\\s)*--\x3e<\\/div>',"gi");if(b.test(a))return a=a.replace(b,"")}else for(var b=a.getElementsByTagName("div"),c=b.length-1;0<=c;c--){var d=b[c];d&&"hwpEditorBoardContent"==d.id&&d.childNodes&&1==d.childNodes.length&&8==d.childNodes[0].nodeType&&d.parentNode.removeChild(d)}if("string"==typeof a)return a}
function setNodeWidthHeight(a,b){try{for(s in b){var c="",d=b[s];""!=d?(c=""!=a.style[s]?"style":a.getAttribute(s)&&""!=a.getAttribute(s)?"attr":"style","style"==c?a.style[s]=d:a.setAttribute(s,DEXTTOP.DEXT5.util.parseIntOr0(d))):(a.removeAttribute(s),a.style.removeAttribute?a.style.removeAttribute(s):a.style.removeProperty(s))}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function getNodeWidthHeight(a,b){var c="";""!=a.style[b]?c=a.style[b]:a.getAttribute(b)&&""!=a.getAttribute(b)&&(c=a.getAttribute(b));return c}function getFileName(a,b){for(var c;-1!==a.indexOf("\\");)a=a.replace("\\","/");c=a.split("/").pop();b&&(c=c.slice(0,c.lastIndexOf(".")));return c}
function checkClickOnScrollBar(a){var b=!1;if((a.target?a.target:a.srcElement)==_iframeDoc.documentElement&&(a.clientX>=_iframeDoc.documentElement.clientWidth&&(b=!0),0==b)){var c=0,c=DEXTTOP.DEXT5.browser.ie?_iframeDoc.documentElement.clientHeight:_iframeDoc.body.clientHeight;a.clientY>=c&&(b=!0)}return b}
function preventScrollMove(a){a?(a=DEXTTOP.G_CURREDITOR.preventScrollMove,a.use=!0,a.beforeTop=_iframeDoc.documentElement.scrollTop,a.beforeLeft=_iframeDoc.documentElement.scrollLeft):setTimeout(function(){DEXTTOP.G_CURREDITOR.preventScrollMove.use=!1},1)}function setDisableUndoRedo(a,b){b.disableUndoRedo=0<=b._config.undoLimitLength?a.length>=b._config.undoLimitLength?!0:!1:!1}
function adjustSizeInContainer(a){var b=function(a){a=getNodeWidthHeight(a,"width");a.indexOf("px")?a=DEXTTOP.DEXT5.util.parseIntOr0(a):(a=getClientRect(parent),a=a.right-a.left);return a},c=function(a){for(var c=a.length-1;0<=c;c--){var d=a[c];b(d)>=e&&("IMG"==d.tagName&&(d.style.removeAttribute?d.style.removeAttribute("height"):d.style.removeProperty("height")),d.style.width="100%")}};if("1"==DEXTTOP.G_CURREDITOR._config.autoFitInHolder){var d=function(){var a=getFirstRange().range.startContainer;
3==a.nodeType&&(a=a.parentNode);return a}();if(d=getParentbyTagNameEx(d,"td,th,div")){var e=b(d);if(0<e){if(a.strHtml){d=document.createElement("div");d.innerHTML=a.strHtml;a=["table","img"];for(var f=a.length,g=0;g<f;g++){var h=d.getElementsByTagName(a[g]);c(h)}return d.innerHTML}a.nodes&&(h=a.nodes,"undefined"==typeof h.length&&(h=[h]),c(h))}}}if("string"==typeof a.strHtml)return a.strHtml}
function getCurrentZoomValue(a){var b=1;try{var c=a._BODY.style.transform;""!=c&&(c=c.replace("scale(",""),b=parseFloat(c))}catch(d){b=1}0==b&&(b=1);return b}
function pluginInsertImageAutoFit(a){var b=a.src;if(0<G_dext5plugIn.getImageWidthHeight(b).length){var c=a.style.width.replace("px","");""==c&&(c=a.width);var d=a.style.height.replace("px","");""==d&&(d=a.height);var e=c+"^"+d,f="",g="",h="",m="";0>DEXTTOP.G_CURREDITOR._config.imgDefaultWidth.indexOf("%")&&(h=DEXTTOP.G_CURREDITOR._config.imgDefaultWidth,m=DEXTTOP.G_CURREDITOR._config.imgDefaultHeight);""!=h&&(h=DEXTTOP.DEXT5.util.parseIntOr0(h),DEXTTOP.DEXT5.util.parseIntOr0(c)>h&&(f=h,DEXTTOP.G_CURREDITOR._config.imgDefaultWidth=
c));""!=m&&(m=DEXTTOP.DEXT5.util.parseIntOr0(m),DEXTTOP.DEXT5.util.parseIntOr0(d)>m&&(g=m,DEXTTOP.G_CURREDITOR._config.imgDefaultHeight=d));SetImageAutoFitSize(a,b+"?"+e);""!=f&&(DEXTTOP.G_CURREDITOR._config.imgDefaultWidth=f);""!=g&&(DEXTTOP.G_CURREDITOR._config.imgDefaultHeight=g)}}
function placeholderControl(a,b,c){var d={};c&&(d=c);c=a._DOC;d.docNode&&(c=d.docNode);d=c.body;"remove"==b?(0==d.classList.length?d.removeAttribute("class"):d.classList.remove("dext_placeholder"),c.getElementById("dext_placeholder")&&c.getElementById("dext_placeholder").parentNode.removeChild(c.getElementById("dext_placeholder"))):"set"==b?c.getElementById("dext_placeholder")||(b=document.createElement("style"),b.setAttribute("id","dext_placeholder"),b.innerHTML=".dext_placeholder:before { content: '"+
a._config.placeholder.content+"'; color: "+a._config.placeholder.fontColor+"; font-size: "+a._config.placeholder.fontSize+"; font-family: "+a._config.placeholder.fontFamily+"; display: block; position: absolute; white-space: pre; }",c.getElementsByTagName("head")[0].appendChild(b)):"class"==b&&(0<d.childNodes.length&&"edit"==a._config.mode?(a=d.innerHTML,b=d.innerText,a=a.replace(/<head(.*?)>(.*?)<(\/?)head>/gi,""),a=a.replace(/<title(.*?)>(.*?)<(\/?)title>/gi,""),a=a.replace(/<style(.*?)>(.*?)<(\/?)style>/gi,
""),a=a.replace(/<meta(.*?)>(.*?)<(\/?)meta>/gi,""),a=a.replace(/<meta(.*?)>/gi,""),a=a.replace(/<br \/>/i,""),a=a.replace(/<br>/i,""),DEXTTOP.DEXT5.browser.ie&&10==DEXTTOP.DEXT5.browser.ieVersion&&(a=a.replace(/&nbsp;/i,""),a=" "==b?b:a),a=a.replace(/<p *([^>?+])*><\/p>/i,""),""==a?d.classList.add("dext_placeholder"):0==d.classList.length?d.removeAttribute("class"):d.classList.remove("dext_placeholder")):"edit"==a._config.mode&&d.classList.add("dext_placeholder"))}
function getReplaceMsoStyleReg(a){var b=DEXTTOP.G_CURREDITOR._config.replaceMsoStyle.styleValue[a],c="(\\s?"+a+")";b&&(c="(\\s?"+a+":\\s*"+b+")([^>]*)>");return c}
function execReplaceMsoStyle(a){var b=a;try{for(var c=DEXTTOP.G_CURREDITOR._config.replaceMsoStyle,d=0;d<c.settingStyle.length;d++){var e=getReplaceMsoStyleReg(c.settingStyle[d]);reg_exp=new RegExp(e,"gi");reg_exp.test(b)&&(b=b.replace(reg_exp,"$1 $2 "+c.settingStyle[d].replace("mso",c.replaceAttributeName)+">"))}}catch(f){b=a}return b}function restoreValueInSetError(a){try{a&&(a.setValueIsBusy=!1,a.notFocusToEditor=void 0)}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function externalPageBreakDataRaplaceInEditor(a){try{if(-1<a.indexOf("page-break")){var b=RegExp("(<span [^>]*>)(<br[^>]*page-break(.*?)>)(.*?>)","gi"),c=getPageBreakOuterHTML();a=a.replace(b,c);b=RegExp("(<br[^>]*page-break(.*?)>)","gi");a=a.replace(b,c)}}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return a}
function insertCarriageReturnBeforeCloseCell(a){if(!DEXTTOP.DEXT5.browser.ie)return a;try{return a.replace(RegExp("(\\/(?:p|div)>)(<\\/t[dh]>)","gi"),"$1\n$2")}catch(b){return a}}
function removeEditorAttribute(a){try{var b=RegExp('(<t[dh][^>]*)( dext_select="true")',"gi");b.test(a)&&(a=a.replace(b,"$1"));b=RegExp('(<t[dh][^>]*)( cellorgbgcolor=".*?"| cellorgbgcolor)',"gi");b.test(a)&&(a=a.replace(b,"$1"));b=RegExp('(<table[^>]*)( DEXT5CellSelected=".*?")',"gi");b.test(a)&&(a=a.replace(b,"$1"))}catch(c){}return a}
function adjustMsoBorder(a){var b=a;if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion)return b;if(RegExp("<t[dh] [^>]+mso-border[^>]*>","gi").test(b)){a=document.createElement("div");a.innerHTML=b;for(var c=["td","th"],b=[],d=0;d<c.length;d++){var e=a.getElementsByTagName(c[d]);try{b=b.concat(Array.prototype.slice.call(e,0))}catch(f){for(var g=e.length,h=0;h<g;h++)b.push(e[h])}}c=b.length;for(d=0;d<c;d++){e=b[d];h=e.tagName;g={};if(DEXTTOP.DEXT5.browser.ie)g=e.style;else{h=new RegExp("(<"+
h+" [^>]*>)","i");h.test(e.outerHTML);var m=RegExp.$1,m=m.replace(/\n|\t|\s{2,}/gi,""),h=/style="[^"](.*)"/i;if(h.test(m))for(var m=RegExp.$1,h=m.split(";"),m=h.length,q=0;q<m;q++){var t=h[q].split(":");if(2==t.length){var u=DEXTTOP.DEXT5.util.trim(t[0]),t=DEXTTOP.DEXT5.util.trim(t[1]);g[u]?g[u].length<t.length&&(g[u]=t):g[u]=t}}}!DEXTTOP.DEXT5.browser.ie&&"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal&&(h=g["mso-diagonal-up"],m=g["mso-diagonal-down"],h&&0<h.length&&e.setAttribute("diagonal-up",
h),m&&0<m.length&&e.setAttribute("diagonal-down",m));h=["Top","Bottom","Left","Right"];m=h.length;for(q=0;q<m;q++)if((u=g["mso-border-"+h[q].toLowerCase()+"-alt"])&&0<u.length){u=u.split(" ");if(3!=u.length){var t=g["mso-border-style-alt"],v=g["mso-border-width-alt"],w=g["mso-border-color-alt"];1==u.length?(t&&0<t.length&&(-1<u[0].indexOf("pt")&&(u[2]=u[0]),u[0]=t),w&&0<w.length&&(u[1]=w),v&&0<v.length&&(u[2]=v)):2==u.length&&(u[2]=u[1],u[1]="")}0<u.length&&"none"==e.style["border"+h[q]+"Style"]&&
(e.style["border"+h[q]+"Style"]=u[0],u[1]&&0<u[1].length&&(e.style["border"+h[q]+"Color"]=u[1]),e.style["border"+h[q]+"Width"]=u[2])}}b=a.innerHTML}return b}
function setLiStyle(){for(var a=getFirstRange().range,b=getNodesInRange(a),c=b.length,a=function(a){var b=G_CURSOR_ELEMENT=a;b.firstChild&&"DIV"==b.firstChild.tagName&&(b=b.firstChild);var c=!1;1!=b.childNodes.length||"SPAN"!=b.childNodes[0].tagName&&3!=b.childNodes[0].nodeType?2!=b.childNodes.length||"BR"!=b.childNodes[1].tagName||"SPAN"!=b.childNodes[0].tagName&&3!=b.childNodes[0].nodeType||(c=!0):c=!0;if(c){b=b.childNodes[0];3==b.nodeType&&(b=b.parentNode);var d=DEXTTOP.DEXT5.util.getStyle,c=d(b,
"fontFamily"),e=d(b,"fontSize"),d=d(b,"color");c!=DEXTTOP.G_CURREDITOR._config.defaultFontFamily&&(a.style.fontFamily=c);e!=DEXTTOP.G_CURREDITOR._config.defaultFontSize&&(a.style.fontSize=e);""!=d&&""!=b.style.color&&(a.style.color=d)}},d=!1,e=[],f=!1,g=0;g<c;g++){var h=b[g].nodeName.toLowerCase();if("ol"==h||"ul"==h)d=!0,e.push(b[g]);"li"==h&&(f=!0,a(b[g]))}if(1==d&&0==f)for(g=e.length-1;0<=g;g--)for(b=e[g].getElementsByTagName("li"),c=b.length,d=0;d<c;d++)a(b[d])}
function getPasteFormatType(){var a="";if("DOC"==G_wordProcessorType||G_dext5plugIn&&1==G_dext5plugIn.getHTMLFormatFromType)a="DOC";else if("XLS"==G_wordProcessorType||G_dext5plugIn&&2==G_dext5plugIn.getHTMLFormatFromType)a="XLS";else if("PPT"==G_wordProcessorType||G_dext5plugIn&&3==G_dext5plugIn.getHTMLFormatFromType)a="PPT";else if("HWP"==G_wordProcessorType||G_dext5plugIn&&4==G_dext5plugIn.getHTMLFormatFromType)a="HWP";return a}
function getXhrResponseData(a){var b={status:"",bodyText:""};try{a&&(b.status=a.status,b.bodyText=a.responseText)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return b}function getDisplayFontName(a,b){var c=DEXTTOP.G_CURREDITOR;b&&(c=b);var d=a;a=c._dextFontFamily.get_trimmed_font(a);c=c._config.displayFontFamilyList;"object"==typeof c&&"[object Object]"==Object.prototype.toString.call(c)&&(d=c[a],0==!!d&&(d=a));return d}
function getRealNameThroughDisplayName(a,b){var c=DEXTTOP.G_CURREDITOR;b&&(c=b);var d=a,c=c._config.displayFontFamilyList;if("object"==typeof c&&"[object Object]"==Object.prototype.toString.call(c))for(n in c)if(c[n]==a){d=n;break}return d}
function setEditorHtmlWidth(a){var b=a._config,c=_iframeDoc.documentElement,d=_iframeDoc.body.style.width;-1!=d.indexOf("px")&&(d=parseInt(d,10),a=parseIntOr0(a._config.defaultBodySpace.configValue.left)+parseIntOr0(b.defaultBodySpace.configValue.right),c.style.width=d+a+"px")}
function replaceColorRgbToHex(a){var b=a;try{a=a.replace(RegExp("<[^>]+style=(.*?)>","gi"),function(a){return a=a.replace(RegExp("(rgb\\(\\d+,\\s*\\d+,\\s*\\d+\\)*)","gi"),function(a){return DEXTTOP.DEXT5.util.rgb2hex(a)})})}catch(c){return b}return a}function getUploadOriginalFileName(a,b){var c=a.substring(a.lastIndexOf("\\")+1);DEXTTOP.DEXT5.browser.HTML5Supported&&"1"==b.uploadUseHTML5&&"1"==b.uploadFileNameEncoding&&(c=encodeURIComponent(c));return c}
function deleteTableUsingKey(a,b){var c=!1;try{if("1"==b._config.deleteTableUsingKey){var d="which"in a?a.which:a.keyCode,e=getFirstRange().range,f=!1;"1"!=b._config.formMode&&"1"==b._config.userTableLock.use&&(f=!0);if((8==d||46==d)&&1==e.collapsed){var g=e.startContainer;3==g.nodeType&&(g=g.parentNode);var h=getParentbyTagNameEx(g,"p");if(h){var m=h[8==d?"previousSibling":"nextSibling"];m&&"TABLE"==m.tagName&&(8==d?isCaretAtTheBeginning():isCaretAtTheEnd())&&(b.UndoManager.putUndo(),0==(f&&checkLockAttr(m,
!0))&&(m.parentNode.removeChild(m),b.UndoManager.putUndo()),DEXTTOP.DEXT5.util.cancelEvent(a),c=!0)}}}}catch(q){c=!1}return c}
function isCaretAtTheBeginning(){var a=!1;try{var b=getFirstRange().range;if(1==b.collapsed){var c=_iframeDoc.createElement("span");c.id="caretCheckNode";b.insertNode(c);try{var d=getParentbyTagNameEx(c,"p,li");if(d){var e=d.innerHTML,f=e.indexOf(c.outerHTML),g=e.substring(0,f),g=g.replace(/<br\b.*?>/gi,"dext5Br");c.parentNode.removeChild(c);g=g.replace(/<[a-zA-Z].*?>/g,"");""==g&&(a=!0)}else c.parentNode.removeChild(c)}catch(h){c.parentNode.removeChild(c)}}}catch(m){a=!1}return a}
function isCaretAtTheEnd(){var a=!1;try{var b=getFirstRange().range;if(1==b.collapsed){var c=_iframeDoc.createElement("span");c.id="caretCheckNode";b.insertNode(c);try{var d=getParentbyTagNameEx(c,"p,li");if(d){var e=d.innerHTML,f=e.indexOf(c.outerHTML),g=e.substring(f+c.outerHTML.length);c.parentNode.removeChild(c);g=g.replace("<br>","");g=g.replace(/<\/.*?>/g,"");g=g.replace(/\s$/,"");""==g&&(a=!0)}else c.parentNode.removeChild(c)}catch(h){c.parentNode.removeChild(c)}}}catch(m){a=!1}return a}
function deleteOlUlUsingKey(a,b){try{var c="which"in a?a.which:a.keyCode,d=getFirstRange().range;if(8==c&&1==d.collapsed){var e=d.startContainer;3==e.nodeType&&(e=e.parentNode);var f=getParentbyTagNameEx(e,"li");if(f){var g=getParentbyTagNameEx(f,"ol,ul"),h=g.getElementsByTagName("li");if(h[0]==f&&isCaretAtTheBeginning()&&null==getParentbyTagNameEx(g.parentNode,"ol,ul")){var m=f.innerHTML;if(0==RegExp("<[ou]l","gi").test(m)){b.UndoManager.putUndo();var q=_iframeDoc.createElement("p");q.innerHTML=
m;""==q.innerHTML&&(q.innerHTML=getDefaultParagraphValue());g.parentNode.insertBefore(q,g);f.parentNode.removeChild(f);0==h.length&&g.parentNode.removeChild(g);setFocusChildForStyle(q);DEXTTOP.DEXT5.util.cancelEvent(a);b.UndoManager.putUndo()}}}}}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function web_url_remove_char(a,b){var c=a;if(b)for(var d=c.toLowerCase(),e=["https://","http://","/"],f=0;f<e.length;f++){var g=d.indexOf(e[f]);if(0==g)break;if(0<g){c=c.substring(g);break}}c=DEXTTOP.DEXT5.util.trim(c);c=c.replace(/(\r\n|\r|\n)/gm,"");c=c.replace(/&#13;/g,"");c=c.replace(/&#10;/g,"");return c=c.replace(/&#32;/g,"")}
function showFileDropArea(a){if(1!=DEXTTOP.G_CURREDITOR.isDragStartedInEditor){var b=document.getElementById("editor_drop_area");if(null==b){b=document.createElement("div");b.id="editor_drop_area";b.style.position="absolute";b.style.left="0px";b.style.top="0px";b.style.width="100%";b.style.height="100%";b.style.backgroundColor="gray";b.style.opacity="0";var c=_iframeWin.frameElement.parentNode;c.style.position="relative";G_Ruler&&G_Ruler.viewRulerStatus&&"2"==DEXTTOP.G_CURREDITOR._config.ruler.mode&&
(c.style.borderTop="0px");c.appendChild(b);DEXTTOP.DEXT5.util.addEvent(b,"dragleave",function(a){b.style.display="none"});DEXTTOP.DEXT5.util.addEvent(b,"mouseover",function(a){b.style.display="none"})}b.style.display=a?"block":"none"}}
function setFontSizeForPpt(a){var b=a;try{var c=document.createElement("div");c.innerHTML=a;a=function(a){for(var b=0;b<a.length;b++){var c=a[b];c&&c.style.lineHeight&&""!=c.style.lineHeight&&c.firstChild&&1==c.firstChild.nodeType&&"span"==c.firstChild.tagName.toLowerCase()&&c.firstChild.style.fontSize&&(c.style.fontSize=c.firstChild.style.fontSize)}};var d=c.getElementsByTagName("div");a(d);var e=c.getElementsByTagName("p");a(e);b=c.innerHTML;c=null;c=void 0}catch(f){}return b}
function getDEXTWINZoomValue(a){var b=1;try{if("1"==a._config.autoSetZoom.use){var c=DEXTTOP.DEXTWIN.document.body;a._config.autoSetZoom&&null!=a._config.autoSetZoom.checkNode&&(c=a._config.autoSetZoom.checkNode);var d=DEXTTOP.DEXTWIN.getComputedStyle(c,null).zoom;void 0!=d&&(b=d)}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return b}
function setZoomValueToBody(a,b){if("1"==b._config.autoSetZoom.use)try{var c=getDEXTWINZoomValue(b);a.body.style.zoom=c}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function changeValueForZoom(a,b){var c=a;try{if("1"==b._config.autoSetZoom.use)var d=getDEXTWINZoomValue(b),c=c/d}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}function urlCheckOrPass(a){return"1"==DEXTTOP.G_CURREDITOR._config.validateUrlLink?DEXTTOP.DEXT5.util.checkUrl(a):!0}
function getImageFileSize(a){var b;if(DEXTTOP.DEXT5.browser.ie&&"ieplugin"==DEXTTOP.G_CURREDITOR._config.runtimes)b=G_dext5plugIn.getSizeByLocation(a);else if("string"==typeof a){if("data:"==a.substring(0,5))try{b=DEXTTOP.DEXT5.util.dataURItoBlob(a).size}catch(c){b=-1}}else"object"==typeof a&&(b=a.size);return b}function checkMaxImageFileSize(a){if(0==DEXTTOP.G_CURREDITOR._config.maxImageFileSize)return!0;a=getImageFileSize(a);return DEXTTOP.G_CURREDITOR._config.maxImageFileSize>a?!0:!1}
function messageForMaxImageFileSize(a){var b="";1==a?(b=dext5_lang.msg.max_file_size,b=b.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(DEXTTOP.G_CURREDITOR._config.maxImageFileSize).toString)):1<a&&(b=dext5_lang.msg.max_image_files_size,b=b.replace("{0}",a));alert(b)}
function imageQualityBool(a,b){var c=!1,c=""==DEXTTOP.G_CURREDITOR._config.imageQuality.extension?!0:-1<DEXTTOP.G_CURREDITOR._config.imageQuality.extension.split(",").indexOf(b.toLowerCase())?!0:!1,d=!1,d=a>DEXTTOP.G_CURREDITOR._config.imageQuality.overFileSize||0==DEXTTOP.G_CURREDITOR._config.imageQuality.overFileSize?!0:!1;return c&&d?!0:!1}
function changeImageQuality(a){var b=G_QualityFileObj.length,c=G_changeCount=0,d="",d=DEXTTOP.DEXT5.UrlStamp;"1"==DEXTTOP.G_CURREDITOR._config.cacheProtectMode&&(d=(new Date).getTime());var d=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.js+"editor_imageProcess.min.js?ver="+d:DEXTTOP.G_CURREDITOR._config.webPath.js_dev+"editor_imageProcess.js?ver="+d,e=DEXTTOP.G_CURREDITOR._config.imageQuality.quality;a&&(e=a);var f=DEXTTOP.G_CURREDITOR._config.imageQuality.workerCount,g=b>=f?f:b;for(a=
0;a<g;a++){var h=new Worker(d);h.onmessage=function(a){a=a.data;switch(a.type){case "complete":var b=a.sendData;a=b.workerIdx;var d=b.newBlob,b=b.newData,e=(G_QualityFileObj[a].fileObj?G_QualityFileObj[a].fileObj:G_QualityFileObj[a].afterRawData).name;e||(e=G_QualityFileObj[a].originalFileName+".jpg");var g=DEXTTOP.DEXT5.util.getExtensionFromFileName(e).toLowerCase();if("jpg"!=g||"jpeg"!=g)e=e.substring(0,e.lastIndexOf("."))+".jpg";d.lastModifiedDate=new Date;d.name=e;G_QualityFileObj[a].fileObj=
d;G_QualityFileObj[a].afterRawData=b;G_workerCount++;G_changeCount+G_workerCount==G_QualityFileObj.length+c?changeImageQualityComplete():(d=G_changeCount+f,G_ChangeImageArr[d-1]&&t(a,G_ChangeImageArr[d-1]));break;case "error":b=a.sendData,a=b.workerIdx,G_workerCount++,G_changeCount+G_workerCount==G_QualityFileObj.length+c?changeImageQualityComplete():(d=G_changeCount+f,G_ChangeImageArr[d-1]&&t(a,G_ChangeImageArr[d-1]))}};G_ImageWorkerArr.push(h)}var m=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("dext5editor_imageCanvas"),
q=m.getContext("2d"),t=function(a,d){return function(a,d){var h=G_QualityFileObj[a].fileObj?G_QualityFileObj[a].fileObj:G_QualityFileObj[a].beforeRawData,u=G_QualityFileObj[a].originalExtension.toLowerCase();if(G_QualityFileObj[a].changeBool){c++;var v=new Image;v.onload=function(){try{(window.URL||window.webkitURL||window).revokeObjectURL(this.src)}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{m.width=v.width;m.height=v.height;q.fillStyle="#fff";q.fillRect(0,0,m.width,m.height);
q.drawImage(v,0,0);var c=m.toDataURL("image/jpeg",e);v.setAttribute("raonk_thumbs","true");delete v;try{q.clearRect(0,0,m.width,m.height),q.beginPath()}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var f=65636;f>h.size&&(f=h.size);var g;g=h.mozSlice?h.mozSlice(0,f):h.webkitSlice?h.webkitSlice(0,f):h.slice(0,f);var t=new FileReader;t.onload=function(b){g=null;b=new Uint8Array(b.target.result);b=[].slice.call(b);b={workerIdx:a,fileIdx:a,imageOriginalData:b,imageNewData:c};G_QualityFileObj[a].afterRawData=
c;G_ImageWorkerArr[a]?G_ImageWorkerArr[a].postMessage({type:"start",sendData:b}):(G_ImageWorkerArr[G_WorkingIdx].postMessage({type:"start",sendData:b}),G_ImageWorkerArr[G_WorkingIdx+1]?G_WorkingIdx++:G_WorkingIdx=0);t=void 0};t.readAsArrayBuffer(g)}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};v.onerror=function(b){null==b.target.getAttribute("raonk_thumbs")&&(G_changeCount++,c--,G_changeCount+G_workerCount==G_QualityFileObj.length+c?changeImageQualityComplete():(b=G_changeCount+
f,G_ChangeImageArr[b-1]&&t(a,G_ChangeImageArr[b-1])))};try{if("string"==typeof h){for(var D=atob(h),A=D.length,C=new Uint8Array(A);A--;)C[A]=D.charCodeAt(A);DEXTTOP.DEXT5.browser.ie?(u8blob=new Blob([C],{type:"image/"+u}),u8blob.lastModifiedDate=new Date,u8blob.name=DEXTTOP.DEXT5.util.makeGuid()+"."+u,G_QualityFileObj[G_changeCount].fileObj=u8blob,h=G_QualityFileObj[G_changeCount].fileObj):(h=new File([C],DEXTTOP.DEXT5.util.makeGuid()+"."+u,{type:"image/"+u}),G_QualityFileObj[G_changeCount].fileObj=
h)}var E=(window.URL||window.webkitURL||window).createObjectURL(h);v.src=E;G_changeCount++}catch(H){G_changeCount++,c--,G_changeCount+G_workerCount==G_QualityFileObj.length+c?changeImageQualityComplete():(u=G_changeCount+f,G_ChangeImageArr[u-1]&&t(a,G_ChangeImageArr[u-1]))}}else G_QualityFileObj[G_changeCount].fileObj||(D=G_QualityFileObj[G_changeCount].beforeRawData,0>D.indexOf("data:image/"+u+";base64,")&&(D="data:image/"+u+";base64,"+D),u=G_QualityFileObj[G_changeCount].originalFileName+"."+G_QualityFileObj[G_changeCount].originalExtension,
A=DEXTTOP.DEXT5.util.dataURItoBlob(D),A.lastModifiedDate=new Date,A.name=u,G_QualityFileObj[a].fileObj=A,G_QualityFileObj[a].afterRawData=D),G_changeCount++,G_changeCount+G_workerCount==b+c?changeImageQualityComplete():(u=G_changeCount+g,G_ChangeImageArr[u-1]&&t(a,G_ChangeImageArr[u-1]))}}();for(a=0;a<G_QualityFileObj.length;a++)t(a,G_QualityFileObj[a].fileObj)}
function changeImageQualityWithoutWorker(a){var b=G_QualityFileObj.length,c=DEXTTOP.G_CURREDITOR._config.imageQuality.quality;a&&(c=a);var d=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("dext5editor_imageCanvas"),e=d.getContext("2d"),f=0,g=function(){return function(){var a=G_QualityFileObj[G_changeCount].fileObj?G_QualityFileObj[G_changeCount].fileObj:G_QualityFileObj[G_changeCount].beforeRawData,m=G_QualityFileObj[G_changeCount].originalExtension.toLowerCase();if(G_QualityFileObj[G_changeCount].changeBool){var q=
new Image;q.onload=function(){try{(window.URL||window.webkitURL||window).revokeObjectURL(this.src)}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}d.width=q.width;d.height=q.height;e.fillStyle="#fff";e.fillRect(0,0,d.width,d.height);e.drawImage(q,0,0);var t=d.toDataURL("image/jpeg",c);q.setAttribute("raonk_thumbs","true");delete q;var u=65636;u>a.size&&(u=a.size);var v;v=a.mozSlice?a.mozSlice(0,u):a.webkitSlice?a.webkitSlice(0,u):a.slice(0,u);var w=new FileReader;w.onload=function(c){v=
null;c=new Uint8Array(c.target.result);c=[].slice.call(c);if(t=DEXTTOP.G_CURREDITOR._FRAMEWIN.ExifRestorer.restore2(c,t)){0>t.indexOf("data:image/jpeg;base64,")&&(t="data:image/jpeg;base64,"+t);c=DEXTTOP.DEXT5.util.dataURItoBlob(t);var d="",d=a.name?a.name:G_QualityFileObj[G_changeCount].originalFileName+"."+G_QualityFileObj[G_changeCount].originalExtension,e=d.substring(d.lastIndexOf(".")+1,d.length).toLowerCase();if("jpg"!=e||"jpeg"!=e)d=d.substring(0,d.lastIndexOf("."))+".jpg";c.lastModifiedDate=
new Date;c.name=d;G_QualityFileObj[G_changeCount].fileObj=c;G_QualityFileObj[G_changeCount].afterRawData=t}G_changeCount++;G_changeCount==b?changeImageQualityComplete():(f++,g(G_ChangeImageArr[f]));w=void 0};w.readAsArrayBuffer(v)};q.onerror=function(a){null==a.target.getAttribute("raonk_thumbs")&&(G_changeCount++,G_changeCount==b?changeImageQualityComplete():(a=G_changeCount+1,G_ChangeImageArr[a-1]&&g(G_ChangeImageArr[a-1])))};try{if("string"==typeof a){for(var t=atob(a),u=t.length,v=new Uint8Array(u);u--;)v[u]=
t.charCodeAt(u);DEXTTOP.DEXT5.browser.ie?(u8blob=new Blob([v],{type:"image/"+m}),u8blob.lastModifiedDate=new Date,u8blob.name=DEXTTOP.DEXT5.util.makeGuid()+"."+m,G_QualityFileObj[G_changeCount].fileObj=u8blob,a=G_QualityFileObj[G_changeCount].fileObj):(a=new File([v],DEXTTOP.DEXT5.util.makeGuid()+"."+m,{type:"image/"+m}),G_QualityFileObj[G_changeCount].fileObj=a)}var w=(window.URL||window.webkitURL||window).createObjectURL(a);q.src=w}catch(y){G_changeCount++,G_changeCount==b?changeImageQualityComplete():
(f++,g(G_ChangeImageArr[f]))}}else G_QualityFileObj[G_changeCount].fileObj||(t=G_QualityFileObj[G_changeCount].beforeRawData,0>t.indexOf("data:image/"+m+";base64,")&&(t="data:image/"+m+";base64,"+t),m=G_QualityFileObj[G_changeCount].originalFileName+"."+G_QualityFileObj[G_changeCount].originalExtension,u=DEXTTOP.DEXT5.util.dataURItoBlob(t),DEXTTOP.DEXT5.browser.ie?(u.lastModifiedDate=new Date,u.name=m,G_QualityFileObj[G_changeCount].fileObj=u):G_QualityFileObj[G_changeCount].fileObj=new File([u],
m),G_QualityFileObj[G_changeCount].afterRawData=t),G_changeCount++,G_changeCount==b?changeImageQualityComplete():(f++,g(G_ChangeImageArr[f]))}}(G_ChangeImageArr[f]);g(G_ChangeImageArr[f])}function changeImageQualityComplete(){for(var a=0;a<G_ImageWorkerArr.length;a++)G_ImageWorkerArr[a]&&G_ImageWorkerArr[a].terminate();G_changeCount=0;G_ImageWorkerArr=[];G_ChangeImageArr=[];G_QualityImgElm=[];G_ImageWorkerArr=[];G_workerCount=0;G_CompleteImageQuality=!0}
function getDocumentForDummy(){var a=null;try{if("function"==typeof DOMParser){var b=(new DOMParser).parseFromString("","text/html");b&&9==b.nodeType&&(a=b)}else a=document}catch(c){a=document}return a}function applyFakeImgSrc(a,b){var c=a;return c=!0===b?c.replace(/<img[^>]*? raon-tsrc=/gi,function(a){return a.replace(" raon-tsrc="," src=")}):c.replace(/<img[^>]*? src=/gi,function(a){return a.replace(" src="," raon-tsrc=")})}
function isMobileAndFixBottom(){var a=!1;DEXTTOP.DEXT5.browser.mobile&&"2"==DEXTTOP.G_CURREDITOR._config.mobilePopupMode&&(a=!0);return a}function replaceMsStyleName(a,b){var c=a;try{for(var d=b._config.replaceMsStyleName,e=0;e<d.length;e++)c=c.replace(new RegExp("<\\w{1,} [^>]*("+d[e]+":).*?>","gi"),function(a,b){return a.replace(b,b.replace("-ms-",""))})}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}
function dingBatFont(a,b){var c=!1;""==a&&(c=!0,a=b._BODY.innerHTML);var d=a;if("1"==b._config.compatibility.dingBatChar&&"undefined"!=typeof DEXT5_DINGBAT_FONTS)try{for(var e=function(a,b){for(var c=a.childNodes,d=c.length-1;0<=d;d--){var e=c[d];if(3==e.nodeType&&""==a.style.fontFamily){for(var f=e,g=b,e=e.nodeValue.split(""),h="",m=0;m<e.length;m++)h=void 0!=DEXT5_DINGBAT_FONTS[g]&&void 0!=DEXT5_DINGBAT_FONTS[g][e[m]]?h+DEXT5_DINGBAT_FONTS[g][e[m]]:h+DEXT5_DINGBAT_FONTS.DefaultChar;f.nodeValue=
h}}},f=function(a,b){for(var c=a.getElementsByTagName("*"),d=c.length-1;0<=d;d--){var f=c[d];1==f.nodeType&&e(f,b)}e(a,b)},g=function(a){var b=a;if(-1<b.indexOf(' class="')){var c=b.indexOf(' class="');a=b.substring(0,c+8);b=b.substring(c+8);b=a+"de_dingbat "+b}else b=b.replace(">",' class="de_dingbat">');return b},h=document.createElement("div"),m=0;m<DEXT5_DINGBAT_FONTS.FontList.length;m++){var q=DEXT5_DINGBAT_FONTS.FontList[m],t=!1,u=q,v=q;-1<q.indexOf(" ")&&(t=!0,u="&quot;"+u+"&quot;",v='"'+v+
'"');var w=new RegExp("<span [^>]*font-family:\\s*"+u+".*?>","gi");w.test(a)?a=a.replace(w,function(a){return g(a)}):t&&(w=new RegExp("<span [^>]*font-family:\\s*"+v+".*?>","gi"),w.test(a)&&(a=a.replace(w,function(a){return g(a)})));h.innerHTML=a;for(var y=getElementsByClassNameEx(h,"de_dingbat"),x=y.length-1;0<=x;x--){var z=y[x];_font=z.style.fontFamily;v==_font&&(z.style.fontFamily="",z.className=z.className.replace("de_dingbat",""),""==z.className&&z.removeAttribute("class"),f(z,q))}a=h.innerHTML}h=
null;h=void 0}catch(B){c&&(b._BODY.innerHTML=d),a=d}c&&(b._BODY.innerHTML=a);c&&(b._BODY.innerHTML=a);return a}
function replaceFontFamilyInHtml(a,b){var c=a,d=b._config.forceFontFamilyChangeObject;if(d)try{if((new RegExp("<[^>]+font-family:\\s*(&quot;|'|\")*("+d.targetFontReg+")","gi")).test(c)){var e=DEXTTOP.DEXT5.util.splitBodyInnerString(c),f=e.body;try{f=b._FRAMEWIN.applyFakeImgSrc(f)}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var h=getDocumentForDummy().createElement("div");h.innerHTML=f;for(var m=h.getElementsByTagName("*"),q=m.length,f=0;f<q;f++){var t=m[f];if(1==t.nodeType){var u=
t.style.fontFamily;"FONT"==t.tagName&&""==u&&(u=t.face);if(""!=u){for(var v=!1,w=u.toLowerCase().split(","),y=w.length-1;0<=y;y--){var x=w[y],x=DEXTTOP.DEXT5.util.trim(x),x=x.replace(/['"]/g,""),z,B=x,D=null,A=d.definedNewFont[B];if("string"==typeof A)D=A;else for(p in d.definedNewPrefixFont)if(0==B.toLowerCase().indexOf(p)&&(A=d.definedNewPrefixFont[p],"string"==typeof A)){D=A;break}z=D;"string"==typeof z&&(0==v&&(v=!0),""==z?w.splice(y,1):(z=changeFontFamily(z),w[y]=z))}v&&(0==w.length?DEXTTOP.DEXT5.util.removeStyleAttribute(t,
"font-family"):t.style.fontFamily=w.join(","),""==t.getAttribute("style")&&t.removeAttribute("style"))}}}c=e.head+h.innerHTML+e.tail;try{c=b._FRAMEWIN.applyFakeImgSrc(c,!0)}catch(C){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}catch(E){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}
function replaceEmptySpaceInATag(a){a=a.getElementsByTagName("a");for(var b=a.length,c="",c=DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?unescape("%u200B"):unescape("%uFEFF"),d=0;d<b;d++){var e=a[d].getAttribute("href");0!=a[d].innerHTML.length||null!=e&&""!=e||(a[d].innerHTML=c)}}
function Ruler(a){this.editorID=a.ID;this.editorComponent=a;DEXTTOP.DEXT5.browser.mobile&&(a._config.ruler.viewGuideLine="0",a._config.ruler.viewPointer="0");this.viewRulerStatus="1"==a._config.ruler.use&&"1"==a._config.ruler.defaultView;this.rulerPositionArr=[];if(G_BodyFit.widthFixableStatus){var b=parseIntOr0(G_BodyFit.fixedWidth),c=parseIntOr0(a._config.defaultBodySpace.configValue.left),b=b+(c+a._config.widthFix.padding);this.rulerPositionArr=[b+""]}else 0==a._config.ruler.rulerInitPosition.length?
"2"==a._config.ruler.mode&&(this.rulerPositionArr=[parseIntOr0(getCurrEditorWidth())],a._config.ruler.autoFitMode="1"):this.rulerPositionArr=a._config.ruler.rulerInitPosition;this.maxRulerPosition=this.rulerPositionArr[this.rulerPositionArr.length-1];this.rulerPositionLen="1"==a._config.ruler.mode?this.rulerPositionArr.length:4;this._doc=getEditorFrameDoc(a);this.rulerPointLineArea=this.rulerBottomArea=this.rulerArea=null;this._init=!1;this.vRuler0PositionTop=this.hRuler0PositionLeft=0}
Ruler.prototype.SelectIcon=function(){var a=this.editorComponent,b=document.getElementById("dext_span_"+this.editorID+"ruler");if(b){var c=DEXTTOP.DEXT5.util.getClass(b);this.viewRulerStatus?(DEXTTOP.DEXT5.util.setClass(b,c+" uebutton_span_enter"),b.style.backgroundImage="url("+a._config.webPath.image+"skin/"+a._config.style.skinName+"/skinback_release.gif)"):(c=DEXTTOP.DEXT5.util.replaceAll(c,"uebutton_span_enter",""),c=DEXTTOP.DEXT5.util.trim(c),DEXTTOP.DEXT5.util.setClass(b,c),b.style.backgroundImage=
"")}};Ruler.prototype.SettingInit=function(){this._init=!0;var a=this.editorID,b=this._doc;this.rulerArea=b.getElementById("dext_tab_tool3_"+a);this.rulerBottomArea=b.getElementById("dext_tab_tool4_"+a);this.rulerPointLineArea=b.getElementById("dext_ruler_pointline_div")};Ruler.prototype.RulerUiInit=function(){var a=this.editorComponent;"1"==a._config.ruler.viewPointer&&this.SyncRulerCount("viewPointer");"1"==a._config.ruler.viewGuideLine&&this.SyncRulerCount("viewGuideLine")};
Ruler.prototype.SetRulerPosition=function(){if(this.viewRulerStatus){var a=this.editorComponent;this.viewRulerStatus&&"view"!=a._config.mode&&(set_ruler_horizontal_width(a),this._init&&(this.SetRulerHeight(),"1"==a._config.ruler.useVertical&&set_ruler_vertical_height(a),"1"==a._config.horizontalLine.use&&set_horizontal_line_2(a),"1"==a._config.ruler.mode?(set_ruler_point_position(a),set_ruler_pointline_position(a)):setRulerPositionForNode(a,!1)))}};
Ruler.prototype.SyncRulerCount=function(a){var b=this.editorComponent,c=this.editorID,d=!0,e=null,f=0,g=this.rulerPositionLen;"viewPointer"==a?("2"==b._config.ruler.mode&&(g=3),e=this.rulerArea.getElementsByTagName("img")):e=this.rulerPointLineArea.getElementsByTagName("div");f=e.length;if(g!=f)for(d=!1,--f;0<=f;f--)e[f].parentNode.removeChild(e[f]);if(0==d)for(f=0;f<g;f++)"viewPointer"==a?(d=this._doc.createElement("img"),d.id="dext_ruler_point_"+f+"_"+c,d.src="../images/bg/point.gif",d.style.verticalAlign=
"top",d.style.border="0px",d.style.width="14px",d.style.height="9px",d.style.margin="0 0 0 -7",d.style.display="none",d.style.position="absolute",d.style.top="-1px",this.rulerArea.appendChild(d),d.onmousedown=function(){return!1},d.unselectable="on"):(d=this._doc.createElement("div"),d.id="dext_ruler_pointline_"+f+"_"+c,d.style.position="absolute",d.style.zIndex="9999",d.style.borderLeft=b._config.ruler.guideLineStyle+" 1px "+b._config.ruler.guideLineColor,d.style.display="none",this.rulerPointLineArea.appendChild(d))};
Ruler.prototype.GetLeftPosition=function(a,b){var c=this.editorComponent,d=0,d=0;a&&(d=parseIntOr0(a.style.width),d=parseIntOr0(b)-d/2);var e;"preview"==c.getEditorMode()?(e=c._EDITOR.preview.contentWindow.document.documentElement,c=c._EDITOR.preview.contentWindow.document.body):(e=_iframeDoc.documentElement,c=_iframeDoc.body);c=e.scrollLeft||c.scrollLeft||0;return d=isRTL()?d+c:d-c};
Ruler.prototype.SetRulerHeight=function(){for(var a=this.editorComponent,b=this.editorID,c=this._doc.getElementById("ue_editor_holder_"+b),d=0;d<this.rulerPositionLen;d++){var e=this._doc.getElementById("dext_ruler_pointline_"+d+"_"+b);if(e)if("2"!=a._config.ruler.mode||"2"==a._config.ruler.mode&&(0==d||3==d))e.style.top=c.offsetTop+"px",e.style.height=c.style.height;else{var f=parseIntOr0(this.rulerBottomArea.style.height);e.style.top=c.offsetTop-f+"px";e.style.height=parseIntOr0(c.style.height)+
f+"px"}}"1"==a._config.ruler.autoFitMode||"2"!=a._config.ruler.mode||G_BodyFit.useNoncreationAreaBackground||(e="right",isRTL()&&(e="left"),e=getClientRect(this.editorComponent._BODY)[e],isRTL()&&(e=getClientRect(_iframeWin.frameElement).right-e),0<e&&(d=parseIntOr0(e),"1"==a._config.ruler.useVertical&&(d+=18),f=parseIntOr0(this.rulerBottomArea.style.height),e=this._doc.getElementById("dext_ruler_pointline_4_"+b),e.style.top=c.offsetTop-f+"px",isRTL()?(e.style.left="auto",e.style.right=d+"px"):e.style.left=
d+"px",e.style.height=parseIntOr0(c.style.height)+f+"px",e.style.display=""))};
Ruler.prototype.SetRulerPositionApi=function(a){var b=this.editorComponent;a=(a+"").split(",");for(var c=0;c<a.length;c++)a[c]=parseIntOr0(a[c])+"";this.rulerPositionArr=a.sort(function(a,b){return a-b});this.maxRulerPosition=parseIntOr0("1"==b._config.ruler.autoFitMode?getCurrEditorWidth():this.rulerPositionArr[this.rulerPositionArr.length-1]);this.rulerPositionLen="1"==b._config.ruler.mode?this.rulerPositionArr.length:4;G_BodyFit&&(G_BodyFit.fixedWidth=this.rulerPositionArr[G_Ruler.rulerPositionArr.length-
1]);this.RulerUiInit();G_BodyFit.SetBodyWidth();this.SetRulerPosition()};
function BodyFit(a){this.editorID=a.ID;this.editorComponent=a;this.widthFixableStatus=!(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion)&&""!=a._config.widthFix.defaultView&&""!=a._config.widthFix.value;this.widthFixedStatus=!1;this.fixedWidth="";var b="1"==a._config.ruler.use;this.widthFixableStatus&&(this.fixedWidth=a._config.widthFix.value);this.widthFixStatus=this.widthFixableStatus&&"1"==a._config.widthFix.defaultView||!this.widthFixableStatus&&b&&"1"==a._config.autoBodyFit;this.useNoncreationAreaBackground=
"1"==a._config.useNoncreationAreaBackground||""!=a._config.widthFix.backgroundColor;this.noncreationAreaBackgroundStatus=!1;this.noncreationAreaBackgroundColor=""!=a._config.widthFix.backgroundColor?a._config.widthFix.backgroundColor:"#e6e6e6"}
BodyFit.prototype.SetBodyWidth=function(a){var b=this.editorComponent,c=0;void 0!==a?c=a:this.widthFixStatus?this.widthFixableStatus?(c=this.fixedWidth,this.widthFixedStatus=!0):c=this.GetBodyWidthInRulerSetting():this.widthFixableStatus||(c=this.GetBodyWidthInRulerSetting());this.SelectIcon();c?(0==this.widthFixableStatus?"1"==b._config.defaultBodySpace.use?this.widthFixableStatus&&!this.widthFixStatus||!this.widthFixableStatus&&"1"==b._config.ruler.autoFitMode?(c-=parseIntOr0(b._config.defaultBodySpace.configValue.left)+
parseIntOr0(b._config.defaultBodySpace.configValue.right)+15,G_Ruler&&G_Ruler.viewRulerStatus&&"1"==b._config.ruler.useVertical&&(c-=18)):c-=parseIntOr0(b._config.defaultBodySpace.configValue.left):c-=35:c=parseIntOr0(c),b._defTableWidth=c,b._defaultWidth=c,_iframeDoc.body.style.width=c+"px",setEditorHtmlWidth(b)):(0<_iframeDoc.body.clientWidth&&(b._defTableWidth=_iframeDoc.body.clientWidth-30,b._defaultWidth=_iframeDoc.body.clientWidth-30),_iframeDoc.body.style.width="",_iframeDoc.documentElement.style.width=
"");100>b._defTableWidth&&(b._defTableWidth=400,b._defaultWidth=400);"1"==b._config.widthFix.alignCenter&&(_iframeDoc.documentElement.style.marginLeft="auto",_iframeDoc.documentElement.style.marginRight="auto")};
BodyFit.prototype.SelectIcon=function(){if(this.widthFixableStatus){var a=this.editorComponent,b=document.getElementById("dext_span_"+this.editorID+"body_fit");if(b){var c=DEXTTOP.DEXT5.util.getClass(b);this.widthFixStatus?(DEXTTOP.DEXT5.util.setClass(b,c+" uebutton_span_enter"),b.style.backgroundImage="url("+a._config.webPath.image+"skin/"+a._config.style.skinName+"/skinback_release.gif)"):(c=DEXTTOP.DEXT5.util.replaceAll(c,"uebutton_span_enter",""),c=DEXTTOP.DEXT5.util.trim(c),DEXTTOP.DEXT5.util.setClass(b,
c),b.style.backgroundImage="")}}};BodyFit.prototype.GetBodyWidthInRulerSetting=function(){var a=this.editorComponent,b=0;G_Ruler&&"1"==a._config.autoBodyFit&&("1"==a._config.ruler.autoFitMode?"1"==a._config.ruler.fixEditorWidth&&(b=getCurrEditorWidth(),G_Ruler.maxRulerPosition=b):b=G_Ruler.maxRulerPosition);return b};function beforeGetApi(a,b){G_BodyFit.noncreationAreaBackgroundStatus&&G_BodyFit.widthFixStatus&&setBodyFitStyle(a,!1,b)}
function afterGetApi(a,b){G_BodyFit.widthFixStatus&&setBodyFitStyle(a,!0,b)}
function removeDomainFromIMGObjectInVirtualDom(a,b){var c=b;if("/"==a._config.serverDomain)try{var d=DEXTTOP.DEXT5.util.splitBodyInnerString(c),e=DEXTTOP.location.href.substring(0,DEXTTOP.location.href.indexOf(DEXTTOP.location.pathname)),f=getDocumentForDummy().createElement("div");f.innerHTML=d.body;for(var g=f.getElementsByTagName("img"),h=0,m=g.length,q;h<m;h++){var t=g[h].src;"string"==typeof t&&(q=!0,"undefined"!=typeof DEXTTOP.DEXT5.config.ServerDomainStartWithUrl&&0!=t.indexOf(DEXTTOP.DEXT5.config.ServerDomainStartWithUrl)&&
(q=!1),0==t.indexOf(e)&&q&&g[h].setAttribute("src",t.substring(e.length)))}c=d.head+f.innerHTML+d.tail}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}function getChangedSizeForPPTImage(a){try{return Math.round(.64*a)}catch(b){return a}}
function execBlobToBase64(a,b){var c=0,d=a.length,e=[],f=function(a){c++;e.push(a);c==d?b(e):g()},g=function(){var b=a[c],d=new FileReader;d.onload=function(a){var b=new Image;b.onload=function(c){c=b.fileName;G_OriginalMultiImageSize_src[c]={width:b.width,height:b.height};G_Base64FileNameMap[a.target.result]=c;b=null;b=void 0;f(a.target.result)};b.fileName=d.fileName;b.src=a.target.result};d.onerror=function(){f("error")};d.fileName=b.name;d.readAsDataURL(b)};g()}
function execBlobD5FileDetector(a,b){var c=0,d=a.length,e=[],f=function(a,f,h){c++;0==h?e.push(!0):e.push(!1);c==d?b(e):g()},g=function(){var b=a[c],d=b.name.split(".").pop();D5FileDetector(b,d,f)};if(-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector)g();else{for(var h=0;h<d;h++)e.push(!1);b(e)}}
function execBlobCheckMaxImageFileSize(a){for(var b=a.length,c=[],d=0;d<b;d++)checkMaxImageFileSize(a[d])?c.push(!1):c.push(!0);return c}function checkXssContentType(a,b){var c=!1,d={};b&&(d=b);d=d.editor;void 0==d&&(d=DEXTTOP.G_CURREDITOR);if("string"==typeof a&&"1"==d._config.xss_use){var d=["data:text/html","data:image/svg+xml","data:application/xml"],e=d.length;for(k=0;k<e;k++)if(-1<a.toLowerCase().indexOf(d[k])){c=!0;break}}return c}
function replaceCharToWingdings(a){return a=a.replace(RegExp("(\uf09f)","g"),'<span style="font-family: Wingdings;">$1</span>')}
function handlingSpacingTableInHwp(a){var b=a,c=getDocumentForDummy().createElement("div");c.innerHTML=b;var b=c.getElementsByTagName("table"),d=b.length;if(0<d){for(a=d-1;0<=a;a--){d=b[a];""==d.style.marginTop&&(d.style.marginTop="6px");""==d.style.marginBottom&&(d.style.marginBottom="6px");var e=d;(d=d.parentNode)&&"P"==d.tagName&&(e=d);for(var d=[],e=e.nextSibling,f=!1;null!=e;)if("P"==e.tagName)if("<p></p>"==e.outerHTML.toLowerCase())d.push(e),e=e.nextSibling;else{var g=e.childNodes;if(1==g.length&&
"SPAN"==g[0].tagName&&"hnc_page_break"==g[0].className&&"&nbsp;"==g[0].innerHTML){d.push(e);break}else if(0==f)f=!0,e=e.nextSibling;else break}else if(3==e.nodeType&&e.data&&""==e.data.replace(/\s/g,""))e=e.nextSibling;else break;e=d.length;for(f=0;f<e;f++)g=d[f],g.parentNode.removeChild(g)}b=c.innerHTML}else b=a;return b}
function getCellLastChildNode(a){var b=1;do if(a=a.lastChild,null!=a.previousSibling&&(3==a.nodeType&&"\n"==a.data||"br"==a.nodeName.toLowerCase())&&(a=a.previousSibling),"<br>"==a.innerHTML){b=0;break}while(3!=a.nodeType);return{node:a,position:b}}
function handlingFontFamilyInHwp(a){return a=a.replace(/(?:<span.*?style=["'].*?font-family:\s*([^;'"]+).*?["'].*?>)/g,function(a,c){for(var d=c.split(","),e=d.length,f=/[ .]/,g=!1,h=0;h<e;h++){var m=d[h].replace(/['"]|(&quot;)/g,""),m=DEXTTOP.DEXT5.util.trim(m);f.test(m)&&(g=!0,d[h]="&quot;"+m+"&quot;")}g&&(d=d.join(","),a=a.replace(c,d));return a})}
function getNodeLastChildNode(a){for(;a&&3!=a.nodeType&&(null!=a.previousSibling&&(3==a.nodeType&&"\n"==a.data||"br"==a.nodeName.toLowerCase())&&(a=a.previousSibling),null!=a.lastChild);)a=a.lastChild;return a}
function replaceFontTagToSpan(a,b){if("1"==a._config.compatibility.fontTagToSpan){var c=b?b:a._DOC;try{for(var d=c.getElementsByTagName("font"),e=c="",f="",g=d.length-1;0<=g;g--){var h=d[g],m=a._DOC.createElement("span"),c=h.face,e=h.color;switch(h.size){case "1":f="8pt";break;case "2":f="10pt";break;case "3":f="12pt";break;case "4":f="14pt";break;case "5":f="18pt";break;case "6":f="24pt";break;case "7":f="36pt";break;default:f=h.size}c&&""!=c&&(m.style.fontFamily=c);e&&""!=e&&(m.style.color=e);f&&
""!=f&&(m.style.fontSize=f);m.style.cssText=DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion?m.style.cssText+("; "+h.style.cssText):m.style.cssText+h.style.cssText;for(var q=0;q<h.attributes.length;q++){var t=h.attributes[q];switch(t.name){case "face":case "color":case "size":case "style":break;default:h.getAttribute(t.name)&&""!=h.getAttribute(t.name)&&m.setAttribute(t.name,t.value)}}for(h.parentNode.insertBefore(m,h);h.hasChildNodes();)m.appendChild(h.firstChild?h.firstChild:h.childNodes[0]);
h.parentNode.removeChild(h)}}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}
function Diagonal(a){this.editorID=a.ID;this.editorComponent=a;this.resizeObserver=null;this.util={getDiagonalValue:function(a,c){var d={lineWidth:0,deg:0},e=getClientRect(a),f=e.right-e.left,e=e.bottom-e.top,f=0===f?DEXTTOP.DEXT5.util.parseIntOr0(a.width):f,e=0===e?DEXTTOP.DEXT5.util.parseIntOr0(a.height):e;d.lineWidth=Math.sqrt(Math.pow(f,2)+Math.pow(e,2));f=180*Math.atan2(e,f)/Math.PI;"up"===c&&(f*=-1);d.deg=f;return d},setDiagonalTransform:function(a,c,d,e){a=c.getElementsByTagName("dext_diagonal_"+
a);for(var f=0;f<a.length;f++){var g=a[f];g.parentNode==c&&(g.style.width=d+"px",g.style.height="0",g.style.transform="translate(-50%, -50%) rotate("+e+"deg)",g.style.top="50%",g.style.left="50%",g.style.cursor="text",g.style.zIndex=-1)}},replaceEmptySpaceInDiagonal:function(a){if(a)a.innerHTML=unescape("%uFEFF");else{var c=DEXTTOP.G_CURREDITOR._BODY;a=c.getElementsByTagName("dext_diagonal_up");for(var c=c.getElementsByTagName("dext_diagonal_down"),d=0;d<a.length;d++)a[d].innerHTML=unescape("%uFEFF");
for(d=0;d<c.length;d++)c[d].innerHTML=unescape("%uFEFF")}},changeStyle:function(a,c){a.style.borderTop=c}}}
Diagonal.prototype.getResizeObserver=function(){if(null===this.resizeObserver){var a=this;try{"undefined"!=typeof ResizeObserver&&(this.resizeObserver=new ResizeObserver(function(b){try{for(var d=0;d<b.length;d++){var e=b[d].target,f=e.getElementsByTagName("dext_diagonal_up"),g=e.getElementsByTagName("dext_diagonal_down");if(0<f.length)for(var h=0;h<f.length;h++){var m=f[h];if(m.parentNode==e){if(e.lastChild!=m){var q=m;e.removeChild(q);e.appendChild(q)}var t=a.util.getDiagonalValue(e,"up");a.util.setDiagonalTransform("up",
e,t.lineWidth,t.deg)}}if(0<g.length)for(h=0;h<g.length;h++){var u=g[h];u.parentNode==e&&(e.lastChild!=u&&(q=u,e.removeChild(q),e.appendChild(q)),t=a.util.getDiagonalValue(e,"down"),a.util.setDiagonalTransform("down",e,t.lineWidth,t.deg))}}}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}))}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}return this.resizeObserver};
Diagonal.prototype.setResizeForDiagonal=function(a,b){try{var c=this.getResizeObserver();if(a)c.observe(a);else{var d;d=b?b:this.editorComponent._BODY;var e=d.getElementsByTagName("dext_diagonal_up"),f=d.getElementsByTagName("dext_diagonal_down");for(d=0;d<e.length;d++)c.observe(e[d].parentNode);for(d=0;d<f.length;d++)c.observe(f[d].parentNode)}}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};
Diagonal.prototype.makeDiagonal=function(a,b,c,d,e,f){if(a)try{a.style.position="relative";a.style.overflow="hidden";a.style.zIndex=1;-1==a.className.indexOf("dext_diagonal_td")&&DEXTTOP.DEXT5.util.addClass(a,"dext_diagonal_td");var g=findDiagonal(a,!0),h=[];g&&(h=g["diagonal"+b.charAt(0).toUpperCase()+b.slice(1)]);if(0==h.length){var m=_iframeDoc.createElement("dext_diagonal_"+b),q=this.util.getDiagonalValue(a,b);DEXTTOP.DEXT5.util.addClass(m,"dext_diagonal");if(e&&0<e.length)for(b=0;b<e.length;b++)DEXTTOP.DEXT5.util.addClass(m,
e[b]);m.contentEditable=!1;m.style.display="block";m.style.position="absolute";m.style.transformOrigin="center";m.style.top="50%";m.style.left="50%";m.style.borderTop=c;m.style.width=q.lineWidth+"px";m.style.height="0";m.style.transform="translate(-50%, -50%) rotate("+q.deg+"deg)";m.style.cursor="text";m.style.zIndex=f?"":-1;this.util.replaceEmptySpaceInDiagonal(m);f||(1==a.childNodes.length?""!=a.childNodes[0].innerHTML&&"&nbsp;"!=a.childNodes[0].innerHTML||0!=a.innerHTML.indexOf("<p")?"\u3000"==
a.innerHTML&&(a.innerHTML=getCellDefValue()):a.innerHTML=getCellDefValue():0!=a.childNodes.length||""!=a.innerHTML&&"&nbsp;"!=a.innerHTML||(a.innerHTML=getCellDefValue()));a.appendChild(m)}else 0<h.length&&h[0].style.borderTop!=c&&(h[0].style.borderTop=c);d||this.setResizeForDiagonal(a)}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};
Diagonal.prototype.addStyleForIE=function(){var a=_iframeDoc.getElementById("dext_diagonal_notIE"),b=function(){var a=_iframeDoc.createElement("style");a.id="dext_diagonal_notIE";a.innerText="@media \\0screen\\,screen\\9 {.dext_diagonal { display:none !important;}.dext_diagonal_td { position: static !important; overflow: visible !important; }}@media screen and (-ms-high-contrast: active),(-ms-high-contrast: none) {.dext_diagonal { display:none !important;}.dext_diagonal_td { position: static !important; overflow: visible !important; }}@media screen and (min-width:0\\0) {.dext_diagonal { display:none !important;}.dext_diagonal_td { position: static !important; overflow: visible !important; }}";
_iframeDoc.body.appendChild(a)};a?a.parentNode&&a.parentNode.tagName&&"HEAD"==a.parentNode.tagName&&(a.parentNode.removeChild(a),b()):b()};
function findDiagonal(a,b,c){var d={diagonalUp:[],diagonalDown:[]};a||(a="undefined"!==typeof c?c._BODY:_iframeDoc.body);c=[];var e=[];if(b)for(a=a.childNodes,b=0;b<a.length;b++){var f=a[b].tagName;f&&(-1<f.indexOf("DEXT_DIAGONAL_")||-1<f.indexOf("/DEXT_DIAGONAL_"))&&("UP"==f.split("_")[2]?c.push(a[b]):"DOWN"==f.split("_")[2]&&e.push(a[b]))}else c=a.getElementsByTagName("dext_diagonal_up"),e=a.getElementsByTagName("dext_diagonal_down");if(0==c.length&&0==e.length)return null;0<c.length&&(d.diagonalUp=
c);0<e.length&&(d.diagonalDown=e);return d}
function deleteDiagonalLine(a,b,c,d,e){var f="undefined"!==typeof c?c._BODY:_iframeDoc.body,g="undefined"!==typeof c?c._DOC:_iframeDoc;c=function(a,b){try{for(var c=0;c<a.length;c++){var d=a[c].parentNode;b&&b.disconnect(d);d.removeChild(a[c]);findDiagonal(d,!0)||(d.style.position="",d.style.overflow="")}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};var h=function(){if(!findDiagonal(f)){var a=g.getElementById("dext_diagonal_notIE");a&&a.parentNode&&a.parentNode.removeChild(a)}};
try{if(!d){var m,q,t,u="undefined"!=typeof G_DEXT_Diagonal&&G_DEXT_Diagonal?G_DEXT_Diagonal.getResizeObserver():null;if(a){if(m=findDiagonal(a,!0))switch(b){case "up":q=m.diagonalUp;break;case "down":t=m.diagonalDown;break;default:q=m.diagonalUp,t=m.diagonalDown}}else!e&&(m=findDiagonal(f))&&(q=m.diagonalUp,t=m.diagonalDown);q&&0<q.length&&c(q,u);t&&0<t.length&&c(t,u)}h()}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setSelectCell(a){var b=a.cell,c=a.editor;if(0==!!b){restoreSelection();var d=getFirstRange().range;d&&(b=GetTDTHCell(d.startContainer))}if(b)if(a="string"==typeof a.mode?a.mode:"",""==a&&(a="selectCell"),a=a.replace("select","select_"),a=a.toLowerCase(),ClearDraggingTableCellSelected(),ActiveCurrTable=null,"select_clear"!=a)if("select_cell"==a){if(d=null,d="function"==typeof Array.isArray&&Array.isArray(b)?b:[b])for(var b=d.length,e=0;e<b;e++)command_TableSelect("",c,a,d[e])}else command_TableSelect("",
c,a,b);else c=getFirstRange().range.startContainer,3==c.nodeType&&(c=c.parentNode),_iframeDoc_MouseUpMenu(null,c)}function convertCustomFilter(a,b){var c=new CustomFilter(a,b);c.convertNode();c.convertAttribute();c.convertStyle();return c.getHtml()}
function CustomFilter(a,b){this.options="object"===typeof b?b:{};this.splitHtmlData=DEXTTOP.DEXT5.util.splitBodyInnerString(a);this.dummyDom=getDocumentForDummy().createElement("div");this.dummyDom.innerHTML=this.splitHtmlData.body;this.getObject=function(a){a="object"===typeof a?a:{};a.nodeName="string"===typeof a.nodeName?DEXTTOP.DEXT5.util.removeWhiteSpace(a.nodeName):"";a.styleName="string"===typeof a.styleName?DEXTTOP.DEXT5.util.removeWhiteSpace(a.styleName):"";a.attributeName="string"===typeof a.attributeName?
DEXTTOP.DEXT5.util.removeWhiteSpace(a.attributeName):"";return a};this.isSupportedQuerySelector="function"===typeof this.dummyDom.querySelectorAll?!0:!1;this.getNodesByNodeName=function(a){var b=null;this.isSupportedQuerySelector&&(b=this.dummyDom.querySelectorAll(a));return b};this.getNodesByStyleName=function(a,b){var e=null;this.isSupportedQuerySelector&&(e=a,"*"===e&&(e=""),e=this.dummyDom.querySelectorAll(e+'[style*="'+b+'"]'));return e};this.getNodesByAttributeName=function(a,b){var e=null;
this.isSupportedQuerySelector&&(e=a,"*"===e&&(e=""),e=this.dummyDom.querySelectorAll(e+"["+b+"]"));return e};this.fnConvertNode=function(){var a=this.options.arrayConvertNode;if("object"===typeof a)for(var b=a.length,e=0;e<b;e++){var f=a[e],g=f.nodeName;if(""!==g){var g=g.split(","),h=g.length,m=!1,q=!1,f=this.getObject(f.after),t=f.nodeName;""===t&&(m=!0);if(!1===m){""!==f.styleName&&(q=!0);if(!0===q)for(m=0;m<h;m++)for(var u=g[m],q=this.getNodesByNodeName(u),v=q.length,w=0;w<v;w++){var y=DEXTTOP.DEXT5.util.convertStyleNameToCamelCase(f.styleName);
q[w].style[y]=f.styleValue}f=this.dummyDom.innerHTML;for(m=0;m<h;m++)u=g[m],q=new RegExp("<"+u+"[ >]","gi"),f=f.replace(q,function(a){return a.replace(u,t)}),q=new RegExp("</"+u+">","gi"),f=f.replace(q,"</"+t+">")}else for(f=this.dummyDom.innerHTML,m=0;m<h;m++)u=g[m],q=new RegExp("<"+u+" .*?>","gi"),f=f.replace(q,""),q=new RegExp("<"+u+">","gi"),f=f.replace(q,""),q=new RegExp("</"+u+">","gi"),f=f.replace(q,"");this.dummyDom.innerHTML=f}}};this.fnConvertAttribute=function(){var a=this.options.arrayConvertAttribute;
if("object"===typeof a)for(var b=a.length,e=0;e<b;e++){var f=a[e],g=f.nodeName,h=f.attributeName;if(""!==g&&""!==h){var g=g.split(","),m=g.length,h=h.split(","),q=h.length,f=this.getObject(f.after),t=f.styleName,f=f.attributeName,u=!1,v=!1;""!==t&&(u=!0);""!==f&&(v=!0);for(var t=DEXTTOP.DEXT5.util.convertStyleNameToCamelCase(t),w=0;w<m;w++)for(var y=g[w],x=0;x<q;x++)for(var z=h[x],B=this.getNodesByAttributeName(y,z),D=B.length,A=0;A<D;A++){var C=B[A],E=C.getAttribute(z);C.removeAttribute(z);u&&(C.style[t]=
E);v&&C.setAttribute(f,E)}}}};this.fnConvertStyle=function(){var a=this.options.arrayConvertStyle;if("object"===typeof a)for(var b=a.length,e=0;e<b;e++){var f=a[e],g=f.nodeName,h=f.styleName;if(""!==g&&""!==h){var g=g.split(","),m=g.length,h=h.split(","),q=h.length,f=this.getObject(f.after),t=f.styleName,f=f.attributeName,u=!1,v=!1;""!==t&&(u=!0);""!==f&&(v=!0);for(var t=DEXTTOP.DEXT5.util.convertStyleNameToCamelCase(t),w=0;w<m;w++)for(var y=g[w],x=0;x<q;x++)for(var z=h[x],B=DEXTTOP.DEXT5.util.convertStyleNameToCamelCase(z),
D=this.getNodesByStyleName(y,z),A=D.length,C=0;C<A;C++){var E=D[C],H=E.style[B];DEXTTOP.DEXT5.util.removeStyleAttribute(E,z);u&&(E.style[t]=H);v&&E.setAttribute(f,H)}}}};this.fnGetHtml=function(){return this.splitHtmlData.head+this.dummyDom.innerHTML+this.splitHtmlData.tail}}CustomFilter.prototype.convertNode=function(){this.fnConvertNode()};CustomFilter.prototype.convertAttribute=function(){this.fnConvertAttribute()};CustomFilter.prototype.convertStyle=function(){this.fnConvertStyle()};
CustomFilter.prototype.getHtml=function(){return this.fnGetHtml()};
function replaceWhiteSpaceStyleNodeInDesign2Source(a){var b=[];try{if(a.querySelectorAll){for(var c=a.querySelectorAll('[style*="white-space-collapse: preserve"]'),d=c.length,e=d-1;0<=e;e--){var f=c[e],g="detemp"+e,h=document.createElement(g);b.push({nodeName:g,html:f.innerHTML});f.innerHTML="";f.appendChild(h)}c=a.querySelectorAll('[style*="white-space: pre"]');d=c.length;0<d&&null==b&&(b=[]);for(e=d-1;0<=e;e--)f=c[e],g="detemptemp"+e,h=document.createElement(g),b.push({nodeName:g,html:f.innerHTML}),
f.innerHTML="",f.appendChild(h);b.reverse&&b.reverse()}}catch(m){b=[]}return b}function restoreWhiteSpaceStyleNodeInDesign2Source(a,b){var c=a;try{var d=b.length;if(0<d){var e=getDocumentForDummy().createElement("div");e.innerHTML=a;for(var f=0;f<d;f++){var g=b[f].nodeName;a=b[f].html;var h=e.querySelector(g);h&&(h.parentNode.innerHTML=a)}c=e.innerHTML}}catch(m){c=a}return c}
function setGlobalIsCollapsedInMouseup(){try{G_IsCollapsedInMouseup=getFirstRange().range.collapsed}catch(a){G_IsCollapsedInMouseup=!0}}function validateWidthHeight(a,b,c){var d=a.maxImageWidthSize;a=a.maxImageHeightSize;return 0!=d&&d<DEXTTOP.DEXT5.util.parseIntOr0(b)||0!=a&&a<DEXTTOP.DEXT5.util.parseIntOr0(c)?!0:!1}
function removeTitleInStyleNode(a,b){var c=a;/<style [^>]*?title=.*?>/i.test(c)&&(c=c.replace(/<style [^>]*?(title=".*?").*?>/gi,function(a,b){return a.replace(b,"")}),c=c.replace(/<style [^>]*?(title=.*?)[ |>]/gi,function(a,b){return a.replace(b,"")}));return c}
function parsingCssString(a){for(var b,c,d="",e=0,f=[];""!=DEXTTOP.DEXT5.util.trim(a);){var g=!1,h=!1;b=a.indexOf("{");c=a.indexOf("}");-1==b&&-1==c&&(h=!0);if(h){f=[];break}if(-1<c){var m=a.substring(0,c+1),d=d+m;a=a.replace(m,"");-1<b?b<c?(c=RegExp("{","g"),c=d.match(c),b=c.length,c=RegExp("}","g"),c=d.match(c),e=b-c.length):e--:e--}else h=!0;if(0==h)0==e&&(g=!0),g&&(f.push(d),e=0,d="");else{f=[];break}}return f}
function createStyleNode(a){a=(a?a:document).createElement("style");a.type="text/css";return a}function setCssTextToStyleNode(a,b,c){c=c?c:document;b.styleSheet?(b.styleSheet.cssText=a,""==b.innerHTML&&(b.innerHTML=a)):b.appendChild(c.createTextNode(a))}
function getLiNodesForStyle(a,b){try{if(_iframeDoc.createTreeWalker){var c=null;if(b)rangySel=b.sel,c=b.range;else{var d=getFirstRange();rangySel=d.sel;c=d.range}var e=getNodesInRange(c),f=e.length;if(-1<e.toString().indexOf("LIElement")){c=[];for(d=0;d<f;d++){var g=e[d];1==g.nodeType&&"LI"==g.tagName&&c.push(g)}for(var h=c.length,d=0;d<h;d++){for(var g=c[d],m,q=_iframeDoc.createTreeWalker(g,NodeFilter.SHOW_TEXT,null,!1),e=null,f="";m=q.nextNode();){var e=m,t=m.parentNode,f=t.style[a];""==f&&(f=DEXTTOP.DEXT5.util.getStyle(t,
a));if("SPAN"==t.tagName)t.style[a]=f;else{var u=_iframeDoc.createElement("span");u.style[a]=f;t.insertBefore(u,m);u.appendChild(m)}}e&&""!=f&&(g.style[a]=f)}}}}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function insertAfterNode(a,b){var c=a.parentNode;a.nextSibling?c.insertBefore(b,a.nextSibling):c.appendChild(b)}
function convertHtmlToTextEx(a,b){a=a.replace(/<[a-zA-Z]+(\s+.*?)>/g,function(a,b){return a.replace(b,"")});a=a.replace(/<br ?\/>/gi,"<br>");a=a.replace(/<body>\s*</gi,"<");a=a.replace(/>\s*<\/body>/gi,">");a=a.replace(/<li>/gi,"<p>");a=a.replace(/<\/li>/gi,"</p>");a=a.replace(/<td>((?:.|\s)*?)<\/td>/gi,function(a,b){0>b.toLowerCase().indexOf("<p>")&&(a=a.replace("<td>","<p>"),a=a.replace("</td>","</p>"));return a});a=a.replace(/<th>((?:.|\s)*?)<\/th>/gi,function(a,b){0>b.toLowerCase().indexOf("<p>")&&
(a=a.replace("<th>","<p>"),a=a.replace("</th>","</p>"));return a});a=a.replace(/<style>[\w\W]*?<\/style>/gi,"");a=a.replace(/<script>[\w\W]*?<\/script>/gi,"");a=a.replace(/<title>[\w\W]*?<\/title>/gi,"");a=a.replace(/<h[0-9]>/gi,"<p>");a=a.replace(/<\/h[0-9]>/gi,"</p>");a=a.replace(/<pre>([\w\W]*?)<\/pre>/gi,function(a,b){return"<p>"+DEXTTOP.DEXT5.util.replaceAll(b,"\n","<br>")+"</p>"});a=a.replace(/<code>([\w\W]*?)<\/code>/gi,function(a,b){return DEXTTOP.DEXT5.util.replaceAll(a,"\n"," ")});a=a.replace(/<p><\/p>/gi,
"");a=a.replace(/<p>(?:<span>)*(<br>)(?:<\/span>)*<\/p>/gi,"<br>");!0!==b&&(a=a.replace(/<p>(?:<span>)*(&nbsp;)(?:<\/span>)*<\/p>/gi,"<br>"));a=a.replace(/<(?!br\s*\/?>|\/?p\s*\/?>)[^>]+>/gi,"");a=a.replace(/[^\n> \t]<p>/gi,function(a){return a.replace("<p>","</p>")});a=a.replace(/<p>/gi,"");a=a.replace(/<br><\/p>/gi,"</p>");a=a.replace(/<\/p>/gi,"<br>");a=a.replace(/<br>$/i,"");var c=document.createElement("div");c.style.position="absolute";c.style.left="-1000px";document.body.appendChild(c);var d=
_iframeDoc.getElementsByTagName("p")[0];d&&(d=DEXTTOP.DEXT5.util.getStyle(d,"whiteSpace"),"string"==typeof d&&(-1<d.indexOf("pre")||-1<d.indexOf("break"))&&(c.style.whiteSpace=d));c.innerHTML=a;a=c.innerText;c.parentNode.removeChild(c);return a}function convertTextToHtmlEx(a){a=("<p>"+a+"</p>").replace(/\r\n/g,"</p><p>");return a=a.replace(/<p><\/p>/g,"<p>"+getDefaultParagraphValue()+"</p>")}
function hasFocusInEditorWhole(a,b){var c=a.editor;setTimeout(function(){try{var a=_iframeDoc.hasFocus();0==a&&(a=document.hasFocus());var e=function(a,b){for(var c=!1,d=!1,e=0;e<a.length;e++)if((d=b.getElementById(a[e]))&&(d="none"!=d.style.display?!0:!1)&&(_iframeDoc.hasFocus()||document.hasFocus())){c=!0;break}return c};if(0==a)var f=["dext_dialog","dext_context_iframe","dext_topmenu_iframe"+c.ID,"dext_formatting_iframe_"+c.ID,"dext_fontfamily_iframe_"+c.ID,"dext_fontsize_iframe_"+c.ID,"dext_lineheight_iframe_"+
c.ID,"kminiphoto_holder_kminiphoto","dext_letterspacing_iframe_"+c.ID,"dext_detail_align_group_iframe_"+c.ID,"dext_detail_table_group_iframe_"+c.ID,"dext_detail_list_number_iframe_"+c.ID,"dext_detail_list_bullets_iframe_"+c.ID,"dext_order_of_objects_detail_iframe_"+c.ID],a=e(f,DEXTTOP.document);0==a&&(f=["dext5_preview_"+c.ID],a=e(f,document));"function"==typeof b&&(a={hasFocus:a},b(a))}catch(g){"function"==typeof b&&(a={hasFocus:!1},b(a))}},300)}
function execEditorWholeFocusEvent(a,b){if(1!=DEXTTOP.DEXT5.browser.ie){var c="focus"==a?!0:!1;hasFocusInEditorWhole({editor:b},function(d){try{if(G_focusStateInEditorWhole!=a&&d.hasFocus==c){G_focusStateInEditorWhole=a;try{"object"==typeof DEXTTOP.NEXACROHTML&&"object"==typeof DEXTTOP.nexacro&&"blur"===a&&DEXT5_CONTEXT&&DEXT5_CONTEXT._context_iframe&&""==DEXT5_CONTEXT._context_iframe.style.display&&DEXT5_CONTEXT.hide(!1)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{var f=
G_DEPlugin.wordchecking_seegene;if(f)f.onWholeFocusEvent(a)}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}"1"===b._config.returnEvent.focus_event&&("function"==typeof b._config.event.focusInEditorWhole?b._config.event.focusInEditorWhole(a,b.ID):DEXTTOP.DEXTWIN.dext_whole_focus_event(a,b.ID))}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}})}}
function isFixedEditorPosition(a){var b=!1;a=a.editor._config;if("1"==a.useFixedPositionToDialog)b=!0;else if("auto"==a.useFixedPositionToDialog){a=_iframeWin.parent.frameElement.parentNode;for(var c=!1;null!=a&&"BODY"!=a.tagName;){var d="";a.style&&(d=DEXTTOP.DEXT5.util.getStyle(a,"position"));if("fixed"==d){c=!0;break}a=a.parentNode}c&&(b=!0)}return b}
function executeMaxTotalFileSizeCheckProcess(a){var b=a.editor,c=a.finalCallBackFn;a=a.selectedElem;if(0!=b._config.maxTotalFileSize&&-1<b._config.runtimes.indexOf("html5")&&DEXTTOP.DEXT5.browser.HTML5Supported){showProcessingBackground();try{DEXTTOP.DEXT5.getAddedTotalFileSize(function(a){hideProcessingBackground();b.addedTotalFileSize=a;DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currAddedTotalFileSize=b.addedTotalFileSize;c(b)},b.ID,a)}catch(d){hideProcessingBackground()}}else c(b)}
function setMessageForMaxTotalFileSize(a){var b=a.messageInfoForMaxTotalFileSize.messageType;if("multi_img"==b){aMessage=dext5_lang.msg.max_total_file_size_forMultiImg;aMessage=aMessage.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(a._config.maxTotalFileSize).toString);aMessage=aMessage.replace("{1}",DEXTTOP.DEXT5.util.bytesToSize(a.messageInfoForMaxTotalFileSize.currAddedTotalFileSize).toString);for(var c=0,d=a.messageInfoForMaxTotalFileSize.currPassedFiles,b=0;b<d.length;b++)c+=d[b].size;aMessage=
aMessage.replace("{2}",DEXTTOP.DEXT5.util.bytesToSize(c).toString);c=0;a=a.messageInfoForMaxTotalFileSize.currFilteredFiles;for(b=0;b<a.length;b++)c+=a[b].size;aMessage=aMessage.replace("{3}",DEXTTOP.DEXT5.util.bytesToSize(c).toString)}else aMessage="paste"==b?dext5_lang.msg.max_total_file_size_forPaste:dext5_lang.msg.max_total_file_size,aMessage=aMessage.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(a._config.maxTotalFileSize).toString),aMessage=aMessage.replace("{1}",DEXTTOP.DEXT5.util.bytesToSize(a.messageInfoForMaxTotalFileSize.currAddedTotalFileSize).toString),
aMessage=aMessage.replace("{2}",DEXTTOP.DEXT5.util.bytesToSize(a.messageInfoForMaxTotalFileSize.currFileSize).toString);return aMessage}function checkMaxTotalFileSizeByImageSize(a,b){var c,d=!0;c=b+a;c>DEXTTOP.G_CURREDITOR._config.maxTotalFileSize&&(d=!1,DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currFileSize+=a);return d}
function execImgMaxTotalFileSizeCheck(a,b){for(var c=a.length,d=[],e=b,f=0;f<c;f++){var g=getImageFileSize(a[f]),g=parseInt(g),h={passedFileSize:0,filteredFileSize:0};checkMaxTotalFileSizeByImageSize(g,e)?(e+=g,h.passedFileSize=g):h.filteredFileSize=g;d.push(h)}return d}
function executeDomainCheckForNewInsertFileByUrlProcess(a){var b=a.editor,c=a.selectedElemType,d=a.selectedElemUrl,e=a.targetUrl,f=a.finalCallBackFn;if(0!=b._config.maxTotalFileSize&&e&&-1<b._config.runtimes.indexOf("html5")&&DEXTTOP.DEXT5.browser.HTML5Supported)if(a=b._FRAMEWIN.location.host,a=a.toLowerCase(),0==e.toLowerCase().replace("http://","").replace("https://","").indexOf(a)){a="";var g=null;d?("a"==c?(g=document.createElement(c),g.href=d,g.setAttribute("DEXT5HyperlinkImage","")):"videoSource"==
c?(g=document.createElement("video"),c=document.createElement("source"),c.src=d,g.appendChild(c)):(g=document.createElement(c),g.src=d),a=DEXTTOP.DEXT5.GetContentsUrlWhitoutTargetUrl(b.ID,g),g=null):a=DEXTTOP.DEXT5.GetContentsUrlForSizeCheck(b.ID);c=[];""!=a&&(c=a.split(b._config.unitDelimiter));a=c.length;for(var g=!1,h=0;h<a;h++){var m=c[h].split(b._config.unitAttributeDelimiter)[0];if(e==m){g=!0;break}}g?f(!1):(c=!1,""!=d&&d!=e&&(c=!0),c?(d=[],d.push(e),DEXTTOP.DEXT5.GetFileSize(d,function(a){var c=
parseInt(a,10);DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currFileSize=c;DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currAddedTotalFileSize=b.addedTotalFileSize;a=!1;c=b.addedTotalFileSize+c;c>DEXTTOP.G_CURREDITOR._config.maxTotalFileSize&&(a=!0);a||(b.addedTotalFileSize=c);f(a)},b.ID)):f(!1))}else f(!1);else f(!1)}
function executeGetTotalPasteFileSizeByUrlProcess(a){var b=a.editor,c=a.targetUrlList,d=a.finalCallBackFn;if(0!=b._config.maxTotalFileSize&&0<c.length&&-1<b._config.runtimes.indexOf("html5")&&DEXTTOP.DEXT5.browser.HTML5Supported){a=b._FRAMEWIN.location.host;a=a.toLowerCase();var e=DEXTTOP.DEXT5.GetContentsUrlForSizeCheck(b.ID),f=[];""!=e&&(f=e.split(b._config.unitDelimiter));for(var e=f.length,g=[],h=0,m=0;m<c.length;m++){var q=c[m].targetUrl,q=q.toLowerCase();if(0==q.replace("http://","").replace("https://",
"").indexOf(a)){for(var t=!1,u=0;u<e;u++){var v=f[u].split(b._config.unitAttributeDelimiter)[0];if(q==v){t=!0;break}}t||g.push(q)}}(function(){0<g.length?DEXTTOP.DEXT5.GetFileSize(g,function(a){h+=parseInt(a,10);d&&d(h)},b.ID):d&&d(h)})()}else d(0)}
function removeCaretForNexacroEnv(a){try{if("object"==typeof DEXTTOP.NEXACROHTML&&"undefined"===typeof DEXTTOP.nexacro&&a&&"1"===a.setWriteMode){var b=document.createElement("div");try{document.body.insertBefore(b,document.body.firstChild),b.setAttribute("tabindex","-1"),b.focus(),document.body.removeChild(b)}catch(c){b.parentNode&&b.parentNode.removeChild(b)}}}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function canAccessClipboardEnv(){var a=!1;DEXTTOP.navigator.clipboard&&DEXTTOP.isSecureContext&&"1"==_dext_editor._config.usePasteToolbarAndContext&&(a=!0);return a}
function parseRecentlyFont(a){var b="";try{b=JSON.parse(a)}catch(c){var d=DEXTTOP.G_CURREDITOR._config.displayFontFamilyList,e=[];if("object"==typeof d&&"[object Object]"==Object.prototype.toString.call(d))for(n in d)if(-1<a.split(",").indexOf(d[n])&&(a=a.replace(new RegExp(d[n],"g"),n)),-1<a.indexOf(n)){var f=a.substring(a.indexOf(n),a.indexOf(n)+n.length);a=a.replace(new RegExp(f,"g"),"");e.push(f)}b+="["+DEXTTOP.G_CURREDITOR._dextFontFamily.get_trimmed_font(a,!0)+"]";try{b=JSON.parse(b)}catch(g){b=
[]}b=b.concat(e);DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyFontName,JSON.stringify(b))}return b}function isRTL(a){var b=!1;a=(a?a:document).documentElement.getAttribute("dir");"string"==typeof a&&"rtl"==a&&(b=!0);return b}function loadCssNode(a,b){var c=a.url,d=a.doc?a.doc:document,e=d.getElementsByTagName("head")[0],d=d.createElement("link");d.type="text/css";d.rel="stylesheet";"function"===typeof b&&(d.onload=function(){b(this)});d.href=c;e.appendChild(d)}
function convertNumberToOther(a,b){if(0>a)return 0;var c,d;2==b.split("-").length?("upper"==b.split("-")[0]?c=!0:"lower"==b.split("-")[0]&&(c=!1),d=b.split("-")[1]):d=b;var e=[{value:1E3,numeral:c?"M":"m"},{value:900,numeral:c?"CM":"cm"},{value:500,numeral:c?"D":"d"},{value:400,numeral:c?"CD":"cd"},{value:100,numeral:c?"C":"c"},{value:90,numeral:c?"XC":"xc"},{value:50,numeral:c?"L":"l"},{value:40,numeral:c?"XL":"xl"},{value:10,numeral:c?"X":"x"},{value:9,numeral:c?"IX":"ix"},{value:5,numeral:c?"V":
"v"},{value:4,numeral:c?"IV":"iv"},{value:1,numeral:c?"I":"i"}],f="\u03b1\u03b2\u03b3\u03b4\u03b5\u03b6\u03b7\u03b8\u03b9\u03ba\u03bb\u03bc\u03bd\u03be\u03bf\u03c0\u03c1\u03c3\u03c4\u03c5\u03c6\u03c7\u03c8\u03c9".split("");switch(d){case "decimal-leading-zero":return e=a,0<=a&&10>a&&(e="0"+a),e;case "alpha":e=65;c||(e=97);for(c="";0<a;)a--,d=a%26,c=String.fromCharCode(e+d)+c,a=Math.floor(a/26);return c;case "roman":if(isNaN(a))return"";f="";for(c=0;c<e.length;c++)for(;a>=e[c].value;)f+=e[c].numeral,
a-=e[c].value;return f;case "greek":for(c="";0<a;)a--,d=a%24,c=f[d]+c,a=Math.floor(a/24);return c}return a}function applyClassOnSelection(a,b){if("add"===a.toLowerCase()){var c=rangy.createCssClassApplier(b,{elementTagName:"span"});c.applyToSelection(_iframeWin)}else"remove"===a.toLowerCase()&&(c=rangy.createCssClassApplier(b,{}),c.undoToSelection(_iframeWin))}
function NodesObserver(){this.isSupported="MutationObserver"in window&&!1===DEXTTOP.DEXT5.browser.ie;this.observer=null;this._internalConfig={addedNodes:[],removedNodes:[]};this.addNodesInternal=function(a,b){if("string"==typeof b&&0<b.length){var c=b.toLowerCase().split(","),c=c.map(function(a){return a.trim()}),d="added"==a?this._internalConfig.addedNodes:this._internalConfig.removedNodes,d=d.concat(c),d=Array.from(new Set(d));"added"==a?this._internalConfig.addedNodes=d:this._internalConfig.removedNodes=
d;this.addMutationObserver()}};this.removeNodesInternal=function(a,b){if("string"==typeof b&&0<b.length){var c=b.toLowerCase().split(","),c=c.map(function(a){return a.trim()});"added"==a?this._internalConfig.addedNodes=this._internalConfig.addedNodes.filter(function(a){return 0==c.includes(a)}):this._internalConfig.removedNodes=this._internalConfig.removedNodes.filter(function(a){return 0==c.includes(a)});this.addMutationObserver()}};this.addMutationObserver=function(){var a=this;a.removeObserver();
var b=!1,c=_dext_editor._config,d=[],e=[],f=[],g=c.observeAddedNodes;0<g.length&&(f=g.split(","),f=f.map(function(a){return a.trim().toLowerCase()}));var h=[],g=c.observeRemovedNodes;0<g.length&&(h=g.split(","),h=h.map(function(a){return a.trim().toLowerCase()}));c=f.concat(a._internalConfig.addedNodes);d=Array.from(new Set(c));c=h.concat(a._internalConfig.removedNodes);e=Array.from(new Set(c));if(0<d.length||0<e.length)b=!0;b&&(a.observer=new MutationObserver(function(b){var c=[],g=[],u=[],v=[],
w=function(a,b){for(var c=Array.from(a.addedNodes),d=c.length,e=[],f=0;f<d;f++){var g=c[f];if(1===g.nodeType){var h=g.tagName.toLowerCase();b.includes(h)&&e.push(g);for(var g=g.querySelectorAll(b.join(",")),h=g.length,m=0;m<h;m++)e.push(g[m])}}for(var c=Array.from(a.removedNodes),d=c.length,q=[],f=0;f<d;f++)if(g=c[f],1===g.nodeType)for(h=g.tagName.toLowerCase(),b.includes(h)&&q.push(g),g=g.querySelectorAll(b.join(",")),h=g.length,m=0;m<h;m++)q.push(g[m]);return{addedNodes:e,removedNodes:q}};b.forEach(function(a){"childList"===
a.type&&0<d.length&&(a=w(a,d),c=c.concat(a.addedNodes),g=g.concat(a.removedNodes))});b.forEach(function(a){"childList"===a.type&&0<e.length&&(a=w(a,e),u=u.concat(a.addedNodes),v=v.concat(a.removedNodes))});g.forEach(function(a){a=c.indexOf(a);-1!==a&&c.splice(a,1)});u.forEach(function(a){a=v.indexOf(a);-1!==a&&v.splice(a,1)});var y=Array.from(new Set(c));b=Array.from(new Set(v));if(0<y.length){var x=y.filter(function(b){return a._internalConfig.addedNodes.includes(b.tagName.toLowerCase())});0<x.length&&
a._executeInternalEvent(x,"added");y=y.filter(function(a){return f.includes(a.tagName.toLowerCase())});0<y.length&&a._executeUserEvent(y,"added")}0<b.length&&(y=b.filter(function(b){return a._internalConfig.removedNodes.includes(b.tagName.toLowerCase())}),0<y.length&&a._executeInternalEvent(y,"removed"),b=b.filter(function(a){return h.includes(a.tagName.toLowerCase())}),0<b.length&&a._executeUserEvent(b,"removed"))}),a.observer.observe(_iframeDoc.body,{childList:!0,subtree:!0}))};this.removeObserver=
function(){this.observer&&this.observer.disconnect()};this._executeUserEvent=function(a,b){var c=null;"added"==b?"function"===typeof _dext_editor._config.event.addedNodes?c=_dext_editor._config.event.addedNodes:"function"===typeof DEXTTOP.DEXTWIN.dext_editor_added_nodes&&(c=DEXTTOP.DEXTWIN.dext_editor_added_nodes):"removed"==b&&("function"===typeof _dext_editor._config.event.removedNodes?c=_dext_editor._config.event.removedNodes:"function"===typeof DEXTTOP.DEXTWIN.dext_editor_removed_nodes&&(c=DEXTTOP.DEXTWIN.dext_editor_removed_nodes));
c&&(c(_dext_editor.ID,{nodes:a}),"added"==b&&(_dext_editor.UndoManager.putUndo({overwriteToLast:!0}),_dext_editor.UndoManager.charCount=0))};this._executeInternalEvent=function(a,b){var c=null;if("added"==b)try{for(var d in G_DEPlugin)"function"===typeof G_DEPlugin[d].addedNodes&&(c=G_DEPlugin[d].addedNodes)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else if("removed"==b)try{for(d in G_DEPlugin)"function"===typeof G_DEPlugin[d].removedNodes&&(c=G_DEPlugin[d].removedNodes)}catch(f){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}c&&c({nodes:a})};0==this.isSupported&&(this.addMutationObserver=function(){},this.removeObserver=function(){})}
function changePosForCovered(a){var b=DEXTTOP.DEXT5.util,c=_dext_editor._config.autoRepositionPopupAndMenu;if("0"!=c.use){var d=a.popupNode,e=a.checkNode,f=function(a){a?d.style.opacity=0:b.removeStyleAttribute(d,"opacity")},g="1"==c.enableTransition;g?b.removeStyleAttribute(d,"transition"):f(!0);var h=function(a,h){var t=new IntersectionObserver(function(e){t.disconnect();delete t;e.forEach(function(e){if(1>e.intersectionRatio){var t=parseInt(d.style.top),u=e.boundingClientRect;e=e.intersectionRect;
var x;"bottom"==a?0==e.bottom&&0==e.top?(u=u.height,x=t-u-3):u.bottom>e.bottom&&(u=u.bottom-e.bottom,x=t-u-3):"top"==a&&u.top<e.top&&(u=e.top-u.top,x=t+u+3);if("number"==typeof x){if(g){d.style.transition="top "+c.transitionDuration+" "+c.transitionTimingFunction;var z=function(){b.removeStyleAttribute(d,"transition");b.removeEvent(d,"transitionend",z);"function"==typeof h&&setTimeout(h,1)};b.addEventEx(d,"transitionend",z)}d.style.top=x+"px";0==g&&(f(!1),"function"==typeof h&&h())}}else 0==g&&f(!1)})},
{threshold:0});t.observe(e)};h("bottom",function(){h("top")})}}
function replaceNotRenderedSpaceToNbsp(a){a=DEXTTOP.DEXT5.util.splitBodyInnerString(a);var b=a.body,b=b.replace(/<p\b[^>]*?>[\w\W]+?<\/p>/gi,function(a){a=a.replace(/(<p\b[^>]*?>)([\w\W]*)(<span\b[^>]*?>) (<\/span>)/i,function(a,b,c,g,h){var m=!1;if(""!=c){var q=c.replace(/<u\b[^>]*?>/gi,""),q=q.replace(/<s\b[^>]*?>/gi,"");""==q&&(m=!0)}else m=!0;return m?b+c+g+"&nbsp;"+h:a});return a=a.replace(/((<br> )+)(.*?)(<span[^>]*>)( {1})?([^>])/gi,function(a,b,c,g,h,m,q){c=!1;" "==m&&(""!=g?(m=g.replace(/<u\b[^>]*?>/gi,
""),m=m.replace(/<s\b[^>]*?>/gi,""),""==m&&(c=!0)):c=!0,c&&(b=b.replace(/<br> /gi,"<br>"),a=b+g+h+"&nbsp;"+q));return a})});return a.head+b+a.tail}
function applyTableAlignInHwp(a){if(DEXTTOP.DEXT5.browser.DOMParserSupported)try{var b=new DOMParser,c=b.parseFromString("<html><head></head><body>"+a+"</body></html","text/html"),d=c.getElementsByTagName("table"),e=d.length;if(0<e){var f=[],g=null,h=c.getElementById("hwpEditorBoardContent").innerHTML,m=h.indexOf("{"),q=h.lastIndexOf("}"),t=null;try{g=h.substring(m,q+1),t=JSON.parse(g)}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(t){for(var v=findObjectsWithKey(t,"tr"),w=v.length,
y=0;y<w;y++){var x=v[y];x.hasOwnProperty("tr")&&f.push(x)}e!==f.length&&(f=[])}for(y=0;y<e;y++){var z=d[y],B=z.parentElement;if(B&&B.nodeType===Node.ELEMENT_NODE&&"P"===B.nodeName){var D=f[y],A=D.ph1,h="";!0===D.pta?1<B.getAttribute("style").match(/text-align/g).length&&(h=B.style.textAlign,"justify"===h&&(h="")):"number"===typeof A&&(h=1===A?"center":2===A?"right":"");B.parentNode.insertBefore(z,B);B.parentNode.removeChild(B);m=z;"center"===h?(m.style.marginLeft="auto",m.style.marginRight="auto"):
("right"===h?m.style.marginLeft="auto":DEXTTOP.DEXT5.util.removeStyleAttribute(m,"margin-left"),DEXTTOP.DEXT5.util.removeStyleAttribute(m,"margin-right"))}}a=c.body.innerHTML;delete b}}catch(C){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return a}function findObjectsWithKey(a,b){function c(a){if("object"===typeof a&&null!==a){a.hasOwnProperty(b)&&d.push(a);for(var f in a)c(a[f])}}var d=[];c(a);return d}
function clipboardHtmlToImage(a,b){var c=G_DEPlugin.convertimage;c?c.convertHtmlToImage(a,function(a){a=DEXTTOP.DEXT5.util.dataURItoBlob(a.imgData);b(a)}):b(null)}
function dextWindowResizeEvt(){try{var a=_dext_editor;null==a&&"undefined"!=typeof DEXTTOP&&null!=DEXTTOP&&DEXTTOP.G_CURREDITOR&&(a=DEXTTOP.G_CURREDITOR);if(a&&a._config.isLoadedEditor){if(0==isDEXTContainerMode())try{resizeEditor(a,!1)}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}setZoomValueToBody(document,a);setZoomValueToBody(a._DOC,a);setToolbarScroll(a);"1"==a._config.tool_bar_grouping&&(groupingIcon(),setPositionGroupingDiv(1),setPositionGroupingDiv(2));if(G_BodyFit.widthFixStatus&&
(setBodyFitStyle(a,!0),setAutoBodyFit(a),"1"==_dext_editor._config.widthFix.defaultView&&"1"==_dext_editor._config.widthFix.alignCenter&&G_BodyFit.noncreationAreaBackgroundStatus)){var c=document.getElementById("dext5_design_"+_dext_editor.ID).offsetWidth,d=_iframeDoc.body;_iframeDoc.body.parentElement.style.marginLeft="auto";_iframeDoc.body.parentElement.style.marginRight="auto";var e=d.getBoundingClientRect(),f=e.width+2*G_DesignHtmlMarginValue;"2"==_dext_editor._config.defaultBodySpace.mode&&(f=
e.width);c>f&&c>G_DesignHtmlWidth||(d.parentElement.style.width=f+"px",d.style.transformOrigin=c>f?"center 0% 0px":1>G_ZoomValue?"center 0% 0px":"0% 0% 0px")}G_Ruler&&G_Ruler.viewRulerStatus&&("1"==a._config.ruler.mode||"2"==a._config.ruler.mode&&"1"==a._config.ruler.useResizeEvent)&&G_Ruler.SetRulerPosition()}}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};function command_bold(a,b){dext_src_init(b._EDITOR.design);var c={document:_iframeDoc,styleWithCss:!1,tagName:"strong"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"bold",c)}function command_italic(a,b){dext_src_init(b._EDITOR.design);var c={document:_iframeDoc,styleWithCss:!1,tagName:"i"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"italic",c)}
function command_formatting(a,b,c){dext_src_init(b);c.toLowerCase();restoreSelection();setFocusToBody();a=getFirstRange();b=a.range;var d=!1;if(0==b.collapsed){var e=b.endContainer;0==(3==b.startContainer.nodeType&&3==e.nodeType)&&(d=!0,adjustSelectionExcludingNextLineStart(a,b))}""==c?DoExecuteCommandFormatting(b,"p",!1):DoExecuteCommandFormatting(b,c,!0);d&&(removeDextMarkInFrame(),(c=_iframeDoc.getElementById("de_temp_start_span"))&&c.parentNode.removeChild(c),(c=_iframeDoc.getElementById("de_temp_end_span"))&&
c.parentNode.removeChild(c))}function command_underline(a,b){dext_src_init(b._EDITOR.design);var c={document:_iframeDoc,styleWithCss:!1,tagName:"u"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"underline",c)}function command_strikeThrough(a,b){dext_src_init(b._EDITOR.design);var c={document:_iframeDoc,styleWithCss:!1,tagName:"strike"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"strikeThrough",c)}
function command_superscript(a,b){dext_src_init(b._EDITOR.design);var c={document:_iframeDoc,styleWithCss:!1,tagName:"sup"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"superscript",c)}function command_subscript(a,b){dext_src_init(b._EDITOR.design);var c={document:_iframeDoc,styleWithCss:!1,tagName:"sub"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"subscript",c)}
function command_selectAll(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody(b,!0);_iframeDoc.execCommand("selectAll",!1,null);b._iconEnable("selectArea");setGlobalIsCollapsedInMouseup()}
function command_align(a,b,c,d,e){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var f=getFirstRange();a=f.range;try{DEXTTOP.G_CURREDITOR.beforeOffset=[],DEXTTOP.G_CURREDITOR.beforeOffset.push(a.startOffset),DEXTTOP.G_CURREDITOR.beforeOffset.push(a.endOffset),3==a.startContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(a.startContainer.parentNode):DEXTTOP.G_CURREDITOR.beforeOffset.push(a.startContainer),3==a.endContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(a.endContainer.parentNode):
(DEXTTOP.G_CURREDITOR.beforeOffset.push(a.endContainer),1==a.endOffset&&(DEXTTOP.G_CURREDITOR.beforeOffset[1]=(a.endContainer.innerText||a.endContainer.textContent).length)),DEXTTOP.G_CURREDITOR.beforeOffset.push(a.toString().length)}catch(g){DEXTTOP.G_CURREDITOR.beforeOffset=null}var h=null;if(e&&"table"==e.tagName.toLowerCase())h=e;else if(e&&"img"==e.tagName.toLowerCase()){if(b=GetParentbyTagName(e,"figure")){if("justify"==c||"center"==c)c="";"cssFloat"in b.style?b.style.cssFloat=c:b.style.styleFloat=
c;rangy.getSelection(_iframeWin).removeAllRanges();(c=b.getElementsByTagName("figcaption"))&&c[0]&&doSetCaretPosition(c[0],0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;e&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem=e,DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,!1,null));setMenuIconRealable(getMyElementNode(e));return}}else h=getSelectionTable(b);if(h){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
if("0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign||"0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO)"justify"==c||"left"==c&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO?h.removeAttribute("align"):h.setAttribute("align",c);try{var m=_iframeDoc.body.createControlRange();m.add(h);m.select()}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}setMenuIconRealable(h);DEXTTOP.G_CURREDITOR._iconEnable("focusTable",h);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;e&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem=e,DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,!1,null))}else{if(void 0==a)"left"==c?c="justifyLeft":"right"==c?c="justifyRight":"center"==c?c="justifyCenter":"justify"==c&&(c="justifyFull"),DoExecuteCommand2(f.sel,a,c,d);else{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&
DEXTTOP.G_CURREDITOR.UndoManager.putUndo();e="p li dt dd h1 h2 h3 h4 h5 h6 pre address div".split(" ");m=e.length;b=GetTableSelectionCells();if(0==b.length){if(null!=a.startContainer.previousSibling&&"HEAD"==a.startContainer.previousSibling.tagName&&null==a.endContainer.nextSibling){for(var t=0;t<m;t++)for(f=_iframeDoc.body.getElementsByTagName(e[t]),h=f.length,d=0;d<h;d++)""!=f[d].style.layoutGridMode&&(f[d].style.layoutGridMode="none"),f[d].style.textAlign=c;m=_iframeDoc.body.getElementsByTagName("table");
f=m.length;for(t=0;t<f;t++){if("0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign||"0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO)"justify"==c||"left"==c&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO?m[t].removeAttribute("align"):m[t].setAttribute("align",c);var h=m[t].rows,u=h.length;for(d=0;d<u;d++){b=h[d].cells;a=b.length;for(var v=0;v<a;v++)setBlockTag(b[v].childNodes,e,"align",c)}}setBlockTag(_iframeDoc.body.childNodes,e,"align",c);v=_iframeDoc.body.getElementsByTagName("div");
f=v.length;for(d=0;d<f;d++)setBlockTag(v[d].childNodes,e,"align",c)}else{b=!1;a&&(t=GetTDTHCell(a.startContainer),d=GetTDTHCell(a.endContainer),f=a.commonAncestorContainer,null!=t&&null!=d&&null!=f&&t==d==f&&(v=GetParentbyTagName(t,"table"),b=!0));b?f=getElementsFromSelection(t.nodeName.toString().toLowerCase()):1==a.collapsed?(d=a.startContainer,f=[d]):f=a.getNodes();h=f.length;if(2>=h)for(t=0;t<h;t++)d=f[t],3==d.nodeType&&f.push(d.parentNode);if(!f||1==f.length&&-1<"body,td,th".indexOf(f[0].nodeName.toLowerCase()))f=
getNodesInRange(a);var h=f.length,u=a.startOffset,w=a.endOffset;1==a.collapsed&&0==a.getNodes().length&&a.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(var y=0;y<h;y++)if(1==f[y].nodeType&&(t=f[y].tagName.toLowerCase(),"0"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign&&"0"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO||0!=a.collapsed||0==a.getNodes().length||"table"!=t||b&&v==f[y]||("justify"==c||"left"==c&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO?f[y].removeAttribute("align"):
f[y].setAttribute("align",c)),-1<e.indexOf(t))){for(t=0;t<m;t++){var x=f[y].getElementsByTagName(e[t]),z=x.length;for(d=0;d<z;d++)""!=x[d].style.layoutGridMode&&(x[d].style.layoutGridMode="none"),x[d].style.textAlign=c}""!=f[y].style.layoutGridMode&&(f[y].style.layoutGridMode="none");f[y].style.textAlign=c}var B;0==a.toString().length&&1==a.getNodes().length&&(B=a.getNodes()[0],f.push(a.getNodes()[0]));m=3==f[0].nodeType;setBlockTag(f,e,"align",c);if(m){if(1==a.collapsed)try{a.setEnd(f[0],w)}catch(D){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}a.setStart(f[0],u);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a)}}(c=_iframeDoc.getElementById("_dextPosition"))?(doSetCaretPosition(c,1),c.parentNode.removeChild(c)):B&&(c=getFirstRange().range,getFirstRange().sel.removeAllRanges(),c.selectNode(B),getFirstRange().sel.addRange(c));f=getFirstRange();a=f.range;setMenuIconRealable(getMyElementNode(a.startContainer))}else{7==DEXTTOP.DEXT5.browser.ieVersion&&null!=
ActiveCurrTable&&0==d&&(B=!1,"0"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjust&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="1",B=!0),setAdjustTableWidthHeight(ActiveCurrTable),B&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="0"));a=b.length;for(t=0;t<a;t++){for(d=0;d<m;d++)for(f=b[t].getElementsByTagName(e[d]),h=f.length,v=0;v<h;v++)""!=f[v].style.layoutGridMode&&(f[v].style.layoutGridMode="none"),f[v].style.textAlign=c;setBlockTag(b[t].childNodes,e,"align",c);v=b[t].getElementsByTagName("div");
f=v.length;for(d=0;d<f;d++)setBlockTag(v[d].childNodes,e,"align",c);B=b[t].getElementsByTagName("table");v=B.length;for(d=0;d<v;d++)"justify"==c?B[d].removeAttribute("align"):B[d].setAttribute("align",c)}!DEXTTOP.DEXT5.browser.ie||"td"!=DrageEndCell.nodeName.toLowerCase()&&"th"!=DrageEndCell.nodeName.toLowerCase()?doSetCaretPosition(DrageEndCell.childNodes[0],1):(c=getCellLastChildNode(DrageEndCell),doSetCaretPosition(c.node,c.position));c=getFirstRange().range;B=getMyChildElementNode(c.startContainer);
c.selectNode(B);setMenuIconRealable(B);_iframeDoc_MouseUpMenu(null,DrageEndCell)}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}DEXTTOP.G_CURREDITOR.beforeOffset=null}}
function command_justifyLeft(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange();DoExecuteCommand2(a.sel,a.range,"justifyLeft",c)}function command_justifyCenter(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange();DoExecuteCommand2(a.sel,a.range,"justifyCenter",c)}
function command_justifyRight(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange();DoExecuteCommand2(a.sel,a.range,"justifyRight",c)}function command_justifyFull(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange();DoExecuteCommand2(a.sel,a.range,"justifyFull",c)}
function command_indent(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange().range,d=c.startContainer,d=3==d.nodeType?d.parentNode:d;if(GetParentbyTagName(d,"li"))setTabkeyAction();else{d=parseIntOr0(b._config.inoutdentDefaultSize);0==d&&(d=40);0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var e="p li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" "),f,g,h=GetTableSelectionCells(),m=h.length;if(0<m){g=[];for(var q=
e.length,t=0;t<m;t++){for(var u=!1,v=0;v<q;v++){f=h[t];var w=f.getElementsByTagName(e[v]);0<w.length&&(u=!0,g=htmlCollectionToArray(g,w))}if(0==u)for(u=f.childNodes,v=u.length,w=0;w<v;w++)g.push(u[w])}f=g}else{f=1==c.collapsed?[c.startContainer]:c.getNodes();if(1==f.length){if(h=f[0],!(h.tagName&&-1<e.indexOf(h.tagName.toLowerCase())))for(;h=h.parentNode,!h.tagName||"body"!=h.tagName.toLowerCase();)if(h.tagName&&-1<e.indexOf(h.tagName.toLowerCase())){f=[h];break}}else{h=f[0];m=f[f.length-1];g=h;for(q=
m;!g.tagName||"body"!=g.tagName.toLowerCase();){if(g.tagName&&-1<e.indexOf(g.tagName.toLowerCase())){h=g;break}g=g.parentNode}for(;!q.tagName||"body"!=q.tagName.toLowerCase();){if(q.tagName&&-1<e.indexOf(q.tagName.toLowerCase())){m=q;break}q=q.parentNode}h==m&&(f=[h])}null!=c.startContainer.previousSibling&&"HEAD"==c.startContainer.previousSibling.tagName&&null==c.endContainer.nextSibling&&(f=c.getNodes());0==c.collapsed&&1<f.length&&1==f[0].nodeType&&"P"==f[0].tagName&&(h=f[0].innerText||f[0].textContent,
3==c.startContainer.nodeType&&null==c.startContainer.nextSibling&&(h=c.startContainer.nodeValue),m=!1,h.length==c.startOffset&&(m=!0),!m&&DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&2<=f.length&&0<c.startOffset&&3!=f[1].nodeType&&1==c.startContainer.nodeType&&(m=!0),m&&(c.setStartAfter(f[0]),f=c.getNodes()))}g=f.length;h=c.startOffset;m=c.endOffset;q="marginLeft";t="marginRight";u="paddingLeft";isRTL()&&(q="marginRight",t="marginLeft",u="paddingRight");for(v=0;v<g;v++)if(null!=f[v].parentNode&&
1==f[v].nodeType&&f[v].tagName&&"body"!=f[v].tagName.toLowerCase())if("table"==f[v].tagName.toLowerCase()){if("1"!=b._config.allowInoutdentText){var y=parseIntOr0(f[v].style[q]);f[v].style[q]=y+d+"px"}}else if(f[v].tagName&&-1<e.indexOf(f[v].tagName.toLowerCase())){var x=function(a){return a=DEXTTOP.DEXT5.util.replacePtOrCmToPx(a)},z=DEXTTOP.DEXT5.util.parseFloatOr0(x(f[v].style[u])),y=DEXTTOP.DEXT5.util.parseFloatOr0(x(f[v].style[q])),w=DEXTTOP.DEXT5.util.parseFloatOr0(x(f[v].style[t])),B=DEXTTOP.DEXT5.util.parseFloatOr0(x(f[v].style.textIndent)),
x=DEXTTOP.DEXT5.util.parseFloatOr0(x(_iframeDoc.body.style.width));0<z?(tempUnit="px",0<y&&(z+=y),y=0,"1"==b._config.autoBodyFit?(0==x&&(x=getCurrEditorWidth()),y=0<B?z+d+B>x-w?z:z+d:z+d>x-w?z:z+d):y=z+d,f[v].style[u]="",f[v].style[q]=y+(""==tempUnit?"px":tempUnit)):(tempUnit="px",z=0,"1"==b._config.autoBodyFit?(0==x&&(x=getCurrEditorWidth()),z=0<B?y+d+B>x-w?y:y+d:y+d>x-w?y:y+d):z=y+d,f[v].style[q]=z+(""==tempUnit?"px":tempUnit))}g=!1;f[0]&&3==f[0].nodeType&&3==c.endContainer.nodeType&&(g=!0);setBlockTag(f,
e,"indent",d);g&&(1==c.collapsed&&c.setEnd(f[0],m),c.setStart(f[0],h),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(c));G_Ruler&&"2"==b._config.ruler.mode&&G_Ruler.SetRulerPosition()}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_outdent(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange().range,d=c.startContainer,d=3==d.nodeType?d.parentNode:d;if(GetParentbyTagName(d,"li"))setShiftTabkeyAction();else{d=parseIntOr0(b._config.inoutdentDefaultSize);0==d&&(d=40);0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var e="p li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" "),f,g,h=GetTableSelectionCells();g=h.length;if(0<g){for(var m=
[],q=e.length,t=0;t<g;t++){for(var u=!1,v=0;v<q;v++){f=h[t];var w=f.getElementsByTagName(e[v]);0<w.length&&(u=!0,m=htmlCollectionToArray(m,w))}if(0==u)for(u=f.childNodes,v=u.length,w=0;w<v;w++)m.push(u[w])}f=m}else{f=1==c.collapsed?[c.startContainer]:c.getNodes();if(1==f.length){if(h=f[0],!(h.tagName&&-1<e.indexOf(h.tagName.toLowerCase())))for(;h=h.parentNode,!h.tagName||"body"!=h.tagName.toLowerCase();)if(h.tagName&&-1<e.indexOf(h.tagName.toLowerCase())){f=[h];break}}else{h=f[0];g=f[f.length-1];
m=h;for(q=g;!m.tagName||"body"!=m.tagName.toLowerCase();){if(m.tagName&&-1<e.indexOf(m.tagName.toLowerCase())){h=m;break}m=m.parentNode}for(;!q.tagName||"body"!=q.tagName.toLowerCase();){if(q.tagName&&-1<e.indexOf(q.tagName.toLowerCase())){g=q;break}q=q.parentNode}h==g&&(f=[h])}null!=c.startContainer.previousSibling&&"HEAD"==c.startContainer.previousSibling.tagName&&null==c.endContainer.nextSibling&&(f=c.getNodes())}g=f.length;e=c.startOffset;h=c.endOffset;m="marginLeft";q="paddingLeft";isRTL()&&
(m="marginRight",q="paddingRight");for(t=0;t<g;t++)null!=f[t].parentNode&&1==f[t].nodeType&&f[t].tagName&&"body"!=f[t].tagName.toLowerCase()&&("table"==f[t].tagName.toLowerCase()?"1"!=b._config.allowInoutdentText&&(u=parseIntOr0(f[t].style[m]),v=0>u-d?0:u-d,f[t].style[m]=v+"px"):(w=function(a){return a=DEXTTOP.DEXT5.util.replacePtOrCmToPx(a)},v=DEXTTOP.DEXT5.util.parseFloatOr0(w(f[t].style[q])),u=DEXTTOP.DEXT5.util.parseFloatOr0(w(f[t].style[m])),w=DEXTTOP.DEXT5.util.parseFloatOr0(w(f[t].style.textIndent)),
0<v?(tempUnit="px",0<u&&(v+=u),u=0,0!=w?0<w?0>v-d?(u=0,f[t].style.textIndent=w+v-d):u=v-d:0>w&&(u=0>v-d+w?-w:v-d):u=0>v-d?0:v-d,f[t].style[q]="",f[t].style[m]=u+(""==tempUnit?"px":tempUnit)):(tempUnit="px",v=0,0!=w?0<w?0>u-d?(v=0,f[t].style.textIndent=w+u-d):v=u-d:0>w&&(v=0>u-d+w?-w:u-d):v=0>u-d?0:u-d,f[t].style[m]=v+(""==tempUnit?"px":tempUnit))));d=!1;f[0]&&3==f[0].nodeType&&3==c.endContainer.nodeType&&(d=!0);d&&(1==c.collapsed&&c.setEnd(f[0],h),c.setStart(f[0],e),rangy.getSelection(_iframeWin).removeAllRanges(),
rangy.getSelection(_iframeWin).addRange(c));G_Ruler&&"2"==b._config.ruler.mode&&G_Ruler.SetRulerPosition()}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_insertOrderedList(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(null==b._formatPainterList||b._formatPainterList&&"1"!=b._formatPainterList.nowApplying)try{b.UndoManager.putUndo(),b.UndoManager.charCount=0}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var d=function(a){""==a.style.listStyleType&&(a.style.listStyleType=b._config.olListStyleTypeSequence.init);""!=b._config.orderListDefaultClass&&a.setAttribute("class",b._config.orderListDefaultClass);
if(a.parentNode&&a.parentNode.tagName&&-1<",ul,ol,".indexOf(","+a.parentNode.tagName.toLowerCase()+",")){for(var c=a.previousSibling;null!=c&&1!=c.nodeType;)c=c.previousSibling;"2"==b._config.olUlTagMode&&c&&"li"==c.tagName.toLowerCase()&&c.appendChild(a)}},e=function(a){for(var b=a.length,c=0;c<b;c++)if("ol"==a[c].nodeName.toLowerCase()){var d=a[c].parentNode;"p"==d.nodeName.toLowerCase()&&(""==a[c].style.fontSize&&""!=d.style.fontSize&&(a[c].style.fontSize=d.style.fontSize),""==a[c].style.fontFamily&&
""!=d.style.fontFamily&&(a[c].style.fontFamily=d.style.fontFamily),d.parentNode.replaceChild(a[c],d),d=getFirstRange(),d.sel.removeAllRanges(),d.range.selectNodeContents(a[c]),d.sel.addRange(d.range))}},f=function(a){var b=getFirstRange().range,c=null;b&&b.startContainer&&(c="BODY"==b.startContainer.tagName?b.startContainer.childNodes[b.startOffset]:getMyElementNode(b.startContainer));var b=GetParentbyTagName(c,"ol",!0),f=GetParentbyTagName(c,"ul",!0);_iframeDoc.execCommand("insertOrderedList",!1,
null);var g=getFirstRange().range;0==!!g&&(g=q);setMenuIconRealable(getMyElementNode(g.startContainer));if(a)for(var g=a.getElementsByTagName("ol"),h=g.length,m=0;m<h;m++)d(g[m]),e([g[m]]);else(c="BODY"==g.startContainer.tagName?g.startContainer.childNodes[g.startOffset]:getMyElementNode(g.startContainer))&&(h=GetParentbyTagName(c,"ol"))&&d(h),g=getNodesInRange(g),e(g);if("40px"!==_dext_editor._config.listSpaceSize){for(c=c.parentNode;"OL"!=c.tagName;)c=c.parentNode;c.style.paddingLeft="0";c.style.marginLeft=
_dext_editor._config.listSpaceSize}null==b&&null==f&&setLiStyle();removeDivInLiTag(a)},g=GetTableSelectionCells(),h=g.length;if(0<h)for(var m=getFirstRange(),q=m.range,t=q.cloneRange(),u=0;u<h;u++){m.sel.removeAllRanges();var v=getMyFirstOrLastChildElementNode(g[u],!1),w=getMyFirstOrLastChildElementNode(g[u],!0);if(null==v&&null==w){var y=_iframeDoc.createElement("p");y.innerHTML="<br>";w=v=y;g[u].appendChild(y)}v&&w&&(q.setStartBefore(v),q.setEndAfter(w),m.sel.addRange(q),f(g[u]),m.sel.removeAllRanges(),
m.sel.addRange(t))}else f();G_Ruler&&"2"==b._config.ruler.mode&&G_Ruler.SetRulerPosition();if(null==b._formatPainterList||b._formatPainterList&&"1"!=b._formatPainterList.nowApplying)try{b.UndoManager.putUndo(),b.UndoManager.charCount=0}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function command_listDecimal(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","decimal")}
function command_listDecimalLeadingZero(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","decimal-leading-zero")}function command_listLowerAlpha(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","lower-alpha")}function command_listLowerGreek(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","lower-greek")}function command_listLowerRoman(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","lower-roman")}
function command_listUpperAlpha(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","upper-alpha")}function command_listUpperRoman(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","upper-roman")}function command_expandList(a,b,c){var d;c.includes("list_")&&(d=c.replace("list_",""));dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N",d)}
function command_insertUnOrderedList(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(null==b._formatPainterList||b._formatPainterList&&"1"!=b._formatPainterList.nowApplying)try{b.UndoManager.putUndo(),b.UndoManager.charCount=0}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var d=function(a){""==a.style.listStyleType&&(a.style.listStyleType=b._config.ulListStyleTypeSequence.init);""!=b._config.unOrderListDefaultClass&&a.setAttribute("class",b._config.unOrderListDefaultClass);
if(a.parentNode&&a.parentNode.tagName&&-1<",ul,ol,".indexOf(","+a.parentNode.tagName.toLowerCase()+",")){for(var c=a.previousSibling;null!=c&&1!=c.nodeType;)c=c.previousSibling;"2"==b._config.olUlTagMode&&c&&"li"==c.tagName.toLowerCase()&&c.appendChild(a)}},e=function(a){for(var b=a.length,c=0;c<b;c++)if("ul"==a[c].nodeName.toLowerCase()){var d=a[c].parentNode;"p"==d.nodeName.toLowerCase()&&(""==a[c].style.fontSize&&""!=d.style.fontSize&&(a[c].style.fontSize=d.style.fontSize),""==a[c].style.fontFamily&&
""!=d.style.fontFamily&&(a[c].style.fontFamily=d.style.fontFamily),d.parentNode.replaceChild(a[c],d),d=getFirstRange(),d.sel.removeAllRanges(),d.range.selectNodeContents(a[c]),d.sel.addRange(d.range))}},f=function(a){var b=getFirstRange().range,c=null;b&&b.startContainer&&(c="BODY"==b.startContainer.tagName?b.startContainer.childNodes[b.startOffset]:getMyElementNode(b.startContainer));var b=GetParentbyTagName(c,"ol",!0),f=GetParentbyTagName(c,"ul",!0);f?f.style.listStyleType="":b&&(b.style.listStyleType=
"");_iframeDoc.execCommand("insertUnOrderedList",!1,null);var g=getFirstRange().range;0==!!g&&(g=q);setMenuIconRealable(getMyElementNode(g.startContainer));if(a)for(var g=a.getElementsByTagName("ul"),h=g.length,m=0;m<h;m++)d(g[m]),e([g[m]]);else(c="BODY"==g.startContainer.tagName?g.startContainer.childNodes[g.startOffset]:getMyElementNode(g.startContainer))&&(h=GetParentbyTagName(c,"ul"))&&d(h),g=getNodesInRange(g),e(g);if("40px"!==_dext_editor._config.listSpaceSize){for(c=c.parentNode;"UL"!=c.tagName;)c=
c.parentNode;c.style.paddingLeft="0";c.style.marginLeft=_dext_editor._config.listSpaceSize}null==b&&null==f&&setLiStyle();removeDivInLiTag(a)},g=GetTableSelectionCells(),h=g.length;if(0<h)for(var m=getFirstRange(),q=m.range,t=q.cloneRange(),u=0;u<h;u++){m.sel.removeAllRanges();var v=getMyFirstOrLastChildElementNode(g[u],!1),w=getMyFirstOrLastChildElementNode(g[u],!0);if(null==v&&null==w){var y=_iframeDoc.createElement("p");y.innerHTML="<br>";w=v=y;g[u].appendChild(y)}v&&w&&(q.setStartBefore(v),q.setEndAfter(w),
m.sel.addRange(q),f(g[u]),m.sel.removeAllRanges(),m.sel.addRange(t))}else f();G_Ruler&&"2"==b._config.ruler.mode&&G_Ruler.SetRulerPosition();if(null==b._formatPainterList||b._formatPainterList&&"1"!=b._formatPainterList.nowApplying)try{b.UndoManager.putUndo(),b.UndoManager.charCount=0}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function command_listDisc(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"B","disc")}
function command_listCircle(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"B","circle")}function command_listSquare(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"B","square")}function command_expandListBullet(a,b,c){var d;c.includes("list_")&&(d=c.replace("list_",""));dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"B",d)}function command_listNone_N(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","none")}
function command_listNone_B(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"B","none")}function command_removeFormat(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange();DoExecuteCommand2(c.sel,c.range,"removeFormat")}
function command_removeCss(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange().range;try{var d=getElementsFromSelection(),e=d.length;if(1==c.collapsed){var f=GetTableSelectionCells(),g=f.length;if(0==g)return!1;1!=isApplyFormat&&ClearDraggingTableCellSelected();for(var d=[],c=null,h=0,m=0;m<g;m++){d.push(f[m]);for(var c=f[m].getElementsByTagName("*"),h=c.length,q=0;q<h;q++)d.push(c[q])}e=d.length}else{f="";g=!1;for(m=0;m<e;m++)f=d[m].nodeName,"TABLE"==f&&
(g=!0);g&&ClearDraggingTableAllTable()}(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();for(var f=null,t,m=0;m<e;m++)if(f=d[m],t=f.tagName.toLowerCase(),"table"==t||"td"==t||"th"==t){if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying){var u=
f.style.width,v=f.style.height,w=f.style.border,y=f.style.borderBottom,x=f.style.borderTop,z=f.style.borderLeft,B=f.style.borderRight,D=f.style.borderWidth,A=f.style.borderStyle,C=f.style.borderColor,E=f.style.position,H=f.style.overflow,M=f.style.zIndex,g="";"table"==t&&(g=f.style.fontSize);removeAttribute(f,"align");removeAttribute(f,"style");removeAttribute(f,"className");removeAttribute(f,"bgcolor");""!=g&&(f.style.fontSize=g);""!=u&&(f.style.width=u);""!=v&&(f.style.height=v);""!=w&&(f.style.border=
w);""!=D&&(f.style.borderWidth=D);""!=A&&(f.style.borderStyle=A);""!=C&&(f.style.borderColor=C);""!=y&&(f.style.borderBottom=y);""!=x&&(f.style.borderTop=x);""!=z&&(f.style.borderLeft=z);""!=B&&(f.style.borderRight=B);""!=E&&(f.style.position=E);""!=H&&(f.style.overflow=H);""!=M&&(f.style.zIndex=M);"table"==t&&(f.style.borderCollapse="collapse",null!=f.getAttribute("cellpadding")&&"0"!=f.getAttribute("cellpadding")||f.setAttribute("cellPadding","1"))}}else{var g="style align background cellOrgBgColor border borderColor color face size height width hspace vspace valign class".split(" "),
N=g.length;if(-1<",a,p,span,div,address,b,dd,dl,dt,font,i,li,label,ol,ul,strike,strong,sub,sup,u,".indexOf(","+t+","))for(c=0;c<N;c++)removeAttribute(f,g[c])}var I=DEXT5_EDITOR.HTMLParser.makeMap("span,font");DEXTTOP.G_CURREDITOR._formatPainterList&&"1"==DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying&&(I=DEXT5_EDITOR.HTMLParser.makeMap("span,font,b,strong,i,em,u,strike,s,sub,sup"));for(m=e-1;0<=m;m--)if(f=d[m],t=f.tagName.toLowerCase(),I[t]&&"BODY"!=f.parentNode.tagName)if(DEXTTOP.DEXT5.browser.ie)f.removeNode();
else{for(;f.firstChild;)f.parentNode.insertBefore(f.firstChild,f);f.parentNode.removeChild(f)}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(S){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_removeCss2(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange().range;if(1==a.collapsed)try{var d=getElementsFromSelection(),e=d.length;if(1==a.collapsed){var f=GetTableSelectionCells(),g=f.length;if(0==g)return!1;d=[];c=null;for(var h=a=0;h<g;h++){d.push(f[h]);c=f[h].getElementsByTagName("*");a=c.length;for(var m=0;m<a;m++)d.push(c[m])}e=d.length}for(var f=null,q,h=0;h<e;h++)if(f=d[h],q=f.tagName.toLowerCase(),"table"!=q&&"td"!=q&&"th"!=q&&
"tr"!=q&&"tbody"!=q&&"body"!=q&&"img"!=q){for(var t=f.attributes.length,g=[],m=0;m<t;m++)g.push(f.attributes[m].nodeName);for(c=0;c<t;c++)removeAttribute(f,g[c])}var u=DEXT5_EDITOR.HTMLParser.makeMap("span,font");DEXTTOP.G_CURREDITOR._formatPainterList&&"1"==DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying&&(u=DEXT5_EDITOR.HTMLParser.makeMap("span,font,b,strong,i,em,u,strike,s,sub,sup"));for(h=0;h<e;h++)f=d[h],q=f.tagName.toLowerCase(),u[q]&&"BODY"!=f.parentNode.tagName&&f.removeNode()}catch(v){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else removeCssInSelection(c)}
function command_copy(a,b){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();if(!0===(b?b:{}).textCopy){var c=getFirstRange().range.cloneContents(),d=_iframeDoc.createElement("div");d.appendChild(c);c=convertHtmlToTextEx(d.innerHTML);if(DEXTTOP.clipboardData&&DEXTTOP.clipboardData.setData)DEXTTOP.clipboardData.setData("Text",c);else if(DEXTTOP.navigator.clipboard&&DEXTTOP.isSecureContext)DEXTTOP.navigator.clipboard.writeText(c);else{d=document.createElement("textarea");d.value=c;
d.style.top="0";d.style.left="-500px";d.style.position="fixed";document.body.appendChild(d);d.focus();d.select();try{document.execCommand("copy")}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}document.body.removeChild(d);setFocusToBody()}}else 0==_iframeDoc.execCommand("copy",!1,null)&&alert(dext5_lang.msg.copy)}
function command_cut(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(1!=DEXTTOP.DEXT5.browser.gecko&&1!=DEXTTOP.DEXT5.browser.safari){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();_iframeDoc.execCommand("cut",!1,null);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper()}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else alert(dext5_lang.msg.cut)}
function command_pastehtml(a,b,c,d){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion){0<b.UndoManager.charCount&&b.UndoManager.putUndo();if(G_dext5plugIn&&0==b.setTextPaste){try{if(void 0==d&&"1"==b._config.limitPasteHtmlLength.value){var e=b._config.limitPasteHtmlLength.length,f=G_dext5plugIn.getOriginalHtml("body");if(f.length>e&&!checkCanPasteToIamge()){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2);setFocusToBody();
return}if("0"==b._config.pasteToImage&&f.length>e){checkCanPasteToIamge()?alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1):alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2);setFocusToBody();return}}}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}a=G_dext5plugIn.getPasteHtml();a=a.replace(/layout-flow:.*?;/gi,"");"1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64_remove&&(a=a.replace(/<img[^>]*src=["\']([^>]*:\\)([^>"\']+)["\']?[^>]*>/gi,""));if(100==G_dext5plugIn.getHTMLFormatFromType){var h=
"",m=findUrlInText(a,DEXTTOP.G_CURREDITOR);""!=m.changedData&&(h=a,a=m.changedData);a=adjustTextPasteForPlugin(a);if(""!=m.changedData){m.changedData=a;try{a=replaceRealUrl(m)}catch(q){a=adjustTextPasteForPlugin(h),a=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,a)}}}else{h="";try{h=G_dext5plugIn.getDext5PluginVersion()}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}m=!0;""!=h&&(m=DEXTTOP.DEXT5.util.compareVersion?0<=DEXTTOP.DEXT5.util.compareVersion(h,"5,0,0,9"):"5,0,0,9"<=
h);m&&6!=G_dext5plugIn.getHTMLFormatFromType&&(a=a.replace(/\r\n/g,"\n"))}h=!1;if(DEXTTOP.G_CURREDITOR.setTextPaste&&"1"!=DEXTTOP.G_CURREDITOR.setTextPasteMode){if(6==G_dext5plugIn.getHTMLFormatFromType){a=G_dext5plugIn.getPasteHtmlEx();var m=a.indexOf("\x3c!--StartFragment--\x3e"),u=a.lastIndexOf("\x3c!--EndFragment--\x3e");-1<m&&-1<u&&(strTemp=a.substr(m+20),u=strTemp.lastIndexOf("\x3c!--EndFragment--\x3e"),-1<u&&(a=strTemp=strTemp.substring(0,u)))}m=document.createElement("div");m.innerHTML=a;
a=m.innerHTML;a=DEXTTOP.DEXT5.convertHtmlToText(a)}else{if(G_dext5plugIn.getHTMLFormatFromType&&G_dext5plugIn.getPasteHtmlEx&&6==G_dext5plugIn.getHTMLFormatFromType&&(h=!0,DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&(u=a.match(RegExp("<img[^>]*src=[\"']?([^>\"']+)[\"']?[^>]*>","gi")))))for(var v=u.length,m=0;m<v;m++)if(-1<u[m].indexOf("file://")){h=!1;break}6==G_dext5plugIn.getHTMLFormatFromType&&DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion&&(m=G_dext5plugIn.getPasteHtmlEx(),
m=checkCopyInCellFormInertnNet(m),""!=m&&(a=m,h=!1))}if(void 0!=c){d&&"0"==b._config.pasteToImage&&d.hide();c=G_dext5plugIn.ShowImageSaveDlgFromClipboard(c);try{if("HTML"==c&&"1"==b._config.limitPasteHtmlLength.value&&(e=b._config.limitPasteHtmlLength.length,f=G_dext5plugIn.getOriginalHtml("body"),f.length>e)){checkCanPasteToIamge()?alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1):alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2);setFocusToBody();return}}catch(w){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&
RAONWIZDLW()}if(""==c){setFocusToBody();return}""!=c&&"HTML"!=c&&(a=c,h=!1)}"1"==b._config.ie_BugFixed_Hyfont&&(a=DEXTTOP.DEXT5.util.replaceHyFont(a,b));a=replaceFontFamilyInHtml(a,b);e=!0;h&&(setPasteBin(),b.isStopScroll=!0,(e=document.execCommand("paste",!1,null))?(e=!1,fn_PasteIE(),setTimeout(function(){b.isStopScroll=!1},1)):e=!0);if(e){e=!1;6==G_dext5plugIn.getHTMLFormatFromType&&(e=!0);f=document.createElement("div");f.innerHTML=a;if(c=replaceSpanToDivContainAbsolute(f))a=f.innerHTML;if(-1<
b._config.disableInsertImage.indexOf(",paste_image,")){c=!1;d=f.getElementsByTagName("img");for(m=d.length-1;0<=m;m--)h=d[m],h.src&&0==h.src.toLowerCase().indexOf("file:")&&(c=!0,h.parentNode.removeChild(h));c&&(a=f.innerHTML)}a=execReplaceMsoStyle(a);"1"==b._config.useHtmlCorrection?"1"==b._config.useHtmlProcessByWorker?(showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:DEXTTOP.G_CURREDITOR._config,
callFn:"htmlTagRevision",callFnParam:[a,!0,e],callBackFn:fn_PastePlugin_htmlTagRevision_After})):(a=htmlTagRevision(a,!0,e),fn_PastePlugin_htmlTagRevision_After(a)):fn_PastePlugin_htmlTagRevision_After(a)}}else setPasteBin(),b.isStopScroll=!0,document.execCommand("paste",!1,null),fn_PasteIE(),setTimeout(function(){b.isStopScroll=!1},1);b.UndoManager.putUndo();b.UndoManager.charCount=0}else _iframeDoc.queryCommandState("paste")?(0<b.UndoManager.charCount&&b.UndoManager.putUndo(),_iframeDoc.execCommand("paste",
!1,null),b.UndoManager.putUndo(),b.UndoManager.charCount=0):"1"==b._config.usePasteToolbarAndContext&&accessNavigatorClipboard?(DEXTTOP.G_CURREDITOR.html5PasteImageType="","jpg"==c?DEXTTOP.G_CURREDITOR.html5PasteImageType="usePasteToImage":""==c&&(DEXTTOP.G_CURREDITOR.html5PasteImageType="usePasteToImageDetail"),a={},1==_dext_editor.setTextPaste&&(a.pasteText=!0),accessNavigatorClipboard(a).then(function(a){a.error&&(2==a.error?alert(dext5_lang.paste_dialog.permissionDenied):b._dextCommands(b.ID,
"paste_dialog"))})):b._dextCommands(b.ID,"paste_dialog")}
function fn_command_pasteHtml_htmlTagRevision_After(a,b){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();"undefined"==typeof b&&(b=DEXTTOP.G_CURREDITOR);a=removeTagStyle(a);a=repairPasteTextInCell(a);0<a.length?(0<b.UndoManager.charCount&&(b.UndoManager.putUndo(),b._iconEnable("")),"1"==b._config.useHtmlProcessByWorker?(a=DEXTTOP.DEXT5.util.officeCleanByDom(a,!0),showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,
gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:b._config,callFn:"DEXTTOP.DEXT5.util.officeClean",callFnParam:[a,!0],callBackFn:fn_command_pasteHtml_officeClean_After})):(a=DEXTTOP.DEXT5.util.officeClean(a,!0),fn_command_pasteHtml_officeClean_After(a,b))):"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}
function fn_command_pasteHtml_officeClean_After(a,b){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();"undefined"==typeof b&&(b=DEXTTOP.G_CURREDITOR);a=OfficePasteClean(a);a=DEXTTOP.DEXT5.util.emptyTagRemove(a);a=IEPasteRemoveEmptyNodes(a);a=DEXTTOP.DEXT5.util.htmlRevision(a);a=xssReplaceScript(null,a);a=adjustSizeInContainer({strHtml:a});a=getImageAutoFitForPasteHtml(a);a=removeEditorAttribute(a);"1"==b._config.removeAppleInterchangeNewlineBr&&(a=a.replace(/<br class="Apple-interchange-newline">/gi,
""));"1"==b._config.compatibility.dingBatCharPaste&&(a=dingBatFont(a,DEXTTOP.editor));try{for(var c in G_DEPlugin)if("function"===typeof G_DEPlugin[c].onBeforePaste){var d=G_DEPlugin[c].onBeforePaste({html:a});if("string"==typeof d)a=d;else if(!1===d)return}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{if("function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste||"function"===typeof DEXTTOP.DEXTWIN.DEXTTOP.G_CURREDITOR._config.event.beforePaste){c=a;try{"function"===
typeof DEXTTOP.DEXTWIN.DEXTTOP.G_CURREDITOR._config.event.beforePaste?c=DEXTTOP.DEXTWIN.DEXTTOP.G_CURREDITOR._config.event.beforePaste(a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event&&(c=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(a))}catch(f){c=a}if(c)a=c;else if(0==c||""==c){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}pasteWordCount(a)?(-1<a.indexOf("dext5customdata")&&
(a=checkExistCustomData(a)),a=externalPageBreakDataRaplaceInEditor(a),setTimeout(function(){pasteHtmlAtCaretHuge(a)},0),checkPasteImage(a),0>a.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1)),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground(),window.setTimeout(function(){try{contentChangeEventWrapper(),onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}catch(a){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},500)):"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}
function command_pastetext(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=document.getElementById("dext_span_"+a+"text_paste");b.setTextPaste?(b.setTextPaste=!1,c.style.backgroundImage=""):(b.setTextPaste=!0,c&&(_className=DEXTTOP.DEXT5.util.getClass(c),_className+=" uebutton_span_enter",DEXTTOP.DEXT5.util.setClass(c,_className),-1<c.className.indexOf("uebutton_type")?c.style.backgroundImage="url("+b._config.webPath.image+"skin/"+b._config.style.skinName+"/form_skinback_release.gif)":
c.style.backgroundImage="url("+b._config.webPath.image+"skin/"+b._config.style.skinName+"/skinback_release.gif)"))}function getPageBreakOuterHTML(){var a;a='<div class="DEXT_fiVe_Page_Break" style="page-break-after:always; display:block;" contentEditable="false">'+('<span style="display:none;">'+dext5_lang.icon.pagebreak+"</span>");return a+"</div>"}
function command_pagebreak(a,b){try{dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var c=getFirstRange(),d=c.range,e=c.sel,f=function(a,b){var c=a.sel,d=a.range;if(DEXTTOP.DEXT5.browser.ie)c.removeAllRanges(),d.setStartBefore(b),d.setEndBefore(b);else{var e=_iframeDoc.createElement("p");e.innerHTML="<br>";b.parentNode.insertBefore(e,b);c.removeAllRanges();d.setStart(e,0);d.setEnd(e,0)}c.addRange(d)},
g=getParentbyTagNameEx(d.startContainer,"td,th");if(g){var h=/<table/i.test(g.innerHTML),m=GetParentbyTagName(g,"table"),q=null;if(q=h?m:GetParentbyTagName(m.parentNode,"table")){for(;;){var t=GetParentbyTagName(q.parentNode,"table");if(null==t)break;else q=t}f({sel:e,range:d},q)}else{var u=splitTable(g,m);if(u.table2)f({sel:e,range:d},u.table2);else return}}else 0==d.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);var c=getFirstRange(),e=c.sel,v=getPageBreakOuterHTML(),v=v.replace(/<div /,
'<div id="dext_page_break" '),c="";DEXTTOP.DEXT5.browser.ie&&(c="<p>",11<=DEXTTOP.DEXT5.browser.ieVersion?c+="<br>":7>=DEXTTOP.DEXT5.browser.ieVersion&&(c+="&nbsp;"),c+="</p>");pasteHtmlAtCaretHuge(v+c,!1,!0,!1,!0);var w=_iframeDoc.getElementById("dext_page_break");w.removeAttribute("id");var y=GetParentbyTagName(w,"span");y&&(y.parentNode.insertBefore(w,y),""==y.innerHTML&&y.parentNode.removeChild(y));v=null;try{w.nextSibling?v=w.nextSibling:(v=_iframeDoc.createElement("p"),v.innerHTML=!DEXTTOP.DEXT5.browser.ie||
DEXTTOP.DEXT5.browser.ie&&11<=DEXTTOP.DEXT5.browser.ieVersion?"<br>":"&nbsp;",w.parentNode.appendChild(v)),v&&doSetCaretPosition(v,0)}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_print(a,b){dext_src_init(b._EDITOR.design);var c=function(a,b){isViewMode(b)||b.setChangeMode("preview");setTimeout(function(){var a,c="preview";isViewMode(b)&&(c="design");a=b._EDITOR[c].contentDocument?b._EDITOR[c].contentDocument:b._EDITOR[c].contentWindow.document;changeSpanPageBreakProperty(a);if(DEXTTOP.DEXT5.browser.ie)if(c=a.getElementById("dext5printpreview"))try{c.doPrintPreview(b._config.printHeader,b._config.printFooter,"")}catch(d){a.execCommand("print",!1,null)}else a.execCommand("print",
!1,null);else"none"==b._EDITOR[c].style.display&&(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)&&(bChnageDisplay=!0,b._EDITOR[c].style.display=""),b._EDITOR[c].contentWindow.print();isViewMode(b)?restoreSpanPageBreakProperty(a):b.setChangeMode("design")},350)};if(DEXTTOP.DEXT5.browser.ie)if(G_dext5plugIn&&"1"==b._config.usePrintApp){var d=DEXTTOP.DEXT5.getHtmlValueExWithDocType(b.ID,!0);try{G_dext5plugIn.doPrintDirectEx(d,b._config.printHeader,b._config.printFooter)}catch(e){c(a,b)}}else c(a,
b);else c(a,b)}
function command_saveAs(a,b,c){dext_src_init(b._EDITOR.design);var d=DEXTTOP.DEXT5.getHtmlValueExWithDocType(),d=d.replace("&amp;","&");if(G_dext5plugIn){var e=b._config.saveHtmlName,e=e.replace(/[\\/:*?"<>|]/gi,""),f=e.lastIndexOf(".");0<=f&&(e=e.substr(0,f));c?(e=G_dext5plugIn.doSaveHTML(d,e,"utf-8",""),""!=e&&(b.strOldSaveFileName=e)):(c="",c=""==b.strOldSaveFileName?e:b.strOldSaveFileName,b.strOldSaveFileName=G_dext5plugIn.doSaveHTML(d,c,"utf-8",""))}else{var g=b._config.saveHtmlName,g=g.replace(/[\\/:*?"<>|]/gi,
""),f=g.lastIndexOf(".");0>g.substr(f+1).indexOf("htm")&&(g=0<=f?g.substr(0,f):g+".html");var h=function(){var a=DEXTTOP.DEXTDOC.createElement("form");a.id="dext5_saveFrm";a.name="dext5_saveFrm";DEXTTOP.DEXT5.util.isAndroidWebView()?a.method="get":a.method="post";var c=DEXTTOP.DEXTDOC.createElement("input");c.id="htmlstring";c.name="htmlstring";c.type="hidden";c.value=encodeURIComponent(d);var e=DEXTTOP.DEXTDOC.createElement("input");e.id="tosavepathurl";e.name="tosavepathurl";e.type="hidden";var f=
DEXTTOP.DEXTDOC.createElement("input");f.id="savafoldernamerule";f.name="savafoldernamerule";f.type="hidden";var h=DEXTTOP.DEXTDOC.createElement("input");h.id="saveHtmlName";h.name="saveHtmlName";h.type="hidden";if("0"!=b._config.security.encryptParam){e.value=DEXTTOP.DEXT5.util._fn_$mEPF(b._config.toSavePathURL);f.value=DEXTTOP.DEXT5.util._fn_$mEPF(b._config.saveFolderNameRule);h.value=DEXTTOP.DEXT5.util._fn_$mEPF(g);var w=DEXTTOP.DEXTDOC.createElement("input");w.id="pe";w.name="pe";w.value=b._config.security.encryptParam;
w.type="hidden";a.appendChild(w)}else e.value=b._config.toSavePathURL,f.value=b._config.saveFolderNameRule,h.value=encodeURIComponent(g);a.action=""!=b._config.post_url_save_for_notes?b._config.post_url_save_for_notes:b._config.post_url;a.appendChild(c);a.appendChild(e);a.appendChild(f);a.appendChild(h);DEXTTOP.DEXTDOC.body.appendChild(a);null==DEXTTOP.DEXTDOC.getElementById("dext_saveframe")&&(c=DEXTTOP.DEXTDOC.createElement("iframe"),c.style.display="none",c.id="dext_saveframe",c.name="dext_saveframe",
DEXTTOP.DEXTDOC.body.appendChild(c));a.target="dext_saveframe";a.submit();DEXTTOP.DEXTDOC.body.removeChild(a)},e=function(b){if(b){var c=document.createElement("iframe");c.style.display="none";c.id="saveframe";document.body.appendChild(c);var d=c.contentWindow.document;c.onload=function(){setTimeout(function(){d.execCommand("SaveAs",!0,g);c.parentNode.removeChild(c);c=null},10)};d.open("text/html","replace");d.write(DEXTTOP.DEXT5.getHtmlValueExWithDocType(a));d.close()}else{b=document.createElement("a");
b.setAttribute("href","data:text/html;charset=utf-8,"+encodeURIComponent(DEXTTOP.DEXT5.getHtmlValueExWithDocType(a)));b.setAttribute("download",g);if(document.createEvent){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0);b.dispatchEvent(e)}else b.click();b=null}};c=function(){if(DEXTTOP.navigator.msSaveOrOpenBlob){var b=new Blob([DEXTTOP.DEXT5.getHtmlValueExWithDocType(a)]);DEXTTOP.navigator.msSaveOrOpenBlob(b,g)}else h()};"1"==b._config.forceSaveAsServer||DEXTTOP.DEXT5.browser.mobile?
DEXTTOP.DEXT5.browser.iOS?function(){var a="",c=b._config.post_url_save_for_notes||b._config.post_url,a={htmlstring:encodeURIComponent(d),tosavepathurl:b._config.toSavePathURL,savafoldernamerule:b._config.saveFolderNameRule,saveHtmlName:encodeURIComponent(g)};"0"!==b._config.security.encryptParam&&(a.tosavepathurl=DEXTTOP.DEXT5.util._fn_$mEP(b._config.toSavePathURL),a.savafoldernamerule=DEXTTOP.DEXT5.util._fn_$mEP(b._config.saveFolderNameRule),a.saveHtmlName=DEXTTOP.DEXT5.util._fn_$mEP(g),a.pe=b._config.security.encryptParam);
var e=[],f;for(f in a)a.hasOwnProperty(f)&&e.push(f+"="+encodeURIComponent(a[f]));var a="?"+e.join("&"),h=c+a;setTimeout(function(){window.open(h)},500)}():h():DEXTTOP.DEXT5.browser.safari?h():DEXTTOP.DEXT5.browser.ie&&11<DEXTTOP.DEXT5.browser.ieVersion?c():DEXTTOP.DEXT5.browser.ie?e(!0):e(!1)}}function command_undo(a,b){dext_src_init(b._EDITOR.design);"1"==b._config.undoMode&&0<b.UndoManager.charCount&&(b.UndoManager.putUndo(),b.UndoManager.charCount=0);b.UndoManager.execUndo()}
function command_redo(a,b){dext_src_init(b._EDITOR.design);b.UndoManager.execRedo();b.UndoManager.charCount=0}
function command_fontsize(a,b,c){dext_src_init(b);a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontsize:c};restoreSelection();setFocusToBody();b=getFirstRange();DoExecuteCommand3(b.sel,b.range,"fontSize",a,c);try{c={style:"fontSize",value:c},"function"===typeof DEXTTOP.G_CURREDITOR._config.event.applyFontStyle?DEXTTOP.G_CURREDITOR._config.event.applyFontStyle(DEXTTOP.G_CURREDITOR.ID,c):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_apply_font_style_event&&DEXTTOP.DEXTWIN.dext_editor_apply_font_style_event(DEXTTOP.G_CURREDITOR.ID,
c)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_fontfamily(a,b,c){dext_src_init(b);a=changeFontFamily(c);b={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontfamily:a};restoreSelection();setFocusToBody();c=getFirstRange();DoExecuteCommand3(c.sel,c.range,"fontFamily",b,a);try{a={style:"fontFamily",value:a},"function"===typeof DEXTTOP.G_CURREDITOR._config.event.applyFontStyle?DEXTTOP.G_CURREDITOR._config.event.applyFontStyle(DEXTTOP.G_CURREDITOR.ID,a):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_apply_font_style_event&&DEXTTOP.DEXTWIN.dext_editor_apply_font_style_event(DEXTTOP.G_CURREDITOR.ID,
a)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function command_docBGColor(a,b,c){dext_src_init(b);0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();_iframeDoc.body.style.background=c;DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_fontColor(a,b,c){dext_src_init(b);a=document.getElementById("dext_em_"+DEXTTOP.G_CURREDITOR.ID+"color_show");c?a.style.backgroundColor=c:c=a.style.backgroundColor;""==c&&(c="#000000");a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontcolor:c};restoreSelection();setFocusToBody();b=getFirstRange();DoExecuteCommand3(b.sel,b.range,"fontcolor",a,c)}
function command_fontBgColor(a,b,c){dext_src_init(b);a=document.getElementById("dext_em_"+DEXTTOP.G_CURREDITOR.ID+"bg_color_show");c?a.style.backgroundColor=c:c=a.style.backgroundColor;""==c&&(c="#ffffff");a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontcolor:c};restoreSelection();setFocusToBody();b=getFirstRange();DoExecuteCommand3(b.sel,b.range,"fontbgcolor",a,c)}
function command_lineHeight(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();a=getFirstRange();var d=a.range;if(DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion)try{if("BODY"!=d.startContainer.tagName&&1==d.endContainer.nodeType&&"BODY"==d.endContainer.tagName){var e=d.endContainer.childNodes[d.endOffset];d.setEnd(e,e.childNodes.length)}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{DEXTTOP.G_CURREDITOR.beforeOffset=[],DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startOffset),
DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endOffset),3==d.startContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startContainer.parentNode):DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startContainer),3==d.endContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endContainer.parentNode):(DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endContainer),1==d.endOffset&&(DEXTTOP.G_CURREDITOR.beforeOffset[1]=(d.endContainer.innerText||d.endContainer.textContent).length)),DEXTTOP.G_CURREDITOR.beforeOffset.push(d.toString().length)}catch(g){DEXTTOP.G_CURREDITOR.beforeOffset=
null}"2"==DEXTTOP.G_CURREDITOR._config.lineHeightMode&&-1<c.toString().indexOf("%")&&(c=parseInt(c,10)/100);if(void 0==d)DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion&&c==DEXTTOP.G_CURREDITOR._setting.line_height&&(c=parseInt(c,10)/100+.01),DoExecuteCommand3(a.sel,d,"lineheight",{document:_iframeDoc,styleWithCss:!0,lineheight:c},c);else{0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var e="p span li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" "),
h=e.length,m,q,t=GetTableSelectionCells();if(0==t.length){if(null!=d.startContainer.previousSibling&&"HEAD"==d.startContainer.previousSibling.tagName&&null==d.endContainer.nextSibling){for(a=0;a<h;a++)for(m=_iframeDoc.body.getElementsByTagName(e[a]),q=m.length,b=0;b<q;b++)"span"==m[b].tagName.toLowerCase()?""!=m[b].style.lineHeight&&(m[b].style.lineHeight=c):m[b].style.lineHeight=c;h=_iframeDoc.body.getElementsByTagName("table");m=h.length;for(a=0;a<m;a++){q=h[a].rows;var u=q.length;for(b=0;b<u;b++)for(var t=
q[b].cells,d=t.length,v=0;v<d;v++)setBlockTag(t[v].childNodes,e,"lineHeight",c)}setBlockTag(_iframeDoc.body.childNodes,e,"lineHeight",c);m=_iframeDoc.body.getElementsByTagName("div");q=m.length;for(b=0;b<q;b++)setBlockTag(m[b].childNodes,e,"lineHeight",c)}else{m=getNodesInRange(d);q=m.length;1==d.collapsed&&0==d.getNodes().length&&d.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(t=0;t<q;t++)if(1==m[t].nodeType&&(v=m[t].tagName.toLowerCase(),-1<e.indexOf(v))){if("div"!=v)for(a=0;a<h;a++){var u=
m[t].getElementsByTagName(e[a]),w=u.length;for(b=0;b<w;b++)"span"==u[b].tagName.toLowerCase()?""!=u[b].style.lineHeight&&(u[b].style.lineHeight=c):u[b].style.lineHeight=c}"span"==v?""!=m[t].style.lineHeight&&(m[t].style.lineHeight=c):m[t].style.lineHeight=c}var y;0==d.toString().length&&1==d.getNodes().length&&(y=d.getNodes()[0],m.push(d.getNodes()[0]));setBlockTag(m,e,"lineHeight",c)}(e=_iframeDoc.getElementById("_dextPosition"))?(doSetCaretPosition(e,1),e.parentNode.removeChild(e)):y&&(e=getFirstRange().range,
getFirstRange().sel.removeAllRanges(),e.selectNode(y),getFirstRange().sel.addRange(e))}else for(d=t.length,a=0;a<d;a++){for(b=0;b<h;b++)for(m=t[a].getElementsByTagName(e[b]),q=m.length,v=0;v<q;v++)"span"==m[v].tagName.toLowerCase()?""!=m[v].style.lineHeight&&(m[v].style.lineHeight=c):m[v].style.lineHeight=c;setBlockTag(t[a].childNodes,e,"lineHeight",c);m=t[a].getElementsByTagName("div");q=m.length;for(b=0;b<q;b++)setBlockTag(m[b].childNodes,e,"lineHeight",c)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}DEXTTOP.G_CURREDITOR.beforeOffset=null;try{c={style:"lineHeight",value:c},"function"===typeof DEXTTOP.G_CURREDITOR._config.event.applyFontStyle?DEXTTOP.G_CURREDITOR._config.event.applyFontStyle(DEXTTOP.G_CURREDITOR.ID,c):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_apply_font_style_event&&DEXTTOP.DEXTWIN.dext_editor_apply_font_style_event(DEXTTOP.G_CURREDITOR.ID,c)}catch(x){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}}
function command_InsertTablebyRowCol(a,b,c,d){dext_src_init(b);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();b=getFirstRange();a=b.range;try{1==a.collapsed&&setRestoreCaretPos(!1)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}b=getCellDefValue();a=_iframeDoc.createElement("table");var f=DEXTTOP.DEXT5.util.getWordBreakStyle(DEXTTOP.G_CURREDITOR._config);a.style.wordBreak=f;var f=0,g=getFirstRange().range,h=getMyElementNode(g.startContainer),m,g=
getWidthForAutoBodyFit(DEXTTOP.G_CURREDITOR,"table");try{var q=GetParentbyTagName(h,"td");if(q){var t=getClientRect(q);m=t.right-t.left}m&&50<m?(m-=10,f=Math.round(m/d),a.style.width=m+"px"):(f=Math.round(g/d),a.style.width=g+"px")}catch(u){f=Math.round(g/d),a.style.width=g+"px"}""!=DEXTTOP.G_CURREDITOR._config.tableDefaultWidth&&("number"!=typeof DEXTTOP.G_CURREDITOR._config.tableDefaultWidth&&-1<DEXTTOP.G_CURREDITOR._config.tableDefaultWidth.indexOf("%")?a.style.width=DEXTTOP.G_CURREDITOR._config.tableDefaultWidth:
(f=Math.round(DEXTTOP.G_CURREDITOR._config.tableDefaultWidth/d),a.style.width=DEXTTOP.G_CURREDITOR._config.tableDefaultWidth+"px"));""!=DEXTTOP.G_CURREDITOR._config.tableDefaultHeight&&(a.style.height=DEXTTOP.G_CURREDITOR._config.tableDefaultHeight+"px");""!=DEXTTOP.G_CURREDITOR._config.tableInitInoutdent&&(a.style.marginLeft=DEXTTOP.G_CURREDITOR._config.tableInitInoutdent+"px");q="";""!=DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight?(q=DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight+"px",a.style.height=
parseInt(q,10)*c+"px"):q="20px";""!=DEXTTOP.G_CURREDITOR._config.tableDefaultClass?(a.className=DEXTTOP.G_CURREDITOR._config.tableDefaultClass,q="",a.style.height=""):a.style.fontSize=DEXTTOP.G_CURREDITOR._setting.font_size;a.style.borderCollapse="collapse";"1"==DEXTTOP.G_CURREDITOR._config.useTableBorderAttribute&&a.setAttribute("border","1");m="";m=DEXTTOP.DEXT5.browser.gecko?"1px solid ":"1px none ";a.style.border=m+DEXTTOP.G_CURREDITOR._config.defaultBorderColor;a.setAttribute("cellSpacing","0");
t=_iframeDoc.createElement("tbody");for(g=0;g<c;g++){h=_iframeDoc.createElement("tr");for(m=0;m<d;m++){var v=_iframeDoc.createElement("td");v.innerHTML=b;v.style.border="1px solid "+DEXTTOP.G_CURREDITOR._config.defaultBorderColor;h.appendChild(v);v.style.width=f-1+"px";v.style.height=q;DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&0==m&&0==g&&(v.id="temp_td_for_caret")}t.appendChild(h)}a.appendChild(t);c=DEXTTOP.G_CURREDITOR._config.tableDefaultCellPadding;if("1"!=DEXTTOP.G_CURREDITOR._config.insidePaddingTdSetting)a.setAttribute("cellPadding",
c);else for(d=a.getElementsByTagName("td"),m=0;m<d.length;m++)d[m].style.padding=c+"px";g=getFirstRange().range;h=getMyElementNode(g.startContainer);"p"!=h.tagName.toLowerCase()||"<br>"!=h.innerHTML&&"<br/>"!=h.innerHTML&&"<br />"!=h.innerHTML&&""!=h.innerHTML&&"&nbsp;"!=h.innerHTML||g.selectNode(h);c=a.outerHTML;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){if(_iframeDoc.execCommand("inserthtml",!1,c),g=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(g)}else pasteHtmlAtCaretHuge(c);
b=getFirstRange();if(b.range.startContainer&&(a=GetParentbyTagName(b.range.startContainer,"table"),null==a))try{if(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion){var w=_iframeDoc.getElementById("temp_td_for_caret");w.removeAttribute("id");a=GetParentbyTagName(w,"table")}}catch(y){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{g.selectNode(a);var x=a.parentNode;"body"!=x.tagName.toLowerCase()&&g.setEndAfter(x);g.collapse(!1);DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion||
(b=getFirstRange(),b.sel.addRange(g));DEXTTOP.DEXT5.browser.gecko&&doSetCaretPosition(x,1);repairBodyFirstLastTag(!1);var z=a.rows[0].cells[0];z&&(createTableCellDefValue(z),0==checkCellBRValue()&&0==(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion)&&(z.innerHTML="<p></p>"),0!=DEXTTOP.DEXT5.browser.ie?doSetCaretPosition(z.childNodes[0],0):setTimeout(function(){doSetCaretPosition(z.childNodes[0],0)},10),DEXTTOP.G_SELECTED_ELEMENT=z.childNodes[0])}catch(B){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell");ActiveCurrTable=a;G_Ruler&&"2"==DEXTTOP.G_CURREDITOR._config.ruler.mode&&G_Ruler.SetRulerPosition();onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}
function command_InsertDetailTable(a,b,c,d,e,f,g,h,m,q,t,u,v,w,y,x,z,B,D,A,C,E,H,M,N,I,S,F,O,P,J,L,K,W,G,Q,X){dext_src_init(b);restoreSelection();setFocusToBody();Q||(Q="px");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var ea=L=b=a=0,V=getFirstRange().range,aa=getMyElementNode(V.startContainer),ga,V=getWidthForAutoBodyFit(DEXTTOP.G_CURREDITOR,"table");if("3"!=c&&"4"!=c){a=d;b=e;if(""==f)try{var ba=GetParentbyTagName(aa,"td");if(ba){var fa=getClientRect(ba);ga=fa.right-fa.left}ga?(L=ga,"px"==Q&&(L-=
10)):L=V}catch(ca){L=V}else L="%"==Q?(V+10)*(1*parseInt(f,10)/100):"1"==DEXTTOP.G_CURREDITOR._config.autoBodyFit?f>V?V:f:f;""!=g&&(ea=g)}else if("3"==c){a=H;b=M;if(""==N)try{if(ba=GetParentbyTagName(aa,"td"))fa=getClientRect(ba),ga=fa.right-fa.left;L=ga&&50<ga?ga-10:DEXTTOP.G_CURREDITOR._defTableWidth}catch(ta){L=DEXTTOP.G_CURREDITOR._defTableWidth}else L=N;""!=I&&(ea=I)}d=getFirstRange();d=d.range;try{1==d.collapsed&&setRestoreCaretPos(!1)}catch(da){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("4"!=
c){W=Math.floor(L/b*100)/100;d=Math.floor(ea/a*100)/100;0==d&&(d=""!=DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight?parseInt(DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight,10):20);e=getCellDefValue();K=_iframeDoc.createElement("table");H=DEXTTOP.DEXT5.util.getWordBreakStyle(DEXTTOP.G_CURREDITOR._config);K.style.wordBreak=H;null!=J&&""!=J&&(K.id=J);null!=P&&""!=P?(K.className=P,d=""):null==P&&""!=DEXTTOP.G_CURREDITOR._config.tableDefaultClass?(K.className=DEXTTOP.G_CURREDITOR._config.tableDefaultClass,
d=""):K.style.fontSize=DEXTTOP.G_CURREDITOR._setting.font_size;"%"==Q&&(L=""==f?"100":f);K.style.width=L+Q;if("3"!=c){""!=g&&(K.style.height=ea+"px");"Y"==h?K.style.borderCollapse="separate":"N"==h&&(K.style.borderCollapse="collapse");""==m||"left"==m&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO||(K.align=m);"N"==h?K.style.border=DEXTTOP.DEXT5.browser.gecko?"1px #000000":"1px none #000000":"Y"==h&&(""!=q.outsideTop&&(K.style.borderTop=q.outsideTop,showBorderForNoneClass(K,"dext_table_border_t")),
""!=q.outsideLeft&&(K.style.borderLeft=q.outsideLeft,showBorderForNoneClass(K,"dext_table_border_l")),""!=q.outsideRight&&(K.style.borderRight=q.outsideRight,showBorderForNoneClass(K,"dext_table_border_r")),""!=q.outsideBottom&&(K.style.borderBottom=q.outsideBottom,showBorderForNoneClass(K,"dext_table_border_b")));"1"==DEXTTOP.G_CURREDITOR._config.useTableBorderAttribute&&K.setAttribute("border","1");""!=t&&K.setAttribute("cellSpacing",t);""!=w&&K.setAttribute("summary",w);if(""!=y){"[FAIL]"==y.substring(0,
6)?(K.setAttribute("alt",y.substring(6,y.length)),y=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"):insertImageSrc(DEXTTOP.G_CURREDITOR,y);K.style.backgroundImage="url("+y+")";""!=x&&(K.style.backgroundAttachment=x);""!=z&&(K.style.backgroundRepeat=z);if(""!=B||""!=D)K.style.backgroundPosition=parseInt(B,10)+"px "+parseInt(D,10)+"px";if(G&&1<G.length)for(g=G.length,f=1;f<g;f++)m=G[f].split("^"),2==m.length&&K.setAttribute(m[0],m[1])}""!=A&&(K.style.backgroundColor=A)}else""!=I&&
"1"==DEXTTOP.G_CURREDITOR._config.tableUseHeight&&(K.style.height=ea+"px"),"1"==F?(q.outsideTop="3px solid rgb(0, 216, 255)",q.outsideLeft="0px rgb(0, 0, 0)",q.outsideRight="0px rgb(0, 0, 0)",q.outsideBottom="3px solid rgb(0, 216, 255)",q.insideRow="1px solid rgb(0, 0, 0)",q.insideCol="1px solid rgb(0, 0, 0)",K.style.borderCollapse="collapse",K.style.fontSize="10pt",K.setAttribute("cellSpacing","0"),K.setAttribute("cellPadding","3")):"2"==F?(K.style.borderWidth="1px",K.style.borderStyle="solid",K.style.borderColor=
"#000000",K.style.fontSize="10pt",K.style.borderCollapse="collapse",K.setAttribute("border","1"),K.setAttribute("cellSpacing","0")):"3"==F?(K.style.borderWidth="1px",K.style.borderStyle="dashed",K.style.borderColor="#000000",K.style.fontSize="10pt",K.style.borderCollapse="collapse",K.setAttribute("border","1"),K.setAttribute("cellSpacing","0")):"4"==F?(K.style.borderWidth="1px",K.style.borderStyle="solid",K.style.borderColor="#000000",K.style.fontSize="10pt",K.style.borderCollapse="collapse",K.setAttribute("border",
"1"),K.setAttribute("cellSpacing","0")):"5"==F?(K.style.borderWidth="1px",K.style.borderStyle="solid",K.style.borderColor="#000000",K.style.fontSize="10pt",K.style.borderCollapse="collapse",K.setAttribute("border","1"),K.setAttribute("cellSpacing","0")):"6"==F?(K.style.borderWidth="1px",K.style.borderStyle="solid",K.style.borderColor="#000000",K.style.fontSize="10pt",K.style.borderCollapse="collapse",K.setAttribute("border","1"),K.setAttribute("cellSpacing","0")):"7"==F?(K.style.borderWidth="medium",
K.style.borderStyle="solid",K.style.borderColor="#000000",K.style.fontSize="10pt",K.setAttribute("rules","none"),K.setAttribute("cellSpacing","0")):"8"==F?(K.style.borderWidth="1px",K.style.borderStyle="solid",K.style.borderColor="#000000",K.style.fontSize="10pt",K.style.borderCollapse="collapse",K.setAttribute("border","1"),K.setAttribute("cellSpacing","0")):"9"==F?(K.style.borderWidth="1px",K.style.borderStyle="solid",K.style.borderColor="#000000",K.style.fontSize="10pt",K.style.borderCollapse=
"collapse",K.setAttribute("border","1"),K.setAttribute("cellSpacing","0")):"10"==F?(K.style.borderWidth="1px",K.style.borderStyle="solid",K.style.borderColor="#000000",K.style.fontSize="10pt",K.style.borderCollapse="collapse",K.setAttribute("border","1")):"11"==F?(K.style.borderStyle="hidden",K.style.borderColor="#ffffff",K.style.fontSize="10pt",K.setAttribute("border","1"),K.setAttribute("rules","none"),K.setAttribute("frame","void"),K.setAttribute("cellSpacing","0")):"12"==F&&(K.style.borderWidth=
"1px",K.style.borderStyle="solid",K.style.borderColor="#000000",K.style.fontSize="10pt",K.style.borderCollapse="collapse",K.setAttribute("border","1"),K.setAttribute("rules","rows"),K.setAttribute("cellSpacing","0"));0<O&&(K.style.marginLeft=O+"px");A=_iframeDoc.createElement("tbody");for(O=0;O<a;O++){G=_iframeDoc.createElement("tr");for(f=0;f<b;f++){if("3"!=c)"2"==E?0==f?(g=_iframeDoc.createElement("th"),"Y"==C&&(g.scope="row")):g=_iframeDoc.createElement("td"):"3"==E?0==O?(g=_iframeDoc.createElement("th"),
"Y"==C&&(g.scope="col")):g=_iframeDoc.createElement("td"):"4"==E?0==f||0==O?(g=_iframeDoc.createElement("th"),"Y"!=C||0==f&&0==O||(0==f&&(g.scope="row"),0==O&&(g.scope="col"))):g=_iframeDoc.createElement("td"):g=_iframeDoc.createElement("td"),g.innerHTML=e;else{if("5"==F&&0!=f&&0==O)continue;"1"==F||"2"==F||"5"==F||"10"==F||"11"==F||"12"==F?0==O?(g=_iframeDoc.createElement("th"),"Y"==S&&(g.scope="col")):g=_iframeDoc.createElement("td"):"6"==F?0==O||0==f?(g=_iframeDoc.createElement("th"),"Y"!=S||0==
f&&0==O||(0==f&&(g.scope="row"),0==O&&(g.scope="col"))):g=_iframeDoc.createElement("td"):"8"==F?0==f?(g=_iframeDoc.createElement("th"),"Y"==S&&(g.scope="row")):g=_iframeDoc.createElement("td"):g=_iframeDoc.createElement("td");"1"==F?0==O?(m=_iframeDoc.createElement("p"),m.innerHTML="T"+(f+1),g.appendChild(m)):g.innerHTML=e:g.innerHTML=e}G.appendChild(g);"3"==c&&"1"!=F?"4"==F?(g.style.borderWidth="1px",g.style.borderStyle="dashed",g.style.borderColor="#000000"):"5"==F?0==f&&0==O&&g.setAttribute("colSpan",
b):"6"==F?0==O?0!=f&&(g.style.backgroundColor="#e5e5e5"):0==f&&(g.style.backgroundColor="#e9f5f7"):"8"==F&&0==f&&(g.style.backgroundColor="#e9f5f7"):("3"==c&&"1"==F&&0==O&&(g.style.textAlign="center"),g.style.border="1px solid #000000","N"==h&&(0==O&&""!=q.outsideTop&&(g.style.borderTop=q.outsideTop,showBorderForNoneClass(g,"dext_table_border_t")),0==f&&""!=q.outsideLeft&&(g.style.borderLeft=q.outsideLeft,showBorderForNoneClass(g,"dext_table_border_l")),f==b-1&&""!=q.outsideRight&&(g.style.borderRight=
q.outsideRight,showBorderForNoneClass(g,"dext_table_border_r")),O==a-1&&""!=q.outsideBottom&&(g.style.borderBottom=q.outsideBottom,showBorderForNoneClass(g,"dext_table_border_b"))));""!=W&&(g.style.width=W-1+"px");""!=d&&(g.style.height=d+"px");DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&0==f&&0==O&&(g.id="temp_td_for_caret")}A.appendChild(G);"3"==c&&("2"==F?0==O&&(G.style.backgroundColor="#e5e5e5"):"5"==F?0==O&&(G.style.backgroundColor="#e5e5e5"):"9"==F?G.style.backgroundColor=0==
O%2?"#e5e5e5":"#e9f5f7":"10"==F?0==O?G.style.backgroundColor="#e5e5e5":O==parseInt(a,10)-1&&(G.style.backgroundColor="#e9f5f7"):"11"==F?0==O&&(G.style.backgroundColor="#e5e5e5"):"12"==F&&0==O&&(G.style.backgroundColor="#e5e5e5"))}""!=v&&(h=_iframeDoc.createElement("caption"),h.innerHTML=v,K.appendChild(h),v=!0,"object"==typeof X&&(v=X.captionDisplay),!0!==v&&(h.style.display="none"));K.appendChild(A);if(""!=u)if("1"==DEXTTOP.G_CURREDITOR._config.insidePaddingTdSetting)for(X=K.getElementsByTagName("td"),
f=0;f<X.length;f++)X[f].style.padding=u+"px";else K.setAttribute("cellPadding",u);("3"!=c||"3"==c&&"1"==F)&&setBorderTableAndAllCell(K,q);q=K}else q="TableTemplateList",0==DEXTTOP.DEXT5.util.xml.count(W,q)&&(q="TableTempleteList"),q=DEXTTOP.DEXT5.util.xml.getNodeIdx(W,q,parseInt(K,10)-1),q=DEXTTOP.DEXT5.util.xml.getNode(q,"SetSource").textContent||DEXTTOP.DEXT5.util.xml.getNode(q,"SetSource").text,q=DEXTTOP.DEXT5.util.replaceAll(q,"\r\n",""),q=DEXTTOP.DEXT5.util.replaceAll(q,"\r",""),q=DEXTTOP.DEXT5.util.replaceAll(q,
"\n",""),q=DEXTTOP.DEXT5.util.replaceAll(q,"\t",""),q=q.replace(/^\s+/,"").replace(/\s+$/,""),u=_iframeDoc.createElement("div"),u.innerHTML=q,q=u.childNodes[0],delete u;V=getFirstRange().range;aa=getMyElementNode(V.startContainer);"p"!=aa.tagName.toLowerCase()||"<br>"!=aa.innerHTML&&"<br/>"!=aa.innerHTML&&"<br />"!=aa.innerHTML&&""!=aa.innerHTML&&"&nbsp;"!=aa.innerHTML||V.selectNode(aa);V.deleteContents();u=q.outerHTML;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){if(_iframeDoc.execCommand("inserthtml",
!1,u),V=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(V)}else pasteHtmlAtCaretHuge(u);d=getFirstRange();if(d.range.startContainer&&(q=GetParentbyTagName(d.range.startContainer,"table"),null==q))try{if(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion){var na=_iframeDoc.getElementById("temp_td_for_caret");na.removeAttribute("id");q=GetParentbyTagName(na,"table")}}catch(Ja){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{V.selectNode(q);
var qa=q.parentNode;"body"!=qa.tagName.toLowerCase()&&V.setEndAfter(qa);V.collapse(!1);DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion||(d=getFirstRange(),d.sel.addRange(V));DEXTTOP.DEXT5.browser.gecko&&doSetCaretPosition(qa,1);repairBodyFirstLastTag(!1);var za=q.rows[0].cells[0];za&&("4"!=c&&createTableCellDefValue(za),0==checkCellBRValue()&&""==za.innerHTML&&(za.innerHTML="<p></p>"),doSetCaretPosition(za.childNodes[0],0))}catch(mb){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("1"==
DEXTTOP.G_CURREDITOR._config.limitTableInoutdent){c=0;na=getClientRect(q);qa=na.right;if(""!=_iframeDoc.body.style.width&&-1<_iframeDoc.body.style.width.indexOf("px"))c=DEXTTOP.DEXT5.util.parseIntOr0(_iframeDoc.body.style.width),qa-=10;else{c=_iframeDoc.documentElement.clientWidth;if(0==c||null==c||void 0==c)c=_iframeDoc.body.clientWidth;c=Math.floor(c);c-=10}0<c&&qa>=c&&(c-=na.right-na.left+10,0>c&&(c=0),q.style.marginLeft=c+"px")}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell");ActiveCurrTable=q;G_Ruler&&"2"==DEXTTOP.G_CURREDITOR._config.ruler.mode&&G_Ruler.SetRulerPosition()}
function command_InsertTableProperty(a,b,c,d,e,f,g,h,m,q,t,u,v,w,y,x,z,B,D,A,C,E,H,M,N,I,S){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();I||(I="px");var F=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");null==H||""==H?removeAttribute(F,"id"):""!=H&&(F.id=H);F.style.wordBreak=F.style.wordBreak;""==E?(removeAttribute(F,"class"),F.style.fontSize=DEXTTOP.G_CURREDITOR._setting.font_size):null!=E&&(F.className=
E,F.style.fontSize="");b=F.style.width;""!=c&&("%"==I&&(F.oWidth=F.clientWidth),F.style.width=c+I);a=F.style.height;""!=d&&"1"==DEXTTOP.G_CURREDITOR._config.tableUseHeight&&(F.style.height=d+"px");"N"==e?F.style.borderCollapse="collapse":"Y"==e&&(F.style.borderCollapse="separate");F.align=""==f||"left"==f&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO?"":f;F.style.marginLeft=0<C?C+"px":"";"N"==e?F.style.border=DEXTTOP.DEXT5.browser.gecko?"1px #000000":"1px none #000000":"Y"==e&&(""!=g.outsideTop.width&&
""!=g.outsideTop.style&&""!=g.outsideTop.color&&(""==g.outsideTop.width&&(F.style.borderTopWidth=g.outsideTop.width),""==g.outsideTop.style&&(F.style.borderTopStyle=g.outsideTop.style),""==g.outsideTop.color&&(F.style.borderTopColor=g.outsideTop.color),showBorderForNoneClass(F,"dext_table_border_t")),""!=g.outsideLeft.width&&""!=g.outsideLeft.style&&""!=g.outsideLeft.color&&(""==g.outsideLeft.width&&(F.style.borderLeftWidth=g.outsideLeft.width),""==g.outsideLeft.style&&(F.style.borderLeftStyle=g.outsideLeft.style),
""==g.outsideLeft.color&&(F.style.borderLeftColor=g.outsideLeft.color),showBorderForNoneClass(F,"dext_table_border_l")),""!=g.outsideRight.width&&""!=g.outsideRight.style&&""!=g.outsideRight.color&&(""==g.outsideRight.width&&(F.style.borderRightWidth=g.outsideRight.width),""==g.outsideRight.style&&(F.style.borderRightStyle=g.outsideRight.style),""==g.outsideRight.color&&(F.style.borderRightColor=g.outsideRight.color),showBorderForNoneClass(F,"dext_table_border_r")),""!=g.outsideBottom.width&&""!=
g.outsideBottom.style&&""!=g.outsideBottom.color&&(""==g.outsideBottom.width&&(F.style.borderBottomWidth=g.outsideBottom.width),""==g.outsideBottom.style&&(F.style.borderBottomStyle=g.outsideBottom.style),""==g.outsideBottom.color&&(F.style.borderBottomColor=g.outsideBottom.color),showBorderForNoneClass(F,"dext_table_border_b")));""!=h&&F.setAttribute("cellSpacing",h);if(""!=m)for(e="","1"==DEXTTOP.G_CURREDITOR._config.insidePaddingTdSetting||S&&"2"==S.cellPaddingMode?(F.removeAttribute("cellPadding"),
e=m+"px"):F.setAttribute("cellPadding",m),f=F.getElementsByTagName("td"),m=0;m<f.length;m++)f[m].style.padding=e;e=!1;f=0;h=F.childNodes.length;for(m=0;m<h;m++)if(F.childNodes[m].nodeName.match(/caption/i)){e=!0;f=m;break}""==q?e&&F.removeChild(F.childNodes[f]):(m=null,e?m=F.childNodes[f]:(e=_iframeDoc.createElement("caption"),e.innerHTML=q,F.appendChild(e)),m.innerHTML=q,S&&!0!==S.captionDisplay?m.style.display="none":DEXTTOP.DEXT5.util.removeStyleAttribute(m,"display"));""!=t?F.setAttribute("summary",
t):F.getAttribute("summary")&&F.removeAttribute("summary");if("Y"==u)F.style.backgroundImage="",F.style.backgroundAttachment="",F.style.backgroundRepeat="",F.style.backgroundPosition="",F.style.backgroundColor="",F.removeAttribute("background");else if("N"==u){if(""!=v){"[FAIL]"==v.substring(0,6)&&(F.setAttribute("alt",v.substring(6,v.length)),v=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg");0==v.indexOf("url")?F.style.backgroundImage=v:F.style.backgroundImage="url("+v+")";F.removeAttribute("background");
F.style.backgroundAttachment=""==w?"":w;F.style.backgroundRepeat=""==y?"":y;if(""!=x||""!=z)F.style.backgroundPosition=parseInt(x,10)+"px "+parseInt(z,10)+"px";if(N&&1<N.length)for(q=N.length,m=1;m<q;m++)t=N[m].split("^"),2==t.length&&F.setAttribute(t[0],t[1])}if(""!=B)for(F.style.backgroundColor=B,N=F.rows,q=F.rows.length,m=0;m<q;m++)for(t=N[m].cells,u=N[m].cells.length,B=0;B<u;B++)""!=t[B].style.backgroundColor&&(t[B].style.backgroundColor="")}B=GetTableSelectionCellsPosition(F,!0);N=B.arrOutSideLeft.length;
q=B.arrOutSideRight.length;t=B.arrOutSideTop.length;u=B.arrOutSideBottom.length;v=B.arrSelected.length;w=[];y=[];x=[];z=[];S="";if(""==g.outsideLeft.style&&""==g.outsideLeft.width&&""==g.outsideLeft.color)for(m=0;m<N;m++)S=B.arrOutSideLeft[m].style.borderLeftWidth+" "+B.arrOutSideLeft[m].style.borderLeftStyle+" "+B.arrOutSideLeft[m].style.borderLeftColor,w.push(S);if(""==g.outsideRight.style&&""==g.outsideRight.width&&""==g.outsideRight.color)for(m=0;m<q;m++)S=B.arrOutSideRight[m].style.borderRightWidth+
" "+B.arrOutSideRight[m].style.borderRightStyle+" "+B.arrOutSideRight[m].style.borderRightColor,y.push(S);if(""==g.outsideTop.style&&""==g.outsideTop.width&&""==g.outsideTop.color)for(m=0;m<t;m++)S=B.arrOutSideTop[m].style.borderTopWidth+" "+B.arrOutSideTop[m].style.borderTopStyle+" "+B.arrOutSideTop[m].style.borderTopColor,x.push(S);if(""==g.outsideBottom.style&&""==g.outsideBottom.width&&""==g.outsideBottom.color)for(m=0;m<u;m++)S=B.arrOutSideBottom[m].style.borderBottomWidth+" "+B.arrOutSideBottom[m].style.borderBottomStyle+
" "+B.arrOutSideBottom[m].style.borderBottomColor,z.push(S);if(""!=g.insideRow.width||""!=g.insideRow.style||""!=g.insideRow.color)for(m=0;m<v;m++)command_ApplyCellBorderProperty("inRow",B.arrSelected[m],g);if(""!=g.insideCol.width||""!=g.insideCol.style||""!=g.insideCol.color)for(m=0;m<v;m++)command_ApplyCellBorderProperty("inCol",B.arrSelected[m],g);if(""==g.outsideLeft.width&&""==g.outsideLeft.style&&""==g.outsideLeft.color)for(m=0;m<N;m++)g.outsideLeft=w[m],command_ApplyCellBorderProperty("left",
B.arrOutSideLeft[m],g);else for(m=0;m<N;m++)command_ApplyCellBorderProperty("left",B.arrOutSideLeft[m],g);if(""==g.outsideRight.width&&""==g.outsideRight.style&&""==g.outsideRight.color)for(m=0;m<q;m++)g.outsideRight=y[m],command_ApplyCellBorderProperty("right",B.arrOutSideRight[m],g);else for(m=0;m<q;m++)command_ApplyCellBorderProperty("right",B.arrOutSideRight[m],g);if(""==g.outsideTop.width&&""==g.outsideTop.style&&""==g.outsideTop.color)for(m=0;m<t;m++)g.outsideTop=x[m],command_ApplyCellBorderProperty("top",
B.arrOutSideTop[m],g);else for(m=0;m<t;m++)command_ApplyCellBorderProperty("top",B.arrOutSideTop[m],g);if(""==g.outsideBottom.width&&""==g.outsideBottom.style&&""==g.outsideBottom.color)for(m=0;m<u;m++)g.outsideBottom=z[m],command_ApplyCellBorderProperty("bottom",B.arrOutSideBottom[m],g);else for(m=0;m<u;m++)command_ApplyCellBorderProperty("bottom",B.arrOutSideBottom[m],g);g=F.rows.length;for(m=N=0;m<g;m++)for(N=F.rows[m].cells.length,B=0;B<N;B++){"2"==A?0==B?(q=_iframeDoc.createElement("th"),setCopyAllObjectAtributes(F.rows[m].cells[B],
q,!0),"Y"==D&&(q.scope="row")):(q=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(F.rows[m].cells[B],q,!0)):"3"==A?0==m?(q=_iframeDoc.createElement("th"),setCopyAllObjectAtributes(F.rows[m].cells[B],q,!0),"Y"==D&&(q.scope="col")):(q=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(F.rows[m].cells[B],q,!0)):"4"==A?0==m||0==B?(q=_iframeDoc.createElement("th"),setCopyAllObjectAtributes(F.rows[m].cells[B],q,!0),"Y"==D&&(0!=m||0!=B?(0==m&&(q.scope="col"),0==B&&(q.scope="row")):q.scope=
"")):(q=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(F.rows[m].cells[B],q,!0)):(q=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(F.rows[m].cells[B],q,!0));"N"==D&&(q.scope="");""!=F.rows[m].cells[B].id&&(q.id=F.rows[m].cells[B].id);"1"!=F.rows[m].cells[B].colSpan&&(q.colSpan=F.rows[m].cells[B].colSpan);"1"!=F.rows[m].cells[B].rowSpan&&(q.rowSpan=F.rows[m].cells[B].rowSpan);""!=F.rows[m].cells[B].style.width&&(q.style.width=F.rows[m].cells[B].style.width);""!=F.rows[m].cells[B].style.height&&
(q.style.height=F.rows[m].cells[B].style.height);""!=F.rows[m].cells[B].style.textAlign&&(q.style.textAlign=F.rows[m].cells[B].style.textAlign);""!=F.rows[m].cells[B].style.verticalAlign&&(removeAttribute(F.rows[m].cells[B],"valign"),q.style.verticalAlign=F.rows[m].cells[B].style.verticalAlign);"nowrap"==F.rows[m].cells[B].style.whiteSpace&&(q.style.whiteSpace="nowrap");""!=F.rows[m].cells[B].style.backgroundImage&&(q.style.backgroundImage=F.rows[m].cells[B].style.backgroundImage);""!=F.rows[m].cells[B].style.backgroundAttachment&&
(q.style.backgroundAttachment=F.rows[m].cells[B].style.backgroundAttachment);""!=F.rows[m].cells[B].style.backgroundRepeat&&(q.style.backgroundRepeat=F.rows[m].cells[B].style.backgroundRepeat);""!=F.rows[m].cells[B].style.backgroundPosition&&(q.style.backgroundPosition=F.rows[m].cells[B].style.backgroundPosition);""!=F.rows[m].cells[B].style.backgroundColor&&(q.style.backgroundColor=F.rows[m].cells[B].style.backgroundColor);t=[];u=[];try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion){t=
F.rows[m].cells[B].getElementsByTagName("a");for(var O=t.length,P=0;P<O;P++)t[P].outerHTML.match(RegExp("(hrefs*=s*(?:\"|')(.*?)(?:\"|'))","gi")),u.push(RegExp.$2)}}catch(J){t=[],u=[]}q.innerHTML=F.rows[m].cells[B].innerHTML;try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion&&(O=t.length,0<O))for(var L=q.getElementsByTagName("a"),K=L.length,P=0;P<K;P++)L[P].href&&0>L[P].href.toLowerCase().indexOf("javascript")&&0>L[P].href.indexOf("'")&&0>L[P].href.indexOf('"')&&""!=u[P]&&L[P].href!=
u[P]&&(L[P].href=u[P],L[P].setAttribute("href",u[P]))}catch(W){q.innerHTML=F.rows[m].cells[B].innerHTML}F.rows[m].cells[B].parentNode.replaceChild(q,F.rows[m].cells[B])}setAdjustTableWidthHeight(F);ClearDraggingTableCellSelected();0<F.rows[0].cells[0].childNodes.length?setTimeout(function(){doSetCaretPosition(F.rows[0].cells[0].childNodes[0],0)},0):setTimeout(function(){doSetCaretPosition(F.rows[0].cells[0],0)},0);""!=b&&(D=parseInt(b,10),A=b.replace(D,""),D==parseInt(c,10)&&A==I||command_AdjustTableAndCellWidth(DEXTTOP.G_CURREDITOR,
{tables:[F]}));-1<a.indexOf("px")&&(a=parseInt(a,10),a!=parseInt(d,10)&&command_AdjustTableAndCellHeight(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,{type:"forceAdjust",targetTable:F,beforeHeight:a}));if("1"==DEXTTOP.G_CURREDITOR._config.limitTableInoutdent){c=0;d=getClientRect(F);I=d.right;if(""!=_iframeDoc.body.style.width&&-1<_iframeDoc.body.style.width.indexOf("px"))c=DEXTTOP.DEXT5.util.parseIntOr0(_iframeDoc.body.style.width),I-=10;else{c=_iframeDoc.documentElement.clientWidth;if(0==c||null==
c||void 0==c)c=_iframeDoc.body.clientWidth;c=Math.floor(c);c-=10}0<c&&I>=c&&(c-=d.right-d.left+10,0>c&&(c=0),F.style.marginLeft=c+"px")}"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal&&findDiagonal(null,!1,DEXTTOP.G_CURREDITOR)&&(G_DEXT_Diagonal.setResizeForDiagonal(),G_DEXT_Diagonal.util.replaceEmptySpaceInDiagonal());DEXTTOP.G_CURREDITOR._iconEnable("focusInCell");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertCellProperty(a,b,c,d,e,f,g,h,m,q,t,u,v,w,y,x,z,B,D,A){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();b=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");var C="";"collapse"==b.style.borderCollapse&&"1"==DEXTTOP.G_CURREDITOR._config.tableNearCellBorderStyle?C="N":"separate"==b.style.borderCollapse&&(C="Y");var E=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);a=GetTableSelectionCellsPosition(E,
!1);ClearDraggingTableCellSelected();var H=a.arrOutSideLeft.length,M=a.arrOutSideRight.length,N=a.arrOutSideTop.length,I=a.arrOutSideBottom.length,S=a.arrSelected.length,F=[],O=[],P=[],J=[],L=[],K=[],W="";if(""==h.outsideLeft.style&&""==h.outsideLeft.width&&""==h.outsideLeft.color)for(var G=0;G<H;G++)W=a.arrOutSideLeft[G].style.borderLeftWidth+" "+a.arrOutSideLeft[G].style.borderLeftStyle+" "+a.arrOutSideLeft[G].style.borderLeftColor,F.push(W);if(""==h.outsideRight.style&&""==h.outsideRight.width&&
""==h.outsideRight.color)for(G=0;G<M;G++)W=a.arrOutSideRight[G].style.borderRightWidth+" "+a.arrOutSideRight[G].style.borderRightStyle+" "+a.arrOutSideRight[G].style.borderRightColor,O.push(W);if(""==h.outsideTop.style&&""==h.outsideTop.width&&""==h.outsideTop.color)for(G=0;G<N;G++)W=a.arrOutSideTop[G].style.borderTopWidth+" "+a.arrOutSideTop[G].style.borderTopStyle+" "+a.arrOutSideTop[G].style.borderTopColor,P.push(W);if(""==h.outsideBottom.style&&""==h.outsideBottom.width&&""==h.outsideBottom.color)for(G=
0;G<I;G++)W=a.arrOutSideBottom[G].style.borderBottomWidth+" "+a.arrOutSideBottom[G].style.borderBottomStyle+" "+a.arrOutSideBottom[G].style.borderBottomColor,J.push(W);DEXTTOP.DEXT5.browser.ie||"1"!=DEXTTOP.G_CURREDITOR._config.diagonal.use||(G=findDiagonal(E,!0),""==h.diagonalUp&&1>=S&&G&&0<G.diagonalUp.length&&(W=G.diagonalUp[0].style.borderTop,L.push(W)),""==h.diagonalDown&&1>=S&&G&&0<G.diagonalDown.length&&(W=G.diagonalDown[0].style.borderTop,K.push(W)));if(""!=h.insideRow.width||""!=h.insideRow.style||
""!=h.insideRow.color)for(G=0;G<S;G++)command_ApplyCellBorderProperty("inRow",a.arrSelected[G],h);else for(G=0;G<S;G++)command_ApplyCellBorderProperty("inRow",a.arrSelected[G],null);if(""!=h.insideCol.width||""!=h.insideCol.style||""!=h.insideCol.color)for(G=0;G<S;G++)command_ApplyCellBorderProperty("inCol",a.arrSelected[G],h);else for(G=0;G<S;G++)command_ApplyCellBorderProperty("inCol",a.arrSelected[G],null);L=function(a){if(""!==a){a=a.split(" ")[0];switch(a){case "thin":_width=1;break;case "medium":_width=
3;break;case "thick":_width=5;break;default:_width=DEXTTOP.DEXT5.util.parseIntOr0(a)}return 1>=_width?!0:!1}return!1};if(""==h.outsideLeft.width&&""==h.outsideLeft.style&&""==h.outsideLeft.color)for(G=0;G<H;G++)h.outsideLeft=F[G],command_ApplyCellBorderProperty("left",a.arrOutSideLeft[G],h);else for(K=L(h.outsideLeft.width),G=0;G<H;G++){if("N"==C||K)F=getCellNearLeftTop(a.arrOutSideLeft[G]),command_ApplyEdgeReduce(F.arrLeft,h,"left");command_ApplyCellBorderProperty("left",a.arrOutSideLeft[G],h)}if(""==
h.outsideRight.width&&""==h.outsideRight.style&&""==h.outsideRight.color)for(G=0;G<M;G++)h.outsideRight=O[G],command_ApplyCellBorderProperty("right",a.arrOutSideRight[G],h);else for(K=L(h.outsideRight.width),G=0;G<M;G++){if("N"==C||K)F=getCellNearLeftTop(a.arrOutSideRight[G]),command_ApplyEdgeReduce(F.arrRight,h,"right");command_ApplyCellBorderProperty("right",a.arrOutSideRight[G],h)}if(""==h.outsideTop.width&&""==h.outsideTop.style&&""==h.outsideTop.color)for(G=0;G<N;G++)h.outsideTop=P[G],command_ApplyCellBorderProperty("top",
a.arrOutSideTop[G],h);else for(K=L(h.outsideTop.width),G=0;G<N;G++){if("N"==C||K)F=getCellNearLeftTop(a.arrOutSideTop[G]),command_ApplyEdgeReduce(F.arrTop,h,"top");command_ApplyCellBorderProperty("top",a.arrOutSideTop[G],h)}if(""==h.outsideBottom.width&&""==h.outsideBottom.style&&""==h.outsideBottom.color)for(G=0;G<I;G++)h.outsideBottom=J[G],command_ApplyCellBorderProperty("bottom",a.arrOutSideBottom[G],h);else for(K=L(h.outsideBottom.width),G=0;G<I;G++){if("N"==C||K)F=getCellNearLeftTop(a.arrOutSideBottom[G]),
command_ApplyEdgeReduce(F.arrBottom,h,"bottom");command_ApplyCellBorderProperty("bottom",a.arrOutSideBottom[G],h)}if(0<S)for(G=0;G<S;G++)command_ApplyCellProperty(a.arrSelected[G],c,d,f,g,m,q,t,u,v,w,y,x,z,B,e);else command_ApplyCellProperty(DEXTTOP.G_SELECTED_ELEMENT,c,d,f,g,m,q,t,u,v,w,y,x,z,B,e);if(""!=D||""!=A){var Q=[];0<a.arrSelected.length?Q=a.arrSelected:Q.push(DEXTTOP.G_SELECTED_ELEMENT);var X=Q.length;e=[];for(G=0;G<X;G++)d=Q[G],""!=D&&(D=DEXTTOP.DEXT5.util.parseIntOr0(D),c=getClientRect(d),
c=DEXTTOP.DEXT5.util.parseIntOr0(c.right-c.left),e.push(c)),""!=A&&(d.style.height=A+"px");if(""!=D){for(G=0;G<X;G++)d=Q[G],d.style.width=D+"px";D=[0];for(G=1;G<X;G++){A=D.length;e=!1;d=Q[G];c=getClientRect(d);for(d=0;d<A;d++)if(f=getClientRect(Q[D[d]]),c.left>=f.left&&c.right<=f.right){e=!0;break}0==e&&D.push(G)}A=D=G=!1;c=getClientRect(a.arrOutSideTop[0]);d=getClientRect(a.arrOutSideBottom[0]);e=getClientRect(b);1>=Math.abs(c.top-e.top)&&(D=!0);1>=Math.abs(d.bottom-e.bottom)&&(A=!0);D&&A&&(G=!0);
if(G){for(G=A=D=0;G<a.virtualSelectionsCellTable.length;G++)c=a.virtualSelectionsCellTable[G].length,c>A&&(A=c,D=G);D=a.virtualSelectionsCellTable[D][0].parentNode.cells;A=D.length;for(G=d=0;G<A;G++)c=0,""!=D[G].style.width&&D[G].style.width.indexOf("px")?c=DEXTTOP.DEXT5.util.parseIntOr0(D[G].style.width):(c=getClientRect(D[G]),c=c.right-c.left),d+=c;b.style.width=d+1+"px";G_Ruler&&"2"==DEXTTOP.G_CURREDITOR._config.ruler.mode&&G_Ruler.SetRulerPosition()}}}if(h.diagonalUp&&0<h.diagonalUp.length){if("noApply"!=
h.diagonalUp)for(Q||(Q=[],0<a.arrSelected.length?Q=a.arrSelected:Q.push(DEXTTOP.G_SELECTED_ELEMENT),X=Q.length),G=0;G<X;G++)b=h.diagonalUp.split(" "),D=Q[G].getElementsByTagName("dext_diagonal_up"),0==D.length?(0!=DEXTTOP.DEXT5.util.parseFloatOr0(b[0])&&"none"!=b[1]||"thin"==b[0]||"medium"==b[0]||"thick"==b[0])&&G_DEXT_Diagonal.makeDiagonal(Q[G],"up",h.diagonalUp):0!=DEXTTOP.DEXT5.util.parseFloatOr0(b[0])&&"none"!=b[1]||"thin"==b[0]||"medium"==b[0]||"thick"==b[0]?G_DEXT_Diagonal.makeDiagonal(Q[G],
"up",h.diagonalUp):deleteDiagonalLine(Q[G],"up",DEXTTOP.G_CURREDITOR,null)}else if(Q)for(G=0;G<Q.length;G++)deleteDiagonalLine(Q[G],"up",DEXTTOP.G_CURREDITOR,null);else for(Q=[],0<a.arrSelected.length?Q=a.arrSelected:Q.push(DEXTTOP.G_SELECTED_ELEMENT),X=Q.length,G=0;G<X;G++)deleteDiagonalLine(Q[G],"up",DEXTTOP.G_CURREDITOR,null);if(h.diagonalDown&&0<h.diagonalDown.length){if("noApply"!=h.diagonalDown)for(Q||(Q=[],0<a.arrSelected.length?Q=a.arrSelected:Q.push(DEXTTOP.G_SELECTED_ELEMENT),X=Q.length),
G=0;G<X;G++)b=h.diagonalDown.split(" "),a=Q[G].getElementsByTagName("dext_diagonal_down"),0==a.length?(0!=DEXTTOP.DEXT5.util.parseFloatOr0(b[0])&&"none"!=b[1]||"thin"==b[0]||"medium"==b[0]||"thick"==b[0])&&G_DEXT_Diagonal.makeDiagonal(Q[G],"down",h.diagonalDown):0!=DEXTTOP.DEXT5.util.parseFloatOr0(b[0])&&"none"!=b[1]||"thin"==b[0]||"medium"==b[0]||"thick"==b[0]?G_DEXT_Diagonal.makeDiagonal(Q[G],"down",h.diagonalDown):deleteDiagonalLine(Q[G],"down",DEXTTOP.G_CURREDITOR,null)}else if(Q)for(G=0;G<Q.length;G++)deleteDiagonalLine(Q[G],
"down",DEXTTOP.G_CURREDITOR,null);else for(Q=[],0<a.arrSelected.length?Q=a.arrSelected:Q.push(DEXTTOP.G_SELECTED_ELEMENT),X=Q.length,G=0;G<X;G++)deleteDiagonalLine(Q[G],"down",DEXTTOP.G_CURREDITOR,null);0<DEXTTOP.G_SELECTED_ELEMENT.childNodes.length?doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT.childNodes[0],0):doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT,0);DEXTTOP.G_CURREDITOR._iconEnable("focusInCell");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_ApplyTitleCell(a,b){var c=a.tagName.toLowerCase(),d="",e;"Y"==b?(d="th",e=_iframeDoc.createElement("th")):"N"==b?(d="td",e=_iframeDoc.createElement("td")):(e=_iframeDoc.createElement(a.tagName.toLowerCase()),d=a.tagName.toLowerCase());c!=d&&(setCopyAllObjectAtributes(a,e,!0),e.innerHTML=a.innerHTML,e.style.width=a.style.width,e.style.height=a.style.height,1<a.colSpan&&(e.colSpan=a.colSpan),1<a.rowSpan&&(e.rowSpan=a.rowSpan));c!=d&&a.parentNode.replaceChild(e,a)}
function command_ApplyCellProperty(a,b,c,d,e,f,g,h,m,q,t,u,v,w,y,x){""==v?removeAttribute(a,"class"):null!=v&&(a.className=v);""==w?removeAttribute(a,"id"):null!=w&&(a.id=w);""==b?a.style.textAlign="":null!=b&&(a.style.textAlign=b);""==c?a.style.verticalAlign="":null!=c&&(removeAttribute(a,"valign"),a.style.verticalAlign=c);null!=d&&(""==d?a.removeAttribute("scope"):a.scope=d);if(null!=e)if("break-all"==e){if("nowrap"==a.style.whiteSpace||"pre"==a.style.whiteSpace)a.style.whiteSpace="";a.style.wordBreak=
"break-all"}else if("keep-all"==e){if("nowrap"==a.style.whiteSpace||"pre"==a.style.whiteSpace)a.style.whiteSpace="";a.style.wordBreak="keep-all"}else if("nowrap"!=a.style.whiteSpace||"pre"!=a.style.whiteSpace)a.style.whiteSpace="nowrap";if("Y"==f)a.style.backgroundImage="",a.style.backgroundAttachment="",a.style.backgroundRepeat="",a.style.backgroundPosition="",a.style.backgroundColor="",a.removeAttribute("cellOrgBgColor"),a.removeAttribute("background");else if("N"==f){""!=g&&("[FAIL]"==g.substring(0,
6)&&(a.setAttribute("alt",g.substring(6,g.length)),g=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),0==g.indexOf("url")?a.style.backgroundImage=g:a.style.backgroundImage="url("+g+")",a.removeAttribute("background"));if(y&&1<y.length)for(b=y.length,c=1;c<b;c++)d=y[c].split("^"),2==d.length&&a.setAttribute(d[0],d[1]);""==h?DEXTTOP.DEXT5.util.removeStyleAttribute(a,"backgroundAttachment"):null!=h&&(a.style.backgroundAttachment=h);""==m?DEXTTOP.DEXT5.util.removeStyleAttribute(a,"backgroundRepeat"):
null!=m&&(a.style.backgroundRepeat=m);h=a.style.backgroundPosition;m=["0px","0px"];""!=h&&(m=h.split(" "));if(""!=q&&""!=t)a.style.backgroundPosition=parseInt(q,10)+"px "+parseInt(t,10)+"px";else if(""!=q||""!=t)""!=q&&""==t?a.style.backgroundPosition=parseInt(q,10)+"px "+m[1]:""==q&&""!=t&&(a.style.backgroundPosition=m[0]+" "+parseInt(t,10)+"px");""!=u&&(a.style.backgroundColor=u)}null!=x&&(q=a.tagName.toLowerCase(),t="","Y"==x?(t="th",x=_iframeDoc.createElement("th")):"N"==x?(t="td",x=_iframeDoc.createElement("td")):
(x=_iframeDoc.createElement(a.tagName.toLowerCase()),t=a.tagName.toLowerCase()),q!=t&&(setCopyAllObjectAtributes(a,x,!0),x.innerHTML=a.innerHTML,x.style.width=a.style.width,x.style.height=a.style.height,1<a.colSpan&&(x.colSpan=a.colSpan),1<a.rowSpan&&(x.rowSpan=a.rowSpan)),q!=t&&a.parentNode.replaceChild(x,a))}
function command_ApplyCellBorderProperty(a,b,c){if(c){var d=RegExp("^\\s\\s*$","g"),e=!1,f=!1,g=!1,h=!1,m=GetTableSelectionCellsEx(b,!0);if("inCol"==a||"inRow"==a){var q=m[1],t=m[2];if(m[0][0].isOneCell)0==m[0][0].row&&(e=!0),1==q-m[0][0].row&&(f=!0),0==m[0][0].col&&(g=!0),1==t-m[0][0].col&&(h=!0);else for(var u=0;u<m.length;u++)for(var v=0;v<m[u].length;v++)e||0!=m[u][v].row||(e=!0),f||q-m[u][v].rowSpan!=m[u][v].row||(f=!0),g||0!=m[u][v].col||(g=!0),h||t-m[u][v].colSpan!=m[u][v].col||(h=!0)}"top"==
a?"string"==typeof c.outsideTop?c.outsideTop.match(d)||""==c.outsideTop||(b.style.borderTop=c.outsideTop):c.outsideTop.width.match(d)||c.outsideTop.style.match(d)||c.outsideTop.color.match(d)?""!=b.style.borderTop&&(b.style.borderTop="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_t")):(""!=c.outsideTop.width&&(b.style.borderTopWidth=c.outsideTop.width),""!=c.outsideTop.style&&(b.style.borderTopStyle=c.outsideTop.style),""!=c.outsideTop.color&&(b.style.borderTopColor=c.outsideTop.color),
showBorderForNoneClass(b,"dext_table_border_t")):"bottom"==a?"string"==typeof c.outsideBottom?c.outsideBottom.match(d)||""==c.outsideBottom||(b.style.borderBottom=c.outsideBottom):c.outsideBottom.width.match(d)||c.outsideBottom.style.match(d)||c.outsideBottom.color.match(d)?""!=b.style.borderBottom&&(b.style.borderBottom="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_b")):(""!=c.outsideBottom.width&&(b.style.borderBottomWidth=c.outsideBottom.width),""!=c.outsideBottom.style&&
(b.style.borderBottomStyle=c.outsideBottom.style),""!=c.outsideBottom.color&&(b.style.borderBottomColor=c.outsideBottom.color),showBorderForNoneClass(b,"dext_table_border_b")):"left"==a?"string"==typeof c.outsideLeft?c.outsideLeft.match(d)||""==c.outsideLeft||(b.style.borderLeft=c.outsideLeft):c.outsideLeft.width.match(d)||c.outsideLeft.style.match(d)||c.outsideLeft.color.match(d)?""!=b.style.borderLeft&&(b.style.borderLeft="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_l")):
(""!=c.outsideLeft.width&&(b.style.borderLeftWidth=c.outsideLeft.width),""!=c.outsideLeft.style&&(b.style.borderLeftStyle=c.outsideLeft.style),""!=c.outsideLeft.color&&(b.style.borderLeftColor=c.outsideLeft.color),showBorderForNoneClass(b,"dext_table_border_l")):"right"==a?"string"==typeof c.outsideRight?c.outsideRight.match(d)||""==c.outsideRight||(b.style.borderRight=c.outsideRight):c.outsideRight.width.match(d)||c.outsideRight.style.match(d)||c.outsideRight.color.match(d)?""!=b.style.borderRight&&
(b.style.borderRight="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_r")):(""!=c.outsideRight.width&&(b.style.borderRightWidth=c.outsideRight.width),""!=c.outsideRight.style&&(b.style.borderRightStyle=c.outsideRight.style),""!=c.outsideRight.color&&(b.style.borderRightColor=c.outsideRight.color),showBorderForNoneClass(b,"dext_table_border_r")):"inRow"==a?"string"==typeof c.insideRow?c.insideRow.match(d)||""==c.insideRow||(b.style.borderTop=c.insideRow,b.style.borderBottom=c.insideRow):
c.insideRow.width.match(d)||c.insideRow.style.match(d)||c.insideRow.color.match(d)?(""!=b.style.borderTop&&(b.style.borderTop="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_t")),""!=b.style.borderBottom&&(b.style.borderBottom="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_b"))):(""!=c.insideRow.width&&(e||(b.style.borderTopWidth=c.insideRow.width),f||(b.style.borderBottomWidth=c.insideRow.width)),""!=c.insideRow.style&&(e||(b.style.borderTopStyle=c.insideRow.style),
f||(b.style.borderBottomStyle=c.insideRow.style)),""!=c.insideRow.color&&(e||(b.style.borderTopColor=c.insideRow.color),f||(b.style.borderBottomColor=c.insideRow.color)),e||showBorderForNoneClass(b,"dext_table_border_t"),f||showBorderForNoneClass(b,"dext_table_border_b")):"inCol"==a&&("string"==typeof c.insideCol?c.insideCol.match(d)||""==c.insideCol||(b.style.borderLeft=c.insideCol,b.style.borderRight=c.insideCol):c.insideCol.width.match(d)||c.insideCol.style.match(d)||c.insideCol.color.match(d)?
(""!=b.style.borderLeft&&(b.style.borderLeft="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_l")),""!=b.style.borderRight&&(b.style.borderRight="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_r"))):(""!=c.insideCol.width&&(g||(b.style.borderLeftWidth=c.insideCol.width),h||(b.style.borderRightWidth=c.insideCol.width)),""!=c.insideCol.style&&(g||(b.style.borderLeftStyle=c.insideCol.style),h||(b.style.borderRightStyle=c.insideCol.style)),""!=c.insideCol.color&&
(g||(b.style.borderLeftColor=c.insideCol.color),h||(b.style.borderRightColor=c.insideCol.color)),g||showBorderForNoneClass(b,"dext_table_border_l"),h||showBorderForNoneClass(b,"dext_table_border_r")))}}
function command_ApplyEdgeReduce(a,b,c){if(a){var d=a.length;if("top"==c)for(var e=0;e<d;e++)a[e].style.borderBottomWidth=b.outsideTop.width,a[e].style.borderBottomStyle=b.outsideTop.style,a[e].style.borderBottomColor=b.outsideTop.color;if("left"==c)for(e=0;e<d;e++)a[e].style.borderRightWidth=b.outsideLeft.width,a[e].style.borderRightStyle=b.outsideLeft.style,a[e].style.borderRightColor=b.outsideLeft.color;if("right"==c)for(e=0;e<d;e++)a[e].style.borderLeftWidth=b.outsideRight.width,a[e].style.borderLeftStyle=
b.outsideRight.style,a[e].style.borderLeftColor=b.outsideRight.color;if("bottom"==c)for(e=0;e<d;e++)a[e].style.borderTopWidth=b.outsideBottom.width,a[e].style.borderTopStyle=b.outsideBottom.style,a[e].style.borderTopColor=b.outsideBottom.color}}
function command_InsertRowColumn(a,b,c,d,e){dext_src_init(b);restoreSelection();setFocusToBody();"R"==c&&"U"==d?command_insertRowUp(a,_dext_editor,e):"R"==c&&"D"==d?command_insertRowDown(a,_dext_editor,e):"C"==c&&"R"==d?command_insertCellRight(a,_dext_editor,e):"C"==c&&"L"==d&&command_insertCellLeft(a,_dext_editor,e)}
function command_RowProperty(a,b,c,d,e,f,g){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();b=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);setTableRowSelect(b);a=getCellNearLeftTop(b);for(var h=a.arrSelected.length,m=0;m<h;m++)""!=d&&(a.arrSelected[m].style.height=d+"px"),a.arrSelected[m].style.textAlign=""==f?"":f,a.arrSelected[m].style.verticalAlign=""==g?"":g,""!=c&&a.arrSelected[m].setAttribute("cellOrgBgColor",
c);c=b.parentNode.rowIndex;d=b.cellIndex;m=function(a){var b="";return b=a.parentNode.parentNode.tagName.toLowerCase()};if(e){if("tbody"==m(b)){e=ActiveCurrTable.getElementsByTagName("thead")[0];f=ActiveCurrTable.getElementsByTagName("tbody")[0];0==!!e&&(e=_iframeDoc.createElement("thead"),ActiveCurrTable.insertBefore(e,f));h=[];g=[];var q=b.parentNode,m=q.rowIndex;1<b.rowSpan&&(m+=b.rowSpan-1,q=ActiveCurrTable.rows[m]);for(;"TBODY"==q.parentNode.tagName&&(b=q,q=b.cloneNode(!1),q.innerHTML=b.innerHTML.replace(/<td/g,
"<th").replace(/<\/td/g,"</th"),h.push(q),m--,q=ActiveCurrTable.rows[m],g.push(b),0!=!!q););for(m=h.length-1;0<=m;m--)e.appendChild(h[m]);m=0;for(b=g.length;m<b;m++)g[m].parentNode.removeChild(g[m]);0==f.getElementsByTagName("tr").length&&f.parentNode.removeChild(f)}}else if("thead"==m(b)){e=ActiveCurrTable.getElementsByTagName("thead")[0];f=ActiveCurrTable.getElementsByTagName("tbody")[0];0==!!f&&(f=_iframeDoc.createElement("tbody"),ActiveCurrTable.appendChild(f));h=[];g=[];q=b.parentNode;for(m=
q.rowIndex;"THEAD"==q.parentNode.tagName&&(b=q,q=b.cloneNode(!1),q.innerHTML=b.innerHTML.replace(/<th/g,"<td").replace(/<\/th/g,"</td"),h.push(q),m++,q=ActiveCurrTable.rows[m],g.push(b),0!=!!q););for(m=h.length-1;0<=m;m--)b=f.getElementsByTagName("tr"),0==b.length?f.appendChild(h[m]):f.insertBefore(h[m],b[0]);m=0;for(b=g.length;m<b;m++)g[m].parentNode.removeChild(g[m]);0==e.getElementsByTagName("tr").length&&e.parentNode.removeChild(e)}"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal&&
findDiagonal(null,!1,DEXTTOP.G_CURREDITOR)&&(G_DEXT_Diagonal.setResizeForDiagonal(),G_DEXT_Diagonal.util.replaceEmptySpaceInDiagonal());setFocusChildForStyle(ActiveCurrTable.rows[c].cells[d]);ActiveCurrTable.setAttribute("DEXT5CellSelected","DEXT5CellSelected");ClearDraggingTableCellSelected();a&&0<a.arrSelected.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_ColumnProperty(a,b,c,d,e,f,g){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);setTableColumnSelect(a);a=getCellNearLeftTop(a);b=a.arrSelected.length;for(g=0;g<b;g++)""!=d&&(a.arrSelected[g].style.width=d+"px"),a.arrSelected[g].style.textAlign=""==e?"":e,a.arrSelected[g].style.verticalAlign=""==f?"":f,""!=c&&a.arrSelected[g].setAttribute("cellOrgBgColor",
c);ActiveCurrTable.setAttribute("DEXT5CellSelected","DEXT5CellSelected");ClearDraggingTableCellSelected();a&&a.arrSelected.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_InsertCellBorder(a,b,c,d,e,f){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");var g="";"collapse"==a.style.borderCollapse?g="N":"separate"==a.style.borderCollapse&&(g="Y");a=!1;b=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);b=getCellNearLeftTop(b);for(var h=b.arrSelected.length,m=0;m<h;m++)a=b.arrSelected[m],""!=c&&(a.style.borderTop=c),
""!=d&&(a.style.borderLeft=d),""!=e&&(a.style.borderRight=e),""!=f&&(a.style.borderBottom=f),a=!0;if("N"==g){if(""!=c)for(g=b.arrTop.length,m=0;m<g;m++)b.arrTop[m].style.borderBottom=c,a=!0;if(""!=d)for(c=b.arrLeft.length,m=0;m<c;m++)b.arrLeft[m].style.borderRight=d,a=!0;if(""!=e)for(d=b.arrRight.length,m=0;m<d;m++)b.arrRight[m].style.borderLeft=e,a=!0;if(""!=f)for(e=b.arrBottom.length,m=0;m<e;m++)b.arrBottom[m].style.borderTop=f,a=!0}a&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0)}
function command_cellBGColor(a,b,c){dext_src_init(b);a=document.getElementById("dext_em_"+DEXTTOP.G_CURREDITOR.ID+"cell_bg_color_show");c?a.style.backgroundColor=c:c=a.style.backgroundColor;restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d;try{if(DEXTTOP.G_SELECTED_ELEMENT)d=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);else{var e=getFirstRange().range;a=null;e&&e.startContainer&&(a=getMyElementNode(e.startContainer));d=GetTDTHCell(a)}var f=
getCellNearLeftTop(d),g=f.arrSelected.length;for(d=0;d<g;d++){var h=f.arrSelected[d];h.style.backgroundColor=c;h.removeAttribute("dext_select")}f&&0<f.arrSelected.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0);DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_InsertDogBGImg(a,b,c,d,e,f,g,h){dext_src_init(b);DEXTTOP.DEXT5.browser.ie&&DEXTTOP.G_CURREDITOR.notFocusToEditor||(restoreSelection(),setFocusToBody());0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if("Y"==c)_iframeDoc.body.style.backgroundImage="",_iframeDoc.body.style.backgroundAttachment="",_iframeDoc.body.style.backgroundRepeat="",_iframeDoc.body.style.backgroundColor="",_iframeDoc.body.removeAttribute("background"),DEXTTOP.G_CURREDITOR._PageProp.bodyimage=
"",DEXTTOP.G_CURREDITOR._PageProp.bodycolor="",DEXTTOP.G_CURREDITOR._PageProp.bodyattachment="",DEXTTOP.G_CURREDITOR._PageProp.bodyrepeat="",showRuler(DEXTTOP.G_CURREDITOR);else if("N"==c&&("1"!=DEXTTOP.G_CURREDITOR._config.horizontalLine.use&&("[FAIL]"==d.substring(0,6)&&(_iframeDoc.body.setAttribute("alt",d.substring(6,d.length)),d=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),_iframeDoc.body.style.backgroundImage="url("+d+")",_iframeDoc.body.removeAttribute("background"),
_iframeDoc.body.style.backgroundAttachment=e,_iframeDoc.body.style.backgroundRepeat=f,""!=g&&(_iframeDoc.body.style.backgroundColor=g)),DEXTTOP.G_CURREDITOR._PageProp.bodyimage="url("+d+")",""!=g&&(DEXTTOP.G_CURREDITOR._PageProp.bodycolor=g),DEXTTOP.G_CURREDITOR._PageProp.bodyattachment=e,DEXTTOP.G_CURREDITOR._PageProp.bodyrepeat=f,h&&1<h.length))for(a=h.length,b=1;b<a;b++)c=h[b].split("^"),2==c.length&&_iframeDoc.body.setAttribute(c[0],c[1]);DEXTTOP.G_CURREDITOR._PageProp.bshowgrid&&1==DEXTTOP.G_CURREDITOR._PageProp.bshowgrid?
changeBodyImageProperty(!1):"1"!=DEXTTOP.G_CURREDITOR._config.horizontalLine.use&&(changeBodyImageProperty(!0),G_BodyFit.noncreationAreaBackgroundStatus&&setBodyFitStyle(DEXTTOP.G_CURREDITOR,!0));DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertImage(a,b,c,d,e,f,g,h){dext_src_init(b);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();c=getFirstRange().range;try{1==c.collapsed&&setRestoreCaretPos(!1)}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}c=_iframeDoc.createElement("img");void 0==h.widthUnit&&(h.widthUnit="px");void 0==h.heightUnit&&(h.heightUnit="px");"0"!=DEXTTOP.G_CURREDITOR._config.allowImgSize&&(""!=h.width&&(c.style.width=h.width+h.widthUnit),""!=h.height&&
(c.style.height=h.height+h.heightUnit));"[FAIL]"==h.srcURL.substring(0,6)?(c.setAttribute("src",DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),c.setAttribute("alt",h.srcURL.substring(6,h.srcURL.length).replace(/"/g,"'"))):c.setAttribute("src",h.srcURL);0==h.input_url_checked&&"[FAIL]"!=h.srcURL.substring(0,6)&&insertImageSrc(DEXTTOP.G_CURREDITOR,h.srcURL);"undefined"!=typeof h.title&&""!==h.title&&c.setAttribute("title",h.title);"[FAIL]"!=h.srcURL.substring(0,6)&&c.setAttribute("alt",
h.alt);"undefined"!=typeof h.id&&""!=h.id&&c.setAttribute("id",h.id);"undefined"!=typeof h.className&&""!=h.className&&c.setAttribute("class",h.className);""!=h.margin_top.toString()&&(c.style.marginTop=h.margin_top+"px");""!=h.margin_right.toString()&&(c.style.marginRight=h.margin_right+"px");""!=h.margin_bottom.toString()&&(c.style.marginBottom=h.margin_bottom+"px");""!=h.margin_left.toString()&&(c.style.marginLeft=h.margin_left+"px");""!=h.align&&c.setAttribute("align",h.align);""==h.border?c.setAttribute("border",
"0"):c.setAttribute("border",h.border);""==h.border?c.style.border="0px solid":c.style.border=h.border+"px solid";c=setImageBorder(c,{borderStyle:h.borderStyle,borderWidth:h.borderThickness,borderColor:h.borderColor,borderKind:h.borderKind});if((d=h.img_attr_info_arr)&&1<d.length)for(f=d.length,e=1;e<f;e++)g=d[e].split("^"),2==g.length&&c.setAttribute(g[0],g[1]);d=getFirstRange().range;d.collapse(!0);if(h.figure){e=_iframeDoc.createElement("figure");f=_iframeDoc.createElement("figcaption");e.setAttribute("contenteditable",
"false");e.setAttribute("style",DEXTTOP.G_CURREDITOR._config.figure.figurestyle);f.setAttribute("style",DEXTTOP.G_CURREDITOR._config.figure.figcaptionstyle);f.setAttribute("contenteditable","true");f.setAttribute("dext_default_caption","true");e.appendChild(c);e.appendChild(f);e=e.outerHTML;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){if(_iframeDoc.execCommand("inserthtml",!1,e),d=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(d)}else pasteHtmlAtCaretHuge(e);
f=_iframeDoc.getElementsByTagName("figcaption");g=f.length;for(e=0;e<g;e++)if("true"==f[e].getAttribute("dext_default_caption")){f[e].removeAttribute("dext_default_caption");g=_iframeDoc.createElement("p");g.innerHTML=DEXTTOP.G_CURREDITOR._config.figure.defaultcaption;f[e].appendChild(g);break}}else d.insertNode(c);try{if(void 0==c.nextSibling||null==c.nextSibling){var q=d.getDocument().createTextNode(" ");c.parentNode.appendChild(q)}}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}d.selectNode(c);
d.collapse(!1);q=!1;DEXTTOP.DEXT5.browser.safari&&h.continueInsert&&(q=!0,e=_iframeDoc.createElement("br"),d.insertNode(e),d.selectNode(e),d.collapse(!1));h.imageSpacing&&(e=_iframeDoc.createElement("br"),d.insertNode(e),d.selectNode(e),d.collapse(!1),0==q&&(e=_iframeDoc.createElement("br"),d.insertNode(e),d.selectNode(e),d.collapse(!1)));rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(d);adjustSizeInContainer({nodes:c});""!=h.linkurl&&(c.parentNode.removeChild(c),
command_InsertHyperLink(a,b,{type:"hyperlink",text:c.outerHTML,url:h.linkurl,target:h.linktarget,title:h.linktitle}));DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper(c)}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_InsertMedia(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange();0==a.range.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);range.pasteHtml(c);a.sel.collapseToEnd();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertReplacedImg(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0==getFirstRange().range.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=makeImageElementForObject(c);b=getFirstRange().range;b.deleteContents();b.insertNode(a);b.selectNode(b.endContainer);b.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b);rangy.getSelection(_iframeWin).collapseToEnd();
"0"==DEXTTOP.G_CURREDITOR._config.useReplaceImage&&(DEXTTOP.G_CURREDITOR._dextCustomDataMode=!1,ReplaceImageToRealObject(!1,!0));DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertLinkMedia(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange();b=a.range;0==b.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);b.pasteHtml(c);a.sel.collapseToEnd();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_ModifyReplacedImg(a,b,c,d){dext_src_init(b);restoreSelection();setFocusToBody();a=d.getAttribute("dext5customdata");if(null!=a&&void 0!=a)if(a=getDextCustomData(a),"iframe"==c.type||"iframe"==c.type2)a.type=c.type,a.type2=c.type2,a.src=c.src?c.src:"",a.id=c.id?c.id:"",a.name=c.name?c.name:"",a.title=c.title?c.title:"",a.className=c.className?c.className:"",a.width=c.width?c.width:"",a.height=c.height?c.height:"",a.align=c.align?c.align:"",a.scrolling=c.scrolling?c.scrolling:"",a.frameBorder=
c.frameBorder?c.frameBorder:"",a.attributes=c.attributes?c.attributes:"",a.caption=c.caption?c.caption:"",-1<c.width.indexOf("px")||-1<c.width.indexOf("%")||-1<c.width.indexOf("pt")?d.style.width=c.width:""!=c.width&&(d.style.width=c.width+"px"),-1<c.height.indexOf("px")||-1<c.height.indexOf("%")||-1<c.height.indexOf("pt")?d.style.height=c.height:d.style.height=c.height+"px",d.align=c.align;else if("flash"==c.type||"flash"==c.type2){a.type=c.type;a.type2=c.type2;a.src=c.src;a.width=c.width;a.height=
c.height;a.hspace=c.hspace;a.vspace=c.vspace;a.scale=c.scale;a.allowScriptAccess=c.allowScriptAccess;a.quality=c.quality;a.align="";a.menu=c.menu;a.play=c.play;a.loop=c.loop;a.allowFullScreen=c.allowFullScreen;a.flashvars=c.flashvars;a.caption=c.caption;-1<c.width.indexOf("px")||-1<c.width.indexOf("%")||-1<c.width.indexOf("pt")?d.style.width=c.width:d.style.width=c.width+"px";-1<c.height.indexOf("px")||-1<c.height.indexOf("%")||-1<c.height.indexOf("pt")?d.style.height=c.height:d.style.height=c.height+
"px";d.align="";b="absbottom absmiddle absmiddle bottom left middle right texttop top".split(" ");for(var e=b.length,f=0;f<e;f++)if(c.align==b[f]){d.align=c.align;a.align=c.align;break}}}
function command_InsertHR(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0==getFirstRange().range.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);var c=getFirstRange().range;if(c){for(var d=_iframeDoc.createElement("hr"),e=!1,f=c.startContainer;f;){if("p"===f.nodeName.toLowerCase()){e=!0;break}f=f.firstChild}e&&(c.setStartBefore(f),c.collapse(!0));c.insertNode(d);c.selectNode(d);
c.collapse(!1)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_insertHorizontalLine(a,b,c,d,e){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0==getFirstRange().range.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=getFirstRange().range;b=_iframeDoc.createElement("hr");if(a){d?(b.style.cssText=d.style.cssText,100>e&&DEXTTOP.DEXT5.util.dextSetAttribute(b,"width",e,"%")):c&&(100>c.width&&DEXTTOP.DEXT5.util.dextSetAttribute(b,"width",c.width,
"%"),""==c.height?b.style.height="1px":b.style.height=c.height+"px",""!=c.align&&(b.align=c.align),b.style.backgroundColor=""!=c.color?c.color:"#000000",b.style.color=c.color,b.style.border="0px");for(c=a.startContainer;c&&"p"!==c.nodeName.toLowerCase();)c=c.parentNode;c=b.outerHTML;c+='<p id="dext_target"></p><p><br></p>';if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){if(_iframeDoc.execCommand("inserthtml",!1,c),a=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),
rangy.getSelection(_iframeWin).addRange(a)}else pasteHtmlAtCaretHuge(c);if(c=_iframeDoc.getElementById("dext_target"))if(d=c.nextSibling,a.selectNode(c),a.deleteContents(),d)try{if(("P"==d.tagName||"TABLE"==d.tagName||"DIV"==d.tagName)&&d.firstChild)for(var f=d.firstChild;;)if(3==f.nodeType||-1<",img,input,iframe,object,video,".indexOf(","+f.tagName.toLowerCase()+",")){d=f.parentNode;break}else if("BR"==f.tagName){d=f.parentNode;break}else if(null!=f.firstChild)f=f.firstChild;else{d=f;break}doSetCaretPosition(d,
0)}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertIframe(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0==getFirstRange().range.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=_iframeDoc.createElement("iframe");""!=c.id&&(a.id=c.id);""!=c.name&&(a.name=c.name);""!=c.title&&(a.title=c.title);a.style.width=""!=c.width?c.width+"px":"400px";a.style.height=""!=c.height?c.height+"px":"400px";a.align=c.align;a.scrolling=
c.scroll;a.frameBorder=1==c.border?1:0;a.src=c.url;c=getFirstRange().range;c.deleteContents();c.insertNode(a);c.selectNode(c.endContainer);c.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertHyperLink(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;if("hyperlink"==c.type||"image"==c.type)if(1==a.collapsed){""==c.text&&(c.text=c.url);b=_iframeDoc.createElement("a");0>c.text.toLowerCase().indexOf("<img")&&(c.text=DEXTTOP.DEXT5.util.escapeHtml(c.text));b.innerHTML=c.text;b.setAttribute("href",c.url);b.target="undefined"!=typeof c.target&&""!=
c.target?c.target:"_blank";" "==c.target&&b.removeAttribute("target");"undefined"!=typeof c.title&&""!=c.title?b.title=c.title:"0"!=DEXTTOP.G_CURREDITOR._config.accessibility&&-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("a_title")&&(b.title=c.url);"undefined"!=typeof c.id&&""!=c.id&&(b.id=c.id);"undefined"!=typeof c.className&&""!=c.className&&(b.className=c.className);"undefined"!=typeof c.type2&&"insert_file"==c.type2&&(b.setAttribute("DEXT5InsertFile",""),"1"==DEXTTOP.G_CURREDITOR._config.attachFileImage&&
attachFileImage(b,c));"image"==c.type&&b.setAttribute("DEXT5HyperlinkImage","");if("undefined"!=typeof c.attr_info_arr&&1<c.attr_info_arr.length)for(var d=c.attr_info_arr.length,e=1;e<d;e++){var f=c.attr_info_arr[e].split("^");2==f.length&&b.setAttribute(f[0],f[1])}a.deleteContents();a.insertNode(b);a.selectNode(b);c=c.text.replace(/"/g,"'").match(RegExp("srcs*=s*(\"|')(([^\"']*))(\"|')","gi"));e="";c&&0<c.length&&(e=c[0].replace("src=",""),e=e.replace(/\'/g,""),e=e.replace(/&amp;/g,"&"),b.getElementsByTagName("img")[0].src=
e)}else for(_iframeDoc.execCommand("CreateLink",!1,c.url),b=getFirstRange().range,0==!!b&&(b=a),b=getNodesInRange(b),d=b.length,e=0;e<d;e++)"a"==b[e].nodeName.toLowerCase()&&(b[e].target="undefined"!=typeof c.target&&""!=c.target?c.target:"_blank","undefined"!=typeof c.title&&""!=c.title?b[e].title=c.title:"0"!=DEXTTOP.G_CURREDITOR._config.accessibility&&-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("a_title")&&(b[e].title=c.url),"undefined"!=typeof c.id&&""!=c.id&&(b[e].id=
c.id),"undefined"!=typeof c.className&&""!=c.className&&(b[e].className=c.className),"undefined"!=typeof c.type2&&"insert_file"==c.type2&&(b[e].setAttribute("DEXT5InsertFile",""),"1"==DEXTTOP.G_CURREDITOR._config.attachFileImage&&attachFileImage(b[e],c)),"image"==c.type&&b[e].setAttribute("DEXT5HyperlinkImage",""));else"bookmark"==c.type&&(1==a.collapsed?(""==c.text&&(c.text=c.bookname),b=_iframeDoc.createElement("a"),c.text=DEXTTOP.DEXT5.util.escapeHtml(c.text),b.innerHTML=c.text,b.href=c.bookname,
a.deleteContents(),a.insertNode(b),a.selectNode(b)):(_iframeDoc.execCommand("CreateLink",!1,c.bookname),getNodesInRange(a)));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();try{rangy.getSelection(_iframeWin).addRange(a)}catch(g){try{if(c={strType:"Hyperlink",strCode:"C211",strMessage:"DEXT5 Hyperlink error : ",strStack:g},"function"===typeof DEXTTOP.G_CURREDITOR._config.event.onError)DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,c);else"function"===typeof DEXTTOP.DEXTWIN.dext_editor_on_error_event?
DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,c):alert(c.strMessage+c.strStack)}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertBookmark(a,b,c,d){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0==getFirstRange().range.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=_iframeDoc.createElement("a");""==c&&(c=DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?unescape("%u200B"):unescape("%uFEFF"));a.innerHTML=c;a.setAttribute("id",d);a.setAttribute("name",d);a.className="dext5_bookmark";
c=getFirstRange().range;c.deleteContents();d=c.getDocument().createTextNode("\u00a0");c.insertNode(d);c.insertNode(a);c.selectNode(a.nextSibling);c.collapse(!1);DEXTTOP.DEXT5.browser.ie&&d.parentNode.removeChild(d);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertSymbol(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;a.deleteContents();0==a.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a.pasteHtml(c+'<span id="dext_symbol">dext_symbol</span>');c=_iframeDoc.getElementById("dext_symbol");doSetCaretPosition(c,1);c.parentNode.removeChild(c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0}
function command_TableSelect(a,b,c,d){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(a=getFirstRange().range)d=d?d:GetTDTHCell(a.startContainer),null==d&&DEXTTOP.G_SELECTED_ELEMENT&&(d=DEXTTOP.G_SELECTED_ELEMENT),a=GetParentbyTagName(d,"table"),a.setAttribute("DEXT5CellSelected","DEXT5CellSelected"),ActiveCurrTable=a,"select_cell"==c?setTableCellSelect(d):"select_row"==c?setTableRowSelect(d):"select_column"==c?setTableColumnSelect(d):"select_all"==c&&setTableAllSelect(d)}
function command_TableWidthHeightRemove(a,b,c){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();"width_remove"==c?setTableWidthRemove():"height_remove"==c?setTableHeightRemove():"width_height_remove"==c&&setTableWidthHeightRemove();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_TableSameWidthheight(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();"same_width"==c?setTableWidthSame():"same_height"==c?setTableHeightSame():"same_widthheight"==c&&(setTableWidthSame(),setTableHeightSame());a=GetTableSelectionCells();1<a.length?DEXTTOP.G_CURREDITOR._iconEnable("selectedMultiCell"):1==a.length&&DEXTTOP.G_CURREDITOR._iconEnable("selectedSingleCell");
DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_TableRowClone(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange().range;c&&(0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),c=GetTDTHCell(c.startContainer),setTableRowClone(c),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell"),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_VerticalAlignExcute(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if(a=getFirstRange().range){var d=GetTDTHCell(a.startContainer);a=GetTableSelectionCells(d);b=a.length;0==b&&(a[0]=d,b=a.length);for(d=0;d<b;d++){var e=a[d];removeAttribute(e,"valign");e.style.verticalAlign=c}a=GetTableSelectionCells();b=a.length;0==b?DEXTTOP.G_CURREDITOR._iconEnable("focusInCell"):
1==b?DEXTTOP.G_CURREDITOR._iconEnable("selectedSingleCell"):1<b&&DEXTTOP.G_CURREDITOR._iconEnable("selectedMultiCell");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}
function command_editorSetting(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();b=DEXTTOP.DEXT5.util.getEditorByName(a);b._setting.grid_color=c.grid_color;b._setting.grid_color_nm=c.grid_color_nm;b._setting.grid_spans=c.grid_spans;b._setting.grid_form=c.grid_form;b._setting.page_title=c.page_title;b._setting.encoding=c.encoding;b._setting.doctype=c.doctype;b._setting.xhtml=c.xhtml;b._setting.lang=c.lang;b._PageProp.encoding=c.encoding;b._PageProp.doctype=c.doctype;b._PageProp.xmlnsname=
c.xhtml;b._PageProp.lang=c.lang;var d=!1;"1"==b._config.setAutoSave.saveAndStartInterval&&b._setting.auto_save&&"on"===b._setting.auto_save.userSetting&&(d=!0);setAutoSave(b,void 0,d);DEXTTOP.G_CURREDITOR.autoListUse=0<c.auto_list?1<c.auto_list?0:1:b._config.autoList.use;try{DEXTTOP.DEXTWIN.localStorage["dext_"+a+"_auto_list"]=c.auto_list}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}d=a="";"1"==b._config.useLineBreak&&(b._setting.word_break_type=c.word_break_type,b._setting.word_wrap_type=
c.word_wrap_type,a=c.word_break_type,d=c.word_wrap_type,setUserSetting(b,"lineBreak"));if(1==b._config.usePersonalSetting){b._setting.personal_font_family=c.personal_font_family;b._setting.personal_font_size=c.personal_font_size;b._setting.personal_line_height=c.personal_line_height;b._config.pasteToImage="-1"==c.personal_paste_to_image?b._setting.config_paste_to_image:c.personal_paste_to_image;b._setting.personal_paste_to_image=c.personal_paste_to_image;setUserSetting(b,"personalSetting");var f=
c.personal_font_family,g=c.personal_font_size,h=c.personal_line_height;""==f&&(f=b._config.defaultFontFamily);""==g&&(g=b._config.defaultFontSize);""==h&&(h=b._config.defaultLineHeight);b._setting.font_family=f;b._dextFontFamily._fontFamily[b.ID]&&(b._dextFontFamily._fontFamily[b.ID][0]=f);b._dextFontFamily._iframe_doc&&(b._dextFontFamily._iframe_doc.getElementById("ff_"+b.ID+"_0").getElementsByTagName("span")[0].style.fontFamily=f);b._setting.font_size=g;b._dextFontSize._fontSize[b.ID]&&(b._dextFontSize._fontSize[b.ID][0]=
g);b._dextFontSize._iframe_doc&&(b._dextFontSize._iframe_doc.getElementById("fs_"+b.ID+"_0").style.fontSize=g);b._setting.line_height=h;b._dextLineHeight._lineHeight[b.ID]&&(b._dextLineHeight._lineHeight[b.ID][0]=h)}if(1==b._config.useLineBreak||1==b._config.usePersonalSetting)d=createDefaultStyleNodeForEditorArea(b,{wordBreakType:a,wordWrapType:d}),(f=getDefaultStyleTag(_iframeDoc,b))?(f.parentNode.insertBefore(d,f),f.parentNode.removeChild(f)):(f=_iframeDoc.getElementsByTagName("head")[0])&&f.appendChild(d);
if(c.word_break_for_all_table)for(""==a&&(a="normal"),d=_iframeDoc.getElementsByTagName("table"),f=d.length,g=0;g<f;g++)d[g].style.wordBreak=a;setDoctypeProperty(b._docType[c.doctype],c.encoding,c.lang,c.xhtml);a=b._config.webPath.image+"grid/bggrid_"+c.grid_spans+"_"+c.grid_color_nm.replace(" ","").toLowerCase()+"_"+c.grid_form+".png";_iframeDoc.title=c.page_title;b._PageProp.bshowgrid&&1==b._PageProp.bshowgrid&&(b._PageProp.gridimage="url("+DEXTTOP.DEXT5.util.url.full_url(a)+")",b._PageProp.gridattachment=
"scroll",b._PageProp.gridrepeat="repeat",changeBodyImageProperty(!1));G_BodyFit.noncreationAreaBackgroundStatus&&setBodyFitStyle(b,!0)}
function command_InsertInputText(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("input");b.type=c.insertType;b.setAttribute("value",c.insertValue);b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;""!=c.insertAlign&&(b.style.textAlign=c.insertAlign);""!=c.insertWidth&&(b.style.width=c.insertWidth+"px");""!=c.insertHeight&&(b.style.height=
c.insertHeight+"px");c.insertDisabled?b.disabled=!0:b.removeAttribute("disabled");c.insertReadonly?b.readOnly=!0:b.removeAttribute("readonly");""!=c.insertSize&&(b.size=c.insertSize);""!=c.insertMaxlength&&(b.maxLength=c.insertMaxlength);""!=c.insertPlaceholder&&(b.placeholder=c.insertPlaceholder);var d=c.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=c.insertEventNameArr[g],f+=c.insertEventFunctionArr[g];d={type:"event"};d.eventName=e;d.eventFunction=
f;setDextCustomData(b,d)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(b.setAttribute("name",c.insertName),a.insertNode(b),a.selectNode(b)):(b=b.outerHTML,b=b.replace(">",' name="'+c.insertName+'" />'),a.pasteHtml(b));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputRadioOrCheckbox(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("input");b.type=c.insertType;b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;""!=c.insertWidth&&(b.style.width=c.insertWidth+"px");""!=c.insertHeight&&(b.style.height=c.insertHeight+"px");c.insertDisabled?b.disabled=!0:b.removeAttribute("disabled");
c.insertChecked?(b.checked=!0,b.setAttribute("checked","checked")):(b.checked=!1,b.removeAttribute("chekced"));b.setAttribute("value",c.insertValue);var d=c.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=c.insertEventNameArr[g],f+=c.insertEventFunctionArr[g];g={type:"event"};g.eventName=e;g.eventFunction=f;setDextCustomData(b,g)}a.deleteContents();if(DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie){b.setAttribute("name",
c.insertName);if("radio"==c.insertType&&c.insertChecked)for(e=_iframeDoc.getElementsByName(c.insertName),f=e.length,g=0;g<f;g++)e[g].checked=!1,e[g].removeAttribute("checked");a.insertNode(b);a.selectNode(b);c.insertChecked&&(b.checked=!0,b.setAttribute("checked","checked"))}else{if("radio"==c.insertType&&c.insertChecked)for(e=_iframeDoc.getElementsByName(c.insertName),f=e.length,g=0;g<f;g++)e[g].checked=!1,e[g].removeAttribute("checked");b=b.outerHTML;b=b.replace(">",' name="'+c.insertName+'" />');
a.pasteHtml(b)}a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputButton(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("input");b.type=c.insertType;b.setAttribute("value",c.insertValue);b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;""!=c.insertAlign&&(b.style.textAlign=c.insertAlign);""!=c.insertWidth&&(b.style.width=c.insertWidth+"px");""!=c.insertHeight&&(b.style.height=
c.insertHeight+"px");c.insertDisabled?b.disabled=!0:b.removeAttribute("disabled");var d=c.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=c.insertEventNameArr[g],f+=c.insertEventFunctionArr[g];d={type:"event"};d.eventName=e;d.eventFunction=f;setDextCustomData(b,d)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(b.setAttribute("name",c.insertName),a.insertNode(b),a.selectNode(b)):(b=b.outerHTML,
b=b.replace(">",' name="'+c.insertName+'" />'),a.pasteHtml(b));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputSelect(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("select");b.setAttribute("value",c.insertValue);b.multiple=c.insertMultiselect;b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;b.size=c.insertSize;""!=c.insertWidth&&(b.style.width=c.insertWidth+"px");""!=c.insertHeight&&(b.style.height=c.insertHeight+
"px");c.insertDisabled?b.disabled=!0:b.removeAttribute("disabled");for(var d=c.insertOptionsArr.length,e=0;e<d;e++){var f=_iframeDoc.createElement("option");f.innerHTML=c.insertOptionsArr[e];f.setAttribute("value",c.insertOptionsValueArr[e]);f.selected=c.insertOptionsSelected[e];b.appendChild(f)}var g=c.insertEventNameArr.length;if(0<g){f=d="";for(e=0;e<g;e++)0!=e&&(d+="\x0B",f+="\x0B"),d+=c.insertEventNameArr[e],f+=c.insertEventFunctionArr[e];e={type:"event"};e.eventName=d;e.eventFunction=f;setDextCustomData(b,
e)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(b.setAttribute("name",c.insertName),a.insertNode(b),a.selectNode(b)):(b=b.outerHTML,b=b.replace(">",' name="'+c.insertName+'" >'),a.pasteHtml(b));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputTextarea(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("textarea");b.value=c.insertValue;b.innerHTML=c.insertValue;b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;""!=c.insertRows&&(b.rows=c.insertRows);""!=c.insertCols&&(b.cols=c.insertCols);""!=c.insertWrap&&(b.wrap=c.insertWrap);""!=c.insertWidth&&(b.style.width=
c.insertWidth+"px");""!=c.insertHeight&&(b.style.height=c.insertHeight+"px");""!=c.insertAlign&&(b.style.textAlign=c.insertAlign);c.insertDisabled?b.disabled=!0:b.removeAttribute("disabled");c.insertReadonly?b.readOnly=!0:b.removeAttribute("readonly");""!=c.insertPlaceholder&&(b.placeholder=c.insertPlaceholder);var d=c.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=c.insertEventNameArr[g],f+=c.insertEventFunctionArr[g];d={type:"event"};d.eventName=e;
d.eventFunction=f;setDextCustomData(b,d)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(b.setAttribute("name",c.insertName),a.insertNode(b),a.selectNode(b)):(b=b.outerHTML,b=b.replace(">",' name="'+c.insertName+'" >'),a.pasteHtml(b));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputHidden(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("input");b.type="hidden";b.setAttribute("value",c.insertValue);b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(b.setAttribute("name",c.insertName),
a.insertNode(b),a.selectNode(b)):(b=b.outerHTML,b=b.replace(">",' name="'+c.insertName+'" />'),a.pasteHtml(b));DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0;ReplaceRealObjectToImage(!1);a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputImage(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("input");b.type=c.insertType;b.setAttribute("value",c.insertValue);b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;b.src=c.insertSrc;c.insertAlign&&(b.align=c.insertAlign);""!=c.insertWidth&&(b.style.width=c.insertWidth+"px");""!=c.insertHeight&&(b.style.height=
c.insertHeight+"px");c.insertDisabled?b.disabled=!0:b.removeAttribute("disabled");var d=c.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=c.insertEventNameArr[g],f+=c.insertEventFunctionArr[g];d={type:"event"};d.eventName=e;d.eventFunction=f;setDextCustomData(b,d)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(b.setAttribute("name",c.insertName),a.insertNode(b),a.selectNode(b)):(b=b.outerHTML,
b=b.replace(">",' name="'+c.insertName+'" />'),a.pasteHtml(b));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function isDEXTContainerMode(){var a=!1;try{a=-1<DEXTTOP.DEXTWIN.location.href.indexOf("editor_container.html")}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return a}
function command_fullScreen(a,b){if(1==isDEXTContainerMode())return!1;var c=document.getElementById("ue_editor_holder_"+a);try{"function"==typeof b._config.event.beforeFullScreen?b._config.event.beforeFullScreen(a,b.FrameStatus):DEXTTOP.DEXTWIN.dext_before_full_screen_event(a,b.FrameStatus)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(""==b.FrameStatus){for(var e=DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+b.ID);e.parentNode&&"body"!=e.parentNode.tagName.toLowerCase()&&
"html"!=e.parentNode.tagName.toLowerCase();)e=e.parentNode,"relative"==e.style.position&&"auto"==e.style.overflow?(e.style.overflow="",G_FullScreenCheckObject.push({flag:"1",object:e})):(e.style.overflow="visible",G_FullScreenCheckObject.push({flag:"2",object:e}));if(e=DEXTTOP.DEXTDOC.getElementById("div_resizebar_"+b.ID))e.style.display="none";originScrollSize=getWindowScrollPos(DEXTTOP.DEXTWIN);orginEditorSize=getClientSize(c);e=window.frameElement;originfull.margin1=DEXTTOP.DEXTDOC.documentElement.style.margin;
originfull.padding1=DEXTTOP.DEXTDOC.documentElement.style.padding;originfull.border1=DEXTTOP.DEXTDOC.documentElement.style.border;originfull.height1=DEXTTOP.DEXTDOC.documentElement.style.height;originfull.overflow1=DEXTTOP.DEXTDOC.documentElement.style.overflow;originfull.margin2=DEXTTOP.DEXTDOC.body.style.margin;originfull.padding2=DEXTTOP.DEXTDOC.body.style.padding;originfull.border2=DEXTTOP.DEXTDOC.body.style.border;originfull.height2=DEXTTOP.DEXTDOC.body.style.height;originfull.overflow2=DEXTTOP.DEXTDOC.body.style.overflow;
DEXTTOP.DEXTDOC.documentElement.style.overflow="hidden";DEXTTOP.DEXTDOC.documentElement.style.padding="0";DEXTTOP.DEXTDOC.documentElement.style.margin="0";DEXTTOP.DEXTDOC.documentElement.style.border="0";DEXTTOP.DEXTDOC.documentElement.style.height="100%";DEXTTOP.DEXTDOC.body.style.overflow="hidden";DEXTTOP.DEXTDOC.body.style.padding="0";DEXTTOP.DEXTDOC.body.style.margin="0";DEXTTOP.DEXTDOC.body.style.border="0";DEXTTOP.DEXTDOC.body.style.height="100%";originfull.overflow3=e.style.overflow;originfull.position3=
e.style.position;originfull.zIndex=e.style.zIndex;getClientRect(e);e.style.overflow="hidden";e.style.position="absolute";e.style.width="100%";e.style.height="100%";e.style.zIndex=b._config.zIndex;var f=getWindowClientSize(DEXTTOP.DEXTWIN);e.style.width=f[0]+"px";e.style.height=f[1]+"px";c.style.height=f[1]-b.baseMenuToolbarHeight+"px";e.style.left="0px";e.style.top="0px";c=getClientRect(e);relativePos=isRelativePosition(e);0<c.left||0<c.top?relativePos=!0:(e.style.left="0px",e.style.top="0px");setBackupHiddenStyle(e,
DEXTTOP.DEXTWIN);b.FrameStatus="full_size";setEditorHeight(b,!1);resizeDextWin();DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTWIN,"resize",resizeDextWin)}else{if(G_FullScreenCheckObject&&0<G_FullScreenCheckObject.length){e=G_FullScreenCheckObject.length;for(f=0;f<e;f++)"1"==G_FullScreenCheckObject[f].flag?G_FullScreenCheckObject[f].object.style.overflow="auto":"2"==G_FullScreenCheckObject[f].flag&&(G_FullScreenCheckObject[f].object.style.overflow="");G_FullScreenCheckObject=[]}if(e=DEXTTOP.DEXTDOC.getElementById("div_resizebar_"+
b.ID))e.style.display="";DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTWIN,"resize",resizeDextWin);e=window.frameElement;DEXTTOP.DEXTDOC.documentElement.style.margin=originfull.margin1;DEXTTOP.DEXTDOC.documentElement.style.padding=originfull.padding1;DEXTTOP.DEXTDOC.documentElement.style.border=originfull.border1;DEXTTOP.DEXTDOC.documentElement.style.height=originfull.height1;DEXTTOP.DEXTDOC.documentElement.style.overflow=originfull.overflow1;DEXTTOP.DEXTDOC.body.style.margin=originfull.margin2;DEXTTOP.DEXTDOC.body.style.padding=
originfull.padding2;DEXTTOP.DEXTDOC.body.style.border=originfull.border2;DEXTTOP.DEXTDOC.body.style.height=originfull.height2;DEXTTOP.DEXTDOC.body.style.overflow=originfull.overflow2;e.style.overflow=originfull.overflow3;e.style.position=originfull.position3;e.style.left="0px";e.style.top="0px";e.style.width="100%";e.style.height="100%";e.width="100%";e.height="100%";e.style.zIndex=originfull.zIndex;setRestorreHiddenStyle();setEditorHeight(b,!0);c.style.height=b._defaultHeight+"px";DEXTTOP.DEXTWIN.scroll(originScrollSize[0],
originScrollSize[1]);b.FrameStatus=""}c=[];"full_size"==b.FrameStatus?c.push("full_screen"):removeArrayItemByValue(c,"full_screen");b._iconSelected(c);G_Ruler&&"2"==b._config.ruler.mode&&G_Ruler.SetRulerPosition();setTimeout(function(){try{"function"==typeof b._config.event.fullScreen?b._config.event.fullScreen(a,b.FrameStatus):DEXTTOP.DEXTWIN.dext_full_screen_event(a,b.FrameStatus)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},100)}
function command_grid(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(b._PageProp.bshowgrid&&1==b._PageProp.bshowgrid)changeBodyImageProperty(!0),G_BodyFit.noncreationAreaBackgroundStatus&&setBodyFitStyle(b,!0),b._PageProp.bshowgrid=!1;else{var c=b._config.webPath.image+"grid/bggrid_"+b._setting.grid_spans+"_"+b._setting.grid_color_nm.replace(" ","").toLowerCase()+"_"+b._setting.grid_form+".png";b._PageProp.gridimage="url("+DEXTTOP.DEXT5.util.url.full_url(c)+")";b._PageProp.gridattachment=
"scroll";b._PageProp.gridrepeat="repeat";b._PageProp.bshowgrid=!0;changeBodyImageProperty(!1)}}
function command_InsertPasteDialogHtml(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();a=DEXTTOP.DEXT5.util.officeClean(c,!1);a=DEXTTOP.DEXT5.util.htmlRevision(a);a=xssReplaceScript(null,a);adjustTableAfterPaste(DEXTTOP.G_CURREDITOR,{html:a});a=removeEditorAttribute(a);"1"==DEXTTOP.G_CURREDITOR._config.removeAppleInterchangeNewlineBr&&(a=a.replace(/<br class="Apple-interchange-newline">/gi,""));"1"==DEXTTOP.G_CURREDITOR._config.compatibility.dingBatCharPaste&&(a=dingBatFont(a,DEXTTOP.G_CURREDITOR));
try{for(var d in G_DEPlugin)if("function"===typeof G_DEPlugin[d].onBeforePaste){var e=G_DEPlugin[d].onBeforePaste({html:a});if("string"==typeof e)a=e;else if(!1===e)return}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{if("function"===typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event||"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste){d=a;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste?d=DEXTTOP.DEXTWIN.DEXTTOP.G_CURREDITOR._config.event.beforePaste(a):
"function"===typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event&&(d=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(a))}catch(g){d=a}if(d)a=d;else if(0==d||""==d)return}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}pasteWordCount(a)&&(-1<a.indexOf("dext5customdata")&&(a=checkExistCustomData(a)),a=externalPageBreakDataRaplaceInEditor(a),_iframeDoc.execCommand("inserthtml",!1,a),0>a.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=
!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1),xssReplaceScript(_iframeDoc)),adjustTableAfterPaste(DEXTTOP.G_CURREDITOR))}
function command_tableIndentOutdent(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=GetParentbyTagName(parent.G_SELECTED_ELEMENT,"table",!0);try{if(null==a&&0<GetTableSelectionCells().length){var d=GetTableSelectionCells();a=GetParentbyTagName(d[0],"table",!0)}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}d="marginLeft";isRTL()&&(d="marginRight");var f=parseIntOr0(b._config.tableDefaultInoutdent),
g=parseIntOr0(a.style[d],10);if("indent"==c)if("1"==b._config.limitTableInoutdent){b=0;c=getClientRect(a).right;if(""!=_iframeDoc.body.style.width&&-1<_iframeDoc.body.style.width.indexOf("px"))b=DEXTTOP.DEXT5.util.parseIntOr0(_iframeDoc.body.style.width),c-=10;else{b=_iframeDoc.documentElement.clientWidth;if(0==b||null==b||void 0==b)b=_iframeDoc.body.clientWidth;b=Math.floor(b);b-=10}var h=c+f;0<b&&(h>=b&&c<b?g+=b-c:h<b&&(g+=f),0>g&&(g=0))}else g=989>=g?g+f:999;else"outdent"==c&&(g=g>=f?g-f:0);a.style[d]=
g+"px";doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT,0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}function command_loadAutoSave(a,b,c){b=function(){c&&""!=c&&DEXTTOP.DEXT5.setHtmlValueExWithDocType(c,a)};0==DEXTTOP.DEXT5.isEmpty(a)?1==confirm(dext5_lang.loadAutoSave.loadMsg)&&b():b()}
function command_useRuler(a){a=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+a);getIframeDocument(a);G_Ruler.viewRulerStatus=!G_Ruler.viewRulerStatus;G_Ruler.viewRulerStatus?showRuler(DEXTTOP.G_CURREDITOR):hideRuler(DEXTTOP.G_CURREDITOR)}
function command_Direction(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange().range;var d=getFirstRange().sel,e=elems=null,f=[];if(a&&a.startContainer){if(1==a.startContainer.nodeType){var e=getMyElementNode(a.startContainer),g=rangy.dom.getBody(_iframeDoc).childNodes,h=g.length;for(b=0;b<h;b++)f.push(g[b])}else e=getMyElementNode(a.startContainer),f=getNodesInRange(a);elems=getDirectionNode(a,d,e,f);d=elems.length;for(b=0;b<d;b++)elems[b].dir=c.toLowerCase();
setMenuIconRealable(getMyElementNode(a.startContainer))}}
function command_tableCopy(a,b,c){if(1==c||1==getCopyCellData())if(dext_src_init(b._EDITOR.design),restoreSelection(),setFocusToBody(),DEXTTOP.DEXT5.browser.safari||DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion){if(c=DEXTTOP.DEXTDOC.getElementById("dext5_paste_temp_frame")){var d=getFirstRange().range;a=c.contentWindow;null==a.document.body&&(a.document.open("text/html","replace"),isCustomDomain(document)&&(a.document.domain=document.domain),a.document.write("<html><head></head><body></body></html>"),
a.document.close());a.document.body.innerHTML=DEXTTOP.G_COPIEDTABLE.outerHTML;c.style.display="";c=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection;var e=a.document.createRange();e.selectNode(a.document.body.firstChild);c.removeAllRanges();c.addRange(e);var f=function(a){a.preventDefault&&a.preventDefault();a&&a.clipboardData&&a.clipboardData.setData&&a.clipboardData.setData("text/html",DEXTTOP.G_COPIEDTABLE.outerHTML);DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"copy",f);_iframeWin.focus();
a=getFirstRange();a.sel.removeAllRanges();a.sel.addRange(d)};DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"copy",f);a.document.execCommand("copy",!1,null)}}else{_iframeDoc.getElementById("dext_temp_copy_div")&&_iframeDoc.getElementById("dext_temp_copy_div").parentNode.removeChild(_iframeDoc.getElementById("dext_temp_copy_div"));var g=0,h=0;if(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion)try{g=Math.max(_iframeDoc.documentElement.scrollLeft,_iframeDoc.body.scrollLeft),h=Math.max(_iframeDoc.documentElement.scrollTop,
_iframeDoc.body.scrollTop)}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var q=_iframeDoc.createElement("div");q.style.position="absolute";q.style.left="-5000px";q.style.top=h+"px";q.id="dext_temp_copy_div";q.style.width="1px";q.style.height="1px";q.innerHTML=DEXTTOP.G_COPIEDTABLE.outerHTML;a=q.getElementsByTagName("table")[0];ClearDraggingTable(a);_iframeDoc.body.appendChild(q);setTimeout(function(){try{var a=saveSelection(b.ID,!0),c=getFirstRange(),d=c.range,e=c.sel;d.setStartBefore(q.firstChild);
d.setEndAfter(q.firstChild);e.removeAllRanges();e.addRange(d);var f=function(a){a.preventDefault&&a.preventDefault();a&&a.clipboardData&&a.clipboardData.setData&&a.clipboardData.setData("text/html",q.firstChild.outerHTML);DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"copy",f)};DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"copy",f);_iframeDoc.execCommand("copy");if(a){restoreSelection(a,!0);try{DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&_iframeWin.scroll(g,h)}catch(m){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}}q.parentNode.removeChild(q)}catch(z){_iframeDoc.getElementById("dext_temp_copy_div")&&_iframeDoc.getElementById("dext_temp_copy_div").parentNode.removeChild(_iframeDoc.getElementById("dext_temp_copy_div"))}},0)}}
function command_tablePaste(a,b,c,d){try{dext_src_init(b._EDITOR.design);c&&(DEXTTOP.G_COPIEDTABLE=c);DEXTTOP.G_COPIEDCELLDATA=[];a={};"object"===typeof d&&"string"===typeof d.pasteType&&("table_content_paste_with_format"===d.pasteType?a.copiedCellFormat=[]:"table_content_paste_to_text"===d.pasteType&&(a.copiedText=[]));var e=DEXTTOP.G_COPIEDTABLE.rows.length;for(d=0;d<e;d++){var f=DEXTTOP.G_COPIEDTABLE.rows[d],g=f.cells.length;for(b=0;b<g;b++){var h=f.cells[b];void 0==DEXTTOP.G_COPIEDCELLDATA[d]&&
(DEXTTOP.G_COPIEDCELLDATA[d]=[]);a.copiedCellFormat?void 0==a.copiedCellFormat[d]&&(a.copiedCellFormat[d]=[]):a.copiedText&&void 0==a.copiedText[d]&&(a.copiedText[d]=[]);c="";c=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&""==h.innerHTML?"&nbsp;":h.innerHTML;if(a.copiedCellFormat){for(var m={},q="fontFamily textAlign fontColor color backgroundColor fontWeight fontSize".split(" "),t=q.length,u=0;u<t;u++){var v=q[u];""!==h.style[v]&&(m[v]=h.style[v])}a.copiedCellFormat[d].push(m)}else if(a.copiedText){var w=
convertHtmlToTextEx(c),w=DEXTTOP.DEXT5.util.escapeHtml(w),w=w.replace(/<br>/g,"\r\n"),w=w.replace(/<br .*?>/g,"\r\n"),y=convertTextToHtmlEx(w),y=y.replace(/  /g,"&nbsp; ");a.copiedText[d].push(y)}DEXTTOP.G_COPIEDCELLDATA[d].push(c)}}var x,z=getFirstRange().range;null!=DEXTTOP.G_SELECTED_ELEMENT?"html"==DEXTTOP.G_SELECTED_ELEMENT.tagName.toLowerCase()?x=_iframeDoc.body.lastChild:z&&z.startContainer&&(x=getMyElementNode(z.startContainer)):z&&z.startContainer&&(x=getMyElementNode(z.startContainer));
null!=x&&doSetCaretPosition(x,0);0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();1==setPasteCellData(a)&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}catch(B){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_intablePaste(a,b){try{dext_src_init(b._EDITOR.design);var c,d=getFirstRange().range;null!=DEXTTOP.G_SELECTED_ELEMENT?"html"==DEXTTOP.G_SELECTED_ELEMENT.tagName.toLowerCase()?c=_iframeDoc.body.lastChild:d&&d.startContainer&&(c=getMyElementNode(d.startContainer)):d&&d.startContainer&&(c=getMyElementNode(d.startContainer));null!=c&&doSetCaretPosition(c,0);0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DrageStartCell=null;1==setPasteCellData()&&
(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_listNumberBullets(a,b,c,d){restoreSelection();setFocusToBody();if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)try{DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var f=function(a){a.style.listStyleType=d;"N"==c&&""!=b._config.orderListDefaultClass?a.setAttribute("class",b._config.orderListDefaultClass):
"B"==c&&""!=b._config.unOrderListDefaultClass&&a.setAttribute("class",b._config.unOrderListDefaultClass)},g=function(a){for(var b=a.length,c=0;c<b;c++){var d=a[c].nodeName.toLowerCase();if("ol"==d||"ul"==d)d=a[c].parentNode,"p"==d.nodeName.toLowerCase()&&(d.parentNode.replaceChild(a[c],d),d=getFirstRange(),d.sel.removeAllRanges(),d.range.selectNodeContents(a[c]),d.sel.addRange(d.range))}};a=function(a){var b=getFirstRange().range,d=null;b&&b.startContainer&&(d=a?1!=b.startContainer.nodeType||"TD"!=
b.startContainer.tagName&&"TH"!=b.startContainer.tagName?getMyElementNode(b.startContainer):b.startContainer.childNodes[b.startOffset]:"BODY"==b.startContainer.tagName?b.startContainer.childNodes[b.startOffset]:getMyElementNode(b.startContainer));var b=GetParentbyTagName(d,"ol",!0),e=GetParentbyTagName(d,"ul",!0);"N"==c&&e||"N"==c&&!b&&!e?_iframeDoc.execCommand("insertOrderedList",!1,null):("B"==c&&b||"B"==c&&!b&&!e)&&_iframeDoc.execCommand("insertUnOrderedList",!1,null);var h=getFirstRange().range,
d=null;setMenuIconRealable(getMyElementNode(h.startContainer));h&&h.startContainer&&(d="BODY"==h.startContainer.tagName?h.startContainer.childNodes[h.startOffset]:getMyElementNode(h.startContainer));if(a)for(var d=a.getElementsByTagName("N"==c?"ol":"ul"),h=d.length,m=0;m<h;m++)f(d[m]),g([d[m]]);else d&&(m=null,"N"==c?m=GetParentbyTagName(d,"ol"):"B"==c&&(m=GetParentbyTagName(d,"ul")),m&&f(m)),d=getFirstRange().range,0==!!d&&(d=h),d=getNodesInRange(d),g(d);null==b&&null==e&&setLiStyle();removeDivInLiTag(a)};
var h=GetTableSelectionCells(),m=h.length;if(0<m)for(var q=getFirstRange(),t=q.range,u=t.cloneRange(),v=0;v<m;v++){q.sel.removeAllRanges();var w=getMyFirstOrLastChildElementNode(h[v],!1),y=getMyFirstOrLastChildElementNode(h[v],!0);if(null==w&&null==y){var x=_iframeDoc.createElement("p");x.innerHTML="<br>";y=w=x;h[v].appendChild(x)}w&&y&&(t.setStartBefore(w),t.setEndAfter(y),q.sel.addRange(t),a(h[v]),q.sel.removeAllRanges(),q.sel.addRange(u))}else a();if(null==DEXTTOP.G_CURREDITOR._formatPainterList||
DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)try{DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}G_Ruler&&"2"==b._config.ruler.mode&&G_Ruler.SetRulerPosition();onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}
function command_setClassStyle(a,b,c){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();var d=getFirstRange(),e=d.range;0<a.UndoManager.charCount&&!c&&a.UndoManager.putUndo();try{if(1==e.collapsed){var f=GetTableSelectionCells();if(0!=f.length){var g=f.length,h="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode,m=DEXTTOP.DEXT5.browser.quirks;if(DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||1==h||1==m))for(var q=0;q<g;q++){var t=f[q];"<p></p>"==t.innerHTML.toLowerCase()?
t.innerHTML="<p>&nbsp;</p>":"<span></span>"==t.innerHTML.toLowerCase()?t.innerHTML="<span>&nbsp;</span>":""==t.innerHTML.toLowerCase()&&(t.innerHTML="&nbsp;")}for(q=0;q<g;q++){d.sel.removeAllRanges();e.selectNode(f[q]);d.sel.addRange(e);var u=rangy.createCssClassApplier(b);u.applyToSelection(_iframeWin);rangy.getSelection(_iframeWin).removeAllRanges()}d.sel.removeAllRanges();doSetCaretPosition(DrageEndCell.childNodes[0],1);!DEXTTOP.DEXT5.browser.ie||8!=DEXTTOP.DEXT5.browser.ieVersion&&1!=h&&1!=m||
(DEXTTOP.G_CURREDITOR._LastRange=null)}}else u=rangy.createCssClassApplier(b),u.applyToSelection(_iframeWin);c||(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_removeClassStyle(a,b){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange(),d=c.range;0<a.UndoManager.charCount&&a.UndoManager.putUndo();try{if(1==d.collapsed){var e=GetTableSelectionCells();if(0!=e.length){for(var f=e.length,g=0;g<f;g++){c.sel.removeAllRanges();d.selectNode(e[g]);c.sel.addRange(d);var h=rangy.createCssClassApplier(b);h.undoToSelection(_iframeWin);rangy.getSelection(_iframeWin).removeAllRanges()}c.sel.removeAllRanges();doSetCaretPosition(DrageEndCell.childNodes[0],
1);!DEXTTOP.DEXT5.browser.ie||8!=DEXTTOP.DEXT5.browser.ieVersion&&1!=iframeQuirks&&1!=browserQuirks||(DEXTTOP.G_CURREDITOR._LastRange=null)}}else h=rangy.createCssClassApplier(b),h.undoToSelection(_iframeWin);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_custom(a,b,c,d){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.customAction?DEXTTOP.G_CURREDITOR._config.event.customAction(c,a,d):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_custom_action&&DEXTTOP.DEXTWIN.dext_editor_custom_action(c,a,d)}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_formatPainter(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();try{var c=getFirstRange().range;if(1==c.collapsed)if(0<GetTableSelectionCells().length)null!=b._formatPainterList&&(b._formatPainterList=null,b._iconEnable(""));else{b._formatPainterList=[];var d=b._config.applyFormatExceptStyle,e=c.endContainer,c=e;3==e.nodeType&&(c=e.parentNode);if(1==c.nodeType&&"BODY"!=c.tagName){var f=DEXTTOP.DEXT5.util.getStyle(c,"all"),g=getElementInParentStyleProperty(c,
"lineHeight");""!=g&&0<d.length&&-1<d.indexOf("lineHeight")&&(g="");b._formatPainterList.lineHeight=g;var h=getElementInParentStyleProperty(c,"fontFamily");""==h&&(h=f.fontFamily);b._formatPainterList.fontFamily=h;var m=getElementInParentStyleProperty(c,"fontSize");""==m&&(m=f.fontSize);b._formatPainterList.fontSize=m;var q=getElementInParentStyleProperty(c,"color");""==q&&(q=f.color);b._formatPainterList.color=q;var t=getElementInParentStyleProperty(c,"backgroundColor");b._formatPainterList.backgroundColor=
t;b._formatPainterList.textAlign=f.textAlign;var u=getElementInParentStyleProperty(c,"paddingLeft");b._formatPainterList.paddingLeft=u;var v=f.fontWeight;""!=v&&("700"<=v||"bold"==v)&&(b._formatPainterList.b=!0);b._formatPainterList.i=""!=getElementInParentTag(c,["em","i"])?!0:!1;var w=GetParentbyTagName(c,"u");if(w){b._formatPainterList.u=!0;var y=getElementInParentStyleProperty(w,"color");""!=y&&(b._formatPainterList.u_has_color=!0)}else _iframeDoc.queryCommandState("underline")&&(b._formatPainterList.u=
!0);(w=GetParentbyTagName(c,"s")||GetParentbyTagName(c,"strike"))?(b._formatPainterList.s=!0,y=getElementInParentStyleProperty(w,"color"),""!=y&&(b._formatPainterList.s_has_color=!0)):_iframeDoc.queryCommandState("strikeThrough")&&(b._formatPainterList.s=!0);b._formatPainterList.sup=""!=getElementInParentTag(c,["sup"])?!0:!1;b._formatPainterList.sub=""!=getElementInParentTag(c,["sub"])?!0:!1;if(""!=getElementInParentTag(c,["ol"])){var w=GetParentbyTagName(c,"ol"),x=w.style.listStyleType;b._formatPainterList.ol=
x}""!=getElementInParentTag(c,["ul"])&&(w=GetParentbyTagName(c,"ul"),x=w.style.listStyleType,b._formatPainterList.ul=x)}else b._formatPainterList=null}}catch(z){b._formatPainterList=null}}
function command_applyFormat(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(null!=b._formatPainterList)try{var c,d;DEXTTOP.DEXT5.browser.ie&&(c=0<_iframeDoc.body.scrollLeft?_iframeDoc.body.scrollLeft:_iframeDoc.documentElement.scrollLeft,d=0<_iframeDoc.body.scrollTop?_iframeDoc.body.scrollTop:_iframeDoc.documentElement.scrollTop);var e="";if("undefined"!=typeof _iframeWin.getSelection){var f=_iframeWin.getSelection();if(f.rangeCount){for(var g=_iframeDoc.createElement("div"),
h=0,m=f.rangeCount;h<m;++h)g.appendChild(f.getRangeAt(h).cloneContents());e=g.innerHTML}}else"undefined"!=typeof _iframeDoc.selection&&"Control"!=_iframeDoc.selection.type&&(e=_iframeDoc.selection.createRange().htmlText);if(/<table|<td|<tr|<th/i.test(e))alert(dext5_lang.msg.apply_format_alert1);else{var q=b._formatPainterList;q.nowApplying="1";var t=getFirstRange(),u=t.range;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();command_removeCss2(a,b,e);try{setSelectionWithDextmark();
var t=getFirstRange(),u=t.range,v=u.startContainer;3==v.nodeType&&(v=v.parentNode);var w=GetTDTHCell(v);if(v)if(w){if("700"<=w.style.fontWeight||"bold"<=w.style.fontWeight)setSelectionWithDextmark(),command_bold(a,b),setSelectionWithDextmark(),command_bold(a,b);"italic"==w.style.fontStyle&&(setSelectionWithDextmark(),command_italic(a,b),setSelectionWithDextmark(),command_italic(a,b))}else{var y=DEXTTOP.DEXT5.util.getStyle(v,"all");if(""==getElementInParentTag(v,["b","strong"])){var x=y.fontWeight;
""!=x&&("700"<=x||"bold"==x)&&(setSelectionWithDextmark(),command_bold(a,b),setSelectionWithDextmark(),command_bold(a,b))}if(""==getElementInParentTag(v,["em","i"])){var z=y.fontStyle;""!=z&&"italic"==z&&(setSelectionWithDextmark(),command_italic(a,b),setSelectionWithDextmark(),command_italic(a,b))}}}catch(B){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}setSelectionWithDextmark();command_removeFormat(a,b);if(void 0!=q.ol)switch(setSelectionWithDextmark(),q.ol.toLowerCase()){case "decimal-leading-zero":command_listDecimalLeadingZero(a,
b);break;case "lower-alpha":command_listLowerAlpha(a,b);break;case "lower-greek":command_listLowerGreek(a,b);break;case "lower-roman":command_listLowerRoman(a,b);break;case "upper-alpha":command_listUpperAlpha(a,b);break;case "upper-roman":command_listUpperRoman(a,b);break;default:command_listDecimal(a,b)}if(void 0!=q.ul)switch(setSelectionWithDextmark(),q.ul.toLowerCase()){case "circle":command_listCircle(a,b);break;case "square":command_listSquare(a,b);break;default:command_listDisc(a,b)}1==q.b&&
(setSelectionWithDextmark(),command_bold(a,b));1==q.i&&(setSelectionWithDextmark(),command_italic(a,b));1==q.u&&1!=q.u_has_color&&(setSelectionWithDextmark(),command_underline(a,b));1==q.s&&1!=q.s_has_color&&(setSelectionWithDextmark(),command_strikeThrough(a,b));""!=q.color&&(setSelectionWithDextmark(),command_fontColor(a,b._EDITOR.design,q.color));1==q.u&&1==q.u_has_color&&(setSelectionWithDextmark(),command_underline(a,b));1==q.s&&1==q.s_has_color&&(setSelectionWithDextmark(),command_strikeThrough(a,
b));""!=q.fontFamily&&(setSelectionWithDextmark(),command_fontfamily(a,b._EDITOR.design,q.fontFamily));""!=q.fontSize&&0>q.fontSize.indexOf("em")&&(setSelectionWithDextmark(),command_fontsize(a,b._EDITOR.design,q.fontSize));""!=q.lineHeight&&(setSelectionWithDextmark(),command_lineHeight(a,b._EDITOR.design,q.lineHeight));var D=q.textAlign;""!=D&&-1<D.toLowerCase().indexOf("right")?(setSelectionWithDextmark(null,!0),command_align(a,b,"right")):-1<D.toLowerCase().indexOf("left")?(setSelectionWithDextmark(null,
!0),command_align(a,b,"left")):-1<D.toLowerCase().indexOf("center")?(setSelectionWithDextmark(null,!0),command_align(a,b,"center")):-1<D.toLowerCase().indexOf("full")&&(setSelectionWithDextmark(null,!0),command_align(a,b,"justify"));""!=q.paddingLeft&&(setSelectionWithDextmark(),command_setIndentOutdent(a,b,q.paddingLeft));""!=q.backgroundColor&&(setSelectionWithDextmark(),command_fontBgColor(a,b._EDITOR.design,q.backgroundColor));1==q.sup&&(setSelectionWithDextmark(),command_superscript(a,b));1==
q.sub&&(setSelectionWithDextmark(),command_subscript(a,b));q.nowApplying="0";void 0==c&&void 0==d||_iframeWin.scroll(c,d);removeDextmark(!0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}catch(A){q.nowApplying="0",removeDextmark()}}
function command_setIndentOutdent(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();b=getFirstRange().range;if(!b||!GetTDTHCell(b.startContainer)||0!=b.collapsed){a=getNodesInRange(b);null!=b.startContainer.previousSibling&&"HEAD"==b.startContainer.previousSibling.tagName&&null==b.endContainer.nextSibling&&(a=_iframeDoc.body.childNodes);b=a.length;for(var d=0;d<b;d++)null!=a[d].parentNode&&"body"==a[d].parentNode.nodeName.toLowerCase()&&"table"!=a[d].tagName.toLowerCase()&&
(0<parseIntOr0(a[d].style.paddingLeft)&&(a[d].style.paddingLeft=""),a[d].style.marginLeft=c)}}
function command_margin(a,b,c,d){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var e=getFirstRange().range;a=GetTableSelectionCells();b=a.length;if(0==b)for(a=getNodesInRange(e),null!=e.startContainer.previousSibling&&"HEAD"==e.startContainer.previousSibling.tagName&&null==e.endContainer.nextSibling&&(a=_iframeDoc.body.childNodes),b=a.length,e=0;e<b;e++)null==a[e].parentNode||"body"!=a[e].parentNode.nodeName.toLowerCase()&&"td"!=a[e].parentNode.nodeName.toLowerCase()&&"td"!=
a[e].parentNode.nodeName.toLowerCase()||!a[e].tagName||"table"==a[e].tagName.toLowerCase()||("margin"==c?a[e].style.margin=d:("marginTop"==c&&(a[e].style.marginTop=d),"marginBottom"==c&&(a[e].style.marginBottom=d),"marginLeft"==c&&(a[e].style.marginLeft=d),"marginRight"==c&&(a[e].style.marginRight=d)));else for(e=0;e<b;e++)for(var f=a[e].childNodes,g=f.length,h=0;h<g;h++)1!=f[h].nodeType||"P"!=f[h].tagName&&"SPAN"!=f[h].tagName||("margin"==c?f[h].style.margin=d:("marginTop"==c&&(f[h].style.marginTop=
d),"marginBottom"==c&&(f[h].style.marginBottom=d),"marginLeft"==c&&(f[h].style.marginLeft=d),"marginRight"==c&&(f[h].style.marginRight=d)))}
function command_textIndent(a,b,c,d){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var e=getFirstRange().range;a=GetTableSelectionCells();b=a.length;if(0==b)for(a=getNodesInRange(e),null!=e.startContainer.previousSibling&&"HEAD"==e.startContainer.previousSibling.tagName&&null==e.endContainer.nextSibling&&(a=_iframeDoc.body.childNodes),b=a.length,e=0;e<b;e++)null==a[e].parentNode||"body"!=a[e].parentNode.nodeName.toLowerCase()&&"td"!=a[e].parentNode.nodeName.toLowerCase()&&"td"!=
a[e].parentNode.nodeName.toLowerCase()||"table"==a[e].tagName.toLowerCase()||"textIndent"!=c||(a[e].style.textIndent=d);else for(e=0;e<b;e++)for(var f=a[e].childNodes,g=f.length,h=0;h<g;h++)1!=f[h].nodeType||"P"!=f[h].tagName&&"SPAN"!=f[h].tagName||"textIndent"!=c||(f[h].style.textIndent=d)}
function command_imageAlign(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();getFirstRange();a=DEXTTOP.G_SELECTED_IMAGE_ELEMENT;""==c?a.removeAttribute("align"):a.setAttribute("align",c)}
function command_letterSpacing(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var d=getFirstRange().range;try{DEXTTOP.G_CURREDITOR.beforeOffset=[],DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startOffset),DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endOffset),3==d.startContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startContainer.parentNode):DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startContainer),3==d.endContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endContainer.parentNode):
(DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endContainer),1==d.endOffset&&(DEXTTOP.G_CURREDITOR.beforeOffset[1]=(d.endContainer.innerText||d.endContainer.textContent).length)),DEXTTOP.G_CURREDITOR.beforeOffset.push(d.toString().length)}catch(e){DEXTTOP.G_CURREDITOR.beforeOffset=null}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a="p span li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" ");var f=a.length,g,h,m=GetTableSelectionCells();if(0==m.length){if(null!=
d.startContainer.previousSibling&&"HEAD"==d.startContainer.previousSibling.tagName&&null==d.endContainer.nextSibling){for(b=0;b<f;b++){g=_iframeDoc.body.getElementsByTagName(a[b]);h=g.length;for(var q=0;q<h;q++)"span"==g[q].tagName.toLowerCase()?""!=g[q].style.letterSpacing&&(g[q].style.letterSpacing=c):g[q].style.letterSpacing=c}f=_iframeDoc.body.getElementsByTagName("table");g=f.length;for(b=0;b<g;b++){h=f[b].rows;for(var t=h.length,q=0;q<t;q++)for(var m=h[q].cells,d=m.length,u=0;u<d;u++)setBlockTag(m[u].childNodes,
a,"letterSpacing",c)}setBlockTag(_iframeDoc.body.childNodes,a,"letterSpacing",c);g=_iframeDoc.body.getElementsByTagName("div");h=g.length;for(q=0;q<h;q++)setBlockTag(g[q].childNodes,a,"letterSpacing",c)}else{g=getNodesInRange(d);h=g.length;1==d.collapsed&&0==d.getNodes().length&&d.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(m=0;m<h;m++)if(1==g[m].nodeType&&(u=g[m].tagName.toLowerCase(),-1<a.indexOf(u))){if("div"!=u)for(b=0;b<f;b++)for(var t=g[m].getElementsByTagName(a[b]),v=t.length,q=
0;q<v;q++)"span"==t[q].tagName.toLowerCase()?""!=t[q].style.letterSpacing&&(t[q].style.letterSpacing=c):t[q].style.letterSpacing=c;"span"==u?""!=g[m].style.letterSpacing&&(g[m].style.letterSpacing=c):g[m].style.letterSpacing=c}var w;0==d.toString().length&&1==d.getNodes().length&&(w=d.getNodes()[0],g.push(d.getNodes()[0]));setBlockTag(g,a,"letterSpacing",c)}(c=_iframeDoc.getElementById("_dextPosition"))?(doSetCaretPosition(c,1),c.parentNode.removeChild(c)):w&&(c=getFirstRange().range,getFirstRange().sel.removeAllRanges(),
c.selectNode(w),getFirstRange().sel.addRange(c))}else for(d=m.length,b=0;b<d;b++){for(q=0;q<f;q++)for(g=m[b].getElementsByTagName(a[q]),h=g.length,u=0;u<h;u++)"span"==g[u].tagName.toLowerCase()?""!=g[u].style.letterSpacing&&(g[u].style.letterSpacing=c):g[u].style.letterSpacing=c;setBlockTag(m[b].childNodes,a,"letterSpacing",c);g=m[b].getElementsByTagName("div");h=g.length;for(q=0;q<h;q++)setBlockTag(g[q].childNodes,a,"letterSpacing",c)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0;DEXTTOP.G_CURREDITOR.beforeOffset=null}function command_InsertOpenFile(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();b=c.data;"html"!=c.fileExt&&"htm"!=c.fileExt&&"txt"==c.fileExt&&(b=htmlSpecialChars(c.data),b=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,b));DEXTTOP.DEXT5.setHtmlContents(b,a)}
function command_InsertBlockquote(a,b,c){var d="";switch(c.tagvalue){case "1":d="margin:0 0 30px 20px;padding:0 8px;border-left:2px solid #999999";break;case "2":d="margin:0 0 30px 13px;padding:0 8px 0 16px;background:url("+DEXTTOP.G_CURREDITOR._config.webPath.image+"icon/img_blockquote02.gif)  0 3px no-repeat;";break;case "3":d="BORDER-TOP: #7a7d83 1px dashed; BORDER-RIGHT: #7a7d83 1px dashed; BORDER-BOTTOM: #7a7d83 1px dashed; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #7a7d83 1px dashed; PADDING-RIGHT: 10px;";
break;case "4":d="BORDER-TOP: #007ace 1px dashed; BORDER-RIGHT: #007ace 1px dashed; BORDER-BOTTOM: #007ace 1px dashed; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #007ace 1px dashed; PADDING-RIGHT: 10px;";break;case "5":d="BORDER-TOP: #7a7d83 1px dashed; BORDER-RIGHT: #7a7d83 1px dashed; background:#ebebeb; BORDER-BOTTOM: #7a7d83 1px dashed; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #7a7d83 1px dashed; PADDING-RIGHT: 10px";
break;case "6":d="BORDER-TOP: #7a7d83 1px solid; BORDER-RIGHT: #7a7d83 1px solid; BORDER-BOTTOM: #7a7d83 1px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #7a7d83 1px solid; PADDING-RIGHT: 10px;";break;case "7":d="BORDER-TOP: #007ace 1px solid; BORDER-RIGHT: #007ace 1px solid; BORDER-BOTTOM: #007ace 1px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #007ace 1px solid; PADDING-RIGHT: 10px;";
break;case "8":d="BORDER-TOP: #7a7d83 1px solid; BORDER-RIGHT: #7a7d83 1px solid; background:#ebebeb; BORDER-BOTTOM: #7a7d83 1px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #7a7d83 1px solid; PADDING-RIGHT: 10px";break;case "9":d="BORDER-TOP: #999 2px solid; BORDER-RIGHT: #999 2px solid; BORDER-BOTTOM: #999 2px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #999 2px solid; PADDING-RIGHT: 10px";
break;case "10":d="BORDER-TOP: #007ace 2px solid; BORDER-RIGHT: #007ace 2px solid; background:#ebebeb; BORDER-BOTTOM: #007ace 2px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #007ace 2px solid; PADDING-RIGHT: 10px"}dext_src_init(b);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;a=function(a){try{var b=getFirstRange(),c=b.range,f=c.startContainer,h=c.endContainer;
a&&(1!=f.nodeType||"TD"!=f.tagName&&"TH"!=f.tagName||(f=f.childNodes[c.startOffset]),1!=h.nodeType||"TD"!=h.tagName&&"TH"!=h.tagName||(h=h.childNodes[c.endOffset-1]));var m=GetParentbyTagName(f,"blockquote",!0),q=GetParentbyTagName(h,"blockquote",!0),t=m,u=!1;if(null!=m||null!=q)if(m==q)u=!0;else if(m!=q){var E=c.commonAncestorContainer;if(E&&E.tagName&&"blockquote"==E.tagName.toLowerCase())t=E;else{if(m)c.setStartBefore(m.firstChild);else{for(m=c.startContainer;!m.tagName;)m=m.parentNode;c.setStartBefore(m)}q||
(q=c.endContainer);for(;q.parentNode!=E;)q=q.parentNode;for(;m.parentNode!=E;)m=m.parentNode;t=_iframeDoc.createElement("blockquote");E.insertBefore(t,m);c.setStartAfter(t);c.setEndAfter(q);c.surroundContents(t);c.setStartBefore(t.firstChild);c.setEndAfter(t.lastChild);b.sel.removeAllRanges();b.sel.addRange(c)}u=!0}if(u)t.style.cssText=d;else{q=!1;c&&1==c.collapsed&&f==h&&f.tagName&&"p"==f.tagName.toLowerCase()&&"<br>"==f.innerHTML&&(f.innerHTML=unescape("%u200B"),q=!0);var H=getParentbyTagNameEx(f,
"ol,ul"),M=getParentbyTagNameEx(h,"ol,ul");if(H||M){H&&(H=e(H,"ol,ul"),c.setStartBefore(H));M&&(M=e(M,"ol,ul"),c.setEndAfter(M));for(var N=_iframeDoc.createElement("blockquote"),I=c.extractContents();I.firstChild;)N.appendChild(I.firstChild);c.insertNode(N);c.setStartBefore(N.firstChild);c.setEndAfter(N.lastChild);b.sel.removeAllRanges();b.sel.addRange(c)}else _iframeDoc.execCommand("indent",!1,null);if(q){var S=getFirstRange().range,F=S.startContainer;if(3==F.nodeType)F=F.parentNode;else if("TD"==
F.tagName||"TH"==F.tagName)F=F.getElementsByTagName("p")[0];F&&"P"==F.tagName&&F.innerHTML==unescape("%u200B")&&(F.innerHTML="<br>")}if(a)for(var O=a.getElementsByTagName("blockquote"),P=O.length,J=0;J<P;J++)O[J].style.cssText=d;else{S=getFirstRange().range;0==!!S&&(S=g);for(var J=getNodesInRange(S),L=J.length,O=0;O<L;O++)if("blockquote"==J[O].nodeName.toLowerCase()){J[O].style.cssText=d;break}}}}catch(K){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};var e=function(a,b){for(var c=a;;){var d=
getParentbyTagNameEx(c.parentNode,b);if(d)c=d;else break}return c};b=GetTableSelectionCells();c=b.length;if(0<c)for(var f=getFirstRange(),g=f.range,h=g.cloneRange(),m=0;m<c;m++){f.sel.removeAllRanges();var q=getMyFirstOrLastChildElementNode(b[m],!1),t=getMyFirstOrLastChildElementNode(b[m],!0);if(null==q&&null==t){var u=_iframeDoc.createElement("p");u.innerHTML="<br>";t=q=u;b[m].appendChild(u)}q&&t&&(g.setStartBefore(q),g.setEndAfter(t),f.sel.addRange(g),a(b[m]),f.sel.removeAllRanges(),f.sel.addRange(h))}else a();
DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_CancelBlockquote(a,b){dext_src_init(b);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;var c=getFirstRange(),d=c.range,e=function(a){for(;0<a.childNodes.length;)a.parentNode.insertBefore(a.childNodes[0],a);null!=a.previousSibling&&doSetCaretPosition(a.previousSibling,1);a.parentNode.removeChild(a)},f=function(a){if(a){a=a.getElementsByTagName("blockquote");for(var b=a.length-1;0<=b;b--)e(a[b])}else(a=GetParentbyTagName(d.startContainer,
"blockquote",!0))&&e(a)},g=GetTableSelectionCells(),h=g.length;if(0<h)for(c=getFirstRange(),c=0;c<h;c++)f(g[c]);else f();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_inputSameWidthHeight(a,b,c){"1"==b._config.formMode&&(dext_src_init(b._EDITOR.design),restoreSelection(),setFocusToBody(),"width"==c?d5ApplySameWidth():"height"==c?d5ApplySameHeight():"widthheight"==c&&d5ApplySameWidthHeight(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_setAccessibility(a,b,c,d,e){dext_src_init(b);a=!1;if(c.idSamMode)c.id!=c.sameOrgId&&(d.setAttribute("id",c.id),a=!0);else if(b=null,a=d.getAttribute("dext5customdata"),null!=a&&void 0!=a&&(b=getDextCustomData(a)),c.skip)d.setAttribute("dext5webaccskip","dext5webaccskip"),a=!0;else{d.removeAttribute("dext5webaccskip");a=!1;var f=d.tagName.toLowerCase();if(-1<"frame,framset,a".indexOf(f)||b&&("iframe"==b.type||"iframe"==b.type2))b?b.title=c.title:d.title=c.title,""!=c.title&&(a=!0);
else if("table"==f){if(-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("table_caption")||""==DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems)if(d.caption)if(""==c.title){b=0;for(var f=d.childNodes.length,g=0;g<f;g++)if(d.childNodes[g].nodeName.match(/caption/i)){b=g;break}d.removeChild(d.childNodes[b])}else d.caption.innerHTML=c.title,a=!0;else""!=c.title&&(a=_iframeDoc.createElement("caption"),a.innerHTML=c.title,d.insertBefore(a,d.firstChild),a=!0);else a=!0;a=a&&
""!=c.alt?!0:!1;if(-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("table_summary")||""==DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems)d.summary=c.alt}else""!=c.alt&&(a=!0),d.alt=c.alt}c=_iframeDoc.createElement("img");c.alt="web_accessibility_ok";c.src="../images/editor/dialog/check01.png";c.name="chkImg";d=e.getElementsByTagName("img");b=e.getElementsByTagName("div");a?0<b.length&&("chkImg"!=d[0].name&&e.insertBefore(c,b[0]),b[0].style.display="none"):("chkImg"==
d[0].name&&e.removeChild(d[0]),0<b.length&&(b[0].style.display=""));onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0});onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"accessibility_validation"})}
function command_calculationFormula(a,b,c){b=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);if(null!=b){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d;switch(c){case "horizontal_sum":case "horizontal_avg":case "horizontal_mul":case "horizontal_sub":case "horizontal_div":d=getLeftHorizontalCells(b);break;case "vertical_sum":case "vertical_avg":case "vertical_mul":case "vertical_sub":case "vertical_div":d=getTopVerticalCells(b)}for(var e=d.length,f=a=0,g=!1,
h=!0,m=0;m<e;m++){var q=d[m].innerHTML,q=q.replace(/\r/g,""),q=q.replace(/[\n|\t]/g,""),q=q.replace(/[\v|\f]/g,""),q=q.replace(/<p><br><\/p>/gi,"\n"),q=q.replace(/<P>&nbsp;<\/P>/gi,"\n"),q=q.replace(/<br(\s)*\/?>/gi,"\n"),q=q.replace(/<br(\s[^\/]*)?>/gi,"\n"),q=q.replace(/<\/p(\s[^\/]*)?>/gi,"\n"),q=q.replace(/<\/li(\s[^\/]*)?>/gi,"\n"),q=q.replace(/<\/tr(\s[^\/]*)?>/gi,"\n");nIdx=q.lastIndexOf("\n");-1<nIdx&&"\n"==q.substring(nIdx)&&(q=q.substring(0,nIdx));q=removeStripTags(q,null);q=unhtmlSpecialChars(q);
-1<q.indexOf(",")&&(g||(g=!0),q=q.replace(/,/gi,""));if(!isNaN(Number(q))&&""!=q){if(h)if(-1<c.indexOf("_mul"))a=1;else if(-1<c.indexOf("_sub")||-1<c.indexOf("_div")){a=q;f++;h=!1;continue}if(-1<c.indexOf("_sum")||-1<c.indexOf("_avg"))a=command_NumCal(a,q,"+");else if(-1<c.indexOf("_mul"))a=command_NumCal(a,q,"*");else if(-1<c.indexOf("_sub"))a=command_NumCal(a,q,"-");else if(-1<c.indexOf("_div")){if(0==q){a="#Div/0!";break}a=command_NumCal(a,q,"/")}f++;h=!1}}if("horizontal_avg"==c||"vertical_avg"==
c)a=command_NumCal(a,f,"/");a||(a=0);a=a.toString();g&&(a=-1<a.indexOf(".")?fnCommaExec(a.substring(0,a.indexOf(".")))+a.substring(a.indexOf("."),a.length):fnCommaExec(a));var t=null;if(null==b.firstChild)t=_iframeDoc.createElement("p"),t.innerHTML=a,b.innerHTML="",b.appendChild(t);else{for(t=b.firstChild;null!=t&&void 0!=t;)if(3==t.nodeType)if(c=t.nodeValue,c=c.replace(/\r\n/g,""),c=c.replace(/\n/g,""),c=c.replace(/\r/g,""),c=c.replace(/\t/g,""),c=c.replace(/ /g,""),c=c.replace(/\s/g,""),c=c.replace(/&nbsp;/g,
""),""==c&&null!=t.nextSibling)t=t.nextSibling;else{t=t.parentNode;break}else if(1==t.nodeType)if("IMG"==t.tagName||"BR"==t.tagName||"TABLE"==t.tagName||"HR"==t.tagName||"A"==t.tagName){t=t.parentNode;break}else if(c=t.innerHTML,c=c.replace(/&nbsp;/g," "),t.innerHTML=c,t.firstChild){if(t&&"TD"!=t.tagName&&"TH"!=t.tagName)for(;t.nextSibling;)t.parentNode.removeChild(t.nextSibling);t=t.firstChild}else break;else break;t.innerHTML=a}setTimeout(function(){doSetCaretPosition(t,1)},10);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}
function command_NumCal(a,b,c){if(isNaN(Number(a))||isNaN(Number(b)))return!1;var d,e,f;e=/\./;e.test(a)?(a=a.toString(),d=a.split("."),d=d[1].length):d=0;e.test(b)?(b=b.toString(),e=b.split("."),e=e[1].length):e=0;d=d>e?d:e;e="1";for(var g=1;g<=d;g++)e+="0";switch(c){case "+":f=Math.round(Number(a)*e+Number(b)*e)/e;break;case "/":f=Number(a)/Number(b);break;case "-":f=Math.round(Number(a)*e-Number(b)*e)/e;break;case "*":f=Math.round(a*e*b*e)/(e*e),f=Number(f.toFixed(12))}return f}
function command_tableSelection(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(a=getFirstRange().range){if(!c){c=GetTDTHCell(a.startContainer);if(null==c||void 0==c)return;c=GetParentbyTagName(c,"table");if(null==c)return}if(getApplyDragResize(b))DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear(),DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem=c,clearInterval(DEXTTOP.G_CURREDITOR.dext_dragresize.dextResizeIconInterval),DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,
!1,null);else{b=_iframeDoc.body.createControlRange();try{ClearDraggingTableCellSelected(),b.add(c),b.select(),DEXTTOP.G_SELECTED_ELEMENT=c,setMenuIconRealable(c),_iframeDoc_MouseUpMenu(null,c)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}}
function command_showBlocks(a,b){document.getElementById("ue_editor_holder_"+a);if(""==DEXTTOP.G_CURREDITOR.ShowBlocks){var c=DEXTTOP.G_CURREDITOR._config.webPath.css;DEXTTOP.DEXT5.isRelease||(c=DEXTTOP.G_CURREDITOR._config.webPath.css_dev);DEXTTOP.DEXT5.addUserCssUrl(c+"editor_showblocks.css?t="+DEXTTOP.DEXT5.UrlStamp);DEXTTOP.G_CURREDITOR.ShowBlocks="show_blocks"}else{for(var c=b._DOC.getElementsByTagName("link"),d=null,e=c.length-1;0<=e;e--)-1<c[e].href.indexOf("editor_showblocks.css")&&(d=c[e],
d.parentNode.removeChild(d));DEXTTOP.G_CURREDITOR.ShowBlocks=""}c=[];"show_blocks"==DEXTTOP.G_CURREDITOR.ShowBlocks?c.push("show_blocks"):removeArrayItemByValue(c,"show_blocks");DEXTTOP.G_CURREDITOR._iconSelected(c)}
function command_tableLock(a,b){var c=getFirstRange().range.startContainer;3==c.nodeType&&(c=c.parentNode);var d=getSelectionTable(b);if(d)if(checkLockAttr(d,!0))removeLockAttr(d),removeClassName(d,"DEXT_five_table_lock");else{var e=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultLockName,f=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultTableLockMode,g=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultShowLockIconUserMode;setClassName(d,"DEXT_five_table_lock");d.setAttribute(e,"");d.setAttribute("lock_mode",
f);d.setAttribute("show_icon",g)}else{e=GetTableSelectionCells();f=e.length;g=GetTDTHCell(c);if(0<f)d=GetParentbyTagName(e[0],"table");else{if(null==g||"TD"!=g.tagName&&"TH"!=g.tagName)return;d=GetParentbyTagName(g,"table")}d&&(checkLockAttr(d,!0)?(removeLockAttr(d),removeClassName(d,"DEXT_five_table_lock")):(e=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultLockName,f=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultTableLockMode,g=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultShowLockIconUserMode,
setClassName(d,"DEXT_five_table_lock"),d.setAttribute(e,""),d.setAttribute("lock_mode",f),d.setAttribute("show_icon",g)))}c&&1==c.nodeType&&setMenuIconRealable(c)}
function command_cellLock(a,b){var c=GetTableSelectionCells(),d=c.length,e=getFirstRange().range.startContainer;3==e.nodeType&&(e=e.parentNode);currElem=GetTDTHCell(e);if(0<d){var f=!1;checkLockAttr(c[0],!0)&&(f=!0);for(var g=0;g<d;g++)f?(removeLockAttr(c[g]),removeClassName(c[g],"DEXT_five_cell_lock")):(c[g].setAttribute("dext_lock",""),setClassName(c[g],"DEXT_five_cell_lock"))}else{if(null==currElem||"TD"!=currElem.tagName&&"TH"!=currElem.tagName)return;checkLockAttr(currElem,!0)?(removeLockAttr(currElem),
removeClassName(currElem,"DEXT_five_cell_lock")):(currElem.setAttribute("dext_lock",""),setClassName(currElem,"DEXT_five_cell_lock"))}e&&1==e.nodeType&&setMenuIconRealable(e)}
function command_help(){var a="ko";"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(a="en");var a=DEXTTOP.G_CURREDITOR._config.webPath.help+"index_"+a+".html",b=1200,c=screen.availHeight,d=40;DEXTTOP.DEXT5.browser.ie?d=40:DEXTTOP.DEXT5.browser.chrome?d=70:DEXTTOP.DEXT5.browser.gecko?d=40:DEXTTOP.DEXT5.browser.opera?d=80:DEXTTOP.DEXT5.browser.safari&&(d=100);var e=screen.availHeight;e<=c&&(c=e-d);try{b>parseInt(screen.width,10)&&(b=parseInt(screen.width,10)-50)}catch(f){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}d=0;try{d=screen.width/2-b/2}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var h=DEXTTOP.DEXTWIN.open(a,"DEXT5Help","width="+b+","+("height="+c)+","+("left="+d+"px")+",top=0px,resizable=yes");setTimeout(function(){h.focus()},100)}
function command_wordTransform(a,b){if(G_dext5plugIn){setImageSizeForProperty();var c=_iframeDoc.getElementsByTagName("head")[0].getElementsByTagName("style")[0],d="";if(c){var d=c.innerHTML,e=d.replace("margin:0px 10px 10px 10px;","").replace("MARGIN: 0px 10px 10px","").replace("margin:10px;","").replace("MARGIN: 10px","");if(c.styleSheet){c.styleSheet.cssText=e;try{c.innerHTML=e}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else c.innerHTML=e}e=DEXTTOP.DEXT5.getHtmlValueEx(a);
if("/"==DEXTTOP.G_CURREDITOR._config.serverDomain){var e=DEXTTOP.DEXT5.util.splitBodyInnerString(e),g=_iframeDoc.createElement("div");g.innerHTML=e.body;for(var h=g.getElementsByTagName("img"),m=0;m<h.length;m++){var q=h[m];q.src=q.src}e=e.head+g.innerHTML+e.tail}if(c)if(c.styleSheet){c.styleSheet.cssText=d;try{c.innerHTML=d}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else c.innerHTML=d;/<div.*class=.*DEXT_fiVe_Page_Break.*/gi.test(e)&&(c=null,c=RegExp("<div .*class=DEXT_fiVe_Page",
"gi").test(e)?RegExp("<div[^>]*class=DEXT_fiVe_Page*.+?<\\/div>","gi"):RegExp("<div[^>]*class=[\"']DEXT_fiVe_Page*.+?<\\/div>","gi"),e=e.replace(c,'<p><br clear="all" style="page-break-before: always;"></p>'));c=G_dext5plugIn.getHTMLValueFromApplication(e,0);""!=c&&(c=externalPageBreakDataRaplaceInEditor(c),DEXTTOP.DEXT5.setBodyValue(c,a))}}
function command_InsertMiniPhotoEditor(a,b,c){if("1"==DEXTTOP.G_CURREDITOR._config.useMiniImageEditor){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var d=DEXTTOP.DEXTWIN;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(d=DEXTTOP.G_CURREDITOR.dialogWindow);d.KMINIPHOTO&&1==d.KMINIPHOTO.miniPhotoCreation?show_MiniPhotoEditor(a,b,c):create_MiniPhotoEditor(a,b,c)}}
function create_MiniPhotoEditor(a,b,c){try{if("1"==DEXTTOP.G_CURREDITOR._config.useMiniImageEditor){var d=DEXTTOP.DEXTWIN;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(d=DEXTTOP.G_CURREDITOR.dialogWindow);if(null==d.document.getElementById("k_mini_photo")){miniPhotoCallback=function(){d.KMINIPHOTO.isRelease=DEXTTOP.DEXT5.isRelease;new d.KMINIPhoto({Id:"kminiphoto",Lang:DEXTTOP.G_CURREDITOR._config.lang,PhotoHolder:"k_mini_photo",ZIndex:DEXTTOP.G_CURREDITOR._config.zIndex+5E3,AutoDestroy:DEXTTOP.G_CURREDITOR._config.autoDestroy.use,
Width:DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.width,Height:DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.height,BackgroundColor:DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.backgroundColor,BackgroundOpacity:DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.backgroundOpacity,AutoSetZoom:DEXTTOP.G_CURREDITOR._config.autoSetZoom,MaxImageFileSize:DEXTTOP.G_CURREDITOR._config.maxImageFileSize,MaxTotalFileSize:DEXTTOP.G_CURREDITOR._config.maxTotalFileSize,Direction:{Ui:DEXTTOP.G_CURREDITOR._config.direction.ui},
CreationCompleteEvent:function(){d.KMINIPHOTO.miniPhotoCreation=!0}})};var e=d.document.createElement("div");e.id="k_mini_photo";e.style.display="none";d.document.body.appendChild(e);var f=d.document.getElementsByTagName("head")[0],g=d.document.createElement("script");g.type="text/javascript";var h=!1;g.onreadystatechange=function(){"loaded"!=this.readyState&&"complete"!=this.readyState||h||(h=!0,miniPhotoCallback())};g.onload=function(){h||(h=!0,miniPhotoCallback())};g.src=DEXTTOP.DEXT5.isRelease?
DEXTTOP.DEXT5.rootPath+"imageEdit/js/kminiphoto.js":DEXTTOP.DEXT5.rootPath+"imageEdit/js_dev/kminiphoto.js";f.appendChild(g)}}}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}d=DEXTTOP.DEXTWIN;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(d=DEXTTOP.G_CURREDITOR.dialogWindow);if(d.KMINIPHOTO&&1==d.KMINIPHOTO.miniPhotoCreation)show_MiniPhotoEditor(a,b,c);else var q=setInterval(function(){d.KMINIPHOTO&&d.KMINIPHOTO.miniPhotoCreation&&(clearInterval(q),show_MiniPhotoEditor(a,b,c))},1E3)}
function show_MiniPhotoEditor(a,b,c){a=function(a){var c;a?(0==a.toLowerCase().indexOf("file://")&&G_dext5plugIn&&(a=G_dext5plugIn.getBase64ImageFromLocalImage(a)),b.miniPhotoLastMode="modify",c={url:a,width:DEXTTOP.G_SELECTED_IMAGE_ELEMENT.clientWidth,height:DEXTTOP.G_SELECTED_IMAGE_ELEMENT.clientHeight,dialogWindow:b.dialogWindow?b.dialogWindow:null,completeEvent:kMiniPhotoComplete,addedTotalFileSize:b.addedTotalFileSize}):(b.miniPhotoLastMode="new",c={url:null,width:"",height:"",dialogWindow:b.dialogWindow?
b.dialogWindow:null,completeEvent:kMiniPhotoComplete,addedTotalFileSize:b.addedTotalFileSize,parentEditor:b});var f=getDialogWindow();setTimeout(function(){isFixedEditorPosition({editor:DEXTTOP.G_CURREDITOR})&&(f.KMINIPHOTO.util._getKMiniPhotoByName("kminiphoto")._config.useFixedPositionToDialog="1");DEXTTOP.DEXT5.isClickedMiniPhoto=!1;f.KMINIPHOTO.ShowPhotoPopup(c)},20)};c?DEXTTOP.G_SELECTED_IMAGE_ELEMENT&&"IMG"==DEXTTOP.G_SELECTED_IMAGE_ELEMENT.tagName&&(c=DEXTTOP.G_SELECTED_IMAGE_ELEMENT.src,a(c)):
(c=getFirstRange().range,c.startOffset==c.endOffset&&1==c.collapsed?a(null):DEXTTOP.G_SELECTED_IMAGE_ELEMENT&&"IMG"==DEXTTOP.G_SELECTED_IMAGE_ELEMENT.tagName&&(c=DEXTTOP.G_SELECTED_IMAGE_ELEMENT.src,a(c)))}
function command_InsertImagePhotoEdit(a,b){var c=DEXTTOP.G_CURREDITOR._config.photoEditorId;null!=DEXTTOP.G_CURREDITOR.dialogWindow?""!=c?DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup(c):DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup():""!=c?(DEXTTOP.DEXT5PHOTO.ShowPopup(c),DEXTTOP.DEXT5PHOTO.Reset(c),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!0,c)):(DEXTTOP.DEXT5PHOTO.ShowPopup(),DEXTTOP.DEXT5PHOTO.Reset(),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!0))}
function kMiniPhotoComplete(a,b){dext_src_init(DEXTTOP.G_CURREDITOR._EDITOR.design);restoreSelection();setFocusToBody();var c=b.src;if(G_dext5plugIn){if("base64"!=DEXTTOP.G_CURREDITOR._config.uploadMethod){var d="jpg";try{if("data:"==c.substring(0,5)){var e=c.split(",");2==e.length&&(d=getExtFromImageDataSrc(e[0]))}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}c=G_dext5plugIn.getLocalImageFromBase64Image(c,d)}"new"==DEXTTOP.G_CURREDITOR.miniPhotoLastMode?(d=_iframeDoc.createElement("img"),
d.src=c,d.alt="",c=getFirstRange().range,c.deleteContents(),c.collapse(!0),c.pasteHtml(d.outerHTML),c.collapse(!1)):(DEXTTOP.G_SELECTED_IMAGE_ELEMENT.src=c,DEXTTOP.G_SELECTED_IMAGE_ELEMENT.style.width=b.width,DEXTTOP.G_SELECTED_IMAGE_ELEMENT.style.height=b.height)}else e=c.split(","),2==e.length&&(d=getExtFromImageDataSrc(e[0])),"new"==DEXTTOP.G_CURREDITOR.miniPhotoLastMode?postBase64ImageToServer(e[1],d,null,!0):(postBase64ImageToServer(e[1],d,DEXTTOP.G_SELECTED_IMAGE_ELEMENT,!0),DEXTTOP.G_SELECTED_IMAGE_ELEMENT.style.width=
b.width,DEXTTOP.G_SELECTED_IMAGE_ELEMENT.style.height=b.height);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;if(0<DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.imgTagRemoveAttribute.length&&null!=DEXTTOP.G_SELECTED_IMAGE_ELEMENT)for(c=DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.imgTagRemoveAttribute.length,d=0;d<c;d++)DEXTTOP.G_SELECTED_IMAGE_ELEMENT.removeAttribute(DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.imgTagRemoveAttribute[d]);try{contentChangeEventWrapper()}catch(g){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0})}
function command_photoEditProperty(a,b){if(null!=DEXTTOP.G_SELECTED_ELEMENT){var c=DEXTTOP.G_CURREDITOR._config.photoEditorId;null!=DEXTTOP.G_CURREDITOR.dialogWindow?""!=c?(DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup(c),DEXTTOP.DEXTWIN.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src,c),DEXTTOP.DEXTWIN.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!1,c)):(DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup(),DEXTTOP.DEXTWIN.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src),DEXTTOP.DEXTWIN.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,
!1)):""!=c?(DEXTTOP.DEXT5PHOTO.ShowPopup(c),DEXTTOP.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src,c),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!1,c)):(DEXTTOP.DEXT5PHOTO.ShowPopup(),DEXTTOP.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!1))}}
function command_showTableBorder(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=_iframeDoc.body.getElementsByTagName("table"),d=c.length,e=[];if(1==DEXTTOP.G_CURREDITOR.ShowTableBorder){for(var f=0;f<d;f++)removeClassName(c[f],"DEXT_tableborder");removeArrayItemByValue(e,"table_border");DEXTTOP.G_CURREDITOR.ShowTableBorder=!1}else{for(f=0;f<d;f++)checkExistClassName(c[f].className,"DEXT_tableborder")||setClassName(c[f],"DEXT_tableborder");e.push("table_border");DEXTTOP.G_CURREDITOR.ShowTableBorder=
!0}DEXTTOP.G_CURREDITOR._iconSelected(e)}function command_pasteToImage(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();-1<c.type.indexOf("image")?b.bTextorHtmlData=!1:b.bTextorHtmlData=!0;command_pasteHtml5(b,c)}
function command_pasteHtml5(a,b){var c=a.clipData,d=a.pasteEvt;if(DEXTTOP.G_CURREDITOR.setTextPaste)for(var e="span font strong i em u strike s sub sup".split(" "),f=e.length,c=c.replace(/<b>/gi,""),c=c.replace(/<b ([^>?+])*>/gi,""),c=c.replace(/<\/b>/gi,""),g=0;g<f;g++)var h=new RegExp("</"+e[g]+">","gi"),c=c.replace(new RegExp("<"+e[g]+" *([^>?+])*>","gi"),""),c=c.replace(h,"");c=dummyTagClassClear(c);if(a.bTextorHtmlData)0<c.length&&(c=SetCorrectOfficeHtml(c),command_pasteHtml5_After_quality(c,
a,G_wordProcessorType));else if("0"==a._config.paste_image_base64_remove&&(1>DEXTTOP.G_CURREDITOR._config.imageQuality.quality?setPasteImageFromClipboard_quality(d,b,setPasteImageFromClipboard):setPasteImageFromClipboard(d,b)),0==DEXTTOP.DEXT5.browser.ie)a.UndoManager.putUndo(),a.UndoManager.charCount=0,DEXTTOP.DEXT5.util.cancelEvent(d),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(a){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},500);else return!0}
function command_pasteHtml5_After_quality(a,b,c){var d=document.createElement("div");d.innerHTML=a;for(var e=d.getElementsByTagName("img"),f=e.length,g=!1,h=!1,m=0;m<f;m++){if(-1<e[m].src.indexOf("file:///")){g=!0;break}if(-1<e[m].src.toLowerCase().indexOf("http://")||-1<e[m].src.toLowerCase().indexOf("https://")){h=!0;break}}for(m=0;m<f;m++)if(!g&&!h){var q=e[m].src.split(";")[0].replace("data:image/",""),q=DEXTTOP.DEXT5.util.makeGuid()+"."+q;DEXTTOP.G_CURREDITOR._FRAMEWIN.G_Base64FileNameMap[e[m].src]=
q;DEXTTOP.G_CURREDITOR._FRAMEWIN.G_OriginalMultiImageSize_src[q]={width:e[m].width,height:e[m].height}}if(1>DEXTTOP.G_CURREDITOR._config.imageQuality.quality&&0<f&&!g&&!h&&"0"==DEXTTOP.G_CURREDITOR._config.plugInUse){showProcessingBackground();for(m=0;m<f;m++){g=DEXTTOP.DEXT5.util.makeGuid();q=e[m].src.split(";")[0].replace("data:image/","");h=e[m].src;-1<h.indexOf("data:image/"+q+";base64,")&&(h=h.replace("data:image/"+q+";base64,",""));var t=3*Math.ceil(h.length/4);"=="==h.substr(h.length-2,2)&&
(t-=2);t=imageQualityBool(t,q);G_QualityFileObj.push({beforeRawData:h,originalExtension:q,originalFileName:g,idx:m,changeBool:t})}DEXTTOP.DEXT5.util.cancelEvent(DEXTTOP.G_CURREDITOR.pasteEvt);DEXTTOP.DEXT5.browser.WorkerSupported&&"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?changeImageQuality():changeImageQualityWithoutWorker();var u=setInterval(function(){if(G_CompleteImageQuality){for(var g=0;g<f;g++)DEXTTOP.G_CURREDITOR._FRAMEWIN.G_Base64FileNameMap[e[g].src]&&(DEXTTOP.G_CURREDITOR._FRAMEWIN.G_Base64FileNameMap[G_QualityFileObj[g].afterRawData]=
DEXTTOP.G_CURREDITOR._FRAMEWIN.G_Base64FileNameMap[e[g].src],delete DEXTTOP.G_CURREDITOR._FRAMEWIN.G_Base64FileNameMap[e[g].src]),e[g].src=G_QualityFileObj[g].afterRawData;clearInterval(u);G_QualityFileObj=[];G_changeCount=0;G_CompleteImageQuality=!1;hideProcessingBackground();command_pasteHtml5_After(a,b,c,d)}},300)}else command_pasteHtml5_After(a,b,c)}
function command_pasteHtml5_After(a,b,c,d){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();"undefined"==typeof b&&(b=DEXTTOP.G_CURREDITOR);"undefined"!=typeof c&&""!=c&&(G_wordProcessorType=c);"HWP"==c&&(a=handlingSpacingTableInHwp(a));var e=function(){a=SetCorrectOfficeHtmlForDOM(a);a=execReplaceMsoStyle(a);"1"==b._config.useHtmlCorrection&&(a=htmlTagRevision(a,!0));a=removeTagStyle(a);a=repairPasteTextInCell(a);0<b.UndoManager.charCount&&(b.UndoManager.putUndo(),
b._iconEnable(""));var c=DEXTTOP.DEXT5.util.officeClean(a,!1),c=OfficePasteClean(c);"PPT"!=G_wordProcessorType&&(c=DEXTTOP.DEXT5.util.emptyTagRemove(c));c=DEXTTOP.DEXT5.util.htmlRevision(c);c=xssReplaceScript(null,c);c=b._FRAMEWIN.DEXT5_EDITOR.HTMLParser.RemoveOfficeTag2(c);"1"==b._config.ie_BugFixed_Hyfont&&(c=DEXTTOP.DEXT5.util.replaceHyFont(c,b));var c=replaceFontFamilyInHtml(c,b),c=adjustSizeInContainer({strHtml:c}),d=!1;if("base64"==b._config.uploadMethod&&c&&""!=c&&"-1"!=b._config.maxImageBase64fileCount){var e=
getBase64ImageCountEx(c);0<e&&getBase64ImageCount()+e>parseInt(b._config.maxImageBase64fileCount,10)&&(d=dext5_lang.msg.max_base64file_count,d=d.replace("{0}",b._config.maxImageBase64fileCount),alert(d),d=!0)}c=removeEditorAttribute(c);"HWP"==G_wordProcessorType&&(c=replaceCharToWingdings(c),c=handlingFontFamilyInHwp(c));"1"==b._config.removeAppleInterchangeNewlineBr&&(c=c.replace(/<br class="Apple-interchange-newline">/gi,""));"1"==b._config.compatibility.dingBatCharPaste&&(c=dingBatFont(c,b));if(!d){try{for(var f in G_DEPlugin)if("function"===
typeof G_DEPlugin[f].onBeforePaste){var g=G_DEPlugin[f].onBeforePaste({html:c});if("string"==typeof g)c=g;else if(!1===g)return}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{if("function"===typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event||"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste){g=c;try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.beforePaste?g=DEXTTOP.G_CURREDITOR._config.event.beforePaste(c):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event&&
(g=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(c))}catch(m){g=c}if(g)c=g;else if(0==g||""==g){DEXTTOP.DEXT5.util.cancelEvent(b.pasteEvt);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(!pasteWordCount(c)){DEXTTOP.DEXT5.util.cancelEvent(b.pasteEvt);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}-1<c.indexOf("dext5customdata")&&(c=checkExistCustomData(c));
c=externalPageBreakDataRaplaceInEditor(c);d=GetTableSelectionCells();g=document.createElement("div");g.innerHTML=c;e=g.childNodes;if(1==e.length&&e[0].tagName&&"table"==e[0].tagName.toLowerCase()&&0<d.length)command_tablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,e[0]);else{var t=getFirstRange().range,d=null,u=!1;if(t.startContainer==t.endContainer){var v=t.startContainer;3==v.nodeType&&(v=v.parentNode);d=GetTDTHCell(v);null===d&&(d=(v=GetParentbyTagName(v,"div"))||d,u=!!v)}v=!1;"1"==DEXTTOP.G_CURREDITOR._config.useTablePasteDialog&&
d&&!u&&1==e.length&&e[0].tagName&&"table"==e[0].tagName.toLowerCase()&&(v=!0);if(v)DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode=e[0],DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml=c,DEXTTOP.G_CURREDITOR.pasteTableParam.currCellNode=d,DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode=GetParentbyTagName(d,"table"),null!=dragPopup&&0!=(dragPopup&&"none"!=dragPopup.style.display)||DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.paste_table);
else{var N=e=!1,I;if(I=d&&t.startOffset==t.endOffset){I=!1;u=u?d:GetParentbyTagName(d,"table");1<g.getElementsByTagName("p").length&&""==u.style.fontSize?(N=DEXTTOP.DEXT5.util.getStyle(u,"fontSize"),u.style.fontSize=N,I=N=!0):1<g.getElementsByTagName("p").length&&""!=u.style.fontSize?I=!0:3==t.startContainer.nodeType?I=!1:1==t.startContainer.nodeType&&0==t.startOffset&&"P"==t.startContainer.nodeName&&1==t.startContainer.childNodes.length&&(1!=t.startContainer.childNodes[0].nodeType||"BR"!=t.startContainer.childNodes[0].nodeName&&
"SPAN"!=t.startContainer.childNodes[0].nodeName||(I=!0));for(t=u.parentNode;t&&"BODY"!=t.tagName;){if("P"==t.tagName){I=!1;break}t=t.parentNode}I=!I}I&&(e=!0);e||(e=/<h[0-9]/i.test(c));if(!e)for(u=g.getElementsByTagName("a"),I=!1,t=0;t<u.length;t++){for(var S=u[t].getElementsByTagName("span"),F=0;F<S.length;F++)""!=S[F].style.textDecoration&&(I=e=!0);if(I)break}if(e||DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion||"TEXT"==G_wordProcessorType)pasteHtmlAtCaretHuge(c,!1,!1,!0);else{"1"==
DEXTTOP.G_CURREDITOR._config.pasteWhenTableIsLast&&g.lastChild&&1==g.lastChild.nodeType&&"TABLE"==g.lastChild.tagName&&(c+="<p><br></p>");_iframeDoc.execCommand("inserthtml",!1,c);g=GetParentbyTagName(d,"table");N&&g&&(g.style.fontSize="");adjustTableAfterPaste(DEXTTOP.G_CURREDITOR);try{for(f in G_DEPlugin)if("function"===typeof G_DEPlugin[f].onAfterPaste)G_DEPlugin[f].onAfterPaste({})}catch(O){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}"function"===typeof _dext_editor._config.event.afterPaste?
_dext_editor._config.event.afterPaste({},_dext_editor.ID):"function"===typeof DEXTTOP.DEXTWIN.dext_after_paste_event&&DEXTTOP.DEXTWIN.dext_after_paste_event({},_dext_editor.ID)}}}if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)for(f=getElementsByClass("raon_placeholder",_iframeDoc.body,"span"),g=f.length,t=0;t<g;t++)f[t].getAttribute("contentEditable")||f[t].setAttribute("contentEditable","true");checkPasteImage(c);if(f=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),
rangy.getSelection(_iframeWin).addRange(f);0>c.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),b._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1),ClearDraggingTableAllTable())}"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();G_wordProcessorType="";"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal&&findDiagonal(_iframeDoc.body)&&(G_DEXT_Diagonal.setResizeForDiagonal(),G_DEXT_Diagonal.util.replaceEmptySpaceInDiagonal(),
-1<a.indexOf("diagonal")&&!1===v&&DEXTTOP.DEXT5.util.openModal(document,dext5_lang.msg.dext_diagonal_warning,DEXTTOP.G_CURREDITOR._config.diagonal.useNotification));if(0==DEXTTOP.DEXT5.browser.ie){b.UndoManager.putUndo();b.UndoManager.charCount=0;DEXTTOP.DEXT5.util.cancelEvent(b.pasteEvt);try{contentChangeEventWrapper()}catch(P){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else return!0};if(0==DEXTTOP.DEXT5.browser.ie)try{if(RegExp("<img[^>]+data:[^>]+>","gi").test(a)){d||(d=document.createElement("div"),
d.innerHTML=a);var f=d.getElementsByTagName("img"),g=f.length,h=[],m=[];if(0!=DEXTTOP.G_CURREDITOR._config.maxImageFileSize||0!=DEXTTOP.G_CURREDITOR._config.maxTotalFileSize){c=null;for(var q=0,t=g-1;0<=t;t--)(c=f[t],checkMaxImageFileSize(c.src))?0!=DEXTTOP.G_CURREDITOR._config.maxTotalFileSize&&(h.push(c),m.push(c.src)):(c.parentNode.removeChild(c),q++)}var u={editor:DEXTTOP.G_CURREDITOR,finalCallBackFn:function(){var b=0;if(0!=DEXTTOP.G_CURREDITOR._config.maxImageFileSize||0!=DEXTTOP.G_CURREDITOR._config.maxTotalFileSize){if(0!=
DEXTTOP.G_CURREDITOR._config.maxTotalFileSize&&0<h.length){var c=execImgMaxTotalFileSizeCheck(m,DEXTTOP.G_CURREDITOR.addedTotalFileSize),t=c.length;DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.messageType="multi_img";DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currFilteredFiles=[];DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currPassedFiles=[];DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currAddedTotalFileSize=DEXTTOP.G_CURREDITOR.addedTotalFileSize;for(--t;0<=t;t--){var u=
c[t],v={size:0};0!=u.filteredFileSize?(v.size=u.filteredFileSize,DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currFilteredFiles.push(v),b++,h[t].parentNode.removeChild(h[t])):0!=u.passedFileSize&&(v.size=u.passedFileSize,DEXTTOP.G_CURREDITOR.messageInfoForMaxTotalFileSize.currPassedFiles.push(v))}}0!=q&&messageForMaxImageFileSize(q);0!=b&&(t=setMessageForMaxTotalFileSize(DEXTTOP.G_CURREDITOR),alert(t));f=d.getElementsByTagName("img");g=f.length}b=[];for(t=0;t<g;t++){var c=f[t],D=c.src;"data:"==
D.substring(0,5)&&(""==c.style.width&&c.width&&""!=c.width&&(-1<c.getAttribute("width").indexOf("pt")||-1<c.getAttribute("width").indexOf("cm")?c.style.width=DEXTTOP.DEXT5.util.replacePtOrCmToPx(c.getAttribute("width")):c.style.width=DEXTTOP.DEXT5.util.parseIntOr0(c.width)+"px"),""==c.style.height&&c.height&&""!=c.height&&(-1<c.getAttribute("height").indexOf("pt")||-1<c.getAttribute("height").indexOf("cm")?c.style.height=DEXTTOP.DEXT5.util.replacePtOrCmToPx(c.getAttribute("height")):c.style.height=
DEXTTOP.DEXT5.util.parseIntOr0(c.height)+"px"),"1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64_remove?c.parentNode.removeChild(c):(u=D.split(","),2==u.length&&(v=getExtFromImageDataSrc(u[0]),DEXTTOP.G_CURREDITOR._FRAMEWIN.validateWidthHeight(_dext_editor._config,c.style.width,c.style.height)?(c=dext5_lang.msg.alert_exec_iamgesize,0!=_dext_editor._config.maxImageWidthSize&&(c+=dext5_lang.msg.alert_width.replace("{0}",_dext_editor._config.maxImageWidthSize),c+=" "),0!=_dext_editor._config.maxImageHeightSize&&
(c+=dext5_lang.msg.alert_height.replace("{0}",_dext_editor._config.maxImageHeightSize)),alert(c),b.push(f[t])):(D=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_Base64FileNameMap[D],D||(D=f[t].src.split(";")[0].replace("data:image/",""),D=DEXTTOP.DEXT5.util.makeGuid()+"."+D,DEXTTOP.G_CURREDITOR._FRAMEWIN.G_OriginalMultiImageSize_src[D]={width:f[t].style.width,height:f[t].style.height}),postBase64ImageToServer(u[1],v,c,!1,null,null,!0,null,D)))))}if(0<b.length)for(t=b.length-1;0<=t;t--)b[t].remove();a=d.innerHTML;
d=null;d=void 0;e()}}}else u={editor:DEXTTOP.G_CURREDITOR,finalCallBackFn:function(){if(0!=_dext_editor._config.maxTotalFileSize||-1<_dext_editor._config.imgDefaultWidth.indexOf("%")){d||(d=document.createElement("div"),d.innerHTML=a);var b=d.getElementsByTagName("img"),c=b.length,f=function(){if(-1<_dext_editor._config.imgDefaultWidth.indexOf("%"))for(var f=0;f<c;f++){var g=b[f],h=DEXTTOP.DEXT5.util.parseIntOr0(_dext_editor._config.imgDefaultWidth),m=DEXTTOP.DEXT5.util.getEditSpacePx(_dext_editor);
tempImgW="string"==typeof g.style.width&&-1<g.style.width.indexOf("%")?DEXTTOP.DEXT5.util.parseFloatOr0(g.style.width):Math.round(DEXTTOP.DEXT5.util.parseFloatOr0(g.style.width)/m*1E4)/100;g.style.width=0!=h&&h<tempImgW?_dext_editor._config.imgDefaultWidth:tempImgW+"%";g.style.height=""}a=d.innerHTML;d=null;d=void 0;e()},g=[];if(0!=_dext_editor._config.maxTotalFileSize){for(var h=0;h<c;h++){var m="",q=b[h];"IMG"==q.tagName?m=q.src:"A"==q.tagName?m=q.href:("TABLE"==q.tagName||"TD"==q.tagName)&&(q=
q.style.backgroundImage.match(/url\(["']?([^"']+)["']?\)/i))&&(m=q[1]);g.push({targetUrl:m})}if(0<g.length){var t=[],u={};g.forEach(function(a){u[a.targetUrl]||(u[a.targetUrl]=!0,t.push(a))});executeGetTotalPasteFileSizeByUrlProcess({editor:_dext_editor,targetUrlList:t,finalCallBackFn:function(a){0<a&&_dext_editor._config.maxTotalFileSize<_dext_editor.addedTotalFileSize+a&&(_dext_editor.messageInfoForMaxTotalFileSize.messageType="paste",_dext_editor.messageInfoForMaxTotalFileSize.currAddedTotalFileSize=
_dext_editor.addedTotalFileSize,_dext_editor.messageInfoForMaxTotalFileSize.currFileSize=a,a=setMessageForMaxTotalFileSize(_dext_editor),alert(a),_dext_editor.messageInfoForMaxTotalFileSize.messageType="default",_dext_editor.messageInfoForMaxTotalFileSize.currAddedTotalFileSize=0,_dext_editor.messageInfoForMaxTotalFileSize.currFileSize=0,d.innerHTML="");f()}})}else f()}else f()}else e()}};executeMaxTotalFileSizeCheckProcess(u)}catch(v){d=null,d=void 0}}
function command_insertLayer(a,b){try{dext_src_init(b._EDITOR.design);getApplyDragResize(b)&&DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear();restoreSelection();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0==getFirstRange().range.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);getFirstRange();var c=_iframeDoc.createElement("div");c.style.display="block";c.className="DEXT_fiVe_Layer";c.style.width="150px";c.style.height="100px";c.style.border=
"#000000 1px solid";c.style.position="absolute";var d=getWindowScrollPos(_iframeWin);c.style.left=d[0]+30+"px";c.style.top=d[1]+30+"px";_iframeDoc.body.appendChild(c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_elementZindex(a,b,c){try{if(DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem){var d=DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem;d.style.position="absolute";var e=_iframeDoc.body.getElementsByTagName("*"),f=e.length;a=[];for(b=0;b<f;b++)1==e[b].nodeType&&-1<",img,iframe,table,embed,div,".indexOf(","+e[b].tagName.toLowerCase()+",")&&a.push(e[b]);var g=a.length;for(b=g-1;0<=b;b--)for(var h=1;h<=b;h++)if(a[h-1].style.zIndex>a[h].style.zIndex){var m=
a[h-1];a[h-1]=a[h];a[h]=m}switch(c){case 1:d!=a[a.length-1]&&(d.style.zIndex=a[a.length-1].style.zIndex+1);break;case 2:if(d!=a[0])for(b=0;b<g;b++)d==a[b]?d.style.zIndex=0:a[b].style.zIndex+=1;break;case 3:if(d!=a[a.length-1])for(b=0;b<g;b++)if(d==a[b]){a[b]=a[b+1];a[b+1]=d;for(h=0;h<g;h++)a[h].style.zIndex=h;break}break;case 4:if(d!=a[0])for(b=0;b<g;b++)if(d==a[b]){a[b]=a[b-1];a[b-1]=d;for(h=0;h<g;h++)a[h].style.zIndex=h;break}}}}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_elementPosition(a,b){try{getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem.style.position="absolute"==DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem.style.position?"":"absolute",DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear())}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_insert_datetime(a,b,c){try{dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=getFirstRange().range,e;if(c)e=c;else if("undefined"!=typeof DEXTTOP.DEXTWIN.G_CURREDITOR._FRAMEWIN.DEXT_LANG_CONFIG||"undefined"!=typeof DEXTTOP.DEXTWIN.G_CURREDITOR._FRAMEWIN.DEXT_LANG_CONFIG.dateTime){e=DEXTTOP.G_CURREDITOR.lastDateType;var f=DEXTTOP.G_CURREDITOR._config.lang,f=f.replace("-",
""),g=new Date,h=c=b=a="",m="",q="",t="",u="",v="",w="",y="";a=g.getFullYear();b=a.toString().substring(2,4);c=DEXTTOP.DEXT5.util.leadingZeros(g.getMonth()+1,2);h=DEXTTOP.DEXT5.util.leadingZeros(g.getDate(),2);m=g.getDay();void 0!=DEXT_LANG_CONFIG.dateTime["date_"+f].Month[g.getMonth()]&&(q=DEXT_LANG_CONFIG.dateTime["date_"+f].Month[g.getMonth()]);void 0!=DEXT_LANG_CONFIG.dateTime["date_"+f].Day[m]&&(t=DEXT_LANG_CONFIG.dateTime["date_"+f].Day[m]);u=DEXTTOP.DEXT5.util.leadingZeros(g.getHours(),2);
v=DEXTTOP.DEXT5.util.leadingZeros(g.getMinutes(),2);w=DEXTTOP.DEXT5.util.leadingZeros(g.getSeconds(),2);y=12<=g.getHours()?"PM":"AM";e=e.replace("YYYY",a);e=e.replace("YY",b);e=e.replace("MM",c);e=e.replace("DD",h);e=e.replace("Month",q);e=e.replace("Day",t);e=e.replace("hh",u);e=e.replace("mm",v);e=e.replace("ss",w);e=e.replace("AMPM",y)}else e="";d.deleteContents();0==d.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);d.pasteHtml(e+'<span id="dext_datevalue">dext_datevalue</span>');var x=
_iframeDoc.getElementById("dext_datevalue");doSetCaretPosition(x,1);x.parentNode.removeChild(x);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0});onCommand({editor:DEXTTOP.G_CURREDITOR,cmd:"insert_datetime"})}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_InsertConversion(a,b,c){try{dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=getFirstRange().range;d.deleteContents();var e=d.getDocument().createTextNode(c.text);d.insertNode(e);d.selectNode(e);d.select();if(e.parentNode&&e.parentNode.tagName&&"BODY"==e.parentNode.tagName){var f=_iframeDoc.createElement("p");_iframeDoc.body.insertBefore(f,e);f.appendChild(e)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_InsertVideo(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange();b=a.range;0==b.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);b.pasteHtml(c);a.sel.collapseToEnd();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertCalculator(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange();b=a.range;0==b.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);b.pasteHtml(c);a.sel.collapseToEnd();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_zoom(a,b,c){try{var d=DEXTTOP.G_CURREDITOR.getEditorMode();b=null;"design"==d?b=_iframeDoc.body:"preview"==d&&(b=DEXTTOP.G_CURREDITOR._EDITOR.preview.contentDocument.body);d=0;"p"==c?d=10:"m"==c&&(d=-10);var e=document.getElementById("ue_"+a+"zoom_text").value,e=parseIntOr0(e)+d;0==e?(c=/\((.*)\)/i,b&&b.style.transform.match(c),e=""==RegExp.$1?100:100*parseFloat(RegExp.$1)):10>e&&(e=10);document.getElementById("ue_"+a+"zoom_text").value=e.toString()+"%";e/=100;if(DEXTTOP.DEXT5.browser.ie&&
10>DEXTTOP.DEXT5.browser.ieVersion)b.style.zoom=100*e+"%";else{b.style.transform="scale("+e+")";var f=DEXTTOP.DEXT5.util.parseIntOr0(b.parentElement.style.width);null==G_DesignHtmlWidth&&(G_DesignHtmlWidth=f);G_ZoomValue=e;if("1"==_dext_editor._config.widthFix.defaultView&&"1"==_dext_editor._config.widthFix.alignCenter&&G_BodyFit.noncreationAreaBackgroundStatus){var g=b.getBoundingClientRect(),h=document.getElementById("dext5_design_"+_dext_editor.ID).offsetWidth;G_DesignHtmlMarginValue=10;var m=
g.width+20;"2"==_dext_editor._config.defaultBodySpace.mode&&(m=g.width);h>m?(b.parentElement.style.width=G_DesignHtmlWidth+"px",b.parentElement.style.marginLeft="auto",b.parentElement.style.marginRight="auto",b.style.transformOrigin="center 0% 0px"):1>e?(b.parentElement.style.width=G_DesignHtmlWidth+"px",b.parentElement.style.marginLeft="auto",b.parentElement.style.marginRight="auto",b.style.transformOrigin="center 0% 0px"):(b.parentElement.style.width=m+"px",b.parentElement.style.marginLeft="10px",
b.parentElement.style.marginRight="10px","2"==_dext_editor._config.defaultBodySpace.mode&&(b.parentElement.style.marginLeft="auto",b.parentElement.style.marginRight="auto"),b.style.transformOrigin="0% 0% 0px")}else b.style.transformOrigin="0% 0% 0px"}}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_InsertPlaceholder(a,b,c){try{dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=getFirstRange(),e=d.range;0==e.collapsed?setRestoreCaretPos(!0):setRestoreCaretPos(!1);var f=document.createElement("span");f.className="raon_placeholder";f.setAttribute("placeholder",c.notice);f.setAttribute("contenteditable","true");e.pasteHtml(f.outerHTML);d.sel.collapseToEnd();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_removeBackgroundColor(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=function(a,b){try{b||makeRangeSelectionMarkInDesign();var c=_iframeDoc.getElementsByTagName("dextmark"),d,e,f=c[0].parentNode;if(f){for(;;){if("P"==f.tagName||"DIV"==f.tagName||"BODY"==f.tagName||"TD"==f.tagName){d=f;break}f=f.parentNode}e=GetParentbyTagName(d,"table")}var g,h,z=c[1].parentNode;if(z){for(;;){if("P"==z.tagName||"DIV"==z.tagName||"BODY"==z.tagName||"TD"==z.tagName){g=
z;break}z=z.parentNode}h=GetParentbyTagName(g,"table")}var B=dext5_lang.msg.error_remove_background_color,f=!1;if(e&&h)e!=h&&(f=!0);else if(e||h)f=!0;if(f)alert(B);else{h=function(a,b,c,d){b=b.childNodes;for(var e=b.length,f="",g=0;g<e;g++){var h="";1==b[g].nodeType?(h=b[g].outerHTML,h=CleanZeroChar(h)):3==b[g].nodeType&&(h=b[g].data);f+=h}c?(a.innerHTML=f,d?a.appendChild(d):a.innerHTML=f+'<dextmark class="dextmark"></dextmark>'):d?(a.innerHTML+=f,a.firstChild?a.insertBefore(d,a.firstChild):a.appendChild(d)):
a.innerHTML+='<dextmark class="dextmark"></dextmark>'+f};B=function(a,b){null==a.firstChild&&("xp"==DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?a.innerHTML=unescape("%uFEFF"):a.innerHTML=DEXTTOP.DEXT5.browser.ie?unescape("%u200B"):"<br>");b.setStartBefore(a.firstChild);b.setEndAfter(a.lastChild);return b.extractContents()};e=function(a,b,c){c.setStartAfter(a);c.setEndBefore(b);return c.extractContents()};"BODY"==d.tagName?a.setStartBefore(c[0]):a.setStartBefore(d.firstChild);a.setEndBefore(c[0]);
var D=a.extractContents();a.setStartAfter(c[1]);"BODY"==g.tagName?a.setEndAfter(c[1]):a.setEndAfter(g.lastChild);var A=a.extractContents();if(d==g){removeDextMarkInFrame();var C=B(d,a);h(d,D,!0);h(g,A,!1);for(var E=removeBackgroundColorInNodes(C,"backgroundColor",",table,td,p,");E.firstChild;)c[1].parentNode.insertBefore(E.firstChild,c[1])}else{C=null;"BODY"!=d.tagName&&(_iframeDoc.body.firstChild?_iframeDoc.body.insertBefore(c[0],_iframeDoc.body.firstChild):_iframeDoc.body.appendChild(c[0]),C=B(d,
a));f=null;"BODY"!=g.tagName&&(_iframeDoc.body.appendChild(c[1]),f=B(g,a));if("BODY"!=d.tagName)for(h(d,D,!0,c[0]),E=removeBackgroundColorInNodes(C,"backgroundColor",",table,td,p,");E.firstChild;)d.appendChild(E.firstChild);if("BODY"!=g.tagName){h(g,A,!1,c[1]);for(var E=removeBackgroundColorInNodes(f,"backgroundColor",",table,td,p,"),H=g.getElementsByTagName("dextmark");E.firstChild;)H[0].parentNode.insertBefore(E.firstChild,H[0])}D=null;c=_iframeDoc.getElementsByTagName("dextmark");"BODY"==d.tagName&&
(d=c[0]);"BODY"==g.tagName&&(g=c[1]);D=e(d,g,a);for(E=removeBackgroundColorInNodes(D,"backgroundColor",",table,td,p,");E.firstChild;)g.parentNode.insertBefore(E.firstChild,g)}b||(c=_iframeDoc.getElementsByTagName("dextmark"),a.setStartAfter(c[0]),a.setEndBefore(c[1]),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(a))}removeDextMarkInFrame()}catch(M){removeDextMarkInFrame()}};0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
var d=getFirstRange().range,e=GetTableSelectionCells(),f=e.length;if(0<f)for(var g=0;g<f;g++){var h=_iframeDoc.createElement("dextmark");e[g].insertBefore(h,e[g].firstChild);h=_iframeDoc.createElement("dextmark");e[g].appendChild(h);d.setStartBefore(e[g].firstChild);d.setEndAfter(e[g].lastChild);c(d,!0)}else c(d);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_ParagraphAttribute(a,b,c){try{dext_src_init(b);restoreSelection();setFocusToBody();var d=getFirstRange().range;try{DEXTTOP.G_CURREDITOR.beforeOffset=[],DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startOffset),DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endOffset),3==d.startContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startContainer.parentNode):DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startContainer),3==d.endContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endContainer.parentNode):
(DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endContainer),1==d.endOffset&&(DEXTTOP.G_CURREDITOR.beforeOffset[1]=(d.endContainer.innerText||d.endContainer.textContent).length)),DEXTTOP.G_CURREDITOR.beforeOffset.push(d.toString().length)}catch(e){DEXTTOP.G_CURREDITOR.beforeOffset=null}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a="p li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" ");var f=a.length,g,h,m=GetTableSelectionCells();if(0==m.length){if(null!=d.startContainer.previousSibling&&
"HEAD"==d.startContainer.previousSibling.tagName&&null==d.endContainer.nextSibling){for(var q=0;q<f;q++){g=_iframeDoc.body.getElementsByTagName(a[q]);h=g.length;for(var t=0;t<h;t++)""!=c.marginLeft.toString()&&(g[t].style.marginLeft=c.marginLeft+c.marginLeftType),""!=c.marginRight.toString()&&(g[t].style.marginRight=c.marginRight+c.marginRightType),""!=c.marginTop.toString()&&(g[t].style.marginTop=c.marginTop+c.marginTopType),""!=c.marginBottom.toString()&&(g[t].style.marginBottom=c.marginBottom+
c.marginBottomType),""!=c.letterSpacing.toString()&&(g[t].style.letterSpacing=c.letterSpacing+"px"),""!=c.wordSpacing.toString()&&(g[t].style.wordSpacing=c.wordSpacing+"px"),""!=c.textIndent.toString()&&(g[t].style.textIndent=c.textIndent+c.textIndentType),""!=c.fontSize.toString()&&(g[t].style.fontSize=c.fontSize+c.fontType),""!=c.fontFamily.toString()&&("default"==c.fontFamily?g[t].style.fontFamily="":g[t].style.fontFamily=c.fontFamily)}for(var u=_iframeDoc.body.getElementsByTagName("table"),v=
u.length,q=0;q<v;q++)for(var w=u[q].rows,y=w.length,t=0;t<y;t++)for(var m=w[t].cells,x=m.length,z=0;z<x;z++)setBlockTag(m[z].childNodes,a,"paragraphAttribute",c);setBlockTag(_iframeDoc.body.childNodes,a,"paragraphAttribute",c);for(var B=_iframeDoc.body.getElementsByTagName("div"),D=B.length,t=0;t<D;t++)setBlockTag(B[t].childNodes,a,"paragraphAttribute",c)}else{g=getNodesInRange(d);h=g.length;1==d.collapsed&&0==d.getNodes().length&&d.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(f=0;f<h;f++)if(1==
g[f].nodeType){var A=g[f].tagName.toLowerCase();-1<a.indexOf(A)&&(""!=c.marginLeft.toString()&&(g[f].style.marginLeft=c.marginLeft+c.marginLeftType),""!=c.marginRight.toString()&&(g[f].style.marginRight=c.marginRight+c.marginRightType),""!=c.marginTop.toString()&&(g[f].style.marginTop=c.marginTop+c.marginTopType),""!=c.marginBottom.toString()&&(g[f].style.marginBottom=c.marginBottom+c.marginBottomType),""!=c.letterSpacing.toString()&&(g[f].style.letterSpacing=c.letterSpacing+"px"),""!=c.wordSpacing.toString()&&
(g[f].style.wordSpacing=c.wordSpacing+"px"),""!=c.textIndent.toString()&&(g[f].style.textIndent=c.textIndent+c.textIndentType),""!=c.fontSize.toString()&&(g[f].style.fontSize=c.fontSize+c.fontType),""!=c.fontFamily.toString()&&("default"==c.fontFamily?g[f].style.fontFamily="":g[f].style.fontFamily=c.fontFamily))}var C;0==d.toString().length&&1==d.getNodes().length&&(C=d.getNodes()[0],g.push(d.getNodes()[0]));setBlockTag(g,a,"paragraphAttribute",c)}var E=_iframeDoc.getElementById("_dextPosition");
if(E)doSetCaretPosition(E,1),E.parentNode.removeChild(E);else if(C){var H=getFirstRange().range;getFirstRange().sel.removeAllRanges();H.selectNode(C);getFirstRange().sel.addRange(H)}}else for(x=m.length,q=0;q<x;q++){for(t=0;t<f;t++)for(g=m[q].getElementsByTagName(a[t]),h=g.length,z=0;z<h;z++)""!=c.marginLeft.toString()&&(g[t].style.marginLeft=c.marginLeft+c.marginLeftType),""!=c.marginRight.toString()&&(g[t].style.marginRight=c.marginRight+c.marginRightType),""!=c.marginTop.toString()&&(g[t].style.marginTop=
c.marginTop+c.marginTopType),""!=c.marginBottom.toString()&&(g[t].style.marginBottom=c.marginBottom+c.marginBottomType),""!=c.letterSpacing.toString()&&(g[t].style.letterSpacing=c.letterSpacing+"px"),""!=c.wordSpacing.toString()&&(g[t].style.wordSpacing=c.wordSpacing+"px"),""!=c.textIndent.toString()&&(g[t].style.textIndent=c.textIndent+c.textIndentType),""!=c.fontSize.toString()&&(g[t].style.fontSize=c.fontSize+c.fontType),""!=c.fontFamily.toString()&&("default"==c.fontFamily?g[t].style.fontFamily=
"":g[t].style.fontFamily=c.fontFamily);setBlockTag(m[q].childNodes,a,"paragraphAttribute",c);B=m[q].getElementsByTagName("div");D=B.length;for(t=0;t<D;t++)setBlockTag(B[t].childNodes,a,"paragraphAttribute",c)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR.beforeOffset=null;G_Ruler&&"2"==DEXTTOP.G_CURREDITOR._config.ruler.mode&&G_Ruler.SetRulerPosition()}catch(M){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_BeforeSetCompleteSpellCheck(a){try{a._BODY&&"spellcheck"in a._BODY&&"1"==a._config.browserSpellCheck&&0==a._BODY.spellcheck&&a._BODY.removeAttribute("spellcheck")}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function command_AdjustTableAndCellWidth(a,b){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();var c=[],d=b.tables?b.tables:null,e=b.container?b.container:null;d?c=d:e&&(c=e.getElementsByTagName("table"));for(var d=c.length,e=function(a,b){var c=null,d=DEXTTOP.DEXT5.util.getStyle(a,b);"string"==typeof d&&0<d.length?(d=DEXTTOP.DEXT5.util.replacePtOrCmToPx(d),d=parseFloat(d),"number"==typeof d&&(c=Math.round(d))):c=0;return c},f=!1,g=0;g<d;g++){for(var h=c[g],m=[],q=h.rows,t=q.length,
u=0;u<t;u++){m.push([]);for(var v=q[u],v=v.cells,w=v.length,y=0;y<w;y++){var x=v[y],z=x.clientWidth,B=e(x,"paddingLeft");if(null==B){f=!0;break}x=e(x,"paddingRight");if(null==x){f=!0;break}m[u].push({styleWidth:z-B-x+"px"})}}if(0==f)for(u=0;u<t;u++)for(v=q[u],v=v.cells,w=v.length,y=0;y<w;y++)x=v[y],x.style.width=m[u][y].styleWidth,"string"==typeof x.getAttribute("width")&&x.setAttribute("width",DEXTTOP.DEXT5.util.parseIntOr0(x.style.width));u=h.style.width;if(""==u||0>u.indexOf("%"))h.style.width=
h.clientWidth+"px";"fixed"==h.style.tableLayout&&(h.style.tableLayout="");h=h.getElementsByTagName("colgroup");for(u=h.length-1;0<=u;u--)h[u].parentNode.removeChild(h[u])}}
function command_AdjustTableAndCellWidthEx(a){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();a=[];a=_iframeDoc.getElementsByTagName("table");for(var b=a.length,c=0;c<b;c++){for(var d=a[c],e=[],f=d.rows,g=f.length,h=0;h<g;h++){e.push([]);for(var m=f[h],m=m.cells,q=m.length,t=0;t<q;t++){var u=m[t],v=u.clientWidth,w=DEXTTOP.DEXT5.util.getStyle(u,"all"),u=w.paddingLeft;if("string"==typeof u&&0<u.length)if(-1<u.indexOf("pt")){var y=4*DEXTTOP.DEXT5.util.parseFloatOr0(u)/3;0<y&&1>y&&
(y=1);0>y&&(y=0);y=Math.round(y);u=Math.round(y)}else u=DEXTTOP.DEXT5.util.parseFloatOr0(u),u=Math.round(u);w=w.paddingRight;"string"==typeof w&&0<w.length&&(-1<w.indexOf("pt")?(y=4*DEXTTOP.DEXT5.util.parseFloatOr0(w)/3,0<y&&1>y&&(y=1),0>y&&(y=0),y=Math.round(y),w=Math.round(y)):(w=DEXTTOP.DEXT5.util.parseFloatOr0(w),w=Math.round(w)));e[h].push({styleWidth:v-u-w+"px"})}}for(h=0;h<g;h++)for(m=f[h],m=m.cells,q=m.length,t=0;t<q;t++)u=m[t],u.style.width=e[h][t].styleWidth;d.style.width=d.clientWidth+
"px";"fixed"==d.style.tableLayout&&(d.style.tableLayout="");d=d.getElementsByTagName("colgroup");for(h=d.length-1;0<=h;h--)d[h].parentNode.removeChild(d[h])}}
function command_AdjustTableAndCellHeight(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=[];if(c&&"forceAdjust"==c.type){a.push(c.targetTable);try{var d=a.length;for(b=0;b<d;b++){var e=a[b];if(""!=e.style.height)for(var f=e.rows,g=f.length,h=parseInt(e.style.height,10),m=c.beforeHeight,q=0;q<g;q++)for(var t=f[q].cells,u=t.length,v=0;v<u;v++){var w=t[v],y=w.style.height;""!=y&&-1<y.indexOf("px")&&(y=parseInt(y,10),w.style.height=h*y/m+"px")}}}catch(x){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}}}function command_PluginAction(a,b,c){switch(c.action){case "insert_image":plugin_insertImage(a,b,c);break;case "replace_image":plugin_replaceImage(a,b,c);break;case "insert_element":plugin_insertElement(a,b,c);break;case "replace_element":plugin_replaceElement(a,b,c)}}
function plugin_insertImage(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;try{1==selObjectText.collapsed&&setRestoreCaretPos(!1)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}a.collapse(!0);a.insertNode(c.image);c.image.setAttribute("raon_plugin",c.pluginName);a.selectNode(c.image);a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{if("function"===typeof DEXTTOP.dext_editor_contentsize_change_event||"function"===typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange){var e=c.image.src;if("data:"==e.substring(0,5)){var f=e.split(",");if(2==f.length){var g=DEXTTOP.G_CURREDITOR._FRAMEWIN.getExtFromImageDataSrc(f[0]);DEXTTOP.G_CURREDITOR._FRAMEWIN.postBase64ImageToServer(f[1],g,c.image,!1);window.setTimeout(function(){try{contentChangeEventWrapper()}catch(a){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}},500)}}}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function plugin_replaceImage(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;try{1==selObjectText.collapsed&&setRestoreCaretPos(!1)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}a.selectNode(c.element);a.deleteContents();a.collapse(!0);a.insertNode(c.image);c.image.setAttribute("raon_plugin",c.pluginName);a.selectNode(c.image);a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);
DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{if("function"===typeof DEXTTOP.dext_editor_contentsize_change_event||"function"===typeof DEXTTOP.G_CURREDITOR._config.event.contentSizeChange){var e=c.image.src;if("data:"==e.substring(0,5)){var f=e.split(",");if(2==f.length){var g=DEXTTOP.G_CURREDITOR._FRAMEWIN.getExtFromImageDataSrc(f[0]);DEXTTOP.G_CURREDITOR._FRAMEWIN.postBase64ImageToServer(f[1],g,c.image,!1);window.setTimeout(function(){try{contentChangeEventWrapper()}catch(a){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},500)}}}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function plugin_insertElement(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;try{1==selObjectText.collapsed&&setRestoreCaretPos(!1)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}a.collapse(!0);a.insertNode(c.newElement);c.newElement.setAttribute("raon_plugin",c.pluginName);a.selectNode(c.newElement);a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);
DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function plugin_replaceElement(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;try{1==selObjectText.collapsed&&setRestoreCaretPos(!1)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}a.selectNode(c.element);a.deleteContents();a.collapse(!0);a.insertNode(c.newElement);c.newElement.setAttribute("raon_plugin",c.pluginName);a.selectNode(c.newElement);a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();
rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertTableTopBottomParagraph(a,b,c){restoreSelection();setFocusToBody();if(null!=c)c&&("insert_table_top_paragraph"==a?insertPtagTableNear(!0,c):insertPtagTableNear(!1,c));else{var d=getFirstRange().range;c=null;d&&d.startContainer&&(c=getMyElementNode(d.startContainer));if(c){d=GetTDTHCell(c);if(null==d&&"tr"==c.tagName.toLowerCase()){var e=c.cells.length;0<e&&(d=c.cells[e-1])}d&&(c=GetParentbyTagName(d,"table"))&&("insert_table_top_paragraph"==a?insertPtagTableNear(!0,c):insertPtagTableNear(!1,
c))}}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;b._iconEnable("default")}
function command_fontSizeIncDec(a,b,c){var d="";"1"==c._config.useFontSizeKeyin?d=document.getElementById("txtara_"+a+"font_size").value:(d=document.getElementById("ue_"+a+"font_size").innerHTML,DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion?(d=d.replace("<SPAN>",""),d=d.replace("</SPAN>","")):(d=d.replace("<span>",""),d=d.replace("</span>","")));if(""!=d&&d!=dext5_lang.icon.font_size){var e="",f="",f=1;""!=c._config.fontSizeIncDecGap&&(f=parseInt(c._config.fontSizeIncDecGap));"font_size_dec"==
b&&(f*=-1);c=parseInt(d);if(-1<d.indexOf("pt")||-1<d.indexOf("px")||-1<d.indexOf("em")||0<d.indexOf("%"))0<d.indexOf("pt")?e="pt":0<d.indexOf("px")?e="px":0<d.indexOf("em")?e="em":0<d.indexOf("%")&&(e="%",f*=10);d=c+f;"font_size_dec"==b&&1>d&&(d=c);f=d+e;"1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?document.getElementById("txtara_"+a+"font_size").value=f:document.getElementById("ue_"+a+"font_size").innerHTML="<span>"+f+"</span>";command_fontsize(a,document.getElementById("dext5_design_"+a),
f)}}
function command_lineHeightIncDec(a,b,c){var d="";"1"==c._config.useLineHeightKeyin?d=document.getElementById("txtara_"+a+"line_height").value:(d=document.getElementById("ue_"+a+"line_height").innerHTML,DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion?(d=d.replace("<SPAN>",""),d=d.replace("</SPAN>","")):(d=d.replace("<span>",""),d=d.replace("</span>","")));if(""!=d&&d!=dext5_lang.icon.line_height){var e=d,f=1;""!=c._config.lineHeightIncDecGap&&(f=parseFloat(c._config.lineHeightIncDecGap));"line_height_dec"==
b&&(f*=-1);0<d.indexOf("%")?(f*=10,e=e.substring(0,e.length-1),f=parseInt(parseInt(e)+f),0<parseInt(e,10)&&0<=f&&(e=f),b="%"):(b="",0<d.indexOf("pt")||0<d.indexOf("px")||0<d.indexOf("em")?(f=parseFloat(parseFloat(e)+f).toFixed(2),0<d.indexOf("pt")?b="pt":0<d.indexOf("px")?b="px":0<d.indexOf("em")&&(b="em"),0<=f&&(e=f)):(f*=.1,f=parseFloat(parseFloat(e)+f).toFixed(2),e=0<=f?f:parseFloat(e)));e=parseFloat(e)+b;"1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin?document.getElementById("txtara_"+a+
"line_height").value=e:document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+e+"</span>";command_lineHeight(a,document.getElementById("dext5_design_"+a),e)}}
function command_letterSpacingIncDec(a,b,c){var d=document.getElementById("ue_"+a+"letter_spacing").innerHTML;DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion?(d=d.replace("<SPAN>",""),d=d.replace("</SPAN>","")):(d=d.replace("<span>",""),d=d.replace("</span>",""));if(""!=d&&d!=dext5_lang.icon.letter_spacing){var e=1;void 0!=c._config.letterSpacingIncDecGap&&""!=c._config.letterSpacingIncDecGap&&(e=parseFloat(c._config.letterSpacingIncDecGap));"letter_spacing_dec"==b&&(e*=-1);b=d.substring(d.length,
d.length-2);c=parseFloat(d);if(-1<d.indexOf("pt")||-1<d.indexOf("px")||-1<d.indexOf("em"))b="",0<d.indexOf("pt")?b="pt":0<d.indexOf("px")?b="px":0<d.indexOf("em")&&(b="em"),c=parseFloat(parseFloat(parseFloat(c)+e).toFixed(2))+b;document.getElementById("ue_"+a+"letter_spacing").innerHTML="<span>"+c+"</span>";command_letterSpacing(a,DEXTTOP.G_CURREDITOR,c)}}
function command_bodyFit(a,b){if(!(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion)){G_BodyFit.widthFixStatus=!G_BodyFit.widthFixStatus;G_BodyFit.widthFixedStatus=!G_BodyFit.widthFixedStatus;G_BodyFit.SetBodyWidth();var c={wordBreakType:"",wordWrapType:""},d=!1;G_BodyFit.widthFixedStatus?(d=!0,c.wordWrapType="break-word;",c.wordBreakType="normal"==b._setting.word_break_type?"break-all":b._setting.word_break_type):(c.wordWrapType=b._setting.word_wrap_type,c.wordBreakType=b._setting.word_break_type);
var c=createDefaultStyleNodeForEditorArea(b,c),e=getDefaultStyleTag(_iframeDoc,b);e?(e.parentNode.insertBefore(c,e),e.parentNode.removeChild(e)):(e=_iframeDoc.getElementsByTagName("head")[0])&&e.appendChild(c);setBodyFitStyle(b,d);G_Ruler&&G_Ruler.viewRulerStatus&&G_Ruler.SetRulerPosition()}}function command_forbidden_word(a,b,c){DEXT5_EDITOR.prototype.dialog.show(b._config.webPath.page,b._config.pages.forbidden_word)}
function command_saveAsImage(a,b,c){try{dext_src_init(c._EDITOR.design);var d=b.src.split(/(\\|\/)/g).pop().substring(0,b.src.split(/(\\|\/)/g).pop().lastIndexOf("."));""==d&&(d="untitled");var e="",f=!1;a=function(){var a=b.src.split("?")[0].split(".");e=a[a.length-1].toLowerCase();"jpg"!=e&&"gif"!=e&&"png"!=e&&"tif"!=e&&"tiff"!=e&&"bmp"!=e&&"jpeg"!=e&&"jpe"!=e&&"jfif"!=e&&(d="untitled",e="png",f=!0)};c=function(a){var c=new Image;c.src=b.src;c.onload=function(){var b=document.createElement("canvas");
b.style.display="none";document.body.appendChild(b);var d=b.getContext("2d");b.id="saveCanvas";b.width=c.width;b.height=c.height;d.drawImage(c,0,0,c.width,c.height);a?(dataURL="jpg"==e||"jpeg"==e?b.toDataURL("image/jpeg"):b.toDataURL(),h(dataURL)):(dataURL=b.toDataURL(),g(dataURL))}};if(G_dext5plugIn&&-1==b.src.indexOf("data:image/"))a(),a="",a=0==b.src.indexOf("/")?location.protocol+"//"+location.host+b.src:b.src,""==G_dext5plugIn.DoSaveToImage(a,d+"."+e)&&alert(dext5_lang.msg.error_save_as_image);
else{var g=function(a){var b=document.createElement("a");b.setAttribute("href",a);b.setAttribute("download",d+"."+e);document.createEvent?(a=document.createEvent("MouseEvents"),a.initEvent("click",!0,!0),b.dispatchEvent(a)):b.click()},h=function(a){if(DEXTTOP.navigator.msSaveOrOpenBlob){a=DEXTTOP.DEXT5.util.dataURItoBlob(a);var b="."+a.type.substring(a.type.indexOf("/")+1,a.type.length);".jpeg"==b&&(b=".jpg");DEXTTOP.navigator.msSaveOrOpenBlob(a,d+b)}else alert(dext5_lang.msg.error_browser_save_as_image)};
DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.safari?alert(dext5_lang.msg.error_browser_save_as_image):-1<b.src.indexOf("data:image/")?DEXTTOP.DEXT5.browser.ie?h(b.src):(e=getExtFromImageDataSrc(b.src),g(b.src)):b.src.match(/:\/\/(.[^\/]+)/)[1]!=window.location.host?alert(dext5_lang.msg.error_cors_save_as_image):(a(),DEXTTOP.DEXT5.browser.ie?f?DEXTTOP.DEXT5.browser.canvasSupported?c(!0):alert(dext5_lang.msg.error_browser_save_as_image):c(!0):f?c(!1):g(b.src))}}catch(m){alert(dext5_lang.msg.error_save_as_image)}}
function command_continueNumbering(a){for(var b=getParentbyTagNameEx(a,"ol"),c=b.childNodes[0];c;)if(c.tagName&&"LI"==c.tagName)if(c==a)break;else return;else c=c.nextSibling;var c=function(a){var b=0;a=a.childNodes;for(var c=0;c<a.length;c++)a[c]&&a[c].tagName&&"LI"==a[c].tagName&&b++;return b},d=function(a){for(var b=function(a){var b;document.defaultView&&document.defaultView.getComputedStyle?b=document.defaultView.getComputedStyle(a,null).getPropertyValue("list-style-type"):a.currentStyle&&(b=
a.currentStyle["list-style-type"]);return b},c=b(a),d=a.previousSibling;d;){if(d.tagName&&"OL"==d.tagName&&b(d)==c)return{listStyleType:b(d),retOl:d};d=d.previousSibling}return{listStyleType:b(a),retOl:a}}(b),e=d.retOl;if(e!=b){if(b.previousSibling==e){for(;b.hasChildNodes();)e.appendChild(b.firstChild);b.parentNode.removeChild(b);setFocusChildForStyle(a)}else b.style.listStyleType=d.listStyleType,b.start=e.start+c(e);_dext_editor.UndoManager.putUndo();_dext_editor.UndoManager.charCount=0}}
function command_SetNumberingValue(a,b,c,d,e,f){for(var g=e.childNodes[0];g;)if(g.tagName&&"LI"==g.tagName){if(g==c){e.start=b;f&&hideDialog(f);return}break}else g=g.nextSibling;a=a.selectedNode.parentNode.cloneNode();a.style.marginTop="0";a.start=b;a.style.listStyleType=d;b=[];e.style.marginBottom="0";d=e.childNodes;for(g=d.length-1;0<=g&&(!d[g]||!d[g].tagName||"LI"!=d[g].tagName||(b.push(d[g]),d[g]!=c));g--);for(;0<b.length;)a.appendChild(b.pop());e.parentNode.insertBefore(a,e.nextSibling);setFocusChildForStyle(c);
_dext_editor.UndoManager.putUndo();_dext_editor.UndoManager.charCount=0;f&&hideDialog(f)}
function command_SetListInoutdent(a,b,c,d,e){var f=a.selectedNode.parentNode,g=a.changeListPos,h=a.changeListUnit,m=a.changeTextPos,q=a.changeTextUnit;e=e.getElementById("list_all_select");if(b){""==f.style.marginLeft&&(f.style.paddingLeft=0,f.style.marginLeft="40px");b=f.style.marginLeft;b=DEXTTOP.DEXT5.util.parseIntOr0(b);var t=a.fnGetListUnit(f);h!=t&&(b=DEXTTOP.DEXT5.util.replaceUnit(b,t,h,16,16));b=g-b;var t=f.parentNode.getElementsByTagName(f.tagName),u=f.style.listStyleType,v,w=!1;if("BODY"==
f.parentNode.tagName){if(f.style.marginLeft=g+h,!e.checked)for(var t=f.childNodes,y=0;y<t.length;y++)if("OL"==t[y].tagName||"UL"==t[y].tagName){""==t[y].style.marginLeft&&(t[y].style.paddingLeft=0,t[y].style.marginLeft="40px");v=DEXTTOP.DEXT5.util.parseIntOr0(t[y].style.marginLeft);var x=a.fnGetListUnit(t[y]);v=DEXTTOP.DEXT5.util.replaceUnit(v,x,h);t[y].style.marginLeft=v-b+h}}else for(y=0;y<t.length;y++)if(v=t[y].style.listStyleType,u==v&&!w&&(""==t[y].style.marginLeft&&(t[y].style.paddingLeft=0,
t[y].style.marginLeft="40px"),t[y].style.marginLeft=g+h,w=!0,!e.checked))for(var z=0;z<t[y].childNodes.length;z++)if("OL"==t[y].childNodes[z].tagName||"UL"==t[y].childNodes[z].tagName)""==t[y].childNodes[z].style.marginLeft&&(t[y].childNodes[z].style.paddingLeft=0,t[y].childNodes[z].style.marginLeft="40px"),v=DEXTTOP.DEXT5.util.parseIntOr0(t[y].childNodes[z].style.marginLeft),x=a.fnGetListUnit(t[y].childNodes[z]),v=DEXTTOP.DEXT5.util.replaceUnit(v,x,h),t[y].childNodes[z].style.marginLeft=v-b+h}if(c)for(y=
0;y<f.childNodes.length;y++)"LI"==f.childNodes[y].tagName&&(f.childNodes[y].style.paddingLeft=m+q);_dext_editor.UndoManager.putUndo();_dext_editor.UndoManager.charCount=0;d&&hideDialog(d)}
function command_tableSticky(a,b,c){"TD"!=b.tagName&&(b=GetParentbyTagName(b,"td"));var d=function(a,b,c){c=Array.prototype.indexOf.call(c,a.parentNode);if(0>c)return{tr:-1,td:-1};for(var d=0;d<b[c].length;d++)if(b[c][d].cell===a)return{tr:c,td:d};return{tr:-1,td:-1}},e=function(a,b,c){for(var d=0;d<a.length;d++)for(var e=a[d].length,f=0;f<e;f++){var g=a[d][f].cell;DEXTTOP.DEXT5.util.removeStyleAttribute(g,"z-index");"white"!=g.style.backgroundColor&&g.style.backgroundColor!=c&&g.style.backgroundColor!=
b||DEXTTOP.DEXT5.util.removeStyleAttribute(g,"background-color")}},f=c.getElementsByTagName("TR"),g,h,m=getComputedStyle(c).backgroundColor,q=getComputedStyle(_iframeDoc.body).backgroundColor,t=getTableAllCells(c),u=100*t.length,v=1,w=1,y=!1;for(g=0;g<f[0].childNodes.length;g++){var x=f[0].childNodes[g],x=DEXTTOP.DEXT5.util.parseIntOr0(x.getAttribute("rowspan"))||1;1<x&&(y=!0,v=Math.max(v,x))}for(g=0;g<f.length;g++)x=f[g].childNodes[0],x=DEXTTOP.DEXT5.util.parseIntOr0(x.getAttribute("colspan"))||
1,1<x&&(y=!0,w=Math.max(w,x));null==c.getAttribute("sticky")||void 0==c.getAttribute("sticky")?g=!1:(g=!0,h=c.getAttribute("sticky"));switch(a){case "sticky_top_row":b=f[0].childNodes;if(g)if("top"==h){if(y){h=[];for(g=0;g<v;g++)h.push(f[g]);for(b=0;b<h.length;b++)for(f=t[b].length,d=0;d<f;d++)x=t[b][d].cell,DEXTTOP.DEXT5.util.removeStyleAttribute(x,"position"),DEXTTOP.DEXT5.util.removeStyleAttribute(x,"top")}else for(g=0;g<b.length;g++)x=b[g],DEXTTOP.DEXT5.util.removeStyleAttribute(x,"position"),
DEXTTOP.DEXT5.util.removeStyleAttribute(x,"top");e(t,q,m);c.style.borderCollapse="collapse";DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-spacing");c.removeAttribute("sticky")}else if("left"==h)if(y){h=[];x=!1;for(g=0;g<v;g++)h.push(f[g]);for(b=0;b<v;b++)for(f=t[b].length,d=0;d<f;d++)t[b][d].row+t[b][d].rowSpan>v&&(x=!0);if(x)c=dext5_lang.msg.sticky_not_allowed_in_table_structure,c=c.replace("{0}",dext5_lang.context.sticky_top_row),alert(c);else{for(b=0;b<v;b++)for(f=t[b].length,d=0;d<f;d++)if(x=
t[b][d].cell,x.style.zIndex=b<v&&d<w?u+100:u,u--,x&&!x._handled&&x===t[b][d].cell){e=getComputedStyle(x).backgroundColor;x._handled=!0;var z=0;h=new Set;for(g=0;g<b;g++)(y=t[g][d].cell)&&y!==x&&!h.has(y)&&(z+=getClientRect(y).height,h.add(y));x.style.position="sticky";x.style.top=z+"px";"rgba(0, 0, 0, 0)"==e&&(x.style.backgroundColor="rgba(0, 0, 0, 0)"==m?"rgba(0, 0, 0, 0)"==q?"white":q:m)}for(b=0;b<v;b++)for(f=t[b].length,d=0;d<f;d++)(m=t[b][d].cell)&&m._handled&&delete m._handled;c.setAttribute("sticky",
"top-left")}}else{for(g=0;g<b.length;g++)x=b[g],e=getComputedStyle(x).backgroundColor,x.style.position="sticky",x.style.top="0px","rgba(0, 0, 0, 0)"==e&&(x.style.backgroundColor="rgba(0, 0, 0, 0)"==m?"rgba(0, 0, 0, 0)"==q?"white":q:m),x.style.zIndex=u,u--;c.setAttribute("sticky","top-left")}else{if("top-left"==h){if(y){h=[];for(g=0;g<v;g++)h.push(f[g]);for(b=0;b<h.length;b++)for(f=t[b].length,d=0;d<f;d++)x=t[b][d].cell,DEXTTOP.DEXT5.util.removeStyleAttribute(x,"top")}else for(g=0;g<b.length;g++)x=
b[g],DEXTTOP.DEXT5.util.removeStyleAttribute(x,"top");c.setAttribute("sticky","left")}}else if(y){h=[];x=!1;for(g=0;g<v;g++)h.push(f[g]);for(b=0;b<v;b++)for(f=t[b].length,d=0;d<f;d++)t[b][d].row+t[b][d].rowSpan>v&&(x=!0);if(x)c=dext5_lang.msg.sticky_not_allowed_in_table_structure,c=c.replace("{0}",dext5_lang.context.sticky_top_row),alert(c);else{for(b=0;b<v;b++)for(f=t[b].length,d=0;d<f;d++)if(x=t[b][d].cell,x.style.zIndex=b<v&&d<w?u+100:u,u--,x&&!x._handled&&x===t[b][d].cell){e=getComputedStyle(x).backgroundColor;
x._handled=!0;z=0;h=new Set;for(g=0;g<b;g++)(y=t[g][d].cell)&&y!==x&&!h.has(y)&&(z+=getClientRect(y).height,h.add(y));x.style.position="sticky";x.style.top=z+"px";"rgba(0, 0, 0, 0)"==e&&(x.style.backgroundColor="rgba(0, 0, 0, 0)"==m?"rgba(0, 0, 0, 0)"==q?"white":q:m)}for(b=0;b<v;b++)for(f=t[b].length,d=0;d<f;d++)(m=t[b][d].cell)&&m._handled&&delete m._handled;c.style.borderCollapse="separate";c.style.borderSpacing=0;c.setAttribute("sticky","top")}}else{for(g=0;g<b.length;g++)x=b[g],e=getComputedStyle(x).backgroundColor,
x.style.position="sticky",x.style.top="0px",x.style.zIndex=u,u--,"rgba(0, 0, 0, 0)"==e&&(x.style.backgroundColor="rgba(0, 0, 0, 0)"==m?"rgba(0, 0, 0, 0)"==q?"white":q:m);c.style.borderCollapse="separate";c.style.borderSpacing=0;c.setAttribute("sticky","top")}break;case "sticky_first_column":if(g)if("top"==h)if(y){x=!1;for(b=0;b<t.length;b++)for(d=0;d<w;d++)t[b][d].col+t[b][d].colSpan>w&&(x=!0);if(x)c=dext5_lang.msg.sticky_not_allowed_in_table_structure,c=c.replace("{0}",dext5_lang.context.sticky_first_column),
alert(c);else{for(b=0;b<t.length;b++)for(d=0;d<w;d++)if(x=t[b][d].cell,x.style.zIndex=b<v&&d<w?u+100:u,u--,x&&!x._handled&&x===t[b][d].cell){e=getComputedStyle(x).backgroundColor;x._handled=!0;a=0;h=new Set;for(g=0;g<d;g++)(y=t[b][g].cell)&&!h.has(y)&&(a+=getClientRect(y).width,h.add(y));x.style.position="sticky";x.style.left=a+"px";"rgba(0, 0, 0, 0)"==e&&(x.style.backgroundColor="rgba(0, 0, 0, 0)"==m?"rgba(0, 0, 0, 0)"==q?"white":q:m)}for(b=0;b<f.length;b++)for(d=0;d<w;d++)(m=t[b][d].cell)&&m._handled&&
delete m._handled;c.setAttribute("sticky","top-left")}}else{for(g=0;g<f.length;g++)v=f[g],x=v.firstChild,e=getComputedStyle(x).backgroundColor,x.style.position="sticky",x.style.left="0px",x.style.zIndex=u+100,u--,"rgba(0, 0, 0, 0)"==e&&(x.style.backgroundColor="rgba(0, 0, 0, 0)"==m?"rgba(0, 0, 0, 0)"==q?"white":q:m);c.setAttribute("sticky","top-left")}else if("left"==h){if(y)for(b=0;b<f.length;b++)for(d=0;d<w;d++)x=t[b][d].cell,DEXTTOP.DEXT5.util.removeStyleAttribute(x,"position"),DEXTTOP.DEXT5.util.removeStyleAttribute(x,
"left");else for(g=0;g<f.length;g++)v=f[g],x=v.firstChild,DEXTTOP.DEXT5.util.removeStyleAttribute(x,"position"),DEXTTOP.DEXT5.util.removeStyleAttribute(x,"left");e(t,q,m);c.style.borderCollapse="collapse";DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-spacing");c.removeAttribute("sticky")}else{if("top-left"==h){if(y)for(b=0;b<f.length;b++)for(d=0;d<w;d++)x=t[b][d].cell,DEXTTOP.DEXT5.util.removeStyleAttribute(x,"left");else for(g=0;g<f.length;g++)v=f[g],x=v.firstChild,DEXTTOP.DEXT5.util.removeStyleAttribute(x,
"left");c.setAttribute("sticky","top")}}else if(y){x=!1;for(b=0;b<t.length;b++)for(d=0;d<w;d++)t[b][d].col+t[b][d].colSpan>w&&(x=!0);if(x)c=dext5_lang.msg.sticky_not_allowed_in_table_structure,c=c.replace("{0}",dext5_lang.context.sticky_first_column),alert(c);else{for(b=0;b<t.length;b++)for(d=0;d<w;d++)if(x=t[b][d].cell,x.style.zIndex=b<v&&d<w?u+100:u,u--,x&&!x._handled&&x===t[b][d].cell){e=getComputedStyle(x).backgroundColor;x._handled=!0;a=0;h=new Set;for(g=0;g<d;g++)(y=t[b][g].cell)&&!h.has(y)&&
(a+=getClientRect(y).width,h.add(y));x.style.position="sticky";x.style.left=a+"px";"rgba(0, 0, 0, 0)"==e&&(x.style.backgroundColor="rgba(0, 0, 0, 0)"==m?"rgba(0, 0, 0, 0)"==q?"white":q:m)}for(b=0;b<f.length;b++)for(d=0;d<w;d++)(m=t[b][d].cell)&&m._handled&&delete m._handled;c.style.borderCollapse="separate";c.style.borderSpacing=0;c.setAttribute("sticky","left")}}else{for(g=0;g<f.length;g++)v=f[g],x=v.firstChild,e=getComputedStyle(x).backgroundColor,x.style.position="sticky",x.style.left="0px",x.style.zIndex=
u,u--,"rgba(0, 0, 0, 0)"==e&&(x.style.backgroundColor="rgba(0, 0, 0, 0)"==m?"rgba(0, 0, 0, 0)"==q?"white":q:m);c.style.borderCollapse="separate";c.style.borderSpacing=0;c.setAttribute("sticky","left")}break;case "sticky_table":if(g){for(g=0;g<f.length;g++)for(z=0;z<f[g].childNodes.length;z++)x=f[g].childNodes[z],DEXTTOP.DEXT5.util.removeStyleAttribute(x,"position"),DEXTTOP.DEXT5.util.removeStyleAttribute(x,"top"),DEXTTOP.DEXT5.util.removeStyleAttribute(x,"left"),DEXTTOP.DEXT5.util.removeStyleAttribute(x,
"z-index"),"white"!=x.style.backgroundColor&&x.style.backgroundColor!=m&&x.style.backgroundColor!=q||DEXTTOP.DEXT5.util.removeStyleAttribute(x,"background-color");c.style.borderCollapse="collapse";DEXTTOP.DEXT5.util.removeStyleAttribute(c,"border-spacing");c.removeAttribute("sticky")}else{v=f.length;w=0;e=[];x=!1;for(g=0;g<v;g++)h=f[g].childNodes.length,h>w&&(w=h),e.push(h);g=d(b,t,f);var w=g.tr,B=g.td;for(b=0;b<t.length;b++)for(f=t[b].length,d=0;d<f;d++)if(b<w&&t[b][d].row+t[b][d].rowSpan>w||d<B&&
t[b][d].col+t[b][d].colSpan>B)x=!0;if(x)c=dext5_lang.msg.sticky_not_allowed_at_position,c=c.replace("{0}",dext5_lang.context.table_sticky),alert(c);else{for(b=0;b<v;b++)for(f=t[b].length,d=0;d<f;d++)if(x=t[b][d].cell,e=getComputedStyle(x).backgroundColor,x.style.zIndex=b<w&&d<B?u+100:u,u--,x&&!x._handled&&x===t[b][d].cell){x._handled=!0;a=z=0;if(b<w){h=new Set;for(g=0;g<b;g++)(y=t[g][d].cell)&&y!==x&&!h.has(y)&&(z+=getClientRect(y).height,h.add(y));x.style.position="sticky";x.style.top=z+"px"}if(d<
B){h=new Set;for(z=0;z<d;z++)(y=t[b][z].cell)&&y!==x&&!h.has(y)&&(a+=getClientRect(y).width,h.add(y));x.style.position="sticky";x.style.left=a+"px"}"rgba(0, 0, 0, 0)"==e&&(x.style.backgroundColor="rgba(0, 0, 0, 0)"==m?"rgba(0, 0, 0, 0)"==q?"white":q:m)}for(b=0;b<v;b++)for(d=0;d<t[b].length;d++)(m=t[b][d].cell)&&m._handled&&delete m._handled;c.style.borderCollapse="separate";c.style.borderSpacing=0;c.setAttribute("sticky","all")}}}DEXTTOP.DEXT5.dextCommands("table_adjust",_dext_editor.ID);_dext_editor._iconEnable(_dext_editor.iconEnableCommandType,
!1,!0)};var ColorCellBackColor="#d0e6fd",ColorCellDefColor="#ffffff",Mouse_IsPlain=0,Mouse_IsTableSelecting=1,Mouse_IsTableDragging=2,Mouse_IsControlSelecting=3,Mouse_IsCellDragging=4,Mouse_IsCellResizing=5,Mouse_Status=Mouse_IsPlain,DrageStartCell=null,DrageEndCell=null,ActiveCurrTable=null,ActiveLastTable=null,mouseStartPos={},mouseEndPos={},elResizeBar,elResizeBarCover,ResizeInfo={},nDraggableCellEdge=4,nPageLeftRightMargin=0,nPageTopBottomMargin=0,MIN_CELL_WIDTH=10,MIN_CELL_HEIGHT=10;
function createTableResizeBar(a){a=document.getElementById("table_resizebar");if(null==a){a=document.createElement("div");try{a.innerHTML='<div id="table_resizebar" style="position:absolute; overflow:hidden; z-index: 99; "><div onmousedown="return false" style="background-color:#000000;filter:alpha(opacity=0);opacity:0.0;-moz-opacity:0.0;-khtml-opacity:0.0;cursor: col-resize; left: 0px; top: 0px; width: 100%; height: 100%;font-size:1px;z-index: 999; "></div></div>',elResizeBar=a.firstChild,elResizeBarCover=
elResizeBar.firstChild}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}document.body.appendChild(elResizeBar);DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"mousedown",_mousedown_ResizeBarCover);DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"dblclick",dbclick_ResizeBarCover);nPageLeftRightMargin=parseIntOr0(document.body.marginLeft)+parseIntOr0(document.body.marginRight);nPageTopBottomMargin=parseIntOr0(document.body.marginTop)+parseIntOr0(document.body.marginBottom)}}
function dbclick_ResizeBarCover(){if(3==ResizeInfo.nResizeMode||4==ResizeInfo.nResizeMode){var a=getFirstRange().sel;a&&a.docSelection&&"Control"==a.docSelection.type?(a=GetParentbyTagName(ResizeInfo.currCell,"table"),DEXTTOP.G_SELECTED_ELEMENT=ResizeInfo.currCell,DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,a)):(a._ranges.length=a.rangeCount=a.nativeSelection.rangeCount,a.rangeCount&&(a=GetParentbyTagName(ResizeInfo.currCell,
"table"),DEXTTOP.G_SELECTED_ELEMENT=ResizeInfo.currCell,DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,a)))}}var nStartHeight=0,nStartWidth=0;function coverResizeLayer(){elResizeBarCover.style.position="absolute";var a=getClientSize();elResizeBarCover.style.width=a.width-nPageLeftRightMargin+"px";elResizeBarCover.style.height=a.height-nPageTopBottomMargin+"px";document.body.appendChild(elResizeBarCover)}
function uncoverResizeLayer(){elResizeBar.appendChild(elResizeBarCover);elResizeBarCover.style.position="";elResizeBarCover.style.width="100%";elResizeBarCover.style.height="100%"}
function _mousedown_ResizeBarCover(a){a=getElementPos(a);nStartHeight=a.clientY;DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"mousemove",mousemove_ResizeBarCover);DEXTTOP.DEXT5.util.addEvent(document,"mouseup",mouseup_ResizeBarCover);coverResizeLayer();parseIntOr0(elResizeBar.style.width)>parseIntOr0(elResizeBar.style.height)?elResizeBar.style.height="1px":elResizeBar.style.width="1px";elResizeBar.style.border="1px dotted black";elResizeBar.style.fontSize="1pt";nStartWidth=a.clientX;nStartHeight=
a.clientY;onCellResize({cmd:"start"})}function mousemove_ResizeBarCover(a){a=getElementPos(a);1==ResizeInfo.nResizeMode?elResizeBar.style.left=a.pageX-parseIntOr0(elResizeBar.style.width)/2+"px":elResizeBar.style.top=a.pageY-parseIntOr0(elResizeBar.style.height)/2+"px"}
function mouseup_ResizeBarCover(a){hideResizeBar();uncoverResizeLayer();elResizeBar.style.border="";DEXTTOP.DEXT5.util.removeEvent(elResizeBarCover,"mousemove",mousemove_ResizeBarCover);DEXTTOP.DEXT5.util.removeEvent(document,"mouseup",mouseup_ResizeBarCover);var b=getElementPos(a),c=0,d=0,e=getCurrentZoomValue(DEXTTOP.G_CURREDITOR);2==ResizeInfo.nResizeMode&&(c=(b.clientY-nStartHeight)/e);1==ResizeInfo.nResizeMode&&(d=(b.clientX-nStartWidth)/e);b=GetParentbyTagName(ResizeInfo.currCell,"table");if(null!=
b){for(var e=[],f=0,g=b.rows.length,h=0;h<g;h++)for(var m=b.rows[h],q=m.cells.length,t=0;t<q;t++){var u=m.cells[t],v=getClientRect(u),w=getElementOffset(_iframeWin.frameElement);1==ResizeInfo.nResizeMode?nStartWidth<=v.right+w.left+2*nDraggableCellEdge&&nStartWidth>v.right+w.left-2*nDraggableCellEdge&&(w={},w.cell=u,w.right=v.right,e[f]=w,f+=1):2==ResizeInfo.nResizeMode&&nStartHeight<=v.bottom+w.top+2*nDraggableCellEdge&&nStartHeight>v.bottom+w.top-2*nDraggableCellEdge&&(w={},w.cell=u,w.right=v.bottom,
e[f]=w,f+=1)}setResizeCells(d,c,e);onChange({editor:DEXTTOP.G_CURREDITOR,isPossibleDirty:!0});onCellResize({cmd:"end",event:a})}}
function setResizeCells(a,b,c){var d=GetParentbyTagName(ResizeInfo.currCell,"table");if(null!=d&&!(0>=c.length||0==a&&0==b)){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var e=getCurrentZoomValue(DEXTTOP.G_CURREDITOR);try{if(0!=b)for(var f=c.length,g=0;g<f;g++){var h=c[g].cell.parentNode;if(1==h.nodeType&&("TR"==h.tagName||"TH"==h.tagName)&&""!=h.style.height){for(var m=h.cells.length,q=0;q<m;q++)h.cells[q].style.height=h.style.height;h.style.removeProperty?
h.style.removeProperty("height"):h.style.removeAttribute("height")}}}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}G_ResizeFixedTable.resizeFixedTable({nNewWidth:a,targetCell:ResizeInfo.currCell});for(var h=[],f=0,m=d.rows.length,g=0;g<m;g++)for(var u=d.rows[g],v=u.cells.length,q=0;q<v;q++){var w=u.cells[q],y=getClientRect(w);1==ResizeInfo.nResizeMode&&isSameRect(c[0].right,y.left)&&(h[f]=w,f+=1)}var x=0;if(1==ResizeInfo.nResizeMode){0<a&&0<h.length&&(y=getClientRect(h[0]),x=y.right-
y.left,x-a<MIN_CELL_WIDTH&&(a=x-MIN_CELL_WIDTH));0>a&&0<c.length&&(y=getClientRect(c[0].cell),x=y.right-y.left,x+a<MIN_CELL_WIDTH&&(a=MIN_CELL_WIDTH-x));if(0==h.length){g=parseIntOr0(d.style.width);if(""==d.style.width||""!=d.style.width&&-1<d.style.width.indexOf("%"))y=getClientRect(d),g=y.right-y.left;0<g+a&&0==G_ResizeFixedTable.isModifiedTable(d)&&(d.style.width=g+a+"px")}f=c.length;for(g=0;g<f;g++)getClientRect(c[g].cell),x=getElemAdjustWidthHeight(c[g].cell).width,e=a,x+a<MIN_CELL_WIDTH&&(e=
MIN_CELL_WIDTH-x),c[g].newWidth=x+e+"px";for(g=0;g<f;g++)c[g].cell.style.width=c[g].newWidth;f=h.length;e=[];for(g=0;g<f;g++)getClientRect(h[g]),x=getElemAdjustWidthHeight(h[g]).width,x-a<MIN_CELL_WIDTH&&(a=x-MIN_CELL_WIDTH),e[g]=x-a+"px";for(g=0;g<f;g++)h[g].style.width=e[g];if(d.getAttribute("sticky"))for(g=0;g<h.length;g++){var z=h[g],y=getClientRect(c[g].cell);z.style.left&&(z.style.left=y.width+"px")}}else{f=c.length;for(g=0;g<f;g++)y=getClientRect(c[g].cell),x=getElemAdjustWidthHeight(c[g].cell).height,
x+b<MIN_CELL_HEIGHT&&(b=MIN_CELL_HEIGHT-x),c[g].newHeight=x+b+"px";for(g=0;g<f;g++)c[g].cell.style.height=c[g].newHeight;try{if(0<f){a=[];for(var B=getClientRect(c[0].cell),m=d.rows.length,g=0;g<m;g++)for(u=d.rows[g],v=u.cells.length,q=0;q<v;q++)if(w=u.cells[q],y=getClientRect(w),y.top<=B.top&&y.bottom>=B.bottom){b=!1;for(h=0;h<f;h++)if(w==c[h].cell){b=!0;break}b||a.push(w)}for(var D=a.length,g=0;g<D;g++)a[g].style.height="";d.removeAttribute("height");d.style.height="";if("1"==DEXTTOP.G_CURREDITOR._config.tableUseHeight){var A=
getClientRect(d);d.style.height=(A.bottom-A.top)/e+"px"}for(g=0;g<D;g++){var C=getClientRect(a[g]);a[g].style.height=(C.bottom-C.top)/e+"px"}}if(d.getAttribute("sticky")){var E=GetParentbyTagName(c[0].cell,"tr").nextSibling;if(E)for(g=0;g<c.length;g++){var H=c[g].cell,z=E.childNodes[g],y=getClientRect(H);z.style.top&&(z.style.top=y.height+"px")}DEXTTOP.DEXT5.dextCommands("table_adjust",_dext_editor.ID)}}catch(M){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}setAdjustTableWidthHeight(d);
DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem&&(c=DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem,DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear(),DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem=c,clearInterval(DEXTTOP.G_CURREDITOR.dext_dragresize.dextResizeIconInterval),DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,
!1,null));try{setFocusToBody()}catch(N){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}
function setAdjustTableWidthHeight(a){if("0"!=DEXTTOP.G_CURREDITOR._config.tableAutoAdjust){var b,c,d;b=null;c=a.rows.length;if(0<c){var e=a.rows[0];d=e.cells.length;0<d&&(b=e.cells[0])}if(null!=b){var f,g;g=f=0;var h=[],m=[],q=getClientRect(b);for(b=0;b<c;b++){e=a.rows[b];d=e.cells.length;for(var t=0;t<d;t++){var u=e.cells[t],v=getClientRect(u);if(q.left==v.left){var w=v.bottom-v.top-1;g+=w}w=parseIntOr0(a.cellPadding);w=v.bottom-v.top-2-2*w+"px";h.push(w);q.top==v.top&&(w=v.right-v.left,f+=w);w=
v.right-v.left-1;1<u.colSpan&&(w=1*w/u.colSpan);w+="px";m.push(w)}}0<f&&0<g&&(a.style.width=f+"px",removeAttribute(a.style,"height"));for(b=f=0;b<c;b++)for(e=a.rows[b],d=e.cells.length,t=0;t<d;t++)u=e.cells[t],u.style.width=m[f],u.style.height=h[f],f++}}}function getPosition(a){for(var b=0,c=0;a;)b+=a.offsetLeft-a.scrollLeft+a.clientLeft,c+=a.offsetTop-a.scrollTop+a.clientTop,a=a.offsetParent;return{x:b,y:c}}function hideResizeBar(){elResizeBar.style.display="none"}
function showResizeBar(){elResizeBar.style.display="block";var a=getElementOffset(_iframeWin.frameElement);if(1==ResizeInfo.nResizeMode||3==ResizeInfo.nResizeMode){setResizeBarSize(2*(ResizeInfo.nBorderSize+nDraggableCellEdge),parseIntOr0(_iframeWin.frameElement.offsetHeight));var b=a.left+ResizeInfo.nBorderLeftPos+ResizeInfo.Pos.clientX-ResizeInfo.Pos.offsetX-parseIntOr0(elResizeBar.style.width);if(DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion&&"BackCompat"!=_iframeDoc.compatMode||
9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks))var c=getWindowScrollPos(_iframeWin),b=9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks&&0<c[0]?b+2:b+c[0];3==ResizeInfo.nResizeMode&&(b+=2);setElementOffset(elResizeBar,a.top,b)}else setResizeBarSize(parseIntOr0(_iframeWin.frameElement.offsetWidth+"px"),2*(ResizeInfo.nBorderSize+nDraggableCellEdge)),b=a.top+ResizeInfo.Pos.clientY+ResizeInfo.nBorderTopPos-ResizeInfo.Pos.offsetY-parseIntOr0(elResizeBar.style.height),
DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion&&"BackCompat"!=_iframeDoc.compatMode||9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks)&&(c=getWindowScrollPos(_iframeWin),b=9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks&&0<c[1]?b+nDraggableCellEdge:b+c[1]),4==ResizeInfo.nResizeMode&&(b+=2),setElementOffset(elResizeBar,b,a.left);DEXTTOP.DEXT5.util.removeEvent(elResizeBarCover,"mousedown",_mousedown_ResizeBarCover);DEXTTOP.DEXT5.util.removeEvent(elResizeBarCover,
"click",setTableSelectEvt);3==ResizeInfo.nResizeMode||4==ResizeInfo.nResizeMode?getApplyDragResize(DEXTTOP.G_CURREDITOR)||(elResizeBarCover.style.cursor="move",DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"click",setTableSelectEvt)):(DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"mousedown",_mousedown_ResizeBarCover),elResizeBarCover.style.cursor=1==ResizeInfo.nResizeMode?"col-resize":"row-resize")}
function setTableSelectEvt(){var a=GetParentbyTagName(ResizeInfo.currCell,"table");command_tableSelection(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,a)}function setResizeBarSize(a,b){elResizeBar.style.width=a+"px";elResizeBar.style.height=b+"px"}
function IsMousePointOnBorder(a){if(dragMove.dragStart)return!1;ResizeInfo.nResizeMode=0;ResizeInfo.currCell=a.target?a.target:a.srcElement;var b=ResizeInfo.currCell.tagName;if("TD"!=ResizeInfo.currCell.tagName&&"TH"!=ResizeInfo.currCell.tagName&&(ResizeInfo.currCell=GetTDTHCell(ResizeInfo.currCell),null==ResizeInfo.currCell))return!1;var c=GetParentbyTagName(ResizeInfo.currCell,"table");if(null==c)return!1;var d=DEXTTOP.G_CURREDITOR._config.tableNoResizeClass;if(""!=d&&c.className&&""!=c.className){for(var e=
c.className.split(" "),f=e.length,g=!1,h=0;h<f;h++)if(e[h]==d){g=!0;break}if(g)return!1}ResizeInfo.currTable=c;ResizeInfo.nBorderLeftPos=0;ResizeInfo.nBorderTopPos=-1;ResizeInfo.Pos="contextmenu"==a.type?getClientRect(ResizeInfo.currCell):getElementPos(a,!0,ResizeInfo.currCell.tagName);ResizeInfo.nBorderSize=parseIntOr0(c.border);DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.opera?(a=ResizeInfo.nBorderSize+nDraggableCellEdge,c=nDraggableCellEdge):(a=nDraggableCellEdge,c=ResizeInfo.nBorderSize+nDraggableCellEdge);
d=ResizeInfo.Pos.offsetX;e=ResizeInfo.Pos.offsetY;DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion&&"BackCompat"!=_iframeDoc.compatMode||9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks)&&(f=getWindowScrollPos(_iframeWin),d-=f[0],e-=f[1]);e<=a&&ResizeInfo.currCell.parentNode.previousSibling&&("td"==b.toLowerCase()||"th"==b.toLowerCase())&&(ResizeInfo.nResizeMode=2);ResizeInfo.currCell.offsetHeight-c<=e&&(ResizeInfo.nBorderTopPos=ResizeInfo.currCell.offsetHeight+a-1,ResizeInfo.nResizeMode=
2);b=1;9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks&&(f=getWindowScrollPos(_iframeWin),b=f[0]);if(ResizeInfo.currCell.offsetWidth-c<=d+b||DEXTTOP.DEXT5.browser.chrome&&0==ResizeInfo.Pos.offsetX)ResizeInfo.nBorderLeftPos=ResizeInfo.currCell.offsetWidth+a-1,ResizeInfo.nResizeMode=1;b=getClientRect(ResizeInfo.currTable);d=!1;e=!0;"1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use&&(f=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode,
ResizeInfo.currTable.getAttribute("lock_mode")&&""!=ResizeInfo.currTable.getAttribute("lock_mode")&&(f=ResizeInfo.currTable.getAttribute("lock_mode")),"1"==f&&(d=!0),checkLockAttr(ResizeInfo.currTable,d)&&(e=!1));e&&DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion&&(b.left+a>=ResizeInfo.Pos.clientX?ResizeInfo.nResizeMode=3:b.top+c>=ResizeInfo.Pos.clientY&&(ResizeInfo.nResizeMode=4));return 0===ResizeInfo.nResizeMode?!1:!0}function parseIntOr0(a){a=parseInt(a,10);return isNaN(a)?0:a}
function getClientSize(){var a={};"number"===typeof window.innerWidth?(a.width=window.innerWidth,a.height=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)?(a.width=document.body.clientWidth,a.height=document.body.clientHeight):(a.width=0,a.height=0);a.width=changeValueForZoom(a.width,
DEXTTOP.G_CURREDITOR);a.height=changeValueForZoom(a.height,DEXTTOP.G_CURREDITOR);return a}function setElementOffset(a,b,c){if("number"==typeof b&&"number"==typeof c){isNaN(parseInt(a.style.top,10))&&(a.style.top="0px");isNaN(parseInt(a.style.left,10))&&(a.style.left="0px");var d=getElementOffset(a);b-=d.top;c-=d.left;a.style.top=parseInt(a.style.top,10)+b+"px";a.style.left=parseInt(a.style.left,10)+c+"px"}}
function getElementPos(a,b,c){var d=a.target?a.target:a.srcElement;"string"==typeof c&&(c=GetParentInTag(d,c.toLowerCase()))&&(d=c);c=(d.ownerDocument||_iframeDoc).body;var e=(d.ownerDocument||_iframeDoc).documentElement,e=[c.scrollLeft||e.scrollLeft,c.scrollTop||e.scrollTop];a={clientX:a.clientX,clientY:a.clientY,pageX:"pageX"in a?a.pageX:a.clientX+e[0]-c.clientLeft,pageY:"pageY"in a?a.pageY:a.clientY+e[1]-c.clientTop};b&&(b=getElementOffset(d),d=getCurrentZoomValue(DEXTTOP.G_CURREDITOR),a.offsetX=
(a.pageX-b.left)/d,a.offsetY=(a.pageY-b.top)/d);return a}
function getElementOffset(a){var b={left:0,top:0},c=a.ownerDocument||a.document||_iframeDoc,d=c.documentElement,e=c.body,f;"undefined"!=typeof c.defaultView?f=c.defaultView:"undefined"!=typeof c.parentWindow&&(f=c.parentWindow);box=a.getBoundingClientRect();a=d.clientTop||e.clientTop||0;c=f.pageYOffset&&d.scrollTop||e.scrollTop;b.left=box.left+(f.pageXOffset&&d.scrollLeft||e.scrollLeft)-(d.clientLeft||e.clientLeft||0);b.top=box.top+c-a;return b}
function GetParentInTag(a,b){for(var c=a;null!=c&&(!c.tagName||"html"!=c.tagName.toLowerCase());){if(c.tagName.toLowerCase()==b)return c;c=c.parentNode}return null}function GetParentTagPath(a){for(var b="";null!=a&&(!a.tagName||"html"!=a.tagName.toLowerCase());)b=a.tagName.toLowerCase()+"&nbsp;"+b,a=a.parentNode;return b}function getMyElementNode(a){if(1==a.nodeType)return a;for(;null!=a;){if(1==a.nodeType)return a;a=a.parentNode}return null}
function getMyChildElementNode(a){if(3==a.nodeType)return a.parentNode;for(;null!=a.childNodes&&0<a.childNodes.length;){a=a.lastChild;if(3==a.nodeType)return a.parentNode;if("BR"==a.tagName||"IMG"==a.tagName)return a.previousSibling?getMyChildElementNode(a.previousSibling):a.parentNode}return 1==a.nodeType&&a.parentNode&&"BODY"!=a.parentNode.tagName?a.parentNode:null}
function getElementInParentStyleProperty(a,b){for(var c="",d=a;null!=d&&(!d.tagName||"body"!=d.tagName.toLowerCase());){var e="";if("fontSize"==b)if(d.tagName&&"FONT"==d.tagName){if(e=d.size,0==!!e||""==e)e=d.style[b]}else d.style&&(e=d.style[b]);else d.style&&(e=d.style[b]);if(""!=e&&(c=e,void 0!=c&&0<c.length))return c=c.replace(/"/gi,""),c=c.replace(/'/gi,""),"backgroundColor"!=b&&"color"!=b&&(c=c.split(",")[0]),("backgroundColor"==b||-1<b.indexOf("margin")||-1<b.indexOf("padding"))&&-1<",TD,TH,TABLE,TR,".indexOf(","+
d.tagName+",")&&(c=""),c;d=d.parentNode}"fontFamily"==b?c=getElementInParentProperty(a,"face"):"fontSize"==b&&(c=getElementInParentProperty(a,"size"));return void 0==c?"":c}function getElementInParentProperty(a,b){for(var c="",d=a;null!=d&&(!d.tagName||"body"!=d.tagName.toLowerCase());){if(void 0!=d[b]&&(c=d[b],0<c.length))return c=c.replace(/"/gi,""),c=c.replace(/'/gi,""),c=c.split(",")[0];d=d.parentNode}return void 0==c?"":c}
function getElementInParentTag(a,b){for(var c="",d=a,e="";null!=d&&(!(e=d.nodeName.toLowerCase())||"body"!=e);){for(var f=0;f<b.length;f++)if(e==b[f]){switch(e){case "b":case "strong":c="blod";break;case "em":case "i":c="italic";break;case "u":c="underline";break;case "s":case "strike":c="strike_through";break;case "sup":c="superscript";break;case "sub":c="subscript";break;case "ol":c="list_number";break;case "ul":c="list_bullets";break;case "h1":case "h2":case "h3":case "h4":case "h5":c=e}return c}d=
d.parentNode}return c}
function _iframeDoc_MouseDown(a){G_dext5plugIn&&1==G_dext5plugIn.hasContainer&&G_dext5plugIn.DEXT5SetFocus(0);var b=null,b=a?a:_iframeWin.event,b=b.target?b.target:b.srcElement,c=b.tagName?b.tagName.toLowerCase():null;if(c&&-1<c.indexOf("dext_diagonal"))DEXTTOP.DEXT5.util.cancelEvent(a);else{setDEXTWINDOC();var d=_dext_editor;d._RangeBlurBug=!0;d._LastRange=null;if(d.dext_dragresize&&d.dext_dragresize.G_dextResize_elem)DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion&&(checkClickOnScrollBar(a)?
d.isMouseDownOnScrollBar=!0:d.isMouseDownOnScrollBar=!1);else{if(getApplyDragResize(d)&&DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion&&("div"==c||"img"==c))return DEXTTOP.DEXT5.util.cancelEvent(a),!1;if(0!=checkContentEditable(d,b)){if(isRightClick(a))return DEXTTOP.DEXT5.util.cancelEvent(a),!1;if(!isViewMode(d)&&null!=b&&null!=c){setTimeout(function(){if(!G_dextResize_Elem_Flag){var a=getFirstRange().range.startContainer;3==a.nodeType&&(a=a.parentNode);for(;a&&a.tagName&&-1<a.tagName.indexOf("DEXT_DIAGONAL");)a=
a.previousSibling;G_CURSOR_ELEMENT=a;onChange({editor:d})}},10);if("1"!=d._config.formMode&&"1"==d._config.userTableLock.use){var e=GetTDTHCell(b),f;e&&(f=GetParentbyTagName(b,"table"));var g=d._config.userTableLock.defaultTableLockMode;f&&("2"==d._config.userTableLock.tableLockMode?checkLockAttr(f,!0)||checkLockAttr(e,!0)?f.getAttribute("lock_mode")&&""!=f.getAttribute("lock_mode")&&(g=f.getAttribute("lock_mode")):g="0":f.getAttribute("lock_mode")&&""!=f.getAttribute("lock_mode")&&(g=f.getAttribute("lock_mode")));
var h=!0;"1"==g?h=!1:"0"==g&&(h=!1,e=null);if(e){if(h&&checkLockAttr(f)){d.lastElemForLock?setFocusForLock(d.lastElemForLock):(b=findNoLockElem(f))?setFocusForLock(b):(window.focus(),document.body.focus());DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(e,!h)){d.lastElemForLock?setFocusForLock(d.lastElemForLock):setFocusForLock(findNoLockCell(f));DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}}}if("1"==d._config.formMode){if(a.ctrlKey)return setFormControlSelected(b),
DEXTTOP.DEXT5.util.cancelEvent(a),!1;clearAllFormControlSelected()}if("1"==d._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{"function"===typeof d._config.event.mouse?d._config.event.mouse("mousedown",a,b):"function"===typeof DEXTTOP.DEXTWIN.dext_mouse_event&&DEXTTOP.DEXTWIN.dext_mouse_event("mousedown",a,b)}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(c&&("textarea"==
c||"input"==c||"select"==c))return!1;try{var q=G_DEPlugin.mention;if(q)var t=q.onMouseDown({evt:a});if(!1===t){DEXTTOP.DEXT5.util.cancelEvent(a);return}}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("1"==d._config.adjustCursorInRelative&&(f=null,f=b.tagName&&"BODY"==b.tagName?b:getBlockContainer(b)))for(f=f.getElementsByTagName("span"),q=f.length,t=0;t<q;t++)"relative"==f[t].style.position&&(f[t].style.position="",d.relativeNode.push(f[t]));f=GetTDTHCell(b);null==f&&null!=ActiveCurrTable&&
ClearDraggingTableCellSelected();if(f){ActiveCurrTable=GetParentbyTagName(f,"table");try{ActiveLastTable?ActiveLastTable!=ActiveCurrTable&&(ClearDraggingTable(ActiveLastTable),ActiveLastTable=ActiveCurrTable):ActiveLastTable=ActiveCurrTable}catch(v){ActiveLastTable=ActiveCurrTable}"1"==d._config.ie11_BugFixed_JASO&&1==b.nodeType&&"TD"==b.nodeName&&(RegExp("<p([^>?+]*)></p>","gi").test(b.innerHTML),f=ReplaceAll(b.innerHTML,RegExp.$1,""),""!=RegExp.$1&&"<p></p>"==f?b.innerHTML="<p "+RegExp.$1+"><br /></p>":
"<p></p>"==b.innerHTML&&(b.innerHTML="<p><br /></p>"))}null!=ActiveCurrTable&&b==ActiveCurrTable?Mouse_Status=Mouse_IsTableDragging:(c=b.tagName.toLowerCase(),"img"==c||"hr"==c?("img"==c&&(DEXTTOP.G_SELECTED_IMAGE_ELEMENT=b),Mouse_Status=Mouse_IsControlSelecting):(q=null,q=GetTDTHCell(b),null==q?(Mouse_Status=Mouse_IsPlain,ClearDraggingTableCellSelected(),DrageStartCell=null,DEXTTOP.G_SELECTED_ELEMENT=b):(f=!1,t=d._config.tableNoSelectionClass,""!=t&&(f=GetParentbyTagName(b,"table"),f=checkContainClass(f,
t)),0==f&&(Mouse_Status=Mouse_IsCellDragging,a.shiftKey?(a=getFirstRange().range.startContainer,DrageStartCell=GetTDTHCell(a),SelectedCellRange(DrageStartCell,q)):(ClearDraggingTableCellSelected(),removeCellDefValue(q,!1),mouseStartPos=getMousePosition(a),DrageStartCell=q,DrageEndCell=null,DEXTTOP.G_SELECTED_ELEMENT=b)))))}}}}}
function _iframeDoc_MouseUp(a){if(!dragMove.dragStart){setDEXTWINDOC();var b=_dext_editor;b._RangeBlurBug=!1;if(isRightClick(a))return DEXTTOP.DEXT5.util.cancelEvent(a),!1;if(!isViewMode(b)){var c=null,d=a?a:_iframeWin.event,c=d.target?d.target:d.srcElement;if("1"==b._config.adjustCursorInRelative){for(d=b.relativeNode.length-1;0<=d;d--)b.relativeNode[d].style.position="relative";b.relativeNode=[]}if(0==checkContentEditable(b,c))DEXTTOP.DEXT5.util.cancelEvent(a),b._iconEnable("editableFalse");else{if(!G_dextResize_Elem_Flag){d=
getFirstRange().range.startContainer;3==d.nodeType&&(d=d.parentNode);for(;d&&d.tagName&&-1<d.tagName.indexOf("DIAGONAL");)d=d.previousSibling;G_CURSOR_ELEMENT=d;set_ruler_vertical_height(b)}G_dextResize_Elem_Flag=!1;if(b.useFocusDivForIOS&&(b.useFocusDivForIOS=!1,d=document.getElementById("ue_editor_holder_"+b.ID))){var e=getClientRect(d),f=document.createElement("div");f.style.width="100%";f.style.height="100%";f.style.position="absolute";f.style.left=e.left+"px";f.style.top=e.top+"px";f.style.zIndex=
b._config.zIndex+10;e=document.createElement("textarea");e.style.width="100%";e.style.height="100%";f.appendChild(e);d.appendChild(f);e.focus();e.blur();d.firstChild.contentWindow.document.body.focus();d.removeChild(f)}if("1"!=b._config.formMode&&"1"==b._config.userTableLock.use){var f=GetTDTHCell(c),g;f&&(g=GetParentbyTagName(c,"table"));e=b._config.userTableLock.defaultTableLockMode;g&&("2"==b._config.userTableLock.tableLockMode?checkLockAttr(g,!0)||checkLockAttr(f,!0)?g.getAttribute("lock_mode")&&
""!=g.getAttribute("lock_mode")&&(e=g.getAttribute("lock_mode")):e="0":g.getAttribute("lock_mode")&&""!=g.getAttribute("lock_mode")&&(e=g.getAttribute("lock_mode")));d=!0;"1"==e?d=!1:"0"==e&&(d=!1,f=null);if(f){e=!1;if(e=d?!checkLockAttr(f)&&!checkLockAttr(g):!checkLockAttr(f,!d))"TABLE"==c.tagName?checkLockAttr(c,!d)?b.lastElemForLock=findNoLockElem(c):(f=findNoLockCell(c),b.lastElemForLock=f):b.lastElemForLock=c;if(d&&checkLockAttr(g)){if(b.lastElemForLock)setFocusForLock(b.lastElemForLock);else{var h=
findNoLockElem(g);h?setFocusForLock(h):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}}else"0"!=e&&("BODY"!=c.tagName&&("TABLE"==c.tagName?checkLockAttr(c,!d)?b.lastElemForLock=findNoLockElem(c):(f=findNoLockCell(c),b.lastElemForLock=f):b.lastElemForLock=c),checkLockElemInSelectionRange());d||(d=getFirstRange().range.startContainer,3==d.nodeType&&(d=d.parentNode),(f=GetParentbyTagName(d,"td"))&&checkLockAttr(f,!0)&&(b.lastElemForLock?
setFocusForLock(b.lastElemForLock):(g=GetParentbyTagName(f,"td"),setFocusForLock(findNoLockCell(g)))));f=GetTableSelectionCells();e=f.length;if(0<e){for(var m=!1,d=0;d<e;d++){if(checkLockAttr(f[d],!0)){m=!0;break}else{var q=[];q.push(f[d].getElementsByTagName("table"));q.push(f[d].getElementsByTagName("td"));var t=q.length;for(j=0;j<t;j++){var u=q[j].length;for(k=0;k<u;k++)if(checkLockAttr(q[j][k],!0)){m=!0;break}if(m)break}}if(m)break}m&&(b.lastElemForLock?setFocusForLock(b.lastElemForLock):setFocusForLock(findNoLockCell(g)),
ClearDraggingTableCellSelected())}(g=getSelectionTable(b))&&checkLockAttr(g)&&(b.lastElemForLock?setFocusForLock(b.lastElemForLock):setFocusForLock(findNoLockCell(g)))}g=c.tagName?c.tagName.toLowerCase():null;if("2"==b._config.olUlTagMode&&(e=GetParentbyTagName(c,"li")))if(d=getFirstRange().range,f=e.innerHTML,f=f.replace(/(<([^>]+)>)/ig,""),""==f)e.innerHTML=unescape("%u200B");else if(1==d.collapsed){f=d.endContainer;if(GetParentbyTagName(3==f.nodeType?f.parentNode:f,"li")!=e){f=e;try{var v=f.innerHTML.toLowerCase(),
w=v.indexOf("ol"),y=v.indexOf("ul"),v="";-1<w&&0>y?v="ol":0>w&&-1<y?v="ul":-1<w&&-1<y&&(v=w<y?"ol":"ul");if(""!=v){var x=f.getElementsByTagName(v)[0],z=_iframeDoc.createTextNode(unescape("%u200B"));f.insertBefore(z,x);d.setStartBefore(z);d.setEndBefore(z);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(d)}}catch(B){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}for(w=null;;){if(f.nextSibling&&("OL"==f.nextSibling.tagName||"UL"==f.nextSibling.tagName)){w=
f.nextSibling;break}if(0==!!f.parentNode||"LI"==f.parentNode.tagName||"BODY"==f.parentNode.tagName)break;f=f.parentNode}w&&((z=w.previousSibling)&&3==z.nodeType&&z.data==unescape("%u200B")?(d.setStartBefore(z),d.setEndBefore(z),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(d)):(z=_iframeDoc.createTextNode(unescape("%u200B")),w.parentNode.insertBefore(z,w)))}if("input"==g&&(z=!1,DEXTTOP.DEXT5.browser.ie&&(z=c.disabled?!1:!0),z&&(DEXTTOP.G_SELECTED_ELEMENT=
c,"checkbox"==c.type.toLowerCase()||"radio"==c.type.toLowerCase())))if(1==c.checked)c.checked=!1,c.removeAttribute("checked");else{if("radio"==c.type.toLowerCase())for(z=_iframeDoc.getElementsByName(c.name),w=z.length,d=0;d<w;d++)z[d].checked=!1,z[d].removeAttribute("checked");c.checked=!0;c.setAttribute("checked","checked")}if(g&&("textarea"==g||"input"==g||"select"==g)&&"1"!=b._config.formMode)return!1;if("1"==b._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{"function"===
typeof b._config.event.mouse?b._config.event.mouse("mouseup",a,c):"function"===typeof DEXTTOP.DEXTWIN.dext_mouse_event&&DEXTTOP.DEXTWIN.dext_mouse_event("mouseup",a,c)}catch(D){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(Mouse_Status==Mouse_IsCellDragging){if(DEXTTOP.DEXT5.browser.ie)try{_iframeDoc.body.releaseCapture()}catch(A){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}Mouse_Status=
Mouse_IsPlain;try{var C=GetTDTHCell(c);C?"true"==C.getAttribute("dext_select")?h=""==ReplaceAll(C.innerHTML," ","")||1==checkCellDefValue(C.innerHTML)?1:2:(ClearDraggingTableCellSelected(),DrageEndCell=null,h=3):DrageEndCell&&(h=""==ReplaceAll(DrageEndCell.innerHTML," ","")||1==checkCellDefValue(DrageEndCell.innerHTML)?1:2);switch(h){case 1:setTimeout(function(){b._iconSelected();try{DrageEndCell?DrageEndCell.firstChild&&"P"==DrageEndCell.firstChild.tagName?doSetCaretPosition(DrageEndCell.firstChild,
0):doSetCaretPosition(DrageEndCell,0):C&&(C.firstChild&&"P"==C.firstChild.tagName?doSetCaretPosition(C.firstChild,0):doSetCaretPosition(C,0))}catch(a){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},0);break;case 2:setTimeout(function(){try{var a;DrageEndCell?a=DrageEndCell:C&&(a=C);if(DEXTTOP.DEXT5.browser.ie){var c=getCellLastChildNode(a);doSetCaretPosition(c.node,c.position)}else a=a.lastChild,a=getMyChildElementNode(a),doSetCaretPosition(a,1);b._iconSelected()}catch(d){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},0);break;case 3:break;default:b._iconSelected();try{DrageEndCell?doSetCaretPosition(DrageEndCell,0):C&&doSetCaretPosition(C,0)}catch(E){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}catch(H){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}try{var M=G_DEPlugin.mention;if(M)var N=M.onMouseUp({evt:a});if(!1===N){DEXTTOP.DEXT5.util.cancelEvent(a);return}}catch(I){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(h=c.tagName)if(h=
h.toLowerCase(),"img"==h)0==Mouse_Status&&(c.getAttribute("raon_chart")&&c.setAttribute("raon_plugin","chart"),onResize({cmd:"end",isResize:getApplyDragResize(b),target:c}),b.UndoManager.putUndo(),b.UndoManager.charCount=0);else if("html"==h){if(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion&&(b.isMouseDownOnScrollBar||checkClickOnScrollBar(a)))return;setFocusToBody()}G_Ruler&&"2"==b._config.ruler.mode&&G_Ruler.SetRulerPosition();if(DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion)try{setTimeout(function(){var a,
d=getFirstRange().range;d&&d.startContainer==d.endContainer&&1==d.collapsed&&(a=getMyElementNode(d.startContainer));if(1==d.collapsed&&("undefined"==typeof a&&"a"==getMyElementNode(d.startContainer).tagName.toLowerCase()&&(a=getMyElementNode(d.startContainer)),null==a)){var e=!1;try{var f;d.startContainer&&d.startContainer.tagName&&(f=d.startContainer.tagName.toLowerCase());var g=getElementsFromSelection(f);f?DEXTTOP.DEXT5.browser.ie&&(8>DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)?
1==g.length&&"IMG"==g[0].tagName&&(e=!0):2==g.length&&"IMG"==g[1].tagName&&(e=!0):3==g.length&&"IMG"==g[2].tagName&&(e=!0)}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}!e&&c&&0>",div,img,table,input,textarea,select,hr,".indexOf(","+c.tagName.toLowerCase()+",")&&(c.tagName&&"P"==c.tagName&&"TD"==c.parentNode.tagName?doSetCaretPosition(c,1):c.tagName&&"SPAN"==c.tagName&&"raon_placeholder"==c.className||("VIDEO"==c.tagName?(setFocusToBody(),e=getFirstRange().sel,d.setStartBefore(c),
d.setEndBefore(c),e.removeAllRanges(),e.addRange(d)):(setFocusToBody(),setFocusChildForStyle(b._BODY),(d=getFirstRange().range)&&d.startContainer==d.endContainer&&1==d.collapsed&&(a=getMyElementNode(d.startContainer)))))}if(11<=DEXTTOP.DEXT5.browser.ieVersion){if("undefined"==typeof a&&d.endContainer&&(a=getMyElementNode(d.endContainer)),a&&"P"==a.nodeName&&a.lastChild&&"BR"==a.lastChild.nodeName&&a.lastChild.previousSibling&&(d=d.getBoundingDocumentRect(),Math.round(d.right)==Math.round(getClientRect(a.lastChild).right))){for(a=
a.lastChild.previousSibling;a&&a.lastChild;)a=a.lastChild;a=getMyElementNode(a)}}else if(a)if(a=getFirstRange().sel.focusNode)for(;1!=a.nodeType;)a=a.parentNode;else a=getMyElementNode(d.startContainer);a&&setMenuIconRealable(a)},10)}catch(S){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}onChange({editor:b,isPossibleDirty:!0})}}}}
function CheckNoWhere(a,b,c){var d=b.Y,e=_iframeDoc.body.clientHeight,f=_iframeDoc.body.firstChild,g=_iframeDoc.body.lastChild;b=!1;a="spanTag_NoWhere_"+DEXTTOP.G_CURREDITOR.ID;if(10>=d&&-1<",table,hr,div,ul,ol,dl,form,blockquote,".indexOf(","+f.tagName.toLowerCase()+","))b=!0;else if(d>=e&&-1<",table,hr,div,ul,ol,dl,form,blockquote,".indexOf(","+g.tagName.toLowerCase()+","))b=!0;else if(10<d&&d<e){b=!1;d=" table hr div ul ol dl form blockquote ".split(" ");f=e=null;for(g=0;g<d.length&&(e=GetParentInTag(c,
d[g]),null==e);g++);if(null!=e)if(null==e.previousSibling)b=!0,getElementOffset(e);else{for(g=0;g<d.length&&(f=GetParentInTag(e.previousSibling,d[g]),null==f);g++);null!=e&&null!=f&&(b=!0,getElementOffset(e))}}else if(f.id==a)return;0==b?(c=_iframeDoc.getElementById(a),null!=c&&_iframeDoc.body.removeChild(c)):(c=_iframeDoc.getElementById(a),null==c&&(c=_iframeDoc.createElement("span"),c.setAttribute("id",a),c.innerHTML="",_iframeDoc.body.insertBefore(c,_iframeDoc.body.firstChild)))}
function _iframeDoc_MouseMove(a){var b=_dext_editor;if(!isViewMode(b))if(getApplyDragResize(b)&&b.dext_dragresize&&b.dext_dragresize.G_dextResize_elem&&b.dext_dragresize.G_isDrag)b.dext_dragresize.dragElem(a,"doc"),DEXTTOP.DEXT5.util.cancelEvent(a);else{var c=null,d=a?a:_iframeWin.event,c=d.target?d.target:d.srcElement,e=c.tagName?c.tagName.toLowerCase():null;set_ruler_mouse_guide(b,d);if(null!=e&&Mouse_Status!=Mouse_IsCellResizing&&Mouse_Status!=Mouse_IsTableDragging&&null!=c){if("1"==b._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=
!1;try{"function"===typeof b._config.event.mouse?b._config.event.mouse("mousemove",a,c):"function"===typeof DEXTTOP.DEXTWIN.dext_mouse_event&&DEXTTOP.DEXTWIN.dext_mouse_event("mousemove",a,c)}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if("1"==b._config.clickCtrlHyperlink)if("a"==c.tagName.toLowerCase()||c.parentElement&&"a"==c.parentElement.tagName.toLowerCase()){b.isAOver.linkStyle&&!a.ctrlKey&&
hyperLinkOut();d=c;"a"!=c.tagName.toLowerCase()&&(d=c.parentElement);var g=null;"a"!=c.tagName.toLowerCase()&&(g=c);if(!d.getAttribute("href")||-1<d.getAttribute("href").indexOf("#"))return;if(b.isAOver.node!=d&&!b.isAOver.openHelp){var h=a.clientX,m=a.clientY;b.isAOver={over:!0,node:d,nodeChild:g,linkStyle:!1};b.isAOver.timer=setTimeout(function(){hyperHelpOpen(h,m)},500)}}else b.isAOver.timer&&(clearTimeout(b.isAOver.timer),b.isAOver.node=null,b.isAOver.nodeChild=null),b.isAOver.linkStyle&&hyperLinkOut(),
b.isAOver.openHelp&&hyperHelpClose(),b.isAOver.timer=null;d=GetTDTHCell(c);mouseEndPos=getMousePosition(a);if(isLeftClick(a)&&Mouse_Status==Mouse_IsCellDragging){if(null!=d&&null!=DrageStartCell&&(DrageStartCell!=d||0!=GetTableSelectionCells().length)&&(GetParentbyTagName(c,"table")==ActiveCurrTable&&(DrageEndCell=d),SelectedCellRange(DrageStartCell,d),DEXTTOP.DEXT5.browser.ie&&setAutoScroll(mouseEndPos),DEXTTOP.DEXT5.browser.ie))try{_iframeDoc.body.setCapture(!1)}catch(q){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}}else"img"!=e&&"hr"!=e&&"div"!=e&&"a"!=e&&(Mouse_Status=Mouse_IsPlain),DEXTTOP.DEXT5.browser.mobile||(null!=d?(c=!1,null!=b.dext_dragresize&&b.dext_dragresize.G_ResizeHandlerActivatedFlag||(c=!0),IsMousePointOnBorder(a)&&c?d.isContentEditable&&showResizeBar():hideResizeBar()):hideResizeBar())}}}function _iframeDoc_MouseOut(a){setDEXTWINDOC();a=_dext_editor;isViewMode(a)||(a.isAOver.linkStyle&&hyperLinkOut(),a.isAOver.openHelp&&hyperHelpClose())}
function setAutoScroll(a){var b=getElementOffset(_iframeWin.frameElement),c,d;c=_iframeWin.frameElement.offsetHeight;d=_iframeWin.frameElement.offsetWidth;var b=b.left+d,e,f;DEXTTOP.DEXT5.browser.ie?(e=_iframeDoc.documentElement.scrollLeft+_iframeDoc.body.scrollLeft,f=_iframeDoc.documentElement.scrollTop+_iframeDoc.body.scrollTop):(e=_iframeWin.scrollX,f=_iframeWin.scrollY);a.X+20>b&&_iframeWin.scroll(e+30,f);0<e&&a.X-20<b-d&&_iframeWin.scroll(e-30,f);a.Y+20>c&&_iframeWin.scroll(e,f+30);0<f&&a.Y-
20<c-c&&_iframeWin.scroll(e,f-30)}function isLeftClick(a){return a.which?1==a.which:a.button?1==a.button:!1}function isRightClick(a){var b=!1;a=a||window.event;a.which||void 0===a.button||(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);switch(a.which){case 1:b=!1;break;case 2:b=!1;break;case 3:b=!0;break;case 0:0==a.button&&(b=!0)}return b}
function ClearDraggingTableCellSelected(){if(null!=ActiveCurrTable&&ActiveCurrTable.getAttribute("DEXT5CellSelected"))try{ActiveCurrTable.removeAttribute("DEXT5CellSelected");for(var a=ActiveCurrTable,b=a.rows.length,c=0;c<b;c++)for(var d=a.rows[c],e=d.cells.length,f=0;f<e;f++){var g=d.cells[f];"true"==g.getAttribute("dext_select")&&(g.style.backgroundColor=g.getAttribute("cellOrgBgColor"),removeAttribute(g,"cellOrgBgColor"),removeAttribute(g,"dext_select"),removeEmptyStyleTag(g))}}catch(h){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function ClearDraggingTable(a){if(null!=a&&a.getAttribute("DEXT5CellSelected"))try{a.removeAttribute("DEXT5CellSelected");for(var b=a.rows.length,c=0;c<b;c++)for(var d=a.rows[c],e=d.cells.length,f=0;f<e;f++){var g=d.cells[f];"true"==g.getAttribute("dext_select")&&(g.style.backgroundColor=g.getAttribute("cellOrgBgColor"),removeAttribute(g,"cellOrgBgColor"),removeAttribute(g,"dext_select"),removeEmptyStyleTag(g))}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function ClearDraggingTableAllTable(a){try{var b=_iframeDoc;a&&(b=a);for(var c=b.getElementsByTagName("TABLE"),d=c.length,e=b=null,f=0,g=0,h=0,m=0;m<d;m++)if(b=c[m],f=b.rows.length,b.getAttribute("DEXT5CellSelected")){try{if(a){var q=b.cloneNode();q.innerHTML=b.innerHTML;b.parentNode.replaceChild(q,b);b=q}}catch(t){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}b.removeAttribute("DEXT5CellSelected");for(var u=0;u<f;u++)for(var g=b.rows[u],h=g.cells.length,v=0;v<h;v++)e=g.cells[v],"true"==
e.getAttribute("dext_select")&&(e.style.backgroundColor=e.getAttribute("cellOrgBgColor"),removeAttribute(e,"cellOrgBgColor"),removeAttribute(e,"dext_select"),removeEmptyStyleTag(e))}}catch(w){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function colorToHex(a){if(6>a.length)return"#tttttt";if("#"===a.substr(0,1))return a;a=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a);if(null==a)return"#tttttt";var b=parseInt(a[2]),c=parseInt(a[3]),b=parseInt(a[4])|c<<8|b<<16;return a[1]+"#"+b.toString(16)}function removeAttribute(a,b){if(null!=a)try{a.removeProperty?a.removeProperty(b):a.removeAttribute(b)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function getClientRect(a){var b={left:0,top:0,right:0,bottom:0};try{b=a.getBoundingClientRect()}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return b}function getMousePosition(a){var b={};if(a.clientX||a.clientY)b.X=Math.round(a.clientX),b.Y=Math.round(a.clientY);else if(a.pageX||a.pageY)b.X=Math.round(a.pageX),b.Y=Math.round(a.pageY);return b}
function SelectedCellRange(a,b,c){c=GetParentbyTagName(a,"tr");var d=GetParentbyTagName(b,"tr");if(null!=c&&null!=d&&(ActiveCurrTable=GetParentbyTagName(c,"table"),ClearDraggingTableCellSelected(),a!=b)){c=getClientRect(a);var e=getClientRect(b),d=function(a,b){null==a?a={left:b.left,top:b.top,right:b.right,bottom:b.bottom}:(b.left<a.left&&(a.left=b.left),b.right>a.right&&(a.right=b.right),b.top<a.top&&(a.top=b.top),b.bottom>a.bottom&&(a.bottom=b.bottom));return a};a=function(a,b){var c=0;b.left>=
a.left&&b.right<=a.right&&b.top>=a.top&&b.bottom<=a.bottom?c=2:!(1>Math.abs(b.left-a.right))&&b.left<a.right&&!(1>Math.abs(b.right-a.left))&&b.right>a.left&&!(1>Math.abs(b.top-a.bottom))&&b.top<a.bottom&&!(1>Math.abs(b.bottom-a.top))&&b.bottom>a.top&&(c=1);return c};c=d(null,c);c=d(c,e);for(e=ActiveCurrTable.rows.length;;){for(var f=0,g=0;g<e;g++){for(var h=ActiveCurrTable.rows[g],m=h.cells.length,q=0;q<m;q++){var f=h.cells[q],t=getClientRect(f),f=a(c,t);if(1==f){c=d(c,t);break}}if(1==f)break}if(1!=
f)break}d=!1;for(g=0;g<e;g++)for(h=ActiveCurrTable.rows[g],m=h.cells.length,q=0;q<m;q++)f=h.cells[q],t=getClientRect(f),2==a(c,t)&&(null!=f.getAttribute("cellOrgBgColor")&&f.removeAttribute("cellOrgBgColor"),f.setAttribute("cellOrgBgColor",f.style.backgroundColor),f.style.backgroundColor=ColorCellBackColor,"1"==DEXTTOP.G_CURREDITOR._config.setDefaultTagInEmptyCell&&setCellDefValue(f),f.setAttribute("dext_select","true"),d=!0);if(d)try{if(DrageEndCell=b,ActiveCurrTable.setAttribute("DEXT5CellSelected",
"DEXT5CellSelected"),"1"==DEXTTOP.G_CURREDITOR._config.cellSelectionMode){var u=getFirstRange().sel;u&&u.removeAllRanges&&u.removeAllRanges()}}catch(v){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}function GetTDTHCell(a){3==a.nodeType&&(a=a.parentNode);if(a&&a.nodeName.match(/t[dh]/i))return a;for(;null!=a&&!a.nodeName.match(/t[dh]/i);)a=a.parentNode;return a}
function CanMerge(){if(null==ActiveCurrTable)return 0;for(var a=0,b,c,d,e,f,g,h,m,q=0;q<ActiveCurrTable.rows.length;q++)for(var t=ActiveCurrTable.rows[q],u=0;u<t.cells.length;u++)if(h=t.cells[u],"true"==h.getAttribute("dext_select")){var v=h.colSpan,w=h.rowSpan,a=a+v*w;m=getClientRect(h);f=m.left;g=m.top;h=m.right;m=m.bottom;"number"!=typeof b?(b=parseInt(f,10),c=parseInt(g,10),d=parseInt(h,10),e=parseInt(m,10)):(b>f&&(b=parseInt(f,10)),c>g&&(c=parseInt(g,10)),d<h&&(d=parseInt(h,10)),e<m&&(e=parseInt(m,
10)))}for(q=g=f=0;q<ActiveCurrTable.rows.length;q++)for(t=ActiveCurrTable.rows[q],u=0;u<t.cells.length;u++)if(h=t.cells[u],m=getClientRect(h),b<=parseInt(m.left,10)&&c<=parseInt(m.top,10)&&d>=parseInt(m.right,10)&&e>=parseInt(m.bottom,10)||b>parseInt(m.left,10)&&c<=parseInt(m.top,10)&&b<parseInt(m.right,10)&&e>=parseInt(m.bottom,10)||d>parseInt(m.left,10)&&c<=parseInt(m.top,10)&&d<parseInt(m.right,10)&&e>=parseInt(m.bottom,10)||b<=parseInt(m.left,10)&&e>parseInt(m.top,10)&&d>=parseInt(m.right,10)&&
e<parseInt(m.bottom,10)||b<=parseInt(m.left,10)&&c>parseInt(m.top,10)&&d>=parseInt(m.right,10)&&c<parseInt(m.bottom,10))v=h.colSpan,w=h.rowSpan,f+=v*w,d==m.right&&(g+=h.rowSpan);b=0;0<g&&(b=a/g);return"number"==typeof b&&0<b.toString().indexOf(".")?!1:f==a&&1<f?f:0}
function command_mergeCell(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(0!=CanMerge()){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var c,d,e,f,g,h,m,q,t="";ActiveCurrTable&&(t=ActiveCurrTable.style.borderCollapse,ActiveCurrTable.style.borderCollapse="");for(var u=!0,v=!0,w=0;w<ActiveCurrTable.rows.length;w++)for(var y=ActiveCurrTable.rows[w],x=0;x<y.cells.length;x++){var z=y.cells[x];"true"==z.getAttribute("dext_select")&&
(q=getClientRect(z),g=q.left,h=q.top,m=q.right,q=q.bottom,v&&findDiagonal(z,!0)&&(u=!1),v&&u&&deleteDiagonalLine(z),!v&&u&&deleteDiagonalLine(z),v=!1,u=!0,"number"!=typeof c?(c=g,d=h,e=m,f=q):(c>g&&(c=g),d>h&&(d=h),e<m&&(e=m),f<q&&(f=q)))}m=h="";u=v=0;g=null;for(w=0;w<ActiveCurrTable.rows.length;w++)for(y=ActiveCurrTable.rows[w],x=0;x<y.cells.length;x++)z=y.cells[x],q=getClientRect(z),c<=q.left&&d<=q.top&&e>=q.right&&f>=q.bottom&&(d==q.top&&c==q.left?(g=z,m=z.innerHTML):z.style.visibility="hidden",
h+=removeCellDefValue(z,!0),1>Math.abs(c-q.left)&&(u+=z.rowSpan),1>Math.abs(d-q.top)&&(v+=z.colSpan));if(g){q=0;c=getClientRect(g);for(w=ActiveCurrTable.rows.length-1;0<=w;w--)for(y=ActiveCurrTable.rows[w],x=y.cells.length-1;0<=x;x--)z=y.cells[x],d=getClientRect(z),"hidden"==z.style.visibility&&(c.top==d.top&&(q+=parseIntOr0(z.style.width)),c.right==d.left&&c.top!=d.top&&parseIntOr0(z.style.height));0<q&&(g.style.width=parseIntOr0(g.style.width)+q+"px")}w=!1;g&&(w=!0);if(w){ActiveCurrTable.style.borderCollapse=
"";e=d=0;f=[];c=getClientRect(g);for(w=0;w<ActiveCurrTable.rows.length;w++)for(nTemp=0,y=ActiveCurrTable.rows[w],x=0;x<y.cells.length;x++)z=y.cells[x],q=getClientRect(z),(c.left!=q.left||c.right!=q.right)&&c.left<=q.left&&c.right>=q.right&&(0==nTemp&&f.push(z),nTemp+=z.colSpan),c.bottom==q.top&&(e=nTemp),c.top==q.bottom&&(d=nTemp);0<d||0<e?g.colSpan=d<e?e:d:removeAttribute(g,"colSpan");if(f.length==ActiveCurrTable.rows.length){for(w=0;w<f.length;w++)removeAttribute(f[w],"colSpan");removeAttribute(g,
"colSpan")}}if(g){1<v&&(g.colSpan=v);1<u&&(g.rowSpan=u);q=!1;for(w=ActiveCurrTable.rows.length-1;0<=w;w--){y=ActiveCurrTable.rows[w];for(x=y.cells.length-1;0<=x;x--)z=y.cells[x],"hidden"==z.style.visibility&&(q||(g.style.borderRightStyle=z.style.borderRightStyle,g.style.borderRightColor=z.style.borderRightColor,g.style.borderRightWidth=z.style.borderRightWidth,g.style.borderBottomStyle=z.style.borderBottomStyle,g.style.borderBottomColor=z.style.borderBottomColor,g.style.borderBottomWidth=z.style.borderBottomWidth,
replaceClassForBorder(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._BODY,"show"),q=!0),y.deleteCell(x));0==y.cells.length&&deleteRow(y)}g.innerHTML=0==h.length?""!=m?m:DEXTTOP.DEXT5.browser.ie?"":getCellDefValue():h;try{DEXTTOP.DEXT5.browser.gecko?0==h.length?setFocusChildForStyle(g.childNodes[0]):setGeckoCellCaretPosistion(g,!0):(setFocusChildForStyle(g.childNodes[0]),removeCellDefValue(g,!1))}catch(B){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}ClearDraggingTableCellSelected();if(1==ActiveCurrTable.rows.length)for(y=
ActiveCurrTable.rows[0],x=0;x<y.cells.length;x++)z=y.cells[x],removeAttribute(z,"rowSpan"),removeAttribute(z,"colSpan");1==ActiveCurrTable.rows.length&&1==ActiveCurrTable.rows[0].cells.length&&(removeAttribute(ActiveCurrTable.rows[0].cells[0],"width"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"height"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"colSpan"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"rowSpan"));if(g&&1<g.colSpan&&1<ActiveCurrTable.rows.length){m=0;h=[];c=getClientRect(g);
for(w=0;w<ActiveCurrTable.rows.length;w++)for(y=ActiveCurrTable.rows[w],x=0;x<y.cells.length;x++)z=y.cells[x],q=getClientRect(z),c.left==q.left&&c.right==q.right&&parseIntOr0(g.colSpan)==parseIntOr0(z.colSpan)&&(q=parseIntOr0(z.rowSpan),m=1<q?m+q:m+1,h.push(z));if(m==ActiveCurrTable.rows.length)for(y=h.length,w=0;w<y;w++)removeAttribute(h[w],"colSpan")}}"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal&&findDiagonal(null,!1,DEXTTOP.G_CURREDITOR)&&(G_DEXT_Diagonal.setResizeForDiagonal(),
G_DEXT_Diagonal.util.replaceEmptySpaceInDiagonal());ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=t);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}}
function command_deleteTable(a,b){dext_src_init(b._EDITOR.design);if(null==ActiveCurrTable)return 0;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var c=ActiveCurrTable.previousSibling;try{if(c){if(3==c.nodeType||1==c.nodeType&&"BR"==c.tagName)c="text"}else{var d=ActiveCurrTable.parentNode;1==d.nodeType&&"BODY"!=d.tagName&&(c=d)}}catch(e){c=null}ActiveCurrTable.parentNode.removeChild(ActiveCurrTable);ActiveCurrTable=null;if("text"!=c)if(null==c)""==_iframeDoc.body.innerHTML?
(setBodyDefaultValue(),setFocusToBody()):(doSetCaretPosition(_iframeDoc.body.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("default"));else if(doSetCaretPosition(c,1),c=GetParentbyTagName(c,"table")){var d=b._config.tableNoActionClass,f=!1;""!=d&&(f=checkContainClass(c,d));ActiveCurrTable=c;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",f)}else DEXTTOP.G_CURREDITOR._iconEnable("default");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_insertRowUp(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();InsertRowUpDown(!0,!1,c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function command_insertRowDown(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();InsertRowUpDown(!1,!1,c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function InsertRowUpDown(a,b,c,d){var e=getFirstRange().range;if(e){var f=null,f=d?d:GetTDTHCell(e.startContainer);if(null!=f&&(ActiveCurrTable=GetParentbyTagName(f,"table"),d=GetParentbyTagName(f,"tr"))){e=0;a?e=d.rowIndex:(e=1<f.rowSpan?d.rowIndex+f.rowSpan:d.rowIndex+1,e>ActiveCurrTable.rows.length&&(e=ActiveCurrTable.rows.length));for(var g=[],h=[],m=getClientRect(f),q=0;q<ActiveCurrTable.rows.length;q++)for(var t=ActiveCurrTable.rows[q],u=0;u<t.cells.length;u++){var v=t.cells[u],w=getClientRect(v);
if(a){if(.1>Math.abs(m.top-w.top)||!isSameRect(w.top,m.top)&&w.top<m.top&&!isSameRect(w.bottom,m.top)&&w.bottom>m.top){var y={};y.left=w.left;y.cell=v;h.push(y)}}else if(.1>Math.abs(m.bottom-w.bottom)||!isSameRect(w.bottom,m.bottom)&&w.bottom>m.bottom&&!isSameRect(m.bottom,w.top)&&m.bottom>w.top)y={},y.left=w.left,y.cell=v,h.push(y)}h.sort(function(a,b){return a.left-b.left});for(q=0;q<h.length;q++)g.push(h[q].cell);h=[];for(q=0;q<g.length;q++)t=g[q],u=t.rowSpan,w=getClientRect(t),1<u&&1==a&&!isSameRect(w.top,
m.top)||1<u&&0==a&&!isSameRect(w.bottom,m.bottom)?h[q]=t.rowSpan+1:h[q]=1;c||(c=1);for(a=0;a<c;a++)for(m=insertRowByIndex(ActiveCurrTable,d,e),setCopyAllObjectAtributes(d,m,!1),q=0;q<g.length;q++)if(t=g[q],u=t.rowSpan,1<h[q])t.rowSpan=h[q],removeAttribute(t,"height");else if(w=insertCellByIndex(m,f,-1)){"th"==t.tagName.toLowerCase()&&(u=document.createElement("th"),w.parentNode.replaceChild(u,w),w=u);w.innerHTML=getCellDefValue();if(b){u=[];v=[];try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion)for(var u=
t.getElementsByTagName("a"),x=u.length,z=0;z<x;z++)u[z].outerHTML.match(RegExp("(hrefs*=s*(?:\"|')(.*?)(?:\"|'))","gi")),v.push(RegExp.$2)}catch(B){u=[],v=[]}setCopyAllObjectAtributes(t,w,!0);try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion&&(x=u.length,0<x))for(var D=w.getElementsByTagName("a"),A=D.length,z=0;z<A;z++)D[z].href&&0>D[z].href.toLowerCase().indexOf("javascript")&&0>D[z].href.indexOf("'")&&0>D[z].href.indexOf('"')&&""!=v[z]&&D[z].href!=v[z]&&(D[z].href=v[z],D[z].setAttribute("href",
v[z]))}catch(C){w.innerHTML=t.innerHTML}}else setCopyAllObjectAtributes(t,w,!1);1<w.rowSpan&&removeAttribute(w,"rowSpan")}}}}
function command_deleteRow(a,b){dext_src_init(b._EDITOR.design);if(null==ActiveCurrTable)return 0;restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var c=null,d=-1,e=0,f=getFirstRange().range;if(f){f=GetTDTHCell(f.startContainer);c=ActiveCurrTable.previousSibling;try{if(c){if(3==c.nodeType||1==c.nodeType&&"BR"==c.tagName)c="text"}else{var g=ActiveCurrTable.parentNode;1==g.nodeType&&"BODY"!=g.tagName&&(c=g)}}catch(h){c=null}g=
GetParentbyTagName(f,"tr");for(f=0;f<ActiveCurrTable.rows.length;f++)for(var m=ActiveCurrTable.rows[f],q=0;q<m.cells.length;q++)if("true"==m.cells[q].getAttribute("dext_select")){-1==d&&(d=m.rowIndex);e++;break}e=e||1;for(f=0;f<e;f++){-1!=d&&(g=ActiveCurrTable.rows[d]);if(null==g)return;deleteRow(g)}}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;ActiveCurrTable?(doSetCaretPosition(ActiveCurrTable.rows[0].cells[0].childNodes[0],0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")):
"text"!=c&&(null==c?""==_iframeDoc.body.innerHTML?(setBodyDefaultValue(),setFocusToBody()):(doSetCaretPosition(_iframeDoc.body.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("default")):(doSetCaretPosition(c,1),(c=GetParentbyTagName(c,"table"))?(d=b._config.tableNoActionClass,e=!1,""!=d&&(e=checkContainClass(c,d)),ActiveCurrTable=c,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",e)):DEXTTOP.G_CURREDITOR._iconEnable("default")))}
function deleteRow(a){if(null!=a){ActiveCurrTable=GetParentbyTagName(a,"table");var b=a.rowIndex;ActiveCurrTable.previousSibling&&doSetCaretPosition(ActiveCurrTable.previousSibling,0);for(var c=0;c<ActiveCurrTable.rows.length;c++){var d=ActiveCurrTable.rows[c],e=d.rowIndex;if(b==e)break;for(var f=0;f<d.cells.length;f++){var g=d.cells[f],h=g.rowSpan;1<h&&b<e+h&&(2==h?removeAttribute(g,"rowSpan"):g.rowSpan=h-1)}}for(f=0;f<a.cells.length;f++)if(g=a.cells[f],h=g.rowSpan,1<h){c=insertCellByIndex(ActiveCurrTable.rows[a.rowIndex+
1],g,g.cellIndex);if(null==c)return;d=g.colSpan;e=g.style.width;c.innerHTML=g.innerHTML;c.style.border="1px solid #000000";c.style.width=e;2<h&&(c.rowSpan=h-1);1<d&&(c.colSpan=d)}1==ActiveCurrTable.rows.length?(ActiveCurrTable.parentNode.removeChild(ActiveCurrTable),ActiveCurrTable=null):ActiveCurrTable.deleteRow(b)}}
function command_insertCellLeft(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();insertCell(!0,c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function command_insertCellRight(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();insertCell(!1,c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function insertCell(a,b){var c=getFirstRange().range;if(c&&(c=GetTDTHCell(c.startContainer),null!=c&&(ActiveCurrTable=GetParentbyTagName(c,"table"),GetParentbyTagName(c,"tr")))){for(var d=[],e=[],f=getClientRect(c),g=0;g<ActiveCurrTable.rows.length;g++)for(var h=ActiveCurrTable.rows[g],m=0;m<h.cells.length;m++){var q=h.cells[m],t=getClientRect(q);a?1>Math.abs(f.left-t.left)?(t={},t.x=g,t.y=m,t.width=0<q.style.width.length?q.style.width:"",t.height=0<q.style.height.length?q.style.height:"",t.rowSpan=
q.rowSpan,t.cell=q,d.push(t)):(isSameRect(f.top,t.bottom)||f.top>t.bottom||isSameRect(f.bottom,t.top)||f.bottom<t.top)&&.1<t.right-f.left&&.1<f.left-t.left&&e.push(q):1>Math.abs(f.right-t.right)?(t={},t.x=g,t.y=m+1,t.rowSpan=q.rowSpan,t.width=0<q.style.width.length?q.style.width:"",t.height=0<q.style.height.length?q.style.height:"",t.cell=q,d.push(t)):(isSameRect(f.top,t.bottom)||f.top>t.bottom||isSameRect(f.bottom,t.top)||f.bottom<t.top)&&.1<t.right-f.right&&.1<f.right-t.left&&e.push(q)}b||(b=1);
for(g=0;g<d.length;g++)for(f=0;f<b;f++){q=d[g];h=insertCellByIndex(ActiveCurrTable.rows[q.x],c,q.y);if(null==h)return;"th"==q.cell.tagName.toLowerCase()&&(m=document.createElement("th"),h.parentNode.replaceChild(m,h),h=m);h.innerHTML=getCellDefValue();setCopyAllObjectAtributes(q.cell,h,!1);1<q.rowSpan?h.rowSpan=q.rowSpan:removeAttribute(h,"rowSpan");1<q.cell.colSpan&&removeAttribute(h,"colSpan");0==g&&""!=ActiveCurrTable.style.width&&-1<ActiveCurrTable.style.width.indexOf("px")&&(h=DEXTTOP.DEXT5.util.parseIntOr0(ActiveCurrTable.style.width),
m=0,""!=q.width&&-1<q.width.indexOf("px")&&(m=DEXTTOP.DEXT5.util.parseIntOr0(q.width)),"0"==_dext_editor._config.keepTableWidthLikeWord?ActiveCurrTable.style.width=h+m+"px":(q=isTableOutOfRange(_dext_editor,ActiveCurrTable,m),q.result||q.newCellWidthFlag?ActiveCurrTable.style.width=h+m+"px":widthAdjustFlag=!0))}for(g=0;g<e.length;g++)for(f=0;f<b;f++)q=e[g],q.colSpan+=1}}
function command_InsertSplitCell(a,b,c,d){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;var e,f,g;!DEXTTOP.G_SELECTED_ELEMENT||"TD"!=DEXTTOP.G_SELECTED_ELEMENT.tagName&&"TH"!=DEXTTOP.G_SELECTED_ELEMENT.tagName?a&&(g=GetTDTHCell(a.startContainer)):g=DEXTTOP.G_SELECTED_ELEMENT;g&&(e=GetTableSelectionCells(g),f=e.length);if(0==f)1<parseInt(c)&&splitCellByRow(c,!0,g),1<parseInt(d)&&
splitCellByColumn(d,!0,g);else for(g=0;g<f;g++)1<parseInt(c)&&splitCellByRow(c,!0,e[g]),1<parseInt(d)&&splitCellByColumn(d,!0,e[g]);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;c="focusInCell";try{e=GetTableSelectionCells(),0<e.length&&(c=1==e.length?"selectedSingleCell":"selectedMultiCell")}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}DEXTTOP.G_CURREDITOR._iconEnable(c)}
function splitCellByRow(a,b,c){if(b=null==c||void 0==c?getFirstRange().range:c)if(b=null==c||void 0==c?GetTDTHCell(b.startContainer):GetTDTHCell(b),null!=b){ActiveCurrTable=GetParentbyTagName(b,"table");var d=GetParentbyTagName(b,"tr"),e="";ActiveCurrTable&&(e=ActiveCurrTable.style.borderCollapse,ActiveCurrTable.style.borderCollapse="");var f=null;if("1"==DEXTTOP.G_CURREDITOR._config.splitCellStyle){var g=[];if(b.firstChild){var h=b.firstChild.nodeName.toLowerCase();if("p"==h||"span"==h||"ol"==h||
"ul"==h||"li"==h){var m=function(a){g.push(a.cloneNode());if(a.firstChild){h=a.firstChild.nodeName.toLowerCase();for(var b="span b strong i em strike u sup sub font ul ol li".split(" "),c=!1,d=0;d<b.length;d++)if(b[d]==h){c=!0;break}return c?m(a.firstChild):!0}return!0};if(m(b.firstChild)){for(var f=null,q=g.length-1;0<=q;q--)f?g[q].appendChild(f):g[q].innerHTML=getCellDefValue().replace(/<p>|<\/p>/gi,""),f=g[q];f=f.outerHTML}}}}if(d){whereRowIdx=d.rowIndex;if(1<b.rowSpan){--b.rowSpan;var t=b.style.width,
u=b.style.height,v=ActiveCurrTable.rows[whereRowIdx+b.rowSpan],w=GetFirstIndexInRowByCurrCell(v,b);if(v=insertCellByIndex(v,b,w+1))v.innerHTML=f?f:getCellDefValue(),v.style.borderTop=b.style.borderTop,v.style.borderRight=b.style.borderRight,v.style.borderBottom=b.style.borderBottom,v.style.borderLeft=b.style.borderLeft,v.style.padding=b.style.padding,v.style.marginTop=b.style.marginTop,v.style.marginRight=b.style.marginRight,v.style.marginBottom=b.style.marginBottom,v.style.marginLeft=b.style.marginLeft,
v.className=b.className,"true"==b.getAttribute("dext_select")?(v.setAttribute("cellOrgBgColor",b.getAttribute("cellOrgBgColor")),v.style.backgroundColor=ColorCellBackColor,v.setAttribute("dext_select","true")):""==b.style.backgroundColor||0!=b.style.backgroundColor.indexOf("#")&&0!=b.style.backgroundColor.indexOf("rgb")||(v.style.backgroundColor=b.style.backgroundColor),0<t.length&&(v.style.width=t),0<u.length&&(v.style.height=u),1<b.colSpan&&(v.colSpan=b.colSpan),"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&
G_DEXT_Diagonal&&((t=findDiagonal(b,!0))&&0<t.diagonalUp.length&&G_DEXT_Diagonal.makeDiagonal(v,"up",t.diagonalUp[0].style.borderTop),t&&0<t.diagonalDown.length&&G_DEXT_Diagonal.makeDiagonal(v,"down",t.diagonalDown[0].style.borderTop));--a;1==b.rowSpan&&removeAttribute(b,"rowSpan");1<a&&splitCellByRow(a,!1,c);ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=e);return}c=[];q=0;u=getClientRect(b);for(t=0;t<ActiveCurrTable.rows.length;t++)for(v=ActiveCurrTable.rows[t],w=0;w<v.cells.length;w++){var y=
v.cells[w],x=getClientRect(y);if(1>Math.abs(u.top-x.top)||1<=Math.abs(u.top-x.top)&&x.top<u.top&&1<=Math.abs(u.top-x.bottom)&&x.bottom>u.top)c[q]=y,q+=1}q=[];for(t=0;t<c.length;t++)u=c[t],x=getClientRect(u),u!=b&&(q[t]=u.rowSpan+(a-1));for(x=1;x<a;x++){v=insertRowByIndex(ActiveCurrTable,d,whereRowIdx+x);t=b.style.width;u=b.style.height;w=GetFirstIndexInRowByCurrCell(v,b);if(v=insertCellByIndex(v,b,w))v.innerHTML=f?f:getCellDefValue(),v.style.borderTop=b.style.borderTop,v.style.borderRight=b.style.borderRight,
v.style.borderBottom=b.style.borderBottom,v.style.borderLeft=b.style.borderLeft,v.style.padding=b.style.padding,v.style.marginTop=b.style.marginTop,v.style.marginRight=b.style.marginRight,v.style.marginBottom=b.style.marginBottom,v.style.marginLeft=b.style.marginLeft,v.className=b.className,"true"==b.getAttribute("dext_select")?(v.setAttribute("cellOrgBgColor",b.getAttribute("cellOrgBgColor")),v.style.backgroundColor=ColorCellBackColor,v.setAttribute("dext_select","true")):""==b.style.backgroundColor||
0!=b.style.backgroundColor.indexOf("#")&&0!=b.style.backgroundColor.indexOf("rgb")||(v.style.backgroundColor=b.style.backgroundColor),0<t.length&&(v.style.width=t),0<u.length&&(v.style.height=u),1<b.colSpan&&(v.colSpan=b.colSpan),"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal&&((t=findDiagonal(b,!0))&&0<t.diagonalUp.length&&G_DEXT_Diagonal.makeDiagonal(v,"up",t.diagonalUp[0].style.borderTop),t&&0<t.diagonalDown.length&&G_DEXT_Diagonal.makeDiagonal(v,"down",t.diagonalDown[0].style.borderTop));
for(t=0;t<c.length;t++)u=c[t],1<=q[t]&&(u.rowSpan=q[t],removeAttribute(u,"height"))}}ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=e)}}function GetFirstIndexInRowByCurrCell(a,b){for(var c=-1,d=a.cells.length,e=getClientRect(b),d=d-1;0<=d;d--){var f=getClientRect(a.cells[d]);if(isSameRect(e.left,f.right)||e.left>=f.right){c=d;break}}return c}
function splitCellByColumn(a,b,c){if(b=null==c||void 0==c?getFirstRange().range:c)if(b=null==c||void 0==c?GetTDTHCell(b.startContainer):GetTDTHCell(b),null!=b){ActiveCurrTable=GetParentbyTagName(b,"table");var d=GetParentbyTagName(b,"tr"),e="";ActiveCurrTable&&(e=ActiveCurrTable.style.borderCollapse,ActiveCurrTable.style.borderCollapse="");var f=null;if("1"==DEXTTOP.G_CURREDITOR._config.splitCellStyle){var g=[];if(b.firstChild){var h=b.firstChild.nodeName.toLowerCase();if("p"==h||"span"==h||"ol"==
h||"ul"==h||"li"==h){var m=function(a){g.push(a.cloneNode());if(a.firstChild){h=a.firstChild.nodeName.toLowerCase();for(var b="span b strong i em strike u sup sub font ul ol li".split(" "),c=!1,d=0;d<b.length;d++)if(b[d]==h){c=!0;break}return c?m(a.firstChild):!0}return!0};if(m(b.firstChild)){for(var f=null,q=g.length-1;0<=q;q--)f?g[q].appendChild(f):g[q].innerHTML=getCellDefValue().replace(/<p>|<\/p>/gi,""),f=g[q];f=f.outerHTML}}}}if(d){if(1<b.colSpan){--b.colSpan;var t=parseInt(b.style.width),q=
isNaN(parseInt(parseInt(b.style.width)/a))?"":parseInt(parseInt(b.style.width,10)/a,10)+"px",u=b.style.height,v=insertCellByIndex(d,b,b.cellIndex+1);if(v&&(v.innerHTML=f?f:getCellDefValue(),v.style.borderTop=b.style.borderTop,v.style.borderRight=b.style.borderRight,v.style.borderBottom=b.style.borderBottom,v.style.borderLeft=b.style.borderLeft,v.style.padding=b.style.padding,v.style.marginTop=b.style.marginTop,v.style.marginRight=b.style.marginRight,v.style.marginBottom=b.style.marginBottom,v.style.marginLeft=
b.style.marginLeft,v.className=b.className,"true"==b.getAttribute("dext_select")?(v.setAttribute("cellOrgBgColor",b.getAttribute("cellOrgBgColor")),v.style.backgroundColor=ColorCellBackColor,v.setAttribute("dext_select","true")):""==b.style.backgroundColor||0!=b.style.backgroundColor.indexOf("#")&&0!=b.style.backgroundColor.indexOf("rgb")||(v.style.backgroundColor=b.style.backgroundColor),0<q.length&&(v.style.width=q),0<u.length&&(v.style.height=u),1<b.rowSpan&&(v.rowSpan=b.rowSpan),"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&
G_DEXT_Diagonal)){var w=findDiagonal(b,!0);w&&0<w.diagonalUp.length&&G_DEXT_Diagonal.makeDiagonal(v,"up",w.diagonalUp[0].style.borderTop);w&&0<w.diagonalDown.length&&G_DEXT_Diagonal.makeDiagonal(v,"down",w.diagonalDown[0].style.borderTop)}--a;1==b.colSpan&&removeAttribute(b,"colSpan");1<a?(q=t-parseInt(q),0<q&&(b.style.width=q+"px"),splitCellByColumn(a,!1,c)):0<q.length&&(b.style.width=q);ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=e);return}c=[];v=0;u=getClientRect(b);for(q=0;q<ActiveCurrTable.rows.length;q++)for(var y=
ActiveCurrTable.rows[q],w=0;w<y.cells.length;w++){var t=y.cells[w],x=getClientRect(t);if(t!=b){if(u.left>=x.left&&u.right<=x.right){y={};y.x=q;y.y=w;y.width=0<t.style.width.length?t.style.width:"";y.colSpan=t.colSpan;c[v]=y;v+=1;break}}else if(t==b)break}for(q=0;q<c.length;q++){v=c[q];v=ActiveCurrTable.rows[v.x].cells[v.y];if(null==v)return;v.colSpan+=a-1}q=isNaN(parseInt(parseInt(b.style.width)/a))?"":parseInt(parseInt(b.style.width,10)/a,10)+"px";0>=q.length&&(q=isNaN(parseInt(parseInt(b.clientWidth)/
a))?"":parseInt(parseInt(b.clientWidth,10)/a,10)+"px");""==q&&1==ActiveCurrTable.rows.length&&(q=parseInt(parseInt(ActiveCurrTable.style.width,10)/a,10)+"px");u=b.style.height;0<q.length&&(b.style.width=q);0<u.length&&(b.style.height=u);for(c=1;c<a;c++)if(v=insertCellByIndex(d,b,b.cellIndex+c))v.innerHTML=f?f:getCellDefValue(),v.style.borderTop=b.style.borderTop,v.style.borderRight=b.style.borderRight,v.style.borderBottom=b.style.borderBottom,v.style.borderLeft=b.style.borderLeft,v.style.padding=
b.style.padding,v.style.marginTop=b.style.marginTop,v.style.marginRight=b.style.marginRight,v.style.marginBottom=b.style.marginBottom,v.style.marginLeft=b.style.marginLeft,v.className=b.className,"true"==b.getAttribute("dext_select")?(v.setAttribute("cellOrgBgColor",b.getAttribute("cellOrgBgColor")),v.style.backgroundColor=ColorCellBackColor,v.setAttribute("dext_select","true")):""==b.style.backgroundColor||0!=b.style.backgroundColor.indexOf("#")&&0!=b.style.backgroundColor.indexOf("rgb")||(v.style.backgroundColor=
b.style.backgroundColor),0<q.length&&(v.style.width=q),0<u.length&&(v.style.height=u),1<b.rowSpan&&(v.rowSpan=b.rowSpan),"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal&&((w=findDiagonal(b,!0))&&0<w.diagonalUp.length&&G_DEXT_Diagonal.makeDiagonal(v,"up",w.diagonalUp[0].style.borderTop),w&&0<w.diagonalDown.length&&G_DEXT_Diagonal.makeDiagonal(v,"down",w.diagonalDown[0].style.borderTop))}ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=e)}}
function command_deleteCell(a,b){dext_src_init(b._EDITOR.design);if(null==ActiveCurrTable)return 0;restoreSelection();setFocusToBody();var c=null;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=getFirstRange().range;if(d){var e="";ActiveCurrTable&&(e=ActiveCurrTable.style.borderCollapse,ActiveCurrTable.style.borderCollapse="");c=ActiveCurrTable.previousSibling;try{if(c){if(3==c.nodeType||1==c.nodeType&&"BR"==c.tagName)c="text"}else{var f=ActiveCurrTable.parentNode;
1==f.nodeType&&"BODY"!=f.tagName&&(c=f)}}catch(g){c=null}var f=0,h=!1;"0"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjust&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="1",h=!0);"1"==DEXTTOP.G_CURREDITOR._config.adjustCellSizeAfterDeleteCell&&setAdjustTableWidthHeight(ActiveCurrTable);h&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="0");h=GetTableSelectionCells();for(0==h.length&&h.push(GetTDTHCell(d.startContainer));0<h.length;){var d=0,m=h[h.length-1],q=getClientRect(m);if(m){for(var t=[],h=0;h<
ActiveCurrTable.rows.length;h++){var u=ActiveCurrTable.rows[h];if(m.parentNode.rowIndex==h){var v={};v.x=h;v.y=m.cellIndex;v.isDel=!0;t.push(v)}else for(var w=0;w<u.cells.length;w++){var v=u.cells[w],y=getClientRect(v),v={};v.x=h;v.y=w;q.left<=y.left&&q.right>=y.right?(v.isDel=!0,t.push(v)):q.left>=y.left&&q.right<=y.right&&(v.isDel=!1,t.push(v))}}for(h=t.length;0<h;h--){u=t[h-1];w=ActiveCurrTable.rows[u.x].cells[u.y];if(null==w){ActiveCurrTable.style.borderCollapse=e;return}u.isDel?(w=parseIntOr0(w.style.width),
d<w&&(d=w),ActiveCurrTable.rows[u.x].deleteCell(u.y)):2<w.colSpan?--w.colSpan:removeAttribute(w,"colSpan")}for(h=ActiveCurrTable.rows.length-1;0<=h;h--)if(0==ActiveCurrTable.rows[h].cells.length){t=ActiveCurrTable.rows[h].rowIndex;for(w=0;w<h;w++){u=ActiveCurrTable.rows[w];m=u.rowIndex;if(t==m)break;for(q=0;q<u.cells.length;q++)v=u.cells[q],y=v.rowSpan,1<y&&t<m+y&&(2==y?removeAttribute(v,"rowSpan"):v.rowSpan=y-1)}ActiveCurrTable.deleteRow(h)}0==ActiveCurrTable.rows.length&&(ActiveCurrTable.parentNode.removeChild(ActiveCurrTable),
ActiveCurrTable=null)}f+=d;h=GetTableSelectionCells()}ActiveCurrTable&&(d=parseIntOr0(ActiveCurrTable.style.width),0<d&&(ActiveCurrTable.style.width=d-f+"px"),ActiveCurrTable.style.borderCollapse=e)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;ActiveCurrTable?(doSetCaretPosition(ActiveCurrTable.rows[0].cells[0].childNodes[0],0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")):"text"!=c&&(null==c?""==_iframeDoc.body.innerHTML?(setBodyDefaultValue(),setFocusToBody()):
(doSetCaretPosition(_iframeDoc.body.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("default")):(doSetCaretPosition(c,1),(c=GetParentbyTagName(c,"table"))?(e=b._config.tableNoActionClass,f=!1,""!=e&&(f=checkContainClass(c,e)),ActiveCurrTable=c,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",f)):DEXTTOP.G_CURREDITOR._iconEnable("default")))}
function GetTableSelectionCells(a){null==ActiveCurrTable&&(ActiveCurrTable=GetParentbyTagName(a,"table"));if(null==ActiveCurrTable)return[];a=[];for(var b=0,c=0;c<ActiveCurrTable.rows.length;c++)for(var d=ActiveCurrTable.rows[c],e=0;e<d.cells.length;e++){var f=d.cells[e];"true"==f.getAttribute("dext_select")&&(a[b]=f,b+=1)}return a}
function GetTableSelectionCellsPosition(a,b){null==ActiveCurrTable&&(ActiveCurrTable=GetParentbyTagName(a,"table"));if(null==ActiveCurrTable)return[];for(var c={arrOutSideLeft:[],arrOutSideRight:[],arrOutSideTop:[],arrOutSideBottom:[],arrSelected:[],rowCnt:0,colCnt:0},d,e=[],f=[],g=ActiveCurrTable.rows.length,h=[],m=0,q=0;q<g;q++){for(var t=ActiveCurrTable.rows[q],f=[],u=0,v=t.cells.length,w=0;w<v;w++){var y=t.cells[w];b?(f.push(y),c.arrSelected.push(y),d=q,u+=1):"true"==y.getAttribute("dext_select")&&
(f.push(y),c.arrSelected.push(y),d=q,u+=1,void 0==h[m]&&(h[m]=[]),h[m].push(y))}h[m]&&0<h[m].length&&m++;0<f.length&&e.push(f);u>c.colCnt&&(c.colCnt=u)}c.virtualSelectionsCellTable=h;if(0==e.length&&(null==a||void 0==a))return c;if(0==e.length)return c.arrOutSideLeft.push(a),c.arrOutSideRight.push(a),c.arrOutSideTop.push(a),c.arrOutSideBottom.push(a),c.rowCnt=1,c.colCnt=1,c.virtualSelectionsCellTable=[[a]],c;c.arrOutSideTop=e[0].slice();f=e.length;c.rowCnt=f;if(0<f)for(c.arrOutSideBottom=e[f-1].slice(),
q=t=m=h=g=0;q<f;q++){u=e[q];w=u.length;y=0;v=w;if(0==g||u[0].parentNode.rowIndex==h+g)c.arrOutSideLeft.push(u[0]),y=1,1<u[0].rowSpan&&(g=parseIntOr0(u[0].rowSpan),h=u[0].parentNode.rowIndex,1<g&&g+h-1>=d&&c.arrOutSideBottom.push(u[0]));if(0==m||u[w-1].parentNode.rowIndex==t+m)c.arrOutSideRight.push(u[w-1]),--v,1<u[w-1].rowSpan&&(m=parseIntOr0(u[w-1].rowSpan),t=u[w-1].parentNode.rowIndex),1<m&&m+t-1>=d&&c.arrOutSideBottom.push(u[w-1]);u[0].parentNode.rowIndex==h+g&&(g=h=0);u[w-1].parentNode.rowIndex==
t+m&&(m=t=0);if(q<f-1)for(w=y;w<v;w++){var y=u[w].rowSpan,x=u[w].parentNode.rowIndex;1<y&&x+y-1>=d&&c.arrOutSideBottom.push(u[w])}}return c}
function CellSelectedCopy(a){var b={all:!0,selected:!1,cellValue:[],Table:null},c=l=0,d,e="",f=0;if(null==a||void 0==a)return!1;for(var g=a.rows.length,h=!1,m=0;m<g;m++){for(var q=a.rows[m],t=q.cells.length,e=e+"<tr>",u=0;u<t;u++){var v=q.cells[u];if("true"==v.getAttribute("dext_select")){b.selected=!0;void 0==b.cellValue[c]&&(b.cellValue[c]=[]);d=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&""==v.innerHTML?"&nbsp;":v.innerHTML;b.cellValue[c].push(d);e+=v.outerHTML;try{var w=isNaN(parseInt(v.style.width,
10))?w=parseInt(v.width,10):parseInt(v.style.width,10);if(isNaN(w))var y=getClientRect(v),w=y.right-y.left;isNaN(w)&&(w=0)}catch(x){w=0}0==h&&(f+=parseInt(w,10)+1)}else b.all=!1}0!=f&&(h=!0);e+="</tr>";void 0!=b.cellValue[c]&&(c+=1)}if(0==b.all)for(table_tag=DEXTTOP.DEXT5.util.replaceAll(a.outerHTML,a.innerHTML,e),table_tag=DEXTTOP.DEXT5.util.replaceAll(table_tag,"<tr></tr>",""),m=document.createElement("div"),m.innerHTML=table_tag,a=m.getElementsByTagName("table")[0],a.style.width=f+"px",a.style.height=
"",a.height="",f=a.getElementsByTagName("td"),c=f.length,m=0;m<c;m++)""!=f[m].getAttribute("cellOrgBgColor")&&"undefined"!=typeof f[m].getAttribute("cellOrgBgColor")?(f[m].style.backgroundColor=f[m].getAttribute("cellOrgBgColor"),removeAttribute(f[m],"cellOrgBgColor"),removeAttribute(f[m],"dext_select")):f[m].style.backgroundColor="";b.Table=a;return b}
function getTableBorderCells(a){var b={arrLeft:[],arrTop:[],arrRight:[],arrBottom:[]};if(null==a||void 0==a)return b;var c=a.tagName.toLowerCase(),d=a;"table"!=c&&(d=GetParentbyTagName(a,"table"));if(null==d)return b;a=d.rows.length;for(var e=getClientRect(d.rows[0].cells[0]),c=0;c<a;c++)for(var f=d.rows[c],g=f.cells.length,h=0;h<g;h++){var m=f.cells[h],q=getClientRect(m);e.left==q.left&&b.arrLeft.push(m);e.top==q.top&&b.arrTop.push(m)}for(var c=b.arrTop[b.arrTop.length-1],e=getClientRect(b.arrLeft[b.arrLeft.length-
1]),t=getClientRect(c),c=0;c<a;c++)for(f=d.rows[c],g=f.cells.length,h=0;h<g;h++)m=f.cells[h],q=getClientRect(m),e.bottom==q.bottom&&b.arrBottom.push(m),t.right==q.right&&b.arrRight.push(m);return b}
function getCellNearLeftTop(a,b){var c={arrLeft:[],arrRight:[],arrTop:[],arrBottom:[],arrSelected:[]},d=[];void 0==b&&(d=GetTableSelectionCells(a));if(0==d.length&&(null==a||void 0==a))return c;0==d.length&&d.push(a);c.arrSelected=d;var e=GetParentbyTagName(d[0],"table");getClientRect(e.rows[0].cells[0]);var f=0;if(""==e.style.borderCollapse||"separate"==e.style.borderCollapse){var g=e.cellSpacing;1<g&&(f=DEXTTOP.DEXT5.util.parseIntOr0(g))}for(g=0;g<d.length;g++)for(var h=getClientRect(d[g]),m=e.rows.length,
q=0;q<m;q++)for(var t=e.rows[q],u=t.cells.length,v=0;v<u;v++){var w=t.cells[v],y=getClientRect(w);isSameRect(h.left,y.right,f)&&(h.top<=y.top&&h.bottom>=y.bottom||h.top>=y.top&&h.bottom<=y.bottom&&1<w.rowSpan)&&c.arrLeft.push(w);isSameRect(h.right,y.left,f)&&(h.top<=y.top&&h.bottom>=y.bottom||h.top>=y.top&&h.bottom<=y.bottom&&1<w.rowSpan)&&c.arrRight.push(w);isSameRect(h.top,y.bottom,f)&&(h.left<=y.left&&h.right>=y.right||h.left>=y.left&&h.right<=y.right&&1<w.colSpan)&&c.arrTop.push(w);isSameRect(h.bottom,
y.top,f)&&(h.left<=y.left&&h.right>=y.right||h.left>=y.left&&h.right<=y.right&&1<w.colSpan)&&c.arrBottom.push(w)}return c}
function setTableRowSelect(a){if(null!=a&&void 0!=a){var b=GetParentbyTagName(a,"table"),c=GetParentbyTagName(a,"tr");if(null!=b&&null!=c){for(var b=null,d=0;d<c.cells.length;d++)b=c.cells[d],b.setAttribute("cellOrgBgColor",b.style.backgroundColor),b.style.backgroundColor=ColorCellBackColor,b.setAttribute("dext_select","true"),setCellDefValue(b);DrageEndCell=b;c=getMyChildElementNode(DrageEndCell.childNodes[DrageEndCell.childNodes.length-1]);doSetCaretPosition(c,0);setMenuIconRealable(DrageEndCell);
_iframeDoc_MouseUpMenu(null,a)}}}
function setTableColumnSelect(a){if(null!=a&&void 0!=a){var b=GetParentbyTagName(a,"table");if(null!=b){for(var c=b.rows.length,d=null,e=getClientRect(a),f=0;f<c;f++)for(var g=b.rows[f],h=g.cells.length,m=0;m<h;m++){cell=g.cells[m];var q=getClientRect(cell);e.left==q.left&&(cell.setAttribute("cellOrgBgColor",cell.style.backgroundColor),cell.style.backgroundColor=ColorCellBackColor,cell.setAttribute("dext_select","true"),setCellDefValue(cell),d=cell)}DrageEndCell=d;b=getMyChildElementNode(DrageEndCell.childNodes[DrageEndCell.childNodes.length-
1]);doSetCaretPosition(b,0);setMenuIconRealable(DrageEndCell);_iframeDoc_MouseUpMenu(null,a)}}}function setTableCellSelect(a){if(null!=a&&void 0!=a){var b=a.tagName.toLowerCase();if("td"!=b||"th"!=b)a=GetTDTHCell(a);null!=a&&(a.setAttribute("cellOrgBgColor",a.style.backgroundColor),a.style.backgroundColor=ColorCellBackColor,a.setAttribute("dext_select","true"),setCellDefValue(a),DrageEndCell=a,doSetCaretPosition(DrageEndCell,1),setMenuIconRealable(DrageEndCell),_iframeDoc_MouseUpMenu(null,a))}}
function setTableAllSelect(a){if(null!=a&&void 0!=a){var b=GetParentbyTagName(a,"table");if(null!=b){for(var c=b.rows.length,d=null,e=0;e<c;e++)for(var f=b.rows[e],g=f.cells.length,h=0;h<g;h++)d=f.cells[h],d.setAttribute("cellOrgBgColor",d.style.backgroundColor),d.style.backgroundColor=ColorCellBackColor,d.setAttribute("dext_select","true"),setCellDefValue(d);DrageEndCell=d;b=getMyChildElementNode(DrageEndCell.childNodes[DrageEndCell.childNodes.length-1]);doSetCaretPosition(b,1);setMenuIconRealable(DrageEndCell);
_iframeDoc_MouseUpMenu(null,a)}}}function setTableWidthRemove(){for(var a=GetTableSelectionCells(),b=0;b<a.length;b++){var c=a[b];removeAttribute(c,"width");removeAttribute(c.style,"width")}}function setTableHeightRemove(){for(var a=GetTableSelectionCells(),b=a.length,c=0;c<b;c++){var d=a[c];removeAttribute(d,"height");removeAttribute(d.style,"height")}}
function setTableWidthHeightRemove(){for(var a=GetTableSelectionCells(),b=a.length,c=0;c<b;c++){var d=a[c];removeAttribute(d,"width");removeAttribute(d.style,"width");removeAttribute(d,"height");removeAttribute(d.style,"height")}}
function setTableWidthSame(){var a=GetTableSelectionCells();if(0!=a.length){var b=GetParentbyTagName(a[0],"table");if(null!=b){G_ResizeFixedTable.setSameWidth();for(var c=GetTableSelectionCellsPosition(a[0],!1).virtualSelectionsCellTable,d=0,e=0,f=0;f<c.length;f++){var g=c[f].length;g>e&&(e=g,d=f)}for(var g=0,e=c[d],h=e.length,f=0;f<h;f++)d=0,c=e[f],""!=c.style.width&&-1<c.style.width.indexOf("%")?(d=getClientRect(c),d=d.right-d.left):d=parseIntOr0(c.style.width),0==d&&(d=parseIntOr0(c.width)),0==
d&&(d=getClientRect(c),d=d.right-d.left),g+=d;for(var e=b.rows.length,g=Math.ceil(g/h),h=[],m=0;m<a.length;m++)for(d=getClientRect(a[m]),f=0;f<e;f++)for(var q=b.rows[f],t=q.cells.length,u=0;u<t;u++){var c=q.cells[u],v=getClientRect(c);d.left==v.left&&d.right==v.right&&h.push(c)}a=h.length;for(b=0;b<a;b++)c=h[b],c.style.width=g+"px",removeAttribute(c,"width")}}}
function setTableHeightSame(){var a=GetTableSelectionCells(),b=a.length;if(0!=b){for(var c=[],d,e=0;e<b;e++)d?d==getClientRect(a[e]).left&&c.push(a[e]):(d=getClientRect(a[e]).left,c.push(a[e]));var a=c,e=b=a.length,f=GetParentbyTagName(a[0],"table");if(null!=f){for(var g=0,h=c=0;h<b;h++){var m=a[h],g=g+getCellSize(m).height;if(1<m.rowSpan)var q=parseInt(m.rowSpan,10),e=e+(q-1)}q=f.rows.length;d=0;d=parseInt(g/e,10);g=[];for(h=0;h<b;h++)for(var t=getClientRect(a[h]),e=0;e<q;e++)for(var u=f.rows[e],
v=u.cells.length,w=0;w<v;w++){var m=u.cells[w],y=getClientRect(m);1<parseIntOr0(a[h].rowSpan)?t.top<=y.top&&t.bottom>=y.bottom&&g.push(m):1<parseIntOr0(m.rowSpan)||t.top==y.top&&t.bottom==y.bottom&&g.push(m)}a=g.length;for(e=0;e<a;e++)q=(q=parseIntOr0(g[e].rowSpan))?q:1,g[e].style.height=d*q+"px",removeAttribute(m,"height");b=!1;for(e=0;e<a;e++)f=getCellSize(g[e]).height,q=(q=parseIntOr0(g[e].rowSpan))?q:1,f/=q,d<f&&(c=f,b=!0);if(b)for(e=0;e<a;e++)q=(q=parseIntOr0(g[e].rowSpan))?q:1,g[e].style.height=
c*q+"px",removeAttribute(m,"height")}}}function setTableRowClone(a){null!=a&&void 0!=a&&(GetTDTHCell(a),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),InsertRowUpDown(!1,!0),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_convertTableToText(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(null==ActiveCurrTable)return 0;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();for(var c="",d=ActiveCurrTable,e=d.rows.length,f=0;f<e;f++)for(var g=d.rows[f],h=g.cells.length,m=0;m<h;m++)var q=g.cells[m],t="",t="innerText"in q?q.innerText:"textContent"in q?q.textContent:"",c=c+t;d=ActiveCurrTable.parentNode;d.removeChild(ActiveCurrTable);ActiveCurrTable=
null;c=c.replace("&nbsp;","");e=_iframeDoc.createElement("p");e.innerHTML=c;d.appendChild(e);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function _iframeDoc_MouseUpMenu(a,b){setDEXTWINDOC();var c=_dext_editor;if(!isViewMode(c)){var d=null;try{var e=a?a:_iframeWin.event,d=void 0!=b||null!=b?b:e.target?e.target:e.srcElement;if(0==checkContentEditable(c,d))DEXTTOP.DEXT5.util.cancelEvent(a),c._iconEnable("editableFalse");else{c.dext_dragresize&&c.dext_dragresize.G_dextResize_elem&&(d=c.dext_dragresize.G_dextResize_elem);if("1"!=c._config.formMode&&"1"==c._config.userTableLock.use){var f=GetTDTHCell(d),g;f&&(g=GetParentbyTagName(d,"table"));
var h=c._config.userTableLock.defaultTableLockMode;if(g)if("2"==c._config.userTableLock.tableLockMode)if(checkLockAttr(g,!0)&&checkLockAttr(f,!0)){if(g.getAttribute("lock_mode")||""!=g.getAttribute("lock_mode"))h=g.getAttribute("lock_mode")}else h="0";else g.getAttribute("lock_mode")&&""!=g.getAttribute("lock_mode")&&(h=g.getAttribute("lock_mode"));e=!0;"1"==h?e=!1:"0"==h&&(e=!1,f=null);if(f){if(e&&checkLockAttr(g)){if(currEditor.lastElemForLock)setFocusForLock(currEditor.lastElemForLock);else{var m=
findNoLockElem(g);m?setFocusForLock(m):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(f,!e)){currEditor.lastElemForLock?setFocusForLock(currEditor.lastElemForLock):setFocusForLock(findNoLockCell(g));DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}}}var q=d.tagName.toLowerCase();if(q&&("textarea"==q||"input"==q||"select"==q)&&"1"!=c._config.formMode)return!1;if(q&&"img"==q){var t=d.getAttribute("dext5customdata");
if(null!=t&&void 0!=t&&"hidden"==getDextCustomData(t).type)return!1}var u=function(){var a=getFirstRange(),b=a.range;if(b){var e=GetTableSelectionCells(),f=!1,g=c._config.tableNoActionClass;if(0<e.length)if(""!=g&&(b=GetParentbyTagName(e[0],"table"),f=checkContainClass(b,g)),1==e.length)c._iconEnable("selectedSingleCell",f);else{g="selectedMultiCell";for(b=0;b<e.length-1;b++)if(e[b].tagName!=e[b+1].tagName){g+="_noMerge";break}c._iconEnable(g,f)}else{e=GetTDTHCell(b.startContainer);try{d.toString()||
(d=null)}catch(h){d=null}var m=GetParentbyTagName(d,"div");if(m&&"DEXT_fiVe_Page_Break"==m.className&&b.startContainer==b.endContainer)a.sel.removeAllRanges(),b.selectNode(m),a.sel.addRange(b),c._iconEnable("focusPageBreak");else if("table"==q)""!=g&&(f=checkContainClass(d,g)),c._iconEnable("focusTable",f);else{a=!1;m=!0;DEXTTOP.DEXT5.browser.ie&&1==DEXTTOP.DEXT5.browser.DOMParserSupported&&(m=!1);if(b&&0==b.collapsed)if(m)""!=b.text()&&(a=!0);else{var m=new DOMParser,t;try{t=m.parseFromString("<html><head></head><body></body></html>",
"text/html")}catch(u){t=document.implementation.createHTMLDocument("")}m=b.cloneContents();t.body.appendChild(m);""!=t.body.textContent&&(a=!0)}if(a){var v;"body"==q&&1==b.startContainer.nodeType&&(v=getSelectionTable(c));v?(""!=g&&(f=checkContainClass(v,g)),c._iconEnable("focusTable",f)):e?c._iconEnable("cellSelectText"):c._iconEnable("selectArea")}else if(v=getSelectionTable(c))""!=g&&(f=checkContainClass(v,g)),c._iconEnable("focusTable",f);else if(t=GetTDTHCell(d),"img"==q)DEXTTOP.G_SELECTED_ELEMENT=
d,GetParentbyTagName(d,"figure")?c._iconEnable("focusFigure"):c._iconEnable("focusImage");else if(t){if("1"!=c._config.formMode||"input"!=q&&"textarea"!=q&&"select"!=q)b=GetParentbyTagName(t,"table"),""!=g&&(f=checkContainClass(b,g)),checkLockAttr(b,!0)&&"1"!=c._config.formMode?c._iconEnable("focusInCellLockTable",f):c._iconEnable("focusInCell",f),DEXTTOP.G_SELECTED_ELEMENT=t}else"a"!=q&&"table"!=q&&"video"!=q&&("embed"==q?c._iconEnable("focusEmbed"):"span"==q&&d&&"raon_placeholder"==d.className?
c._iconEnable("placeholder"):c._iconEnable("default"))}}}};0==c._config.editorBodyEditable?(f=d,DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&(f=getFirstRange().range.startContainer,3==f.nodeType&&(f=f.parentNode)),0==f.isContentEditable?c._iconEnable("editableFalse"):"2"==c._config.toolBarEnableDisableMode?u():setTimeout(function(a){u(a)},10)):(setGlobalIsCollapsedInMouseup(),"2"==c._config.toolBarEnableDisableMode?u():setTimeout(function(a){u(a)},10))}}catch(v){"undefined"!=typeof RAONWIZDLW&&
RAONWIZDLW&&RAONWIZDLW()}}}function _iframeBody_Select(a){_iframeDoc_MouseUpMenu(a)}function setGeckoCellCaretPosistion(a,b){if(0<a.childNodes.length){var c=a.childNodes[a.childNodes.length-1];c.childNodes?b?doSetCaretPosition(c.childNodes[0],1):doSetCaretPosition(c.childNodes[0],0):doSetCaretPosition(c,0)}else doSetCaretPosition(a,0)}
function setTableShortcut(a){var b="which"in a?a.which:a.keyCode,c=!1,d=getEditrFromEvent(a);if(null==d)return c;try{if(a.ctrlKey){a=null;var e=getFirstRange().range;e&&1==e.collapsed&&e.startContainer&&(a=getMyElementNode(e.startContainer));if(a){if(a=GetTDTHCell(a))switch(ActiveCurrTable=GetParentbyTagName(a,"table"),b){case 116:ClearDraggingTableCellSelected();d._dextCommands(d.ID,"table_select_cell");c=!0;break;case 117:ClearDraggingTableCellSelected();d._dextCommands(d.ID,"table_select_row");
c=!0;break;case 118:ClearDraggingTableCellSelected();d._dextCommands(d.ID,"table_select_column");c=!0;break;case 119:ClearDraggingTableCellSelected();d._dextCommands(d.ID,"table_select_all");c=!0;break;case 120:d._dextCommands(d.ID,"merge_cell");c=!0;break;case 121:d._dextCommands(d.ID,"table_same_width");c=!0;break;case 122:d._dextCommands(d.ID,"table_same_height"),c=!0}c&&_iframeDoc_MouseUpMenu(null,a)}}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}
function getElemAdjustWidthHeight(a){var b={width:0,height:0},c=getCurrentZoomValue(DEXTTOP.G_CURREDITOR);if(a.style.width&&""!=a.style.width)if(-1<a.style.width.indexOf("%")||-1<a.style.width.indexOf("in")){var d=getClientRect(a);b.width=d.right-d.left}else b.width=parseInt(a.style.width);else a.width&&""!=a.width?b.width=parseInt(a.width):(d=getClientRect(a),b.width=d.right-d.left);if(a.style.height&&""!=a.style.height)if(d=getClientRect(a),-1<a.style.height.indexOf("%")||-1<a.style.width.indexOf("in"))b.height=
(d.bottom-d.top)/c;else{b.height=parseInt(a.style.height);try{var e=d.bottom-d.top,e=e/c;20<e-b.height&&(b.height=e)}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else a.height&&""!=a.height?b.height=parseInt(a.height):(d=getClientRect(a),b.height=d.bottom-d.top);return b}
function setCopyAllObjectAtributes(a,b,c){try{for(var d=a.attributes.length,e=0;e<d;e++){var f=a.attributes[e];f.specified&&"id"!=f.name&&("style"==f.name?b.style.cssText=a.style.cssText:"class"==f.name?b.className=f.value:b.setAttribute(f.name,f.value))}1==c&&(b.innerHTML=a.innerHTML);if("1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal){var g=findDiagonal(a,!0);g&&0<g.diagonalUp.length&&G_DEXT_Diagonal.makeDiagonal(b,"up",g.diagonalUp[0].style.borderTop);g&&0<g.diagonalDown.length&&
G_DEXT_Diagonal.makeDiagonal(b,"down",g.diagonalDown[0].style.borderTop)}}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function setCopyAllObjectAtributesForInput(a,b,c){try{for(var d=a.attributes.length,e=0;e<d;e++){var f=a.attributes[e];f.specified&&"type"!=name&&("style"==f.name?b.style.cssText=a.style.cssText:"type"!=f.name&&("class"==f.name?b.className=f.value:b.setAttribute(f.name,f.value)))}1==c&&(b.innerHTML=a.innerHTML)}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function getTopVerticalCells(a){var b=GetParentbyTagName(a,"table");if(GetParentbyTagName(a,"tr")){var c=[];a=getClientRect(a);for(var d=0;d<b.rows.length;d++)for(var e=b.rows[d],f=0;f<e.cells.length;f++){var g=e.cells[f],h=getClientRect(g);!1===isSameRect(a.top,h.top)&&a.top>h.top&&(isSameRect(a.left,h.left)?c.push(g):(a.top>=h.bottom||a.bottom<=h.top)&&.1<h.right-a.left&&.1<a.left-h.left&&c.push(g))}return c}}
function getLeftHorizontalCells(a){var b=GetParentbyTagName(a,"table");if(GetParentbyTagName(a,"tr")){var c=[],d=[];a=getClientRect(a);for(var e=0;e<b.rows.length;e++)for(var f=b.rows[e],g=0;g<f.cells.length;g++){var h=f.cells[g],m=getClientRect(h);if(!1===isSameRect(a.left,m.left)&&a.left>m.left&&(isSameRect(a.top,m.top)||!1===isSameRect(m.top,a.top)&&m.top<a.top&&!1===isSameRect(m.bottom,a.top)&&m.bottom>a.top)){var q={};q.left=m.left;q.cell=h;d.push(q)}}d.sort(function(a,b){return a.left-b.left});
for(e=0;e<d.length;e++)c.push(d[e].cell);return c}}
function getHorizontalCells(a,b){var c=[],d=GetParentbyTagName(a,"table"),e=GetParentbyTagName(a,"tr");if(b)for(var f=0;f<d.rows.length;f++)for(var g=d.rows[f],h=0;h<g.cells.length;h++){var m=g.cells[h];e.rowIndex==g.rowIndex?c.push(m):1<m.rowSpan?e.rowIndex>g.rowIndex&&e.rowIndex<g.rowIndex+m.rowSpan?c.push(m):1<a.rowSpan&&(e.rowIndex>g.rowIndex&&e.rowIndex<g.rowIndex+m.rowSpan?c.push(m):e.rowIndex<g.rowIndex&&e.rowIndex+a.rowSpan>g.rowIndex&&c.push(m)):1<a.rowSpan&&e.rowIndex<g.rowIndex&&e.rowIndex+
a.rowSpan>g.rowIndex&&c.push(m)}else c=e.cells;return c}
function getCellSize(a){var b={height:0};if(a){var c=getClientRect(a),c=Math.round(c.bottom-c.top);if(parseIntOr0(a.style.height)>=c)return b.height=parseIntOr0(a.style.height),b;var d=parseIntOr0(a.style.paddingTop)+parseIntOr0(a.style.paddingBottom),e=0,f=GetParentbyTagName(a,"table"),g="collapse"==f.style.borderCollapse,h=getCellNearLeftTop(a,!0),m=function(a,b){var c=a.parentElement,d=b.parentElement;return c.rowIndex==d.rowIndex?0:c.rowIndex>d.rowIndex?1:-1},q=function(a,b){var c=a.parentElement,
d=b.parentElement;if(1<a.rowSpan)return 1<b.rowSpan?c.rowIndex+a.rowSpan==d.rowIndex+b.rowSpan?0:c.rowIndex+a.rowSpan>d.rowIndex+b.rowSpan?1:-1:c.rowIndex+a.rowSpan==d.rowIndex+1?0:c.rowIndex+a.rowSpan>d.rowIndex+1?1:-1;if(1<b.rowSpan)return c.rowIndex+1==d.rowIndex+b.rowSpan?0:c.rowIndex+1>d.rowIndex+b.rowSpan?1:-1;if(c.rowIndex==d.rowIndex)return 0;if(c.rowIndex>d.rowIndex)return 1;if(c.rowIndex>d.rowIndex)return-1},t=0;if(h.arrTop[0]){if(g)for(var u=h.arrTop[0],v=getHorizontalCells(u,!0),w=0;w<
v.length;w++)if(0===q(u,v[w]))var y=parseIntOr0(v[w].style.borderBottomWidth),t=t>y?t:y;v=getHorizontalCells(a);w=0}else{g&&(t=parseIntOr0(f.style.borderTopWidth));var v=getHorizontalCells(a),w=0}for(;w<v.length;w++)u=parseIntOr0(v[w].style.borderTopWidth),t=t>u?t:u;u=0;if(h.arrBottom[0]){v=getHorizontalCells(a,!0);for(w=0;w<v.length;w++)0===q(a,v[w])&&(y=parseIntOr0(v[w].style.borderBottomWidth),u=u>y?u:y);if(g)for(h=getHorizontalCells(h.arrBottom[0]),w=0;w<h.length;w++)v=parseIntOr0(h[w].style.borderTopWidth),
u=u>v?u:v}else for(g&&(u=parseIntOr0(f.style.borderBottomWidth)),v=getHorizontalCells(a,!0),w=0;w<v.length;w++)0===q(a,v[w])&&(y=parseIntOr0(v[w].style.borderBottomWidth),u=u>y?u:y);v=h=0;if(1<parseIntOr0(a.rowSpan)){for(var y={},x={},z=getHorizontalCells(a,!0),w=0;w<z.length;w++){var B=z[w].parentElement.rowIndex;if(-1===m(a,z[w])){var D=parseIntOr0(z[w].style.borderTopWidth),A=parseIntOr0(z[w].style.paddingTop),C="posTop"+B;y[C]?(y[C]=y[C]>D?y[C]:D,x[C]=x[C]>A?x[C]:A):(y[C]=D,x[C]=A)}1===q(a,z[w])&&
(D=parseIntOr0(z[w].style.borderBottomWidth),A=parseIntOr0(z[w].style.paddingBottom),C="pos"+(g?"Top"+(B+1):"Bottom"+B),y[C]?(y[C]=y[C]>D?y[C]:D,x[C]=x[C]>A?x[C]:A):(y[C]=D,x[C]=A))}for(C in y)h+=y[C],v+=x[C];g||(v+=parseIntOr0(f.style.borderSpacing))}g&&(t=Math.ceil(t/2),u=Math.floor(u/2));e=e+t+u;e+=h;b.height=c-e-(d+v)}return b}
function command_AddTableLeftAndRight(a,b,c){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();var d=-1;a=-1;for(var e=b.currTableNode.rows.length,f=0;f<e;f++){for(var g=b.currTableNode.rows[f].cells.length,h=0;h<g;h++)if(b.currTableNode.rows[f].cells[h]==b.currCellNode){d=f;a=h;break}if(-1<d)break}if(-1<d&&-1<a){"right"==c&&(a+=1);d=0;e=[];for(f=0;f<b.tableNode.rows.length;f++)e.push(b.tableNode.rows[f].cells);for(f=e.length-1;0<=f;f--)for(g=e[f].length,h=g-1;0<=h;h--){0==f&&(d+=
DEXTTOP.DEXT5.util.parseIntOr0(e[f][0].style.width));var g=b.currTableNode.rows[f],m=e[f][h];"right"==c&&0==!!g.cells[a]?g.appendChild(m):g.insertBefore(m,g.cells[a]);"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal&&findDiagonal(m,!0)&&G_DEXT_Diagonal.setResizeForDiagonal(m)}c=b.currTableNode.style.width;-1<c.indexOf("px")&&(c=DEXTTOP.DEXT5.util.parseIntOr0(c),b.currTableNode.style.width=c+d+"px");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0}}
function command_AddTableUpAndDown(a,b,c){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();a=-1;for(var d=b.currTableNode.rows.length,e=0;e<d;e++){for(var f=b.currTableNode.rows[e].cells.length,g=0;g<f;g++)if(b.currTableNode.rows[e].cells[g]==b.currCellNode){a=e;break}if(-1<a)break}if(-1<a){"down"==c&&(a+=1);d=b.tableNode.getElementsByTagName("tr");if("down"==c&&0==!!b.currTableNode.rows[a])for(;0<d.length;)b.currTableNode.rows[a-1].parentNode.appendChild(d[0]);else for(;0<d.length;)b.currTableNode.rows[a].parentNode.insertBefore(d[d.length-1],
b.currTableNode.rows[a]);"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal&&findDiagonal(null,!1,DEXTTOP.G_CURREDITOR)&&G_DEXT_Diagonal.setResizeForDiagonal();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}var dragMove={dragStart:!1,dragData:null,dragRange:null,dragTarget:null,bodyRect:null,backX:0,backY:0,dragCursorOffsetX:0,dragCursorOffsetY:0,dragDummy:null,dragDummyBack:null,dragCaretValid:!1,dragCaret:null,dragEndContainer:null,ieButton:0};
function dragMoveStart(a,b){if(!(b||"0"!=DEXTTOP.G_CURREDITOR._config.dragMove&&DEXTTOP.DEXT5.browser.chrome))return!0;var c=_iframeDoc.body.getAttribute("contenteditable");if(""!=c&&"true"!=c)return DEXTTOP.DEXT5.util.stopEvent(a),DEXTTOP.DEXT5.util.cancelEvent(a),!1;Mouse_Status=0;c=getFirstRange();c=c.range;if(b||!c.collapsed)return _iframeDoc.body.contentEditable="false",_iframeDoc.body.style.cursor="move",_iframeDoc.documentElement.style.cursor="move",hideResizeBar(),dragMove.dragStart=!0,b?
(dragMove.dragTarget=b,c.selectNode(b)):dragMove.target=null,dragMove.dragRange=c,dragMove.dragData=c.toHtml(),createDragDummy(a),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"selectstart",dragMoveSelect),DEXTTOP.DEXT5.browser.ie?(DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mousemove",dragStop),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mouseup",dragStop)):DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mousemove",dragMoving),DEXTTOP.DEXT5.util.addEvent(document,"mousemove",dragStop),DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTDOC,
"mousemove",dragStop),dragMove.bodyRect=_iframeDoc.body.getBoundingClientRect(),dragMove.dragCursorOffsetX=_iframeDoc.defaultView.frameElement.offsetLeft,dragMove.dragCursorOffsetY=_iframeDoc.defaultView.frameElement.offsetTop,DEXTTOP.DEXT5.browser.ie&&(dragMove.ieButton=1),DEXTTOP.DEXT5.util.stopEvent(a),DEXTTOP.DEXT5.util.cancelEvent(a),!1}function dragMoveSelect(a){DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a)}
function createDragDummy(a){DEXTTOP.DEXT5.browser.ie||(dragMove.dragDummyBack?dragMove.dragDummyBack.style.display="":(dragMove.dragDummyBack=document.createElement("div"),dragMove.dragDummyBack.id="drag_dummy_back",dragMove.dragDummyBack.style.position="absolute",dragMove.dragDummyBack.style.top="0px",dragMove.dragDummyBack.style.left="0px",dragMove.dragDummyBack.style.width="100%",dragMove.dragDummyBack.style.height="100%",dragMove.dragDummyBack.style.zIndex="10100",DEXTTOP.DEXT5.util.addEvent(dragMove.dragDummyBack,
"mousemove",dragStop),dragMove.dragDummy=document.createElement("div"),dragMove.dragDummy.style.position="absolute",dragMove.dragDummy.style.border="0px solid black",dragMove.dragDummy.style.width="20px",dragMove.dragDummy.style.height="10px",dragMove.dragDummyBack.appendChild(dragMove.dragDummy),document.body.appendChild(dragMove.dragDummyBack)))}
function createSelectionFromPoint(a,b){var c=_iframeDoc,d=null;if("undefined"!=typeof c.caretPositionFromPoint){if(d=c.caretPositionFromPoint(a,b),"object"==typeof d&&"undefined"==typeof d.startContainer&&"undefined"==typeof d.endContainer){var e=c.caretPositionFromPoint(a,b),f=c.caretPositionFromPoint(a,b),d=c.createRange();d.setStart(e.offsetNode,e.offset);d.setEnd(f.offsetNode,f.offset)}}else"undefined"!=typeof c.caretRangeFromPoint&&(d=c.caretRangeFromPoint(a,b));d&&dragMove&&dragMove.dragRange&&
dragMove.dragRange.containsNode(d.startContainer)&&(d=null);if(null!==d&&"undefined"!=typeof window.getSelection)c=getFirstRange().sel,c.removeAllRanges(),c.addRange(d);else if("undefined"!=typeof c.body.createTextRange){e=c.body.createTextRange();try{var g=dragMove.bodyRect.left,h=dragMove.bodyRect.right,m=dragMove.bodyRect.top,q=c.body.lastElementChild.getBoundingClientRect().bottom;a<g?a=g+1:a>h&&(a=h-1);b<m?b=m+1:b>q&&(b=q-1);e.moveToPoint(a,b);e.select();var t=getFirstRange(),d=t.range;dragMove.dragRange.containsNode(d.startContainer)?
(t.sel.removeAllRanges(),d=null):d.collapse(!1)}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}return d}
function dragMoving(a){if(dragMove.dragStart){var b=!0,c=a.target?a.target:a.srcElement;if(c==dragMove.dragDummyBack||c==dragMove.dragDummy){var d=_iframeWin.frameElement.getBoundingClientRect();dragMove.backX=d.left;dragMove.backY=d.top}else c.ownerDocument==_iframeDoc?(dragMove.backX=0,dragMove.backY=0):(dragMove.dragDummy&&(dragMove.dragDummy.style.display="none"),b=!1);d=a.clientX-dragMove.backX;a=a.clientY-dragMove.backY;dragMove.dragCaret&&dragMove.dragCaret.parentNode&&c!=dragMove.dragCaret.parentNode&&
dragMove.dragCaret.parentNode.removeChild(dragMove.dragCaret);if(b=b&&createSelectionFromPoint(d,a))if(targetNode=b.startContainer,offset=b.startOffset,targetNode!=dragMove.dragCaret&&"html"!=targetNode.nodeName.toLowerCase()&&(3!=targetNode.nodeType||"false"!=targetNode.parentNode.getAttribute("contenteditable"))){if(targetNode&&3!=targetNode.nodeType&&targetNode.childNodes[offset]&&3==targetNode.childNodes[offset].nodeType&&targetNode.childNodes[offset].wholeText.charAt(0)==unescape("%uFEFF"))return;
b.setStart(targetNode,offset);b.collapse(!1);null==dragMove.dragCaret&&(dragMove.dragCaret=_iframeDoc.createElement("span"),dragMove.dragCaret.style.display="inline-block",dragMove.dragCaret.style.width="0px",dragMove.dragCaret.style.height="1em",dragMove.dragCaret.style.borderLeft="1px solid black",dragMove.dragCaret.style.marginLeft="-0.5px");b.insertNode(dragMove.dragCaret);b=targetNode.parentNode.childNodes;for(c=b.length-1;-1<c;c--){var e=b[c];3==e.nodeType&&""==e.nodeValue&&dragMove.dragRange.startContainer!=
e&&dragMove.dragEndContainer!=e&&e.parentNode.removeChild(e)}}dragMove.dragCaret&&dragMove.dragCaret.parentNode?(dragMove.dragCaretValid=!0,_iframeDoc.body.style.cursor="move",_iframeDoc.documentElement.style.cursor="move"):(dragMove.dragCaretValid=!1,_iframeDoc.body.style.cursor="no-drop",_iframeDoc.documentElement.style.cursor="no-drop");null!=dragMove.dragDummy&&(dragMove.dragDummy.style.left=d-10+dragMove.dragCursorOffsetX+"px",dragMove.dragDummy.style.top=a-5+dragMove.dragCursorOffsetY+"px",
dragMove.dragDummy.style.display="")}}
function dragEnd(a){if(DEXTTOP.DEXT5.browser.ie||dragMove.dragCaret&&dragMove.dragCaret.parentNode){var b=getFirstRange();a=b.sel;var c=b.range;if((DEXTTOP.DEXT5.browser.ie||!c.containsNode(dragMove.dragCaret))&&dragMove.dragCaret&&dragMove.dragCaretValid){dragMove.dragTarget?(c.selectNode(dragMove.dragTarget),c.deleteContents(),c.collapseBefore(dragMove.dragCaret),dragMove.dragCaret.parentNode.removeChild(dragMove.dragCaret)):(dragMove.dragRange.deleteContents(),c.deleteContents(),dragMove.dragCaret.parentNode&&
(c.collapseAfter(dragMove.dragCaret),dragMove.dragCaret.parentNode.removeChild(dragMove.dragCaret)));dragMove.dragCaret=null;a.focusNode.parentNode&&(b=a.focusNode.parentNode,b.nextSibling&&""==b.nextSibling.innerHTML&&b.nextSibling.parentNode&&b.nextSibling.parentNode.removeChild(b.nextSibling),""==b.innerHTML&&b.parentNode&&b.parentNode.removeChild(b));dragMove.dragData=dragMove.dragData.replace(/<p><\/p>/gi,"");a.removeAllRanges();a.addRange(c);var d='<span name="raon_drag_mark"></span>'+dragMove.dragData+
'<span name="raon_drag_mark"></span>';pasteHtmlAtCaretHuge(d,!1,!0,!1,!0);b=_iframeDoc.getElementsByName("raon_drag_mark");if(1<b.length)if(DEXTTOP.DEXT5.browser.ie){if(-1<d.indexOf("<table"))try{var e=b[0].parentNode.nextSibling.rows[0].cells[0],e=e.childNodes[0]||e;c.setStart(e,0)}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else c.setStartBefore(b[1]);c.collapse(!0)}else e=_iframeDoc.createTextNode(""),b[0].parentNode.insertBefore(e,b[0]),c.setStart(e,0),dragMove.dragEndContainer=
_iframeDoc.createTextNode(""),b[1].parentNode.insertBefore(dragMove.dragEndContainer,b[1]),c.setEnd(dragMove.dragEndContainer,0);a.removeAllRanges();a.addRange(c);_iframeDoc.body.focus();for(a=b.length-1;-1<a;a--)e=b[a].parentNode,e.removeChild(b[a]),(0==e.childNodes.length||1==e.childNodes.length&&3==e.childNodes[0].nodeType&&""==e.childNodes[0].nodeValue&&e.parentNode)&&e.parentNode.removeChild(e);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}}
function dragStop(a){0==dragMove.ieButton&&1!=a.buttons?(_iframeDoc.body.contentEditable="true",_iframeDoc.body.style.cursor="",_iframeDoc.documentElement.style.cursor="",dragEnd(a),dragMove.dragStart=!1,dragMove.dragDummy&&(dragMove.dragDummyBack.style.display="none",dragMove.dragDummy.style.display="none",DEXTTOP.DEXT5.util.removeEvent(dragMove.dragDummyBack,"mousemove",dragStop)),dragMove.dragCaret&&dragMove.dragCaret.parentNode&&dragMove.dragCaret.parentNode.removeChild(dragMove.dragCaret),DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,
"selectstart",dragMoveSelect),DEXTTOP.DEXT5.browser.ie?(DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"mousemove",dragStop),DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"mouseup",dragStop)):DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"mousemove",dragMoving),DEXTTOP.DEXT5.util.removeEvent(document,"mousemove",dragStop),DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTDOC,"mousemove",dragStop)):(DEXTTOP.DEXT5.browser.ie&&(dragMove.ieButton=0),dragMoving(a))}
function isSameRect(a,b,c){var d=!1,e=1;"number"==typeof c&&(e=c+.99);Math.abs(a-b)<e&&(d=!0);return d}
var G_ResizeFixedTable={modifiedName:"d5col",changeColWidth:function(a,b){var c=this.getColWidth(a);this.setColWidth(a,c+b)},setColWidth:function(a,b){a.style.width&&(a.style.width=b+"px");a.width=b+"px"},getColWidth:function(a){return parseFloat(""!=a.style.width?a.style.width:a.width)},getCellIndex:function(a){for(var b=0,c=this.getColgroup(a).childNodes.length,d=getClientRect(a),e=a.parentNode,f=GetParentbyTagName(e,"table");e;){for(var g=0,h=e.cells,m=h.length,q=0;q<m;q++)g+=this.getColSpanInt(h[q]);
if(g==c)break;else e=f.rows[e.rowIndex-1]}e=e.cells;f=e.length;for(q=0;q<f;q++)if(g=e[q],c=getClientRect(g),g=this.getColSpanInt(g),b+=g,this.isSameLeftRect(c,d)){b-=g;break}else if(this.isSameRightRect(c,d)){b-=this.getColSpanInt(a);break}else if(this.isContainedRect(c,d)){b-=g;for(a=a.previousSibling;a&&(d=getClientRect(a),b+=this.getColSpanInt(a),!this.isSameLeftRect(c,d));)a=a.previousSibling;break}return b},getColIndex:function(a){var b=null,b=this.getCellIndex(a);a=b+this.getColSpanInt(a)-1;
return b={start:b,end:a}},getColgroup:function(a){var b=null;if("TABLE"==a.tagName)b=a.getElementsByTagName("colgroup")[0];else if("TD"==a.tagName||"TH"==a.tagName)b=GetParentbyTagName(a,"table").getElementsByTagName("colgroup")[0];return b},getColSpanInt:function(a){return a.colSpan?a.colSpan:1},isSameLeftRect:function(a,b){return 1>Math.abs(a.left-b.left)?!0:!1},isSameRightRect:function(a,b){return 1>Math.abs(a.right-b.right)?!0:!1},isContainedRect:function(a,b){return 1<=Math.abs(a.left-b.left)&&
a.left<b.left&&1<=Math.abs(a.right-b.right)&&a.right>b.right?!0:!1},isExcute:function(a){var b=!1;"fixed"==getComputedStyle(a).tableLayout&&(b=!0);return b},isModifiedTable:function(a){var b=!1;null!=a.getAttribute(this.modifiedName)&&(b=!0);return b},setColgroupToTable:function(a){try{for(var b=null,c=a.rows.length,d=0;d<c;d++){var e=a.rows[d];null==b?b=e:e.cells.length>b.cells.length&&(b=e)}for(var f=e.cells,g=f.length,h=_iframeDoc.createElement("colgroup"),b=0;b<g;b++)for(var m=f[b],q=m.colSpan?
parseInt(m.colSpan):1,t=m.clientWidth,c=0;c<q;c++){var u=_iframeDoc.createElement("col");this.setColWidth(u,(t/q).toFixed(1));h.appendChild(u)}for(var v=a.getElementsByTagName("colgroup"),d=v.length-1;0<=d;d--)a==GetParentbyTagName(v[d],"table")&&v[d].parentNode.removeChild(v[d]);var w=a.getElementsByTagName("tbody")[0];a.insertBefore(h,w);a.setAttribute(this.modifiedName,"")}catch(y){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},resizeFixedTable:function(a){try{var b=a.nNewWidth;if(0!=
b){var c=a.targetCell,d=GetParentbyTagName(c,"table");if(1==this.isExcute(d)){this.setColgroupToTable(d);var e=this.getColgroup(c).childNodes,f=this.getCellIndex(c)+(c.colSpan?c.colSpan:1);0<b&&--f;a=0>b?-1:1;b=Math.abs(b);e[f]&&this.changeColWidth(e[f],b);f+=a;if(e[f])for(;e[f];){var g=this.getColWidth(e[f]);g<=b?(b-=g-1,this.changeColWidth(e[f],-(g-1)),f+=a):(this.changeColWidth(e[f],-b),b=0);if(0==b)break}var h=d.offsetWidth;d.style.width="0px";var m=d.offsetWidth;5>Math.abs(h-m)&&(m=h);d.style.width=
m+"px"}else this.getColgroup(d)&&command_AdjustTableAndCellWidth(DEXTTOP.G_CURREDITOR,{tables:[d]})}}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},setSameWidth:function(a){try{var b=GetTableSelectionCells(),c=GetParentbyTagName(b[0],"table");if(0!=this.isExcute(c)){this.setColgroupToTable(c);a=[];for(var d=b.length,e=-1,f=-1,c=0;c<d;c++)b[c].parentNode.rowIndex!=e&&(e=b[c].parentNode.rowIndex,f++,a[f]=[]),b[c].parentNode.rowIndex==e&&a[f].push(b[c]);a.sort(function(a,b){return b.length>
a.length?1:b.length<a.length?-1:0});for(var g=a.length,h=this.getColgroup(b[0]).childNodes,b=0;b<g;b++){for(var d=0,e=[],m=a[b],q=m.length,c=0;c<q;c++){var t=this.getColIndex(m[c]);e.push(t);for(var u=t.start;u<=t.end;u++)d+=this.getColWidth(h[u])}for(var v=d/m.length,w=e.length,c=0;c<w;c++)for(var y=(v/(e[c].end-e[c].start+1)).toFixed(1),u=e[c].start;u<=e[c].end;u++)this.setColWidth(h[u],y)}}}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}};
function splitTable(a,b){for(var c={table1:null,table2:null},d=a.parentNode,e=d.cells,f=e.length,g=!0,h=getClientRect(b),m=0;m<f;m++){var q=e[m],t=getClientRect(q);if(0==m){var q=DEXTTOP.DEXT5.util.parseIntOr0(q.style.borderLeftWidth),u=DEXTTOP.DEXT5.util.parseIntOr0(b.style.borderLeftWidth),q=Math.abs((q-u)/2+1);if(Math.abs(t.left-h.left)>q){g=!1;break}}else{u=getClientRect(e[m-1]);if(0==isSameRect(t.top,u.top)){g=!1;break}if(0==isSameRect(t.left,u.right)){g=!1;break}if(m==f-1&&(q=DEXTTOP.DEXT5.util.parseIntOr0(q.style.borderRightWidth),
u=DEXTTOP.DEXT5.util.parseIntOr0(b.style.borderRightWidth),q=Math.abs((q-u)/2+1),Math.abs(t.right-h.right)>q)){g=!1;break}}}if(g)if(0==d.rowIndex)c.table1=null,c.table2=b;else{e=b.rows;g=e.length;f=b.cloneNode();h=b.getElementsByTagName("colgroup");t=h.length;for(m=0;m<t;m++)q=h[m].cloneNode(!0),f.appendChild(q);h=(m=b.getElementsByTagName("tbody")[0])?m.cloneNode():_iframeDoc.createElement("tbody");t=[];for(m=g-1;0<=m&&(g=e[m],t.push(g.cloneNode(!0)),g.parentNode.removeChild(g),g!=d);m--);for(m=
t.length-1;0<=m;m--)h.appendChild(t[m]);f.appendChild(h);b.nextSibling?b.parentNode.insertBefore(f,b.nextSibling):b.parentNode.appendChild(f);c.table1=b;c.table2=f}return c}function removeEmptyStyleTag(a){try{if(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion){var b=new RegExp("(<"+a.tagName+" [^>]*>)","i");b.test(a.outerHTML);var c=RegExp.$1,b=/style="[^"](.*)"/i;b.test(c)||removeAttribute(a,"style")}}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function insertRowByIndex(a,b,c){var d=_iframeDoc.createElement("tr");a=a.rows;(c=a[c])?c.parentNode!=b.parentNode?b.parentNode.appendChild(d):c.parentNode.insertBefore(d,c):(c=a[a.length-1],c.parentNode.appendChild(d));return d}
function insertCellByIndex(a,b,c){var d=_iframeDoc.createElement(b.tagName);c=a.cells[c];"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal&&findDiagonal(b,!0)&&(d.style.position="relative",d.style.overflow="hidden",d.className="dext_diagonal_td",G_DEXT_Diagonal.setResizeForDiagonal(d));c?a.insertBefore(d,c):a.appendChild(d);return d}
function oneCellAndRowContentsDeleteAction(a,b){if(!DEXTTOP.DEXT5.browser.ie){var c=getFirstRange().range,d=getFirstRange().sel;if(!c.collapsed&&(1==d.focusNode.nodeType&&"BODY"==d.focusNode.tagName||0==c.startOffset)){var e=c.endContainer,f=c.endOffset,g=c.startContainer,h="s",m=GetParentbyTagName(e,"table");null==m&&""==e.textContent&&(m=GetParentbyTagName(g,"table"),h="e");if(m&&(a.UndoManager.putUndo(),a.UndoManager.charCount=0,1==m.rows.length&&1==m.rows[0].cells.length)){var q=m.rows[0].cells[0];
"s"==h?1==d.focusNode.nodeType&&"BODY"==d.focusNode.tagName&&(c.setStart(q.firstChild,0),c.setEnd(e,f),d.removeAllRanges(),d.addRange(c)):(e=q.lastChild,c.setStart(g,0),c.setEndAfter(e),d.removeAllRanges(),d.addRange(c));88==b&&command_copy(a);c.deleteContents();if(""==q.innerHTML||"<p></p>"==q.innerHTML||""==q.textContent)q.innerHTML="<p><br /></p>";c=m.getElementsByTagName("p");d=c.length;g=[];for(m=0;m<d;m++)q=c[m],""==q.innerHTML&&g.push(q);for(;0<g.length;)q=g.pop(),q.parentNode.removeChild(q);
return!0}}}}
function getTableAllCells(a,b){var c=a;if(c&&("TABLE"!=c.tagName&&(c=GetParentbyTagName(a,"table")),c&&"TABLE"==c.tagName)){for(var d=[],e=0;e<c.rows.length;e++){d[e]||(d[e]=[]);for(var f=0;f<c.rows[e].cells.length;f++){var g=c.rows[e].cells[f],h;for(h=0;null!=d[e][h]&&d[e][h].isInfo;h++);for(var m=0;m<g.rowSpan;m++){d[e+m]||(d[e+m]=[]);for(var q=0;q<g.colSpan;++q)b&&"true"!=g.getAttribute("dext_select")||(d[e+m][h+q]={},d[e+m][h+q].isInfo=!0,d[e+m][h+q].isOneCell=1==g.rowSpan&&1==g.colSpan,d[e+m][h+
q].cell=g,d[e+m][h+q].rowSpan=g.rowSpan,d[e+m][h+q].colSpan=g.colSpan,d[e+m][h+q].row=e,d[e+m][h+q].col=h,d[e+m][h+q].idxInRowSpan=m,d[e+m][h+q].idxInColSpan=q)}}}return d}}
function GetTableSelectionCellsEx(a,b){null==ActiveCurrTable&&(ActiveCurrTable=GetParentbyTagName(a,"table"));if(null==ActiveCurrTable)return[];for(var c=[],d=getTableAllCells(ActiveCurrTable),e=0;e<d.length;e++){for(var f=[],g=0;g<d[e].length;g++){var h=d[e][g].cell;if(b&&a==h&&d[e][g].isOneCell)return f.push(d[e][g]),c.push(f),c.push(d.length),c.push(d[e].length),c;if(b&&a==h){var h=d[e][g].colSpan,m=d[e][g].rowSpan;f.push(d[e][g]);1<h&&1<m?f.push(d[e+m-1][g+h-1]):1<h?f.push(d[e][g+h-1]):1<m&&f.push(d[e+
m-1][g]);c.push(f);c.push(d.length);c.push(d[e].length);return c}b||"true"!=h.getAttribute("dext_select")&&h!=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT)||f.push(d[e][g])}0<f.length&&c.push(f)}return c}
function GetTableSelectionCellsPositionEx(a,b,c){null==ActiveCurrTable&&(ActiveCurrTable=GetParentbyTagName(a,"table"));if(null==ActiveCurrTable)return[];var d={arrOutSideLeft:[],arrOutSideRight:[],arrOutSideTop:[],arrOutSideBottom:[]},e=GetTableSelectionCellsEx(a,c);c&&(e=e.slice(0,e.length-2));a=getTableAllCells(ActiveCurrTable);b&&(e=a);b={};b=function(a){var b={firstCell:{},lastCell:{}},c=e[0][0],d=e[e.length-1][e[0].length-1];if(c.cell==d.cell)b.firstCell.row=c.row,b.firstCell.col=c.col,b.lastCell.row=
b.firstCell.row+(c.rowSpan-1),b.lastCell.col=b.firstCell.col+(c.colSpan-1);else for(var c=c.cell,d=d.cell,f=!1,u=0;u<a.length;u++)if(a[u]&&0<a[u].length)for(var v=0;v<a[u].length;v++)a[u][v]&&a[u][v].cell==c&&!f&&(b.firstCell.row=u,b.firstCell.col=v,f=!0),a[u][v]&&a[u][v].cell==d&&(b.lastCell.row=u,b.lastCell.col=v);return b};b=c?b(e):b(a);var f=b.firstCell.col;do{if(!a[b.firstCell.row-1])break;c=a[b.firstCell.row-1][f];d.arrOutSideTop.push(c.cell);f=0==c.idxInColSpan?f+c.colSpan:f+(c.colSpan-c.idxInColSpan)}while(f<=
b.lastCell.col);f=b.firstCell.col;do{if(!a[b.lastCell.row+1])break;c=a[b.lastCell.row+1][f];d.arrOutSideBottom.push(c.cell);f=0==c.idxInColSpan?f+c.colSpan:f+(c.colSpan-c.idxInColSpan)}while(f<=b.lastCell.col);f=b.firstCell.row;do{if(!a[b.firstCell.row][b.firstCell.col-1])break;c=a[f][b.firstCell.col-1];d.arrOutSideLeft.push(c.cell);f=0==c.idxInRowSpan?f+c.rowSpan:f+(c.rowSpan-c.idxInRowSpan)}while(f<=b.lastCell.row);f=b.firstCell.row;do{if(!a[b.firstCell.row][b.lastCell.col+1])break;c=a[f][b.lastCell.col+
1];d.arrOutSideRight.push(c.cell);f=0==c.idxInRowSpan?f+c.rowSpan:f+(c.rowSpan-c.idxInRowSpan)}while(f<=b.lastCell.row);return d}
function GetPreviewCellBorder(a){var b={sameWidth:"",sameStyle:"",sameColor:""},c={sameWidth:"",sameStyle:"",sameColor:""},d={sameWidth:"",sameStyle:"",sameColor:""},e=function(a,e,f,g){if("undefined"===typeof a)return e;if(""==b.sameWidth)b.sameWidth=a.width==e.width?a.width:"diff";else if("diff"!=b.sameWidth&&a.width==e.width&&b.sameWidth==a.width)b.sameWidth=a.width;else if(b.sameWidth!=a.width||a.width!=e.width)b.sameWidth="diff";if(""==b.sameStyle)b.sameStyle=a.style==e.style?a.style:"diff";
else if("diff"!=b.sameStyle&&a.style==e.style&&b.sameStyle==a.style)b.sameStyle=a.style;else if(b.sameStyle!=a.style||a.style!=e.style)b.sameStyle="diff";if(""==b.sameColor)b.sameColor=a.color==e.color?a.color:"diff";else if("diff"!=b.sameColor&&a.color==e.color&&b.sameColor==a.color)b.sameColor=a.color;else if(b.sameColor!=a.color||a.color!=e.color)b.sameColor="diff";if("top"==g||"bottom"==g||"left"==g||"right"==g){if(""==c.sameWidth)c.sameWidth=a.width==e.width?a.width:"diff";else if("diff"!=c.sameWidth&&
a.width==e.width&&c.sameWidth==a.width)c.sameWidth=a.width;else if(c.sameWidth!=a.width||a.width!=e.width)c.sameWidth="diff";if(""==c.sameStyle)c.sameStyle=a.style==e.style?a.style:"diff";else if("diff"!=c.sameStyle&&a.style==e.style&&c.sameStyle==a.style)c.sameStyle=a.style;else if(c.sameStyle!=a.style||a.style!=e.style)c.sameStyle="diff";if(""==c.sameColor)c.sameColor=a.color==e.color?a.color:"diff";else if("diff"!=c.sameColor&&a.color==e.color&&c.sameColor==a.color)c.sameColor=a.color;else if(c.sameColor!=
a.color||a.color!=e.color)c.sameColor="diff"}else if("middle"==g||"center"==g){if(""==d.sameWidth)d.sameWidth=a.width==e.width?a.width:"diff";else if("diff"!=d.sameWidth&&a.width==e.width&&d.sameWidth==a.width)d.sameWidth=a.width;else if(d.sameWidth!=a.width||a.width!=e.width)d.sameWidth="diff";if(""==d.sameStyle)d.sameStyle=a.style==e.style?a.style:"diff";else if("diff"!=d.sameStyle&&a.style==e.style&&d.sameStyle==a.style)d.sameStyle=a.style;else if(d.sameStyle!=a.style||a.style!=e.style)d.sameStyle=
"diff";if(""==d.sameColor)d.sameColor=a.color==e.color?a.color:"diff";else if("diff"!=d.sameColor&&a.color==e.color&&d.sameColor==a.color)d.sameColor=a.color;else if(d.sameColor!=a.color||a.color!=e.color)d.sameColor="diff"}if(JSON.stringify(a)===JSON.stringify(e))return a;if(("none"==a.style&&"none"!=e.style||"0px"==a.width&&"0px"!=e.width)&&f)return e;if(("none"!=a.style&&"none"==e.style||"0px"!=a.width&&"0px"==e.width)&&f)return a.diff&&delete a.diff,a;if((""==a.style&&""!=e.style||""==a.width&&
""!=e.width)&&f)return e;if((""!=a.style&&""==e.style||""!=a.width&&""==e.width)&&f)return a.diff&&delete a.diff,a;a.diff||(a.diff="diff");return a},f=function(a){var b="",c;for(c in a)a.hasOwnProperty(c)&&(b+=a[c],b+=" ");return DEXTTOP.DEXT5.util.trim(b)},g=function(a,b){var c={},d=function(a,b){document.defaultView&&document.defaultView.getComputedStyle?computedValue=document.defaultView.getComputedStyle(a,null).getPropertyValue(b):a.currentStyle&&(computedValue=a.currentStyle[b]);return computedValue},
e=function(b,e,f){var g,h,m;if("undefined"===typeof e||null==e||b==e){e={};e[b]={style:d(a,"border-"+b+"-style"),color:a.style["border-"+b+"-color"]||d(a,"border-"+b+"-color"),width:d(a,"border-"+b+"-width")};var q=GetParentbyTagName(a,"table",!0);""==e[b].style&&q&&q.getAttribute("border")&&"0"!=q.getAttribute("border")&&(""==q.style.borderStyle||"none"!=q.style.borderStyle||q.style.borderColor==d(q,"border-"+b+"-color"))&&(e[b].style="solid");""==e[b].width&&q&&q.getAttribute("border")&&"0"!=q.getAttribute("border")&&
(""==q.style.borderWidth||"none"!=q.style.borderStyle||q.style.borderColor==d(q,"border-"+b+"-color"))&&(e[b].width="1px");if(q&&q.getAttribute("border")&&"0"!=q.getAttribute("border")&&"none"==q.style.borderStyle&&e[b].color==d(a,"color")){var t=d(a,"color");a.style.color="";e[b].color=d(a,"border-"+b+"-color")||a.style["border-"+b+"-color"];a.style.color=t}if(0<f.length&&"collapse"==d(q,"border-collapse")){q={top:"bottom",right:"left",bottom:"top",left:"right"};t=!1;g=!0;for(var u=0;u<f.length;u++)a.style["border-"+
b]!=f[u].style["border-"+q[b]]&&(g=!1);if(!g){m=h=g=!1;for(var v=function(a){var b=a;switch(a){case "thin":b="1px";break;case "medium":b="3px";break;case "thick":b="5px"}return b},u=0;u<f.length;u++)if("none"!=e[b].style&&"none"!=f[u].style["border-"+q[b]+"-style"]){var w=e[b].width,x=f[u].style["border-"+q[b]+"-width"],w=v(w),x=v(x);DEXTTOP.DEXT5.util.parseIntOr0(w)>DEXTTOP.DEXT5.util.parseIntOr0(x)?g=!0:DEXTTOP.DEXT5.util.parseIntOr0(w)==DEXTTOP.DEXT5.util.parseIntOr0(x)?m=!0:DEXTTOP.DEXT5.util.parseIntOr0(w)<
DEXTTOP.DEXT5.util.parseIntOr0(x)&&(h=!0)}!g||h||m?!h||g||m?!m||g||h||(t=!0):t=!0:t=!1}if(t)if(h)e[b].style=f[0].style["border-"+q[b]+"-style"],e[b].width=f[0].style["border-"+q[b]+"-width"],e[b].color=f[0].style["border-"+q[b]+"-color"];else if(m)if(DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion){if("right"==b||"bottom"==b)e[b].style=f[0].style["border-"+q[b]+"-style"],e[b].width=f[0].style["border-"+q[b]+"-width"],e[b].color=f[0].style["border-"+q[b]+"-color"]}else if("top"==b||"left"==
b)e[b].style=f[0].style["border-"+q[b]+"-style"],e[b].width=f[0].style["border-"+q[b]+"-width"],e[b].color=f[0].style["border-"+q[b]+"-color"]}DEXTTOP.DEXT5.util.objectExtend(c,e)}},f=["top","right","bottom","left"],g=GetTableSelectionCellsPositionEx(a,null,!0);"[object Array]"===Object.prototype.toString.call(g)&&(g={arrOutSideTop:[],arrOutSideRight:[],arrOutSideBottom:[],arrOutSideLeft:[]});for(var h=0;4>h;h++)e(f[h],b,g["arrOutSide"+f[h].charAt(0).toUpperCase()+f[h].slice(1)]);return c},h={},m=
{},q="one",t=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table",!0),u=!1;DEXTTOP.G_CURREDITOR._FRAMEWIN._iframeWin.getComputedStyle?"collapse"==DEXTTOP.G_CURREDITOR._FRAMEWIN._iframeWin.getComputedStyle(t).borderCollapse&&(u=!0):t&&"collapse"==t.style.borderCollapse&&(u=!0);var v;v=a?getTableAllCells(t):GetTableSelectionCellsEx();var w=GetTableSelectionCellsPositionEx(DEXTTOP.G_SELECTED_ELEMENT,a),y=v.length,x=v[0].length;1<y&&1==x?q="rows":1<x&&1==y?q="cols":1<y&&1<x&&(q="multi");a&&(q="multi");
if("one"==q){var x=v[0][0].cell,z=g(x),h={top:z.top,left:z.left,right:z.right,bottom:z.bottom};if(w&&u){var z=w.arrOutSideTop.length?w.arrOutSideTop[0]:null,B=w.arrOutSideLeft.length?w.arrOutSideLeft[0]:null,D=w.arrOutSideRight.length?w.arrOutSideRight[0]:null,A=w.arrOutSideBottom.length?w.arrOutSideBottom[0]:null;z?(z=g(z),h.top=e(h.top,z.bottom,!0,"top")):h.top=e(h.top,h.top,!0,"top");B?(z=g(B),h.left=e(h.left,z.right,!0,"left")):h.left=e(h.left,h.left,!0,"left");D?(z=g(D),h.right=e(h.right,z.left,
!0,"right")):h.right=e(h.right,h.right,!0,"right");A?(z=g(A),h.bottom=e(h.bottom,z.top,!0,"bottom")):h.bottom=e(h.bottom,h.bottom,!0,"bottom")}m.top=f(h.top);m.right=f(h.right);m.bottom=f(h.bottom);m.left=f(h.left)}else if("rows"==q){x=v[0][0].cell;z=g(x,"top");h.top=z.top;w&&u&&((z=w.arrOutSideTop.length?w.arrOutSideTop[0]:null)?(z=g(z),h.top=e(h.top,z.bottom,!0,"top")):h.top=e(h.top,h.top,!0,"top"));m.top=f(h.top);x=v[y-1][0].cell;z=g(x,"bottom");h.bottom=z.bottom;w&&u&&((A=w.arrOutSideBottom.length?
w.arrOutSideBottom[0]:null)?(z=g(A),h.bottom=e(h.bottom,z.top,!0,"bottom")):h.bottom=e(h.bottom,h.bottom,!0,"bottom"));m.bottom=f(h.bottom);for(var C=0;C<v.length;C++){var E=v[C],x=E[0].cell,z=g(x);0==C?h={left:z.left,right:z.right,middle:z.bottom}:(h.left=e(h.left,z.left,null,"left"),h.right=e(h.right,z.right,null,"right"),1==x.rowSpan&&(h.middle=e(h.middle,e(z.top,g(v[C-1][0].cell).bottom,!0,"middle"),null,"middle"),C!=y-1&&(h.middle=e(h.middle,e(z.bottom,g(v[C+1][0].cell).top,!0,"middle"),null,
"middle"))))}D=h.left;A=h.right;if(w&&"undefined"!=typeof w.arrOutSideLeft&&u)for(E=!0,C=0;w.arrOutSideLeft.length>C;C++)B=w.arrOutSideLeft[C],z=g(B),h.left=e(h.left,e(z.right,D,!0,"left"),E,"left"),E=!1;if(w&&"undefined"!=typeof w.arrOutSideRight&&u)for(E=!0,C=0;w.arrOutSideRight.length>C;C++)D=w.arrOutSideRight[C],z=g(D),h.right=e(h.right,e(z.left,A,!0,"right"),E,"right"),E=!1;m.left=f(h.left);m.right=f(h.right);m.middle=f(h.middle)}else if("cols"==q){A=v[0];z=g(A[0].cell,"left");h.left=z.left;
w&&u&&((B=w.arrOutSideLeft.length?w.arrOutSideLeft[0]:null)?(z=g(B),h.left=e(h.left,z.right,!0,"left")):h.left=e(h.left,h.left,!0,"left"));m.left=f(h.left);z=g(A[x-1].cell,"right");h.right=z.right;w&&u&&((D=w.arrOutSideRight.length?w.arrOutSideRight[0]:null)?(z=g(D),h.right=e(h.right,z.left,!0,"right")):h.right=e(h.right,h.right,!0,"right"));m.right=f(h.right);for(C=0;C<A.length;C++)E=A[C].cell,z=g(E),0==C?h={top:z.top,bottom:z.bottom,center:z.right}:(h.top=e(h.top,z.top,null,"top"),h.bottom=e(h.bottom,
z.bottom,null,"bottom"),1==E.colSpan&&(h.center=e(h.center,e(z.left,g(A[C-1].cell).right,!0,"center"),null,"center"),C!=x-1&&(h.center=e(h.center,e(z.right,g(A[C+1].cell).left,!0,"center"),null,"center"))));D=h.top;B=h.bottom;if(w&&"undefined"!=typeof w.arrOutSideTop&&u)for(E=!0,C=0;w.arrOutSideTop.length>C;C++)z=w.arrOutSideTop[C],z=g(z),h.top=e(h.top,e(z.bottom,D,!0,"top"),E,"top"),E=!1;if(w&&"undefined"!=typeof w.arrOutSideBottom&&u)for(E=!0,C=0;w.arrOutSideBottom.length>C;C++)A=w.arrOutSideBottom[C],
z=g(A),h.bottom=e(h.bottom,e(z.top,B,!0,"bottom"),E,"bottom"),E=!1;m.top=f(h.top);m.bottom=f(h.bottom);m.center=f(h.center)}else if("multi"==q){A=v[0];for(C=0;C<A.length;C++)E=A[C].cell,z=g(E),0==C?(h={top:z.top},1==E.rowSpan&&(h.middle=z.bottom)):(h.top=e(h.top,z.top,null,"top"),1==E.rowSpan&&(h.middle=1<v.length?e(h.middle,e(z.bottom,g(v[1][C].cell).top,!0,"middle"),null,"middle"):e(h.middle,z.bottom,null,"middle")));D=h.top;if(w&&"undefined"!=typeof w.arrOutSideTop&&u)for(E=!0,C=0;w.arrOutSideTop.length>
C;C++)z=w.arrOutSideTop[C],z=g(z),h.top=e(h.top,e(z.bottom,D,!0,"top"),E,"top"),E=!1;m.top=f(h.top);A=v[y-1];for(C=0;C<A.length;C++)E=A[C].cell,z=g(E),0==C?DEXTTOP.DEXT5.util.objectExtend(h,{bottom:z.bottom}):h.bottom=e(h.bottom,z.bottom,null,"bottom"),1==E.rowSpan&&(h.middle=1<y?e(h.middle,e(z.top,g(v[y-2][C].cell).bottom,!0,"middle"),null,"middle"):e(h.middle,z.top,null,"middle"));B=h.bottom;if(w&&"undefined"!=typeof w.arrOutSideBottom&&u)for(E=!0,C=0;w.arrOutSideBottom.length>C;C++)A=w.arrOutSideBottom[C],
z=g(A),h.bottom=e(h.bottom,e(z.top,B,!0,"bottom"),E,"bottom"),E=!1;m.bottom=f(h.bottom);for(C=0;C<v.length;C++)E=v[C],z=g(E[0].cell),B=g(E[x-1].cell),0==C?(DEXTTOP.DEXT5.util.objectExtend(h,{left:z.left,right:B.right}),E[0].cell!=E[x-1].cell&&(h.center=e(z.right,g(E[1].cell).left,!0,"center"),h.center=e(h.center,e(B.left,g(E[x-2].cell).right,!0,"center"),null,"center"))):(h.left=e(h.left,z.left,null,"left"),h.right=e(h.right,B.right,null,"right"),E[0].cell!=E[x-1].cell&&(h.center=e(h.center,e(z.right,
g(E[1].cell).left,!0,"center"),null,"center"),h.center=e(h.center,e(B.left,g(E[x-2].cell).right,!0,"center"),null,"center")));D=h.left;A=h.right;if(w&&"undefined"!=typeof w.arrOutSideLeft&&u)for(E=!0,C=0;w.arrOutSideLeft.length>C;C++)B=w.arrOutSideLeft[C],z=g(B),h.left=e(h.left,e(z.right,D,!0,"left"),E,"left"),E=!1;if(w&&"undefined"!=typeof w.arrOutSideRight&&u)for(E=!0,C=0;w.arrOutSideRight.length>C;C++)D=w.arrOutSideRight[C],z=g(D),h.right=e(h.right,e(z.left,A,!0,"right"),E,"right"),E=!1;m.left=
f(h.left);m.right=f(h.right);for(C=0;C<v.length;C++)if(0!=C&&C!=y-1)for(E=!0,u=0;u<v[C].length;u++)w=v[C][u].cell,1==w.rowSpan&&(z=g(w),h.middle=e(h.middle,e(z.top,g(v[C-1][u].cell).bottom,!0,"middle"),null,"middle"),h.middle=e(h.middle,e(z.bottom,g(v[C+1][u].cell).top,!0,"middle"),null,"middle"));m.middle=f(h.middle);for(C=0;C<v.length;C++)for(E=!0,u=0;u<v[C].length;u++)0!=u&&u!=x-1&&(w=v[C][u].cell,1==w.colSpan&&(z=g(w),h.center=e(h.center,e(z.left,g(v[C][u-1].cell).right,!0,"center"),null,"center"),
h.center=e(h.center,e(z.right,g(v[C][u+1].cell).left,!0,"center"),null,"center")));m.center=f(h.center)}m.multiSelection=q;m.sameAttr={total:b,outside:c,inside:d};h="top right bottom left middle center".split(" ");q=m[h[0]];C=!1;for(C=1;6>C;C++)if(y=m[h[C]])if(q!=y){C=!0;m.isDifferent=C;break}else q=y;a&&(m.tableBorder=t.style.border);if("1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal){a={diagonalUpBorder:"",diagonalDownBorder:"",notAllUp:!1,notAllDown:!1};for(C=0;C<v.length;C++)for(u=
0;u<v[C].length;u++)t=findDiagonal(v[C][u].cell,!0),null!=t?(0<t.diagonalUp.length?(z=g(t.diagonalUp[0],"top"),a.diagonalUpBorder=""==a.diagonalUpBorder?z.top:e(a.diagonalUpBorder,z.top,null,"diagonalUp")):a.notAllUp=!0,0<t.diagonalDown.length?(z=g(t.diagonalDown[0],"top"),a.diagonalDownBorder=""==a.diagonalDownBorder?z.top:e(a.diagonalDownBorder,z.top,null,"diagonalDown")):a.notAllDown=!0):(a.notAllUp=!0,a.notAllDown=!0);a.diagonalUpBorder=""!=a.diagonalUpBorder?f(a.diagonalUpBorder):"";a.diagonalDownBorder=
""!=a.diagonalDownBorder?f(a.diagonalDownBorder):"";m.diagonalInfo=a}return m}function adjustTableBeforePaste(a,b){if("1"==a._config.tableAutoAdjustInPaste){var c=b.tables,d=b.html;if(c)for(var d=c.length,e=0;e<d;e++)c[e].setAttribute("data-de-adjust","1");else if(d)return d=d.replace(/<table/g,'<table data-de-adjust="1"')}}
function adjustTableAfterPaste(a){if("1"==a._config.tableAutoAdjustInPaste){var b=[];if(_iframeDoc.querySelectorAll)b=_iframeDoc.querySelectorAll("table[data-de-adjust]");else for(var c=_iframeDoc.getElementsByTagName("table"),d=c.length,e=0;e<d;e++){var f=c[e],g=f.getAttribute("data-de-adjust");"string"==typeof g&&"1"==g&&b.push(f)}c=b.length;if(0<c)for(command_AdjustTableAndCellWidth(a,{tables:b}),e=0;e<c;e++)f=b[e],f.removeAttribute("data-de-adjust")}}
function isTableOutOfRange(a,b,c){var d,e;window.getComputedStyle?(d=window.getComputedStyle(a._BODY,null),e=window.getComputedStyle(b,null)):b.currentStyle?(d=a._BODY.currentStyle,e=b.currentStyle):(d=a._BODY.style,e=b.style);var f={};window.getComputedStyle?(f.bPaddingLeft=d.getPropertyValue("padding-left"),f.bMarginLeft=d.getPropertyValue("margin-left"),f.bPaddingRight=d.getPropertyValue("padding-right"),f.bMarginRight=d.getPropertyValue("margin-right"),f.tMarginLeft=e.getPropertyValue("margin-left")):
(f.bPaddingLeft=d.paddingLeft,f.bMarginLeft=d.marginLeft,f.bPaddinRight=d.paddingRight,f.bMarginRight=d.marginRight,f.tMarginLeft=e.marginLeft);for(var g in f)f.hasOwnProperty(g)&&(f[g]=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.util.replacePtOrCmToPx(f[g])));d={};e=""!=a._BODY.style.width;DEXTTOP.DEXT5.browser.ie?(a=e?a._BODY.offsetWidth:a._BODY.clientWidth+f.bPaddingLeft+f.bPaddingRight+f.bMarginLeft+f.bMarginRight,b=b.clientWidth+f.bMarginLeft+f.tMarginLeft):(a=e?a._BODY.offsetWidth:a._BODY.parentElement?
a._BODY.parentElement.clientWidth:a._BODY.clientWidth,b=b.clientWidth+f.tMarginLeft+f.bPaddingLeft+f.bMarginLeft);d.result=a<b;d.newCellWidthFlag=!1;!d.result&&a>=b+c&&(d.newCellWidthFlag=!0);return d}
function repairCaretNearTable(){var a=null;try{var b=getFirstRange().range;if(1==b.collapsed){var c=-1,d=null,e=b.startContainer;if(1==e.nodeType){var f=e.tagName.toLowerCase();if(-1<",body,div,td,th,".indexOf(","+f+",")){var g=b.startOffset,h=e.childNodes[g];if(h&&"TABLE"==h.tagName)if(d=h,0==g)c=0;else{var m=e.childNodes[g-1];if(m)c=0;else{var q=e.childNodes[g+1];q&&(c=1)}}else(m=e.childNodes[g-1])&&"TABLE"==m.tagName?(d=m,c=1):q&&"TABLE"==q.tagName&&(d=q,c=0)}else"table"==f&&(c=0,d=e);if(d){b=
null;if(0==c)b=d.rows[0].cells[0];else if(1==c)var t=d.rows[d.rows.length-1],b=t.cells[t.cells.length-1];b&&(a=getMyFirstOrLastChildElementNode(b,!1),setTimeout(function(){setFocusChildForStyle(a)},0))}}}}catch(u){a=null}return a};function setTopMenu(a,b,c,d){DEXTTOP.G_CURREDITOR=b;DEXT5_TOPMENU.show(a,b.ID,c,d)}function hideTopMenu(){DEXT5_TOPMENU.hide()}function hideTopMenuAndFocus(){DEXT5_TOPMENU.hide_focus()}
var DEXT5_TOPMENU={_editor:null,_topmenu_id:"",_topmenu_iframe:null,_topmenu_zIndex:0,_topmenu_bg_zIndex:0,_topmenu_document:null,_topmenu_main:null,_topmenu_sub:null,_topmenu_bg:null,_topmenu_bg_id:"",_top_menu_click_id:"",_item_position:{},_width:"",_height:"0",_item_sub_list:{entity:["insert_link_media","iframe_create","flash_create","media_create","video"],align:["align_left","align_center","align_right","align_full"],insert_row:["insert_row_up","insert_row_down"],insert_column:["insert_column_left",
"insert_column_right"],table_select:["table_select_cell","table_select_all","","table_select_row","table_select_column"],cell_size:["table_same_width","table_same_height","table_same_widthheight"],align_vertical:["valign_up","valign_center","valign_baseline","valign_bottom"],table_tool:["table_adjust","convert_table_to_text"],list_number:"list_decimal list_decimal_leading_zero list_lower_alpha list_lower_greek list_lower_roman list_upper_alpha list_upper_roman".split(" "),list_bullets:["list_disc",
"list_circle","list_square"],table_copy_paste:"table_copy  intable_paste table_content_paste table_content_paste_to_text table_content_paste_with_format".split(" "),table_row_column:"table_row_clone  insert_row_column insert_row_up insert_row_down insert_column_left insert_column_right  insert_table_top_paragraph insert_table_bottom_paragraph".split(" "),delete_table_and_row_column:["table_delete","delete_row","delete_column"],table_row_column_cell_property:["table_property","cell_property","row_property",
"column_property"],calculation_formula:"horizontal_sum horizontal_avg horizontal_mul horizontal_sub horizontal_div  vertical_sum vertical_avg vertical_mul vertical_sub vertical_div".split(" "),cell_size:["table_same_width","table_same_height","table_same_widthheight"]},_non_image_item:" design source preview text entity align insert_row insert_column table_select cell_size align_vertical table_tool list_number list_bullets".split(" "),_disabeld_menu:[],_create:function(a){var b=DEXTTOP.G_CURREDITOR;
a&&""!=a&&(b=DEXTTOP.DEXT5.util._setDEXT5editor(a))&&(DEXTTOP.G_CURREDITOR=b);this._editor=b;for(var c in this._item_sub_list){for(var b=this._item_sub_list[c],d=b.length-1;0<=d;d--)""==b[d]?d==b.length-1?b.splice(d,1):0==d?(""==b[d+1]&&b.splice(d+1,1),b.splice(d,1)):""!=b[d-1]&&""!=b[d+1]||b.splice(d,1):-1<this._editor.remove_item.indexOf(b[d])&&b.splice(d,1);0==b.length&&this._editor.remove_item.push(c)}(a=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_iframe"+a))&&a.parentNode.removeChild(a);this._topmenu_id=
"dext_topmenu_iframe"+this._editor._config.editor_id;this._topmenu_bg_id="dext_topmenu_background"+this._editor._config.editor_id;this._topmenu_zIndex=G_MAIN_ZINDEX+2E3;this._topmenu_bg_zIndex=G_MAIN_ZINDEX+1E3;if(a=DEXTTOP.DEXTDOC.getElementById(this._topmenu_id))_topmenu_document=a.contentWindow.document,this._topmenu_iframe=a,this._topmenu_document=_topmenu_document,this._topmenu_main=_topmenu_document.getElementById("div_topmenu_main"),this._topmenu_sub=_topmenu_document.getElementById("div_topmenu_sub");
else{try{a=DEXTTOP.DEXTDOC.createElement("<iframe>")}catch(e){a=DEXTTOP.DEXTDOC.createElement("iframe")}DEXTTOP.DEXTDOC.body.appendChild(a);a.id=this._topmenu_id;a.title="DEXT5Editor Topmenu "+this._editor._config.editor_id;a.style.margin="0px";a.style.padding="0px";a.style.zIndex=this._topmenu_zIndex;a.style.position="absolute";a.scrolling="no";a.style.overflow="auto";a.style.overflowX="hidden";a.style.display="none";a.allowTransparency="true";a.frameBorder="0";c="document.open();"+(isCustomDomain(document)?
'document.domain="'+document.domain+'";':"")+" document.close();";c=DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?"javascript:void(function(){"+encodeURIComponent(c)+"}())":"";a.src=c;c="";c=DEXTTOP.DEXT5.isRelease?this._editor._config.webPath.css:this._editor._config.webPath.css_dev;b="editor_context.css";"ko-kr"!=this._editor._config.lang&&(b="editor_context_"+this._editor._config.lang+".css");d=this._editor._config.lang;-1<d.indexOf("-")&&(d=d.split("-")[0]);var f="";isRTL(document)&&
(f=' dir="rtl"');d=""+('<html lang="'+d+'" xml:lang="'+d+'"'+f+"><head>")+("<title>DEXT5Editor Topmenu "+this._editor._config.editor_id+"</title>");isCustomDomain(document)&&(d+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');d+='<link rel="stylesheet" type="text/css" href="'+c+b+"?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">';"1"==this._editor._config.customCssUrlDetailApply&&(d+='<link rel="stylesheet" type="text/css" href="'+this._editor._config.style.customCssUrl+"?t="+
DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">');d+='<link rel="stylesheet" type="text/css" href="'+c+"editor_"+this._editor._config.style.iconName+".css?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">';isRTL(document)&&(d+='<link rel="stylesheet" type="text/css" href="'+c+"editor_context_rtl.css?t="+DEXTTOP.DEXT5.UrlStamp+'" charset="utf-8">');d+='</head><body scroll="no" style="overflow-x:hidden; overflow-y:hidden; margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">';
d+='<div onselectstart="return false;" style="width:100%; height:100%" id="topmenu_iframe_bg">';d+='<div class="DEXT_fiVe_ED_popup">';d+='<div class="DEXT_fiVe_EDP">';d+='<div class="Dfe_popup DEXT_fiVe_'+this._editor._config.style.skinName+'">';d+='<dl id="div_topmenu_main"></dl>';d+="</div>";d+="</div>";d+='<div class="DEXT_fiVe_EDP_s" id="topmenu_sub" style="display:none; position:relative;">';d+='<div class="Dfe_popup DEXT_fiVe_'+this._editor._config.style.skinName+'">';d+='<dl id="div_topmenu_sub"></dl>';
d+="</div>";d+="</div>";d+="</div>";d+="</div>";d+="</body></html>";_topmenu_document=a.contentWindow.document;_topmenu_document.open("text/html","replace");_topmenu_document.write(d);_topmenu_document.close();this._topmenu_iframe=a;this._topmenu_document=_topmenu_document;this._topmenu_main=_topmenu_document.getElementById("div_topmenu_main");this._topmenu_sub=_topmenu_document.getElementById("div_topmenu_sub");DEXTTOP.DEXT5.util.addEvent(_topmenu_document,"dragover",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);
return!1});DEXTTOP.DEXT5.util.addEvent(_topmenu_document,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1});this.setTopMenuEvents()}this._topmenu_main.innerHTML="";this._topmenu_sub.innerHTML=""},_setMenu:function(a){var b=[];switch(a){case "m_file":var b="new file_open  template layout  save save_as save_as_image manually_temp_save load_auto_save  print pagebreak".split(" "),c=290;-1<this._editor.remove_item.indexOf("save_as")&&(c-=30);"0"==this._editor._config.setAutoSave.useManuallySave&&
(b.splice(b.indexOf("manually_temp_save"),1),c-=30);this._height=c+"px";this._width="200px";break;case "m_edit":b="undo redo  copy text_copy cut paste  select_all  find replace".split(" ");this._height="230px";this._width="200px";break;case "m_view":b="grid ruler body_fit full_screen  design source preview text".split(" ");this._height="190px";this._width="200px";break;case "m_insert":b="doc_bg_image image_create entity  insert_file hyperlink_create bookmark  detail_horizontal_line symbol emoticon".split(" ");
this._height="300px";this._width="400px";break;case "m_form":b="bold italic underline strike_through superscript subscript  remove_format remove_css  list_number list_bullets  indent outdent  align".split(" ");this._height="420px";this._width="400px";break;case "m_table":b="detail_table_insert table_selection  table_indent table_outdent  merge_cell split_cell  table_tool table_copy_paste table_row_column delete_table_and_row_column table_row_column_cell_property  table_select cell_size align_vertical  calculation_formula".split(" ");
this._height="585px";this._width="400px";0>=GetTableSelectionCells().length?(c=getFirstRange().range.startContainer,3==c.nodeType&&(c=c.parentNode),c=GetParentbyTagName(c,"table"),null!=c&&(0>=parseIntOr0(c.style.marginLeft)?0>this._disabeld_menu.indexOf("table_outdent")&&this._disabeld_menu.push("table_outdent"):this._disabeld_menu.splice(this._disabeld_menu.indexOf("table_outdent"),1))):this._disabeld_menu.push("table_outdent");break;case "m_tool":b=["clean_nested_tag","","tool_replace","","setting"];
this._height="80px";this._width="200px";break;case "m_help":b=["shortcut","","help","","about"];this._height="80px";this._width="200px";break;default:this._height=this._width="1px"}if("m_file"==a){void 0==getAutoSaveHtml_userID(this._editor.ID,this._editor._config.setAutoSave.unique_key,this._editor._config.setAutoSave.maxCount)||""==getAutoSaveHtml_userID(this._editor.ID,this._editor._config.setAutoSave.unique_key,this._editor._config.setAutoSave.maxCount)?this._disabeld_menu.push("load_auto_save"):
-1<this._disabeld_menu.indexOf("load_auto_save")&&(this._disabeld_menu=this._disabeld_menu.slice(this._disabeld_menu.indexOf("load_auto_save"),1));var c=null,d=!1;_iframeWin.getSelection?(c=_iframeWin.getSelection())&&c.rangeCount&&c.getRangeAt&&(c=c.getRangeAt(0)):_iframeDoc.selection&&(c=_iframeDoc.selection.createRange());try{var e=null,e=c?c:getFirstRange().rng;if(e.startContainer!=e.endContainer||e.startOffset!=e.endOffset)d=!0}catch(f){d=!1}d?null!=DEXTTOP.G_SELECTED_ELEMENT&&"img"==DEXTTOP.G_SELECTED_ELEMENT.tagName.toLowerCase()||
this._disabeld_menu.push("save_as_image"):this._disabeld_menu.push("save_as_image")}for(var g in G_DEPlugin)G_DEPlugin[g].onShowTopMenu&&(c=G_DEPlugin[g].onShowTopMenu(a,b))&&(b=c);for(a=0;a<b.length;a++)0==a&&(g=this._topmenu_document.createElement("dt"),g.innerHTML="top_main_menu",this._topmenu_main.appendChild(g)),this._addItem(b[a]);this._disableItem(this._disabeld_menu)},_disableItem:function(a){for(var b=0;b<a.length;b++){var c=this._topmenu_document.getElementById("topmenu_"+a[b]);c&&(c.className=
"item_disabled")}},_addItem:function(a){for(r=0;r<this._editor.remove_item.length;r++)if(this._editor.remove_item[r]==a)return;var b=this._topmenu_document.createElement("dd"),c=this,d=this._getImageIconUrl(a),e=this._getText(a),f=this._item_sub_list[a];if(""==e)b.className="b_border";else{var g=this._topmenu_document.createElement("div"),h=this._topmenu_document.createElement("div"),m=this._topmenu_document.createElement("div"),q=this._topmenu_document.createElement("span");0<d.length&&(q.className=
a,g.appendChild(q),0==a.indexOf("p_")&&(q.style.background="url("+d+") transparent no-repeat"));g.className="s_left";h.className="s_right ellipsis";var t=this._topmenu_document.createElement("a");t.href="javascript:void(0);";t.title=e;t.style.textDecoration="none";t.style.color="#545454";t.style.cursor="pointer";t.innerHTML=e;h.appendChild(t);b.appendChild(g);b.appendChild(h);if(f)m.className="arrow",b.appendChild(m),e=function(a){return function(b){if("item_disabled"!=a.className){c._topmenu_sub.innerHTML=
"";for(var d=0;d<f.length;d++){if(0==d){var e=c._topmenu_document.createElement("dt");e.innerHTML="top_sub_menu";c._topmenu_sub.appendChild(e)}c._addSubItem(f[d])}c._disableItem(c._disabeld_menu);d=getClientRect(a);0==d.top&&(d=getClientRect(a));c._topmenu_document.getElementById("topmenu_sub").style.display="";c._topmenu_document.getElementById("topmenu_sub").style.top=d.top-0+"px";a.className="on_mouseover";DEXTTOP.DEXT5.util.stopEvent(b);changePosForCovered({popupNode:c._topmenu_document.getElementById("topmenu_sub"),
checkNode:c._topmenu_document.getElementById("topmenu_sub")})}}}(b),d=function(a,b){return function(d){c.setFocusOutline(b,!0);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(d))}}(b,t),g=function(a){return function(b){"on_mouseover"==a.className&&DEXTTOP.DEXT5.util.stopEvent(b)}}(b),DEXTTOP.DEXT5.util.addEvent(b,"mouseover",e),DEXTTOP.DEXT5.util.addEvent(b,"mouseout",d),DEXTTOP.DEXT5.util.addEvent(b,"click",g),e=function(a,b){return function(d){c.setFocusOutline(b);if("item_disabled"!=
a.className){c._topmenu_sub.innerHTML="";for(var e=0;e<f.length;e++)c._addSubItem(f[e],b);var e=d.target?d.target:d.srcElement,g=getClientRect(e);0==g.top&&(g=getClientRect(e));c._topmenu_document.getElementById("topmenu_sub").style.display="";c._topmenu_document.getElementById("topmenu_sub").style.top=g.top-0+"px";a.className="on_mouseover";DEXTTOP.DEXT5.util.stopEvent(d);d=function(a){return function(a){if(39==("which"in a?a.which:a.keyCode)){var b=c._topmenu_document.getElementById("topmenu_sub").getElementsByTagName("A").length,
d=c._topmenu_document.getElementById("topmenu_sub").getElementsByTagName("A")[0],b=c._topmenu_document.getElementById("topmenu_sub").getElementsByTagName("A")[b-1];d.focus();setFocusFirstAndLast(_topmenu_document,d,b);DEXTTOP.DEXT5.util.stopEvent(a)}}}(b);DEXTTOP.DEXT5.util.addEvent(b,"keyup",d)}}}(b,t),DEXTTOP.DEXT5.util.addEvent(t,"focus",e),DEXTTOP.DEXT5.util.addEvent(t,"blur",d);else{var e=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(t,"focus",u);DEXTTOP.DEXT5.util.removeEvent(t,
"blur",v);c._topmenu_document.getElementById("topmenu_sub").style.display="none";"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),d=function(a,b){return function(c){DEXTTOP.DEXT5.util.addEvent(b,"focus",u);DEXTTOP.DEXT5.util.addEvent(b,"blur",v);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(c))}}(b,t),u=function(a,b){return function(d){c.setFocusOutline(b);c._topmenu_document.getElementById("topmenu_sub").style.display="none";
"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(d))}}(b,t),v=function(a,b){return function(d){c.setFocusOutline(b,!0);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(d))}}(b,t),c=this,g=function(b){return function(d){"on_mouseover"==b.className&&(c.hide_focus(c._editor.ID),c._editor._dextCommands(c._editor.ID,a,c),DEXTTOP.DEXT5.util.stopEvent(d))}}(b);DEXTTOP.DEXT5.util.addEvent(b,"mouseover",e);DEXTTOP.DEXT5.util.addEvent(b,"mouseout",
d);DEXTTOP.DEXT5.util.addEvent(b,"click",g);DEXTTOP.DEXT5.util.addEvent(t,"focus",u);DEXTTOP.DEXT5.util.addEvent(t,"blur",v)}}0<a.length&&(b.id="topmenu_"+a);b.unselectable="on";this._topmenu_main.appendChild(b)},_addSubItem:function(a,b){for(r=0;r<this._editor.remove_item.length;r++)if(this._editor.remove_item[r]==a)return;var c=this._topmenu_document.createElement("dd"),d=this,e=this._getImageIconUrl(a),f=this._getText(a);if(""==f)c.className="b_border";else{var g=this._topmenu_document.createElement("div"),
h=this._topmenu_document.createElement("div"),m=this._topmenu_document.createElement("span"),q=this._topmenu_document.createElement("a");q.href="javascript:void(0);";q.title=f;q.style.textDecoration="none";q.style.color="#545454";q.style.cursor="pointer";0<e.length&&(m.className=a,g.appendChild(m),0==a.indexOf("p_")&&(m.style.background="url("+e+") transparent no-repeat"));g.className="s_left";h.className="s_right ellipsis";q.innerHTML=f;h.appendChild(q);c.appendChild(g);c.appendChild(h);var e=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(q,
"focus",t);DEXTTOP.DEXT5.util.removeEvent(q,"blur",u);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(c),f=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(q,"focus",t);DEXTTOP.DEXT5.util.removeEvent(q,"blur",u);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(c),t=function(a,b){return function(c){d.setFocusOutline(b);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(c))}}(c,
q),u=function(a){return function(b){d.setFocusOutline(q,!0);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(c),d=this,g=function(b){return function(c){"on_mouseover"==b.className&&(d.hide_focus(d._editor.ID),d._editor._dextCommands(d._editor.ID,a))}}(c);DEXTTOP.DEXT5.util.addEvent(c,"mouseenter",e);DEXTTOP.DEXT5.util.addEvent(c,"mouseleave",f);DEXTTOP.DEXT5.util.addEvent(c,"click",g);DEXTTOP.DEXT5.util.addEvent(q,"focus",t);DEXTTOP.DEXT5.util.addEvent(q,"blur",u);e=
function(a){return function(a){37==("which"in a?a.which:a.keyCode)&&(b.focus(),DEXTTOP.DEXT5.util.stopEvent(a))}}(q);DEXTTOP.DEXT5.util.addEvent(q,"keyup",e);0<a.length&&(c.id="topmenu_"+a);c.unselectable="on";this._topmenu_sub.appendChild(c)}this._topmenu_sub.appendChild(c)},_getImageIconUrl:function(a){var b="";if(0==a.indexOf("p_")){var b=a.split("_"),c=b[1],d="icon";2<b.length&&(d=b[2]);b=this._editor._config.webPath.plugin+c+"/images/"+d+".png"}else b=this._editor._config.webPath.image+this._editor._config.style.iconName+
"/"+a+".gif";for(c=0;c<this._non_image_item.length;c++)if(a==this._non_image_item[c]){b="";break}return b},_getText:function(a){var b="";""!=a&&(0==a.indexOf("p_")?(b=a.split("_")[1],b=dext5_lang.plugins[b].topmenu[a]):b=dext5_lang.topmenu[a]);return b},show:function(a,b,c,d){if(this._top_menu_click_id!=c){this._top_menu_click_id=c;this.setHoverClass(c);this.setTopMenuItemPosition();null==this._topmenu_iframe&&this._create();this._topmenu_main.innerHTML="";this._topmenu_sub.innerHTML="";this._setMenu(c);
this._topmenu_iframe.style.width=this._width;this._topmenu_iframe.style.height=this._height;a=a?a:window.event;Math.round(a.clientX);Math.round(a.clientY);c={};c=getWindowScrollPos(DEXTTOP.DEXTWIN);d=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);var e=getClientRect(a.target?a.target:a.srcElement);isFixedEditorPosition({editor:this._editor})&&(this._topmenu_iframe.style.position="fixed",c[0]=0,c[1]=0);var f=e.left+c[0]+d.left,g=e.top+c[1]+d.top+19;isRTL(document)&&
(f=DEXTTOP.DEXT5.util.parseIntOr0(this._topmenu_iframe.style.width),f=e.right+c[0]+d.left-f);this._topmenu_iframe.style.left=f+"px";this._topmenu_iframe.style.top=g+"px";this._makeBackground(b);this._topmenu_iframe.style.display="";this._topmenu_bg.style.display="";changePosForCovered({popupNode:this._topmenu_iframe,checkNode:this._topmenu_iframe.contentDocument.getElementById("div_topmenu_main").parentNode.parentNode});var h=this._topmenu_iframe.contentWindow;c=getIframeDocument(this._topmenu_iframe);
0==DEXTTOP.DEXT5.browser.ie&&h.focus();c.body.focus();try{c.getElementsByTagName("A")[0].focus()}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}c.onkeyup=function(a){var b=0;a=a||h.event;b="which"in a?a.which:a.keyCode;27==b&&(hideTopMenu(),setTimeout(function(){setFocusToBody()},1))};setFocusFirstAndLast(c,c.getElementsByTagName("A")[0]);setZoomValueToBody(c,this._editor);try{"function"==typeof this._editor._config.event.afterPopupShow?this._editor._config.event.afterPopupShow(b,
a.target,"topmenu"):"function"==typeof DEXTTOP.dext_editor_afterpopupshow_event&&DEXTTOP.dext_editor_afterpopupshow_event(b,a.target,"topmenu")}catch(q){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}},hide:function(a){this._topmenu_document&&this._topmenu_document.getElementById("topmenu_sub")&&(this._topmenu_document.getElementById("topmenu_sub").style.display="none");this._topmenu_iframe&&(this._topmenu_iframe.style.display="none");this._topmenu_bg&&(this._topmenu_bg.style.display="none");
this._top_menu_click_id="";this.setHoverClass("")},hide_focus:function(a){this._topmenu_document&&this._topmenu_document.getElementById("topmenu_sub")&&(this._topmenu_document.getElementById("topmenu_sub").style.display="none");this._topmenu_iframe&&(this._topmenu_iframe.style.display="none");this._topmenu_bg&&(this._topmenu_bg.style.display="none");this._top_menu_click_id="";this.setHoverClass("");this._editor.isCloseTopMenu=!0;dialogCancel()},_makeBackground:function(a){var b=this;if(this._topmenu_bg=
DEXTTOP.DEXTDOC.getElementById(b._topmenu_bg_id))DEXTTOP.DEXTDOC.body.removeChild(this._topmenu_bg),this._topmenu_bg=null;if(!this._topmenu_bg){this._topmenu_bg=DEXTTOP.DEXTDOC.createElement("div");this._topmenu_bg.style.display="none";this._topmenu_bg.id=this._topmenu_bg_id;this._topmenu_bg.style.overflow="visible";this._topmenu_bg.style.position="static";this._topmenu_bg.innerHTML='<div oncontextmenu="return false" style="filter:alpha(opacity=0); opacity:0.0; -moz-opacity:0.0; -khtml-opacity: 0.0; background-color:#000000; z-index:'+
this._topmenu_bg_zIndex+'; position:absolute; left:0px; top:0px;overflow:hidden; "></div>';var c="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth,d="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight,c=changeValueForZoom(c,this._editor),d=changeValueForZoom(d,this._editor);this._topmenu_bg.firstChild.style.width=c-10+"px";this._topmenu_bg.firstChild.style.height=
d-10+"px";DEXTTOP.DEXTDOC.body.appendChild(this._topmenu_bg);c=function(){return function(c){b.hide_focus(a)}}();DEXTTOP.DEXT5.util.addEvent(this._topmenu_bg,"click",c);DEXTTOP.DEXT5.util.addEvent(this._topmenu_bg,"contextmenu",c);DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTWIN,"resize",this._editor.topmenu_bg_resize);DEXTTOP.DEXT5.util.addEvent(this._topmenu_document.getElementById("topmenu_iframe_bg"),"click",c);DEXTTOP.DEXT5.util.addEvent(this._topmenu_document.getElementById("topmenu_iframe_bg"),
"contextmenu",c);this._topmenu_bg.style.display="none";DEXTTOP.DEXT5.util.addEvent(this._topmenu_bg,"mousemove",function(a){a=b.getItemInCurrPosition(a);""!=a&&a!=b._top_menu_click_id&&(b._topmenu_bg.style.display="none",setTimeout(function(){""==b._topmenu_iframe.style.display&&(b._topmenu_bg.style.display="")},10))})}},setFocusOutline:function(a,b){var c="border";0==DEXTTOP.DEXT5.browser.ie&&(c="outline");a.style[c]=b?"":"1px dotted #B5B7BB"},setTopMenuEvents:function(){for(var a=this,b=null,c=
"",d=0,e=a._editor._config.topMenuItem.length;d<e;d++)if(c=DEXTTOP.DEXT5.util.trim(a._editor._config.topMenuItem[d]).toLowerCase(),b=document.getElementById("ue_"+a._editor.ID+c)){switch(b){case "design":case "source":case "preview":case "text":"textContent"in b?b.textContent=dext5_lang.top_menu[c]:b.innerText=dext5_lang.top_menu[c]}var f=function(b){return function(c){DEXTTOP.DEXT5.util.stopEvent(c);"design"==a._editor._currentMode&&(b==a._top_menu_click_id?hideTopMenuAndFocus():setTopMenu(c,a._editor,
b,a._editor._config))}}(c),c=function(b){return function(c){b!=a._top_menu_click_id&&""==a._topmenu_iframe.style.display&&setTopMenu(c,a._editor,b,a._editor._config)}}(c);DEXTTOP.DEXT5.util.addEvent(b,"click",f);DEXTTOP.DEXT5.util.addEvent(b,"mouseover",c)}},setHoverClass:function(a){for(var b=0,c=this._editor._config.topMenuItem.length;b<c;b++){var d=DEXTTOP.DEXT5.util.trim(this._editor._config.topMenuItem[b]).toLowerCase();document.getElementById("ue_"+this._editor.ID+d).childNodes[0].className=
d==a?"on":""}},setTopMenuItemPosition:function(){var a=this._editor._config.topMenuItem.length;if(0<a)for(var b=0;b<a;b++){var c=this._editor._config.topMenuItem[b],c=DEXTTOP.DEXT5.util.trim(c).toLowerCase(),d=_iframeWin.parent.document.getElementById("ue_"+this._editor.ID+c);if(d){var d=d.getBoundingClientRect(),e=getClientRect(_iframeWin.parent.frameElement),f={};f.x=e.left+d.left;f.y=e.top+d.top;f.xx=e.left+d.right;f.yy=e.top+d.bottom;this._item_position[c]=f}}},getItemInCurrPosition:function(a){var b=
"",c=a.clientX;a=a.clientY;c=changeValueForZoom(c,this._editor);a=changeValueForZoom(a,this._editor);for(p in this._item_position){var d=this._item_position[p];if(point_in_rectagnle(c,a,d.x,d.y,d.xx,d.yy)){b=p;break}}return b}};function point_in_rectagnle(a,b,c,d,e,f){var g=!1,h=function(a,b,c){var d=!1;a<c&&b>a&&b<c&&(d=!0);a>c&&b>c&&b<a&&(d=!0);if(b==a||b==c)d=!0;return d};h(c,a,e)&&h(d,b,f)&&(g=!0);return g};var ImageHTML=function(a,b){this.htmlSource=a;this.range=b},UndoManager=function(){this.arrImageHTML=[];this.limitCount=50;this.currentImage=null;this.index=-1;this.canRedo=this.canUndo=!1;this.charCount=0;this.isInsertData=!1;this.tempRange=this.tempEContainer=this.tempSContainer=null};
UndoManager.prototype={reset:function(){this.arrImageHTML=[];this.limitCount=50;this.currentImage=null;this.index=-1;this.canRedo=this.canUndo=!1;this.charCount=0;1==_iframeDoc.body.contentEditable&&DEXTTOP.G_CURREDITOR._iconEnable("");DEXTTOP.G_CURREDITOR.isInitKeydownForSetApi=!0;this.isInsertData=!1;this.tempRange=this.tempEContainerText=this.tempSContainerText=null},putUndo:function(a){try{if(1!=DEXTTOP.G_CURREDITOR.disableUndoRedo){var b=null,c=null,d=null,e=null,f={};a="object"==typeof a?a:
{};var g=!0===a.overwriteToLast,h=!0===a.isInit,m=DEXTTOP.G_CURREDITOR._config.undoMode;if("2"==m)if(h&&0==DEXTTOP.G_CURREDITOR._config.initFocus||DEXTTOP.DEXT5.browser.ie&&DEXTTOP.G_CURREDITOR.notFocusToEditor){var q=getMyFirstOrLastChildElementNode(DEXTTOP.G_CURREDITOR._BODY),e=_iframeDoc.createElement("dextmark");e.id="_dext_caret";q.firstChild?q.insertBefore(e,q.firstChild):q.appendChild(e)}else b=getFirstRange().range,1!=b.collapsed||9!=b.startContainer.nodeType&&!h||(setFocusChildForStyle(DEXTTOP.G_CURREDITOR._BODY.firstChild),
b=getFirstRange().range),c=getFirstRange().sel,b.cloneRange(),e=_iframeDoc.createElement("dextmark"),e.id="_dext_caret",b.collapse(!1),b.insertNode(e);else(b=getFirstRange().range)&&b.startContainer&&(d=getMyElementNode(b.startContainer)),d&&(f.id=d.id,f.undoId="_dext",d.id=f.id+f.undoId);var t=_iframeDoc.body.innerHTML,t=dummyTagClassClear(t);if("2"==m)e.parentNode.removeChild(e),c&&(b=!1,DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion&&"0"!=DEXTTOP.G_CURREDITOR._config.autoUrlDetect&&
(b=!0),b&&_iframeDoc.execCommand("AutoUrlDetect",!1,!1),b&&_iframeDoc.execCommand("AutoUrlDetect",!0,!0));else if(d)if(""==f.id)try{d.removeAttribute("id")}catch(u){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else d.id=f.id;var v="BackCompat"==_iframeDoc.compatMode;DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&11>DEXTTOP.DEXT5.browser.ieVersion&&1!=v&&(t=DEXTTOP.DEXT5.util.nbspRemove(t));t=ReplaceAll(t,unescape("%uFEFF"),"");t=ReplaceAll(t,unescape("%u200B"),"");if(DEXTTOP.DEXT5.browser.ie&&
8>=DEXTTOP.DEXT5.browser.ieVersion||v)try{var w=t.match(RegExp("<td *([^>?+])*>","gi"));if(w){for(var y=w.length,v=0;v<y;v++){var x=w[v],z=/cellOrgBgColor=>/.exec(x);if(null!=z)var B=z[0].replace(RegExp("cellOrgBgColor=>","g"),">"),x=x.replace(z,B),t=t.replace(w[v],x)}for(v=0;v<y;v++)if(x=w[v],z=/cellOrgBgColor= /.exec(x))B=z[0].replace(RegExp("cellOrgBgColor= ","g"),""),x=x.replace(z,B),t=t.replace(w[v],x)}}catch(D){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(!this.currentImage||
this.currentImage.htmlSource.replace(/<dextmark(\s|\S)*?<\/dextmark>/gi,"")!=t.replace(/<dextmark(\s|\S)*?<\/dextmark>/gi,"")){"2"==m&&(this.isInsertData=!1,this.tempRange=this.tempEContainerText=this.tempSContainerText=null);var A=new ImageHTML(t,f);if("2"==m)for(var C=this.arrImageHTML.length-1;C>=this.index+1;C--)this.arrImageHTML.pop();else for(C=this.index+1;C<this.arrImageHTML.length;C++)this.arrImageHTML.pop();this.arrImageHTML.length==this.limitCount&&this.arrImageHTML.shift();g?(this.arrImageHTML.splice(this.arrImageHTML.length-
1,1,A),this.index=this.arrImageHTML.length-1):this.index=this.arrImageHTML.push(A)-1;this.currentImage=A;this.canUndo=0<this.arrImageHTML.length?!0:!1;this.index==this.arrImageHTML.length-1&&(this.canRedo=!1);if("2"==m){if(this.charCount=99,h&&(this.canUndo=!1),1<this.arrImageHTML.length){f="";try{var E=GetTableSelectionCells();0<E.length&&(f=1==E.length?"selectedSingleCell":"selectedMultiCell")}catch(H){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{var M=DEXTTOP.G_CURREDITOR.dext_dragresize;
M&&M.G_dextResizeDiv&&M.G_dextResize_elem&&(f="IMG"==M.G_dextResize_elem.tagName?"focusImage":"dextResize")}catch(N){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}""!=f&&DEXTTOP.G_CURREDITOR._iconEnable(f)}}else this.charCount=0}}}catch(I){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},execUndo:function(){try{if(!DEXTTOP.G_CURREDITOR.disableUndoRedo)if(G_LAST_CMD="undo",0==this.canUndo)DEXTTOP.G_CURREDITOR._iconEnable("");else{G_AddOrRemovedNodesObserver.removeObserver();var a=
DEXTTOP.G_CURREDITOR._config.undoMode;"2"==a&&1==this.isInsertData&&this.putUndo();--this.index;if(-1==this.index)if("2"==a)1==this.arrImageHTML.length&&(this.index=0);else{this.canRedo=this.canUndo=!1;DEXTTOP.G_CURREDITOR._iconEnable("");return}var b=this.arrImageHTML[this.index].htmlSource;if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion){for(var c="span strong em strike sup sub b i".split(" "),d=c.length,e=0;e<d;e++)var f="(<p[^>]*><"+c[e]+"[^>]*>)(?:\\s|  | |)(</"+c[e]+"></p>)",
g=new RegExp(f,"gim"),b=b.replace(g,"$1"+unescape("%u200B")+"</"+c[e]+"></p>");f="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>";g=new RegExp(f,"gim");b=b.replace(g,"$1</span>")}c="";c=DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?unescape("%u200B"):unescape("%uFEFF");g=RegExp("<a ([^>]+)></a>","gi");b=b.replace(g,"<a $1>"+c+"</a>");if(!this.currentImage||this.currentImage.htmlSource.replace(/<dextmark(\s|\S)*?<\/dextmark>/gi,"")!=b.replace(/<dextmark(\s|\S)*?<\/dextmark>/gi,
"")){_iframeDoc.body.innerHTML=b;try{"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal&&findDiagonal(_iframeDoc.body)&&(G_DEXT_Diagonal.setResizeForDiagonal(),G_DEXT_Diagonal.util.replaceEmptySpaceInDiagonal())}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var m=this.arrImageHTML[this.index].range,q=m.id+m.undoId,b=null;if("2"==DEXTTOP.G_CURREDITOR._config.undoMode){if(b=_iframeDoc.getElementById("_dext_caret")){var t=getFirstRange().range,u=getFirstRange().sel;t.setStartAfter(b);
t.setEndAfter(b);DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&preventScrollMove(!0);u.removeAllRanges();u.addRange(t);DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&preventScrollMove(!1);b.parentNode.removeChild(b);DEXTTOP.G_CURREDITOR._LastRange=t}}else if(b=_iframeDoc.getElementById(q)){b.id==m.undoId?removeAttribute(b,"id"):b.id=m.id;var v=getFirstRange();try{(b.nodeType=b.lastChild&&b.lastChild.tagName&&"br"==b.lastChild.tagName.toLowerCase())?doSetCaretPosition(b,
0):(rangy.getSelection(_iframeWin).removeAllRanges(),v.range.selectNodeContents(b),v.range.collapse(!1),rangy.getSelection(_iframeWin).setSingleRange(v.range)),setMenuIconRealable(b)}catch(w){try{var y=_iframeDoc.body.childNodes,x=y.length;0<x&&(doSetCaretPosition(y[x-1],0),setMenuIconRealable(y[x-1]))}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}this.currentImage=new ImageHTML(_iframeDoc.body.innerHTML,m);this.canRedo=!0;0==this.index&&(this.canUndo=!1);this.charCount="2"==
a?99:0;DEXTTOP.G_CURREDITOR._iconEnableForTextInRange();ClearDraggingTableAllTable();G_AddOrRemovedNodesObserver.addMutationObserver();try{contentChangeEventWrapper()}catch(B){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{for(var D in G_DEPlugin)if("function"===typeof G_DEPlugin[D].onAfterUndo)G_DEPlugin[D].onAfterUndo({})}catch(A){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}}catch(C){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},execRedo:function(){try{if(!DEXTTOP.G_CURREDITOR.disableUndoRedo)if(G_LAST_CMD=
"redo",0==this.canRedo)DEXTTOP.G_CURREDITOR._iconEnable("");else{G_AddOrRemovedNodesObserver.removeObserver();this.index+=1;var a=DEXTTOP.G_CURREDITOR._config.undoMode,b=null;"2"==a&&1==this.arrImageHTML.length&&(this.index=0);b=this.arrImageHTML[this.index].htmlSource;if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion){for(var c="span strong em strike sup sub b i".split(" "),d=c.length,e=0;e<d;e++)var f="(<p[^>]*><"+c[e]+"[^>]*>)(?:\\s|  | |)(</"+c[e]+"></p>)",g=new RegExp(f,"gim"),
b=b.replace(g,"$1"+unescape("%u200B")+"</"+c[e]+"></p>");f="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>";g=new RegExp(f,"gim");b=b.replace(g,"$1</span>")}c="";c=DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?unescape("%u200B"):unescape("%uFEFF");g=RegExp("<a ([^>]+)></a>","gi");b=b.replace(g,"<a $1>"+c+"</a>");if(!this.currentImage||this.currentImage.htmlSource.replace(/<dextmark(\s|\S)*?<\/dextmark>/gi,"")!=b.replace(/<dextmark(\s|\S)*?<\/dextmark>/gi,
"")){_iframeDoc.body.innerHTML=b;try{"1"==DEXTTOP.G_CURREDITOR._config.diagonal.use&&G_DEXT_Diagonal&&findDiagonal(_iframeDoc.body)&&(G_DEXT_Diagonal.setResizeForDiagonal(),G_DEXT_Diagonal.util.replaceEmptySpaceInDiagonal())}catch(h){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}var m=this.arrImageHTML[this.index].range,q=m.id+m.undoId,b=null;if("2"==a){if(b=_iframeDoc.getElementById("_dext_caret")){var t=getFirstRange().range,u=getFirstRange().sel;t.setStartAfter(b);t.setEndAfter(b);DEXTTOP.DEXT5.browser.ie&&
7>=DEXTTOP.DEXT5.browser.ieVersion&&preventScrollMove(!0);u.removeAllRanges();u.addRange(t);DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&preventScrollMove(!1);b.parentNode.removeChild(b);DEXTTOP.G_CURREDITOR._LastRange=t}}else if(b=_iframeDoc.getElementById(q)){b.id==m.undoId?removeAttribute(b,"id"):b.id=m.id;var v=getFirstRange();try{rangy.getSelection(_iframeWin).removeAllRanges(),v.range.selectNodeContents(b),v.range.collapse(!1),rangy.getSelection(_iframeWin).setSingleRange(v.range),
setMenuIconRealable(b)}catch(w){try{var y=_iframeDoc.body.childNodes,x=y.length;0<x&&(doSetCaretPosition(y[x-1],1),setMenuIconRealable(y[x-1]))}catch(z){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}this.currentImage=new ImageHTML(_iframeDoc.body.innerHTML,m);this.canUndo=!0;this.index==this.arrImageHTML.length-1&&(this.canRedo=!1);this.charCount="2"==a?99:0;DEXTTOP.G_CURREDITOR._iconEnableForTextInRange();ClearDraggingTableAllTable();G_AddOrRemovedNodesObserver.addMutationObserver();
try{contentChangeEventWrapper()}catch(B){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{for(var D in G_DEPlugin)if("function"===typeof G_DEPlugin[D].onAfterRedo)G_DEPlugin[D].onAfterRedo({})}catch(A){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}}catch(C){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},clearNextImgData:function(){for(var a=this.arrImageHTML.length-1;a>=this.index+1;a--)this.arrImageHTML.pop();this.arrImageHTML.length==this.limitCount&&this.arrImageHTML.shift();
this.canUndo=0<this.arrImageHTML.length?!0:!1;this.index==this.arrImageHTML.length-1&&(this.canRedo=!1);this.charCount=99}};resizebar_props={editor:null,editorMinTop:0,editorHegiht:0,mouseTop:0,editorMinFlag:!1,mouseClickFlag:!1,mouseClickObj:null,mouseLeftBtnFlag:!1};function DextResize(a){resizebar_props&&(resizebar_props.editor=a,resizebar_props.editorMinTop=parseInt(a._config.style.defaultMinHeight))}
DextResize.prototype.createStatusResizeBar=function(){if(resizebar_props){if(0==checkIfIncluded("editor_resize_bar.css",DEXTTOP.DEXTDOC)){var a=DEXTTOP.DEXTDOC.createElement("link");a.type="text/css";a.rel="stylesheet";a.href=DEXTTOP.DEXT5.isRelease?resizebar_props.editor._config.webPath.css+"editor_resize_bar.css?t="+DEXTTOP.DEXT5.UrlStamp:resizebar_props.editor._config.webPath.css_dev+"editor_resize_bar.css?t="+DEXTTOP.DEXT5.UrlStamp;DEXTTOP.DEXTDOC.getElementsByTagName("head")[0].appendChild(a)}a=
DEXTTOP.DEXTDOC.getElementById(resizebar_props.editor._config.holderID);a.className="DEXT_frame_resizebar";var b=DEXTTOP.DEXTDOC.createElement("div");b.setAttribute("id","dext_resizebar_"+resizebar_props.editor.ID);b.className="DEXT_resizebar DEXT_resizebar_"+resizebar_props.editor._config.style.skinName;b.innerHTML='<div class="DEXT_resizebar_btn" id="dext_resizebar_btn_'+resizebar_props.editor.ID+'"><div class="DEXT_resizebar_horizon_line" id="DEXT_resizebar_horizon_line_'+resizebar_props.editor.ID+
'"></div><button type="button" id="DEXT_resizebar_button_'+resizebar_props.editor.ID+'" title="'+dext5_lang.resizebar_button.title+'"></button></div>';a.appendChild(b)}};function dextResizeMouseDownEvt(a){try{DextResize.prototype.mouseDown(a)}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function dextResizeMouseMoveEvt(a){try{DextResize.prototype.mouseMove(a)}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
function dextResizeMouseUpEvt(a){try{DextResize.prototype.mouseUp(a)}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}function dextResizeBlurEvt(a){try{DextResize.prototype.blur(a)}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}
DextResize.prototype.mouseDown=function(a){try{if(resizebar_props)if(DEXTTOP.DEXTDOC.getElementById(resizebar_props.editor._config.holderID)){a=a?a:event;var b=a.target?a.target:a.srcElement,c=this.isLeftClick(a);resizebar_props.mouseLeftBtnFlag=c;resizebar_props.mouseLeftBtnFlag&&(b&&b.id&&b.id=="dext_resizebar_"+resizebar_props.editor.ID?resizebar_props.mouseClickObj=b:b&&b.id&&b.id=="dext_resizebar_btn_"+resizebar_props.editor.ID?resizebar_props.mouseClickObj=b.parentNode:b&&b.id&&(b.id=="DEXT_resizebar_horizon_line_"+
resizebar_props.editor.ID||b.id=="DEXT_resizebar_button_"+resizebar_props.editor.ID)&&(resizebar_props.mouseClickObj=b.parentNode.parentNode));resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&(resizebar_props.editorHegiht=parseInt(DEXTTOP.DEXTDOC.getElementById(resizebar_props.editor._config.holderID).style.height.replace("px","")),resizebar_props.mouseTop=a.clientY,resizebar_props.mouseClickFlag=!0)}else resizebar_props=
null}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};
DextResize.prototype.mouseMove=function(a){try{if(resizebar_props&&(a=a?a:event,resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&resizebar_props.mouseClickFlag)){DEXTTOP.DEXTDOC.body.style.cursor="row-resize";if(!DEXTTOP.DEXTDOC.getElementById("dext_disabled")){var b=DEXTTOP.DEXTDOC.createElement("div");b.setAttribute("id","dext_disabled");b.style.overflow="visible";b.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:'+
(G_MAIN_ZINDEX+1E3)+'; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';var c="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight;b.firstChild.style.width=("CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth)+"px";b.firstChild.style.height=c+"px";DEXTTOP.DEXTDOC.body.appendChild(b)}var b=0,d=a.clientY,b=resizebar_props.editorHegiht+
(d-resizebar_props.mouseTop),b=Math.max(resizebar_props.editorMinTop,b);resizebar_props.editorMinFlag=b==resizebar_props.editorMinTop?!0:!1;resizebar_props.editorMinFlag||(this.setHeight(b),G_BodyFit.widthFixStatus&&(setBodyFitStyle(resizebar_props.editor,!0),setAutoBodyFit(resizebar_props.editor)),resizebar_props.editorHegiht=b,resizebar_props.mouseTop=d)}}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};
DextResize.prototype.mouseUp=function(a){try{if(resizebar_props)if(a=a?a:event,DEXTTOP.DEXTDOC.body.style.cursor="",resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)){var b=0,b=resizebar_props.editorHegiht+(a.clientY-resizebar_props.mouseTop),b=Math.max(resizebar_props.editorMinTop,b);resizebar_props.editorMinFlag=b==resizebar_props.editorMinTop?!0:!1;resizebar_props.editorMinFlag||(this.setHeight(b),G_BodyFit.widthFixStatus&&
(setBodyFitStyle(resizebar_props.editor,!0),setAutoBodyFit(resizebar_props.editor)));resizebar_props.editorHegiht=0;resizebar_props.mouseTop=0;resizebar_props.editorMinFlag=!1;resizebar_props.mouseClickFlag=!1;resizebar_props.mouseClickObj=null;resizebar_props.mouseLeftBtnFlag=!1;if(DEXTTOP.DEXTDOC.getElementById("dext_disabled")){var c=DEXTTOP.DEXTDOC.getElementById("dext_disabled");c.parentNode.removeChild(c)}try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.resized?DEXTTOP.G_CURREDITOR._config.event.resized(DEXTTOP.G_CURREDITOR.Frame):
"function"===typeof DEXTTOP.DEXTWIN.dext_editor_resized_event&&DEXTTOP.DEXTWIN.dext_editor_resized_event(DEXTTOP.G_CURREDITOR.Frame)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}else resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&(resizebar_props.editorHegiht=0,resizebar_props.mouseTop=0,resizebar_props.editorMinFlag=!1,resizebar_props.mouseClickFlag=!1,resizebar_props.mouseClickObj=null,resizebar_props.mouseLeftBtnFlag=
!1,DEXTTOP.DEXTDOC.getElementById("dext_disabled")&&(c=DEXTTOP.DEXTDOC.getElementById("dext_disabled"),c.parentNode.removeChild(c)))}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};
DextResize.prototype.wheel=function(a){try{if(resizebar_props&&(a=a?a:event,resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)))return a.returnValue=!1,a.preventDefault&&a.preventDefault(),!1}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};
DextResize.prototype.blur=function(a){try{if(resizebar_props&&resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&DEXTTOP.DEXTDOC.getElementById("dext_disabled")){var b=DEXTTOP.DEXTDOC.getElementById("dext_disabled");b.parentNode.removeChild(b)}}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};
DextResize.prototype.setHeight=function(a){var b=resizebar_props.editor.ID,c=DEXTTOP.DEXT5.util._setDEXT5editor(b);if(void 0==b||""==b)b=c.ID;var d=DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+b),e=null;"1"==c._config.resizeBarHolderSync&&(e=d.parentNode);var b=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+b).contentWindow.document.getElementById("ue_editor_holder_"+b),f=0,f=c.baseMenuToolbarHeight;isViewMode(c)?c._defaultHeight=parseInt(a,10)-4:c._defaultHeight=parseInt(a,10)-f;-1<a.toString().indexOf("%")||
-1<a.toString().indexOf("px")?(d.style.height=a,e&&(e.style.height=a)):(d.style.height=a+"px",e&&(e.style.height=a+"px"));b.style.height=c._defaultHeight+"px";c._config.style.height=a+"px";"1"==resizebar_props.editor._config.ruler.view&&"design"==resizebar_props.editor._currentMode&&G_Ruler.SetRulerPosition();"1"==resizebar_props.editor._config.autoBodyFit&&(a=parseIntOr0(resizebar_props.editor._config.defaultBodySpace.configValue.top)+parseIntOr0(resizebar_props.editor._config.defaultBodySpace.configValue.bottom),
c._BODY.style.minHeight=(c._defaultHeight-a)/c._defaultHeight*100+"%")};DextResize.prototype.isLeftClick=function(a){var b=!1;a=a||window.event;a.which||void 0===a.button||(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);switch(a.which){case 1:b=!0;break;case 2:b=!1;break;case 3:b=!1;break;case 0:0==a.button&&(b=!1)}return b};
DextResize.prototype.apply=function(a){try{resizebar_props&&(DextResizeObj=this,DEXTTOP.DEXT5.util.addEvent(a,"mousedown",dextResizeMouseDownEvt,!0),DEXTTOP.DEXT5.util.addEvent(a,"mousemove",dextResizeMouseMoveEvt,!0),DEXTTOP.DEXT5.util.addEvent(a,"mouseup",dextResizeMouseUpEvt,!0),a.addEventListener&&(domMouseScrollEvent=function(a){DextResizeObj.wheel(a)},a.addEventListener("DOMMouseScroll",domMouseScrollEvent,!1),DEXTTOP.DEXT5.DEXTMULTIPLEEVENT[DEXTTOP.G_CURREDITOR.ID].push({element:a,event:"DOMMouseScroll",
func:domMouseScrollEvent})),DEXTTOP.DEXT5.util.addEvent(a,"blur",dextResizeBlurEvt,!0))}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};
DextResize.prototype.remove=function(a){try{DEXTTOP.DEXT5.util.removeEvent(a,"mousedown",dextResizeMouseDownEvt,!0),DEXTTOP.DEXT5.util.removeEvent(a,"mousemove",dextResizeMouseMoveEvt,!0),DEXTTOP.DEXT5.util.removeEvent(a,"mouseup",dextResizeMouseUpEvt,!0),DEXTTOP.DEXT5.util.removeEvent(a,"blur",dextResizeBlurEvt,!0)}catch(b){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};(function(){function a(a){var b={};a=a.split(",");for(var c=0;c<a.length;c++)b[a[c]]=!0;return b}var b=a("p,ul,ol,li,a,img,i,b,u,sup,sub,table,caption,col,colgroup,thead,tbody,tfoot,tr,td,th,br"),c=["background","backgroundColor","word-break","word-wrap"],d=a("col");DEXT5_EDITOR.HWPFilter=function(b,c){function d(a,b,e,q){b=b.toLowerCase();if(y[b]){for("table"!=E.last()&&"tbody"!=E.last()||"td"!=b||d("","tr","","");E.last()&&x[E.last()];)h("",E.last());"p"!=E.last()||"table"!=b&&"hr"!=b&&"center"!=
b||h("","p")}z[b]&&E.last()==b&&h("",b);(q=w[b]||!!q)||E.push(b);if(c.start){var u=[];a=m.test(a)?t:v;e.replace(a,function(a,b,c,d,e){c=c?c:d?d:e?e:B[b]?b:"";d="";""!=a&&(a=a.substring(a.indexOf(b)+b.length),a=a.substring(a.indexOf("=")+1),a=a.replace(/^\s+/,""),d=a.substring(0,1),"'"!=d&&'"'!=d&&(d=""));u.push({name:b,value:c,escaped:c.replace(/(^|[^\\])"/g,'$1\\"'),quotationmark:d})});c.start&&c.start(b,u,q)}}function h(a,b){if(b)for(b=b.toLowerCase(),d=E.length-1;0<=d&&E[d]!=b;d--);else var d=
0;if(0<=d){for(var e=E.length-1;e>=d;e--)c.end&&c.end(E[e]);E.length=d}}var m=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,q=/^<\/([-A-Za-z0-9_:]+)[^>]*>/,t=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,u=/^<([-A-Za-z0-9_:-]+)((?:\s+[a-zA-Z_0-9:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,v=/([-A-Za-z0-9_:-]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,w=a("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed");
a("area,base,basefont,br,col,frame,img,input,isindex,link,meta,param,embed");var y=a("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul,h1,h2,h3,h4,h5,h6"),x=a("colgroup,a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),
z=a("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),B=a("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),D=a(""),A,C,E=[],H=b;E.last=function(){return this[this.length-1]};for(b=b.replace(RegExp("<div( ?([^>?+])*>(\\s+)?(&nbsp;)+(\\s+)?)</ ?div>","gi"),"<p$1</p>");b;){C=!0;if(E.last()&&D[E.last()])b=b.replace(new RegExp("(.*)</"+E.last()+"[^>]*>"),function(a,b){b=b.replace(/\x3c!--(.*?)--\x3e/g,"$1").replace(/<!\[CDATA\[(.*?)]]\x3e/g,"$1");
c.chars&&c.chars(b);return""}),h("",E.last());else{var M=b.indexOf("<");A=b.indexOf(">")+1;var N=b.substring(M,A);if(0==b.indexOf("\x3c!--"))A=b.indexOf("--\x3e"),0<=A&&(c.comment&&c.comment(b.substring(4,A)),b=b.substring(A+3),C=!1);else if(0==b.indexOf("<?xml"))A=b.indexOf("/>"),0<=A&&(b=b.substring(A+2),C=!1);else if(0!=b.indexOf("<")&&"</"+E.last()+">"==N.replace(/ /ig,""))C=b.substring(0,M),A=b.substring(A),b=C+"</"+E.last()+">"+A,C=!0;else if(0==b.indexOf("</")){if(A=b.match(q))b=b.substring(A[0].length),
A[0].replace(q,h),C=!1}else if(0==b.indexOf("<"))if(A=b.match(m))b=b.substring(A[0].length),A[0].replace(m,d),C=!1;else if(A=b.match(u))b=b.substring(A[0].length),A[0].replace(u,d),C=!1;else if("1"==DEXTTOP.G_CURREDITOR._config.removeIncorrectAttribute&&(A=b.indexOf("<"),N=b.indexOf(">"),0==A&&0<N)){var I=b.substring(0,N+1),S=M=A=0;0<I.indexOf('\ub9d1\uc740=""')?(A=I.indexOf('\ub9d1\uc740=""'),M=5,S=I.split('\ub9d1\uc740=""').length):0<I.indexOf("\ub9d1\uc740=''")&&(A=I.indexOf("\ub9d1\uc740=''"),
M=5,S=I.split("\ub9d1\uc740=''").length);if(2==S&&0<A&&(N=b.substring(N+1),S=I.substring(0,A).lastIndexOf(" "),S<A+M))if(A=I.substring(S,A+M),I=I.replace(A,""),b=I+N,A=b.match(m))b=b.substring(A[0].length),A[0].replace(m,d),C=!1;else if(A=b.match(u))b=b.substring(A[0].length),A[0].replace(u,d),C=!1}C&&(A=b.indexOf("<"),C=0>A?b:b.substring(0,A),b=0>A?"":b.substring(A),c.chars&&(E.last()&&x[E.last()]&&"textarea"!=E.last()&&"script"!=E.last()&&(A=!1,M=RegExp("\\S\\n","g"),M.test(C)&&(A=!0),M=RegExp("\\n\\S",
"g"),M.test(C)&&(A=!0),M=RegExp("\\S\\n\\S","g"),M.test(C)&&(A=!0),A?C=C.replace(/\n/g," "):(M=RegExp("\\n\\n","g"),M.test(C)&&""==C.trim()?C=C.replace(/\n\n/g,""):C==unescape("%20%20")&&(A=new RegExp(unescape("%20"),"g"),C=C.replace(A,"&nbsp;")))),c.chars(C)))}if(b==H)throw"Parse Error: "+b;H=b}h()};DEXT5_EDITOR.HWPFilter.DOMProcess=function(b,d,g){d=b;try{var h=function(a){try{if(a.style.cssText){var b=a.style.margin,b=b.split(" "),c=b.length,d="";4==c?d="margin-top: "+b[0]+"; margin-right: "+b[1]+
"; margin-bottom: "+b[2]+"; margin-left: "+b[3]+";":2==c?d="margin-top: "+b[0]+"; margin-right: "+b[1]+"; margin-bottom: "+b[0]+"; margin-left: "+b[1]+";":3==c&&(d="margin-top: "+b[0]+"; margin-right: "+b[1]+"; margin-bottom: "+b[2]+"; margin-left: "+b[1]+";");if(""!=d){a.style.margin="";var e=a.style.cssText;a.removeAttribute("style");a.setAttribute("style",d+" "+e)}}}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},m=function(a,b){try{var c=DEXTTOP.DEXT5.util.getStyle(a,b);if(c&&
""!=c){var d="",e=!1,f=parseFloat(c)+"";c==f&&(e=!0);if(-1<c.indexOf("px"))d=t(c);else if(-1<c.indexOf("pt"))var g=parseFloat(c),d=t(4*g/3);else if(-1<c.indexOf("em")||-1<c.indexOf("%")||e){var g=parseFloat(c),h=DEXTTOP.DEXT5.util.getStyle(a,"fontSize");h&&""!=h&&(-1<h.indexOf("px")?(g*=parseFloat(h),d=t(g)):-1<h.indexOf("pt")&&(g*=4*parseFloat(h)/3,d=t(g)))}""!=d&&(a.style[b]=d)}}catch(m){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},q=function(a,b){var c=DEXTTOP.DEXT5.util.getStyle(a,
b);""==c&&(c=a.style[b]);""!=c&&(c=DEXTTOP.DEXT5.util.parseIntOr0(c),0<c&&a.setAttribute(b,c))},t=function(a){var b=!1,c;c=a+"";c=c.replace(/^\s*|\s*$/g,"");c=""==c||isNaN(c)?!1:!0;c?b=!0:-1<a.indexOf("px")&&(a=parseInt(a),b=!0);b&&(a=.264583*a+"mm");return a},u=function(a){""!=a.align&&-1==",left,center,right,justify,char,".indexOf(","+a.align.toLowerCase()+",")&&(a.align="");""!=a.vAlign&&-1==",top,middle,bottom,baseline,".indexOf(","+a.vAlign.toLowerCase()+",")&&(a.vAlign="")},v=function(a){for(var b=
[],c=a.length>>>0;c--;)b[c]=a[c];return b},w=function(a){var b=[],c=0;a=a.attributes;for(var d=a.length;c<d;c++)b.push(a[c].nodeName);return b},y=document.createElement("div");try{y.style.visibility=!1}catch(x){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}y.style.position="absolute";y.style.top="0px";y.style.left="-2000px";y.innerHTML=d;document.body.appendChild(y);for(var z=y.getElementsByTagName("br"),B={},D=-1,A=z.length-1;0<=A;A--){var C=z[A],E=C.parentNode;if("P"==E.tagName)if(1==
E.childNodes.length)E.removeChild(C);else{var H=E.outerHTML,M=H.match(/<p( (.*?))?>/);if(M){H=M[1];if("string"!=typeof B["de_br"+D])D++,B["de_br"+D]=H;else{var N=!1;B["de_br"+D]==H&&(N=!0);0==N&&(D++,B["de_br"+D]=H)}C.setAttribute("de_br",D)}}else E.removeChild(C)}if(0<=D){for(var I=y.innerHTML,A=0;A<=D;A++){var z='de_br="'+A+'"',S="</p><p "+B["de_br"+A]+">",F=new RegExp("<br "+z+">","gi");I.match(F)||(F=new RegExp("<br .*?"+z+".*?>","gi"));I=I.replace(F,S)}I=I.replace(/<p><\/p>/g,"<p>&nbsp;</p>");
I=I.replace(/<p ([^>]+)><\/p>/g,"<p $1>&nbsp;</p>");y.innerHTML=I}for(var I="p ul ol li table caption col colgroup thead tfoot tbody tr th td a img i b u sub sup ".split(" "),A=j=ba=0,O=I.length,P,J,L,K,W,G,Q,X;A<O;A++)for(P=y.getElementsByTagName(I[A]),j=0,K=P.length;j<K;j++){J=P[j];L=w(J);switch(I[A]){case "p":""!=J.style.textAlign&&(Q=",left,center,right,",X=-1==Q.indexOf(","+J.style.textAlign.toLowerCase()+",")?"":J.style.textAlign,J.style.textAlign="",J.align=X);""==J.align&&removeAttribute(J,
"align");removeAttribute(J,"id");G=a("id,style,align");m(J,"lineHeight");m(J,"marginLeft");m(J,"marginRight");m(J,"marginTop");m(J,"marginBottom");h(J);break;case "ul":case "ol":if(0==J.getElementsByTagName("li").length){var ea=v(J.childNodes),V=document.createElement("li");J.appendChild(V);for(var S=0,aa=ea.length;S<aa;S++)V.appendChild(ea[S])}G=a("id");break;case "a":G=a("id,name,href,rel,rev");break;case "img":""!=J.align&&(Q=",top,middle,bottom,left,right,",-1==Q.indexOf(","+J.align.toLowerCase()+
",")&&(J.align=""));q(J,"width");q(J,"height");""==J.src?J.src="noImage":0==!!g.keepImgUrl&&(J.src.indexOf("/")?J.src=J.src.substring(J.src.lastIndexOf("/")+1):J.src.indexOf("\\")&&(J.src=J.src.substring(J.src.lastIndexOf("\\")+1)));""==J.alt&&(J.alt=""!=J.title?J.title:"untitled");G=a("id,src,alt,name,longdesc,height,width,align,border,hspace,vspace");break;case "table":""!=J.align&&(Q=",left,center,right,adjust,",-1==Q.indexOf(","+J.align.toLowerCase()+",")&&(J.align=""));""==J.border&&J.setAttribute("border",
J.style.borderWidth.replace("px",""));J.border&&""!=J.border&&isNaN(J.border)&&J.setAttribute("border","1");q(J,"width");q(J,"height");G=a("id,summary,width,height,border,cellspacing,cellpadding,align");break;case "caption":""!=J.align&&(Q=",top,bottom,left,right,",-1==Q.indexOf(","+J.align.toLowerCase()+",")&&(J.align=""));G=a("id,align");break;case "colgroup":case "col":u(J);G=a("id,span,width,align,char,charoff,valign");break;case "thead":case "tfoot":case "tbody":case "tr":u(J);G=a("id,align,char,charoff,valign");
break;case "th":case "td":u(J);q(J,"width");q(J,"height");G=a("id,abbr,axis,headers,rowspan,colspan,align,char,charoff,nowrap,width,height");break;case "i":case "b":case "u":case "sub":case "sup":case "li":G=a("id");break;default:G=a("id")}ba=0;for(W=L.length;ba<W;ba++)G[L[ba].toLowerCase()]||removeAttribute(J,L[ba]);for(var ga=c.length,ba=0;ba<ga;ba++)DEXTTOP.DEXT5.util.removeStyleAttribute(J,c[ba])}d=DEXTTOP.DEXT5.util.html2xhtml(y.innerHTML);y.parentNode.removeChild(y);try{var fa=!1,ca=!1;d=d.replace(/ width=['\"](\d+)['\"]/ig,
function(a,b){fa=!0;return' width="'+t(b)+'"'});d=d.replace(/ height=['\"](\d+)['\"]/ig,function(a,b){ca=!0;return' height="'+t(b)+'"'});0==fa&&(d=d.replace(/ width=(\d+)/ig,function(a,b){return' width="'+t(b)+'"'}));0==ca&&(d=d.replace(/ height=(\d+)/ig,function(a,b){return' height="'+t(b)+'"'}))}catch(ta){d=b}}catch(da){y.parentNode.removeChild(y),d=b}return d};DEXT5_EDITOR.HWPFilter.HTMLtoXML=function(a,c,g){var h="",m=a,q=a.toLowerCase().indexOf("<body"),t=a.toLowerCase().lastIndexOf("</body>");
-1<q&&-1<t&&(a=a.substring(q+1,t),q=a.indexOf(">"),a=a.substring(q+1));a=DEXT5_EDITOR.HWPFilter.HtmlToDomProcess(a);if("undefined"!=typeof c)try{var u=_iframeDoc.getElementById(c);if(u)a=u.innerHTML;else{var v=_iframeDoc.createElement("div");v.style.display="none";v.innerHTML=a;_iframeDoc.body.appendChild(v);if(u=_iframeDoc.getElementById(c))a=u.innerHTML;v.innerHTML="";_iframeDoc.body.removeChild(v);try{delete null}catch(w){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}m=a}catch(y){a=
m}try{a=a.replace(/<italic/gi,"<i"),a=a.replace(/<\/italic>/gi,"</i>"),a=a.replace(/<underline/gi,"<u"),a=a.replace(/<\/underline>/gi,"</u>"),a=a.replace(/<strong/gi,"<b"),m=a=a.replace(/<\/strong>/gi,"</b>"),DEXT5_EDITOR.HWPFilter(a,{start:function(a,c,d){if(b[a]){h+="<"+a;for(a=0;a<c.length;a++)h="href"==c[a].name||"src"==c[a].name?h+(" "+c[a].name+"="+c[a].quotationmark+c[a].value+c[a].quotationmark):""!=c[a].quotationmark?h+(" "+c[a].name+"="+c[a].quotationmark+c[a].value+c[a].quotationmark):
h+(" "+c[a].name+'="'+c[a].escaped+'"');h+=(d?"/":"")+">"}},end:function(a){b[a]&&!d[a]&&(h+="</"+a+">")},chars:function(a){h+=a},comment:function(a){h+=""}}),m=a}catch(x){h=m}return h=DEXT5_EDITOR.HWPFilter.DOMProcess(h,c,g)};DEXT5_EDITOR.HWPFilter.HtmlToDomProcess=function(a){var b=a,c=!1;document.createTreeWalker&&(c=!0);if(c){var d=document.createElement("div");d.style.display="none";d.innerHTML=a;document.body.appendChild(d);a=d.getElementsByTagName("p");for(var b=a.length,m=0;m<b;m++)if(c)for(var q=
a[m],t=void 0,u=document.createTreeWalker(q,NodeFilter.SHOW_TEXT,null,!1);t=u.nextNode();){var v=t.nodeValue,v=v.replace(/\n/g,""),v=v.replace(/\t/g,"");if(""!=v&&(t=t.parentNode)&&t.tagName&&"p"!=t.tagName.toLowerCase()){for(var v=["fontFamily","fontSize"],w=v.length,y=0,x=0;x<w;x++){var z=DEXTTOP.DEXT5.util.getStyle(t,v[x]);z&&(q.style[v[x]]=z,y++)}if(0<y)break}}b=d.innerHTML;d.parentNode.removeChild(d)}return b}})();var g_d5selectedCName="DEXT_selected_basic",g_d5selectedFocusCName="DEXT_selected_nofocus";
function setFormControlSelected(a){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var b=["INPUT","TEXTAREA","SELECT","BUTTON"],c=b.length,d=!1;if(a&&1==a.nodeType)for(var e=0;e<c;e++)if(a.tagName==b[e]){d=!0;break}if(0==d)clearAllFormControlSelected();else{rangy.getSelection(_iframeWin).removeAllRanges();for(var f=[],g=_iframeDoc.body,e=0;e<c;e++)for(var h=g.getElementsByTagName(b[e]),m=h.length,q=0;q<m;q++)h[q].className!=g_d5selectedCName&&h[q].className!=g_d5selectedFocusCName||a==h[q]||f.push(h[q]);
if(d)if(a.className==g_d5selectedCName)d5RemoveSelectedClassName(a,g_d5selectedCName);else if(a.className==g_d5selectedFocusCName)d5RemoveSelectedClassName(a,g_d5selectedFocusCName),0<f.length&&(f[0].className=g_d5selectedFocusCName);else for(d5AddSelectedClassName(a,g_d5selectedFocusCName),a=f.length,e=0;e<a;e++)d5RemoveSelectedClassName(f[e],g_d5selectedFocusCName),d5AddSelectedClassName(f[e],g_d5selectedCName)}}}
function getFormControlSelectedItem(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){for(var a={count:0,arrNodes:[]},b=["INPUT","TEXTAREA","SELECT","BUTTON"],c=b.length,d=_iframeDoc.body,e=0;e<c;e++)for(var f=d.getElementsByTagName(b[e]),g=f.length,h=0;h<g;h++)if(f[h].className==g_d5selectedCName||f[h].className==g_d5selectedFocusCName)a.count+=1,a.arrNodes.push(f[h]);return a}}
function clearAllFormControlSelected(a){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var b=_iframeDoc;a&&(b=a);a=["INPUT","TEXTAREA","SELECT","BUTTON"];for(var c=a.length,b=b.body,d=0;d<c;d++)for(var e=b.getElementsByTagName(a[d]),f=e.length,g=0;g<f;g++)if(e[g].className==g_d5selectedCName||e[g].className==g_d5selectedFocusCName)d5RemoveSelectedClassName(e[g],g_d5selectedCName),d5RemoveSelectedClassName(e[g],g_d5selectedFocusCName)}}
function d5AddSelectedClassName(a,b){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var c=a.className,d="";if(0<c.length){for(var c=c.split(" "),e=c.length,f=0;f<e;f++)b!=c[f]&&(d+=c[f]+" ");d+=b}else d=b;a.className=d}}function d5RemoveSelectedClassName(a,b){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var c=a.className,d="";if(0<c.length)for(var c=c.split(" "),e=c.length,f=0;f<e;f++)c[f]!=b&&(d=f<e-1?d+(c[f]+" "):d+c[f]);else d="";a.className=d}}
function d5ApplyAlignLeft(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var a=getFormControlSelectedItem();if(!(1>=a.count)){for(var b=null,c=0;c<a.count;c++)if(a.arrNodes[c].className==g_d5selectedFocusCName){b=a.arrNodes[c];break}if(b)for(c=0;c<a.count;c++)a.arrNodes[c]!=b&&(a.arrNodes[c].style.left=getClientRect(b).left+"px")}}}
function d5ApplySameWidth(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var a=getFormControlSelectedItem();if(!(1>=a.count)){for(var b=null,c=0;c<a.count;c++)if(a.arrNodes[c].className==g_d5selectedFocusCName){b=a.arrNodes[c];break}if(b)for(b=""==b.style.width?getClientRect(b).right-getClientRect(b).left+"px":b.style.width,c=0;c<a.count;c++)a.arrNodes[c].style.width=b}}}
function d5ApplySameHeight(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var a=getFormControlSelectedItem();if(!(1>=a.count)){for(var b=null,c=0;c<a.count;c++)if(a.arrNodes[c].className==g_d5selectedFocusCName){b=a.arrNodes[c];break}if(b)for(b=""==b.style.height?getClientRect(b).bottom-getClientRect(b).top+"px":b.style.height,c=0;c<a.count;c++)a.arrNodes[c].style.height=b}}}
function d5ApplySameWidthHeight(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var a=getFormControlSelectedItem();if(!(1>=a.count)){for(var b=null,c=0;c<a.count;c++)if(a.arrNodes[c].className==g_d5selectedFocusCName){b=a.arrNodes[c];break}if(b)for(var d=""==b.style.width?getClientRect(b).right-getClientRect(b).left+"px":b.style.width,b=""==b.style.height?getClientRect(b).bottom-getClientRect(b).top+"px":b.style.height,c=0;c<a.count;c++)a.arrNodes[c].style.width=d,a.arrNodes[c].style.height=b}}}
;"object"!=typeof JSON&&(JSON={});
(function(){function a(a){return 10>a?"0"+a:a}function b(a){return e.lastIndex=0,e.test(a)?'"'+a.replace(e,function(a){var b=h[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var e,h,w,y,x,z=f,B=d[a];switch(B&&"object"==typeof B&&"function"==typeof B.toJSON&&(B=B.toJSON(a)),"function"==typeof m&&(B=m.call(d,a,B)),typeof B){case "string":return b(B);case "number":return isFinite(B)?B+"":"null";case "boolean":case "null":return B+"";
case "object":if(!B)return"null";if(f+=g,x=[],"[object Array]"===Object.prototype.toString.apply(B)){y=B.length;for(e=0;y>e;e+=1)x[e]=c(e,B)||"null";return w=0===x.length?"[]":f?"[\n"+f+x.join(",\n"+f)+"\n"+z+"]":"["+x.join(",")+"]",f=z,w}if(m&&"object"==typeof m)for(y=m.length,e=0;y>e;e+=1)"string"==typeof m[e]&&(h=m[e],w=c(h,B),w&&x.push(b(h)+(f?": ":":")+w));else for(h in B)Object.prototype.hasOwnProperty.call(B,h)&&(w=c(h,B),w&&x.push(b(h)+(f?": ":":")+w));return w=0===x.length?"{}":f?"{\n"+f+
x.join(",\n"+f)+"\n"+z+"}":"{"+x.join(",")+"}",f=z,w}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var d,e,f,g,h,m;"function"!=typeof JSON.stringify&&(e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(a,b,d){var e;if(f="",g="","number"==typeof d)for(e=0;d>e;e+=1)g+=" ";else"string"==typeof d&&(g=d);if(m=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw Error("JSON.stringify");return c("",{"":a})});"function"!=typeof JSON.parse&&(d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(a,b){function c(a,
d){var e,f,g=a[d];if(g&&"object"==typeof g)for(e in g)Object.prototype.hasOwnProperty.call(g,e)&&(f=c(g,e),void 0!==f?g[e]=f:delete g[e]);return b.call(a,d,g)}var e;if(a+="",d.lastIndex=0,d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),
"function"==typeof b?c({"":e},""):e;throw new SyntaxError("JSON.parse");})})();"undefined"==typeof JSON&&(this.JSON={});
(function(){var a={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},b=function(b){return a[b]||"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)};JSON.validate=function(a){a=a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");return/^[\],:{}\s]*$/.test(a)};JSON.encode=JSON.stringify?function(a){return JSON.stringify(a)}:function(a){a&&a.toJSON&&(a=a.toJSON());
switch(typeOf(a)){case "string":return'"'+a.replace(/[\x00-\x1f\\"]/g,b)+'"';case "array":return"["+a.map(JSON.encode).clean()+"]";case "object":case "hash":var d=[];Object.each(a,function(a,b){var c=JSON.encode(a);c&&d.push(JSON.encode(b)+":"+c)});return"{"+d+"}";case "number":case "boolean":return""+a;case "null":return"null"}return null};JSON.secure=!0;JSON.decode=function(a,b){if(!a||"string"!=typeof a)return null;null==b&&(b=JSON.secure);if(b){if(JSON.parse)return JSON.parse(a);if(!JSON.validate(a))throw Error("JSON could not decode the input; security is enabled and the value is not secure.");
}return eval("("+a+")")}})();var onChange=function(a){var b=a.editor;a=a.isPossibleDirty;try{for(var c in G_DEPlugin)if("function"===typeof G_DEPlugin[c].onChange)G_DEPlugin[c].onChange()}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}set_ruler_vertical_height(b);set_horizontal_line_2(b);a&&(G_IsPossibleDirty=a);""!=b._config.placeholder.content&&placeholderControl(b,"class")},onCommand=function(a){var b=a.editor,c=a.cmd,d=!1;1==a.tool&&(d=!0);try{for(var e in G_DEPlugin)if("function"===typeof G_DEPlugin[e].onCommand)G_DEPlugin[e].onCommand(a)}catch(f){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if("1"==b._config.returnEvent.command_event)try{"function"===typeof DEXTTOP.G_CURREDITOR._config.event.command?DEXTTOP.G_CURREDITOR._config.event.command(b.ID,{cmd:c,tool:d}):"function"===typeof DEXTTOP.DEXTWIN.dext_command_event&&DEXTTOP.DEXTWIN.dext_command_event(b.ID,{cmd:c,tool:d})}catch(g){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},onResize=function(a){try{for(var b in G_DEPlugin)if("function"===typeof G_DEPlugin[b].onResize)G_DEPlugin[b].onResize(a)}catch(c){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},onInitOnce=function(a){try{for(var b in G_DEPlugin)if("function"===typeof G_DEPlugin[b].onInitOnce)G_DEPlugin[b].onInitOnce(a)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}},onColorPicker=function(a){var b=null;try{for(var c in G_DEPlugin)"function"===typeof G_DEPlugin[c].onColorPicker&&(b=G_DEPlugin[c].onColorPicker(a))}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return b},onCellResize=function(a){try{for(var b in G_DEPlugin)if("function"===
typeof G_DEPlugin[b].onCellResize)G_DEPlugin[b].onCellResize(a)}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}};

var rangy; rangy = rangy || function () { function h(c, d) { var e = typeof c[d]; return e == b || e == a && !!c[d] || e == "unknown" } function i(b, c) { return typeof b[c] == a && !!b[c] } function j(a, b) { return typeof a[b] != c } function k(a) { return function (b, c) { var d = c.length; while (d--) if (!a(b, c[d])) return !1; return !0 } } function o(a) { return a && l(a, g) && n(a, f) } function p(a) { return i(a, "body") ? a.body : a.getElementsByTagName("body")[0] } function t(a, b) { b && window.alert(a) } function u(a) { r.initialized = !0, r.supported = !1, t("Rangy is not supported on this page in your browser. Reason: " + a, r.config.alertOnFail) } function v(a) { t("Rangy warning: " + a, r.config.alertOnWarn) } function y(a) { return a.message || a.description || String(a) } function z() { if (r.initialized) return; var a, b = !1, c = !1; h(document, "createRange") && (a = document.createRange(), l(a, e) && n(a, d) && (b = !0), a.detach()); var f = p(document); if (!f || f.nodeName.toLowerCase() != "body") { u("No body element found"); return } f && h(f, "createTextRange") && (a = f.createTextRange(), o(a) && (c = !0)); if (!b && !c) { u("Neither Range nor TextRange are available"); return } r.initialized = !0, r.features = { implementsDomRange: b, implementsTextRange: c }; var g, i; for (var j in q) (g = q[j]) instanceof C && g.init(); for (var k = 0, m = x.length; k < m; ++k) try { x[k](r) } catch (t) { i = "Rangy init listener threw an exception. Continuing. Detail: " + y(t) } } function B(a) { a = a || window, z(); for (var b = 0, c = A.length; b < c; ++b) A[b](a) } function C(a, b) { this.name = a, this.initialized = !1, this.supported = !1, this.init = b } var a = "object", b = "function", c = "undefined", d = ["startContainer", "startOffset", "endContainer", "endOffset", "collapsed", "commonAncestorContainer"], e = ["setStart", "setStartBefore", "setStartAfter", "setEnd", "setEndBefore", "setEndAfter", "collapse", "selectNode", "selectNodeContents", "compareBoundaryPoints", "deleteContents", "extractContents", "cloneContents", "insertNode", "surroundContents", "cloneRange", "toString", "detach"], f = ["boundingHeight", "boundingLeft", "boundingTop", "boundingWidth", "htmlText", "text"], g = ["collapse", "compareEndPoints", "duplicate", "moveToElementText", "parentElement", "select", "setEndPoint", "getBoundingClientRect"], l = k(h), m = k(i), n = k(j), q = {}, r = { version: "1.3alpha.772", initialized: !1, supported: !0, util: { isHostMethod: h, isHostObject: i, isHostProperty: j, areHostMethods: l, areHostObjects: m, areHostProperties: n, isTextRange: o, getBody: p }, features: {}, modules: q, config: { alertOnFail: !0, alertOnWarn: !1, preferTextRange: !1 } }; r.fail = u, r.warn = v, {}.hasOwnProperty ? r.util.extend = function (a, b, c) { var d, e; for (var f in b) b.hasOwnProperty(f) && (d = a[f], e = b[f], c && d !== null && typeof d == "object" && e !== null && typeof e == "object" && r.util.extend(d, e, !0), a[f] = e); return a } : u("hasOwnProperty not supported"), function () { var a = document.createElement("div"); a.appendChild(document.createElement("span")); var b = [].slice, c; try { b.call(a.childNodes, 0)[0].nodeType == 1 && (c = function (a) { return b.call(a, 0) }) } catch (d) { } c || (c = function (a) { var b = []; for (var c = 0, d = a.length; c < d; ++c) b[c] = a[c]; return b }), r.util.toArray = c }(); var w; h(document, "addEventListener") ? w = function (a, b, c) { a.addEventListener(b, c, !1) } : h(document, "attachEvent") ? w = function (a, b, c) { a.attachEvent("on" + b, c) } : u("Document does not have required addEventListener or attachEvent method"), r.util.addListener = w; var x = []; r.init = z, r.addInitListener = function (a) { r.initialized ? a(r) : x.push(a) }; var A = []; r.addCreateMissingNativeApiListener = function (a) { A.push(a) }, r.createMissingNativeApi = B, C.prototype = { fail: function (a) { throw this.initialized = !0, this.supported = !1, new Error("Module '" + this.name + "' failed to load: " + a) }, warn: function (a) { r.warn("Module " + this.name + ": " + a) }, deprecationNotice: function (a, b) { r.warn("DEPRECATED: " + a + " in module " + this.name + "is deprecated. Please use " + b + " instead") }, createError: function (a) { return new Error("Error in Rangy " + this.name + " module: " + a) } }, r.createModule = function (a, b) { var c = new C(a, function () { if (!c.initialized) { c.initialized = !0; try { b(r, c), c.supported = !0 } catch (d) { var e = "Module '" + a + "' failed to load: " + y(d); } } }); q[a] = c }, r.requireModules = function (a) { for (var b = 0, c = a.length, d, e; b < c; ++b) { e = a[b], d = q[e]; if (!d || !(d instanceof C)) throw new Error("required module '" + e + "' not found"); d.init(); if (!d.supported) throw new Error("required module '" + e + "' not supported") } }; var D = !1, E = function (a) { D || (D = !0, r.initialized || z()) }; if (typeof window == c) { u("No window found"); return } if (typeof document == c) { u("No document found"); return } return h(document, "addEventListener") && document.addEventListener("DOMContentLoaded", E, !1), w(window, "load", E), r }(), rangy.createModule("DomUtil", function (a, b) { function h(a) { var b; return typeof a.namespaceURI == c || (b = a.namespaceURI) === null || b == "http://www.w3.org/1999/xhtml" } function i(a) { var b = a.parentNode; return b.nodeType == 1 ? b : null } function j(a) { var b = 0; while (a = a.previousSibling)++b; return b } function k(a) { switch (a.nodeType) { case 7: case 10: return 0; case 3: case 8: return a.length; default: return a.childNodes.length } } function l(a, b) { var c = [], d; for (d = a; d; d = d.parentNode) c.push(d); for (d = b; d; d = d.parentNode) if (g(c, d)) return d; return null } function m(a, b, c) { var d = c ? b : b.parentNode; while (d) { if (d === a) return !0; d = d.parentNode } return !1 } function n(a, b) { return m(a, b, !0) } function o(a, b, c) { var d, e = c ? a : a.parentNode; while (e) { d = e.parentNode; if (d === b) return e; e = d } return null } function p(a) { var b = a.nodeType; return b == 3 || b == 4 || b == 8 } function q(a) { if (!a) return !1; var b = a.nodeType; return b == 3 || b == 8 } function r(a, b) { var c = b.nextSibling, d = b.parentNode; return c ? d.insertBefore(a, c) : d.appendChild(a), a } function s(a, b, c) { var d = a.cloneNode(!1); d.deleteData(0, b), a.deleteData(b, a.length - b), r(d, a); if (c) for (var e = 0, f; f = c[e++];) f.node == a && f.offset > b ? (f.node = d, f.offset -= b) : f.node == a.parentNode && f.offset > j(a) && ++f.offset; return d } function t(a) { if (a.nodeType == 9) return a; if (typeof a.ownerDocument != c) return a.ownerDocument; if (typeof a.document != c) return a.document; if (a.parentNode) return t(a.parentNode); throw b.createError("getDocument: no document found for node") } function u(a) { var d = t(a); if (typeof d.defaultView != c) return d.defaultView; if (typeof d.parentWindow != c) return d.parentWindow; throw b.createError("Cannot get a window object for node") } function v(a) { if (typeof a.contentDocument != c) return a.contentDocument; if (typeof a.contentWindow != c) return a.contentWindow.document; throw b.createError("getIframeDocument: No Document object found for iframe element") } function w(a) { if (typeof a.contentWindow != c) return a.contentWindow; if (typeof a.contentDocument != c) return a.contentDocument.defaultView; throw b.createError("getIframeWindow: No Window object found for iframe element") } function x(a) { return a && d.isHostMethod(a, "setTimeout") && d.isHostObject(a, "document") } function y(a, b, c) { var e; a ? d.isHostProperty(a, "nodeType") ? e = a.nodeType == 1 && a.tagName.toLowerCase() == "iframe" ? v(a) : t(a) : x(a) && (e = a.document) : e = document; if (!e) throw b.createError(c + "(): Parameter must be a Window object or DOM node"); return e } function z(a) { var b; while (b = a.parentNode) a = b; return a } function A(a, c, d, e) { var f, g, h, i, k; if (a == d) return c === e ? 0 : c < e ? -1 : 1; if (f = o(d, a, !0)) return c <= j(f) ? -1 : 1; if (f = o(a, d, !0)) return j(f) < e ? -1 : 1; g = l(a, d), h = a === g ? g : o(a, g, !0), i = d === g ? g : o(d, g, !0); if (h === i) throw b.createError("comparePoints got to case 4 and childA and childB are the same!"); k = g.firstChild; while (k) { if (k === h) return -1; if (k === i) return 1; k = k.nextSibling } } function C(a) { try { return a.parentNode, !1 } catch (b) { return !0 } } function D(a) { if (!a) return "[No node]"; if (B && C(a)) return "[Broken node]"; if (p(a)) return '"' + a.data + '"'; if (a.nodeType == 1) { var b = a.id ? ' id="' + a.id + '"' : ""; return "<" + a.nodeName + b + ">[" + a.childNodes.length + "][" + a.innerHTML.slice(0, 20) + "]" } return a.nodeName } function E(a) { var b = t(a).createDocumentFragment(), c; while (c = a.firstChild) b.appendChild(c); return b } function G(a) { this.root = a, this._next = a } function H(a) { return new G(a) } function I(a, b) { this.node = a, this.offset = b } function J(a) { this.code = this[a], this.codeName = a, this.message = "DOMException: " + this.codeName } var c = "undefined", d = a.util; d.areHostMethods(document, ["createDocumentFragment", "createElement", "createTextNode"]) || b.fail("document missing a Node creation method"), d.isHostMethod(document, "getElementsByTagName") || b.fail("document missing getElementsByTagName method"); var e = document.createElement("div"); d.areHostMethods(e, ["insertBefore", "appendChild", "cloneNode"] || !d.areHostObjects(e, ["previousSibling", "nextSibling", "childNodes", "parentNode"])) || b.fail("Incomplete Element implementation"), d.isHostProperty(e, "innerHTML") || b.fail("Element is missing innerHTML property"); var f = document.createTextNode("test"); d.areHostMethods(f, ["splitText", "deleteData", "insertData", "appendData", "cloneNode"] || !d.areHostObjects(e, ["previousSibling", "nextSibling", "childNodes", "parentNode"]) || !d.areHostProperties(f, ["data"])) || b.fail("Incomplete Text Node implementation"); var g = function (a, b) { var c = a.length; while (c--) if (a[c] === b) return !0; return !1 }, B = !1; (function () { var b = document.createElement("b"); b.innerHTML = "1"; var c = b.firstChild; b.innerHTML = "<br>", B = C(c), a.features.crashyTextNodes = B })(); var F; typeof window.getComputedStyle != c ? F = function (a, b) { return u(a).getComputedStyle(a, null)[b] } : typeof document.documentElement.currentStyle != c ? F = function (a, b) { return a.currentStyle[b] } : b.fail("No means of obtaining computed style properties found"), G.prototype = { _current: null, hasNext: function () { return !!this._next }, next: function () { var a = this._current = this._next, b, c; if (this._current) { b = a.firstChild; if (b) this._next = b; else { c = null; while (a !== this.root && !(c = a.nextSibling)) a = a.parentNode; this._next = c } } return this._current }, detach: function () { this._current = this._next = this.root = null } }, I.prototype = { equals: function (a) { return !!a && this.node === a.node && this.offset == a.offset }, inspect: function () { return "[DomPosition(" + D(this.node) + ":" + this.offset + ")]" }, toString: function () { return this.inspect() } }, J.prototype = { INDEX_SIZE_ERR: 1, HIERARCHY_REQUEST_ERR: 3, WRONG_DOCUMENT_ERR: 4, NO_MODIFICATION_ALLOWED_ERR: 7, NOT_FOUND_ERR: 8, NOT_SUPPORTED_ERR: 9, INVALID_STATE_ERR: 11 }, J.prototype.toString = function () { return this.message }, a.dom = { arrayContains: g, isHtmlNamespace: h, parentElement: i, getNodeIndex: j, getNodeLength: k, getCommonAncestor: l, isAncestorOf: m, isOrIsAncestorOf: n, getClosestAncestorIn: o, isCharacterDataNode: p, isTextOrCommentNode: q, insertAfter: r, splitDataNode: s, getDocument: t, getWindow: u, getIframeWindow: w, getIframeDocument: v, getBody: d.getBody, isWindow: x, getContentDocument: y, getRootContainer: z, comparePoints: A, isBrokenNode: C, inspectNode: D, getComputedStyleProperty: F, fragmentFromNodeChildren: E, createIterator: H, DomPosition: I }, a.DOMException = J }), rangy.createModule("DomRange", function (a, b) { function r(a, b) { return a.nodeType != 3 && (i(a, b.startContainer) || i(a, b.endContainer)) } function s(a) { return a.document || j(a.startContainer) } function t(a) { return new e(a.parentNode, h(a)) } function u(a) { return new e(a.parentNode, h(a) + 1) } function v(a, b, d) { var e = a.nodeType == 11 ? a.firstChild : a; return g(b) ? d == b.length ? c.insertAfter(a, b) : b.parentNode.insertBefore(a, d == 0 ? b : l(b, d)) : d >= b.childNodes.length ? b.appendChild(a) : b.insertBefore(a, b.childNodes[d]), e } function w(a, b, c) { Y(a), Y(b); var d = k(a.startContainer, a.startOffset, b.endContainer, b.endOffset), e = k(a.endContainer, a.endOffset, b.startContainer, b.startOffset); return c ? d <= 0 && e >= 0 : d < 0 && e > 0 } function x(a) { var b; for (var c, d = s(a.range).createDocumentFragment(), e; c = a.next() ;) { b = a.isPartiallySelectedSubtree(), c = c.cloneNode(!b), b && (e = a.getSubtreeIterator(), c.appendChild(x(e)), e.detach(!0)); d.appendChild(c) } return d } function y(a, b, d) { var e, f; d = d || { stop: !1 }; for (var g, h; g = a.next() ;) if (a.isPartiallySelectedSubtree()) { if (b(g) === !1) { d.stop = !0; return } h = a.getSubtreeIterator(), y(h, b, d), h.detach(!0); if (d.stop) return } else { e = c.createIterator(g); while (f = e.next()) if (b(f) === !1) { d.stop = !0; return } } } function z(a) { var b; while (a.next()) a.isPartiallySelectedSubtree() ? (b = a.getSubtreeIterator(), z(b), b.detach(!0)) : a.remove() } function A(a) { for (var b, c = s(a.range).createDocumentFragment(), d; b = a.next() ;) { a.isPartiallySelectedSubtree() ? (b = b.cloneNode(!1), d = a.getSubtreeIterator(), b.appendChild(A(d)), d.detach(!0)) : a.remove(); c.appendChild(b) } return c } function B(a, b, c) { var d = !!b && !!b.length, e, f = !!c; d && (e = new RegExp("^(" + b.join("|") + ")$")); var g = []; return y(new D(a, !1), function (a) { (!d || e.test(a.nodeType)) && (!f || c(a)) && g.push(a) }), g } function C(a) { var b = typeof a.getName == "undefined" ? "Range" : a.getName(); return "[" + b + "(" + c.inspectNode(a.startContainer) + ":" + a.startOffset + ", " + c.inspectNode(a.endContainer) + ":" + a.endOffset + ")]" } function D(a, b) { this.range = a, this.clonePartiallySelectedTextNodes = b; if (!a.collapsed) { this.sc = a.startContainer, this.so = a.startOffset, this.ec = a.endContainer, this.eo = a.endOffset; var c = a.commonAncestorContainer; this.sc === this.ec && g(this.sc) ? (this.isSingleCharacterDataNode = !0, this._first = this._last = this._next = this.sc) : (this._first = this._next = this.sc === c && !g(this.sc) ? this.sc.childNodes[this.so] : m(this.sc, c, !0), this._last = this.ec === c && !g(this.ec) ? this.ec.childNodes[this.eo - 1] : m(this.ec, c, !0)) } } function E(a) { this.code = this[a], this.codeName = a, this.message = "RangeException: " + this.codeName } function K(a) { return function (b, c) { var d, e = c ? b : b.parentNode; while (e) { d = e.nodeType; if (o(a, d)) return e; e = e.parentNode } return null } } function O(a, b) { } function P(a) { } function Q(a, b) { } function R(a, b) { } function S(a, b) { } function T(a) { } function U(a, b) { } function V(a) { return q && c.isBrokenNode(a) || !o(G, a.nodeType) && !L(a, !0) } function W(a, b) { return b <= (g(a) ? a.length : a.childNodes.length) } function X(a) { return !!a.startContainer && !!a.endContainer && !V(a.startContainer) && !V(a.endContainer) && W(a.startContainer, a.startOffset) && W(a.endContainer, a.endOffset) } function Y(a) { P(a); } function bb(a, b) { Y(a); var c = a.startContainer, d = a.startOffset, e = a.endContainer, f = a.endOffset, i = c === e; g(e) && f > 0 && f < e.length && l(e, f, b), g(c) && d > 0 && d < c.length && (c = l(c, d, b), i ? (f -= d, e = c) : e == c.parentNode && f >= h(c) && f++, d = 0), a.setStartAndEnd(c, d, e, f) } function lb() { } function mb(a) { a.START_TO_START = db, a.START_TO_END = eb, a.END_TO_END = fb, a.END_TO_START = gb, a.NODE_BEFORE = hb, a.NODE_AFTER = ib, a.NODE_BEFORE_AND_AFTER = jb, a.NODE_INSIDE = kb } function nb(a) { mb(a), mb(a.prototype) } function ob(a, b) { return function () { Y(this); var c = this.startContainer, d = this.startOffset, e = this.commonAncestorContainer, f = new D(this, !0), g, h; c !== e && (g = m(c, e, !0), h = u(g), c = h.node, d = h.offset), y(f, T), f.reset(); var i = a(f); return f.detach(), b(this, c, d, c, d), i } } function pb(a, b, c) { function e(a, b) { return function (c) { P(this), Q(c, F), Q(p(c), G); var d = (a ? t : u)(c); (b ? f : i)(this, d.node, d.offset) } } function f(a, c, d) { var e = a.endContainer, f = a.endOffset; if (c !== a.startContainer || d !== a.startOffset) { if (p(c) != p(e) || k(c, d, e, f) == 1) e = c, f = d; b(a, c, d, e, f) } } function i(a, c, d) { var e = a.startContainer, f = a.startOffset; if (c !== a.endContainer || d !== a.endOffset) { if (p(c) != p(e) || k(c, d, e, f) == -1) e = c, f = d; b(a, e, f, c, d) } } a.prototype = new lb, d.extend(a.prototype, { setStart: function (a, b) { P(this), O(a, !0), R(a, b), f(this, a, b) }, setEnd: function (a, b) { P(this), O(a, !0), R(a, b), i(this, a, b) }, setStartAndEnd: function () { P(this); var a = arguments, c = a[0], d = a[1], e = c, f = d; switch (a.length) { case 3: f = a[2]; break; case 4: e = a[2], f = a[3] } b(this, c, d, e, f) }, setBoundary: function (a, b, c) { this["set" + (c ? "Start" : "End")](a, b) }, setStartBefore: e(!0, !0), setStartAfter: e(!1, !0), setEndBefore: e(!0, !1), setEndAfter: e(!1, !1), collapse: function (a) { Y(this), a ? b(this, this.startContainer, this.startOffset, this.startContainer, this.startOffset) : b(this, this.endContainer, this.endOffset, this.endContainer, this.endOffset) }, selectNodeContents: function (a) { P(this), O(a, !0), b(this, a, 0, a, n(a)) }, selectNode: function (a) { P(this), O(a, !1), Q(a, F); var c = t(a), d = u(a); b(this, c.node, c.offset, d.node, d.offset) }, extractContents: ob(A, b), deleteContents: ob(z, b), canSurroundContents: function () { Y(this), T(this.startContainer), T(this.endContainer); var a = new D(this, !0), b = a._first && r(a._first, this) || a._last && r(a._last, this); return a.detach(), !b }, detach: function () { c(this) }, splitBoundaries: function () { bb(this) }, splitBoundariesPreservingPositions: function (a) { bb(this, a) }, normalizeBoundaries: function () { Y(this); var a = this.startContainer, c = this.startOffset, d = this.endContainer, e = this.endOffset, f = function (a) { var b = a.nextSibling; b && b.nodeType == a.nodeType && (d = a, e = a.length, a.appendData(b.data), b.parentNode.removeChild(b)) }, i = function (b) { var f = b.previousSibling; if (f && f.nodeType == b.nodeType) { a = b; var g = b.length; c = f.length, b.insertData(0, f.data), f.parentNode.removeChild(f); if (a == d) e += c, d = a; else if (d == b.parentNode) { var i = h(b); e == i ? (d = b, e = g) : e > i && e-- } } }, j = !0; if (g(d)) d.length == e && f(d); else { if (e > 0) { var k = d.childNodes[e - 1]; k && g(k) && f(k) } j = !this.collapsed } if (j) { if (g(a)) c == 0 && i(a); else if (c < a.childNodes.length) { var l = a.childNodes[c]; l && g(l) && i(l) } } else a = d, c = e; b(this, a, c, d, e) }, collapseToPoint: function (a, b) { P(this), O(a, !0), R(a, b), this.setStartAndEnd(a, b) } }), nb(a) } function qb(a) { a.collapsed = a.startContainer === a.endContainer && a.startOffset === a.endOffset, a.commonAncestorContainer = a.collapsed ? a.startContainer : c.getCommonAncestor(a.startContainer, a.endContainer) } function rb(a, b, d, e, f) { a.startContainer = b, a.startOffset = d, a.endContainer = e, a.endOffset = f, a.document = c.getDocument(b), qb(a) } function sb(a) { P(a), a.startContainer = a.startOffset = a.endContainer = a.endOffset = a.document = null, a.collapsed = a.commonAncestorContainer = null } function tb(a) { this.startContainer = a, this.startOffset = 0, this.endContainer = a, this.endOffset = 0, this.document = a, qb(this) } a.requireModules(["DomUtil"]); var c = a.dom, d = a.util, e = c.DomPosition, f = a.DOMException, g = c.isCharacterDataNode, h = c.getNodeIndex, i = c.isOrIsAncestorOf, j = c.getDocument, k = c.comparePoints, l = c.splitDataNode, m = c.getClosestAncestorIn, n = c.getNodeLength, o = c.arrayContains, p = c.getRootContainer, q = a.features.crashyTextNodes; D.prototype = { _current: null, _next: null, _first: null, _last: null, isSingleCharacterDataNode: !1, reset: function () { this._current = null, this._next = this._first }, hasNext: function () { return !!this._next }, next: function () { var a = this._current = this._next; return a && (this._next = a !== this._last ? a.nextSibling : null, g(a) && this.clonePartiallySelectedTextNodes && (a === this.ec && (a = a.cloneNode(!0)).deleteData(this.eo, a.length - this.eo), this._current === this.sc && (a = a.cloneNode(!0)).deleteData(0, this.so))), a }, remove: function () { var a = this._current, b, c; !g(a) || a !== this.sc && a !== this.ec ? a.parentNode && a.parentNode.removeChild(a) : (b = a === this.sc ? this.so : 0, c = a === this.ec ? this.eo : a.length, b != c && a.deleteData(b, c - b)) }, isPartiallySelectedSubtree: function () { var a = this._current; return r(a, this.range) }, getSubtreeIterator: function () { var a; if (this.isSingleCharacterDataNode) a = this.range.cloneRange(), a.collapse(!1); else { a = new tb(s(this.range)); var b = this._current, c = b, d = 0, e = b, f = n(b); i(b, this.sc) && (c = this.sc, d = this.so), i(b, this.ec) && (e = this.ec, f = this.eo), rb(a, c, d, e, f) } return new D(a, this.clonePartiallySelectedTextNodes) }, detach: function (a) { a && this.range.detach(), this.range = this._current = this._next = this._first = this._last = this.sc = this.so = this.ec = this.eo = null } }, E.prototype = { BAD_BOUNDARYPOINTS_ERR: 1, INVALID_NODE_TYPE_ERR: 2 }, E.prototype.toString = function () { return this.message }; var F = [1, 3, 4, 5, 7, 8, 10], G = [2, 9, 11], H = [5, 6, 10, 12], I = [1, 3, 4, 5, 7, 8, 10, 11], J = [1, 3, 4, 5, 7, 8], L = K([9, 11]), M = K(H), N = K([6, 10, 12]), Z = document.createElement("style"), $ = !1; try { Z.innerHTML = "<b>x</b>", $ = Z.firstChild.nodeType == 3 } catch (_) { } a.features.htmlParsingConforms = $; var ab = $ ? function (a) { var b = this.startContainer, d = j(b); var e = null; return b.nodeType == 1 ? e = b : g(b) && (e = c.parentElement(b)), e === null || e.nodeName == "HTML" && c.isHtmlNamespace(j(e).documentElement) && c.isHtmlNamespace(e) ? e = d.createElement("body") : e = e.cloneNode(!1), e.innerHTML = a, c.fragmentFromNodeChildren(e) } : function (a) { P(this); var b = s(this), d = b.createElement("body"); return d.innerHTML = a, c.fragmentFromNodeChildren(d) }, cb = ["startContainer", "startOffset", "endContainer", "endOffset", "collapsed", "commonAncestorContainer"], db = 0, eb = 1, fb = 2, gb = 3, hb = 0, ib = 1, jb = 2, kb = 3; lb.prototype = { compareBoundaryPoints: function (a, b) { Y(this), S(this.startContainer, b.startContainer); var c, d, e, f, g = a == gb || a == db ? "start" : "end", h = a == eb || a == db ? "start" : "end"; return c = this[g + "Container"], d = this[g + "Offset"], e = b[h + "Container"], f = b[h + "Offset"], k(c, d, e, f) }, insertNode: function (a) { Y(this), Q(a, I), T(this.startContainer); var b = v(a, this.startContainer, this.startOffset); this.setStartBefore(b) }, cloneContents: function () { Y(this); var a, b; if (this.collapsed) return s(this).createDocumentFragment(); if (this.startContainer === this.endContainer && g(this.startContainer)) return a = this.startContainer.cloneNode(!0), a.data = a.data.slice(this.startOffset, this.endOffset), b = s(this).createDocumentFragment(), b.appendChild(a), b; var c = new D(this, !0); return a = x(c), c.detach(), a }, canSurroundContents: function () { Y(this), T(this.startContainer), T(this.endContainer); var a = new D(this, !0), b = a._first && r(a._first, this) || a._last && r(a._last, this); return a.detach(), !b }, surroundContents: function (a) { Q(a, J); var b = this.extractContents(); if (a.hasChildNodes()) while (a.lastChild) a.removeChild(a.lastChild); v(a, this.startContainer, this.startOffset), a.appendChild(b), this.selectNode(a) }, cloneRange: function () { Y(this); var a = new tb(s(this)), b = cb.length, c; while (b--) c = cb[b], a[c] = this[c]; return a }, toString: function () { Y(this); var a = this.startContainer; if (a === this.endContainer && g(a)) return a.nodeType == 3 || a.nodeType == 4 ? a.data.slice(this.startOffset, this.endOffset) : ""; var b = [], c = new D(this, !0); return y(c, function (a) { (a.nodeType == 3 || a.nodeType == 4) && b.push(a.data) }), c.detach(), b.join("") }, compareNode: function (a) { Y(this); var b = a.parentNode, c = h(a); var d = this.comparePoint(b, c), e = this.comparePoint(b, c + 1); return d < 0 ? e > 0 ? jb : hb : e > 0 ? ib : kb }, comparePoint: function (a, b) { return Y(this), U(a, "HIERARCHY_REQUEST_ERR"), S(a, this.startContainer), k(a, b, this.startContainer, this.startOffset) < 0 ? -1 : k(a, b, this.endContainer, this.endOffset) > 0 ? 1 : 0 }, createContextualFragment: ab, toHtml: function () { Y(this); var a = this.commonAncestorContainer.parentNode.cloneNode(!1); return a.appendChild(this.cloneContents()), a.innerHTML }, intersectsNode: function (a, b) { Y(this), U(a, "NOT_FOUND_ERR"); if (j(a) !== s(this)) return !1; var c = a.parentNode, d = h(a); U(c, "NOT_FOUND_ERR"); var e = k(c, d, this.endContainer, this.endOffset), f = k(c, d + 1, this.startContainer, this.startOffset); return b ? e <= 0 && f >= 0 : e < 0 && f > 0 }, isPointInRange: function (a, b) { return Y(this), U(a, "HIERARCHY_REQUEST_ERR"), S(a, this.startContainer), k(a, b, this.startContainer, this.startOffset) >= 0 && k(a, b, this.endContainer, this.endOffset) <= 0 }, intersectsRange: function (a) { return w(this, a, !1) }, intersectsOrTouchesRange: function (a) { return w(this, a, !0) }, intersection: function (a) { if (this.intersectsRange(a)) { var b = k(this.startContainer, this.startOffset, a.startContainer, a.startOffset), c = k(this.endContainer, this.endOffset, a.endContainer, a.endOffset), d = this.cloneRange(); return b == -1 && d.setStart(a.startContainer, a.startOffset), c == 1 && d.setEnd(a.endContainer, a.endOffset), d } return null }, union: function (a) { if (this.intersectsOrTouchesRange(a)) { var b = this.cloneRange(); return k(a.startContainer, a.startOffset, this.startContainer, this.startOffset) == -1 && b.setStart(a.startContainer, a.startOffset), k(a.endContainer, a.endOffset, this.endContainer, this.endOffset) == 1 && b.setEnd(a.endContainer, a.endOffset), b } }, containsNode: function (a, b) { return b ? this.intersectsNode(a, !1) : this.compareNode(a) == kb }, containsNodeContents: function (a) { return this.comparePoint(a, 0) >= 0 && this.comparePoint(a, n(a)) <= 0 }, containsRange: function (a) { var b = this.intersection(a); return b !== null && a.equals(b) }, containsNodeText: function (a) { var b = this.cloneRange(); b.selectNode(a); var c = b.getNodes([3]); if (c.length > 0) { b.setStart(c[0], 0); var d = c.pop(); b.setEnd(d, d.length); var e = this.containsRange(b); return b.detach(), e } return this.containsNodeContents(a) }, getNodes: function (a, b) { return Y(this), B(this, a, b) }, getDocument: function () { return s(this) }, collapseBefore: function (a) { P(this), this.setEndBefore(a), this.collapse(!1) }, collapseAfter: function (a) { P(this), this.setStartAfter(a), this.collapse(!0) }, getBookmark: function (b) { var d = s(this), e = a.createRange(d); b = b || c.getBody(d), e.selectNodeContents(b); var f = this.intersection(e), g = 0, h = 0; return f && (e.setEnd(f.startContainer, f.startOffset), g = e.toString().length, h = g + f.toString().length, e.detach()), { start: g, end: h, containerNode: b } }, moveToBookmark: function (a) { var b = a.containerNode, c = 0; this.setStart(b, 0), this.collapse(!0); var d = [b], e, f = !1, g = !1, h, i, j; while (!g && (e = d.pop())) if (e.nodeType == 3) h = c + e.length, !f && a.start >= c && a.start <= h && (this.setStart(e, a.start - c), f = !0), f && a.end >= c && a.end <= h && (this.setEnd(e, a.end - c), g = !0), c = h; else { j = e.childNodes, i = j.length; while (i--) d.push(j[i]) } }, getName: function () { return "DomRange" }, equals: function (a) { return tb.rangesEqual(this, a) }, isValid: function () { return X(this) }, inspect: function () { return C(this) } }, pb(tb, rb, sb), a.rangePrototype = lb.prototype, d.extend(tb, { rangeProperties: cb, RangeIterator: D, copyComparisonConstants: nb, createPrototypeRange: pb, inspect: C, getRangeDocument: s, rangesEqual: function (a, b) { return a.startContainer === b.startContainer && a.startOffset === b.startOffset && a.endContainer === b.endContainer && a.endOffset === b.endOffset } }), a.DomRange = tb, a.RangeException = E }), rangy.createModule("WrappedRange", function (a, b) { a.requireModules(["DomUtil", "DomRange"]); var c, d, e = a.dom, f = a.util, g = e.DomPosition, h = a.DomRange, i = e.getBody, j = e.getContentDocument, k = e.isCharacterDataNode; a.features.implementsDomRange && function () { function k(a) { var b = g.length, c; while (b--) c = g[b], a[c] = a.nativeRange[c]; a.collapsed = a.startContainer === a.endContainer && a.startOffset === a.endOffset } function l(a, b, c, d, e) { var f = a.startContainer !== b || a.startOffset != c, g = a.endContainer !== d || a.endOffset != e, h = !a.equals(a.nativeRange); if (f || g || h) a.setEnd(d, e), a.setStart(b, c) } function m(a) { a.nativeRange.detach(), a.detached = !0; var b = g.length; while (b--) a[g[b]] = null } var d, g = h.rangeProperties, n; c = function (a) { if (!a) throw b.createError("WrappedRange: Range must be specified"); this.nativeRange = a, k(this) }, h.createPrototypeRange(c, l, m), d = c.prototype, d.selectNode = function (a) { this.nativeRange.selectNode(a), k(this) }, d.cloneContents = function () { return this.nativeRange.cloneContents() }, d.surroundContents = function (a) { this.nativeRange.surroundContents(a), k(this) }, d.collapse = function (a) { this.nativeRange.collapse(a), k(this) }, d.cloneRange = function () { return new c(this.nativeRange.cloneRange()) }, d.refresh = function () { k(this) }, d.toString = function () { return this.nativeRange.toString() }; var o = document.createTextNode("test"); i(document).appendChild(o); var p = document.createRange(); p.setStart(o, 0), p.setEnd(o, 0); try { p.setStart(o, 1), d.setStart = function (a, b) { this.nativeRange.setStart(a, b), k(this) }, d.setEnd = function (a, b) { this.nativeRange.setEnd(a, b), k(this) }, n = function (a) { return function (b) { this.nativeRange[a](b), k(this) } } } catch (q) { d.setStart = function (a, b) { try { this.nativeRange.setStart(a, b) } catch (c) { this.nativeRange.setEnd(a, b), this.nativeRange.setStart(a, b) } k(this) }, d.setEnd = function (a, b) { try { this.nativeRange.setEnd(a, b) } catch (c) { this.nativeRange.setStart(a, b), this.nativeRange.setEnd(a, b) } k(this) }, n = function (a, b) { return function (c) { try { this.nativeRange[a](c) } catch (d) { this.nativeRange[b](c), this.nativeRange[a](c) } k(this) } } } d.setStartBefore = n("setStartBefore", "setEndBefore"), d.setStartAfter = n("setStartAfter", "setEndAfter"), d.setEndBefore = n("setEndBefore", "setStartBefore"), d.setEndAfter = n("setEndAfter", "setStartAfter"), p.selectNodeContents(o), p.startContainer == o && p.endContainer == o && p.startOffset == 0 && p.endOffset == o.length ? d.selectNodeContents = function (a) { this.nativeRange.selectNodeContents(a), k(this) } : d.selectNodeContents = function (a) { this.setStartAndEnd(a, 0, e.getNodeLength(a)) }, p.selectNodeContents(o), p.setEnd(o, 3); var r = document.createRange(); r.selectNodeContents(o), r.setEnd(o, 4), r.setStart(o, 2), p.compareBoundaryPoints(p.START_TO_END, r) == -1 && p.compareBoundaryPoints(p.END_TO_START, r) == 1 ? d.compareBoundaryPoints = function (a, b) { return b = b.nativeRange || b, a == b.START_TO_END ? a = b.END_TO_START : a == b.END_TO_START && (a = b.START_TO_END), this.nativeRange.compareBoundaryPoints(a, b) } : d.compareBoundaryPoints = function (a, b) { return this.nativeRange.compareBoundaryPoints(a, b.nativeRange || b) }; var s = document.createElement("div"); s.innerHTML = "123"; var t = s.firstChild, u = i(document); u.appendChild(s), p.setStart(t, 1), p.setEnd(t, 2), p.deleteContents(), t.data == "13" && (d.deleteContents = function () { this.nativeRange.deleteContents(), k(this) }, d.extractContents = function () { var a = this.nativeRange.extractContents(); return k(this), a }), u.removeChild(s), u = null, f.isHostMethod(p, "createContextualFragment") && (d.createContextualFragment = function (a) { return this.nativeRange.createContextualFragment(a) }), i(document).removeChild(o), p.detach(), r.detach(), d.getName = function () { return "WrappedRange" }, a.WrappedRange = c, a.createNativeRange = function (a) { return a = j(a, b, "createNativeRange"), a.createRange() } }(); if (a.features.implementsTextRange) { var l = function (a) { var b = a.parentElement(), c = a.duplicate(); c.collapse(!0); var d = c.parentElement(); c = a.duplicate(), c.collapse(!1); var f = c.parentElement(), g = d == f ? d : e.getCommonAncestor(d, f); return g == b ? g : e.getCommonAncestor(b, g) }, m = function (a) { return a.compareEndPoints("StartToEnd", a) == 0 }, n = function (a, b, c, d, f) { var h = a.duplicate(); h.collapse(c); var i = h.parentElement(); e.isOrIsAncestorOf(b, i) || (i = b); if (!i.canHaveHTML) { var j = new g(i.parentNode, e.getNodeIndex(i)); return { boundaryPosition: j, nodeInfo: { nodeIndex: j.offset, containerElement: j.node } } } var l = e.getDocument(i).createElement("span"); l.parentNode && l.parentNode.removeChild(l); var m, n = c ? "StartToStart" : "StartToEnd", o, p, q, r, s = f && f.containerElement == i ? f.nodeIndex : 0, t = i.childNodes.length, u = t, v = u; for (; ;) { v == t ? i.appendChild(l) : i.insertBefore(l, i.childNodes[v]), h.moveToElementText(l), m = h.compareEndPoints(n, a); if (m == 0 || s == u) break; if (m == -1) { if (u == s + 1) break; s = v } else u = u == s + 1 ? s : v; v = Math.floor((s + u) / 2), i.removeChild(l) } r = l.nextSibling; if (m == -1 && r && k(r)) { h.setEndPoint(c ? "EndToStart" : "EndToEnd", a); var w; if (/[\r\n]/.test(r.data)) { var x = h.duplicate(), y = x.text.replace(/\r\n/g, "\r").length; w = x.moveStart("character", y); while ((m = x.compareEndPoints("StartToEnd", x)) == -1) w++, x.moveStart("character", 1) } else w = h.text.length; q = new g(r, w) } else o = (d || !c) && l.previousSibling, p = (d || c) && l.nextSibling, p && k(p) ? q = new g(p, 0) : o && k(o) ? q = new g(o, o.data.length) : q = new g(i, e.getNodeIndex(l)); return l.parentNode.removeChild(l), { boundaryPosition: q, nodeInfo: { nodeIndex: v, containerElement: i } } }, o = function (a, b) { var c, d, f = a.offset, g = e.getDocument(a.node), h, j, l = i(g).createTextRange(), m = k(a.node); return m ? (c = a.node, d = c.parentNode) : (j = a.node.childNodes, c = f < j.length ? j[f] : null, d = a.node), h = g.createElement("span"), h.innerHTML = "&#feff;", c ? d.insertBefore(h, c) : d.appendChild(h), l.moveToElementText(h), l.collapse(!b), d.removeChild(h), m && l[b ? "moveStart" : "moveEnd"]("character", f), l }; d = function (a) { this.textRange = a, this.refresh() }, d.prototype = new h(document), d.prototype.refresh = function () { var a, b, c, d = l(this.textRange); m(this.textRange) ? b = a = n(this.textRange, d, !0, !0).boundaryPosition : (c = n(this.textRange, d, !0, !1), a = c.boundaryPosition, b = n(this.textRange, d, !1, !1, c.nodeInfo).boundaryPosition), this.setStart(a.node, a.offset), this.setEnd(b.node, b.offset) }, d.prototype.getName = function () { return "WrappedTextRange" }, h.copyComparisonConstants(d), d.rangeToTextRange = function (a) { if (a.collapsed) return o(new g(a.startContainer, a.startOffset), !0); var b = o(new g(a.startContainer, a.startOffset), !0), c = o(new g(a.endContainer, a.endOffset), !1), d = i(h.getRangeDocument(a)).createTextRange(); return d.setEndPoint("StartToStart", b), d.setEndPoint("EndToEnd", c), d }, a.WrappedTextRange = d; if (!a.features.implementsDomRange || a.config.preferTextRange) { var p = function () { return this }(); typeof p.Range == "undefined" && (p.Range = d), a.createNativeRange = function (a) { return a = j(a, b, "createNativeRange"), i(a).createTextRange() }, a.WrappedRange = d } } a.createRange = function (c) { return c = j(c, b, "createRange"), new a.WrappedRange(a.createNativeRange(c)) }, a.createRangyRange = function (a) { return a = j(a, b, "createRangyRange"), new h(a) }, a.createIframeRange = function (c) { return b.deprecationNotice("createIframeRange()", "createRange(iframeEl)"), a.createRange(c) }, a.createIframeRangyRange = function (c) { return b.deprecationNotice("createIframeRangyRange()", "createRangyRange(iframeEl)"), a.createRangyRange(c) }, a.addCreateMissingNativeApiListener(function (b) { var c = b.document; typeof c.createRange == "undefined" && (c.createRange = function () { return a.createRange(c) }), c = b = null }) }), rangy.createModule("WrappedSelection", function (a, b) { function r(a) { return typeof a == "string" ? a == "backward" : !!a } function s(a, c) { if (!a) return window; if (d.isWindow(a)) return a; if (a instanceof T) return a.win; var e = d.getContentDocument(a, b, c); return d.getWindow(e) } function t(a) { return s(a, "getWinSelection").getSelection() } function u(a) { return s(a, "getDocSelection").document.selection } function I(a, b, c) { var d = c ? "end" : "start", e = c ? "start" : "end"; a.anchorNode = b[d + "Container"], a.anchorOffset = b[d + "Offset"], a.focusNode = b[e + "Container"], a.focusOffset = b[e + "Offset"] } function J(a) { var b = a.nativeSelection; a.anchorNode = b.anchorNode, a.anchorOffset = b.anchorOffset, a.focusNode = b.focusNode, a.focusOffset = b.focusOffset } function K(a) { a.anchorNode = a.focusNode = null, a.anchorOffset = a.focusOffset = 0, a.rangeCount = 0, a.isCollapsed = !0, a._ranges.length = 0 } function L(b) { var c; return b instanceof g ? (c = a.createNativeRange(b.getDocument()), c.setEnd(b.endContainer, b.endOffset), c.setStart(b.startContainer, b.startOffset)) : b instanceof h ? c = b.nativeRange : m.implementsDomRange && b instanceof d.getWindow(b.startContainer).Range && (c = b), c } function M(a) { if (!a.length || a[0].nodeType != 1) return !1; for (var b = 1, c = a.length; b < c; ++b) if (!d.isAncestorOf(a[0], a[b])) return !1; return !0 } function N(a) { var c = a.getNodes(); if (!M(c)) throw b.createError("getSingleElementFromRange: range " + a.inspect() + " did not consist of a single element"); return c[0] } function O(a) { return !!a && typeof a.text != "undefined" } function P(a, b) { var c = new h(b); a._ranges = [c], I(a, c, !1), a.rangeCount = 1, a.isCollapsed = c.collapsed } function Q(b) { b._ranges.length = 0; if (b.docSelection.type == "None") K(b); else { var c = b.docSelection.createRange(); if (O(c)) P(b, c); else { b.rangeCount = c.length; var d, e = o(c.item(0)); for (var f = 0; f < b.rangeCount; ++f) d = a.createRange(e), d.selectNode(c.item(f)), b._ranges.push(d); b.isCollapsed = b.rangeCount == 1 && b._ranges[0].collapsed, I(b, b._ranges[b.rangeCount - 1], !1) } } } function R(a, c) { var d = a.docSelection.createRange(), e = N(c), f = o(d.item(0)), g = p(f).createControlRange(); for (var h = 0, i = d.length; h < i; ++h) g.add(d.item(h)); try { g.add(e) } catch (j) { throw b.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)") } g.select(), Q(a) } function T(a, b, c) { this.nativeSelection = a, this.docSelection = b, this._ranges = [], this.win = c, this.refresh() } function U(a) { a.win = a.anchorNode = a.focusNode = a._ranges = null, a.rangeCount = a.anchorOffset = a.focusOffset = 0, a.detached = !0 } function W(a, b) { var c = V.length, d, e; while (c--) { d = V[c], e = d.selection; if (b == "deleteAll") U(e); else if (d.win == a) return b == "delete" ? (V.splice(c, 1), !0) : e } return b == "deleteAll" && (V.length = 0), null } function Z(a, c) { var d = o(c[0].startContainer), e = p(d).createControlRange(); for (var f = 0, g; f < rangeCount; ++f) { g = N(c[f]); try { e.add(g) } catch (h) { throw b.createError("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)") } } e.select(), Q(a) } function cb(a, b) { } function db(b) { return function (c, d) { var e; this.rangeCount ? (e = this.getRangeAt(0), e["set" + (b ? "Start" : "End")](c, d)) : (e = a.createRange(this.win.document), e.setStartAndEnd(c, d)), this.setSingleRange(e, this.isBackward()) } } function eb(a) { var b = [], c = new j(a.anchorNode, a.anchorOffset), d = new j(a.focusNode, a.focusOffset), e = typeof a.getName == "function" ? a.getName() : "Selection"; if (typeof a.rangeCount != "undefined") for (var f = 0, h = a.rangeCount; f < h; ++f) b[f] = g.inspect(a.getRangeAt(f)); return "[" + e + "(Ranges: " + b.join(", ") + ")(anchor: " + c.inspect() + ", focus: " + d.inspect() + "]" } a.requireModules(["DomUtil", "DomRange", "WrappedRange"]), a.config.checkSelectionRanges = !0; var c = "boolean", d = a.dom, e = a.util, f = e.isHostMethod, g = a.DomRange, h = a.WrappedRange, i = a.DOMException, j = d.DomPosition, k, l, m = a.features, n = "Control", o = d.getDocument, p = d.getBody, q = g.rangesEqual, v = f(window, "getSelection"), w = e.isHostObject(document, "selection"); m.implementsWinGetSelection = v, m.implementsDocSelection = w; var x = w && (!v || a.config.preferTextRange); x ? (k = u, a.isSelectionValid = function (a) { var b = s(a, "isSelectionValid").document, c = b.selection; return c.type != "None" || o(c.createRange().parentElement()) == b }) : v ? (k = t, a.isSelectionValid = function () { return !0 }) : b.fail("Neither document.selection or window.getSelection() detected."), a.getNativeSelection = k; var y = k(), z = a.createNativeRange(document), A = p(document), B = e.areHostProperties(y, ["anchorNode", "focusNode", "anchorOffset", "focusOffset"]); m.selectionHasAnchorAndFocus = B; var C = f(y, "extend"); m.selectionHasExtend = C; var D = typeof y.rangeCount == "number"; m.selectionHasRangeCount = D; var E = !1, F = !0; e.areHostMethods(y, ["addRange", "getRangeAt", "removeAllRanges"]) && typeof y.rangeCount == "number" && m.implementsDomRange && function () { var a = window.getSelection(); if (a) { var b = p(document), c = b.appendChild(document.createElement("div")); c.contentEditable = "false"; var d = c.appendChild(document.createTextNode("\u00a0\u00a0\u00a0")), e = document.createRange(); e.setStart(d, 1), e.collapse(!0), a.addRange(e), F = a.rangeCount == 1, a.removeAllRanges(); var f = e.cloneRange(); e.setStart(d, 0), f.setEnd(d, 3), f.setStart(d, 2), a.addRange(e); if (!DEXTTOP.DEXT5.browser.chrome) { a.addRange(f); } E = a.rangeCount == 2, b.removeChild(c), a.removeAllRanges(), e.detach(), f.detach(); } }(), m.selectionSupportsMultipleRanges = E, m.collapsedNonEditableSelectionsSupported = F; var G = !1, H; A && f(A, "createControlRange") && (H = A.createControlRange(), e.areHostProperties(H, ["item", "add"]) && (G = !0)), m.implementsControlRange = G, B ? l = function (a) { return a.anchorNode === a.focusNode && a.anchorOffset === a.focusOffset } : l = function (a) { return a.rangeCount ? a.getRangeAt(a.rangeCount - 1).collapsed : !1 }; var S; f(y, "getRangeAt") ? S = function (a, b) { try { return a.getRangeAt(b) } catch (c) { return null } } : B && (S = function (b) { var c = o(b.anchorNode), d = a.createRange(c); return d.setStartAndEnd(b.anchorNode, b.anchorOffset, b.focusNode, b.focusOffset), d.collapsed !== this.isCollapsed && d.setStartAndEnd(b.focusNode, b.focusOffset, b.anchorNode, b.anchorOffset), d }); var V = [], X = function (a) { if (a && a instanceof T) return a.refresh(), a; a = s(a, "getNativeSelection"); var b = W(a), c = k(a), d = w ? u(a) : null; return b ? (b.nativeSelection = c, b.docSelection = d, b.refresh()) : (b = new T(c, d, a), V.push({ win: a, selection: b })), b }; a.getSelection = X, a.getIframeSelection = function (c) { return b.deprecationNotice("getIframeSelection()", "getSelection(iframeEl)"), a.getSelection(d.getIframeWindow(c)) }; var Y = T.prototype; if (!x && B && e.areHostMethods(y, ["removeAllRanges", "addRange"])) { Y.removeAllRanges = function () { this.nativeSelection.removeAllRanges(), K(this) }; var $ = function (b, c) { var d = g.getRangeDocument(c), e = a.createRange(d); e.collapseToPoint(c.endContainer, c.endOffset), b.nativeSelection.addRange(L(e)), b.nativeSelection.extend(c.startContainer, c.startOffset), b.refresh() }; D ? Y.addRange = function (b, c) { if (G && w && this.docSelection.type == n) R(this, b); else if (r(c) && C) $(this, b); else { var d; E ? d = this.rangeCount : (this.removeAllRanges(), d = 0), this.nativeSelection.addRange(L(b).cloneRange()), this.rangeCount = this.nativeSelection.rangeCount; if (this.rangeCount == d + 1) { if (a.config.checkSelectionRanges) { var e = S(this.nativeSelection, this.rangeCount - 1); e && !q(e, b) && (b = new h(e)) } this._ranges[this.rangeCount - 1] = b, I(this, b, bb(this.nativeSelection)), this.isCollapsed = l(this) } else this.refresh() } } : Y.addRange = function (a, b) { r(b) && C ? $(this, a) : (this.nativeSelection.addRange(L(a)), this.refresh()) }, Y.setRanges = function (a) { if (G && a.length > 1) Z(this, a); else { this.removeAllRanges(); for (var b = 0, c = a.length; b < c; ++b) this.addRange(a[b]) } } } else { if (!(f(y, "empty") && f(z, "select") && G && x)) return b.fail("No means of selecting a Range or TextRange was found"), !1; Y.removeAllRanges = function () { try { this.docSelection.empty(); if (this.docSelection.type != "None") { var a; if (this.anchorNode) a = o(this.anchorNode); else if (this.docSelection.type == n) { var b = this.docSelection.createRange(); b.length && (a = o(b.item(0))) } if (a) { var c = p(a).createTextRange(); c.select(), this.docSelection.empty() } } } catch (d) { } K(this) }, Y.addRange = function (a) { this.docSelection.type == n ? R(this, a) : (h.rangeToTextRange(a).select(), this._ranges[0] = a, this.rangeCount = 1, this.isCollapsed = this._ranges[0].collapsed, I(this, a, !1)) }, Y.setRanges = function (a) { this.removeAllRanges(); var b = a.length; b > 1 ? Z(this, a) : b && this.addRange(a[0]) } } Y.getRangeAt = function (a) { return this._ranges[a].cloneRange() }; var _; if (x) _ = function (b) { var c; a.isSelectionValid(b.win) ? c = b.docSelection.createRange() : (c = p(b.win.document).createTextRange(), c.collapse(!0)), b.docSelection.type == n ? Q(b) : O(c) ? P(b, c) : K(b) }; else if (f(y, "getRangeAt") && typeof y.rangeCount == "number") _ = function (b) { if (G && w && b.docSelection.type == n) Q(b); else { b._ranges.length = b.rangeCount = b.nativeSelection.rangeCount; if (b.rangeCount) { for (var c = 0, d = b.rangeCount; c < d; ++c) b._ranges[c] = new a.WrappedRange(b.nativeSelection.getRangeAt(c)); I(b, b._ranges[b.rangeCount - 1], bb(b.nativeSelection)), b.isCollapsed = l(b) } else K(b) } }; else { if (!B || typeof y.isCollapsed != c || typeof z.collapsed != c || !m.implementsDomRange) return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"), !1; _ = function (a) { var b, c = a.nativeSelection; c.anchorNode ? (b = S(c, 0), a._ranges = [b], a.rangeCount = 1, J(a), a.isCollapsed = l(a)) : K(a) } } Y.refresh = function (a) { var b = a ? this._ranges.slice(0) : null, c = this.anchorNode, d = this.anchorOffset; _(this); if (a) { var e = b.length; if (e != this._ranges.length) return !0; if (this.anchorNode != c || this.anchorOffset != d) return !0; while (e--) if (!q(b[e], this._ranges[e])) return !0; return !1 } }; var ab = function (b, c) { var d = b.getAllRanges(); b.removeAllRanges(); for (var e = 0, f = d.length; e < f; ++e) a.rangesEqual(c, d[e]) || b.addRange(d[e]); b.rangeCount || K(b) }; G ? Y.removeRange = function (a) { if (this.docSelection.type == n) { var b = this.docSelection.createRange(), c = N(a), d = o(b.item(0)), e = p(d).createControlRange(), f, g = !1; for (var h = 0, i = b.length; h < i; ++h) f = b.item(h), f !== c || g ? e.add(b.item(h)) : g = !0; e.select(), Q(this) } else ab(this, a) } : Y.removeRange = function (a) { ab(this, a) }; var bb; !x && B && m.implementsDomRange ? (bb = function (a) { var b = !1; return a.anchorNode && (b = d.comparePoints(a.anchorNode, a.anchorOffset, a.focusNode, a.focusOffset) == 1), b }, Y.isBackward = function () { return bb(this) }) : bb = Y.isBackward = function () { return !1 }, Y.isBackwards = Y.isBackward, Y.toString = function () { var a = []; for (var b = 0, c = this.rangeCount; b < c; ++b) a[b] = "" + this._ranges[b]; return a.join("") }, Y.collapse = function (b, c) { cb(this, b); var d = a.createRange(b); d.collapseToPoint(b, c), this.setSingleRange(d), this.isCollapsed = !0 }, Y.collapseToStart = function () { var a = this._ranges[0]; this.collapse(a.startContainer, a.startOffset) }, Y.collapseToEnd = function () { var a = this._ranges[this.rangeCount - 1]; this.collapse(a.endContainer, a.endOffset) }, Y.selectAllChildren = function (b) { cb(this, b); var c = a.createRange(b); c.selectNodeContents(b), this.removeAllRanges(), this.addRange(c) }, Y.deleteFromDocument = function () { if (G && w && this.docSelection.type == n) { var a = this.docSelection.createRange(), b; while (a.length) b = a.item(0), a.remove(b), b.parentNode.removeChild(b); this.refresh() } else if (this.rangeCount) { var c = this.getAllRanges(); if (c.length) { this.removeAllRanges(); for (var d = 0, e = c.length; d < e; ++d) c[d].deleteContents(); this.addRange(c[e - 1]) } } }, Y.eachRange = function (a, b) { for (var c = 0, d = this._ranges.length; c < d; ++c) if (a(this.getRangeAt(c))) return b }, Y.getAllRanges = function () { var a = []; return this.eachRange(function (b) { a.push(b) }), a }, Y.setSingleRange = function (a, b) { this.removeAllRanges(), this.addRange(a, b) }, Y.callMethodOnEachRange = function (a, b) { var c = []; return this.eachRange(function (d) { c.push(d[a].apply(d, b)) }), c }, Y.setStart = db(!0), Y.setEnd = db(!1), a.rangePrototype.select = function (a) { X(this.getDocument()).setSingleRange(this, a) }, Y.changeEachRange = function (a) { var b = [], c = this.isBackward(); this.eachRange(function (c) { a(c), b.push(c) }), this.removeAllRanges(), c && b.length == 1 ? this.addRange(b[0], "backward") : this.setRanges(b) }, Y.containsNode = function (a, b) { return this.eachRange(function (c) { return c.containsNode(a, b) }, !0) }, Y.getBookmark = function (a) { return { backward: this.isBackward(), rangeBookmarks: this.callMethodOnEachRange("getBookmark", [a]) } }, Y.moveToBookmark = function (b) { var c = []; for (var d = 0, e, f; e = b.rangeBookmarks[d++];) f = a.createRange(this.win), f.moveToBookmark(e), c.push(f); b.backward ? this.setSingleRange(c[0], "backward") : this.setRanges(c) }, Y.toHtml = function () { return this.callMethodOnEachRange("toHtml").join("") }, Y.getName = function () { return "WrappedSelection" }, Y.inspect = function () { return eb(this) }, Y.detach = function () { W(this.win, "delete"), U(this) }, T.detachAll = function () { W(null, "deleteAll") }, T.inspect = eb, T.isDirectionBackward = r, a.Selection = T, a.selectionPrototype = Y, a.addCreateMissingNativeApiListener(function (a) { typeof a.getSelection == "undefined" && (a.getSelection = function () { return X(a) }), a = null }) })

rangy.createModule("TextRange",function(a,b){function t(a,b){function f(b,c,d){var f=a.slice(b,c),g={isWord:d,chars:f,toString:function(){return f.join("")}};for(var h=0,i=f.length;h<i;++h)f[h].token=g;e.push(g)}var c=a.join(""),d,e=[],g=0,h,i;while(d=b.wordRegex.exec(c)){h=d.index,i=h+d[0].length,h>g&&f(g,h,!1);if(b.includeTrailingSpace)while(m.test(a[i]))++i;f(h,i,!0),g=i}return g<a.length&&f(g,a.length,!1),e}function x(a,b){if(!a)return b;var c={};return h(c,b),h(c,a),c}function y(a){var b,c;return a?(b=a.language||o,c={},h(c,w[b]||w[o]),h(c,a),c):w[o]}function z(a){return x(a,u)}function A(a){return x(a,v)}function I(a,b){var c=F(a,"display",b),d=a.tagName.toLowerCase();return c=="block"&&G&&H.hasOwnProperty(d)?H[d]:c}function J(a){var b=P(a);for(var c=0,d=b.length;c<d;++c)if(b[c].nodeType==1&&I(b[c])=="none")return!0;return!1}function K(a){var b;return a.nodeType==3&&(b=a.parentNode)&&F(b,"visibility")=="hidden"}function L(a){return a&&(a.nodeType==1&&!/^(inline(-block|-table)?|none)$/.test(I(a))||a.nodeType==9||a.nodeType==11)}function M(a){var b=a.lastChild;return b?M(b):a}function N(a){return f.isCharacterDataNode(a)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(a.nodeName)}function O(a){var b=[];while(a.parentNode)b.unshift(a.parentNode),a=a.parentNode;return b}function P(a){return O(a).concat([a])}function Q(a){var b;return typeof (b=a.namespaceURI)==c||b===null||b=="http://www.w3.org/1999/xhtml"}function R(a,b){if(!a||a.nodeType!=1||!Q(a))return!1;switch(typeof b){case"string":return a.tagName.toLowerCase()==b.toLowerCase();case"object":return(new RegExp("^("+b.join("|S")+")$","i")).test(a.tagName);default:return!0}}function S(a){while(a&&!a.nextSibling)a=a.parentNode;return a?a.nextSibling:null}function T(a,b){return!b&&a.hasChildNodes()?a.firstChild:S(a)}function U(a){var b=a.previousSibling;if(b){a=b;while(a.hasChildNodes())a=a.lastChild;return a}var c=a.parentNode;return c&&c.nodeType==1?c:null}function V(a){if(!a||a.nodeType!=3)return!1;var b=a.data;if(b==="")return!0;var c=a.parentNode;if(!c||c.nodeType!=1)return!1;var d=F(a.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(b)&&/^(normal|nowrap)$/.test(d)||/^[\t\r ]+$/.test(b)&&d=="pre-line"}function W(a){if(a.data==="")return!0;if(!V(a))return!1;var b=a.parentNode;return b?J(a)?!0:!1:!0}function X(a){var b=a.nodeType;return b==7||b==8||J(a)||/^(script|style)$/i.test(a.nodeName)||K(a)||W(a)}function Y(a,b){var c=a.nodeType;return c==7||c==8||c==1&&I(a,b)=="none"}function Z(){this.store={}}function ab(a,b,c){return function(d){var e=this.cache;if(e.hasOwnProperty(a))return $++,e[a];_++;var f=b.call(this,c?this[c]:this,d);return e[a]=f,f}}function bb(a,b){this.node=a,this.session=b,this.cache=new Z,this.positions=new Z}function kb(a,b){this.offset=b,this.nodeWrapper=a,this.node=a.node,this.session=a.session,this.cache=new Z}function lb(){return"[Position("+f.inspectNode(this.node)+":"+this.offset+")]"}function pb(){return rb(),nb=new ob}function qb(){return nb||pb()}function rb(){nb&&nb.detach(),nb=null}function sb(a,c,d,e){function h(){var a=null,b=null;return c?(b=f,g||(f=f.previousVisible(),g=!f||d&&f.equals(d))):g||(b=f=f.nextVisible(),g=!f||d&&f.equals(d)),g&&(f=null),b}d&&(c?X(d.node)&&(d=a.previousVisible()):X(d.node)&&(d=d.nextVisible()));var f=a,g=!1,i,j=!1;return{next:function(){if(j)return j=!1,i;var a,b;while(a=h()){b=a.getCharacter(e);if(b)return i=a,a}return null},rewind:function(){if(!i)throw b.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");j=!0},dispose:function(){a=d=null}}}function ub(a,b,c){function g(a){var b,c,f=[],g=a?d:e,h=!1,i=!1;while(b=g.next()){c=b.character;if(l.test(c))i&&(i=!1,h=!0);else{if(h){g.rewind();break}i=!0}f.push(b)}return f}function n(a){var b=["["+a.length+"]"];for(var c=0;c<a.length;++c)b.push("(word: "+a[c]+", is word: "+a[c].isWord+")");return b}var d=sb(a,!1,null,b),e=sb(a,!0,null,b),f=c.tokenizer,h=g(!0),i=g(!1).reverse(),j=f(i.concat(h),c),k=h.length?j.slice(tb(j,h[0].token)):[],m=i.length?j.slice(0,tb(j,i.pop().token)+1):[];return{nextEndToken:function(){var a,b;while(k.length==1&&!(a=k[0]).isWord&&(b=g(!0)).length>0)k=f(a.chars.concat(b),c);return k.shift()},previousStartToken:function(){var a,b;while(m.length==1&&!(a=m[0]).isWord&&(b=g(!1)).length>0)m=f(b.reverse().concat(a.chars),c);return m.pop()},dispose:function(){d.dispose(),e.dispose(),k=m=null}}}function vb(a,b,c,f,g){var h=0,i,j=a,k,l,m=Math.abs(c),n;if(c!==0){var o=c<0;switch(b){case d:k=sb(a,o,null,f);while((i=k.next())&&h<m)++h,j=i;l=i,k.dispose();break;case e:var p=ub(a,f,g),q=o?p.previousStartToken:p.nextEndToken;while((n=q())&&h<m)n.isWord&&(++h,j=o?n.chars[0]:n.chars[n.chars.length-1]);break;default:throw new Error("movePositionBy: unit '"+b+"' not implemented")}o?(j=j.previousVisible(),h=-h):j&&j.isLeadingSpace&&(b==e&&(k=sb(a,!1,null,f),l=k.next(),k.dispose()),l&&(j=l.previousVisible()))}return{position:j,unitsMoved:h}}function wb(a,b,c,d){var e=a.getRangeBoundaryPosition(b,!0),f=a.getRangeBoundaryPosition(b,!1),g=d?f:e,h=d?e:f;return sb(g,!!d,h,c)}function xb(a,b,c){var d=[],e=wb(a,b,c),f;while(f=e.next())d.push(f);return e.dispose(),d}function yb(b,c,d){var e=a.createRange(b.node);e.setStartAndEnd(b.node,b.offset,c.node,c.offset);var f=!e.expand("word",d);return e.detach(),f}function zb(a,b,c,d,e){function r(a,b){var c=i[a].previousVisible(),d=i[b-1],f=!e.wholeWordsOnly||yb(c,d,e.wordOptions);return{startPos:c,endPos:d,valid:f}}var f=p(e.direction),g=sb(a,f,a.session.getRangeBoundaryPosition(d,f),e),h="",i=[],j,k,l,m,n,o,q=null;while(j=g.next()){k=j.character,!c&&!e.caseSensitive&&(k=k.toLowerCase()),k=="\u00a0"&&(k=" "),f?(i.unshift(j),h=k+h):(i.push(j),h+=k);if(c){n=b.exec(h);if(n)if(o){l=n.index,m=l+n[0].length;if(!f&&m<h.length||f&&l>0){q=r(l,m);break}}else o=!0}else if((l=h.indexOf(b))!=-1){q=r(l,l+b.length);break}}return o&&(q=r(l,m)),g.dispose(),q}function Ab(a){return function(){var b=!!nb,c=qb(),d=[c].concat(g.toArray(arguments)),e=a.apply(this,d);return b||rb(),e}}function Bb(a,b){return Ab(function(c,e,f,g){typeof f=="undefined"&&(f=e,e=d),g=x(g,C);var h=z(g.characterOptions),i=y(g.wordOptions),j=a;b&&(j=f>=0,this.collapse(!j));var k=vb(c.getRangeBoundaryPosition(this,j),e,f,h,i),l=k.position;return this[j?"setStart":"setEnd"](l.node,l.offset),k.unitsMoved})}function Cb(a){return Ab(function(b,c){c=z(c);var d,e=wb(b,this,c,!a),f=0;while((d=e.next())&&l.test(d.character))++f;e.dispose();var g=f>0;return g&&this[a?"moveStart":"moveEnd"]("character",a?f:-f,{characterOptions:c}),g})}function Db(a){return Ab(function(b,c){var d=!1;return this.changeEachRange(function(b){d=b[a](c)||d}),d})}a.requireModules(["WrappedSelection"]);var c="undefined",d="character",e="word",f=a.dom,g=a.util,h=g.extend,i=f.getBody,j=/^[ \t\f\r\n]+$/,k=/^[ \t\f\r]+$/,l=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,m=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,n=/^[\n-\r\u0085\u2028\u2029]$/,o="en",p=a.Selection.isDirectionBackward,q=!1,r=!1,s=!0;(function(){var b=document.createElement("div");b.contentEditable="true",b.innerHTML="<p>&nbsp; </p><p></p>";var c=i(document),d=b.firstChild,e=a.getSelection();c.appendChild(b),e.collapse(d.lastChild,2),e.setStart(d.firstChild,0),q=(""+e).length==1,b.innerHTML="&nbsp; <br>",e.collapse(b,2),e.setStart(b.firstChild,0),r=(""+e).length==1,c.removeChild(b),e.removeAllRanges()})();var u={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includePreLineTrailingSpace:!0},v={includeBlockContentTrailingSpace:!s,includeSpaceBeforeBr:!r,includePreLineTrailingSpace:!0},w={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:t}},B={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},C={wordOptions:null,characterOptions:null},D={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},E={wordOptions:null,characterOptions:null,direction:"forward"},F=f.getComputedStyleProperty,G;(function(){var a=document.createElement("table"),b=i(document);b.appendChild(a),G=F(a,"display")=="block",b.removeChild(a)})(),a.features.tableCssDisplayBlock=G;var H={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};Z.prototype={get:function(a){return this.store.hasOwnProperty(a)?this.store[a]:null},set:function(a,b){return this.store[a]=b}};var $=0,_=0;a.report=function(){};var cb={getPosition:function(a){var b=this.positions;return b.get(a)||b.set(a,new kb(this,a))},toString:function(){return"[NodeWrapper("+f.inspectNode(this.node)+")]"}};bb.prototype=cb;var db="EMPTY",eb="NON_SPACE",fb="UNCOLLAPSIBLE_SPACE",gb="COLLAPSIBLE_SPACE",hb="TRAILING_SPACE_IN_BLOCK",ib="TRAILING_SPACE_BEFORE_BR",jb="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK";h(cb,{isCharacterDataNode:ab("isCharacterDataNode",f.isCharacterDataNode,"node"),getNodeIndex:ab("nodeIndex",f.getNodeIndex,"node"),getLength:ab("nodeLength",f.getNodeLength,"node"),containsPositions:ab("containsPositions",N,"node"),isWhitespace:ab("isWhitespace",V,"node"),isCollapsedWhitespace:ab("isCollapsedWhitespace",W,"node"),getComputedDisplay:ab("computedDisplay",I,"node"),isCollapsed:ab("collapsed",X,"node"),isIgnored:ab("ignored",Y,"node"),next:ab("nextPos",T,"node"),previous:ab("previous",U,"node"),getTextNodeInfo:ab("textNodeInfo",function(a){var b=null,c=!1,d=F(a.parentNode,"whiteSpace"),e=d=="pre-line";if(e)b=k,c=!0;else if(d=="normal"||d=="nowrap")b=j,c=!0;return{node:a,text:a.data,spaceRegex:b,collapseSpaces:c,preLine:e}},"node"),hasInnerText:ab("hasInnerText",function(a,b){var c=this.session,d=c.getPosition(a.parentNode,this.getNodeIndex()+1),e=c.getPosition(a,0),f=b?d:e,g=b?e:d;while(f!==g){f.prepopulateChar();if(f.isDefinitelyNonEmpty())return!0;f=b?f.previousVisible():f.nextVisible()}return!1},"node"),getTrailingSpace:ab("trailingSpace",function(a){if(a.tagName.toLowerCase()=="br")return"";switch(this.getComputedDisplay()){case"inline":var b=a.lastChild;while(b){if(!Y(b))return b.nodeType==1?this.session.getNodeWrapper(b).getTrailingSpace():"";b=b.previousSibling}break;case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":break;case"table-cell":return"	";default:return this.hasInnerText(!0)?"\n":""}return""},"node"),getLeadingSpace:ab("leadingSpace",function(a){switch(this.getComputedDisplay()){case"inline":case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":case"table-cell":break;default:return this.hasInnerText(!1)?"\n":""}return""},"node")});var mb={character:"",characterType:db,isBr:!1,prepopulateChar:function(){var a=this;if(!a.prepopulatedChar){var b=a.node,c=a.offset,d="",e=db,f=!1;if(c>0)if(b.nodeType==3){var g=b.data,h=g.charAt(c-1),i=a.nodeWrapper.getTextNodeInfo(),j=i.spaceRegex;i.collapseSpaces?j.test(h)?c>1&&j.test(g.charAt(c-2))||(i.preLine&&g.charAt(c)==="\n"?(d=" ",e=jb):(d=" ",e=gb)):(d=h,e=eb,f=!0):(d=h,e=fb,f=!0)}else{var k=b.childNodes[c-1];k&&k.nodeType==1&&!X(k)&&(k.tagName.toLowerCase()=="br"?(d="\n",a.isBr=!0,e=gb,f=!1):a.checkForTrailingSpace=!0);if(!d){var l=b.childNodes[c];l&&l.nodeType==1&&!X(l)&&(a.checkForLeadingSpace=!0)}}a.prepopulatedChar=!0,a.character=d,a.characterType=e,a.isCharInvariant=f}},isDefinitelyNonEmpty:function(){var a=this.characterType;return a==eb||a==fb},resolveLeadingAndTrailingSpaces:function(){this.prepopulatedChar||this.prepopulateChar();if(this.checkForTrailingSpace){var a=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();a&&(this.isTrailingSpace=!0,this.character=a,this.characterType=gb),this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){var b=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();b&&(this.isLeadingSpace=!0,this.character=b,this.characterType=gb),this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(a){var b=this,c;while(b=b.previousVisible()){c=b.getCharacter(a);if(c!=="")return b}return null},getCharacter:function(a){function j(){return h||(g=i.getPrecedingUncollapsedPosition(a),h=!0),g}this.resolveLeadingAndTrailingSpaces();if(this.isCharInvariant)return this.character;var b=["character",a.includeSpaceBeforeBr,a.includeBlockContentTrailingSpace,a.includePreLineTrailingSpace].join("_"),c=this.cache.get(b);if(c!==null)return c;var d="",e=this.characterType==gb,f,g,h=!1,i=this;if(e){if(this.character!=" "||!!j()&&!g.isTrailingSpace&&g.character!="\n")if(this.character=="\n"&&this.isLeadingSpace)j()&&g.character!="\n"&&(d="\n");else{f=this.nextUncollapsed();if(f){f.isBr?this.type=ib:f.isTrailingSpace&&f.character=="\n"&&(this.type=hb);if(f.character==="\n"){if(this.type!=ib||!!a.includeSpaceBeforeBr)if(this.type!=hb||!f.isTrailingSpace||!!a.includeBlockContentTrailingSpace)if(this.type!=jb||f.type!=eb||!!a.includePreLineTrailingSpace)this.character==="\n"?f.isTrailingSpace?this.isTrailingSpace||!this.isBr:d="\n":this.character===" "&&(d=" ")}else d=this.character}}}else this.character!=="\n"||!!(f=this.nextUncollapsed())&&!f.isTrailingSpace;return this.cache.set(b,d),d},equals:function(a){return!!a&&this.node===a.node&&this.offset===a.offset},inspect:lb,toString:function(){return this.character}};kb.prototype=mb,h(mb,{next:ab("nextPos",function(a){var b=a.nodeWrapper,c=a.node,d=a.offset,e=b.session;if(!c)return null;var f,g,h;return d==b.getLength()?(f=c.parentNode,g=f?b.getNodeIndex()+1:0):b.isCharacterDataNode()?(f=c,g=d+1):(h=c.childNodes[d],e.getNodeWrapper(h).containsPositions()?(f=h,g=0):(f=c,g=d+1)),f?e.getPosition(f,g):null}),previous:ab("previous",function(a){var b=a.nodeWrapper,c=a.node,d=a.offset,e=b.session,g,h,i;return d==0?(g=c.parentNode,h=g?b.getNodeIndex():0):b.isCharacterDataNode()?(g=c,h=d-1):(i=c.childNodes[d-1],e.getNodeWrapper(i).containsPositions()?(g=i,h=f.getNodeLength(i)):(g=c,h=d-1)),g?e.getPosition(g,h):null}),nextVisible:ab("nextVisible",function(a){var b=a.next();if(!b)return null;var c=b.nodeWrapper,d=b.node,e=b;return c.isCollapsed()&&(e=c.session.getPosition(d.parentNode,c.getNodeIndex()+1)),e}),nextUncollapsed:ab("nextUncollapsed",function(a){var b=a;while(b=b.nextVisible()){b.resolveLeadingAndTrailingSpaces();if(b.character!=="")return b}return null}),previousVisible:ab("previousVisible",function(a){var b=a.previous();if(!b)return null;var c=b.nodeWrapper,d=b.node,e=b;return c.isCollapsed()&&(e=c.session.getPosition(d.parentNode,c.getNodeIndex())),e})});var nb=null,ob=function(){function a(a){var b=new Z;return{get:function(c){var d=b.get(c[a]);if(d)for(var e=0,f;f=d[e++];)if(f.node===c)return f;return null},set:function(c){var d=c.node[a],e=b.get(d)||b.set(d,[]);e.push(c)}}}function c(){this.initCaches()}var b=g.isHostProperty(document.documentElement,"uniqueID");return c.prototype={initCaches:function(){this.elementCache=b?function(){var a=new Z;return{get:function(b){return a.get(b.uniqueID)},set:function(b){a.set(b.node.uniqueID,b)}}}():a("tagName"),this.textNodeCache=a("data"),this.otherNodeCache=a("nodeName")},getNodeWrapper:function(a){var b;switch(a.nodeType){case 1:b=this.elementCache;break;case 3:b=this.textNodeCache;break;default:b=this.otherNodeCache}var c=b.get(a);return c||(c=new bb(a,this),b.set(c)),c},getPosition:function(a,b){return this.getNodeWrapper(a).getPosition(b)},getRangeBoundaryPosition:function(a,b){var c=b?"start":"end";return this.getPosition(a[c+"Container"],a[c+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}},c}();h(f,{nextNode:T,previousNode:U});var tb=Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:function(a,b){for(var c=0,d=a.length;c<d;++c)if(a[c]===b)return c;return-1};h(a.rangePrototype,{moveStart:Bb(!0,!1),moveEnd:Bb(!1,!1),move:Bb(!0,!0),trimStart:Cb(!0),trimEnd:Cb(!1),trim:Ab(function(a,b){var c=this.trimStart(b),d=this.trimEnd(b);return c||d}),expand:Ab(function(a,b,c){var f=!1;c=x(c,D);var g=z(c.characterOptions);b||(b=d);if(b==e){var h=y(c.wordOptions),i=a.getRangeBoundaryPosition(this,!0),j=a.getRangeBoundaryPosition(this,!1),k=ub(i,g,h),l=k.nextEndToken(),m=l.chars[0].previousVisible(),n,o;if(this.collapsed)n=l;else{var p=ub(j,g,h);n=p.previousStartToken()}return o=n.chars[n.chars.length-1],m.equals(i)||(this.setStart(m.node,m.offset),f=!0),o&&!o.equals(j)&&(this.setEnd(o.node,o.offset),f=!0),c.trim&&(c.trimStart&&(f=this.trimStart(g)||f),c.trimEnd&&(f=this.trimEnd(g)||f)),f}return this.moveEnd(d,1,c)}),text:Ab(function(a,b){return this.collapsed?"":xb(a,this,z(b)).join("")}),selectCharacters:Ab(function(a,b,c,d,e){var f={characterOptions:e};b||(b=i(this.getDocument())),this.selectNodeContents(b),this.collapse(!0),this.moveStart("character",c,f),this.collapse(!0),this.moveEnd("character",d-c,f)}),toCharacterRange:Ab(function(a,b,c){b||(b=i(this.getDocument()));var d=b.parentNode,e=f.getNodeIndex(b),g=f.comparePoints(this.startContainer,this.endContainer,d,e)==-1,h=this.cloneRange(),j,k;return g?(h.setStartAndEnd(this.startContainer,this.startOffset,d,e),j=-h.text(c).length):(h.setStartAndEnd(d,e,this.startContainer,this.startOffset),j=h.text(c).length),k=j+this.text(c).length,{start:j,end:k}}),findText:Ab(function(b,c,d){d=x(d,B),d.wholeWordsOnly&&(d.wordOptions=y(d.wordOptions),d.wordOptions.includeTrailingSpace=!1);var e=p(d.direction),f=d.withinRange;f||(f=a.createRange(),f.selectNodeContents(this.getDocument()));var g=c,h=!1;typeof g=="string"?d.caseSensitive||(g=g.toLowerCase()):h=!0;var i=b.getRangeBoundaryPosition(this,!e),j=f.comparePoint(i.node,i.offset);j===-1?i=b.getRangeBoundaryPosition(f,!0):j===1&&(i=b.getRangeBoundaryPosition(f,!1));var k=i,l=!1,m;for(;;){m=zb(k,g,h,f,d);if(m){if(m.valid)return this.setStartAndEnd(m.startPos.node,m.startPos.offset,m.endPos.node,m.endPos.offset),!0;k=e?m.startPos:m.endPos}else{if(!d.wrap||!!l)return!1;f=f.cloneRange(),k=b.getRangeBoundaryPosition(f,!e),f.setBoundary(i.node,i.offset,e),l=!0}}}),pasteHtml:function(a){this.deleteContents();if(a){var b=this.createContextualFragment(a),c=b.lastChild;this.insertNode(b),this.collapseAfter(c)}}}),h(a.selectionPrototype,{expand:Ab(function(a,b,c){this.changeEachRange(function(a){a.expand(b,c)})}),move:Ab(function(a,b,c,d){var e=0;if(this.focusNode){this.collapse(this.focusNode,this.focusOffset);var f=this.getRangeAt(0);d||(d={}),d.characterOptions=A(d.characterOptions),e=f.move(b,c,d),this.setSingleRange(f)}return e}),trimStart:Db("trimStart"),trimEnd:Db("trimEnd"),trim:Db("trim"),selectCharacters:Ab(function(b,c,d,e,f,g){var h=a.createRange(c);h.selectCharacters(c,d,e,g),this.setSingleRange(h,f)}),saveCharacterRanges:Ab(function(a,b,c){var d=this.getAllRanges(),e=d.length,f=[],g=e==1&&this.isBackward();for(var h=0,i=d.length;h<i;++h)f[h]={characterRange:d[h].toCharacterRange(b,c),backward:g,characterOptions:c};return f}),restoreCharacterRanges:Ab(function(b,c,d){this.removeAllRanges();for(var e=0,f=d.length,g,h,i;e<f;++e)h=d[e],i=h.characterRange,g=a.createRange(c),g.selectCharacters(c,i.start,i.end,h.characterOptions),this.addRange(g,h.backward)}),text:Ab(function(a,b){var c=[];for(var d=0,e=this.rangeCount;d<e;++d)c[d]=this.getRangeAt(d).text(b);return c.join("")})}),a.innerText=function(b,c){var d=a.createRange(b);d.selectNodeContents(b);var e=d.text(c);return d.detach(),e},a.createWordIterator=function(a,b,c){var d=qb();c=x(c,E);var e=z(c.characterOptions),f=y(c.wordOptions),g=d.getPosition(a,b),h=ub(g,e,f),i=p(c.direction);return{next:function(){return i?h.previousStartToken():h.nextEndToken()},dispose:function(){h.dispose(),this.next=function(){}}}},a.noMutation=function(a){var b=qb();a(b),rb()},a.noMutation.createEntryPointFunction=Ab,a.textRange={isBlockNode:L,isCollapsedWhitespaceNode:W,createPosition:Ab(function(a,b,c){return a.getPosition(b,c)})}})

rangy.createModule("CssClassApplier",function(i,v){function r(a,b){return a.className&&RegExp("(?:^|\\s)"+b+"(?:\\s|$)").test(a.className)}function s(a,b){if(a.className)r(a,b)||(a.className+=" "+b);else a.className=b}function o(a){return a.split(/\s+/).sort().join(" ")}function w(a,b){return o(a.className)==o(b.className)}function x(a){for(var b=a.parentNode;a.hasChildNodes();)b.insertBefore(a.firstChild,a);b.removeChild(a)}function y(a,b){var c=a.cloneRange();c.selectNodeContents(b);var d=c.intersection(a);
d=d?d.toString():"";c.detach();return d!=""}function z(a){return a.getNodes([3],function(b){return y(a,b)})}function A(a,b){if(a.attributes.length!=b.attributes.length)return false;for(var c=0,d=a.attributes.length,e,f;c<d;++c){e=a.attributes[c];f=e.name;if(f!="class"){f=b.attributes.getNamedItem(f);if(e.specified!=f.specified)return false;if(e.specified&&e.nodeValue!==f.nodeValue)return false}}return true}function B(a,b){for(var c=0,d=a.attributes.length,e;c<d;++c){e=a.attributes[c].name;if(!(b&&
h.arrayContains(b,e))&&a.attributes[c].specified&&e!="class")return true}return false}function C(a){var b;return a&&a.nodeType==1&&((b=a.parentNode)&&b.nodeType==9&&b.designMode=="on"||k(a)&&!k(a.parentNode))}function D(a){return(k(a)||a.nodeType!=1&&k(a.parentNode))&&!C(a)}function E(a){return a&&a.nodeType==1&&!M.test(p(a,"display"))}function N(a){if(a.data.length==0)return true;if(O.test(a.data))return false;switch(p(a.parentNode,"whiteSpace")){case "pre":case "pre-wrap":case "-moz-pre-wrap":return false;
case "pre-line":if(/[\r\n]/.test(a.data))return false}return E(a.previousSibling)||E(a.nextSibling)}function m(a,b,c,d){var e,f=c==0;if(h.isAncestorOf(b,a))return a;if(h.isCharacterDataNode(b))if(c==0){c=h.getNodeIndex(b);b=b.parentNode}else if(c==b.length){c=h.getNodeIndex(b)+1;b=b.parentNode}else throw v.createError("splitNodeAt should not be called with offset in the middle of a data node ("+c+" in "+b.data);var g;g=b;var j=c;g=h.isCharacterDataNode(g)?j==0?!!g.previousSibling:j==g.length?!!g.nextSibling:
true:j>0&&j<g.childNodes.length;if(g){if(!e){e=b.cloneNode(false);for(e.id&&e.removeAttribute("id");f=b.childNodes[c];)e.appendChild(f);h.insertAfter(e,b)}return b==a?e:m(a,e.parentNode,h.getNodeIndex(e),d)}else if(a!=b){e=b.parentNode;b=h.getNodeIndex(b);f||b++;return m(a,e,b,d)}return a}function F(a){var b=a?"nextSibling":"previousSibling";return function(c,d){var e=c.parentNode,f=c[b];if(f){if(f&&f.nodeType==3)return f}else if(d)if((f=e[b])&&f.nodeType==1&&e.tagName==f.tagName&&w(e,f)&&A(e,f))return f[a?
"firstChild":"lastChild"];return null}}function t(a){this.firstTextNode=(this.isElementMerge=a.nodeType==1)?a.lastChild:a;this.textNodes=[this.firstTextNode]}function q(a,b,c){this.cssClass=a;var d,e,f=null;if(typeof b=="object"&&b!==null){c=b.tagNames;f=b.elementProperties;for(d=0;e=P[d++];)if(b.hasOwnProperty(e))this[e]=b[e];d=b.normalize}else d=b;this.normalize=typeof d=="undefined"?true:d;this.attrExceptions=[];d=document.createElement(this.elementTagName);this.elementProperties={};for(var g in f)if(f.hasOwnProperty(g)){if(G.hasOwnProperty(g))g=
G[g];d[g]=f[g];this.elementProperties[g]=d[g];this.attrExceptions.push(g)}this.elementSortedClassName=this.elementProperties.hasOwnProperty("className")?o(this.elementProperties.className+" "+a):a;this.applyToAnyTagName=false;a=typeof c;if(a=="string")if(c=="*")this.applyToAnyTagName=true;else this.tagNames=c.toLowerCase().replace(/^\s\s*/,"").replace(/\s\s*$/,"").split(/\s*,\s*/);else if(a=="object"&&typeof c.length=="number"){this.tagNames=[];d=0;for(a=c.length;d<a;++d)if(c[d]=="*")this.applyToAnyTagName=
true;else this.tagNames.push(c[d].toLowerCase())}else this.tagNames=[this.elementTagName]}i.requireModules(["WrappedSelection","WrappedRange"]);var h=i.dom,H=function(){function a(b,c,d){return c&&d?" ":""}return function(b,c){if(b.className)b.className=b.className.replace(RegExp("(?:^|\\s)"+c+"(?:\\s|$)"),a)}}(),p;if(typeof window.getComputedStyle!="undefined")p=function(a,b){return h.getWindow(a).getComputedStyle(a,null)[b]};else if(typeof document.documentElement.currentStyle!="undefined")p=function(a,
b){return a.currentStyle[b]};else v.fail("No means of obtaining computed style properties found");var k;(function(){k=typeof document.createElement("div").isContentEditable=="boolean"?function(a){return a&&a.nodeType==1&&a.isContentEditable}:function(a){if(!a||a.nodeType!=1||a.contentEditable=="false")return false;return a.contentEditable=="true"||k(a.parentNode)}})();var M=/^inline(-block|-table)?$/i,O=/[^\r\n\t\f \u200B]/,Q=F(false),R=F(true);t.prototype={doMerge:function(){for(var a=[],b,c,d=0,
e=this.textNodes.length;d<e;++d){b=this.textNodes[d];c=b.parentNode;a[d]=b.data;if(d){c.removeChild(b);c.hasChildNodes()||c.parentNode.removeChild(c)}}return this.firstTextNode.data=a=a.join("")},getLength:function(){for(var a=this.textNodes.length,b=0;a--;)b+=this.textNodes[a].length;return b},toString:function(){for(var a=[],b=0,c=this.textNodes.length;b<c;++b)a[b]="'"+this.textNodes[b].data+"'";return"[Merge("+a.join(",")+")]"}};var P=["elementTagName","ignoreWhiteSpace","applyToEditableOnly"],
G={"class":"className"};q.prototype={elementTagName:"span",elementProperties:{},ignoreWhiteSpace:true,applyToEditableOnly:false,hasClass:function(a){return a.nodeType==1&&h.arrayContains(this.tagNames,a.tagName.toLowerCase())&&r(a,this.cssClass)},getSelfOrAncestorWithClass:function(a){for(;a;){if(this.hasClass(a,this.cssClass))return a;a=a.parentNode}return null},isModifiable:function(a){return!this.applyToEditableOnly||D(a)},isIgnorableWhiteSpaceNode:function(a){return this.ignoreWhiteSpace&&a&&
a.nodeType==3&&N(a)},postApply:function(a,b,c){for(var d=a[0],e=a[a.length-1],f=[],g,j=d,I=e,J=0,K=e.length,n,L,l=0,u=a.length;l<u;++l){n=a[l];if(L=Q(n,!c)){if(!g){g=new t(L);f.push(g)}g.textNodes.push(n);if(n===d){j=g.firstTextNode;J=j.length}if(n===e){I=g.firstTextNode;K=g.getLength()}}else g=null}if(a=R(e,!c)){if(!g){g=new t(e);f.push(g)}g.textNodes.push(a)}if(f.length){l=0;for(u=f.length;l<u;++l)f[l].doMerge();b.setStart(j,J);b.setEnd(I,K)}},createContainer:function(a){a=a.createElement(this.elementTagName);
i.util.extend(a,this.elementProperties);s(a,this.cssClass);return a},applyToTextNode:function(a){var b=a.parentNode;if(b.childNodes.length==1&&h.arrayContains(this.tagNames,b.tagName.toLowerCase()))s(b,this.cssClass);else{b=this.createContainer(h.getDocument(a));a.parentNode.insertBefore(b,a);b.appendChild(a)}},isRemovable:function(a){var b;if(b=a.tagName.toLowerCase()==this.elementTagName){if(b=o(a.className)==this.elementSortedClassName){var c;a:{b=this.elementProperties;for(c in b)if(b.hasOwnProperty(c)&&
a[c]!==b[c]){c=false;break a}c=true}b=c&&!B(a,this.attrExceptions)&&this.isModifiable(a)}b=b}return b},undoToTextNode:function(a,b,c){if(!b.containsNode(c)){a=b.cloneRange();a.selectNode(c);if(a.isPointInRange(b.endContainer,b.endOffset)){m(c,b.endContainer,b.endOffset,[b]);b.setEndAfter(c)}if(a.isPointInRange(b.startContainer,b.startOffset))c=m(c,b.startContainer,b.startOffset,[b])}this.isRemovable(c)?x(c):H(c,this.cssClass)},applyToRange:function(a){a.splitBoundaries();var b=z(a);if(b.length){for(var c,
d=0,e=b.length;d<e;++d){c=b[d];!this.isIgnorableWhiteSpaceNode(c)&&!this.getSelfOrAncestorWithClass(c)&&this.isModifiable(c)&&this.applyToTextNode(c)}a.setStart(b[0],0);c=b[b.length-1];a.setEnd(c,c.length);this.normalize&&this.postApply(b,a,false)}},applyToSelection:function(a){a=a||window;a=i.getSelection(a);var b,c=a.getAllRanges();a.removeAllRanges();for(var d=c.length;d--;){b=c[d];this.applyToRange(b);a.addRange(b)}},undoToRange:function(a){a.splitBoundaries();var b=z(a),c,d,e=b[b.length-1];if(b.length){for(var f=
0,g=b.length;f<g;++f){c=b[f];(d=this.getSelfOrAncestorWithClass(c))&&this.isModifiable(c)&&this.undoToTextNode(c,a,d);a.setStart(b[0],0);a.setEnd(e,e.length)}this.normalize&&this.postApply(b,a,true)}},undoToSelection:function(a){a=a||window;a=i.getSelection(a);var b=a.getAllRanges(),c;a.removeAllRanges();for(var d=0,e=b.length;d<e;++d){c=b[d];this.undoToRange(c);a.addRange(c)}},getTextSelectedByRange:function(a,b){var c=b.cloneRange();c.selectNodeContents(a);var d=c.intersection(b);d=d?d.toString():
"";c.detach();return d},isAppliedToRange:function(a){if(a.collapsed)return!!this.getSelfOrAncestorWithClass(a.commonAncestorContainer);else{for(var b=a.getNodes([3]),c=0,d;d=b[c++];)if(!this.isIgnorableWhiteSpaceNode(d)&&y(a,d)&&this.isModifiable(d)&&!this.getSelfOrAncestorWithClass(d))return false;return true}},isAppliedToSelection:function(a){a=a||window;a=i.getSelection(a).getAllRanges();for(var b=a.length;b--;)if(!this.isAppliedToRange(a[b]))return false;return true},toggleRange:function(a){this.isAppliedToRange(a)?
this.undoToRange(a):this.applyToRange(a)},toggleSelection:function(a){this.isAppliedToSelection(a)?this.undoToSelection(a):this.applyToSelection(a)},detach:function(){}};q.util={hasClass:r,addClass:s,removeClass:H,hasSameClasses:w,replaceWithOwnChildren:x,elementsHaveSameNonClassAttributes:A,elementHasNonClassAttributes:B,splitNodeAt:m,isEditableElement:k,isEditingHost:C,isEditable:D};i.CssClassApplier=q;i.createCssClassApplier=function(a,b,c){return new q(a,b,c)}});

rangy.createModule("Commands",function(e,m){function f(l){return l&&1==l.nodeType&&l.isContentEditable}function h(l,a){var c;!(c=!a||!a.applyToEditableOnly)&&(c=f(l)||f(l.parentNode))&&(c=!(l&&(9==l.nodeType&&"on"==l.designMode||f(l)&&!f(l.parentNode))));return c}function g(l,a){var c=r.comparePoints(l,0,a.startContainer,a.startOffset),b=r.comparePoints(l,r.getNodeLength(l),a.endContainer,a.endOffset);return G(l)==G(a.startContainer)&&1==c&&-1==b}function c(l,a){if(g(l,a))return!0;var b=r.isCharacterDataNode(l);
if(l==a.startContainer&&b&&r.getNodeLength(l)!=a.startOffset||l==a.endContainer&&b&&0!=a.endOffset)return!0;var b=l.childNodes,d=b.length;if(0!=d){for(var e=0;e<d;++e)if(!c(b[e],a))return!1;return!0}return!1}function a(l){var a;return"undefined"==typeof(a=l.namespaceURI)||null===a||"http://www.w3.org/1999/xhtml"==a}function b(l){return r.isCharacterDataNode(l)||1==l.nodeType&&q.test(H(l,"display"))}function d(l){return b(l)&&"br"!=l.nodeName.toLowerCase()}function n(l,b){if(!l||1!=l.nodeType||!a(l))return!1;
switch(typeof b){case "string":return l.tagName.toLowerCase()==b.toLowerCase();case "object":return(new RegExp("^("+b.join(",")+")$","i")).test(l.tagName);default:return!0}}function u(l,a){return n(l)?b(l)&&h(l,a)?p.test(l.tagName):!0:!1}function M(l,a){return 8==l.nodeType||3==l.nodeType&&(l.parentNode&&/^(script|style)$/i.test(l.parentNode.tagName)||a.ignoreWhiteSpace&&!/[^\r\n\t ]/.test(l.data)&&(u(l.previousSibling,a)||u(l.nextSibling,a)))?!0:!1}function N(l,a){if(!n(l))return!1;if(a&&a.command.isModifiableElement)return a.command.isModifiableElement(el,
a);var b=l.tagName.toLowerCase();if(x.test(b))b=["style","class"];else if("a"==b)b=["style","class","href"];else if("font"==b)b=["style","class","color","face","size"];else return!1;a:{for(var c=0,d=l.attributes.length,e;c<d;++c)if(e=l.attributes[c].name,l.attributes[c].specified&&(!b||!r.arrayContains(b,e))){b=!1;break a}b=!0}return b}function v(l,a){if(!n(l))return!1;if(a&&a.command.isSimpleModifiableElement)return a.command.isSimpleModifiableElement(l,a);var b=l.tagName.toLowerCase();if(!y.test(b))return!1;
for(var c,d=!1,e=0,k=l.attributes.length;e<k;++e)if(l.attributes[e].specified){if(d)return!1;c=l.attributes[e].name;l.getAttribute(c);d=!0}return!d||"style"==c&&0==l.style.cssText.length||"a"==b&&"href"==c||"font"==b&&/^(color|face|size)$/.test(c)?!0:"style"!=c||"number"==typeof l.style.length&&1<l.style.length||!/^[a-z\-]+:[^;]+;?\s?$/i.test(l.style.cssText)?!1:("b"==b||"strong"==b)&&""!=l.style.fontWeight||("i"==b||"em"==b)&&""!=l.style.fontStyle||("sub"==b||"sup"==b)&&""!=l.style.verticalAlign||
("span"==b||"font"==b)&&""!=l.style.fontSize||("a"==b||"font"==b||"span"==b)&&""==l.style.textDecoration||("h1"==b||"h2"==b||"h3"==b||"p"==b||"td"==b)&&""!=l.style.textAlign||/^(a|font|s|span|strike|u|del)$/.test(b)&&/^(line-through|underline|overline|none)$/.test(l.style.textDecoration)?!0:!1}function B(b,a,c,d){-1==c&&(c=a.childNodes.length);for(var e=b.parentNode,k=r.getNodeIndex(b),g=[],n=0,p=d.length;n<p;++n){var q=d[n],u=q.startContainer,f=q.startOffset,x=q.endContainer,h=q.endOffset,A=u,y=
f,m=x,t=h;u==a&&f>c&&y++;x==a&&h>c&&t++;u!=e||f!=k&&f!=k+1||(A=a,y+=c-k);x!=e||h!=k&&h!=k+1||(m=a,t+=c-k);u==e&&f>k+1&&y--;x==e&&h>k+1&&t--;A==u&&y==f&&m==x&&t==h&&g.push([q,A,y,m,t])}a.childNodes.length==c?a.appendChild(b):a.insertBefore(b,a.childNodes[c]);for(b=0;a=g[b++];){try{a[0].setStart(a[1],a[2])}catch(N){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}try{a[0].setEnd(a[3],a[4])}catch(M){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}}function Q(a,b){b=b||[];for(var c;c=
a.next();)a.isPartiallySelectedSubtree()?(c=a.getSubtreeIterator(),Q(c,b),c.detach(!0)):b.push(c);return b}function I(a,b,c,d,e){for(var k,g=[];k=a.firstChild;)B(k,b,c++,e),g.push(k);d&&a.parentNode.removeChild(a);return g}function J(a,b){return I(a,a.parentNode,r.getNodeIndex(a),!0,b)}function P(a,b){for(var c=a.attributes,d=0,e=c.length;d<e;++d)c[d].specified&&("style"==c[d].name?b.style.cssText=b.style.cssText:b.setAttribute(c[d].name,c[d].value))}function O(a,b){var c=b.command,d=b.rangesToPreserve;
if(null===c.getSpecifiedValue(a,b))return[];if(v(a,b))return J(a,d);c.clearValue&&c.clearValue(a,b);null!==c.relevantCssProperty&&(a.style[c.relevantCssProperty]="",""==a.style.cssText&&a.removeAttribute("style"));if(null===c.getSpecifiedValue(a,b))return[];c=r.getDocument(a).createElement("span");P(a,c);a.parentNode.insertBefore(c,a);I(a,c,0,!0,d);return[c]}function t(a,b,c){return null===b||null===c?b===c:a.valuesEqual(b,c)}function w(a,b){var c=1==a.nodeType;return c||a.parentNode&&1==a.parentNode.nodeType?
c?b.command.getEffectiveValue(a,b):w(a.parentNode,b):null}function K(a,c,d,e){var k=a[0],g=e.options;e=e.rangesToPreserve;var p,q;if(!a.length||!h(k,g))return null;var f=a[a.length-1];b(f)&&!n(f,"br")&&n(f.nextSibling,"br")&&a.push(f.nextSibling);var u=k.previousSibling,x=f.nextSibling;d=h(u,g)&&c(u)?u:h(x,g)&&c(x)?x:d();if(!d)return null;var u=r.getDocument(d),A=d.parentNode,x=k.parentNode;if(!A)for(x.insertBefore(d,k),p=0;q=e[p++];)q.startContainer==A&&q.startOffset==r.getNodeIndex(d)&&q.setStart(q.startContainer,
q.startOffset+1),q.endContainer==A&&q.endOffset==r.getNodeIndex(d)&&q.setEnd(q.endContainer,q.endOffset+1);p=d.parentNode;q=k.parentNode;p=p&&q?-1==r.comparePoints(d.parentNode,r.getNodeIndex(d),k.parentNode,r.getNodeIndex(k)):!p;if(p)for(!b(d)&&b(d.lastChild)&&b(k)&&!n(d.lastChild,"br")&&d.appendChild(u.createElement("br")),p=0,k=a.length;p<k;++p)B(a[p],d,-1,e);else for(!b(d)&&b(d.firstChild)&&b(f)&&!n(f,"br")&&d.insertBefore(u.createElement("br"),d.firstChild),p=a.length-1;0<=p;p--)B(a[p],d,0,e);
h(x,g)&&!x.hasChildNodes()&&x.parentNode.removeChild(x);a=d.nextSibling;if(h(a,g)&&c(a)){for(!b(d)&&b(d.lastChild)&&b(a.firstChild)&&!n(d.lastChild,"br")&&d.appendChild(u.createElement("br"));a.hasChildNodes();)B(a.firstChild,d,-1,e);d.parentNode.removeChild(a)}if(d&&1==d.nodeType&&!b(d)){c=d.previousSibling;var y;n(c,"br")&&b(y=d.previousSibling.previousSibling)&&!n(y,"br")&&d.parentNode.removeChild(c)}if(d&&1==d.nodeType&&!b(d)){y=d.lastChild;var m;2<=d.childNodes.length&&n(d.lastChild,"br")&&b(m=
d.lastChild.previousSibling)&&!n(m,"br")&&d.removeChild(y)}return d}function z(a,b,c,d,e){for(var k=a[e],g=d.rangesToPreserve;N(k,d)&&1==k.childNodes.length&&N(k.firstChild,d)&&(!v(k,d)||!t(b,b.getSpecifiedValue(k,d),c));)k=k.firstChild;v(k,d)&&t(b,b.getSpecifiedValue(k,d),c)&&t(b,w(k,d),c)&&k!=a[e]&&(I(k,k.parentNode,r.getNodeIndex(k),!1,g),a.parentNode.insertBefore(k,a[e]),B(k.nextSibling,k,k.childNodes.length,g))}function D(a,b,c){if(-1==",br,".indexOf(","+a.nodeName.toLowerCase()+",")){var d,
k,e,g;g=a.nodeType;var n=c.command;d=c.rangesToPreserve;k=c.options;if(a.parentNode&&null!==b){/^(1|3|4|7)$/.test(""+g)&&!u(a,k)&&(z(a,n,b,c,"previousSibling"),z(a,n,b,c,"nextSibling"),K([a],function(a){return v(a,c)&&t(n,n.getSpecifiedValue(a,c),b)&&t(n,w(a,c),b)},function(){return null},c));var p=!1;try{if(e=!1,"fontSize"==n.relevantCssProperty&&(e=!0),0==e&&DEXTTOP.DEXT5.browser.ie&&"fontFamily"==n.relevantCssProperty&&(e=!0),e&&t(n,w(a,c),b)){e=!1;for(var q=a;;)if(3==q.nodeType)q=q.parentNode;
else if(1==q.nodeType){if(""!=q.style[n.relevantCssProperty]){e=!0;break}if(q.tagName&&"BODY"==q.tagName)break;q=q.parentNode}else break;p=1==e?!1:!0}}catch(f){p=!1}if(p||!t(n,w(a,c),b))if(u(a,k)){if("colgroup"!=a.tagName.toLowerCase()){g=[];k=0;e=a.childNodes.length;for(q=null;k<e;++k){d=a.childNodes[k];if(1==d.nodeType&&(q=n.getSpecifiedValue(d,c),null!==q&&(p||!t(n,b,q))))continue;g.push(d)}"1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag&&1>=a.childNodes.length&&(""==a.innerHTML||"<br>"==
a.innerHTML)&&("<br>"==a.innerHTML?DEXTTOP.DEXT5.browser.safari||"windows"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()?a.childNodes[0]||(p=document.createElement("br"),a.appendChild(p)):(p=document.createTextNode("\u200b"),a.childNodes[0]?(d=a.childNodes[0],a.insertBefore(p,d),a.removeChild(d)):a.appendChild(p)):(p=document.createTextNode("\u200b"),a.appendChild(p)),g.push(a.childNodes[0]));for(k=0;d=g[k++];)D(d,b,c)}}else if(4!=g&&7!=g&&(p||!t(n,w(a,c),b)))if(e=null,1==g&&"span"==a.nodeName.toLowerCase()&&
n.relevantCssProperty&&-1<",color,backgroundColor,fontFamily,fontSize,".indexOf(","+n.relevantCssProperty+","))a.style[n.relevantCssProperty]=b;else if(!k.styleWithCss&&n.createNonCssElement&&(e=n.createNonCssElement(a,b,c)),e||(e=n.createCssElement?n.createCssElement(r.getDocument(a),c):r.getDocument(a).createElement("span")),a.parentNode.insertBefore(e,a),k=n.relevantCssProperty,null===k||!p&&t(n,w(e,c),b)||(e.style[k]=b),n.styleCssElement&&n.styleCssElement(e,b),B(a,e,e.childNodes.length,d),1==
g&&(p||!t(n,w(a,c),b)))if(B(a,e.parentNode,r.getNodeIndex(e),d),e.parentNode.removeChild(e),"span"==e.tagName.toLowerCase()&&(n.hasSpecialSpanStyling&&n.hasSpecialSpanStyling(b)||null!==k))null!==k&&(a.style[k]=b),n.styleSpanChildElement&&n.styleSpanChildElement(a,b);else{g=[];k=0;for(e=a.childNodes.length;k<e;++k){d=a.childNodes[k];if(1==d.nodeType&&(q=n.getSpecifiedValue(d,c),null!==q&&(p||!t(n,b,q))))continue;g.push(d)}k=0;for(e=g.length;k<e;++k)D(g[k],b,c)}}}}function L(a,b){for(var c=k(a.childNodes),
d=0,e=c.length;d<e;++d)E(c[d],b)}function E(a,b){var c,d;c=a.nodeType;if(9==c)for(c=0;c<a.childNodes.length;++c){if(d=a.childNodes[c],1==d.nodeType){E(d,b);break}}else if(11==c)L(a,b);else if(a.parentNode&&10!=c&&!M(a,b.options)){if(h(a,b.options)){try{if(d=DEXTTOP.G_CURREDITOR._config.keepFontFamily,"fontFamily"==b.command.relevantCssProperty&&0<d.length&&1==c&&-1<d.indexOf(a.style.fontFamily.toLowerCase()))return}catch(e){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}if(1==c){var n=O(a,
b);c=0;for(d=n.length;c<d;++c)E(n[c],b);if(!a.parentNode)return}c=b.command;var g=b.value,n=b.options;if((d=a.parentNode)&&1==d.nodeType&&!t(c,w(a,b),g)){var p=d;for(d=[];h(p,n)&&1==p.nodeType&&!t(c,w(p,b),g);)d.push(p),p=p.parentNode;if(0!=d.length){var n=d[d.length-1],q=c.getSpecifiedValue(n,b);if(null!==q||q==g)if(null===g||t(c,w(n.parentNode,b),g))for(;d.length;){p=d.pop();null!==c.getSpecifiedValue(p,b)&&(q=c.getSpecifiedValue(p,b));g=k(p.childNodes);null!==c.getSpecifiedValue(p,b)&&O(p,b);for(var p=
0,f;f=g[p++];)f!=a&&(1!=f.nodeType||null===c.getSpecifiedValue(f,b)||t(c,q,c.getSpecifiedValue(f,b)))&&f!=n&&D(f,q,b)}}}D(a,b.value,b)}L(a,b)}}function C(){}function F(a){var b=a.toLowerCase();if(A.hasOwnProperty(b))return A[b];throw m.createError("getCommand(): No command registered with the name '"+a+"'");}e.requireModules(["WrappedSelection","WrappedRange"]);var r=e.dom,G=r.getRootContainer,H;"undefined"!=typeof window.getComputedStyle?H=function(a,b){var c=r.getWindow(a).getComputedStyle(a,null)[b];
if("fontSize"==b)try{-1<c.indexOf("px")&&"undefined"!=typeof document.documentElement.currentStyle?c=a.currentStyle[b]:a.style&&a.style.fontSize&&-1<a.style.fontSize.indexOf("pt")&&(c=a.style.fontSize)}catch(d){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}else if("backgroundColor"==b&&"transparent"==c&&a.parentNode)try{if(1!=a.nodeType||"html"!=a.nodeName.toLowerCase()&&"body"!=a.nodeName.toLowerCase())c=r.getWindow(a.parentNode).getComputedStyle(a.parentNode,null)[b]}catch(k){"undefined"!=
typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}return c}:"undefined"!=typeof document.documentElement.currentStyle?H=function(a,b){return a.currentStyle[b]}:m.fail("No means of obtaining computed style properties found");var k;(function(){var a=document.createElement("div");a.appendChild(document.createElement("span"));var b=Array.prototype.slice;try{1==b.call(a.childNodes,0)[0].nodeType&&(k=function(a){return b.call(a,0)})}catch(c){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}k||(k=function(a){for(var b=
0,c=a.length,d=[];b<c;++b)d[b]=a[b];return d})})();var p=/^(h[1-6]|p|hr|pre|blockquote|ol|ul|li|dl|dt|dd|div|table|caption|colgroup|col|tbody|thead|tfoot|tr|th|td|address|img)$/i,q=/^inline(-block|-table)?$/i,x=/^(b|em|i|s|span|strike|strong|sub|sup|u|del)$/,y=/^(b|em|i|s|span|strike|strong|sub|sup|u|del|a|font|h1|h2|h3|h4|h5|h6|p|hr|pre|blockquote|ol|ul|li|dl|dt|dd|div|table|caption|colgroup|col|tbody|thead|tfoot|tr|th|td|address)$/;C.prototype={relevantCssProperty:null,getSpecifiedValue:function(){return null},
clearValue:function(){},getEffectiveValue:function(a,b){return H(a,this.relevantCssProperty)},createCssElement:null,createNonCssElement:null,styleCssElement:null,hasSpecialSpanStyling:null,styleSpanChildElement:null,isSimpleModifiableElement:null,defaultOptions:null,addDefaultOptions:null,valuesEqual:function(a,b){return a===b},createContext:function(a,b,c){var d=this.defaultOptions;if(d)for(var k in d)d.hasOwnProperty(k)&&!c.hasOwnProperty(k)&&(c[k]=d[k]);return{command:this,value:a,rangesToPreserve:b||
[],options:c||{}}},getSelectionValue:function(){return null},getNewRangeValue:function(){return null},getNewSelectionValue:function(){return null},applyToRange:function(a,b,c,d){a=this.createContext(b,[d],c);a.value=this.getNewRangeValue(d,a);this.applyValueToRange(d,a)},applyToSelection:function(a,b,c){a=r.getWindow(a);a=e.getSelection(a);var d=a.getAllRanges();b=this.createContext(b,d,c);b.value=this.getNewSelectionValue(a,b);c=0;for(var k=d.length;c<k;++c)this.applyValueToRange(d[c],b);a.setRanges(d)}};
C.util={getComputedStyleProperty:H,getFurthestAncestor:function(a){for(;null!=a.parentNode;)a=a.parentNode;return a},isContained:g,isEffectivelyContained:c,isHtmlNode:a,isHtmlElement:n,isInlineNode:b,isUnwrappable:u,blockExtend:function(a){for(var b=a.startContainer,c=a.startOffset,k=a.endContainer,e=a.endOffset,n,g;;)if(r.isCharacterDataNode(b)||0==c)c=r.getNodeIndex(b),b=b.parentNode;else if(c==r.getNodeLength(b))c=1+r.getNodeIndex(b),b=b.parentNode;else if((n=b.childNodes[c])&&d(n)&&d(n.previousSibling))c--;
else break;for(;;)if(0==e)e=r.getNodeIndex(k),k=k.parentNode;else if(r.isCharacterDataNode(k)||e==r.getNodeLength(k))e=1+r.getNodeIndex(k),k=k.parentNode;else if((g=k.childNodes[e])&&d(g)&&d(g.previousSibling))e++;else break;a=a.cloneRange();a.setStart(b,c);a.setEnd(k,e);return a},isModifiableElement:N,isSimpleModifiableElement:v,moveChildrenPreservingRanges:I,replaceWithOwnChildren:J,copyAttributes:P,getEffectiveValue:w,getEffectiveTextNodes:function(a,b){return a.getNodes([3],function(d){return c(d,
a)&&!M(d,b.options)})},setNodeValue:E,wrap:K,decomposeRange:function(a,b){if(a.startContainer==a.endContainer&&a.startOffset==a.endOffset)return[];a.splitBoundaries(b);for(var c=a.cloneRange();0==c.startOffset&&c.startContainer.parentNode;)c.setStart(c.startContainer.parentNode,r.getNodeIndex(c.startContainer));for(;c.endOffset==r.getNodeLength(c.endContainer)&&c.endContainer.parentNode;)c.setEnd(c.endContainer.parentNode,1+r.getNodeIndex(c.endContainer));var c=new rangy.DomRange.RangeIterator(c,
!1),d=Q(c);c.detach();return d},setGlobalOption:function(a,b){}};C.create=function(a,b){var c=new C;a.prototype=c;if("object"==typeof b)for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d])};var A={};e.registerCommand=function(a,b){if(!(b instanceof C))throw m.createError("registerCommand(): Object supplied is not a Command");A[a.toLowerCase()]=b};e.execCommand=function(a,b,c){b=b||{};var d=b.hasOwnProperty("document")?b.document:document,k=b.hasOwnProperty("value")?b.value:null;a=F(a);c?a.applyToRange(d,
k,b,c):a.applyToSelection(d,k,b)};e.queryCommandValue=function(a,b,c){b=b||{};var d=b.hasOwnProperty("document")?r.getWindow(b.document):window;c=b.hasOwnProperty("value")?b.value:null;a=F(a);d=e.getSelection(d);b=a.createContext(c,null,b);return a.getSelectionValue(d,b)};e.getCommand=F;e.Command=C});function getRangeCorrectly(e,m){var f=[];try{for(var h=m.startContainer,g=m.endContainer,c=e.length,a=!1,b=0;b<c;b++)a=!1,0==b&&1<c?3==h.nodeType&&m.startOffset==h.length&&(a=!0):b==c-1&&1<c&&3==g.nodeType&&0==m.endOffset&&(a=!0),0==a&&f.push(e[b])}catch(d){return e}return f}
function convertRgbToHex(e){return"black"==e.toLowerCase()?"#000000":e.replace(/(?:rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\))/gi,function(e,f,h,g){e=[f,h,g];for(f=0;3>f;f++)e[f]=("0"+parseInt(e[f],10).toString(16)).slice(-2);return"#"+e.join("")})}function getChildToArray(e){var m=[];e=e.childNodes;for(var f=0,h=e.length;f<h;f++)m.push(e[f]);return m}
function checkSameParent(e){var m=null,f=!1;e&&e[0].parentNode&&"span"==e[0].parentNode.nodeName.toLowerCase()&&(f=!0);if(f)for(var h=0,g=e.length;h<g;++h){if(m&&m!=e[h].parentNode){f=!1;break}m=e[h].parentNode}if(f)for(var c=m.childNodes,h=0,g=c.length;h<g;++h)if((1!=c[h].nodeType||"br"!=c[h].nodeName.toLowerCase())&&-1==e.indexOf(c[h])){f=!1;break}return f?(e=[],e.push(m),e):null}
rangy.createModule("BoldCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{relevantCssProperty:"fontWeight",defaultOptions:{tagName:"b",ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.fontWeight||(/^(strong|b)$/i.test(c.tagName)?"bold":null)},valuesEqual:function(c,a){c=(""+c).toLowerCase();a=(""+a).toLowerCase();return c==a||"bold"==c&&"700"==a||"bold"==a&&"700"==c||"normal"==c&&"400"==a||"normal"==a&&"400"==c},createNonCssElement:function(c,
a,b){return"bold"==a||"700"==a?h.getDocument(c).createElement(b.options.tagName):null},isBoldCssValue:function(c){return/^(bold|700|800|900)$/.test(c)},getRangeValue:function(c,a){var b=g.getEffectiveTextNodes(c,a),d=b.length,e;if(0==b.length)return this.isBoldCssValue(g.getEffectiveValue(c.commonAncestorContainer,a));for(;d--;)if(e=g.getEffectiveValue(b[d],a),!this.isBoldCssValue(e))return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],
a))return!1;return 0<e},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"normal":"bold"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"normal":"bold"},applyValueToRange:function(c,a){for(var b=g.decomposeRange(c,a.rangesToPreserve),b=getRangeCorrectly(b,a.rangesToPreserve[0]),d=0,e=b.length;d<e;++d)g.setNodeValue(b[d],a)}});e.registerCommand("bold",new f)});
rangy.createModule("ItalicCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{relevantCssProperty:"fontStyle",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.fontStyle||(/^(em|i)$/i.test(c.tagName)?"italic":null)},createNonCssElement:function(c,a){return"italic"==a?h.getDocument(c).createElement("i"):null},getRangeValue:function(c,a){var b=g.getEffectiveTextNodes(c,a),d=b.length,e;if(0==b.length)return"italic"==
g.getEffectiveValue(c.commonAncestorContainer,a);for(;d--;)if(e=g.getEffectiveValue(b[d],a),"italic"!=e)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],a))return!1;return 0<e},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"normal":"italic"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"normal":"italic"},applyValueToRange:function(c,a){for(var b=g.decomposeRange(c,a.rangesToPreserve),
b=getRangeCorrectly(b,a.rangesToPreserve[0]),d=0,e=b.length;d<e;++d)g.setNodeValue(b[d],a)}});e.registerCommand("italic",new f)});
rangy.createModule("UnderlineCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{relevantCssProperty:"textDecoration",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.textDecoration||(/^(u)$/i.test(c.tagName)?"underline":null)},createNonCssElement:function(c,a){return"underline"==a?h.getDocument(c).createElement("u"):null},getRangeValue:function(c,a){var b=g.getEffectiveTextNodes(c,a),d=b.length,e;if(0==
b.length)return"underline"==g.getEffectiveValue(c.commonAncestorContainer,a);for(;d--;)if(e=g.getEffectiveValue(b[d],a),"underline"!=e)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],a))return!1;return 0<e},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"none":"underline"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"none":"underline"},applyValueToRange:function(c,a){for(var b=
g.decomposeRange(c,a.rangesToPreserve),b=getRangeCorrectly(b,a.rangesToPreserve[0]),d=0,e=b.length;d<e;++d)g.setNodeValue(b[d],a)}});e.registerCommand("underline",new f)});
rangy.createModule("StrikeThroughCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{relevantCssProperty:"textDecoration",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.textDecoration||(/^(strike|del)$/i.test(c.tagName)?"line-through":null)},createNonCssElement:function(c,a){return"line-through"==a?h.getDocument(c).createElement("strike"):null},getRangeValue:function(c,a){var b=g.getEffectiveTextNodes(c,
a),d=b.length,e;if(0==b.length)return"line-through"==g.getEffectiveValue(c.commonAncestorContainer,a);for(;d--;)if(e=g.getEffectiveValue(b[d],a),"line-through"!=e)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],a))return!1;return 0<e},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"none":"line-through"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"none":"line-through"},applyValueToRange:function(c,
a){for(var b=g.decomposeRange(c,a.rangesToPreserve),b=getRangeCorrectly(b,a.rangesToPreserve[0]),d=0,e=b.length;d<e;++d)g.setNodeValue(b[d],a)}});e.registerCommand("strikeThrough",new f)});
rangy.createModule("SuperScriptCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{relevantCssProperty:"verticalAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.verticalAlign||(/^(sup|sub)$/i.test(c.tagName)?"super":null)},createNonCssElement:function(c,a){return"super"==a?h.getDocument(c).createElement("sup"):null},getRangeValue:function(c,a){var b=g.getEffectiveTextNodes(c,a),d=b.length,e;if(0==
b.length)return"super"==g.getEffectiveValue(c.commonAncestorContainer,a);for(;d--;)if(e=g.getEffectiveValue(b[d],a),"super"!=e)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],a))return!1;return 0<e},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"baseline":"super"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"baseline":"super"},applyValueToRange:function(c,a){for(var b=g.decomposeRange(c,
a.rangesToPreserve),b=getRangeCorrectly(b,a.rangesToPreserve[0]),d=0,e=b.length;d<e;++d)g.setNodeValue(b[d],a)}});e.registerCommand("superscript",new f)});
rangy.createModule("SubScriptCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{relevantCssProperty:"verticalAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.verticalAlign||(/^(sub|sup)$/i.test(c.tagName)?"sub":null)},createNonCssElement:function(c,a){return"sub"==a?h.getDocument(c).createElement("sub"):null},getRangeValue:function(c,a){var b=g.getEffectiveTextNodes(c,a),d=b.length,e;if(0==b.length)return"sub"==
g.getEffectiveValue(c.commonAncestorContainer,a);for(;d--;)if(e=g.getEffectiveValue(b[d],a),"sub"!=e)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],a))return!1;return 0<e},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"baseline":"sub"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"baseline":"sub"},applyValueToRange:function(c,a){for(var b=g.decomposeRange(c,a.rangesToPreserve),
b=getRangeCorrectly(b,a.rangesToPreserve[0]),d=0,e=b.length;d<e;++d)g.setNodeValue(b[d],a)}});e.registerCommand("subscript",new f)});
rangy.createModule("JustifyLeftCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{relevantCssProperty:"textAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.textAlign||(/^(p)$/i.test(c.tagName)?"left":null)},createNonCssElement:function(c,a){return"left"==a?h.getDocument(c).createElement("p"):null},getRangeValue:function(c,a){var b=g.getEffectiveTextNodes(c,a),d=b.length,e;if(0==b.length)return"left"==
g.getEffectiveValue(c.commonAncestorContainer,a);for(;d--;)if(e=g.getEffectiveValue(b[d],a),"left"!=e)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],a))return!1;return 0<e},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"":"left"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"":"left"},applyValueToRange:function(c,a){for(var b=g.decomposeRange(c,a.rangesToPreserve),b=getRangeCorrectly(b,
a.rangesToPreserve[0]),d=0,e=b.length;d<e;++d)g.setNodeValue(b[d],a)}});e.registerCommand("justifyLeft",new f)});
rangy.createModule("JustifyCenterCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{relevantCssProperty:"textAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.textAlign||(/^(p)$/i.test(c.tagName)?"center":null)},createNonCssElement:function(c,a){return"center"==a?h.getDocument(c).createElement("p"):null},getRangeValue:function(c,a){var b=g.getEffectiveTextNodes(c,a),d=b.length,e;if(0==b.length)return"center"==
g.getEffectiveValue(c.commonAncestorContainer,a);for(;d--;)if(e=g.getEffectiveValue(b[d],a),"center"!=e)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],a))return!1;return 0<e},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"":"center"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"":"center"},applyValueToRange:function(c,a){for(var b=g.decomposeRange(c,a.rangesToPreserve),b=getRangeCorrectly(b,
a.rangesToPreserve[0]),d=0,e=b.length;d<e;++d)g.setNodeValue(b[d],a)}});e.registerCommand("justifyCenter",new f)});
rangy.createModule("FontsizeCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{relevantCssProperty:"fontSize",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.fontSize||(/^(font)$/i.test(c.tagName)?"fontSize":null)},createNonCssElement:function(c,a){return"fontsize"!=a?h.getDocument(c).createElement("span"):null},getRangeValue:function(c,a){var b=g.getEffectiveTextNodes(c,a),d=b.length,e;if(0==b.length)return"fontsize"==
g.getEffectiveValue(c.commonAncestorContainer,a);for(;d--;)if(e=g.getEffectiveValue(b[d],a),e!=a.options.fontsize)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],a))return!1;return 0<e},getNewRangeValue:function(c,a){return a.options.fontsize},getNewSelectionValue:function(c,a){return a.options.fontsize},applyValueToRange:function(c,a){if(""!=a.value){var b=g.decomposeRange(c,a.rangesToPreserve);b&&1==b.length&&1==b[0].nodeType&&
"body"==b[0].nodeName.toLowerCase()&&(b=getChildToArray(b[0]));var b=getRangeCorrectly(b,a.rangesToPreserve[0]),d=checkSameParent(b);d&&(b=d);for(var d=0,e=b.length;d<e;++d)if(1==b[d].nodeType&&"p"==b[d].nodeName.toLowerCase()){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var f=b[d].innerHTML,f=f.replace(RegExp("(<br)[^>].*?>","gim"),"$1>");if("<br/>"==f||"<br />"==f||"<br>"==f||""==f)b[d].innerHTML="&nbsp;";else for(var h=b[d].childNodes.length,f=0;f<h;++f)if(1==b[d].childNodes[f].nodeType&&
"BR"==b[d].childNodes[f].tagName){var m=b[d].childNodes[f],v=_iframeDoc.createElement("span");m.parentNode.insertBefore(v,m);v.appendChild(m)}}h=getChildToArray(b[d]);f=0;for(m=h.length;f<m;++f)g.setNodeValue(h[f],a)}else g.setNodeValue(b[d],a)}}});e.registerCommand("fontsize",new f)});
rangy.createModule("FontfamilyCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{relevantCssProperty:"fontFamily",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.fontFamily||(/^(font)$/i.test(c.tagName)?"fontFamily":null)},createNonCssElement:function(c,a){return"fontFamily"!=a?h.getDocument(c).createElement("span"):null},getRangeValue:function(c,a){var b=g.getEffectiveTextNodes(c,a),d=b.length,e;if(0==
b.length)return"fontFamily"==g.getEffectiveValue(c.commonAncestorContainer,a);for(;d--;)if(e=g.getEffectiveValue(b[d],a),e!=a.options.fontfamily)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],a))return!1;return 0<e},getNewRangeValue:function(c,a){return a.options.fontfamily},getNewSelectionValue:function(c,a){return a.options.fontfamily},applyValueToRange:function(c,a){if(""!=a.value){var b=g.decomposeRange(c,a.rangesToPreserve);
b&&1==b.length&&1==b[0].nodeType&&"body"==b[0].nodeName.toLowerCase()&&(b=getChildToArray(b[0]));var b=getRangeCorrectly(b,a.rangesToPreserve[0]),d=checkSameParent(b);d&&(b=d);for(var d=0,e=b.length;d<e;++d)if(1==b[d].nodeType&&"p"==b[d].nodeName.toLowerCase()){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var f=b[d].innerHTML,f=f.replace(RegExp("(<br)[^>].*?>","gim"),"$1>");if("<br/>"==f||"<br />"==f||"<br>"==f||""==f)b[d].innerHTML="&nbsp;";else for(var h=b[d].childNodes.length,f=0;f<
h;++f)if(1==b[d].childNodes[f].nodeType&&"BR"==b[d].childNodes[f].tagName){var m=b[d].childNodes[f],v=_iframeDoc.createElement("span");m.parentNode.insertBefore(v,m);v.appendChild(m)}}h=getChildToArray(b[d]);f=0;for(m=h.length;f<m;++f)g.setNodeValue(h[f],a)}else g.setNodeValue(b[d],a)}}});e.registerCommand("fontfamily",new f)});
rangy.createModule("FontcolorCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{relevantCssProperty:"color",defaultOptions:{ignoreWhiteSpace:!0},valuesEqual:function(c,a){c=convertRgbToHex(c);a=convertRgbToHex(a);return c==a},getSpecifiedValue:function(c){return c.style.color||(/^(font)$/i.test(c.tagName)?"color":null)},createNonCssElement:function(c,a){return"color"!=a?h.getDocument(c).createElement("span"):null},getRangeValue:function(c,
a){var b=g.getEffectiveTextNodes(c,a),d=b.length,e;if(0==b.length)return"color"==g.getEffectiveValue(c.commonAncestorContainer,a);for(;d--;)if(e=g.getEffectiveValue(b[d],a),!this.valuesEqual(e,a.options.fontcolor))return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],a))return!1;return 0<e},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"":a.options.fontcolor},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,
a)?"":a.options.fontcolor},applyValueToRange:function(c,a){if(""!=a.value){var b=g.decomposeRange(c,a.rangesToPreserve);b&&1==b.length&&1==b[0].nodeType&&"body"==b[0].nodeName.toLowerCase()&&(b=getChildToArray(b[0]));var b=getRangeCorrectly(b,a.rangesToPreserve[0]),d=checkSameParent(b);d&&(b=d);for(var d=0,e=b.length;d<e;++d)if(1==b[d].nodeType&&"p"==b[d].nodeName.toLowerCase()){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var f=b[d].innerHTML,f=f.replace(RegExp("(<br)[^>].*?>","gim"),
"$1>");if("<br/>"==f||"<br />"==f||"<br>"==f||""==f)b[d].innerHTML="&nbsp;";else for(var h=b[d].childNodes.length,f=0;f<h;++f)if(1==b[d].childNodes[f].nodeType&&"BR"==b[d].childNodes[f].tagName){var m=b[d].childNodes[f],v=_iframeDoc.createElement("span");m.parentNode.insertBefore(v,m);v.appendChild(m)}}h=getChildToArray(b[d]);f=0;for(m=h.length;f<m;++f)g.setNodeValue(h[f],a)}else g.setNodeValue(b[d],a)}}});e.registerCommand("fontcolor",new f)});
rangy.createModule("FontBgcolorCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{relevantCssProperty:"backgroundColor",defaultOptions:{ignoreWhiteSpace:!0},valuesEqual:function(c,a){c=convertRgbToHex(c);a=convertRgbToHex(a);return c==a},getSpecifiedValue:function(c){return c.style.backgroundColor||(/^(font)$/i.test(c.tagName)?"backgroundColor":null)},createNonCssElement:function(c,a){return"backgroundColor"!=a?h.getDocument(c).createElement("span"):
null},getRangeValue:function(c,a){var b=g.getEffectiveTextNodes(c,a),d=b.length,e;if(0==b.length)return"backgroundColor"==g.getEffectiveValue(c.commonAncestorContainer,a);for(;d--;)if(e=g.getEffectiveValue(b[d],a),!this.valuesEqual(e,a.options.fontcolor))return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],a))return!1;return 0<e},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"":a.options.fontcolor},getNewSelectionValue:function(c,
a){return this.getSelectionValue(c,a)?"":a.options.fontcolor},applyValueToRange:function(c,a){if(""!=a.value){var b=g.decomposeRange(c,a.rangesToPreserve);b&&1==b.length&&1==b[0].nodeType&&"body"==b[0].nodeName.toLowerCase()&&(b=getChildToArray(b[0]));var b=getRangeCorrectly(b,a.rangesToPreserve[0]),d=checkSameParent(b);d&&(b=d);for(var d=0,e=b.length;d<e;++d)if(1==b[d].nodeType&&"p"==b[d].nodeName.toLowerCase()){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var f=b[d].innerHTML,f=f.replace(RegExp("(<br)[^>].*?>",
"gim"),"$1>");if("<br/>"==f||"<br />"==f||"<br>"==f||""==f)b[d].innerHTML="&nbsp;";else for(var h=b[d].childNodes.length,f=0;f<h;++f)if(1==b[d].childNodes[f].nodeType&&"BR"==b[d].childNodes[f].tagName){var m=b[d].childNodes[f],v=_iframeDoc.createElement("span");m.parentNode.insertBefore(v,m);v.appendChild(m)}}h=getChildToArray(b[d]);f=0;for(m=h.length;f<m;++f)g.setNodeValue(h[f],a)}else g.setNodeValue(b[d],a)}}});e.registerCommand("fontbgcolor",new f)});
rangy.createModule("LineHeightCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{relevantCssProperty:"lineHeight",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.lineHeight?"lineHeight":null},createNonCssElement:function(c,a){return"lineHeight"!=a?h.getDocument(c).createElement("span"):null},getRangeValue:function(c,a){var b=g.getEffectiveTextNodes(c,a),d=b.length,e;if(0==b.length)return"lineHeight"==
g.getEffectiveValue(c.commonAncestorContainer,a);for(;d--;)if(e=g.getEffectiveValue(b[d],a),e!=a.options.lineheight)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],a))return!1;return 0<e},getNewRangeValue:function(c,a){return a.options.lineheight},getNewSelectionValue:function(c,a){return a.options.lineheight},applyValueToRange:function(c,a){for(var b=g.decomposeRange(c,a.rangesToPreserve),b=getRangeCorrectly(b,a.rangesToPreserve[0]),
d=0,e=b.length;d<e;++d)g.setNodeValue(b[d],a)}});e.registerCommand("lineheight",new f)});
rangy.createModule("FormattingCommand",function(e,m){function f(){}e.requireModules(["Commands"]);var h=e.dom,g=e.Command.util;e.Command.create(f,{defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return/^(h1|h2|h3|h4|h5)$/i.test(c.tagName)?"formatting":null},createNonCssElement:function(c,a,b){return"formatting"==a?h.getDocument(c).createElement(b.options.tagName):null},getRangeValue:function(c,a){var b=g.getEffectiveTextNodes(c,a),d=b.length,e;if(0==b.length)return"formatting"==
g.getEffectiveValue(c.commonAncestorContainer,a);for(;d--;)if(e=g.getEffectiveValue(b[d],a),"formatting"!=e)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),d=0,e=b.length;d<e;++d)if(!this.getRangeValue(b[d],a))return!1;return 0<e},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"":"formatting"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"":"formatting"},applyValueToRange:function(c,a){for(var b=g.decomposeRange(c,a.rangesToPreserve),
b=getRangeCorrectly(b,a.rangesToPreserve[0]),d=0,e=b.length;d<e;++d)g.setNodeValue(b[d],a)}});e.registerCommand("formatting",new f)});rangy.createModule("Util",function(e,m){e.requireModules(["WrappedSelection","WrappedRange"]);var f=e.rangePrototype,h=e.selectionPrototype;f.select=function(g){e.getSelection(this.getDocument()).setSingleRange(this,g)};h.pasteText=function(e){this.deleteFromDocument();var c=this.getRangeAt(0);e=c.getDocument().createTextNode(e);c.insertNode(e);this.setSingleRange(c)};f.pasteText=function(e){this.deleteContents();e=this.getDocument().createTextNode(e);this.insertNode(e)};h.pasteHtml=function(e){this.deleteFromDocument();
var c=this.getRangeAt(0);e=this.createContextualFragment(e);var a=e.lastChild;c.insertNode(e);a&&c.setStartAfter(a);this.setSingleRange(c)};f.pasteHtml=function(e){this.deleteContents();e=this.createContextualFragment(e);this.insertNode(e)};h.selectNodeContents=function(f){var c=e.createRange(this.win);c.selectNodeContents(f);this.setSingleRange(c)};e.createRangeFromNode=function(f){var c=e.createRange(f);c.selectNode(f);return c};e.createRangeFromNodeContents=function(f){var c=e.createRange(f);c.selectNodeContents(f);
return c}});rangy.createModule("Position",function(e,m){function f(a){var b=0,c=0;if("number"==typeof a.pageXOffset&&"number"==typeof a.pageYOffset)b=a.pageXOffset,c=a.pageYOffset;else{a=a.document;var d=a.documentElement,e=a.compatMode;if((a="string"==typeof e&&0<=e.indexOf("CSS")&&d?d:t.getBody(a))&&"number"==typeof a.scrollLeft&&"number"==typeof a.scrollTop)try{b=a.scrollLeft,c=a.scrollTop}catch(f){"undefined"!=typeof RAONWIZDLW&&RAONWIZDLW&&RAONWIZDLW()}}return{x:b,y:c}}function h(a,b){for(b=b.toLowerCase();a;){if(1==
a.nodeType&&a.tagName.toLowerCase()==b)return a;a=a.parentNode}return null}function g(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d;this.width=b-d;this.height=c-a}function c(a,b,c){return new g(a.top+c,a.right+b,a.bottom+c,a.left+b)}function a(a,b){var d=0,e=0,f=b.documentElement,g=t.getBody(b),g=0===f.clientWidth&&"number"==typeof g.clientTop?g:f,f=g.clientLeft,g=g.clientTop;f&&(d=-f);g&&(e=-g);return c(a,d,e)}function b(a){for(var b=[],c=[],d=[],e=[],f=0,l=a.length,h;f<l;++f)if(h=a[f])b.push(h.top),
c.push(h.bottom),d.push(h.left),e.push(h.right);return new g(Math.min.apply(Math,b),Math.max.apply(Math,e),Math.max.apply(Math,c),Math.min.apply(Math,d))}function d(a,b,c){a=t.getBody(a).createTextRange();a.moveToPoint(b,c);b=new e.WrappedTextRange(a);return new K(b.startContainer,b.startOffset)}function n(a,b,c){a=a.caretPositionFromPoint(b,c);return new K(a.offsetNode,a.offset)}function u(a,b,c){a=a.caretRangeFromPoint(b,c);return new K(a.startContainer,a.startOffset)}function M(a){a=(a.nativeRange||
a).getClientRects();return 0<a.length?a[a.length-1]:null}function N(a,b,c,d){var f=a.elementFromPoint(b,c);a=e.createRange(a);a.selectNodeContents(f);a.collapse(!0);var g=f.firstChild,l,h,m;if(g){a:for(;g;){if(3==g.nodeType)for(l=0,m=g.length;l<=m;++l){if(a.setEnd(g,l),(h=M(a))&&c<h.bottom&&b>=h.left&&b<=h.right){h.right-b>b-h.left&&--l;break a}}else if(a.setEndAfter(g),(h=M(a))&&c<h.bottom&&b>=h.left&&b<=h.right){l=t.getNodeIndex(g);g=f.parentNode;d||++l;break}g=g.nextSibling}g||(g=f,l=f.childNodes.length)}else g=
f.parentNode,l=t.getNodeIndex(f),d||++l;return new K(g,l)}function v(a){if(e.features.implementsTextRange)return d;if("undefined"!=typeof a.caretPositionFromPoint)return n;if("undefined"!=typeof a.caretRangeFromPoint)return u;if("undefined"!=typeof a.elementFromPoint&&L)return N}function B(a,b,c,d,f){f=t.getContentDocument(f,m,"createRangeFromPoints");var g=v(f);a=g(f,a,b,!1);c=g(f,c,d,!0);f=e.createRange(f);f.setStartAndEnd(a.node,a.offset,c.node,c.offset);return f}function Q(a,b){return a.compareBoundaryPoints(b.START_TO_START,
b)}function I(a){return function(){for(var c="getBounding"+(a?"Document":"Client")+"Rect",d=[],e=0;e<this.rangeCount;++e)d.push(this.getRangeAt(e)[c]());return b(d)}}function J(a,b){return function(){if(0==this.rangeCount)return null;var c=b?"Document":"Client",d=this.getAllRanges();1<d.length&&d.sort(Q);return a?d[0]["getStart"+c+"Pos"]():d[d.length-1]["getEnd"+c+"Pos"]()}}e.requireModules(["WrappedSelection"]);var P=e.WrappedRange,O=e.WrappedTextRange,t=e.dom,w=e.util,K=t.DomPosition,z=document.createElement("span"),
D=w.isHostMethod(z,"getBoundingClientRect"),z=null,L=!1,z=!1;e.features.implementsDomRange&&(z=e.createNativeRange(),L=w.isHostMethod(z,"getClientRects"),z=w.isHostMethod(z,"getBoundingClientRect"));w.extend(e.features,{rangeSupportsGetBoundingClientRect:z,rangeSupportsGetClientRects:L,elementSupportsGetBoundingClientRect:D});var E=function(a){return function(){var b=this.cloneRange();b.collapse(a);b=b.getBoundingClientRect();return{x:b[a?"left":"right"],y:b[a?"top":"bottom"]}}},C=function(a){return function(){var b=
this["get"+(a?"Start":"End")+"ClientPos"](),c=f(t.getWindow(this.startContainer));return{x:b.x+c.x,y:b.y+c.y}}},F=e.rangePrototype;if(e.features.implementsTextRange&&D)F.getBoundingClientRect=function(){var c=O.rangeToTextRange(this),d=this.getNodes([1],function(a){return/^t[dh]$/i.test(a.tagName)}),e=[];if(0<d.length){for(var f=h(this.startContainer,"table"),g=0,m,l,n;m=d[g];++g)l=h(m,"table"),f&&l==f||(n=this.cloneRange(),f&&n.setStartAfter(f),n.setEndBefore(l),e.push(O.rangeToTextRange(n).getBoundingClientRect())),
this.containsNode(m)?e.push(m.getBoundingClientRect()):(f=c.duplicate(),f.moveToElementText(m),-1==f.compareEndPoints("StartToStart",c)?f.setEndPoint("StartToStart",c):1==f.compareEndPoints("EndToEnd",c)&&f.setEndPoint("EndToEnd",c),e.push(f.getBoundingClientRect())),f=l;!h(this.endContainer,"table")&&f&&(n=this.cloneRange(),n.setStartAfter(f),e.push(O.rangeToTextRange(n).getBoundingClientRect()));c=b(e)}else c=c.getBoundingClientRect();return a(c,t.getDocument(this.startContainer))};else if(e.features.implementsDomRange){var r=
function(a){return a instanceof P?a:new P(a)};if(z)F.getBoundingClientRect=function(){var b=r(this).nativeRange,b=b.getBoundingClientRect()||b.getClientRects()[0];return a(b,t.getDocument(this.startContainer))},L&&(E=function(a){return function(){var b;b=r(this).nativeRange.getClientRects();if(0<b.length){if(a)return b=b[0],{x:b.left,y:b.top};b=b[b.length-1];return{x:b.right,y:b.bottom}}}});else{var G=D?function(b){return a(b.getBoundingClientRect(),t.getDocument(b))}:function(b){for(var c=0,d=0,
e=b,f=b.offsetWidth,h=b.offsetHeight;e;)c+=e.offsetLeft,d+=e.offsetTop,e=e.offsetParent;return a(new g(d,c+f,d+h,c),t.getDocument(b))},H=function(a){var c;a.splitBoundaries();var d=document.createElement("span");if(a.collapsed)a.insertNode(d),c=G(d),d.parentNode.removeChild(d);else{var e=a.cloneRange();e.collapse(!0);e.insertNode(d);c=G(d);d.parentNode.removeChild(d);e.collapseToPoint(a.endContainer,a.endOffset);e.insertNode(d);e=G(d);d.parentNode.removeChild(d);d=[c,e];c=a.getNodes([1],function(b){return a.containsNode(b)});
for(var e=0,f=c.length;e<f;++e)d.push(G(c[e]));c=b(d)}a.normalizeBoundaries();return c};F.getBoundingClientRect=function(a){return H(r(a))}}}w.extend(F,{getBoundingDocumentRect:function(){var a=f(t.getWindow(this.startContainer));return c(this.getBoundingClientRect(),a.x,a.y)},getStartClientPos:E(!0),getEndClientPos:E(!1),getStartDocumentPos:C(!0),getEndDocumentPos:C(!1)});w.extend(e.selectionPrototype,{getBoundingClientRect:I(!1),getBoundingDocumentRect:I(!0),getStartClientPos:J(!0,!1),getEndClientPos:J(!1,
!1),getStartDocumentPos:J(!0,!0),getEndDocumentPos:J(!1,!0)});e.positionFromPoint=function(a,b,c){c=t.getContentDocument(c,m,"positionFromPoint");return v(c)(c,a,b)};e.createRangeFromPoints=B;e.moveSelectionToPoints=function(a,b,c,d,e){var f,g;d<b||b==d&&c<a?(f=c,g=d,d=b):(f=a,g=b,a=c);b=rangy.getSelection(e);e=B(f,g,a,d,e);b.setSingleRange(e);return b}});

